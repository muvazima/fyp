@&#MAIN-TITLE@&#Efficient simulation and rendering of realistic motion of one-dimensional flexible objects

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Natural and realistic motion of flexible 1D objects.


                        
                        
                           
                           Smoother and higher order continuity by use of splines.


                        
                        
                           
                           Tractrix based motion applied to control polygon instead of the polyline.


                        
                        
                           
                           Approximate length preservation by modifying control polygon.


                        
                        
                           
                           Adaptive subdivision and merging to reduce computation effort.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

One-dimensional flexible body

Natural motion

Control polygon

Approximate length preservation

Subdivision

Merging

@&#ABSTRACT@&#


               
               
                  In gross motion of flexible one-dimensional (1D) objects such as cables, ropes, chains, ribbons and hair, the assumption of constant length is realistic and reasonable. The motion of the object also appears more natural if the motion or disturbance given at one end attenuates along the length of the object. In an earlier work, variational calculus was used to derive natural and length-preserving transformation of planar and spatial curves and implemented for flexible 1D objects discretized with a large number of straight segments. This paper proposes a novel idea to reduce computational effort and enable real-time and realistic simulation of the motion of flexible 1D objects. The key idea is to represent the flexible 1D object as a spline and move the underlying control polygon with much smaller number of segments. To preserve the length of the curve to within a prescribed tolerance as the control polygon is moved, the control polygon is adaptively modified by subdivision and merging. New theoretical results relating the length of the curve and the angle between the adjacent segments of the control polygon are derived for quadratic and cubic splines. Depending on the prescribed tolerance on length error, the theoretical results are used to obtain threshold angles for subdivision and merging. Simulation results for arbitrarily chosen planar and spatial curves whose one end is subjected to generic input motions are provided to illustrate the approach.
               
            


                        
                           
                              (A.1)
                              
                                 l
                                 
                                    (
                                    θ
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                 
                                 d
                                 l
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                             
                                                5
                                             
                                          
                                          +
                                          2
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          2
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                             
                                                5
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             cos
                                             θ
                                          
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       cos
                                       2
                                       θ
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             cos
                                             θ
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                2
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                cos
                                                θ
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   5
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       θ
                                    
                                    
                                       2
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                2
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                cos
                                                θ
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   5
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 log
                                 
                                    
                                       −
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       θ
                                       +
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             cos
                                             θ
                                          
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       θ
                                       +
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             cos
                                             θ
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       θ
                                       
                                          (
                                          3
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             3
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             cos
                                             θ
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                2
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                cos
                                                θ
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   5
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       2
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       θ
                                       cos
                                       θ
                                    
                                    
                                       2
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                2
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                cos
                                                θ
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   5
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 log
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       θ
                                       +
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             cos
                                             θ
                                          
                                       
                                    
                                    
                                       −
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       θ
                                       +
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             cos
                                             θ
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 0
                                 <
                                 θ
                                 <
                                 π
                              
                           
                        
                     

@&#INTRODUCTION@&#

Motion simulation and rendering of one-dimensional (1D) flexible objects and development of algorithms for real time and realistic or natural motion have been active areas of research in the geometric modeling, CAD and robotics community. The original motivation was the requirement of realism in simulation and display of the motion of cables, ropes, chains, hair, snakes etc. in computer graphics and animation industry. In one of the earlier works, Barzel  [1] uses mode shapes of a constrained string model to fake the dynamics of a string. Hergenröether and Däehne  [2] discretize the flexible 1D object into a large number of small (linear) rigid objects, each endowed with mass and connected by different kinds of springs and dampers. With appropriate choice of parameter values of mass, spring and damping constant, a physics-based realistic simulation was obtained. Taskıran and Güdükbay  [3] have also employed spring–mass system for simulating hair dynamics. In an extension to these works, Güdükbay et al.  [4] propose spring mass systems for simulation of elastically deformable models. The main issue in these techniques is to choose or obtain appropriate spring and damping constants for which Natsupakpong and Çavuşoğlu  [5] have devised an algorithm for estimating these based on error minimization between FEM and lumped element models. However, the algorithm is not feasible for real-time implementation. Moll and Kavaraki  [6] present path planning for flexible 1D objects using minimal energy curves and probabilistic root maps. Ward et al.  [7] survey the field of hair modeling, approaching the majority of the existing methods. Grégoire and Schömer  [8] and, Spillmann and Tescner  [9] use Cosserat model for rod-like solids to model bending and torsion for real-time realistic simulation of flexible parts. Lenoir et al.  [10] use Lagrangian formulation posing lumped masses on the control polygon vertices and springs along the curve (resisting bending and stretching) combined with spline refinement techniques, namely sub-division/merging to simulate the motion of flexible objects. In an extension to this work, Theetten et al.  [11] generate geometrically exact expressions for deformations of flexible 1D objects by concurrently using beams and spline theory. Goldenthal et al.  [12] use a constrained Lagrangian mechanics based approach to handle inextensible cloth simulation—the length constraint (in-extensibility) is explicitly enforced on the cloth mesh thereby increasing computational effort especially when the resolution in the cloth model is increased. To overcome the stiff nature of the differential equation in cloth simulation (due to the high compliance along cloth surface normal vector as compared to almost zero compliance for the in-plane extension), Baraff and Witkin  [13] use an implicit solver to simulate cloth motion. This is however an iterative procedure and convergence is an issue. Wang et al.  [14] use strain limiting algorithms to overcome the stiffness issue. In another work, Mikchevitch et al.  [15] use free-form surfaces and flexible beams to model a real time simulator for assembly–disassembly operations. The review paper by Nealen et al.  [16] discuss the existing physically deformable models in computer graphics in detail and gives a very good overview. In all the above mentioned works, dynamics is incorporated and a large amount of effort is towards speeding up the computation or improving the accuracy by adjusting the algorithms. However, all of these methods suffer from one or more issues like stability, convergence, computational errors due to mathematical stiffness of the system, dependence on many arbitrary parameters, phantom forces from high residuals, excessive damping/numerical losses or lack of feasibility for real-time implementation.

In contrast to the above mentioned approaches, many authors have focused on viewing this problem from a pure kinematics perspective so that the issues of stability, convergence and choice of parameters do not arise. Brown et al.  [17] have presented tying of knots in a rope with a geometric approach where the flexible 1D object is discretized into linear segments connected by joints and the motion of a trailing segment uses a follow the leader based strategy. Su et al.  [18] use inverse kinematics and energy minimization to approximately preserve length of deformed polyline and a 4-point subdivision scheme is used to obtain smooth 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      curve from the deformed polyline. In another work, Sreenivasan et al.  [19] use the closed-form equations of the classical tractrix curve to iteratively compute the motion of all trailing linear segments. They show that the tractrix based approach has the property of attenuating the motion of the segments from the input end, and this results in a more natural motion of the flexible 1D object. In a subsequent work, Menon et al.  [20] have shown that the tractrix based solution can be derived from a constrained optimization problem involving minimizing the velocity of points on a curve subject to preservation of the length of the curve. In all of these works, only the kinematics of the 1D object is used to impart realism in the simulation and rendering and since the flexible 1D object is discretized into linear rigid segments, the length is explicitly and always preserved.

In the robotics community, motion planning and simulation of snake and other robots with large number of rigid links connected by actuated joints have been a continuing research area (see, for example,  [21–24] and the references therein). In a robot, if the number of actuated joints is more than six for motion in 3D space and more than three for motion in a plane, then there exist many joint angle sets (configurations) which will achieve the same position and orientation of the end-effector of the robot. The main approach in such redundant robots is to effectively use the extra actuated joints for selecting poses/paths which optimize a useful functional—this is called the resolution of redundancy. One of the earliest techniques used for resolution of redundancy involved the use of the manipulator Jacobian matrix to minimize joint rotation, velocity, torque or to avoid obstacles and singularities in the path of the robot  [21]. This approach involves obtaining the pseudo-inverse of the manipulator Jacobian matrix and can have a complexity of 
                        O
                        
                           (
                           
                              
                                 n
                              
                              
                                 3
                              
                           
                           )
                        
                      where 
                        n
                      is the number of joint variables. Pseudo-inverse based methods are thus not suitable for motion planning when the numbers of links and joints are large. A second approach developed by Chirikjian and Burdick  [22] involves the use of a backbone curve to approximate the redundant robot and the motion planning is done on the backbone curve. The complexity of their algorithm is 
                        O
                        
                           (
                           n
                           )
                        
                      but in this approach the length of the curve may not be preserved. In another approach by Reznik and Lumelsky  [23], the motion planning is done in the task space (instead of in the joint space) using the classical tractrix curve. As mentioned earlier, the use of the tractrix curve results in a more natural motion of the robot. The tractrix based algorithm has a complexity of 
                        O
                        
                           (
                           n
                           )
                        
                      where 
                        n
                      is the number of rigid links.

In recent past, there has been an increased interest in real-time simulation and rendering of the motion of 1D and 2D flexible objects. This is driven by the need to build simulators for laparoscopy, endoscopy and in the general area of training of medical practitioners where motion of blood vessels, tendons etc., motion inside the gastro-intestinal tract or intestine and actions such as tying of knots and suturing needs to be simulated with a high degree of realism  [25,26]. This work has been motivated by the need for developing more realistic simulators for endoscopy and laparoscopic surgeries and is restricted to real-time, efficient and realistic simulation and rendering of the motion of flexible 1D objects.

In this work, the flexible 1D object to be simulated is modeled as a B-spline curve as opposed to being discretized into large number of straight segments. All manipulations are done on the segments of the control polygon which generates the B-spline curve. The main contributions are (a) obtaining new analytic expressions of change in length of a B-spline curve from an initial configuration as the angle between two adjacent segments of its control polygon is changed, (b) use of a tractrix based algorithm on the control polygon of a B-spline curve representing the flexible 1D object, and (c) the development of an adaptive algorithm to approximately preserve the length of the flexible 1D object. The tractrix based algorithm results in a more natural and realistic motion of the curve modeling the flexible 1D object. As the control polygon is moved, the resulting length of the curve is not preserved and the adaptive algorithm is used to sub-divide and merge sides of the control polygon so that a prescribed error tolerance on the length of the curve is maintained at all times during the motion of the curve. Since the angle between the adjacent segments is related to the length of the B-spline curve, monitoring the angle is enough to decide on the subdivision and merging.

Note that the tractrix based algorithm has a complexity of 
                        O
                        
                           (
                           n
                           )
                        
                      where 
                        n
                      is the number of segments used to represent the flexible 1D object. However, since the number of sides of the underlying control polygon is much less than 
                        n
                     , the complexity of the algorithm can be termed as 
                        O
                        
                           (
                           1
                           )
                        
                     . The algorithms for natural and realistic motion planning, the adaptive altering of the control polygon and the mathematical results are illustrated using numerical examples where an arbitrary curve is moved along a generic direction with a prescribed length error tolerance. The efficiency of the developed algorithms are also demonstrated with the numerical examples.

The paper is organized as follows: in Section  2 we briefly present the tractrix based motion of a flexible 1D object. New analytic expressions and results for the length of a quadratic B-spline and cubic B-spline curve in terms of the angle between two adjacent segments of the control polygon are presented. The notion of moving the generating control polygon and resulting change in the length of the spline due to motion of the control polygon is also presented. In Section  3, we present an algorithm to adaptively subdivide and merge edges of a control polygon to maintain the length of a curve to within a specified length error. In Section  4, we present numerical results illustrating our approach for efficient and realistic motion simulation and visualization of motion of flexible 1D objects. In Section  5 we present the conclusions of this work.

In this section, we present the main theoretical results used to obtain the algorithms for efficient and realistic simulation and rendering of the motion of flexible 1D objects. We start with a brief discussion on the tractrix based algorithm and then present new results dealing with length of quadratic and cubic B-splines.

The tractrix based approach for natural and realistic motion of a curve or a flexible 1D object is dealt in details in Refs.  [19,20]. We present the key results used in this work.


                        
                           
                              •
                              Consider a curve of length 
                                    L
                                  whose one end is given an input motion as shown in Fig. 1
                                 (a) subject to the constraint that the length of the curve is preserved. As shown, using calculus of variation, the infinitesimal motion at any point on the curve is minimized when the velocity of the point is along the tangent to the curve  [20].

For the special case of a line segment of length 
                                    L
                                 , initially lying along the 
                                    Y
                                  axis and an input motion given to the leading end on the 
                                    X
                                  axis along the 
                                    X
                                  axis, the path (curve) traced by the trailing end of the linear segment is given in a parametric form as 
                                    
                                       (1)
                                       
                                          x
                                          
                                             (
                                             q
                                             )
                                          
                                          =
                                          q
                                          −
                                          L
                                          
                                          tanh
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   L
                                                
                                             
                                             )
                                          
                                          
                                          and
                                          
                                          y
                                          
                                             (
                                             q
                                             )
                                          
                                          =
                                          L
                                          
                                          sech
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   L
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                  where 
                                    q
                                  denotes the parameter which in our case is the time 
                                    t
                                 .

The above Eq. (1) is the well-known equation of a classical curve known as the tractrix   [23]. It can be shown that for a infinitesimal motion, 
                                    d
                                    q
                                 , of the leading end, the infinitesimal displacement of the trailing end 
                                    d
                                    r
                                    =
                                    
                                       
                                          d
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          d
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                  is the minimum of all possible infinitesimal displacements of the trailing end, if it follows a tractrix curve. It can also be shown that 
                                    d
                                    r
                                    ≤
                                    d
                                    q
                                 . Additionally, as 
                                    q
                                    →
                                    ∞
                                  (or 
                                    t
                                    →
                                    ∞
                                 ), 
                                    tanh
                                    
                                       (
                                       q
                                       /
                                       L
                                       )
                                    
                                    →
                                    1
                                  and 
                                    sech
                                    
                                       (
                                       q
                                       /
                                       L
                                       )
                                    
                                    →
                                    0
                                  which gives 
                                    
                                       (2)
                                       
                                          x
                                          
                                             (
                                             ∞
                                             )
                                          
                                          →
                                          q
                                          −
                                          L
                                          ,
                                          
                                          y
                                          
                                             (
                                             ∞
                                             )
                                          
                                          →
                                          0
                                          ,
                                       
                                    
                                  implying that as time increases, the linear segment aligns with the 
                                    X
                                 -axis and in this case 
                                    d
                                    r
                                    =
                                    d
                                    q
                                 .

The tractrix based approach can be applied to arbitrary 3D motion of a flexible 1D object discretized by 
                                    n
                                  linear segments as shown in Fig. 1(b) (see Ref.  [19] for details). This is due to the observation that the destination point 
                                    
                                       
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             )
                                          
                                       
                                       
                                          p
                                       
                                       
                                          T
                                       
                                    
                                 , the leading end or point 1 and the trailing end of the first segment or point 2 define a plane. For the arbitrary 3D displacement of the leading end (point 1) to 
                                    
                                       
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             )
                                          
                                       
                                       
                                          p
                                       
                                       
                                          T
                                       
                                    
                                 , the new location of the trailing end (point 2) in the plane can be obtained from Eq. (1). The location of the trailing end in 3D space, denoted by 
                                    
                                       
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             )
                                          
                                       
                                       
                                          2
                                       
                                       
                                          T
                                       
                                    
                                 , can then be obtained by using an appropriate rotation matrix. The second segment 
                                    
                                       
                                          23
                                       
                                       
                                          ⃗
                                       
                                    
                                  and the vector along the displacement of point 2 to 
                                    
                                       
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             )
                                          
                                       
                                       
                                          2
                                       
                                       
                                          T
                                       
                                    
                                 , in general, will lie on a different plane. However, again the new location of the trailing end (point 3) given by 
                                    
                                       
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             )
                                          
                                       
                                       
                                          3
                                       
                                       
                                          T
                                       
                                    
                                  can be computed using the tractrix equations and a different appropriate rotation matrix. Proceeding in a similar manner, the displacement of the leading end of the 
                                    
                                       (
                                       i
                                       −
                                       1
                                       )
                                    
                                 th segment is the displacement of the trailing end of the 
                                    i
                                 th segment and one can thus iteratively go down to the 
                                    n
                                 th linear segment and obtain the new configuration of the discretized flexible 1D flexible object.

The algorithm described above has a complexity of 
                                    O
                                    
                                       (
                                       n
                                       )
                                    
                                  where 
                                    n
                                  is the number of line segments used to discretize the flexible 1D object. Since the line segments are considered as rigid, the sum of the length of the segments is automatically preserved during motion. If 
                                    n
                                  is chosen appropriately to ensure that the curve length is approximately equal to the sum of the length of the line segments, the length of the curve is approximately preserved during the motion.

When the input end is displaced, the displacements of all the trailing segments obey the inequality 
                                    d
                                    
                                       
                                          r
                                       
                                       
                                          0
                                       
                                    
                                    ≥
                                    d
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    ≥
                                    ⋯
                                    ≥
                                    d
                                    
                                       
                                          r
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    ≥
                                    d
                                    
                                       
                                          r
                                       
                                       
                                          n
                                       
                                    
                                 , with the equality 
                                    d
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    d
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                  reached only when all the segments align with the input displacement direction. A consequence of this observation is that the motion of the segments progressively gets smaller and appears to ‘die’ out away from the input end. If the input motion vector is constant in one direction, from Eq. (2) it can be concluded that all the segments eventually align with the direction of the input motion.

As mentioned earlier, one of the key ideas of this paper is to move the segments of the control polygon instead of the elements of the discretized curve (polyline) to reduce computation and enable real-time simulation and visualization. However, it is well-known that as the control polygon changes, the spline curve and its length changes  [27]. This is illustrated in Fig. 2
                        : the left most spline curve of length 
                           
                              
                                 L
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         is generated by the control polygon 
                           
                              
                                 
                                    CP
                                 
                              
                              
                                 1
                              
                           
                         and as the sides of the control polygon is moved to 
                           
                              
                                 
                                    CP
                                 
                              
                              
                                 2
                              
                           
                         keeping 
                           
                              
                                 L
                              
                              
                                 
                                    
                                       
                                          CP
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           =
                           
                              
                                 L
                              
                              
                                 
                                    
                                       
                                          CP
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        , one can clearly see that the length of the spline curve changes. It can be observed from Fig. 2 that as the angle between the adjacent segments decrease the length of the spline decreases and the upper bound of curve length is the length of the control polygon. We provide mathematical proofs of these two observations next, first for a quadratic B-spline and then for a cubic B-spline. Finally, arguments for any higher degree 3D splines are provided.

For a quadratic spline shown in Fig. 3
                           , the three consecutive points 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                            always lie on a plane. It may be noted that the analysis is not restricted to planar quadratic splines as the next three points can lie on a different plane and the entire curve can be spatial. Without loss of generality, the coordinates of the three points can be assumed to be 
                              
                                 
                                    
                                       [
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       0
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                           , 
                              
                                 
                                    
                                       [
                                       0
                                       ,
                                       0
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                            and 
                              
                                 
                                    
                                       [
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       θ
                                       ,
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       sin
                                       θ
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                           , respectively, where 
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                            are the lengths of the two sides of the control polygon and 
                              θ
                            is the angle between the adjacent sides of the control polygon. The set of control points 
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                            generate the part of the spline shown in Fig. 3 for the parameter interval 
                              u
                              ∈
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                              
                           . The length of the spline curve for 
                              u
                              ∈
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                              
                           , is given by 
                              
                                 (3)
                                 
                                    l
                                    
                                       (
                                       θ
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  p
                                                               
                                                            
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                         
                                                         
                                                            d
                                                            u
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  p
                                                               
                                                            
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                         
                                                         
                                                            d
                                                            u
                                                         
                                                      
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                    d
                                    u
                                    ,
                                 
                              
                            where 
                              l
                              
                                 (
                                 θ
                                 )
                              
                            means that the spline curve length depends on the included angle 
                              θ
                           .

In an open-uniform knot vector of the form 
                              
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 …
                                 
                                    
                                       u
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       m
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       m
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       m
                                    
                                 
                                 ]
                              
                            with 
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ≤
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              ≤
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                              ≤
                              ⋯
                              ≤
                              
                                 
                                    u
                                 
                                 
                                    m
                                 
                              
                           , without loss of generality, an intermediate knot interval 
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                              
                            (
                              i
                              ≠
                              1
                              ,
                              2
                              ,
                              m
                              −
                              2
                              ,
                              m
                              −
                              1
                           ) can be reduced to 
                              
                                 (
                                 0
                                 ,
                                 1
                                 )
                              
                            by appropriate scaling and translation of parameter 
                              u
                           . The basis functions 
                              
                                 
                                    N
                                 
                                 
                                    i
                                    ,
                                    p
                                 
                              
                            for a quadratic spline with 
                              p
                              =
                              2
                            and for the knot interval 
                              
                                 (
                                 0
                                 ,
                                 1
                                 )
                              
                            are given by 
                              
                                 (4)
                                 
                                    
                                       
                                          N
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             1
                                             −
                                             u
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          N
                                       
                                       
                                          2
                                          ,
                                          2
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    u
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          N
                                       
                                       
                                          3
                                          ,
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                            Using the above, 
                              l
                              
                                 (
                                 θ
                                 )
                              
                            can be simplified to 
                              
                                 (5)
                                 
                                    l
                                    
                                       (
                                       θ
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   −
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   u
                                                   cos
                                                   θ
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   u
                                                   sin
                                                   θ
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                    d
                                    u
                                 
                              
                            and for 
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              =
                              L
                           , 
                              l
                              
                                 (
                                 θ
                                 )
                              
                            is given by 
                              
                                 (6)
                                 
                                    l
                                    
                                       (
                                       θ
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                32
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   1
                                                   +
                                                   cos
                                                   θ
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             8
                                             
                                                
                                                   L
                                                
                                                
                                                   4
                                                
                                             
                                             
                                                (
                                                1
                                                +
                                                cos
                                                θ
                                                )
                                             
                                          
                                       
                                       +
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          −
                                          1
                                          +
                                          cos
                                          θ
                                          )
                                       
                                       log
                                       
                                          
                                             
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   1
                                                   +
                                                   cos
                                                   θ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                   +
                                                   cos
                                                   θ
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    0
                                    <
                                    θ
                                    <
                                    π
                                    .
                                 
                              
                            From above, 
                              
                                 
                                    lim
                                 
                                 
                                    θ
                                    →
                                    π
                                 
                              
                              l
                              
                                 (
                                 θ
                                 )
                              
                              =
                              L
                            and this agrees with known result for a quadratic curve (see pp. 82 in  [27]). From Eq. (6), 
                              
                                 (
                                 L
                                 −
                                 l
                                 
                                    (
                                    θ
                                    )
                                 
                                 )
                              
                            is maximum when 
                              θ
                              →
                              0
                            and the maximum difference is 50% (see Fig. 5). The expression for 
                              l
                              
                                 (
                                 θ
                                 )
                              
                            when 
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                              ≠
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                            is more complicated and is given in Appendix A.

In general, for a quadratic spline with 
                              n
                            segments in the control polygon, the total curve length can be computed as 
                              
                                 (7)
                                 
                                    
                                       
                                          L
                                       
                                       
                                          C
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                L
                                             
                                             
                                                s
                                             
                                          
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                e
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             l
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    L
                                 
                                 
                                    s
                                 
                              
                           , 
                              
                                 
                                    L
                                 
                                 
                                    e
                                 
                              
                            denotes length of starting and ending segment of the control polygon, respectively, 
                              
                                 
                                    L
                                 
                                 
                                    i
                                 
                              
                            denotes the length of the 
                              i
                           th control polygon segment and 
                              
                                 
                                    l
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            denotes the length of the portion of the curve defined by the 
                              i
                           th, 
                              
                                 (
                                 i
                                 +
                                 1
                                 )
                              
                           th and 
                              
                                 (
                                 i
                                 +
                                 2
                                 )
                              
                           th control points.

In the case of the quadratic spline, the three points generating the spline define a plane and locally the spline is planar in a knot interval. This is not valid for a cubic spline since the four generating points and the resulting cubic spline need not be planar. In Appendix B, we show that the worst case, in terms of difference between the curve length and the length of the control polygon, is obtained when all the four points lie on a plane. Hence, we consider the case of a planar cubic spline and obtain expressions for bounds on this difference.


                           Fig. 4
                           
                            shows four interior control points 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              4
                            on a plane and the two included angle 
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                            between the first and second, second and third segments, respectively. The initial configuration of the knot vector is assumed to be a clamped open-uniform knot vector of the form 
                              
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 …
                                 
                                    
                                       u
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       m
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       m
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       m
                                    
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       m
                                    
                                 
                                 ]
                              
                           , 
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ≤
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              ≤
                              ⋯
                              ≤
                              
                                 
                                    u
                                 
                                 
                                    m
                                 
                              
                           . Note that for a uniform non-repeated knot vector, the difference between the curve length and control polygon length is maximum as any repetition of knot vector or subdivision pulls the curve towards the control polygon thereby reducing the length difference.

From the figure, the points of the spline are 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       [
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       0
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                           , 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    
                                       [
                                       0
                                       ,
                                       0
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                           , 
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              =
                              
                                 
                                    
                                       [
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       sin
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    4
                                 
                              
                              =
                              
                                 
                                    
                                       [
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       cos
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       sin
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       sin
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                           . The elemental length of the cubic spline 
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                            is given by 
                              
                                 (8)
                                 
                                    d
                                    l
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  p
                                                               
                                                            
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                         
                                                         
                                                            d
                                                            u
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  p
                                                               
                                                            
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                         
                                                         
                                                            d
                                                            u
                                                         
                                                      
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                    d
                                    u
                                    ,
                                 
                              
                            where 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            are the coordinates of 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              4
                           .

Substituting the 
                              X
                            and 
                              Y
                            coordinates of the points on the control polygon and using 
                              
                                 
                                    N
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                            to denote 
                              
                                 
                                    d
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          3
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                 
                                 
                                    d
                                    u
                                 
                              
                           , we get 
                              
                                 (9)
                                 
                                    
                                       d
                                       l
                                       =
                                       
                                          
                                             A
                                             +
                                             B
                                          
                                       
                                       
                                       d
                                       u
                                       ,
                                    
                                 
                                 
                                    
                                       A
                                       =
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      ∂
                                                      X
                                                   
                                                   
                                                      ∂
                                                      u
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                cos
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      4
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   cos
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   cos
                                                   
                                                      (
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                       and
                                    
                                 
                                 
                                    
                                       B
                                       =
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      ∂
                                                      Y
                                                   
                                                   
                                                      ∂
                                                      u
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                sin
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      4
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   sin
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   sin
                                                   
                                                      (
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       .
                                    
                                 
                              
                            For a cubic spline, the basis functions in 
                              u
                              ∈
                              
                                 [
                                 0
                                 
                                 1
                                 ]
                              
                            are 
                              
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             1
                                             ,
                                             3
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             6
                                          
                                       
                                       
                                          
                                             
                                                (
                                                1
                                                −
                                                u
                                                )
                                             
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             N
                                          
                                          
                                             2
                                             ,
                                             3
                                          
                                       
                                       =
                                       
                                          
                                             2
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    (10)
                                    
                                       
                                          
                                             N
                                          
                                          
                                             3
                                             ,
                                             3
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             6
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       u
                                       −
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       
                                       and
                                       
                                       
                                          
                                             N
                                          
                                          
                                             4
                                             ,
                                             3
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             6
                                          
                                       
                                       
                                          
                                             
                                                (
                                                1
                                                −
                                                u
                                                )
                                             
                                          
                                          
                                             3
                                          
                                       
                                       .
                                    
                                 
                              
                            Substituting the above in Eq. (9), we get 
                              
                                 
                                    
                                       d
                                       l
                                       =
                                       
                                          
                                             P
                                             
                                                
                                                   u
                                                
                                                
                                                   4
                                                
                                             
                                             +
                                             Q
                                             
                                                
                                                   u
                                                
                                                
                                                   3
                                                
                                             
                                             +
                                             R
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             S
                                             u
                                             +
                                             T
                                          
                                       
                                       
                                       d
                                       u
                                       ,
                                    
                                 
                                 
                                    
                                       P
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       cos
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       Q
                                       =
                                       −
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       3
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       cos
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       R
                                       =
                                       
                                          
                                             3
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             5
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       cos
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    (11)
                                    
                                       S
                                       =
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                       T
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                    
                                 
                              
                            and the length of the spline generated in the knot interval 
                              
                                 [
                                 0
                                 
                                 1
                                 ]
                              
                            can be obtained as the integral of the right-hand side in Eq. (11). Unlike in the quadratic case, for a cubic spline, the analytical form of the integral as a function of 
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                            is not known and it is not possible to find analytical expressions for the difference between the total length of the control polygon and B-spline curve length. The length difference is a surface (being a function of 
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                           ) and can always be found using numerical integration. We can, however, obtain useful approximations to the integral by considering the following: 
                              
                                 •
                                 We consider the effect of change of one angle at a time, i.e., 
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                     is varied with 
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                       
                                     held constant. This is reasonable since during the motion of the control polygon, the angles between the adjacent segments are monitored. When the difference in length between spline and control polygon due to a single angle change becomes large, subdivision is used to reduce the difference (see Section  3) and hence effect of change in one included angle can be considered.

We consider the case of a control polygon with equal lengths, i.e., 
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       L
                                    .

@&#SUMMARY@&#

We can summarize the results obtained from the quadratic and cubic B-splines as follows:
                              
                                 •
                                 For a quadratic B-spline, we can obtain closed-form analytic expression for the curve length as a function of the angle between the adjacent segments. For any angle 
                                       θ
                                     the change in curve length from the completely stretched out case (
                                       θ
                                       =
                                       π
                                    ) can be obtained using Eq. (A.1) as 
                                       
                                          (14)
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   
                                                      quadratic B
                                                   
                                                   -
                                                   
                                                      spline
                                                   
                                                
                                             
                                             =
                                             l
                                             
                                                (
                                                π
                                                )
                                             
                                             −
                                             l
                                             
                                                (
                                                θ
                                                )
                                             
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                l
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 

The difference between the length of the control polygon, 
                                       
                                          
                                             L
                                          
                                          
                                             
                                                CP
                                             
                                          
                                       
                                       =
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             i
                                          
                                       
                                    , and the length of the curve 
                                       
                                          
                                             L
                                          
                                          
                                             C
                                          
                                       
                                     is given by 
                                       
                                          (15)
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   C
                                                
                                             
                                             =
                                             
                                                
                                                   L
                                                
                                                
                                                   
                                                      CP
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   L
                                                
                                                
                                                   C
                                                
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                (
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 

For a cubic B-spline, there is no known closed-form analytic expression for the curve length as a function of the two angles between the three consecutive segments. The length of the curve can be obtained by integrating Eq. (11) and a numerical plot of change in length with respect to one or both angles can be obtained.

A first-order approximation of the difference between the length of cubic spline and the length of the generating control polygon, with one angle held constant and equal control polygon segment lengths, can be obtained as shown in Eq. (13). The first-order approximation is conservative to within a maximum of 3.73% difference from the exact length difference obtained from integration.

It can be seen by comparing the plots in Fig. 5 that a cubic spline gives less length difference when the angle between two adjacent segments change—for a 
                                       θ
                                     value of 100° the length difference for a quadratic spline is 15% whereas for a cubic spline it is 10%. A consequence of this result is that less number of subdivisions (see Section  3) may be required during the motion of the flexible 1D object when it is modeled with cubic splines.

Although the plots in Fig. 5 are for equal control polygon segment lengths, they serve as a design tool whereby the user can choose a threshold angle to limit the change in curve length within desirable limits.

When a curve is modeled using cubic splines, non-trivial continuity is guaranteed till third order which implies curvature continuity. Majority of real-world problems demand a maximum of curvature continuity or lesser and hence, the results have been obtained only for a quadratic and cubic spline. However, first-order results along similar lines as the cubic spline can also be developed for higher-order splines.

As discussed in Section  2.2, error in length of the B-spline curve from an initial value can be related to the included angle 
                        θ
                      between two adjacent segments. The key idea in approximate length preservation is to sub-divide a segment of the control polygon when the included angle between two adjacent segments is less than a threshold value and merge the two adjacent segments when the included angle is larger than another threshold value. In the subdivision step, the control polygon is modified by inserting control points as illustrated in Fig. 6
                     . As shown, the segment 
                        
                           
                              P
                           
                           
                              1
                           
                        
                        
                           
                              P
                           
                           
                              2
                           
                        
                      in Fig. 6(a) is replaced by two segments 
                        
                           
                              P
                           
                           
                              1
                           
                        
                        
                           
                              P
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              P
                           
                           
                              2
                           
                        
                        
                           
                              P
                           
                           
                              3
                           
                        
                      in Fig. 6(b) with the original segment 
                        
                           
                              P
                           
                           
                              1
                           
                        
                        
                           
                              P
                           
                           
                              2
                           
                        
                      shown as 
                        
                           
                              P
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        
                           
                              P
                           
                           
                              2
                           
                           
                              ′
                           
                        
                     . From the construction and using triangle inequality in Fig. 6(b), 
                        
                           |
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           
                              
                                 P
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           |
                        
                        +
                        
                           |
                           
                              
                                 P
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           |
                        
                        ≤
                        
                           |
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           |
                        
                     . Likewise 
                        
                           |
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           
                              
                                 P
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           |
                        
                        +
                        
                           |
                           
                              
                                 P
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                           |
                        
                        ≤
                        
                           |
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                           |
                        
                     . Hence the length of control polygon 
                        
                           
                              P
                           
                           
                              0
                           
                        
                        
                           
                              P
                           
                           
                              1
                           
                        
                        
                           
                              P
                           
                           
                              2
                           
                        
                        
                           
                              P
                           
                           
                              3
                           
                        
                        
                           
                              P
                           
                           
                              4
                           
                        
                      after subdivision is less than the length of the original control polygon 
                        
                           
                              P
                           
                           
                              0
                           
                        
                        
                           
                              P
                           
                           
                              1
                           
                        
                        
                           
                              P
                           
                           
                              2
                           
                        
                        
                           
                              P
                           
                           
                              3
                           
                        
                     . If the segments 
                        
                           
                              P
                           
                           
                              1
                           
                        
                        
                           
                              P
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              P
                           
                           
                              2
                           
                        
                        
                           
                              P
                           
                           
                              3
                           
                        
                      are further subdivided, as in Fig. 6(c), the total length of the modified control polygon will decrease even more. In the limit of infinite number of subdivisions, the length of control polygon will coincide with the length of the curve.

One effect of subdivision is that the number of control points (and the number of segments) monotonically increases over time depending on the extent of bending/warping of the control polygon during the motion and this increases the computation requirement in the tractrix based motion algorithm. To overcome this problem, we reduce the number of segments in the control polygon when parts of the control polygon stretches out and the included angle is larger than a pre-defined threshold. The reduction in the number of segments is schematically opposite of subdivision—the sequence for merging is from right to left in Fig. 6. Note that during merging the length of the resulting control polygon increases.

We discuss in detail and present mathematical results for subdivision and merging in the rest of this Section.


                        Fig. 7
                        (a) shows subdivision (also called knot insertion). Assuming the control polygon segments are of lengths 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                         and the included angle is 
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                        , the length of the portion of control polygon before subdivision (
                           
                              
                                 L
                              
                              
                                 
                                    
                                       
                                          CP
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        ) and the length after subdivision (
                           
                              
                                 L
                              
                              
                                 
                                    
                                       
                                          CP
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                           
                        ) is given by 
                           
                              (16)
                              
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 c
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 d
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       3
                                    
                                 
                                 
                                 
                                    (
                                    0
                                    <
                                    
                                       (
                                       c
                                       ,
                                       d
                                       )
                                    
                                    <
                                    1
                                    )
                                 
                                 ,
                              
                           
                         where by using law of cosines 
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   (
                                                   1
                                                   −
                                                   c
                                                   )
                                                
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                (
                                                
                                                   (
                                                   1
                                                   −
                                                   d
                                                   )
                                                
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       2
                                       
                                          (
                                          1
                                          −
                                          c
                                          )
                                       
                                       
                                          (
                                          1
                                          −
                                          d
                                          )
                                       
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         and 
                           c
                        , 
                           d
                         are the ratios for subdivision which can be chosen by user. Hence, the decrease in length of the control polygon after subdivision is given by 
                           
                              (17)
                              
                                 
                                    Δ
                                 
                                 
                                    
                                       L
                                    
                                    
                                       
                                          CP
                                       
                                    
                                 
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    1
                                    −
                                    c
                                    )
                                 
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    (
                                    1
                                    −
                                    d
                                    )
                                 
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   (
                                                   1
                                                   −
                                                   c
                                                   )
                                                
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                (
                                                
                                                   (
                                                   1
                                                   −
                                                   d
                                                   )
                                                
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       2
                                       
                                          (
                                          1
                                          −
                                          c
                                          )
                                       
                                       
                                          (
                                          1
                                          −
                                          d
                                          )
                                       
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         From the above, as the portion of the control polygon stretches out and the included angle 
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                           →
                           π
                        , the change in length of the control polygon 
                           
                              
                                 lim
                              
                              
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 →
                                 π
                              
                           
                           
                              Δ
                           
                           
                              
                                 L
                              
                              
                                 
                                    CP
                                 
                              
                           
                           →
                           0
                        .

During subdivision, the length of the spline curve remains the same. As mentioned earlier, the length of the control polygon, 
                           
                              
                                 L
                              
                              
                                 
                                    CP
                                 
                              
                           
                        , is more than the length of the spline curve, 
                           
                              
                                 L
                              
                              
                                 C
                              
                           
                        , and we can write 
                           
                              (18)
                              
                                 
                                    
                                       L
                                    
                                    
                                       
                                          CP
                                       
                                    
                                 
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       C
                                    
                                 
                                 +
                                 e
                                 ,
                              
                           
                         where 
                           e
                           ≥
                           0
                         is the difference in length between the control polygon and the spline curve. During subdivision, the length of the spline curve is not changed, and from Eqs. (17) and (18), we get 
                           
                              (19)
                              
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ≤
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       e
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       e
                                    
                                    
                                       0
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 e
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                         are the length differences before and after subdivision, respectively.

The above proves that the length difference between spline curve and control polygon decreases during a subdivision. Most importantly, the angles between the adjacent segments of the control polygon increases, and, as shown in Fig. 5, increasing the angle reduces the difference in the length between the spline curve and the control polygon. Hence, through subdivision, it is possible to control spline length by setting a threshold angle value 
                           
                              
                                 θ
                              
                              
                                 t
                                 h
                              
                           
                        . If the angle between any two segments is less than this threshold (
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                           ≤
                           
                              
                                 θ
                              
                              
                                 t
                                 h
                              
                           
                        ), then the control polygon is subdivided to obtain two new control points. As 
                           
                              
                                 θ
                              
                              
                                 t
                                 h
                              
                           
                         increases, length difference on any elemental segment reduces which in turn reduces the total difference in length. Hence the threshold angle plays a key role in the total difference between length of the control polygon and curve. From the analytical results in the previous section and from Fig. 5, a suitable 
                           
                              
                                 θ
                              
                              
                                 t
                                 h
                              
                           
                         can be chosen to satisfy a desired length error requirement. In extensive simulation (see Section  4), it is observed that a threshold angle of 140° is found to give total difference less than 5%.

When two adjacent segments of a control polygon are merged (by knot removal), the number of segments in the control polygon will reduce and the computations required for the tractrix based motion algorithm will reduce. Knot removal is shown schematically in Fig. 7(b). As mentioned earlier, in case of knot removal, the length of the control polygon increases and the length before and after knot removal can be written as 
                           
                              (20)
                              
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       3
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       3
                                    
                                 
                                 .
                              
                           
                         But we know that 
                           
                              
                                 θ
                              
                              
                                 i
                              
                              
                                 p
                              
                           
                           =
                           
                              (
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           −
                           π
                         and by using the law of sines, 
                           
                              (21)
                              
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       sin
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       sin
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       L
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       sin
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       sin
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         From Eqs. (20) and (21), the increase in length of the control polygon can be computed as 
                           
                              (22)
                              
                                 
                                    Δ
                                 
                                 
                                    
                                       L
                                    
                                    
                                       
                                          CP
                                       
                                    
                                 
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       sin
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       sin
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       sin
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       sin
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         Unlike subdivision, the increase in the length of the control polygon is a function of two angles 
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                         and thus lies on a surface. When 
                           
                              (
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           →
                           π
                        , 
                           
                              
                                 lim
                              
                              
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 →
                                 π
                              
                           
                           
                              Δ
                           
                           
                              
                                 L
                              
                              
                                 
                                    CP
                                 
                              
                           
                           →
                           0
                         and we can infer that knot removal should be done when the 
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                         are close to 
                           π
                        .

Knot removal has the additional complexity of not yielding a unique solution/curve (see pp. 179 in  [27] for further details). As shown in Fig. 8
                        , there are two possible solutions (red and blue) for the merged spline curves, which can be derived from the original spline (black). The length of the two spline curves can be computed by integration, and are denoted by 
                           
                              
                                 L
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         and 
                           
                              
                                 L
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        . We denote the control polygon and curve length before merging by 
                           
                              
                                 L
                              
                              
                                 
                                    CP
                                 
                              
                           
                         and 
                           
                              
                                 L
                              
                              
                                 C
                              
                           
                        , respectively. Since merging increases the length of the control polygon, we can write 
                           
                              (23)
                              
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ≥
                                 
                                    
                                       L
                                    
                                    
                                       
                                          CP
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ≥
                                 
                                    
                                       L
                                    
                                    
                                       
                                          CP
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       e
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             
                                                CP
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       e
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where the two control lengths are denoted by 
                           
                              
                                 L
                              
                              
                                 
                                    
                                       
                                          CP
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                           
                        , 
                           
                              
                                 L
                              
                              
                                 
                                    
                                       
                                          CP
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        , and the difference between the curve length and the control polygon length are denoted by 
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                        . As the length of the two control polygons is known, the terms 
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                         can be computed and the solution with lower difference between the spline and control polygon length is chosen as the new curve definition. For a knot of multiplicity 2 to be removed once, the condition to be satisfied is that two points given below 
                           
                              (24)
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                α
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                       1
                                       −
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         with 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 −
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 
                                    
                                       u
                                    
                                    
                                       4
                                    
                                 
                                 −
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         and 
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 −
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    
                                       u
                                    
                                    
                                       5
                                    
                                 
                                 −
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         must coincide  [27]. As shown in Fig. 8, the two points-
                           
                              
                                 P
                              
                              
                                 s
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 s
                              
                              
                                 2
                              
                           
                        , lie on the vector directed along 
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ⃗
                              
                           
                         and 
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                              
                              
                                 ⃗
                              
                           
                        . Substituting for points 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 
                                    [
                                    
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                    
                                    0
                                    ]
                                 
                              
                              
                                 T
                              
                           
                           ,
                           
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 
                                    [
                                    0
                                    
                                    0
                                    ]
                                 
                              
                              
                                 T
                              
                           
                        , 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                           =
                           
                              
                                 
                                    [
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    cos
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                    
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    sin
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                    ]
                                 
                              
                              
                                 T
                              
                           
                        , and 
                           
                              
                                 P
                              
                              
                                 4
                              
                           
                           =
                           
                              
                                 
                                    [
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    cos
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          L
                                       
                                       
                                          3
                                       
                                    
                                    cos
                                    
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    sin
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          L
                                       
                                       
                                          3
                                       
                                    
                                    sin
                                    
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ]
                                 
                              
                              
                                 T
                              
                           
                        , we get 
                           
                              (25)
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             4
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             −
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    ]
                                 
                                 
                                 and
                                 
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             5
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             cos
                                             
                                                
                                                   θ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      5
                                                   
                                                
                                                −
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   L
                                                
                                                
                                                   3
                                                
                                             
                                             cos
                                             
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      3
                                                   
                                                
                                                −
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             sin
                                             
                                                
                                                   θ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      5
                                                   
                                                
                                                −
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   L
                                                
                                                
                                                   3
                                                
                                             
                                             sin
                                             
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      3
                                                   
                                                
                                                −
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         Since merging is done only when both the angles 
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                         cross the threshold angle, the limiting case can be taken as 
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 θ
                              
                              
                                 m
                              
                           
                        . For equi-spaced knots, the above equation simplifies to 
                           
                              (26)
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             −
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    ]
                                 
                                 
                                 and
                                 
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             cos
                                             
                                                
                                                   θ
                                                
                                                
                                                   m
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   3
                                                
                                             
                                             cos
                                             2
                                             
                                                
                                                   θ
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             sin
                                             
                                                
                                                   θ
                                                
                                                
                                                   m
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   3
                                                
                                             
                                             sin
                                             2
                                             
                                                
                                                   θ
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                        Fig. 9
                         shows the two points 
                           
                              
                                 P
                              
                              
                                 s
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 s
                              
                              
                                 2
                              
                           
                         that define the two control polygons respectively. We can make the following observations from the above analysis: 
                           
                              •
                              If link lengths 
                                    
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          L
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    L
                                 , then in the limiting case mentioned above (
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          θ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          θ
                                       
                                       
                                          m
                                       
                                    
                                 ), the portion of spline shown in Fig. 9 is symmetric about an axis 
                                    A
                                    A
                                  passing through the midpoint of points 
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                  and 
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                 . The lengths of the two curves are equal and either of the two curves can be chosen after merging. The two curves and the length difference due to merging as a function of 
                                    
                                       
                                          θ
                                       
                                       
                                          m
                                       
                                    
                                  are shown in Fig. 10
                                 .

In a more generic case, where 
                                    
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                    ≠
                                    
                                       
                                          L
                                       
                                       
                                          3
                                       
                                    
                                 , the two solutions are not symmetrical. This is shown in Fig. 11
                                  for arbitrarily chosen control polygon segment lengths 
                                    
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    1
                                 , 
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    3
                                  and 
                                    
                                       
                                          L
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    4
                                 . The difference between the curve length and the control polygon is shown in Fig. 11(b); during simulations we noted that the smaller of the two differences is chosen.

The variation in length with change in included angle shown in Fig. 11 can be numerically computed and generated for other combination of lengths. Similar to subdivision, the plot of length difference versus 
                                    
                                       
                                          θ
                                       
                                       
                                          m
                                       
                                    
                                  can be used to choose the threshold angle for merging. From extensive numerical simulations (see also Section  4), it was observed that an angle of 160° for merging (knot removal) resulted in a total spline curve length error of less than 5%.

Based on the analysis in Sections  3.1 and 3.2, the algorithm followed for approximate length preserving configuration planning for a flexible 1D body is summarized in the flowchart of Fig. 12
                        . The inputs to the algorithm are the initial curve configuration, the path (curve) along which the leading end is moved, the velocity of the motion and location of the perturbed point on the curve. Based on these data, the initial control polygon configuration and the open uniform knot vectors are derived and initialized into the algorithm. The output is the motion of the flexible 1D object.


                        
                           
                              1.
                              Obtain the control polygon by interpolating the vertices/points in the input polyline. The number of segments in the control polygon is taken to be 
                                    n
                                 , degree 3 and a clamped open uniform knot vector is used. The maximum deviation between the curve and the points is set to a predefined threshold for terminating the interpolation algorithm.

Initialize length parametrized motion of the leading end and discretized it for smooth visualization of motion.

For each incremental motion, starting from leading segment, recursively obtain the motion of all segments using the tractrix equations.

Perform threshold crossover checks for each included angle in the control polygon and execute subdivision or knot removal algorithms.

Update the new control polygon configurations and knot vectors and continue to next incremental motion of the leading end.

Repeat steps 3, 4 and 5 till the full motion of leading end is completed.

We present numerical simulation results for a chosen 1D (1D) flexible object 5 units in length. All simulations were done using the commercial software MATLAB  [28] on a PENTIUM quad core PC with 16 Gb RAM running the LINUX operating system. The first two simulations are for an arbitrarily chosen 2D path of the leading end and there are two 3D simulation. We present simulation results for an exact length preserving tractrix based algorithm (labeled as TRX), an approximate length preserving tractrix and spline based algorithm with subdivision (labeled as 
                        
                           TRX
                        
                        _
                        
                           SD
                        
                     ) and finally an approximate length preserving tractrix and spline based algorithm with subdivision and knot removal (labeled as 
                        
                           TRX
                        
                        _
                        
                           SD
                        
                        _
                        
                           MRG
                        
                     ). In all the simulations the initial configuration of the flexible 1D object is a straight line—there is no restriction on the initial configuration and it is chosen as a straight line to ensure that the initial length error between the actual object and the discretized object/curve is zero.

In the first simulation, the leading end is moved along an arbitrarily chosen 2D path in steps of 0.5 length units over 52 steps. The arbitrary path is shown in Fig. 13
                     (a). Along the path, seven arbitrary snapshot locations are chosen and these are denoted by 
                        
                      through ⑥. The configuration of the flexible 1D object at each of the seven snapshot locations of the leading end is shown in Fig. 13(b)—as mentioned at the start the flexible 1D object is a straight line (see configuration 
                        
                     in Fig. 13(a)). The configuration of the flexible 1D object computed according to the three algorithms, namely TRX, 
                        
                           TRX
                        
                        _
                        
                           SD
                        
                      and 
                        
                           TRX
                        
                        _
                        
                           SD
                        
                        _
                        
                           MRG
                        
                     , are shown in Fig. 13(b).

In the purely tractrix (TRX) algorithm, the flexible 1D object needs to be discretized into a large number of linear segments to realistically represent the continuous flexible 1D object and to make the motion look smooth. As the number of linear segments, 
                        n
                     , increases, the computations, as expected, grow in a 
                        O
                        
                           (
                           n
                           )
                        
                      manner—the simulation time grows from 40 s for 
                        n
                        =
                        10
                      to about 1680s for 
                        n
                        =
                        200
                     . In Fig. 13(b), the configuration simulations for the tractrix based simulations are done for 
                        n
                        =
                        20
                     .

For the approximate length preserving tractrix and spline based algorithms (
                        
                           TRX
                        
                        _
                        
                           SD
                        
                      and 
                        
                           TRX
                        
                        _
                        
                           SD
                        
                        _
                        
                           MRG
                        
                     ), the initial number of linear segments in the control polygon is chosen as 6 and the angle threshold for subdivision was chosen as 140°. The threshold angle for removing a control point/knot was chosen as 160°. Snapshots of the curve for different points on the chosen path are shown in Fig. 13(b) for illustrating the qualitative nature of the results. As mentioned the maximum percentage length difference depends on the chosen threshold angle (140° for subdivision and 160° for knot removal in this simulation) and the number of control points required to ensure that the angle threshold is not exceeded, in this case, turns out to be 20 for subdivision algorithm and 18 for subdivision with merging algorithm as seen from Fig. 14
                     . The maximum error introduced by merging at any instant over the whole simulation is 1.8%.


                     Fig. 14(b) shows the variation of curve length and Fig. 14(a) shows number of control points in the control polygon backbone over the simulation duration. As seen, the algorithm adapts to the characteristics of the motion by adding control points as and when required to compensate for the warping of the curve. It also removes control points as and when the curve can be simplified and represented in terms of a lesser number of control points. From the figures, it is observed that the maximum number of control points to represent the curve over the complete duration of simulation is 17 for TRX_SD_MRG algorithm.

Intuitively, the higher the number of control points chosen initially, the lesser will be the error in length between control polygon and the spline. This is demonstrated in Table 1
                      in which results of TRX_SD_MRG simulation run on the planar curve input as 20 line segments is shown. As seen in the results, as the initial number of control points increases, the error in total length over the whole simulation comes down significantly to 4.90%. However, as seen in the results, the number of line segments in the backbone also increases accordingly. Finally, to see the effect of the threshold angle, we performed the 
                        
                           TRX
                        
                        _
                        
                           SD
                        
                        _
                        
                           MRG
                        
                      simulations on the generic planar curve discretized into 20 segments with different threshold angles for subdivision and knot removal. The results are given in Table 2
                     . Clearly, as the threshold angle increases, the curve sub-divides more frequently thereby resulting in more number of sides in the control polygon. However, the length error keeps on reducing with higher thresholds because the curve subdivides more to keep the length difference within bounds. The simulation results illustrate the theoretical results developed earlier in Section  3.

It may be mentioned that the actual numbers for length error and control points will vary based on the motion. However, the algorithm adaptively computes the lowest number of control points to effectively represent the curve respecting the prescribed error bounds. To illustrate this, a slightly modified trajectory of the leading end is chosen as shown in Fig. 15
                     . In this trajectory at the end there exists a longer straight segment. The results for the simulation for the new motion are shown below and in the attached video (see file mmc1.mp4). The number of segments initially chosen was 20 and the merging thresholds are relaxed to 
                        150
                        °
                     . Other parameters were kept exactly the same as before. As expected, due to the presence of straight trajectory towards the end, the number of control points further reduce to 12 when compared to 18 in the earlier case (see Fig. 16
                     (a)). However, due to relaxed merging threshold, the maximum error introduced by merging is now seen to be 4% (see Fig. 16(b)). The numerical results shown in above figures and in the video clearly shows that the spline based algorithm results in a more natural motion together with a significant reduction in computation time. Additionally, the spline based algorithm is tunable for tolerances on length error specified by user requirements via the threshold values of the angles and the initial number of control points.

The algorithm is easily extendable to three dimensional space without any significant modifications. Fig. 17
                      shows the input desired motion of the leading end and simulated snapshots of motion of the complete flexible 1D object using the adaptive spline based subdivision algorithm proposed in this paper for a generic motion in three dimensions (see video file mmc2.mp4). In the attached video mmc3.mp4, three simulations are shown for a flexible 1D object of length 60 units and whose leading end is moved along an arbitrary path in 3D space (see Appendix A). In the video, the left most simulation is for an exact length preserving tractrix based algorithm (TRX) where 15 linear segments are used to approximate the 1D flexible object. In the middle simulation, the number of linear segments is increased to 25 for enhanced smoothness and the right most simulation uses the approximate spline based algorithm, the path and snapshots of which are shown in Fig. 17. As shown in the video, the time for simulating with 15 segments is about 280 s while it increases to 914 s when 25 segments are used to make the motion appear more smoother. In comparison, the right most simulation shows an equally smooth motion with the approximate length preserving algorithm (difference less than 10%) in about 244 s. It may be noted that the approximate length preserving spline based algorithm takes even smaller time than the exact length preserving algorithm with 15 segments as only a 12 sided control polygon is employed initially. As mentioned in the text, the length error can be brought down below 5% if more number of sides in the initial control polygon is used—if a 15 sided control polygon is used and time required is of the order of 300 s. Table 3
                      summarizes the simulation results for the 3D trajectory of Fig. 17.

A second video (see mmc4.mp4) shows similar improvement in execution time and smoothness in motion when the leading end is moved along a completely different arbitrary trajectory (Fig. 18
                     (a)). Motion snapshots of this simulation are shown in Fig. 18(b).

@&#CONCLUSION@&#

This paper proposes a new paradigm for the simulation and rendering of the motion of 1D flexible objects. The motion of the flexible 1D objects, represented using splines, is computed using a tractrix based approach. The tractrix based approach yields a more natural and realistic motion with the motion dying out along the length of the flexible 1D object. The use of splines and adaptive modification of the control polygon leads to an approximate length preservation with efficient computation and smoother rendering of the motion of the 1D flexible object. An important feature of the proposed algorithm is that it is a purely kinematics or geometry based algorithm. It is shown that the use of splines and adaptive modification of the control polygon increases computation efficiency and the increased efficiency is more clearly observed when the number of segments in the input is large (more than 20 in the simulations shown in this work). The approach presented in this paper can be easily applied to simulation and realistic rendering of the motion of generic 1D flexible objects such as snakes, chains, ropes and for redundancy resolution in hyper-redundant robotic manipulators.

@&#ACKNOWLEDGMENT@&#

This work was funded in part by the Robert Bosch Center for Cyber–Physical Systems (RBCCPS) at the Indian Institute of Science, Bangalore.

For the general case of a quadratic spline with 
                        
                           
                              L
                           
                           
                              1
                           
                        
                        ≠
                        
                           
                              L
                           
                           
                              2
                           
                        
                     , the expression for the curve length is more complicated and is given in Box I
                     . For case when 
                        
                           
                              L
                           
                           
                              1
                           
                        
                        ≠
                        
                           
                              L
                           
                           
                              2
                           
                        
                      and 
                        θ
                        →
                        0
                      (the curve folding and overlapping with itself), the curve length is given by 
                        
                           
                              lim
                           
                           
                              θ
                              →
                              0
                           
                        
                        l
                        
                           (
                           θ
                           )
                        
                        =
                        
                           
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                           
                           
                              2
                              
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        
                     . In the case of 
                        
                           
                              L
                           
                           
                              1
                           
                        
                        ≠
                        
                           
                              L
                           
                           
                              2
                           
                        
                      and 
                        θ
                        →
                        π
                      (curve straightening out to a line), we have 
                        
                           
                              lim
                           
                           
                              θ
                              →
                              π
                           
                        
                        l
                        
                           (
                           θ
                           )
                        
                        =
                        
                           (
                           1
                           /
                           2
                           )
                        
                        
                           (
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           )
                        
                     , which is another well known result for a quadratic B-spline curve (see pp. 78,  [27]). From the analytical expression of 
                        l
                        
                           (
                           θ
                           )
                        
                      in Eq. (A.1), the maximum and minimum curve length occurs when 
                        θ
                        →
                        π
                      and when 
                        θ
                        →
                        0
                     , respectively.


                     Fig. 19
                      shows four points 
                        
                           
                              P
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              P
                           
                           
                              2
                           
                        
                     , 
                        
                           
                              P
                           
                           
                              3
                           
                        
                     , 
                        
                           
                              P
                           
                           
                              4
                           
                        
                      and the two included angles 
                        
                           
                              θ
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              θ
                           
                           
                              2
                           
                        
                      between the three segments of a control polygon for a cubic spline. The first three points define a plane and the fourth point can lie anywhere on a cone with apex at 
                        
                           
                              P
                           
                           
                              3
                           
                        
                      and slant length 
                        
                           |
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                           
                              
                                 P
                              
                              
                                 4
                              
                           
                           |
                        
                      equal to 
                        
                           
                              L
                           
                           
                              3
                           
                        
                     . We denote the vector on the surface of the cone along 
                        
                           
                              P
                           
                           
                              3
                           
                        
                        
                           
                              P
                           
                           
                              4
                           
                        
                      by 
                        
                           
                              V
                           
                           
                              ⃗
                           
                        
                        
                           (
                           α
                           )
                        
                     , where 
                        α
                      is the angle of rotation about an unit vector 
                        
                           
                              n
                           
                           
                              ˆ
                           
                        
                      along the cone axis lying along 
                        
                           
                              P
                           
                           
                              2
                           
                        
                        
                           
                              P
                           
                           
                              3
                           
                        
                     . For 
                        α
                        =
                        0
                     , the point 
                        
                           
                              P
                           
                           
                              4
                           
                        
                     , denoted by 
                        
                           
                              P
                           
                           
                              4
                           
                        
                        
                           (
                           0
                           )
                        
                     , lies on the plane formed by 
                        
                           
                              P
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              P
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              P
                           
                           
                              3
                           
                        
                      and the vector from 
                        
                           
                              P
                           
                           
                              3
                           
                        
                      to 
                        
                           
                              P
                           
                           
                              4
                           
                        
                        
                           (
                           0
                           )
                        
                      is denoted by 
                        
                           
                              V
                              
                                 (
                                 0
                                 )
                              
                           
                           
                              ⃗
                           
                        
                     . From Fig. 19, the angle between 
                        
                           
                              n
                           
                           
                              ˆ
                           
                        
                      and 
                        
                           
                              V
                              
                                 (
                                 0
                                 )
                              
                           
                           
                              ⃗
                           
                        
                      is seen to be 
                        π
                        −
                        
                           (
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           )
                        
                      and we can write 
                        
                           (B.1)
                           
                              
                                 
                                    V
                                 
                                 
                                    ⃗
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                              =
                              
                                 
                                    
                                       [
                                       −
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       cos
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                       −
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       sin
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                       0
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              .
                           
                        
                      The vector 
                        
                           
                              V
                              
                                 (
                                 α
                                 )
                              
                           
                           
                              ⃗
                           
                        
                      can be obtained as 
                        
                           (B.2)
                           
                              
                                 
                                    V
                                    
                                       (
                                       α
                                       )
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              =
                              R
                              
                                 (
                                 α
                                 )
                              
                              
                                 
                                    V
                                    
                                       (
                                       0
                                       )
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              ,
                           
                        
                      where 
                        R
                        
                           (
                           α
                           )
                        
                      is a rotation matrix given by the Rodrigues’ rotation formula 
                        
                           (B.3)
                           
                              R
                              
                                 (
                                 α
                                 )
                              
                              =
                              
                                 
                                    I
                                 
                                 
                                    3
                                 
                              
                              +
                              
                                 (
                                 sin
                                 α
                                 )
                              
                              K
                              +
                              
                                 (
                                 1
                                 −
                                 cos
                                 α
                                 )
                              
                              
                                 
                                    K
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                      with 
                        
                           
                              I
                           
                           
                              3
                           
                        
                      denoting a 3×3 identity matrix and 
                        
                           [
                           K
                           ]
                        
                      given by 
                        
                           
                              K
                              =
                              
                                 [
                                 
                                    
                                       
                                          0
                                       
                                       
                                          −
                                          
                                             
                                                n
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          −
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                 
                                 ]
                              
                              ,
                           
                        
                      is a skew-symmetric matrix which represents the cross product operation with vector 
                        
                           
                              n
                           
                           
                              ˆ
                           
                        
                        =
                        
                           
                              
                                 [
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                                 ]
                              
                           
                           
                              T
                           
                        
                     .

From Fig. 19, the vector 
                        
                           
                              n
                           
                           
                              ˆ
                           
                        
                      is given by 
                        
                           
                              
                                 [
                                 cos
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 sin
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 0
                                 ]
                              
                           
                           
                              T
                           
                        
                      and we can write the vector locating the point 
                        
                           
                              P
                           
                           
                              4
                           
                        
                        
                           (
                           α
                           )
                        
                      with respect to the origin of the coordinate system 
                        O
                      (or 
                        
                           
                              P
                           
                           
                              2
                           
                        
                     ) as 
                        
                           (B.4)
                           
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          4
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              
                                 (
                                 α
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              +
                              R
                              
                                 (
                                 α
                                 )
                              
                              
                                 
                                    V
                                 
                                 
                                    ⃗
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          4
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                              +
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          P
                                       
                                       
                                          4
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              
                                 (
                                 α
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          P
                                       
                                       
                                          4
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              
                                 (
                                 α
                                 )
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                3
                                             
                                          
                                          sin
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          sin
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             cos
                                             α
                                             −
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       
                                          −
                                          
                                             
                                                L
                                             
                                             
                                                3
                                             
                                          
                                          cos
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          sin
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             cos
                                             α
                                             −
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       
                                          −
                                          
                                             
                                                L
                                             
                                             
                                                3
                                             
                                          
                                          sin
                                          
                                             
                                                θ
                                             
                                             
                                                2
                                             
                                          
                                          sin
                                          α
                                       
                                    
                                 
                                 ]
                              
                              .
                           
                        
                      Using the above, the expression for the spline can be written as 
                        
                           (B.5)
                           
                              C
                              
                                 (
                                 u
                                 ,
                                 α
                                 )
                              
                              =
                              
                                 
                                    N
                                 
                                 
                                    1
                                    ,
                                    3
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    2
                                    ,
                                    3
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    3
                                    ,
                                    3
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    4
                                    ,
                                    3
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 (
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                       ⃗
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             P
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                       ⃗
                                    
                                 
                                 
                                    (
                                    α
                                    )
                                 
                                 )
                              
                              ,
                           
                        
                      and its derivative can be written as 
                        
                           (B.6)
                           
                              
                                 
                                    C
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 α
                                 )
                              
                              =
                              
                                 
                                    N
                                 
                                 
                                    1
                                    ,
                                    3
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                                 ]
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    3
                                    ,
                                    3
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          cos
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          sin
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                                 ]
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    4
                                    ,
                                    3
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 (
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             cos
                                             
                                                
                                                   θ
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   L
                                                
                                                
                                                   3
                                                
                                             
                                             cos
                                             
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             sin
                                             
                                                
                                                   θ
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   L
                                                
                                                
                                                   3
                                                
                                             
                                             sin
                                             
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   3
                                                
                                             
                                             sin
                                             
                                                
                                                   θ
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             
                                                
                                                   θ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                cos
                                                α
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   L
                                                
                                                
                                                   3
                                                
                                             
                                             cos
                                             
                                                
                                                   θ
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             
                                                
                                                   θ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                cos
                                                α
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   L
                                                
                                                
                                                   3
                                                
                                             
                                             sin
                                             
                                                
                                                   θ
                                                
                                                
                                                   2
                                                
                                             
                                             sin
                                             α
                                          
                                       
                                    
                                    ]
                                 
                                 )
                              
                              .
                           
                        
                      When the spline lies in a plane and 
                        
                           
                              
                                 Δ
                              
                              
                                 
                                    P
                                 
                                 
                                    4
                                 
                              
                           
                           
                              ⃗
                           
                        
                        
                           (
                           0
                           )
                        
                        =
                        0
                     , the spline can be written as 
                        
                           (B.7)
                           
                              C
                              
                                 (
                                 u
                                 ,
                                 0
                                 )
                              
                              =
                              
                                 
                                    N
                                 
                                 
                                    1
                                    ,
                                    3
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    2
                                    ,
                                    3
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    3
                                    ,
                                    3
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    4
                                    ,
                                    3
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          4
                                       
                                    
                                 
                                 
                                    ⃗
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                              ,
                           
                        
                      and the derivative can be written as 
                        
                           (B.8)
                           
                              
                                 
                                    C
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 0
                                 )
                              
                              =
                              
                                 
                                    N
                                 
                                 
                                    1
                                    ,
                                    3
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                                 ]
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    3
                                    ,
                                    3
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          cos
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          sin
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                                 ]
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    4
                                    ,
                                    3
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          cos
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                L
                                             
                                             
                                                3
                                             
                                          
                                          cos
                                          
                                             (
                                             
                                                
                                                   θ
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   θ
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          sin
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                L
                                             
                                             
                                                3
                                             
                                          
                                          sin
                                          
                                             (
                                             
                                                
                                                   θ
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   θ
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                                 ]
                              
                              .
                           
                        
                      The square of the elemental length of the cubic spline is given by 
                        
                           
                              d
                              l
                              
                                 
                                    
                                       (
                                       α
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    
                                       (
                                       u
                                       ,
                                       α
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    C
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 α
                                 )
                              
                              d
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              =
                              d
                              l
                              
                                 
                                    
                                       (
                                       0
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              2
                              
                                 
                                    N
                                 
                                 
                                    4
                                    ,
                                    3
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 
                                    L
                                 
                                 
                                    3
                                 
                              
                              sin
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              sin
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 cos
                                 α
                                 −
                                 1
                                 )
                              
                              
                                 
                                    X
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 0
                                 )
                              
                              +
                              
                                 
                                    
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             4
                                             ,
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       sin
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       sin
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          cos
                                          α
                                          −
                                          1
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              −
                              2
                              
                                 
                                    N
                                 
                                 
                                    4
                                    ,
                                    3
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 
                                    L
                                 
                                 
                                    3
                                 
                              
                              cos
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              sin
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 cos
                                 α
                                 −
                                 1
                                 )
                              
                              
                                 
                                    Y
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 0
                                 )
                              
                              +
                              
                                 
                                    
                                       (
                                       −
                                       
                                          
                                             N
                                          
                                          
                                             4
                                             ,
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       cos
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       sin
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          cos
                                          α
                                          −
                                          1
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       (
                                       −
                                       
                                          
                                             N
                                          
                                          
                                             4
                                             ,
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       
                                          
                                             L
                                          
                                          
                                             3
                                          
                                       
                                       sin
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                       
                                       sin
                                       α
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                      where 
                        
                           (
                           
                              
                                 X
                              
                              
                                 ′
                              
                           
                           
                              (
                              u
                              ,
                              0
                              )
                           
                           ,
                           
                              
                                 Y
                              
                              
                                 ′
                              
                           
                           
                              (
                              u
                              ,
                              0
                              )
                           
                           )
                        
                      denote the 
                        X
                      and 
                        Y
                      components of 
                        
                           
                              C
                           
                           
                              ′
                           
                        
                        
                           (
                           u
                           ,
                           0
                           )
                        
                        –
                        
                           
                              Z
                           
                           
                              ′
                           
                        
                        
                           (
                           u
                           ,
                           0
                           )
                        
                      is zero from Eq. (B.8). The above equation on simplifying gives 
                        
                           (B.9)
                           
                              d
                              l
                              
                                 
                                    
                                       (
                                       α
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              d
                              l
                              
                                 
                                    
                                       (
                                       0
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              2
                              
                                 
                                    N
                                 
                                 
                                    1
                                    ,
                                    3
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    4
                                    ,
                                    3
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    L
                                 
                                 
                                    3
                                 
                              
                              sin
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              sin
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 cos
                                 α
                                 −
                                 1
                                 )
                              
                              ,
                           
                        
                      and by using the Cauchy–Schwarz inequality, we can write 
                        
                           (B.10)
                           
                              d
                              l
                              
                                 (
                                 α
                                 )
                              
                              −
                              d
                              l
                              
                                 (
                                 0
                                 )
                              
                              ≤
                              
                                 
                                    2
                                    
                                       
                                          N
                                       
                                       
                                          1
                                          ,
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          4
                                          ,
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          L
                                       
                                       
                                          3
                                       
                                    
                                    sin
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                    sin
                                    
                                       
                                          θ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       cos
                                       α
                                       −
                                       1
                                       )
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        
                           (
                           cos
                           α
                           −
                           1
                           )
                        
                        ≤
                        0
                        
                        ∀
                        α
                        ∈
                        
                           [
                           0
                           
                           2
                           π
                           ]
                        
                     .

For a cubic spline, the basis functions 
                        
                           
                              N
                           
                           
                              1
                              ,
                              3
                           
                        
                     , 
                        
                           
                              N
                           
                           
                              4
                              ,
                              3
                           
                        
                      and their derivatives are given by 
                        
                           (B.11)
                           
                              
                                 
                                    N
                                 
                                 
                                    1
                                    ,
                                    3
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    6
                                 
                              
                              
                                 
                                    
                                       (
                                       1
                                       −
                                       u
                                       )
                                    
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                              
                                 
                                    N
                                 
                                 
                                    1
                                    ,
                                    3
                                 
                                 
                                    ′
                                 
                              
                              =
                              −
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       (
                                       1
                                       −
                                       u
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                              
                                 
                                    N
                                 
                                 
                                    4
                                    ,
                                    3
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    6
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                              
                                 
                                    N
                                 
                                 
                                    4
                                    ,
                                    3
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                      and hence 
                        d
                        l
                        
                           (
                           α
                           )
                        
                        −
                        d
                        l
                        
                           (
                           0
                           )
                        
                      is real and positive. Additionally, the right-hand side of Eq. (B.10) is maximum when 
                        α
                        =
                        π
                      and minimum when 
                        α
                        =
                        0
                     . The length of control polygon remains the same for all 
                        α
                      and hence the elemental length difference between the cubic spline curve and the control polygon becomes maximum when 
                        α
                        =
                        0
                     . This proves the assertion that the worst case difference between the length of the control polygon and the cubic spline is when 
                        α
                        =
                        0
                      (when the four control points lie on a plane) and we do not need to consider the four points in 3D space.

Supplementary material related to this article can be found online at http://dx.doi.org/10.1016/j.cad.2016.02.003.

The following is the Supplementary material related to this article. 
                        
                           Video S1
                           
                              Planar motion of a flexible one-dimensional object initially represented as a spline with 20 control polygon segments.
                           
                           
                        
                     
                     
                        
                           Video S2
                           
                              Spatial motion of a flexible one-dimensional object initially represented as a spline with 60 control polygon segments.
                           
                           
                        
                     
                     
                        
                           Video S3
                           
                              Comparison of simulation time for a generic spatial motion of a flexible one-dimensional object.
                           
                           
                        
                     
                     
                        
                           Video S4
                           
                              Comparison of simulation time for a different generic spatial motion of a flexible one-dimensional object.
                           
                           
                        
                     
                  

@&#REFERENCES@&#

