@&#MAIN-TITLE@&#Robust image retrieval with hidden classes

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We address a new robust problem, named hidden classes, in content-based image retrieval (CBIR).


                        
                        
                           
                           We propose a new robust CBIR scheme using multi-image queries to tackle the difficule problem.


                        
                        
                           
                           We develop a novel query detection technique to separate queries as common or novel according to their underlying classes.


                        
                        
                           
                           We apply a self-adaptive retrieval strategy to handle different types of queries automatically.


                        
                        
                           
                           We design and carry out a number of experiments to demonstrate the effectiveness of our scheme.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Content-based image retrieval

Hidden classes

Robust image retrieval

Image classification

Novel query detection

@&#ABSTRACT@&#


               
               
                  For the purpose of content-based image retrieval (CBIR), image classification is important to help improve the retrieval accuracy and speed of the retrieval process. However, the CBIR systems that employ image classification suffer from the problem of hidden classes. The queries associated with hidden classes cannot be accurately answered using a traditional CBIR system. To address this problem, a robust CBIR scheme is proposed that incorporates a novel query detection technique and a self-adaptive retrieval strategy. A number of experiments carried out on the two popular image datasets demonstrate the effectiveness of the proposed scheme.
               
            

@&#INTRODUCTION@&#

Content-based image retrieval (CBIR) is an active research area. The aim of various CBIR systems is to search images by analyzing their content. Images are normally described by their low-level features such as color, texture and shape [1,2]. In the literature, a significant amount of research has been conducted relating to CBIR [3,4]. However, the robustness of CBIR systems has not been sufficiently investigated even though the topic of robustness has been explored extensively in traditional information retrieval [5]. We have already identified and addressed unclean queries as a problem of robustness [6], however in this paper, we will study the hidden class problem of CBIR systems employing image classification as preprocessing.

The application of image classification techniques into a CBIR system results in a user’s queries being answered with images in predefined classes, thus helping to improve retrieval accuracy and speed. However, in a large-scale image collection, some image classes may be unseen [4]. We call these hidden classes as opposed predefined classes. The existence of hidden classes severely affects the retrieval accuracy of image classification based CBIR systems. There are two approaches that can address the problem of robustness. One approach is detecting hidden classes at the stage of preprocessing in order to avoid the problem of hidden classes when answering a query. The second approach is to take hidden classes into account when answering a query because different retrieval strategies can be adopted for different queries. We decided upon the second approach because it is too difficult to detect hidden classes during preprocessing without extra information.

Under the query-by-example (QBE) paradigm, there are three problems that arise due to hidden classes. When considering hidden classes, a user’s queries can be divided into two categories; a common query and a novel query. Fig. 1
                      illustrates a hidden class, common query and novel query. A common query can be answered using a predefined image class because relevant images of the common query have been gathered in this class. A novel query is associated with a hidden class and it cannot be answered using any predefined image classes. The first problem is how to identify whether a query is a common or novel query. This determination will influence the retrieval strategy. The second problem is how to predict a relevant predefined image class for a common query. The third problem is how to perform image retrieval for a novel query if it is not associated with any predefined image class. The solutions to these problems will result in a new retrieval scheme that can manage the problem of hidden classes.

In this paper, we aim to address the critical problem of hidden classes in CBIR systems. Our major contributions are summarized as follows.
                        
                           •
                           We propose a robust CBIR scheme that can incorporate multi-image queries and a support vector machine (SVM) to effectively deal with hidden classes.

We develop a novel query detection technique to determine whether a user’s query is a common or novel query, therefore making it feasible to consider hidden classes in the retrieval process.

We develop a self-adaptive retrieval strategy. For a common query, a relevant predefined image class will be predicted and the within images are ranked. For a novel query, a new method is proposed to filter out the irrelevant images before image ranking.

Finally, a number of experiments that were carried out on a Corel image dataset and the NUS-WIDE-LITE dataset [23] demonstrate the effectiveness of the proposed scheme. In particular, the improvement on precision depends on the number of hidden classes, with over 10% achieved.

The remainder of this paper is organized as follows: Section 2 reviews related work. Section 3 presents the novel CBIR scheme and discussion is provided in Section 4. In Section 5, the experimental evaluation and results are reported and the conclusion to this paper is presented in Section 6.

@&#RELATED WORK@&#

Image classification improves the accuracy and speed of a content based image retrieval (CBIR) system [4]. Images in a collection can be categorized by supervised image classification using predefined image classes. For a given query, the retrieval results of a CBIR system are generated by first locating the most relevant image followed by ranking the images within the class [7,4]. It should be noted that image classification is not necessary for all CBIR systems. A CBIR system can be entirely based on similarity retrieval without any classes. This paper focuses on CBIR systems which perform classification first.

A significant amount of research has been undertaken with the aim of improving the performance of image classification [8]. One such approach has been to develop new image matching methods and incorporate them into the training process of a multiclass classifier. For instance, spatial pyramid matching was proposed and incorporated into SVM for natural image classification [9]. Considering the trade-off between discriminative power and invariance differing from task to task, a kernel learning method was proposed in order to achieve different levels of trade-off for image classification [10]. To perform object localization, an efficient subwindow search method was proposed [11] that can be combined with a spatial pyramid kernel to improve the multiclass classifier. Another approach has been to directly enhance a multiclass classifier by considering the characteristics of real applications. For instance, a hybrid method was proposed to combine the nearest neighbor classifier and the support vector machine [12], thus helping to overcome several problems of the two individual methods. A self-taught learning method was proposed to use the unlabeled images randomly downloaded from the Internet to improve the performance on a specific image classification task [13]. In defense of the nearest-neighbor (NN) based image classification, a naive-Bayes nearest neighbor classifier was proposed to demonstrate the effectiveness of non-parametric NN methods [14].

Certain scholarship has also addressed a similar problem of unknown concepts in the semantic space. A combination scheme of query by multi-example and semantic retrieval was proposed to alleviate the influence of unknown concepts to semantic-based image retrieval [15]. To bridge the gap between a limited number of learned concept detectors and the full vocabulary a user has, an automatic video retrieval method [16] was proposed by building a set of machine learned concept detectors that were enriched with semantic descriptions and semantic structure obtained from WordNet. Other works have attempted to address the unknown concepts related problems using image classification. For example, a novel sparse graph based semi-supervised learning approach was proposed [17] for harnessing the labeled and unlabeled data simultaneously for the purpose of inferring the images’ semantic concepts more accurately. To promote image annotation performance, a correlative linear neighborhood propagation method was proposed by adapting the hidden semantic correlation into graph-based semi-supervised learning [18]. Considering any ambiguous or unknown concepts in the query, IntentSearch [19] was proposed as a simplified version of active reranking to capture the user’s intention more accurately. The user’s intention is defined by only one query image in IntentSearch, and does not work as well when the user’s intention is too complex to be represented by one image. An enhanced active reranking scheme [20] was proposed to employ a structural information based sample selection strategy for reducing the user’s labeling efforts. This localizes the user’s intention in the visual feature space by a local–global discriminative dimension reduction algorithm.

Our work is different as our research focuses on the problem of hidden classes in the CBIR systems that employ image classification. Firstly, the unknown concepts in the semantic space are not equal to the hidden classes in a categorized image collection because they pose different perspectives. The unknown concepts are derived from semantic meaning while the hidden classes are based on visual similarity. The existing solutions for unknown concepts cannot be applied to deal with hidden classes. In fact, it remains unsolved as to how to identify and answer the queries associated with hidden classes that can dramatically affect the retrieval performance. In addition to this, our work aims to propose a new CBIR scheme that can handle hidden classes in a single interaction without the process of relevance feedback or active reranking.

This section describes the proposed CBIR scheme as illustrated in Fig. 2
                     . Due to hidden classes, a common query and a novel query are two types of queries requiring different retrieval strategies. In this work, novel query detection is proposed to determine if a query is a common query or a novel query. Following this, different types of queries can be answered using different image ranking methods. To support different ranking strategies, a new preprocessing is developed.

Let us consider an image collection Ω containing N images, Ω
                     ={x
                     1,
                     x
                     2,…,
                     x
                     
                        N
                     }. The content of each image is represented by a low-level feature vector. Assuming there are M predefined image classes, {ω
                     1,…,
                     ω
                     
                        M
                     }, and a set of training samples, S
                     
                        i
                     , is available for each predefined image class ω
                     
                        i
                     . A user’s query consists of multiple example images, 
                        
                           Q
                           =
                           {
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 L
                              
                           
                           }
                        
                     .

Preprocessing is designed to train a set of classifiers for the predefined image classes. In contrast to conventional schemes, image classifiers are specialized to address the problems arising from hidden image classes.
                           
                              •
                              At the stage of novel query detection, the classifiers are modified and combine to construct a novel query detector.

At the stage of image ranking for a common query, the classifiers combine to predict the relevant class.

At the stage of image ranking for a novel query, the classifiers are modified and combine to filter out strongly irrelevant images.

Taking hidden classes into account, a new two-step strategy is proposed for classifier training. In the first step, we train a set of weak classifiers for the predefined image classes. For the ith image class, the training samples, S
                        
                           i
                        , are regarded as positive samples, and the training samples of other image classes, {S
                        
                           j
                        },
                        j
                        ≠
                        i, are regarded as the negative samples. All positive and negative samples merge to train a two-class SVM [24,25]. The decision function is 
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              )
                           
                        , which is used to express this SVM. We can use 
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              )
                           
                         to compute a decision value for an image and this decision value can be converted to a probability [26] or a binary value [25]. The weak classifiers are then applied to filter the image collection to obtain a set of images, 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    ∼
                                 
                              
                           
                        , which do not belong to any predefined image class with a high probability. The filtering rule is
                           
                              (1)
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 )
                                 <
                                 0
                                 ,
                                 
                                 i
                                 ∈
                                 [
                                 1
                                 ,
                                 M
                                 ]
                                 .
                              
                           
                        In the second step, we re-train a set of strong classifiers for the predefined image classes. The difference from the first step is that we randomly selected images from 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    ∼
                                 
                              
                           
                         as the negative samples, with new information included in order to improve the classifiers. For the ith image class, the training samples, S
                        
                           i
                        , were used as the positive samples. The training samples of other image classes, {S
                        
                           j
                        }, j
                        ≠
                        i, and some randomly selected images from 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    ∼
                                 
                              
                           
                        , were used as the negative samples. All positive and negative samples were combined to train an SVM classifier, f
                        
                           i
                        (x). Consequently, a set of SVMs, {f
                        1(x),…,
                        f
                        
                           M
                        (x)}, can be prepared for predefined image classes.

The two-step training strategy is necessary to address the hidden class problem. In the first step, all training samples come from predefined image classes, meaning that the training set will not include the information of hidden classes. In this sense, the trained classifiers are weak. In the second step, some new samples were randomly selected from 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    ∼
                                 
                              
                           
                        . Since the extended training set contains the information of hidden classes, the trained classifiers become stronger.

Novel query detection is proposed to identify a query as a common query or a novel query as different retrieval strategies will be applied to answer different queries. In the proposed scheme, novel query detection is achieved by extending traditional novelty detection techniques [27]. Traditional novelty detection is formulated as a two-class classification problem using random rejects as negative training samples [27–29], however these methods do not support multi-image queries. In the CBIR field, a multi-image query [21,22,15] is preferable because this can express the user’s search intent better than a single image query. We incorporate multi-image queries and the combination rules to achieve accurate novel query detection.

Firstly, we construct an SVM-based novel query detector for a single query image, namely NQD-Single. If 
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              )
                              <
                              T
                              ,
                              
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                           
                         is a novel query to the ith class. T is the predefined detection threshold. In the case of multiclass, the problem of novel query detection can be separated into a set of basic novel query detections. The query image 
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                           
                         is determined as a novel query only if it is a novel query for all classes. Therefore, 
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                           
                         is a novel query if 
                           
                              
                                 
                                    max
                                 
                                 
                                    i
                                 
                              
                              
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              )
                              <
                              T
                              ,
                              
                              i
                              ∈
                              [
                              1
                              ,
                              M
                              ]
                           
                        .

Now, we construct a novel query detector for multi-image queries by incorporating the NQD-Single method and the combination rules. In this work, two different combination rules, the majority vote rule (MVR) and the Bayes sum rule (BSR) [30,31], are applied to implement the multi-image query detection.
                           
                              •
                              The first method applies MVR to extend the NQD-Single methods, namely NQD-MVR. For a query image 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                 , the vote associated to the ith predefined image class can be calculated as
                                    
                                       (2)
                                       
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          x
                                          )
                                          =
                                          sign
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                          -
                                          T
                                          )
                                          .
                                       
                                    
                                 
                              

Given a multi-image query 
                                    
                                       Q
                                       =
                                       {
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             L
                                          
                                       
                                       }
                                    
                                  and the detection threshold T, the novel query detection rule for the ith predefined image class is that Q is a novel query to the ith class
                                    
                                       (3)
                                       
                                          if
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   L
                                                
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          <
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          .
                                       
                                    
                                 
                              

The final novel query detection rule for multiclass is that, Q is a novel query
                                    
                                       (4)
                                       
                                          if
                                          
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   L
                                                
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          <
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                          i
                                          ∈
                                          [
                                          1
                                          ,
                                          M
                                          ]
                                          .
                                       
                                    
                                 
                              

The second method is applying BSR to extend the NQD-Single method, namely NQD-BSR. First, the decision values produced by a SVM classifier are converted into the conditional probabilities using the sigmoid function [26],
                                    
                                       (5)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                            (
                                                            
                                                               
                                                                  ω
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            |
                                                            x
                                                            )
                                                            =
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  1
                                                                  +
                                                                  exp
                                                                  (
                                                                  -
                                                                  
                                                                     
                                                                        f
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  (
                                                                  x
                                                                  )
                                                                  )
                                                               
                                                            
                                                            ,
                                                            
                                                            if
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            (
                                                            x
                                                            )
                                                            ⩾
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                            (
                                                            
                                                               
                                                                  ω
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            |
                                                            x
                                                            )
                                                            =
                                                            1
                                                            -
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  1
                                                                  +
                                                                  exp
                                                                  (
                                                                  
                                                                     
                                                                        f
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  (
                                                                  x
                                                                  )
                                                                  )
                                                               
                                                            
                                                            ,
                                                            
                                                            if
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            (
                                                            x
                                                            )
                                                            <
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

Given a multi-image query 
                                    
                                       Q
                                       =
                                       {
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             L
                                          
                                       
                                       }
                                    
                                  and the detection threshold T, for the ith predefined image class, the conditional probability of P(ω
                                 
                                    i
                                 ∣Q) can be calculated as
                                    
                                       (6)
                                       
                                          P
                                          (
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          Q
                                          )
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                L
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   L
                                                
                                             
                                          
                                          P
                                          (
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          .
                                       
                                    
                                 
                              

The novel query detection rule is that, Q is a novel query to the ith class
                                    
                                       (7)
                                       
                                          if
                                          
                                          P
                                          (
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          Q
                                          )
                                          <
                                          T
                                          .
                                       
                                    
                                 
                              

The final novel query detection rule for multiclass is that, Q is a novel query
                                    
                                       (8)
                                       
                                          if
                                          
                                          
                                             
                                                max
                                             
                                             
                                                i
                                             
                                          
                                          
                                          P
                                          (
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          Q
                                          )
                                          <
                                          T
                                          ,
                                          
                                          i
                                          ∈
                                          [
                                          1
                                          ,
                                          M
                                          ]
                                          .
                                       
                                    
                                 
                              

The two multi-image query detection methods are evaluated in our experiments. Note that, if a query is not a novel query, it is a common query.

For a common query, it can be answered using the images in a predefined image class. The retrieval results are obtained by predicting a relevant image class followed by ranking images in this class.

Relevant class prediction can be regarded as an extended multiclass classification problem. For a single query image, this is a classic multiclass classification problem and the conventional solution can be expressed as
                              
                                 (9)
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    arg
                                    
                                       
                                          
                                             max
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                    P
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ,
                                 
                              
                           i.e., the relevant class is a predefined image class with the maximum posterior probability for 
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                              
                           .

We then extend the conventional method to manage a multi-image query by taking the applied detection strategy into account.
                              
                                 •
                                 With NQD-BSR, the prediction rule can be expressed as
                                       
                                          (10)
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   ∗
                                                
                                             
                                             =
                                             arg
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      L
                                                   
                                                
                                             
                                             P
                                             (
                                             
                                                
                                                   ω
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             .
                                          
                                       
                                    
                                 

With NQD-MVR, the prediction rule can be expressed as
                                       
                                          (11)
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   ∗
                                                
                                             
                                             =
                                             arg
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      L
                                                   
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             .
                                          
                                       
                                    
                                 

If there is more than one image class with maximum votes, Eq. (10) can be applied to solve the tie.

Ranking images in the relevant class can further improve the retrieval results. First, the images in the relevant class are extracted from the image collection. The images with 
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                                 (
                                 x
                                 )
                                 >
                                 T
                              
                            are considered as belonging to the relevant class and then ranked according to their relevance to the query. It should be highlighted that this process can be conducted off-line, i.e., the images of predefined image classes can be selected in preprocessing and saved for later use.

The next step is to compute relevance between the images in 
                              
                                 
                                    
                                       ω
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                            and the multi-image query, 
                              
                                 Q
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       L
                                    
                                 
                                 }
                              
                           . In this paper, we cast it as a one-class classification problem [32], i.e., only positive samples are available. We use multiple query images 
                              
                                 {
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       L
                                    
                                 
                                 }
                              
                            to train a one-class SVM [33], f
                           
                              q
                           (x). Then, images in 
                              
                                 
                                    
                                       ω
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                            are ranked according to the decision values produced by f
                           
                              q
                           (x). Finally, the top k images in the ranking list are returned as the retrieval results. This process is also helpful to improve the user experience because ordinary users normally have more interest in the top ranked images in practical applications.

A novel query does not associate with any predefined image class. A straightforward way is to rank images in the entire collection according to their similarities to the query. However, this approach does not take into account the knowledge of predefined image classes. We observe that if the images are strongly relevant to a predefined image class, they are not relevant to the novel query. Therefore, the proposed approach can improve the retrieval results by filtering out irrelevant images before image ranking.

Since the novel query cannot be answered by any predefined image class, it is likely the images in the predefined image classes are not relevant to the novel query and can be filtered out. The prepared image classifiers, {f
                           1(x),…,
                           f
                           
                              M
                           (x)}, can be utilized to produce a set of images, Ψ, from the whole image collection. The images in Ψ are not relevant to the predefined image classes. These images will be used to answer the novel query. The filtering rule is that,
                              
                                 (12)
                                 
                                    if
                                    
                                    
                                       
                                          
                                             max
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    )
                                    <
                                    0
                                    ,
                                    
                                    i
                                    ∈
                                    [
                                    1
                                    ,
                                    M
                                    ]
                                    ,
                                 
                              
                           put x in Ψ. This image filtering process can be conducted off-line, i.e., Ψ can be created in the stage of preprocessing.

In this paper, we cast image ranking for a novel query as a binary classification problem. The query images are used as the positive samples and the training samples for the predefined image classes are used as the negative samples. All positive and negative samples are combined to train a classifier, such as a SVM, for image ranking. However, the positive and negative samples are unbalanced, which influences the accuracy of a SVM. We apply the asymmetric bagging strategy [34] to construct an ensemble of SVMs and combine the outputs for image ranking. The detailed algorithm is described in Table 1
                           . In this algorithm, the decision value f
                           
                              qi
                           (x
                           
                              j
                           ) of an image x
                           
                              j
                            produced by the ith bagging classifier is converted into a conditional probability P(r∣f
                           
                              qi
                           ,
                           x
                           
                              j
                           ) using the sigmoid function in Eq. (5). P(r∣f
                           
                              qi
                           ,
                           x
                           
                              j
                           ) is a probability of the image being relevant to the query predicted by the ith SVM classifier. All decision values of x
                           
                              j
                            produced by the ensemble of SVM classifiers are then merged to make the final decision using the Bayesian sum rule.

This section discusses the implementation of the proposed scheme including utilization of a multi-image query, on-line computation time, and setting of the threshold.

In the proposed scheme, the utilization of a multi-image query is based on combination rules. Specifically, this approach is applied to novel query detection and the relevant class prediction. In this section, we formulate the classification of multi-image queries in a theoretical framework [30] and show that the extension of multi-image queries is a classifier combination problem [35].

Consider a pattern recognition problem where a pattern (query) Q is to be assigned to one of the M possible classes {ω
                        1,…,
                        ω
                        
                           M
                        }. Let us assume we have a classifier but the given pattern can be represented using L distinct measurement vectors from different observations (query images), 
                           
                              {
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    L
                                 
                              
                              }
                           
                        . This is typical classifier combination architecture using repeated measurements [35]. In the measurement space, each class ω
                        
                           k
                         is modeled by the probability density function p(x
                        
                           i
                        ∣ω
                        
                           k
                        ) and its priori probability of occurrence is denoted as P(ω
                        
                           k
                        ).

According to the Bayesian theory, given measurements 
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              i
                              ∈
                              [
                              1
                              ,
                              L
                              ]
                           
                        , the pattern, Q, should be assigned to class ω
                        
                           j
                         provided the a posteriori probability of that interpretation is the maximum, i.e.,
                           
                              (13)
                              
                                 
                                    
                                       
                                       
                                          
                                             assign
                                             
                                             Q
                                             →
                                             
                                                
                                                   ω
                                                
                                                
                                                   j
                                                
                                             
                                             
                                             if
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             P
                                             (
                                             
                                                
                                                   ω
                                                
                                                
                                                   j
                                                
                                             
                                             |
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   L
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                             P
                                             (
                                             
                                                
                                                   ω
                                                
                                                
                                                   k
                                                
                                             
                                             |
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   L
                                                
                                             
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Then, the combination rules, such as Bayes sum and majority vote can be derived from Eq. (13) under certain specific conditions [30]. The classifier combination methods can be employed to extend conventional methods for single image queries to multi-image queries.

For practical applications, the on-line computation time is an important factor. We briefly discuss the on-line computation time concerning the proposed scheme.

At the stage of novel query detection, the detection methods depend on the set of SVM classifiers for the predefined image classes. The set of SVM classifiers can be trained off-line in preprocessing so they will not affect the on-line computation time. Furthermore, the detection methods have a short computation time as they need to handle a small number of query images.

At the stage of image retrieval for a common query, the set of SVM classifiers can be trained off-line without affecting the on-line computation time. The extended method for relevant class prediction has a short computation time thanks to a small number of query images. Following this, the training of one-class SVM using the query images is extremely fast. The image ranking is completed quickly because only those images in the predicted relevant class are ranked.

At the stage of image retrieval for a novel query, image filtering can be conducted off-line. The on-line computation time can be dramatically reduced since only the retained images are used for ranking. Furthermore, the image ranking method has a short computation time because each bagging classifier has only a small number of training samples available and the number of bagging classifiers is small.

The setting of the detection threshold is important for the proposed retrieval scheme. If the threshold is too high, many common queries will be considered novel queries. A low threshold on the other hand, will lead to many novel queries thought of as common queries. Inaccurate detection of queries will influence the retrieval performance.

To study the impact of the threshold on novel query detection, a number of experiments were performed with various thresholds. The experimental results are reported in Section 5.1. Moreover, we applied a practical method [36] in the proposed retrieval scheme to select a proper threshold. We chose a threshold by comparing results on a test set after preprocessing. The test set was specially collected for the purpose of threshold setting and its ground truth was known.

A number of experiments were carried out on two image datasets, Corel [37] and NUS-WIDE [23], to evaluate the proposed scheme.

To simulate the problem of hidden classes, we assumed that certain image classes were predefined classes and other image classes were hidden classes in the experiments. For each predefined class, 30% of images in the class were randomly selected and used as the training samples. For each hidden class, no training samples were available. This means the hidden classes were unknown by the CBIR system. The queries for performance evaluation were randomly created from all image classes including predefined and hidden classes.

Three sets of experiments were carried out on the Corel image dataset to evaluate the methods of novel query detection. The Corel image dataset consists of ten classes with each class containing 100 real-world images. This image dataset was well organized and suited to the evaluation of novel schemes. Two standardized MPEG-7 visual descriptors [38], CSD and EHD, were selected to describe the image content. In the first experiment, nine image classes were set as predefined classes and one image class was set as a hidden class. In the second experiment, eight image classes were set as predefined classes and two image classes were set as hidden classes. In the third experiment, seven image classes were set as predefined classes and three image classes were set as hidden classes. The performance in terms of the true novel query rate and the false novel query rate on a large number of random queries is provided. The true novel query rate is defined as the fraction of accurately detected novel queries over the total number of novel queries. The false novel query rate is defined as the fraction of incorrectly detected novel queries over the total number of common queries.


                        Figs. 3 and 4
                        
                         show the performances of the three methods for NQD-Single, NQD-MVR and NQD-BSR, with various thresholds. To facilitate the comparison, the threshold is expressed by the value of probability. In NQD-Single, each query includes a single example image. In NQD-MVR and NQD-BSR, each query includes five example images. The experimental results show that both NQD-BSR and NQD-MVR were superior to NQD-Single. Firstly, NQD-BSR and NQD-MVR composed higher true novel query rates compared to NQD-Single. Secondly, the false novel query rate of NQD-BSR was much lower than that of NQD-Single. The false novel query rate of NQD-MVR was also slightly lower than that of NQD-Single. A basic reason for this is that multiple examples can describe user query intent better than a single example. The experimental results also show that NQD-BSR outperforms NQD-MVR thanks to a low false novel query rate. For example, when the threshold was set at 0.33, the false novel query rate of NQD-BSR was over 15% lower than that of NQD-MVR. Moreover, it was easier to choose a proper threshold for NQD-BSR in order to guarantee a high true novel query rate and a low false novel query rate. However, this was difficult for NQD-MVR, and therefore, the NQD-BSR method was preferable for novel query detection.

A number of image retrieval experiments were carried out to evaluate the CBIR schemes. The proposed schemes were compared with a conventional CBIR scheme employing image classification. In the conventional scheme, if a single query image was provided, a relevant image class could be predicted using a conventional classification approach. The images in the relevant class would be ranked according to their Euclidean distance to the query image. In contrast to the conventional scheme, the proposed scheme takes hidden classes into account and supports multi-image queries. Two methods of query novelty detection were applied in the proposed scheme, resulting in two versions; the proposed scheme with MVR and the proposed scheme with BSR.


                        Fig. 5
                         demonstrates the retrieval performance of competing schemes on the Corel dataset. These results show that the proposed scheme outperforms the conventional scheme in terms of handling hidden classes using either MVR or BSR. Fig. 6
                         shows a selection of real retrieval results for a novel query. In this case, the conventional scheme predicted an irrelevant class in which there were few relevant images to the query. In contrast, the proposed scheme with BSR accurately detected this novelty query and produced an excellent result. The proposed scheme with MVR predicted an irrelevant class with many relevant images for the query, even though it failed to detect this as a novel query. An important reason for this is that the proposed scheme can handle novel queries, while the conventional scheme cannot. Particularly for a novel query, the conventional schemes will still predict a predefined image class as the relevant class with the retrieval performance dramatically degraded. Furthermore, the proposed scheme with BSR is better than that with MVR because NQD-BSR has a much lower false novel query rate than NQD-MVR. The high false novel query rate can influence the retrieval performance of the proposed scheme with MVR.

Furthermore, we performed a number of image retrieval experiments on the NUS-WIDE-LITE dataset, which is a subset of 55,615 images randomly selected from NUS-WIDE [23]. The NUS-WIDE-LITE dataset has been frequently used for retrieval performance evaluation. The 64-D color histogram and the 73-D edge direction histogram were used to describe the image content. Three sets of experiments were carried out with different hidden classes. In the first experiment, 10% of image classes were set as hidden classes and 90% of image classes were set as predefined classes. In the second experiment, 20% of image classes were set as hidden classes and 80% of image classes were set as predefined classes. In the third experiment, 30% of image classes were set as hidden classes and 70% of image classes were set as predefined classes. Fig. 7
                         demonstrates the retrieval performance of competing schemes on the NUS-WIDE-LITE dataset. These results show that either version of the proposed scheme outperforms the conventional scheme. The proposed scheme with BSR is better than the proposed scheme with MVR. These experimental results further validate the effectiveness of the proposed scheme.

Even though the proposed scheme has different retrieval performances on different testing datasets, it still consistently outperformed the conventional retrieval method when hidden classes were present in the categorized image collection. We argue that the data characteristics of various CBIR benchmarks, such as MPEG-7 (http://mpeg.chiariglione.org/standards/mpeg-7/mpeg-7.htm) and the NIST TRACVID benchmark (http://trecvid.nist.gov/), cause different retrieval performances. Firstly, the number of hidden classes can affect the retrieval performance, which is probably directly related to the amount of predefined classes in the classified image collection. The retrieval performance will decrease as the number of hidden classes increases because any further benefit of image classification during preprocessing is lost. The definition of image classes may affect the accuracy of novel query detection. The different construction strategies for image classes in various benchmarks influences the reliability of the design of novelty query detection. However, the consideration of hidden classes determines that our proposed scheme has a superior retrieval performance compared to the conventional CBIR scheme on various benchmarks.

@&#CONCLUSIONS@&#

In this paper, we identified and addressed a new robustness problem of hidden classes which severely affected the performance of content-based image retrieval (CBIR) systems employing image classification. We observed that, because of hidden classes, the queries can be separated into two categories; either a common query or a novel query. In the proposed scheme, novel query detection was developed to determine whether a query was a novel query or a common query. A self-adaptive strategy was proposed to conduct image retrieval for different types of queries. Therefore, the problem of hidden classes can be addressed from the perspective of query answering. A number of experiments carried out on two real-world image datasets validated the effectiveness of our proposed scheme. Compared to the conventional scheme, the proposed scheme can achieve over a 10% improvement in its retrieval performance, thus helping to significantly improve user’s experience in top ranked images.

@&#ACKNOWLEDGMENTS@&#

The authors thank Dr. Jinhui Tang for providing the NUS-WIDE dataset [23]. The authors would also like to thank the anonymous reviewers for their thoughtful and insightful comments that helped to improve the quality of this paper.

@&#REFERENCES@&#

