@&#MAIN-TITLE@&#Optimal arc spline approximation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A method for approximating point sequences by arc splines is presented.


                        
                        
                           
                           The breakpoints of the arc spline are not restricted to any pre-defined set of points.


                        
                        
                           
                           For any user-defined accuracy, the minimal number of segments is guaranteed.


                        
                        
                           
                           The resulting compact curve representation enables an efficient further processing.


                        
                        
                           
                           Among others, it is hence suited for the generation of highly accurate digital maps.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Approximation

Arc spline

Biarc

SMAP

@&#ABSTRACT@&#


               Graphical abstract
               
                  
               
               
                  
               
            

@&#INTRODUCTION@&#

Various applications require the approximation of planar point sequences by a suitable class of curves. Arc splines are curves composed of circular arcs and line segments (shortly: segments) which therefore have advantageous properties: exact offset and arc length computation, parameter free description and simple closest point calculation (cf. Maier, 2010). In particular, smooth, i.e. 
                        
                           
                              G
                           
                           
                              1
                           
                        
                     -continuous arc splines have been studied in literature in the past few years. Ones of the first publications were Sandel (1937) and Sabin (1977). Arc splines were then further popularized in the publications (Meek and Walton, 1992, 1995). Often, methods are considered which guarantee that the resulting arc spline has a possibly small number of arcs and stays within a user-specified tolerance from the input data (cf. Piegl and Tiller, 2002; Heimlich and Held, 2008; Drysdale et al., 2008). For this purpose, corresponding algorithms mostly follow geometric approaches: In order to approximate a simple polygonal curve, the ε-tolerance zone is focused, which is a closed polygon deduced by the set of points which have an Euclidean distance of at most ε from the input points. In Heimlich and Held (2008) an efficient method is introduced which generates tolerance zones using Voronoi diagrams.

Biarcs, i.e. 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      curve segments consisting of two circular arcs, have been used in a large number of algorithms for approximation or interpolation of given point and possibly tangent data. For an overview we refer to Heimlich and Held (2008). Usually, biarc algorithms fit biarcs or single arcs between selected pairs of points and use the connecting line segments of each two corresponding points for the tangent data. Doubtlessly, they are appropriate for various applications. However, there are cases where they suffer from the unnatural requirement that breakpoints and tangent data of the approximating arc spline have to be chosen from a given finite point set in advance. This is even more the case for the second main approach in literature which is based on interpolation (e.g. Yang, 2002). Note that restricting the loci of the breakpoints can have considerable influence on the resulting segment number: In Maier and Pisinger (2013), which deals with the approximation of a cyclic polygonal curve by 
                        
                           
                              G
                           
                           
                              0
                           
                        
                     -continuous arc splines, one can find an illustrative example: For each biarc and interpolation based algorithm A and 
                        n
                        ∈
                        N
                     , an open polygon K with n vertices can be created and an ε can be chosen such that A needs 
                        O
                        (
                        n
                        )
                      segments but the SMAP algorithm needs only one segment for approximating K with a maximum tolerance of ε.

Thus, we are interested in an arc spline approximation achieving the minimal number of segments subject to the following: The solution is 
                        
                           
                              G
                           
                           
                              1
                           
                        
                     -continuous and it stays inside a user-specified tolerance. Such a solution is called Smooth Minimum Arc Path (SMAP).

The paper is organized as follows: In Section 2 we fix some basic definitions and notation needed in the main part, which deals with the two main tools used in this work: alternating sequences and feasible direction sets (cf. Sections 3 and 4). After the characterization of the so-called visibility set in Section 5 and the continuity properties of feasible directions in Section 6, we focus on n-visibility sets for 
                        n
                        >
                        1
                      and finally the computation of a SMAP (cf. Sections 7 and 8). Finally, we address practical applications of the SMAP algorithm, and discuss possible extensions of the proposed method.

An extensive treatise of this topic including all special cases and more detailed proofs can be found in Maier (2010). In contrast, this paper is of a comprehensive nature and is more comfortable to read: We made some assumptions which allow a simplification of the notation and the proofs, which is still general enough for most practical applications.

For a set 
                           A
                           ⊂
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        , ∂A denotes the boundary of A, 
                           
                              
                                 A
                              
                              
                                 ¯
                              
                           
                         its closure and 
                           
                              
                                 A
                              
                              
                                 ∘
                              
                           
                         its interior. The set 
                           K
                           (
                           A
                           )
                         is used for the set of all non-empty compact subsets of A. By
                           
                              
                                 
                                    dist
                                 
                                 (
                                 A
                                 ,
                                 B
                                 )
                                 :
                                 =
                                 
                                    inf
                                    
                                       x
                                       ∈
                                       A
                                    
                                 
                                 
                                 
                                    inf
                                    
                                       y
                                       ∈
                                       B
                                    
                                 
                                 ‖
                                 x
                                 −
                                 y
                                 ‖
                              
                           
                         we denote the Euclidean distance and use the abbreviation 
                           
                              dist
                           
                           (
                           x
                           ,
                           A
                           )
                           :
                           =
                           
                              dist
                           
                           (
                           {
                           x
                           }
                           ,
                           A
                           )
                        . Likewise, the Hausdorff metric is defined as follows:
                           
                              
                                 h
                                 (
                                 A
                                 ,
                                 B
                                 )
                                 :
                                 =
                                 max
                                 
                                 
                                    {
                                    
                                       sup
                                       
                                          x
                                          ∈
                                          A
                                       
                                    
                                    
                                    
                                       dist
                                    
                                    (
                                    x
                                    ,
                                    B
                                    )
                                    ,
                                    
                                       sup
                                       
                                          x
                                          ∈
                                          B
                                       
                                    
                                    
                                    
                                       dist
                                    
                                    (
                                    x
                                    ,
                                    A
                                    )
                                    }
                                 
                                 .
                              
                           
                        
                     

We will deal with planar curves which are simple, i.e. curves without any self-intersections. The image set, also called trace, of a curve ω is denoted by 
                           
                              tr
                           
                           (
                           ω
                           )
                           ⊂
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        . To simplify the notation we often identify ω with 
                           
                              tr
                           
                           (
                           ω
                           )
                        . The order on 
                           
                              tr
                           
                           (
                           ω
                           )
                         induced by the orientation of ω is denoted by 
                           
                              
                                 ≺
                              
                              
                                 ω
                              
                           
                         and 
                           
                              
                                 [
                                 x
                                 ,
                                 y
                                 ]
                              
                              
                                 ω
                              
                           
                           ⊂
                           ω
                         is the subset ‘between’ 
                           x
                           ∈
                           ω
                         and 
                           y
                           ∈
                           ω
                        . For the tangent unit vector, if it exists, at a point 
                           a
                           ∈
                           ω
                        , we use the symbol 
                           
                              
                                 τ
                              
                              
                                 ω
                              
                           
                           (
                           a
                           )
                        .


                        
                           Definition 1
                           A simple curve Γ in 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                               is called arc spline if its trace is a union 
                                 Γ
                                 =
                                 
                                    
                                       ⋃
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                               of finitely many arcs or line segments. The minimally possible number 
                                 n
                                 ∈
                                 N
                               for the above condition is called segment number of Γ. We use the abbreviation 
                                 |
                                 Γ
                                 |
                                 :
                                 =
                                 n
                              . Arc splines γ with 
                                 |
                                 γ
                                 |
                                 =
                                 1
                               are simply called segments. Every segment γ has exactly one starting point 
                              
                                 s
                                 (
                                 γ
                                 )
                               and one endpoint 
                              
                                 e
                                 (
                                 γ
                                 )
                              . An arc spline Γ is called smooth if it is 
                                 
                                    
                                       G
                                    
                                    
                                       1
                                    
                                 
                              -continuous, i.e. 
                                 
                                    
                                       τ
                                    
                                    
                                       Γ
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       τ
                                    
                                    
                                       Γ
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       −
                                    
                                 
                                 )
                               for all 
                                 x
                                 ∈
                                 Γ
                              .

Let x and a be two distinct points in the plane and let v be a direction, i.e. a point of the unit sphere 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                        . If 
                           v
                           ≠
                           
                              
                                 x
                                 −
                                 a
                              
                              
                                 ‖
                                 x
                                 −
                                 a
                                 ‖
                              
                           
                        , then there exists exactly one segment 
                           γ
                           :
                           =
                           
                              
                                 γ
                              
                              
                                 x
                                 ,
                                 a
                                 ,
                                 v
                              
                           
                         with 
                           s
                           (
                           γ
                           )
                           =
                           x
                        , 
                           e
                           (
                           γ
                           )
                           =
                           a
                         and 
                           
                              
                                 τ
                              
                              
                                 γ
                              
                           
                           (
                           a
                           )
                           =
                           v
                        .

The proposed approach deals with an approximation up to a given tolerance, which can possibly vary locally. As described above we control the approximation error by considering only smooth arc splines staying inside the so-called tolerance channel, which is a closed polygon deduced from the input points and two designated edges. The width of this channel represents the user-specified maximum tolerance, which can vary locally as well. The canonical shape of a tolerance channel modeling a maximum error ε is given by the set of points which have an Euclidean distance to the open polygon running through the set of input points P of at most ε. Generally speaking, this ε-offset is a region formed from strips of width 2ε which are centered at the polygon edges. Thus, in a neighborhood of sharp corners this doesn't guarantee that the curve remains close to the given points. In Heimlich and Held (2008) however a method is introduced which avoids this problem and computes such tolerance channel in an efficient manner. Therefore, we do not deal with the generation of tolerance channels for a given point set and user-specified tolerance within this scope.

Actually, tolerance channels can be formed by a much broader class of bounding curves, namely piecewise restricted analytic curves.
                           1
                        
                        
                           1
                           Restricted analytic curves are curves which have analytic extensions, i.e. developable as power series. See Maier (2010) for an exact definition.
                         We focus on simple closed polygons, which is absolutely sufficient for most purposes. The term polygon is used to denote the union of both the boundary and the interior of the corresponding polygonal Jordan curve.


                        
                           Definition 2
                           Let P be a simple closed polygon in 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                              . Furthermore, let s and d be two disjoint edges of P. Then 
                                 (
                                 P
                                 ,
                                 s
                                 ,
                                 d
                                 )
                               is called tolerance channel and a Smooth Minimum Arc Path (SMAP) is a smooth arc spline starting at s ending in d and staying in P with the minimal number of segments.

An example of a point list, the corresponding tolerance channel for a user-specified tolerance and a resulting SMAP are illustrated in Fig. 1
                        .


                        
                           Definition 3
                           A point 
                                 a
                                 ∈
                                 P
                               is said to be (circularly) visible (from s with respect to P) if there exists a segment γ in P with 
                                 s
                                 (
                                 γ
                                 )
                                 ∈
                                 s
                               and 
                                 e
                                 (
                                 γ
                                 )
                                 =
                                 a
                              . In this case γ is called visibility arc (for s and a). The set of all circularly visible points is denoted by V and the set of all visibility arcs is denoted by 
                                 S
                              . Furthermore, we define: 
                                 S
                                 (
                                 a
                                 )
                                 :
                                 =
                                 {
                                 γ
                                 ∈
                                 S
                                 |
                                 e
                                 (
                                 γ
                                 )
                                 =
                                 a
                                 }
                               and 
                                 S
                                 (
                                 a
                                 ,
                                 v
                                 )
                                 :
                                 =
                                 {
                                 γ
                                 ∈
                                 S
                                 (
                                 a
                                 )
                                 |
                                 
                                    
                                       τ
                                    
                                    
                                       γ
                                    
                                 
                                 (
                                 a
                                 )
                                 =
                                 v
                                 }
                              .

Likewise, 
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                                 ⊂
                                 P
                              , 
                                 n
                                 >
                                 1
                              , denotes the set of points 
                                 a
                                 ∈
                                 P
                               such that there is an arc spline Γ in P with at most n segments, 
                                 s
                                 (
                                 Γ
                                 )
                                 ∈
                                 s
                               and 
                                 e
                                 (
                                 Γ
                                 )
                                 =
                                 a
                              . Then Γ is called visibility spline and the corresponding set is denoted by 
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                 
                              .

In order to give an efficient mathematical characterization of the sets V and 
                           
                              
                                 V
                              
                              
                                 n
                              
                           
                         for 
                           n
                           >
                           1
                        , alternating sequences and feasible direction sets are defined and various properties are examined. We are then able to give an equivalent condition whether a segment in P ending in a non-visible point can be touched by a visibility arc. The characterization of the set of all n-visible points follows by induction. Consequently, we work out characterizations of a SMAP and we present an approach for the computation of a solution based on alternating sequences. Since we can again proceed inductively, this leads to a constructive and iterative procedure, which will result in a greedy algorithm.

Motivated by classical Chebyshev approximation theory (e.g. Braess, 1971), where sequences of alternating signs ±1 play an important role, we introduce alternating sequences: sequences of points a visibility arc γ and ∂P have in common. At these points, γ is alternately touched from the “left” and from the “right”.

As a circle is uniquely determined by three distinct points, so one would intuitively say an arc has three degrees of freedom. Alternating sequences are used to fix these degrees of freedom defining a visibility arc. Whenever a segment in a tolerance channel is in an ‘extremal’ position, its ‘variability’ will be restricted by three alternating left and right restriction points.

To keep the notation as simple as possible, we assume for the remaining part of this paper that the two vertices of s are convex, i.e. their interior angles are strictly smaller than π. The general case can be found in Maier (2010).

We first define the compact subsets 
                        L
                        (
                        γ
                        )
                      and 
                        R
                        (
                        γ
                        )
                      describing the part of ∂P which is left/right of γ. In fact, 
                        L
                        (
                        γ
                        )
                      and 
                        R
                        (
                        γ
                        )
                      are unions of finitely many edges sections of P:


                     
                        Definition 4
                        Let γ be a visibility arc. Then we define
                              
                                 
                                    R
                                    (
                                    γ
                                    )
                                    :
                                    =
                                    
                                       
                                          {
                                          x
                                          ∈
                                          ∂
                                          P
                                          ∖
                                          s
                                          |
                                          det
                                          
                                          
                                             (
                                             x
                                             −
                                             y
                                             ,
                                             
                                                
                                                   τ
                                                
                                                
                                                   γ
                                                
                                             
                                             (
                                             y
                                             )
                                             )
                                          
                                          >
                                          0
                                          
                                          ∀
                                          y
                                          ∈
                                          γ
                                           with 
                                          
                                             dist
                                          
                                          (
                                          γ
                                          ,
                                          x
                                          )
                                          =
                                          ‖
                                          x
                                          −
                                          y
                                          ‖
                                          }
                                       
                                       ¯
                                    
                                    .
                                 
                              
                            The set 
                              L
                              (
                              γ
                              )
                            is defined by using the opposite sign, i.e. 
                              det
                              (
                              x
                              −
                              y
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    γ
                                 
                              
                              (
                              y
                              )
                              )
                              <
                              0
                           .


                     
                        Definition 5
                        Let γ be a visibility arc and 
                              a
                              ∈
                              γ
                              ∩
                              ∂
                              P
                           . Then a is called right restriction point (of γ with respect to s) if one of the following conditions hold:
                              
                                 i)
                                 
                                    
                                       a
                                       ∈
                                       R
                                       (
                                       γ
                                       )
                                       ∖
                                       {
                                       e
                                       (
                                       γ
                                       )
                                       }
                                    ,


                                    
                                       a
                                       =
                                       e
                                       (
                                       γ
                                       )
                                     and γ touches 
                                       R
                                       (
                                       γ
                                       )
                                     in a, i.e. 
                                       a
                                       ∈
                                       R
                                       (
                                       γ
                                       )
                                     and 
                                       
                                          
                                             τ
                                          
                                          
                                             γ
                                          
                                       
                                       (
                                       a
                                       )
                                       ∈
                                       −
                                       
                                          
                                             T
                                          
                                          
                                             ∂
                                             P
                                          
                                       
                                       (
                                       a
                                       )
                                    , where 
                                       
                                          
                                             T
                                          
                                          
                                             ∂
                                             P
                                          
                                       
                                       (
                                       a
                                       )
                                       :
                                       =
                                       
                                          
                                             ⋂
                                          
                                          
                                             ε
                                             >
                                             0
                                          
                                       
                                       {
                                       λ
                                       ⋅
                                       (
                                       x
                                       −
                                       a
                                       )
                                       |
                                       λ
                                       ⩾
                                       0
                                       ,
                                       x
                                       ∈
                                       ∂
                                       P
                                       ,
                                       ‖
                                       x
                                       −
                                       a
                                       ‖
                                       ⩽
                                       ε
                                       }
                                     denotes the tangent cone of ∂P in a.


                                    
                                       a
                                       =
                                       s
                                       (
                                       γ
                                       )
                                     and ‘s is locally left of γ’, i.e. for all 
                                       x
                                       ∈
                                       s
                                     we have 
                                       det
                                       (
                                       x
                                       −
                                       y
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             γ
                                          
                                       
                                       (
                                       y
                                       )
                                       )
                                       ⩽
                                       0
                                     whenever 
                                       ‖
                                       x
                                       −
                                       y
                                       ‖
                                       =
                                       
                                          dist
                                       
                                       (
                                       γ
                                       ,
                                       x
                                       )
                                    .

With the aid of left and right restrictions, alternating sequences can be defined as follows:


                     
                        Definition 6
                        Let 
                              γ
                              ∈
                              S
                           . A finite sequence of points 
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    m
                                 
                              
                            in 
                              γ
                              ∩
                              ∂
                              P
                            is called alternating sequence (of γ) if it is increasing regarding the orientation of γ and each 
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                            is a restriction point of γ, 
                              1
                              ⩽
                              i
                              ⩽
                              m
                           .

The set of all alternating sequences is denoted by 
                              A
                              (
                              γ
                              )
                            and for every 
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    m
                                 
                              
                              ∈
                              A
                              (
                              γ
                              )
                            we can define the numbers
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if 
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                 is a right restriction point,
                                             
                                          
                                          
                                             
                                                −
                                                1
                                             
                                             
                                                if 
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                 is a left restriction point,
                                             
                                          
                                       
                                    
                                    
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    m
                                    ,
                                 
                              
                            and
                              
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                       
                                    
                                    :
                                    =
                                    ε
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if 
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                =
                                                −
                                                1
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise,
                                             
                                          
                                       
                                    
                                    
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    m
                                    −
                                    1
                                    .
                                 
                              
                            Hence the alternating number of 
                           
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    m
                                 
                              
                            is 
                              A
                              (
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    m
                                 
                              
                              )
                              :
                              =
                              1
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    m
                                    −
                                    1
                                 
                              
                              
                                 
                                    ε
                                 
                                 
                                    i
                                 
                              
                           . We say 
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    m
                                 
                              
                            is of length k if 
                              A
                              (
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    m
                                 
                              
                              )
                              =
                              k
                           . Accordingly, we obtain the alternating number of γ:
                              
                                 
                                    A
                                    (
                                    γ
                                    )
                                    :
                                    =
                                    
                                       max
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          A
                                          (
                                          γ
                                          )
                                       
                                    
                                    
                                    A
                                    
                                       (
                                       
                                          
                                             (
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                            where 
                              A
                              (
                              γ
                              )
                            is set to 0 if 
                              A
                              (
                              γ
                              )
                            is empty.

The number 
                        A
                        (
                        γ
                        )
                      is well-defined since 
                        A
                        (
                        γ
                        )
                      is finite for all 
                        γ
                        ∈
                        S
                      as 
                        γ
                        ∩
                        ∂
                        K
                      is homeomorphic to a disjoint union of finitely many intervals and points in 
                        R
                     .

As an example, the alternating sequence 
                        
                           
                              (
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           
                              1
                              ⩽
                              i
                              ⩽
                              6
                           
                        
                      depicted in Fig. 3
                      has three left restriction points 
                        
                           
                              a
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              a
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              a
                           
                           
                              6
                           
                        
                      and three right restriction points 
                        
                           
                              a
                           
                           
                              3
                           
                        
                        ,
                        
                           
                              a
                           
                           
                              4
                           
                        
                      and 
                        
                           
                              a
                           
                           
                              5
                           
                        
                     . Thus, we obtain 
                        
                           
                              ε
                           
                           
                              1
                           
                        
                        =
                        
                           
                              ε
                           
                           
                              3
                           
                        
                        =
                        
                           
                              ε
                           
                           
                              4
                           
                        
                        =
                        0
                     , 
                        
                           
                              ε
                           
                           
                              2
                           
                        
                        =
                        
                           
                              ε
                           
                           
                              5
                           
                        
                        =
                        1
                      and the alternating number of 
                        
                           
                              (
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           
                              1
                              ⩽
                              i
                              ⩽
                              6
                           
                        
                      is 
                        1
                        +
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              5
                           
                        
                        
                           
                              ε
                           
                           
                              i
                           
                        
                        =
                        3
                     . Since this sequence contains all left and right restriction points of γ, we have 
                        A
                        (
                        γ
                        )
                        =
                        3
                     .

The degrees of freedom of visibility arcs are consistent with their alternating number. In particular, we will show the following:
                        
                           •
                           For fixed 
                                 a
                                 ∈
                                 V
                               and end direction v we can always choose a visibility arc 
                                 γ
                                 ∈
                                 S
                                 (
                                 a
                                 ,
                                 v
                                 )
                               with 
                                 A
                                 (
                                 γ
                                 )
                                 ⩾
                                 1
                               since there is one degree of freedom.

For fixed 
                                 a
                                 ∈
                                 V
                               there exists a 
                                 γ
                                 ∈
                                 S
                                 (
                                 a
                                 )
                               with 
                                 A
                                 (
                                 γ
                                 )
                                 ⩾
                                 2
                              .

For 
                                 a
                                 ∈
                                 ∂
                                 V
                                 ∖
                                 ∂
                                 P
                               there exists even a visibility arc γ with 
                                 A
                                 (
                                 γ
                                 )
                                 ⩾
                                 3
                              .

Regarding the first claim, let us choose a visibility arc 
                        γ
                        ∈
                        S
                        (
                        a
                        )
                      and 
                        v
                        :
                        =
                        
                           
                              τ
                           
                           
                              γ
                           
                        
                        (
                        a
                        )
                     . Then we prove that there are always visibility arcs 
                        
                           
                              γ
                           
                           
                              l
                           
                        
                      and 
                        
                           
                              γ
                           
                           
                              r
                           
                        
                      having a left and right restriction respectively.


                     
                        Proposition 1
                        
                           Let 
                           
                              
                                 
                                    γ
                                 
                                 
                                    0
                                 
                              
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            
                           for some 
                           
                              a
                              ∈
                              V
                            
                           and 
                           
                              v
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           
                           . Then there exist 
                           
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            
                           having a left or a right restriction, respectively.
                        


                     
                        Proof
                        It suffices to show the existence of 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            supplying a left restriction. If 
                              
                                 
                                    γ
                                 
                                 
                                    l
                                 
                              
                              :
                              =
                              
                                 
                                    γ
                                 
                                 
                                    x
                                    ,
                                    a
                                    ,
                                    v
                                 
                              
                              ⊂
                              P
                            is contained in P, where 
                              x
                              ∈
                              s
                            is the left end point of s or 
                              
                                 
                                    γ
                                 
                                 
                                    l
                                 
                              
                            touches s in x from the right, we are done since x is then a left restriction point. Likewise, if 
                              
                                 
                                    γ
                                 
                                 
                                    0
                                 
                              
                            already has a left restriction. Hence we can assume that the set 
                              X
                              :
                              =
                              {
                              x
                              ∈
                              [
                              s
                              (
                              
                                 
                                    γ
                                 
                                 
                                    l
                                 
                              
                              )
                              ,
                              s
                              (
                              
                                 
                                    γ
                                 
                                 
                                    0
                                 
                              
                              )
                              ]
                              ⊂
                              s
                              |
                              
                                 dist
                              
                              (
                              
                                 
                                    γ
                                 
                                 
                                    x
                                    ,
                                    a
                                    ,
                                    v
                                 
                              
                              ,
                              L
                              (
                              
                                 
                                    γ
                                 
                                 
                                    0
                                 
                              
                              )
                              )
                              >
                              0
                              }
                            is not empty. Obviously, X is bounded below and we can set 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              :
                              =
                              
                                 
                                    γ
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    a
                                    ,
                                    v
                                 
                              
                            with 
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              :
                              =
                              inf
                              (
                              X
                              )
                              ∈
                              s
                           . Due to continuity reasons one can show that 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            and that 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                            has a left restriction.  □

In this section we are interested in all the exiting directions 
                        
                           
                              τ
                           
                           
                              γ
                           
                        
                        (
                        a
                        )
                      of these visibility arcs γ with 
                        e
                        (
                        γ
                        )
                        =
                        a
                      since we later want to compose segments in a smooth manner: The ending direction of the predecessor segment will have to equal the starting direction of the successor segment.

For this purpose, we first introduce the set of all feasible exiting directions of corresponding visibility arcs ending in the same circularly visible point:


                     
                        Definition 7
                        For every 
                              a
                              ∈
                              V
                              ∖
                              s
                            the set 
                              T
                              (
                              a
                              )
                              :
                              =
                              {
                              v
                              |
                              ∃
                              γ
                              ∈
                              S
                              (
                              a
                              )
                               with 
                              v
                              =
                              
                                 
                                    τ
                                 
                                 
                                    γ
                                 
                              
                              (
                              a
                              )
                              }
                            is called feasible direction set of a. We set 
                              T
                              (
                              a
                              )
                              :
                              =
                              ∅
                            for all 
                              a
                              ∈
                              s
                           .

Note that 
                        T
                        (
                        a
                        )
                      is closely related to tangent cones of visibility arcs ending in a. Due to more convenient formulations in the sequel, we prefer the notation introduced in Definition 7.

The properties of the feasible direction sets of the circularly visible points allow efficient characterizations of the sets 
                        S
                        (
                        a
                        )
                     . First we can show:


                     
                        Proposition 2
                        
                           For every 
                           
                              a
                              ∈
                              V
                              ∖
                              s
                            
                           the set 
                           
                              
                                 tr
                              
                              (
                              S
                              (
                              a
                              )
                              )
                              :
                              =
                              {
                              
                                 tr
                              
                              (
                              γ
                              )
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              |
                              γ
                              ∈
                              S
                              (
                              a
                              )
                              }
                            
                           is closed with respect to the Hausdorff metric.
                        


                     
                        Proof
                        Let 
                              
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 
                                    n
                                    ∈
                                    N
                                 
                              
                            be a convergent sequence in 
                              
                                 tr
                              
                              (
                              S
                              (
                              a
                              )
                              )
                            with 
                              A
                              :
                              =
                              
                                 
                                    lim
                                 
                                 
                                    n
                                    →
                                    ∞
                                 
                              
                              
                              
                                 
                                    A
                                 
                                 
                                    n
                                 
                              
                           . Then A is a compact subset of P which is either a point or the trace of some segment γ. Since 
                              a
                              ∈
                              A
                            and 
                              s
                              ∩
                              A
                              ≠
                              ∅
                           , A cannot be a single point. Thus, A is the trace of a segment γ with 
                              s
                              (
                              γ
                              )
                              ∈
                              s
                           , 
                              e
                              (
                              γ
                              )
                              =
                              a
                            and 
                              γ
                              ⊂
                              P
                           . Therefore, we have 
                              γ
                              ∈
                              S
                              (
                              a
                              )
                           , which completes the proof.  □


                     
                        Lemma 3
                        
                           The feasible direction set 
                           
                              T
                              (
                              a
                              )
                              ⊂
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                            
                           is compact for every 
                           
                              a
                              ∈
                              V
                           
                           .
                        


                     
                        Proof
                        It is sufficient to consider a point 
                              a
                              ∈
                              V
                              ∖
                              s
                            since 
                              T
                              (
                              a
                              )
                              =
                              ∅
                            for all 
                              a
                              ∈
                              s
                           . Let 
                              
                                 
                                    E
                                 
                                 
                                    a
                                 
                              
                              :
                              =
                              {
                              (
                              x
                              ,
                              v
                              )
                              ∈
                              s
                              ×
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              |
                              v
                              ≠
                              
                                 
                                    x
                                    −
                                    a
                                 
                                 
                                    ‖
                                    x
                                    −
                                    a
                                    ‖
                                 
                              
                              ,
                              
                                 
                                    γ
                                 
                                 
                                    x
                                    ,
                                    a
                                    ,
                                    v
                                 
                              
                              ∈
                              S
                              (
                              a
                              )
                              }
                            be the subset of all feasible pairs of starting points and exiting directions in a. In order to show that 
                              
                                 
                                    E
                                 
                                 
                                    a
                                 
                              
                            is closed in 
                              s
                              ×
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           , let 
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 
                                    n
                                    ∈
                                    N
                                 
                              
                            be an arbitrary sequence in 
                              
                                 
                                    E
                                 
                                 
                                    a
                                 
                              
                           . According to Proposition 2, the trace set 
                              
                                 tr
                              
                              (
                              S
                              (
                              a
                              )
                              )
                            is closed with respect to the Hausdorff metric. Hence the sequence 
                              
                                 
                                    (
                                    
                                       tr
                                    
                                    (
                                    
                                       
                                          γ
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                n
                                             
                                          
                                          ,
                                          a
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    n
                                    ∈
                                    N
                                 
                              
                            converges to some 
                              
                                 tr
                              
                              (
                              
                                 
                                    γ
                                 
                                 
                                    x
                                    ,
                                    a
                                    ,
                                    v
                                 
                              
                              )
                            with 
                              
                                 
                                    γ
                                 
                                 
                                    x
                                    ,
                                    a
                                    ,
                                    v
                                 
                              
                              ∈
                              S
                              (
                              a
                              )
                            and we obtain 
                              (
                              x
                              ,
                              v
                              )
                              ∈
                              
                                 
                                    E
                                 
                                 
                                    a
                                 
                              
                            by construction of 
                              
                                 
                                    E
                                 
                                 
                                    a
                                 
                              
                           . Clearly, we have 
                              x
                              =
                              
                                 
                                    lim
                                 
                                 
                                    n
                                    →
                                    ∞
                                 
                              
                              
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                            and 
                              v
                              =
                              
                                 
                                    lim
                                 
                                 
                                    n
                                    →
                                    ∞
                                 
                              
                              
                              
                                 
                                    v
                                 
                                 
                                    n
                                 
                              
                           . Therefore, 
                              
                                 
                                    E
                                 
                                 
                                    a
                                 
                              
                              ⊂
                              s
                              ×
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                            is closed and thus compact since 
                              s
                              ×
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                            is compact. As the canonical projection 
                              
                                 
                                    π
                                 
                                 
                                    2
                                 
                              
                              :
                              s
                              ×
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              →
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                            is continuous, we obtain 
                              T
                              (
                              a
                              )
                              =
                              {
                              v
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              |
                              ∃
                              x
                              ∈
                              s
                              :
                              
                                 
                                    γ
                                 
                                 
                                    x
                                    ,
                                    a
                                    ,
                                    v
                                 
                              
                              ∈
                              S
                              (
                              a
                              )
                              }
                              =
                              
                                 
                                    π
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    E
                                 
                                 
                                    a
                                 
                              
                              )
                            is compact as well.  □

To examine further properties, we focus on special exiting directions, to be called ‘extremal’ ones in the following way:


                     
                        Definition 8
                        Let 
                              a
                              ∈
                              V
                            and 
                              v
                              ∈
                              T
                              (
                              a
                              )
                           . We call v left (right) extremal in 
                           
                              T
                              (
                              a
                              )
                            if there exists a neighborhood U of v in 
                              T
                              (
                              a
                              )
                            with 
                              det
                              (
                              v
                              ,
                              w
                              )
                              ⩽
                              0
                            
                           
                              (
                              det
                              (
                              v
                              ,
                              w
                              )
                              ⩾
                              0
                              )
                            for every 
                              w
                              ∈
                              U
                           . A visibility arc 
                              γ
                              ∈
                              S
                              (
                              a
                              )
                            is called left/right extremal if 
                              
                                 
                                    τ
                                 
                                 
                                    γ
                                 
                              
                              (
                              a
                              )
                            is left/right extremal in 
                              T
                              (
                              a
                              )
                           .

It is not hard to see that 
                        T
                        (
                        a
                        )
                      is locally connected and thus the boundary points 
                        ∂
                        T
                        (
                        a
                        )
                      are left or right extremal. For the sake of brevity we simply call them extremal. If we consider a left (right) extremal exiting direction v of 
                        a
                        ∈
                        V
                     , then no visibility arc 
                        γ
                        ∈
                        S
                        (
                        a
                        )
                      with a direction 
                        
                           
                              τ
                           
                           
                              γ
                           
                        
                        (
                        a
                        )
                      that is to the left (right) of v in a suitable small neighborhood exists.

We will merge the two concepts ‘alternating sequences’ and ‘feasible direction sets’ in the following. In the previous section we have seen that for fixed 
                        a
                        ∈
                        V
                      and 
                        v
                        ∈
                        T
                        (
                        a
                        )
                      one can always choose a visibility arc γ with 
                        A
                        (
                        γ
                        )
                        ⩾
                        1
                     . We now show that we even get 
                        A
                        (
                        γ
                        )
                        ⩾
                        2
                      in case of an extremal direction 
                        v
                        ∈
                        T
                        (
                        a
                        )
                     . As already indicated, alternating sequences are used to characterize the three degrees of freedom that visibility arcs possess. Fixing two degrees and ‘driving one into an extremal position’, we obtain an alternating number of at least 1. If only the endpoint is fixed, we have two degrees of freedom that can be modified until they are in an extremal situation. Hence we obtain an alternating number 
                        A
                        (
                        γ
                        )
                        ⩾
                        2
                     .


                     
                        Proposition 4
                        
                           For 
                           
                              a
                              ∈
                              V
                            
                           let 
                           
                              v
                              ∈
                              T
                              (
                              a
                              )
                            
                           be left [right] extremal. Then there exists a 
                           
                              γ
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            
                           having a right [left] restriction.
                        


                     
                        Proof
                        The mapping 
                              (
                              x
                              ,
                              a
                              ,
                              v
                              )
                              ↦
                              
                                 tr
                              
                              (
                              
                                 
                                    γ
                                 
                                 
                                    x
                                    ,
                                    a
                                    ,
                                    v
                                 
                              
                              )
                            is continuous and the function 
                              K
                              (
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              )
                              →
                              R
                              ,
                              A
                              ↦
                              
                                 dist
                              
                              (
                              A
                              ,
                              B
                              )
                            is upper semi-continuous for every 
                              B
                              ∈
                              K
                              (
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              )
                            (cf. Braess, 1986). Setting 
                              B
                              :
                              =
                              L
                              (
                              γ
                              )
                            for a visibility arc γ, we can easily deduce the claimed.  □


                     
                        Theorem 5
                        
                           Let 
                           
                              a
                              ∈
                              V
                            
                           and 
                           
                              v
                              ∈
                              ∂
                              T
                              (
                              a
                              )
                           
                           . Then there exist exactly one visibility arc 
                           
                              γ
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            
                           and a corresponding alternating sequence 
                           
                              (
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              )
                            
                           of length 2 so that 
                           
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                            
                           is a right (left) restriction point if v is left (right) extremal. In particular, we have 
                           
                              A
                              (
                              γ
                              )
                              ⩾
                              2
                           
                           .
                        


                     
                        Proof
                        Let v be left extremal. By Proposition 1 there exists a visibility arc 
                              γ
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            having a right restriction. Let 
                              
                                 
                                    X
                                 
                                 
                                    r
                                 
                              
                            denote the set of all right restriction points of γ. Since 
                              
                                 
                                    X
                                 
                                 
                                    r
                                 
                              
                            is compact and not empty, we can set 
                              
                                 
                                    x
                                 
                                 
                                    r
                                 
                              
                              :
                              =
                              max
                              
                              
                                 
                                    X
                                 
                                 
                                    r
                                 
                              
                            with respect to the orientation of γ. If 
                              
                                 
                                    x
                                 
                                 
                                    r
                                 
                              
                              =
                              a
                           , γ touches ∂P in a with direction v. In this case a is a right restriction point of every visibility arc in 
                              S
                              (
                              a
                              ,
                              v
                              )
                            and Proposition 1 allows choosing γ with an additional left restriction. Otherwise, there exists a point 
                              b
                              ∈
                              γ
                            between a and 
                              
                                 
                                    x
                                 
                                 
                                    r
                                 
                              
                            and a small neighborhood of b being included in P. Let us split γ at b into two segments 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                           . If 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                            would have no left restriction, a visibility arc 
                              η
                              :
                              =
                              
                                 
                                    γ
                                 
                                 
                                    x
                                    ,
                                    b
                                    ,
                                    w
                                 
                              
                              ∈
                              S
                              (
                              b
                              )
                            could be constructed with x being left of 
                              s
                              (
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              )
                            and w being right of 
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              b
                              )
                           . Some possible tedious manipulation yields that η can be continued so that it ends in a and stays inside P. Then however it can be shown that 
                              
                                 
                                    τ
                                 
                                 
                                    η
                                 
                              
                              (
                              a
                              )
                            is left of v, a contradiction.

For the proof of the uniqueness let 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            and let 
                              (
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              )
                            be an alternating sequence of 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                            of length 2. Then we have 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                              ∩
                              
                                 
                                    [
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ≠
                              ∅
                            and thus we can easily conclude that 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            have at least two points and the exiting direction in common. Hence they are equal.

The argumentation proceeds similarly if v is right extremal.  □

Note that the converse of the claim in the theorem above is not true in general. It is not hard to prove that this is equivalent to 
                        T
                        (
                        a
                        )
                        =
                        
                           
                              S
                           
                           
                              1
                           
                        
                     . Furthermore, it is easy to see that 
                        T
                        (
                        a
                        )
                        =
                        
                           
                              S
                           
                           
                              1
                           
                        
                      implies that a is not on the boundary of V. At least the following can be shown:


                     
                        Lemma 6
                        
                           Let 
                           
                              a
                              ∈
                              V
                            
                           and 
                           
                              v
                              ∈
                              T
                              (
                              a
                              )
                              ≠
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           
                           . If a visibility arc 
                           
                              γ
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            
                           has an alternating sequence 
                           
                              (
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              )
                            
                           of length 2 with a right [left] restriction point 
                           
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                           
                           , then v is left [right] extremal.
                        


                     
                        Proof
                        It is sufficient to consider a visibility arc 
                              γ
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            with an alternating sequence 
                              (
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              )
                            of length 2, where 
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                            is a right restriction point. Let us assume that γ is not left extremal. Then for every neighborhood U of v there exists a direction 
                              w
                              ∈
                              U
                            such that 
                              w
                              ∈
                              T
                              (
                              a
                              )
                           , 
                              det
                              (
                              v
                              ,
                              w
                              )
                              >
                              0
                           , and we can choose a 
                              
                                 
                                    γ
                                 
                                 
                                    w
                                 
                              
                              ∈
                              S
                              (
                              a
                              ,
                              w
                              )
                            so that 
                              
                                 
                                    [
                                    x
                                    ,
                                    a
                                    ]
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                            is right of γ for some 
                              x
                              ∈
                              
                                 
                                    γ
                                 
                                 
                                    w
                                 
                              
                           . It can then be shown that 
                              
                                 
                                    γ
                                 
                                 
                                    w
                                 
                              
                              ∩
                              
                                 
                                    [
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    a
                                    [
                                 
                                 
                                    γ
                                 
                              
                            is not empty whenever 
                              ‖
                              v
                              −
                              w
                              ‖
                            is sufficiently small since 
                              {
                              s
                              (
                              η
                              )
                              ∈
                              s
                              |
                              η
                              ∈
                              S
                              (
                              a
                              ,
                              w
                              )
                              }
                            is connected. However, we have 
                              
                                 
                                    [
                                    s
                                    (
                                    γ
                                    )
                                    ,
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    [
                                 
                                 
                                    γ
                                 
                              
                              ∩
                              
                                 
                                    γ
                                 
                                 
                                    w
                                 
                              
                              ≠
                              ∅
                           . Consequently, γ and 
                              
                                 
                                    γ
                                 
                                 
                                    w
                                 
                              
                            have at least three points in common, and we have 
                              γ
                              =
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                           , a contradiction.  □

The characterization of left and right extremal directions of the feasible direction sets by alternating sequences enables the examination of further properties of 
                        T
                        (
                        a
                        )
                     :


                     
                        Proposition 7
                        
                           Let 
                           
                              a
                              ∈
                              V
                              ∖
                              s
                            
                           and let 
                           
                              T
                              (
                              a
                              )
                              ≠
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           
                           . Then 
                           
                              T
                              (
                              a
                              )
                            
                           contains exactly one left and one right extremal direction.
                        


                     
                        Proof
                        Obviously, 
                              T
                              (
                              a
                              )
                            is not empty. It is sufficient to show the existence and uniqueness of a left extremal direction. The existence follows from the local connectivity and compactness of 
                              T
                              (
                              a
                              )
                            (cf. Lemma 3). For the proof of the uniqueness let 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                            be two left extremal directions. Then by Theorem 5 we can choose visibility arcs 
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                              ∈
                              S
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                            and alternating sequences 
                              (
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                              )
                            of length 2 with right restriction points 
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                            for 
                              i
                              =
                              1
                              ,
                              2
                           . It follows that 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            have at least three distinct points in common, which means that they are equal. Hence 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                           .  □

Since 
                        T
                        (
                        a
                        )
                      is locally connected, Proposition 7 yields the following: 
                        Corollary 8
                        
                           The feasible direction set 
                           
                              T
                              (
                              a
                              )
                            
                           is connected for every 
                           
                              a
                              ∈
                              V
                           
                           .
                        

Obviously, an exiting direction 
                        v
                        ∈
                        T
                        (
                        a
                        )
                      is left and right extremal if and only if it is an isolated point of 
                        T
                        (
                        a
                        )
                     . Hence by Corollary 8 we obtain: 
                        Corollary 9
                        
                           A direction 
                           
                              v
                              ∈
                              T
                              (
                              a
                              )
                            
                           is left and right extremal if and only if 
                           
                              T
                              (
                              a
                              )
                              =
                              {
                              v
                              }
                           
                           .
                        

For continuity reasons we obtain: 
                        Corollary 10
                        
                           Let 
                           
                              a
                              ∈
                              V
                            
                           and 
                           
                              v
                              ∈
                              T
                              
                                 
                                    (
                                    a
                                    )
                                 
                                 
                                    ∘
                                 
                              
                            
                           with 
                           
                              T
                              (
                              a
                              )
                              ≠
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           
                           . Then there exists a visibility arc 
                           
                              γ
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            
                           having neither a left nor a right restriction.
                        

With the aid of the two instruments alternating sequences and feasible directions sets we are able to characterize the set V: In the previous sections we have seen that we can choose visibility arcs γ with 
                        A
                        (
                        γ
                        )
                        ⩾
                        1
                      for a fixed endpoint 
                        a
                        ∈
                        V
                      and exiting direction 
                        v
                        ∈
                        T
                        (
                        a
                        )
                     . If v is extremal, we can even require an alternating number of at least two as two of the three degrees of freedom have been driven to an extremal position. Visibility arcs ending in a point of the boundary of V with respect to the relative topology on P are called blocking arcs. We will prove that blocking arcs have at least three alternating restrictions. This allows us to describe them in an efficient manner and to enable a constructive approach in view of developing an algorithm. We will focus on one special blocking arc, namely the window, which is the one being ‘nearest’ to the destination segment d. 
                        Lemma 11
                        
                           For 
                           
                              a
                              ∈
                              V
                            
                           with 
                           
                              card
                              (
                              T
                              (
                              a
                              )
                              )
                              =
                              1
                            
                           we have 
                           
                              card
                              (
                              S
                              (
                              a
                              )
                              )
                              =
                              1
                           
                           .
                        

As 
                              T
                              (
                              a
                              )
                              ≠
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           , we have 
                              N
                              :
                              =
                              card
                              (
                              S
                              (
                              a
                              )
                              )
                              ∈
                              {
                              1
                              ,
                              ∞
                              }
                           . Let us assume 
                              N
                              =
                              ∞
                           . For continuity reasons then there is a 
                              γ
                              ∈
                              S
                              (
                              a
                              )
                            without any restriction point. By Theorem 5 
                           
                              v
                              :
                              =
                              
                                 
                                    τ
                                 
                                 
                                    γ
                                 
                              
                              (
                              a
                              )
                            is not an extremal direction, a contradiction since 
                              ∂
                              T
                              (
                              a
                              )
                              =
                              T
                              (
                              a
                              )
                           . Thus, 
                              N
                              =
                              1
                           .  □

A visibility arc 
                              γ
                              ∈
                              S
                            is called right-blocking if the points to its right hand side are not visible in neighborhood, i.e.: There exist a point 
                              a
                              ∈
                              γ
                              ∩
                              
                                 
                                    P
                                 
                                 
                                    ∘
                                 
                              
                            and a neighborhood U of a with 
                              
                                 
                                    U
                                 
                                 
                                    r
                                 
                              
                              ∩
                              V
                              =
                              ∅
                           , where
                              
                                 
                                    
                                       
                                          U
                                       
                                       
                                          r
                                       
                                    
                                    :
                                    =
                                    
                                       {
                                       x
                                       ∈
                                       U
                                       |
                                       det
                                       
                                       
                                          (
                                          x
                                          −
                                          y
                                          ,
                                          
                                             
                                                τ
                                             
                                             
                                                γ
                                             
                                          
                                          (
                                          y
                                          )
                                          )
                                       
                                       >
                                       0
                                       
                                       ∀
                                       y
                                       ∈
                                       γ
                                        with 
                                       ‖
                                       x
                                       −
                                       y
                                       ‖
                                       =
                                       
                                          dist
                                       
                                       (
                                       x
                                       ,
                                       γ
                                       )
                                       }
                                    
                                    .
                                 
                              
                            The term left-blocking and 
                              
                                 
                                    U
                                 
                                 
                                    l
                                 
                              
                            are defined analogously. We simply call γ blocking if it is left- or right-blocking.

Obviously, the blocking arcs are exactly the visibility arcs γ containing boundary points 
                        a
                        ∈
                        ∂
                        V
                        ∖
                        ∂
                        P
                     . We will show that these segments are exactly the segments supplying alternating sequences of length 3 and examine how the terms right- and left-blocking relate to specific alternating sequences. 
                        Theorem 12
                        
                           For 
                           
                              a
                              ∈
                              V
                              ∖
                              ∂
                              P
                            
                           and 
                           
                              γ
                              ∈
                              S
                              (
                              a
                              )
                            
                           the following is equivalent:
                           
                              
                                 1)
                                 
                                    
                                       a
                                       ∈
                                       ∂
                                       V
                                    
                                    ,
                                 


                                    
                                       T
                                       (
                                       a
                                       )
                                     
                                    is a singleton, i.e. 
                                    
                                       card
                                       (
                                       T
                                       (
                                       a
                                       )
                                       )
                                       =
                                       1
                                    
                                    ,
                                 


                                    
                                       S
                                       (
                                       a
                                       )
                                       =
                                       {
                                       γ
                                       }
                                     
                                    and 
                                    
                                       A
                                       (
                                       γ
                                       )
                                       ⩾
                                       3
                                    
                                    ,
                                 


                                    γ is a blocking arc.
                                 

The implication ‘
                              1
                              )
                              ⇒
                              2
                              )
                           ’ is shown as follows: Trivially, 
                              T
                              (
                              a
                              )
                            is not empty, i.e. it contains at least one feasible direction. If 
                              card
                              (
                              T
                              (
                              a
                              )
                              )
                              >
                              1
                           , we can choose a direction v from the interior of 
                              T
                              (
                              a
                              )
                            since 
                              T
                              (
                              a
                              )
                            is connected (cf. Corollary 8), Hence there is a 
                              γ
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            having neither a right nor a left restriction (cf. Corollary 10). For continuity reasons we obtain a whole neighborhood U that is visible, i.e. 
                              U
                              ⊂
                              V
                           , a contradiction to a being on the boundary of V.

Next we consider the implication ‘
                              2
                              )
                              ⇒
                              3
                              )
                           ’: Since 
                              a
                              ∉
                              ∂
                              P
                           , the set 
                              S
                              (
                              a
                              ,
                              v
                              )
                              =
                              S
                              (
                              a
                              )
                            is a singleton by Lemma 11. The unique corresponding visibility arc γ is left and right extremal since v is left and right extremal. Hence we have alternating sequences 
                              (
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              )
                            and 
                              (
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    4
                                 
                              
                              )
                            of γ of length 2, where 
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                            is a right restriction and 
                              
                                 
                                    a
                                 
                                 
                                    4
                                 
                              
                            is a left restriction point, and we obtain an alternating sequence 
                              (
                              
                                 
                                    a
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              )
                            of length 3 with 
                              
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              4
                              }
                           , i.e. 
                              A
                              (
                              γ
                              )
                              ⩾
                              3
                           .

In order to show the implication ‘
                              3
                              )
                              ⇒
                              4
                              )
                           ’, let 
                              (
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                              )
                            be an alternating sequence of γ of length 3 where we assume that 
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                            is a right restriction point. If we denote the connected component of 
                              
                                 
                                    P
                                 
                                 
                                    ∘
                                 
                              
                              ∖
                              
                                 
                                    [
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          a
                                       
                                       
                                          3
                                       
                                    
                                    ]
                                 
                                 
                                    γ
                                 
                              
                            not containing s by C, we can choose a point 
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ∈
                              ]
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                              ,
                              e
                              (
                              γ
                              )
                              [
                              ∩
                              C
                            and a neighborhood U of 
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                            included in C. By construction every visibility arc 
                              
                                 
                                    γ
                                 
                                 
                                    x
                                 
                              
                            of a point 
                              x
                              ∈
                              U
                            has to cross 
                              
                                 
                                    [
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          a
                                       
                                       
                                          3
                                       
                                    
                                    ]
                                 
                                 
                                    γ
                                 
                              
                            at some 
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                           . According to Lemma 6, 
                              
                                 
                                    τ
                                 
                                 
                                    γ
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                              )
                              ∈
                              T
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                              )
                            is right-extremal. Hence 
                              
                                 
                                    γ
                                 
                                 
                                    x
                                 
                              
                            is locally left to γ in 
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                           . Supposing 
                              x
                              ∈
                              
                                 
                                    U
                                 
                                 
                                    r
                                 
                              
                           , 
                              
                                 
                                    γ
                                 
                                 
                                    x
                                 
                              
                            is locally right to γ in x and there must be an intersection 
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              (
                              x
                              )
                              ∈
                              
                                 
                                    ]
                                    
                                       
                                          a
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    e
                                    (
                                    γ
                                    )
                                    ]
                                 
                                 
                                    γ
                                 
                              
                              ∩
                              
                                 
                                    γ
                                 
                                 
                                    x
                                 
                              
                            with 
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          x
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              (
                              x
                              )
                              )
                            right to 
                              
                                 
                                    τ
                                 
                                 
                                    γ
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              (
                              x
                              )
                              )
                           . But again by Lemma 6 
                           
                              
                                 
                                    τ
                                 
                                 
                                    γ
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              (
                              x
                              )
                              )
                              ∈
                              T
                              (
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              (
                              x
                              )
                              )
                            is right-extremal, a contradiction.

Eventually, the implication ‘
                              4
                              )
                              ⇒
                              1
                              )
                           ’ follows directly from the definition of a blocking arc.  □

The terms ‘right-blocking’ and ‘left-blocking’ are not mutually exclusive: A visibility arc γ is left- and right-blocking if and only if 
                        A
                        (
                        γ
                        )
                        ⩾
                        4
                     . In any case, there are finitely many blocking arcs 
                        
                           
                              γ
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              γ
                           
                           
                              n
                           
                        
                      describing the boundary of V, i.e. 
                        ∂
                        V
                        ∖
                        ∂
                        P
                        ⊂
                        
                           
                              ⋃
                           
                           
                              i
                              =
                              1
                           
                           
                              m
                           
                        
                        
                           
                              γ
                           
                           
                              i
                           
                        
                     .

Exactly one blocking arc corresponds to each connected component of 
                        P
                        ∖
                        V
                     . Of course, we are especially interested in the connected component containing the destination d. The corresponding blocking arc is called window: 
                        Definition 10
                        Let 
                              V
                              ∩
                              d
                              =
                              ∅
                           , and let 
                              
                                 
                                    C
                                 
                                 
                                    ⁎
                                 
                              
                            denote the connected component of 
                              P
                              ∖
                              V
                            containing d. Then the blocking arc ω which is uniquely determined by the set inclusion 
                              
                                 
                                    
                                       C
                                    
                                    
                                       ⁎
                                    
                                 
                                 ¯
                              
                              ∩
                              V
                              ⊂
                              ω
                            is called window.

To keep the exposition as simple as possible and to avoid special cases let us assume for the rest of the paper that each blocking arc has an alternating number of exactly three. A more general treatise can be found in Maier (2010). In particular, we assume that ω has a unique alternating sequence 
                        (
                        
                           
                              a
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              a
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              a
                           
                           
                              3
                           
                        
                        )
                      of length three. Then we can define another useful term: 
                        Definition 11
                        The subset 
                              
                                 
                                    V
                                 
                                 
                                    ˜
                                 
                              
                              ⊂
                              V
                            is the closure of the connected component of 
                              V
                              ∖
                              
                                 
                                    [
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    e
                                    (
                                    ω
                                    )
                                    ]
                                 
                                 
                                    ω
                                 
                              
                            which does not contain s.

It is not hard to prove that 
                        
                           
                              V
                           
                           
                              ˜
                           
                        
                      is compact. An illustration can be found in Fig. 4
                     .

The local property ‘left’ and ‘right’ in the definition of alternating sequences can be replaced by a global one in the case of the window. The alternating restrictions defining the window are described due to the left and right channel 
                        
                           
                              P
                           
                           
                              l
                           
                        
                      and 
                        
                           
                              P
                           
                           
                              r
                           
                        
                     : The counterclockwise polygonal path of P from 
                        e
                        (
                        s
                        )
                      to 
                        s
                        (
                        d
                        )
                      is denoted by 
                        
                           
                              P
                           
                           
                              r
                           
                        
                     . Analogously, 
                        
                           
                              P
                           
                           
                              l
                           
                        
                      is the clockwise polygonal path from 
                        s
                        (
                        s
                        )
                      to 
                        e
                        (
                        d
                        )
                      (cf. Fig. 4). 
                        Theorem 13
                        
                           There are points 
                           
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    4
                                 
                              
                              :
                              =
                              e
                              (
                              ω
                              )
                            
                           of ω such that 
                           
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    3
                                 
                              
                            
                           is an alternating sequence of length three and
                           
                              
                                 i)
                                 
                                    either 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             4
                                          
                                       
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             l
                                          
                                       
                                     
                                    and 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             3
                                          
                                       
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             r
                                          
                                       
                                    
                                 


                                    or 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             4
                                          
                                       
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             r
                                          
                                       
                                     
                                    and 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             3
                                          
                                       
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             l
                                          
                                       
                                    
                                    .
                                 


                     
                        Proof
                        Let ω be right-blocking. By definition we can choose an alternating sequence 
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                            with 
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    r
                                 
                              
                            and 
                              
                                 
                                    a
                                 
                                 
                                    4
                                 
                              
                              :
                              =
                              e
                              (
                              ω
                              )
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    l
                                 
                              
                           . Hence we have 
                              L
                              (
                              ω
                              )
                              ⊂
                              
                                 
                                    P
                                 
                                 
                                    l
                                 
                              
                            and 
                              R
                              (
                              ω
                              )
                              ⊂
                              
                                 
                                    P
                                 
                                 
                                    r
                                 
                              
                            and therefore 
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    l
                                 
                              
                            (cf. Definition 4).

On the one hand, only the connected component 
                              
                                 
                                    C
                                 
                                 
                                    ⁎
                                 
                              
                            containing d satisfies 
                              
                                 
                                    P
                                 
                                 
                                    l
                                 
                              
                              ∩
                              
                                 
                                    C
                                 
                                 
                                    ⁎
                                 
                              
                              ≠
                              ∅
                              ≠
                              
                                 
                                    P
                                 
                                 
                                    r
                                 
                              
                              ∩
                              
                                 
                                    C
                                 
                                 
                                    ⁎
                                 
                              
                           . On the other hand, we have 
                              
                                 
                                    
                                       C
                                    
                                    
                                       ⁎
                                    
                                 
                                 ¯
                              
                              ∩
                              V
                              ⊂
                              ω
                           . Thus, also the addendum follows.  □

We have discussed the properties of V on the assumption that d is not circularly visible. The development of the blocking arcs and the window are crucial for this purpose. If we consider d and V not to be disjoint, the term ‘window’ is not generally well-defined any longer. However, we have the following property:


                     
                        Lemma 14
                        
                           If 
                           
                              V
                              ∩
                              d
                              ≠
                              ∅
                           
                           , there exists a visibility arc γ ending in d and points 
                           
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                            
                           on γ so that one of the following conditions hold:
                           
                              
                                 1)
                                 
                                    
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             3
                                          
                                       
                                       )
                                     
                                    is an alternating sequence of length 3.
                                 


                                    
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       )
                                     
                                    is an alternating sequence of length 2 and 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       e
                                       (
                                       γ
                                       )
                                     
                                    is an endpoint of d.
                                 


                     
                        Proof
                        If an endpoint a of d is visible, we can choose a 
                              v
                              ∈
                              ∂
                              T
                              (
                              a
                              )
                            since obviously 
                              T
                              (
                              a
                              )
                              ≠
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           . Hence by Theorem 5 there is a visibility arc 
                              γ
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            with 
                              A
                              (
                              γ
                              )
                              ⩾
                              2
                           . Otherwise, 
                              V
                              ∩
                              d
                            is a line segment and a visibility arc γ ending in an endpoint of this line segment has to be a blocking arc. Therefore, we obtain by Theorem 12: 
                              A
                              (
                              γ
                              )
                              ⩾
                              3
                           .  □

In order to characterize the n-visibility set 
                        
                           
                              V
                           
                           
                              n
                           
                        
                      with 
                        n
                        >
                        1
                     , we first have to work out the behavior of the feasible direction sets when the corresponding points are varied. Our idea will be to use the intermediate value theorem in order to give an equivalent condition whether a segment can be joined with a predecessor visibility arc.

In order to examine the continuity properties of the feasible direction sets, it is useful to consider T as a mapping that assigns its feasible direction set to every circularly visible point:
                        
                           
                              T
                              :
                              V
                              ∖
                              s
                              →
                              K
                              
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ,
                              
                              a
                              ↦
                              T
                              (
                              a
                              )
                              .
                           
                        
                     
                  


                     
                        T
                        (
                        a
                        )
                      is not empty for all 
                        a
                        ∈
                        V
                        ∖
                        s
                      and compact by Lemma 3. Thus, T is well-defined. Let us now establish its continuity properties: First we show the upper semi-continuity, which is comparatively easy to prove. We will see later on that T is not lower semi-continuous on V but on the subset 
                        
                           
                              V
                           
                           
                              ˜
                           
                        
                        ∖
                        ∂
                        P
                     . For the verification of the lower semi-continuity we will need more technical effort. However, we first show:


                     
                        Lemma 15
                        
                           T is upper semi-continuous.
                        


                     
                        Proof
                        Since 
                              V
                              ×
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                            is compact and 
                              V
                              ∖
                              s
                            is locally compact, it is sufficient to show that for every compact subset 
                              K
                              ⊂
                              V
                              ∖
                              s
                            the set 
                              
                                 graph
                              
                              
                                 
                                    (
                                    T
                                    |
                                 
                                 
                                    K
                                 
                              
                              )
                              :
                              =
                              {
                              (
                              a
                              ,
                              v
                              )
                              ∈
                              K
                              ×
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              |
                              v
                              ∈
                              T
                              (
                              a
                              )
                              }
                            is closed (cf. Aubin and Frankowska, 1990, Prop. 1.4.12). Let 
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 
                                    n
                                    ∈
                                    N
                                 
                              
                            be a sequence in 
                              
                                 graph
                              
                              
                                 
                                    (
                                    T
                                    |
                                 
                                 
                                    K
                                 
                              
                              )
                            converging to a pair 
                              (
                              a
                              ,
                              v
                              )
                            with 
                              a
                              ∈
                              K
                            since K is compact. For 
                              n
                              ∈
                              N
                            we can choose a visibility arc 
                              
                                 
                                    γ
                                 
                                 
                                    n
                                 
                              
                              ∈
                              S
                              (
                              
                                 
                                    a
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    n
                                 
                              
                              )
                           . By passing to a subsequence if necessary, we can assume that 
                              
                                 
                                    (
                                    
                                       tr
                                    
                                    (
                                    
                                       
                                          γ
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    n
                                    ∈
                                    N
                                 
                              
                            converges to 
                              
                                 tr
                              
                              (
                              γ
                              )
                            due to Proposition 2. Even more we obtain 
                              
                                 
                                    τ
                                 
                                 
                                    γ
                                 
                              
                              (
                              a
                              )
                              =
                              v
                            because of the convergence of 
                              
                                 
                                    (
                                    
                                       tr
                                    
                                    (
                                    
                                       
                                          γ
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    n
                                    ∈
                                    N
                                 
                              
                            since 
                              
                                 
                                    γ
                                 
                                 
                                    n
                                 
                              
                            is a segment. However, this means 
                              γ
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                           , and hence we have 
                              (
                              a
                              ,
                              v
                              )
                              ∈
                              
                                 graph
                              
                              
                                 
                                    (
                                    T
                                    |
                                 
                                 
                                    K
                                 
                              
                              )
                           , which completes the proof.  □

Since we need the lower semi-continuity just for a subset of V, we focus on the set 
                        
                           
                              V
                           
                           
                              ˜
                           
                        
                     . Dealing with the whole set of circularly visible points would be somewhat clumsy. We will show that the mapping T is lower semi-continuous at all points of 
                        
                           
                              V
                           
                           
                              ˜
                           
                        
                      except the vertices of P. For this purpose, we distinguish between three cases: First we focus on points 
                        a
                        ∈
                        
                           
                              V
                           
                           
                              ˜
                           
                        
                        ∖
                        ∂
                        P
                      and interior directions 
                        v
                        ∈
                        T
                        
                           
                              (
                              a
                              )
                           
                           
                              ∘
                           
                        
                     . Next, we take smooth points on the boundary 
                        ∂
                        P
                        ∩
                        
                           
                              V
                           
                           
                              ˜
                           
                        
                      and interior directions into account. Eventually, the enhancement to boundary directions can be deduced by a ‘diagonal trick’.


                     
                        Lemma 16
                        
                           For every 
                           
                              a
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    ˜
                                 
                              
                              ∖
                              ∂
                              P
                            
                           and 
                           
                              v
                              ∈
                              T
                              
                                 
                                    (
                                    a
                                    )
                                 
                                 
                                    ∘
                                 
                              
                            
                           we obtain: For all 
                           
                              ε
                              >
                              0
                            
                           there exists a 
                           
                              δ
                              >
                              0
                            
                           such that for all 
                           
                              x
                              ∈
                              V
                            
                           with 
                           
                              ‖
                              x
                              −
                              a
                              ‖
                              <
                              δ
                            
                           there is a feasible direction 
                           
                              w
                              ∈
                              T
                              (
                              x
                              )
                            
                           with 
                           
                              ‖
                              v
                              −
                              w
                              ‖
                              <
                              ε
                           
                           .
                        


                     
                        Proof
                        By Corollary 10 there exists a visibility arc 
                              
                                 
                                    γ
                                 
                                 
                                    0
                                 
                              
                              ∈
                              S
                              (
                              a
                              ,
                              v
                              )
                            having neither a left nor a right restriction since v is not an extremal direction. Thus, there exists a 
                              δ
                              >
                              0
                            with 
                              S
                              (
                              x
                              ,
                              v
                              )
                              ≠
                              ∅
                            and hence 
                              v
                              ∈
                              T
                              (
                              x
                              )
                            for all 
                              x
                              ∈
                              V
                            with 
                              ‖
                              x
                              −
                              a
                              ‖
                              <
                              δ
                           .  □


                     
                        Proposition 17
                        
                           Let 
                           
                              a
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    ˜
                                 
                              
                              ∩
                              ∂
                              P
                            
                           not be a vertex of P and 
                           
                              v
                              ∈
                              T
                              
                                 
                                    (
                                    a
                                    )
                                 
                                 
                                    ∘
                                 
                              
                            
                           an interior direction. Then for all 
                           
                              ε
                              >
                              0
                            
                           there exists a neighborhood U of a such that for all 
                           
                              x
                              ∈
                              U
                              ∩
                              P
                            
                           there is a direction 
                           
                              
                                 
                                    v
                                 
                                 
                                    x
                                 
                              
                              ∈
                              T
                              (
                              x
                              )
                            
                           with 
                           
                              ‖
                              v
                              −
                              
                                 
                                    v
                                 
                                 
                                    x
                                 
                              
                              ‖
                              <
                              ε
                           
                           .
                        


                     
                        Proof
                        We only give a short sketch of the proof. The full argumentation can again be found in Maier (2010). Since a is not a vertex of P, the tangent cone on P is the half-plane defined by the corresponding edge of P for all points in a sufficiently small neighborhood of a in ∂P. The idea now is to slightly extend the given tolerance channel so that the boundary point 
                              a
                              ∈
                              ∂
                              P
                            will become an interior point of the extended channel and use the results from Lemma 16: Consider the canonical extension 
                              
                                 
                                    P
                                 
                                 
                                    ˜
                                 
                              
                              :
                              =
                              P
                              ∪
                              
                                 
                                    B
                                 
                                 
                                    δ
                                 
                              
                              (
                              a
                              )
                            of P for a suitable δ, where 
                              
                                 
                                    B
                                 
                                 
                                    δ
                                 
                              
                              (
                              a
                              )
                            denotes the compact square with center a and edge length δ. Obviously, a is an interior point of the visibility set with respect to 
                              
                                 
                                    P
                                 
                                 
                                    ˜
                                 
                              
                            and v is a corresponding interior direction. Applying Lemma 16 yields the existence of a neighborhood 
                              
                                 
                                    U
                                 
                                 
                                    ˜
                                 
                              
                            of a such that for all 
                              x
                              ∈
                              
                                 
                                    U
                                 
                                 
                                    ˜
                                 
                              
                            there is a feasible direction 
                              
                                 
                                    v
                                 
                                 
                                    x
                                 
                              
                            in 
                              x
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    ˜
                                 
                              
                            with 
                              ‖
                              v
                              −
                              
                                 
                                    v
                                 
                                 
                                    x
                                 
                              
                              ‖
                            sufficiently small. Consequently, it can be shown that for all 
                              x
                              ∈
                              U
                              :
                              =
                              
                                 
                                    U
                                 
                                 
                                    ˜
                                 
                              
                              ∩
                              V
                            the direction 
                              
                                 
                                    v
                                 
                                 
                                    x
                                 
                              
                            is contained in 
                              T
                              (
                              x
                              )
                           , thus completing the proof.  □


                     
                        Lemma 18
                        
                           T is lower semi-continuous on 
                           
                              
                                 
                                    V
                                 
                                 
                                    ˜
                                 
                              
                              ∖
                              ∂
                              P
                            
                           and at all smooth points of 
                           
                              
                                 
                                    V
                                 
                                 
                                    ˜
                                 
                              
                              ∩
                              ∂
                              P
                           
                           .
                        


                     
                        Proof
                        Choose 
                              a
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    ˜
                                 
                              
                            which is not a vertex of P and 
                              v
                              ∈
                              T
                              (
                              a
                              )
                           . Let 
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 
                                    n
                                    ∈
                                    N
                                 
                              
                            be a sequence in V convergent to a and 
                              ε
                              >
                              0
                           . Since 
                              T
                              (
                              a
                              )
                            is connected, either its interior is not empty or 
                              T
                              (
                              a
                              )
                            is a singleton. If 
                              v
                              ∈
                              T
                              
                                 
                                    (
                                    a
                                    )
                                 
                                 
                                    ∘
                                 
                              
                           , we obtain by Lemma 16 and Proposition 17 that there exists a 
                              
                                 
                                    v
                                 
                                 
                                    n
                                 
                              
                              ∈
                              T
                              (
                              
                                 
                                    a
                                 
                                 
                                    n
                                 
                              
                              )
                            with 
                              ‖
                              v
                              −
                              
                                 
                                    v
                                 
                                 
                                    n
                                 
                              
                              ‖
                              <
                              ε
                            whenever 
                              n
                              >
                              N
                            for some 
                              N
                              ∈
                              N
                           . Let us now focus on a boundary direction 
                              v
                              ∈
                              ∂
                              T
                              (
                              a
                              )
                            with 
                              T
                              
                                 
                                    (
                                    a
                                    )
                                 
                                 
                                    ∘
                                 
                              
                              ≠
                              ∅
                           . Since 
                              T
                              (
                              a
                              )
                            has no isolated points by Corollary 8, we can deduce the existence of a 
                              w
                              ∈
                              T
                              
                                 
                                    (
                                    a
                                    )
                                 
                                 
                                    ∘
                                 
                              
                            with 
                              ‖
                              w
                              −
                              v
                              ‖
                              <
                              
                                 ε
                                 2
                              
                           . As above, we obtain directions 
                              
                                 
                                    v
                                 
                                 
                                    n
                                 
                              
                              ∈
                              T
                              (
                              
                                 
                                    a
                                 
                                 
                                    n
                                 
                              
                              )
                            with 
                              ‖
                              w
                              −
                              
                                 
                                    v
                                 
                                 
                                    n
                                 
                              
                              ‖
                              <
                              
                                 ε
                                 2
                              
                            whenever 
                              n
                              >
                              N
                            for some 
                              N
                              ∈
                              N
                           . Thus, we have
                              
                                 
                                    ‖
                                    
                                       
                                          v
                                       
                                       
                                          n
                                       
                                    
                                    −
                                    v
                                    ‖
                                    =
                                    
                                       ‖
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       w
                                       )
                                       +
                                       (
                                       w
                                       −
                                       v
                                       )
                                       ‖
                                    
                                    ⩽
                                    ‖
                                    
                                       
                                          v
                                       
                                       
                                          n
                                       
                                    
                                    −
                                    w
                                    ‖
                                    +
                                    ‖
                                    w
                                    −
                                    v
                                    ‖
                                    <
                                    
                                       ε
                                       2
                                    
                                    +
                                    
                                       ε
                                       2
                                    
                                    =
                                    ε
                                    ,
                                 
                              
                            which completes the proof in the case of 
                              T
                              (
                              a
                              )
                            not being a singleton.

Let 
                              T
                              (
                              a
                              )
                            now be a singleton, for instance 
                              T
                              (
                              a
                              )
                              :
                              =
                              {
                              v
                              }
                           . Considering an arbitrary 
                              ε
                              >
                              0
                            and a sequence 
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 
                                    n
                                    ∈
                                    N
                                 
                              
                            in V convergent to a, there exists a bound 
                              N
                              ∈
                              N
                            so that 
                              T
                              (
                              
                                 
                                    a
                                 
                                 
                                    n
                                 
                              
                              )
                              ⊂
                              {
                              w
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              |
                              ‖
                              v
                              −
                              w
                              ‖
                              <
                              ε
                              }
                            for all 
                              n
                              ⩾
                              N
                            since T is upper semi-continuous at a (cf. Lemma 15). In particular, we can choose a 
                              
                                 
                                    v
                                 
                                 
                                    n
                                 
                              
                              ∈
                              T
                              (
                              
                                 
                                    a
                                 
                                 
                                    n
                                 
                              
                              )
                            with 
                              ‖
                              v
                              −
                              
                                 
                                    v
                                 
                                 
                                    n
                                 
                              
                              ‖
                              <
                              ε
                            for all 
                              n
                              ⩾
                              N
                           . Hence we obtain a sequence 
                              
                                 
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 
                                    n
                                    ∈
                                    N
                                 
                              
                            converging to v and we have shown the lower semi-continuity at points whose direction set is a singleton as well.  □

Altogether, we obtain directly: 
                        Corollary 19
                        
                           T is continuous on 
                           
                              
                                 
                                    V
                                 
                                 
                                    ˜
                                 
                              
                            
                           except the vertices of P.
                        

In Fig. 5
                      the direction sets of some circularly visible points are depicted to outline the continuity attitudes of the mapping T. Note that the direction set at a vertex can abruptly increase but not abruptly shrink when approaching the vertex since T is at least upper semi-continuous. Furthermore, it is illustrated that 
                        T
                        (
                        x
                        )
                      is steadily getting smaller when approaching the boundary of V and on ∂V it is just a singleton (cf. Theorem 12).

We now give a characterization of the n-visibility set 
                        
                           
                              V
                           
                           
                              n
                           
                        
                     , the set of all points that can be reached by a smooth arc spline with n segments, 
                        n
                        >
                        1
                     . First, we focus on the set 
                        
                           
                              V
                           
                           
                              2
                           
                        
                      and then proceed inductively. Unfortunately, the set 
                        
                           
                              V
                           
                           
                              2
                           
                        
                        ∖
                        V
                      is not simply the set of all end points 
                        a
                        ∈
                        P
                      of visibility splines with two segments of which the first segment is a restriction of the corresponding blocking.

In order to characterize 
                        
                           
                              V
                           
                           
                              2
                           
                        
                     , we examine conditions whether for an arbitrary segment γ in P there is a visibility arc which γ can be smoothly joined with. The properties of the mapping T worked out previously are used for this purpose. It will turn out that 
                        
                           
                              V
                           
                           
                              2
                           
                        
                      can be computed by examining tolerance channels with a more sophisticated starting condition, the so-called continuation condition. For simplicity we focus on the examination of the connected component 
                        
                           
                              C
                           
                           
                              ⁎
                           
                        
                      of 
                        P
                        ∖
                        V
                      (cf. Definition 10) leading to d.

First we present a lemma proved by homotopy techniques. By combining this lemma with the continuity properties of the feasible direction sets, we give an equivalent condition for when a segment γ within P can be smoothly joined to a visibility arc of 
                        (
                        P
                        ,
                        s
                        ,
                        d
                        )
                     . The idea is stated as follows: Considering two points 
                        
                           
                              x
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              x
                           
                           
                              2
                           
                        
                      of γ where the tangent unit vector 
                        
                           
                              τ
                           
                           
                              γ
                           
                        
                        (
                        
                           
                              x
                           
                           
                              1
                           
                        
                        )
                      is ‘left’ of 
                        T
                        (
                        
                           
                              x
                           
                           
                              1
                           
                        
                        )
                      and 
                        
                           
                              τ
                           
                           
                              γ
                           
                        
                        (
                        
                           
                              x
                           
                           
                              2
                           
                        
                        )
                      is ‘right’ of 
                        T
                        (
                        
                           
                              x
                           
                           
                              2
                           
                        
                        )
                     , there must be a point 
                        x
                        ∈
                        γ
                      between 
                        
                           
                              x
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              x
                           
                           
                              2
                           
                        
                      with 
                        
                           
                              τ
                           
                           
                              γ
                           
                        
                        (
                        x
                        )
                        ∈
                        T
                        (
                        x
                        )
                      by the intermediate value theorem. Hence there exists a visibility arc smoothly joined to γ. In particular, 
                        e
                        (
                        γ
                        )
                        ∈
                        
                           
                              V
                           
                           
                              2
                           
                        
                     .


                     
                        Definition 12
                        A segment γ satisfies the continuation condition (CC) with respect to a segment η if one of the following conditions hold:
                              
                                 i)
                                 There is a point 
                                       x
                                       ∈
                                       γ
                                       ∩
                                       η
                                     with 
                                       
                                          
                                             τ
                                          
                                          
                                             γ
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          
                                             τ
                                          
                                          
                                             η
                                          
                                       
                                       (
                                       x
                                       )
                                     or

there are two intersection points 
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                     of γ and η so that the order induced by γ and the one induced by η are equal: 
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             ≺
                                          
                                          
                                             γ
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                     and 
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             ≺
                                          
                                          
                                             η
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                    .


                           Let 
                           
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            
                           be a segment in P with 
                           
                              e
                              (
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              a
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    ⁎
                                 
                              
                           
                           , and suppose that 
                           
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              ∈
                              S
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                            
                           for some 
                           
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    [
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            
                           with 
                           
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              ±
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           , where 
                           
                              {
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              }
                              =
                              ω
                              ∩
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            
                           with 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    ≺
                                 
                                 
                                    ω
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           
                           . Furthermore, suppose there exist 
                           
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              ∩
                              ω
                            
                           which satisfy one of the following two properties
                           
                              
                                 i)
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             ≺
                                          
                                          
                                             ω
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                     
                                    and 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             ≺
                                          
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                     
                                    or
                                 


                                    
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                     
                                    and 
                                    
                                       
                                          
                                             τ
                                          
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             τ
                                          
                                          
                                             ω
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    .
                                 


                     
                        Proof
                        Let 
                              w
                              :
                              [
                              0
                              ,
                              1
                              ]
                              →
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                            be a parametrization of 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            between 
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                            with 
                              ‖
                              
                                 
                                    w
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              ‖
                            constant, 
                              w
                              (
                              0
                              )
                              =
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                            and 
                              w
                              (
                              1
                              )
                              =
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                           . For every 
                              λ
                              ∈
                              [
                              0
                              ,
                              1
                              ]
                            we define a segment 
                              
                                 
                                    γ
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                            with 
                              s
                              (
                              
                                 
                                    γ
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                              )
                              =
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                            and 
                              e
                              (
                              
                                 
                                    γ
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                              )
                              =
                              w
                              (
                              λ
                              )
                            and additionally: 
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    γ
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                            or 
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          (
                                          λ
                                          )
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              
                                 
                                    τ
                                 
                                 
                                    ω
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              )
                            if 
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                           . Setting 
                              X
                              (
                              λ
                              )
                              :
                              =
                              
                                 
                                    C
                                 
                                 
                                    λ
                                 
                              
                              ∩
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    λ
                                 
                              
                              :
                              =
                              C
                              (
                              
                                 
                                    γ
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                              )
                           , where 
                              C
                              (
                              γ
                              )
                            denotes the supporting circle or line corresponding to a segment γ, it can be shown that
                              
                                 1)
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       C
                                       (
                                       ω
                                       )
                                     and 
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       C
                                       (
                                       
                                          
                                             γ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    .

The mapping 
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                       →
                                       K
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       ,
                                       λ
                                       ↦
                                       
                                          tr
                                       
                                       (
                                       
                                          
                                             γ
                                          
                                          
                                             (
                                             λ
                                             )
                                          
                                       
                                       )
                                     is continuous.


                                    
                                       card
                                       (
                                       X
                                       (
                                       λ
                                       )
                                       )
                                       =
                                       2
                                     for every 
                                       λ
                                       <
                                       1
                                     and 
                                       card
                                       (
                                       X
                                       (
                                       1
                                       )
                                       )
                                       =
                                       1
                                    .

Let us use the abbreviation 
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                              :
                              =
                              e
                              (
                              
                                 
                                    γ
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                              )
                            and let 
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                            be the uniquely determined point contained in 
                              X
                              (
                              λ
                              )
                            with 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                              ≠
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                           , 
                              λ
                              ∈
                              [
                              0
                              ,
                              1
                              [
                           . Consequently, for every 
                              λ
                              ∈
                              [
                              0
                              ,
                              1
                              [
                            and 
                              i
                              ∈
                              {
                              1
                              ,
                              2
                              }
                            there exist uniquely determined parameters 
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                              ∈
                              [
                              0
                              ,
                              1
                              ]
                            with 
                              
                                 
                                    w
                                 
                                 
                                    λ
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                              )
                              =
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                            and 
                              
                                 
                                    w
                                 
                                 
                                    ˜
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                              )
                              =
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                           , where 
                              
                                 
                                    w
                                 
                                 
                                    λ
                                 
                              
                            is a parametrization of 
                              
                                 
                                    γ
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                            with constant 
                              ‖
                              
                                 
                                    w
                                 
                                 
                                    λ
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              ‖
                              ≠
                              0
                            and 
                              
                                 
                                    w
                                 
                                 
                                    ˜
                                 
                              
                            is a parametrization of 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            between 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                            with constant 
                              ‖
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              ‖
                              ≠
                              0
                           , 
                              
                                 
                                    w
                                 
                                 
                                    ˜
                                 
                              
                              (
                              0
                              )
                              =
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    w
                                 
                                 
                                    ˜
                                 
                              
                              (
                              1
                              )
                              =
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           . Obviously, we can conclude: 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                              <
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                              =
                              1
                            and 
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                              <
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                                 
                                    (
                                    λ
                                    )
                                 
                              
                           . Therefore, the mappings
                              
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          1
                                       
                                    
                                    :
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                    →
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                    ,
                                    
                                    λ
                                    ↦
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      (
                                                      λ
                                                      )
                                                   
                                                
                                                +
                                                
                                                   1
                                                   2
                                                
                                                ⋅
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      (
                                                      λ
                                                      )
                                                   
                                                
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      (
                                                      λ
                                                      )
                                                   
                                                
                                                )
                                                ,
                                             
                                             
                                                0
                                                ⩽
                                                λ
                                                <
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                             
                                             
                                                λ
                                                =
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                            and
                              
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          2
                                       
                                    
                                    :
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                    →
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                    ,
                                    
                                    λ
                                    ↦
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      (
                                                      λ
                                                      )
                                                   
                                                
                                                +
                                                
                                                   1
                                                   2
                                                
                                                ⋅
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      (
                                                      λ
                                                      )
                                                   
                                                
                                                −
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      (
                                                      λ
                                                      )
                                                   
                                                
                                                )
                                                ,
                                             
                                             
                                                0
                                                ⩽
                                                λ
                                                <
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                             
                                             
                                                λ
                                                =
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                            are continuous. Since the parametrizations 
                              
                                 
                                    w
                                 
                                 
                                    λ
                                 
                              
                            and 
                              
                                 
                                    w
                                 
                                 
                                    ˜
                                 
                              
                            are regular, the mappings
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    :
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                    →
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    λ
                                    )
                                    :
                                    =
                                    
                                       
                                          
                                             d
                                             
                                                d
                                                t
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                λ
                                             
                                          
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          λ
                                          )
                                          )
                                       
                                       
                                          ‖
                                          
                                             d
                                             
                                                d
                                                t
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                λ
                                             
                                          
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          λ
                                          )
                                          )
                                          ‖
                                       
                                    
                                    
                                     and 
                                    
                                    
                                       
                                          f
                                       
                                       
                                          2
                                       
                                    
                                    :
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                    →
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          f
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    λ
                                    )
                                    :
                                    =
                                    
                                       
                                          
                                             d
                                             
                                                d
                                                t
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          λ
                                          )
                                          )
                                       
                                       
                                          ‖
                                          
                                             d
                                             
                                                d
                                                t
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          λ
                                          )
                                          )
                                          ‖
                                       
                                    
                                 
                              
                            are well-defined and continuous. By an easy geometric observation (see Fig. 6
                           ) we have
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    λ
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                (
                                                λ
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                (
                                                λ
                                                )
                                             
                                          
                                       
                                       
                                          ‖
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                (
                                                λ
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                (
                                                λ
                                                )
                                             
                                          
                                          ‖
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    λ
                                    )
                                 
                              
                            for all 
                              λ
                              <
                              1
                           . Thus, 
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                            are equal on the dense subset 
                              [
                              0
                              ,
                              1
                              [
                              ⊂
                              [
                              0
                              ,
                              1
                              ]
                            and therefore, we get 
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                            since they are continuous. In particular, we obtain: 
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              (
                              1
                              )
                              =
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                              (
                              1
                              )
                              =
                              
                                 d
                                 
                                    d
                                    t
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    ˜
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                           .

Altogether, these results yield the following: The orientation of 
                              
                                 tr
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    ˜
                                 
                              
                              )
                            induced by 
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                            equals the orientation on 
                              
                                 
                                    w
                                 
                                 
                                    ˜
                                 
                              
                            and therefore it is equal to the orientation of ω as well. I.e. we have 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ≺
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                            with respect to 
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                           . From this we can easily deduce both implications of the assertion.  □


                     
                        Theorem 21
                        
                           Let 
                           
                              a
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    ⁎
                                 
                              
                           
                           . Then 
                           
                              a
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                            
                           if and only if there exists a segment γ in 
                           
                              V
                              ∪
                              
                                 
                                    C
                                 
                                 
                                    ⁎
                                 
                              
                            
                           ending in a and satisfying the CC with respect to the window ω. We can even choose a visibility spline whose first segment 
                           
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                            
                           is extremal, i.e. 
                           
                              A
                              (
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              )
                              ⩾
                              2
                            
                           or 
                           
                              e
                              (
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              )
                            
                           is a vertex of P and 
                           
                              A
                              (
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              )
                              ⩾
                              1
                           
                           .
                        


                     
                        Proof
                        Let 
                              a
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              ∩
                              
                                 
                                    C
                                 
                                 
                                    ⁎
                                 
                              
                           . Then there is a visibility spline with two segments 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            in P ending in a. If 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              ⊂
                              ω
                           , we are done. Otherwise, there are two intersections 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                            between the circles corresponding to ω and 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                           . Let these points be ordered regarding ω. Some rather technical argumentation, based on an alternating sequence of ω of length 3, curvature reasons and the Homotopy-Lemma 20, shows that 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    ≺
                                 
                                 
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           , where 
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                            is an extension of 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                           , which ends in a and contains both 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           . Therefore, 
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                            satisfies the CC with respect to ω.

As 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                            does not necessarily lie on 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            but on 
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           , it remains to show that 
                              
                                 
                                    [
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            is included in V. For this purpose, let 
                              y
                              ∈
                              
                                 
                                    [
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           . Then 
                              y
                              ∈
                              P
                            as otherwise one could construct a Jordan curve moving around y. Since ∂P is simply connected, the constructed loop is contractible, which would contradict the assumption that 
                              y
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              ∖
                              P
                           . After some tedious argumentation we can even assume 
                              y
                              
                                 
                                    ≻
                                 
                                 
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                           , where 
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ∈
                              V
                            denotes the breakpoint of 
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                           . Thus, we have 
                              y
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                            and obviously, 
                              y
                              ∉
                              C
                           . If 
                              y
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              ∖
                              V
                           , y would be contained in another connected component corresponding to a blocking arc η. However, the orientations induced by η and 
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                            on the two intersection points 
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ∈
                              η
                              ∩
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            would then not be identical, which is contradictory to the Homotopy-Lemma 20. Altogether, we obtain the first implication.

In order to show the other implication let 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            be a segment in P ending in 
                              a
                              ∈
                              V
                              ∪
                              C
                           . Again let 
                              C
                              =
                              
                                 
                                    C
                                 
                                 
                                    ⁎
                                 
                              
                            be the component including d. Then we can assume points 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ∈
                              ω
                              ∩
                              C
                              (
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                              )
                            with 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    ≺
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           , 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    ≺
                                 
                                 
                                    ω
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    [
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ⊂
                              V
                            since the case 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                            is obvious. Because of these orientation properties, we can assume 
                              det
                              (
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    ω
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                              )
                              >
                              0
                            and 
                              det
                              (
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              )
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    ω
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              )
                              )
                              <
                              0
                           .

Let 
                              X
                              ⊂
                              
                                 
                                    V
                                 
                                 
                                    ˜
                                 
                              
                              ∩
                              ∂
                              P
                            denote the subset of all vertices which are passed through by 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            in 
                              
                                 
                                    V
                                 
                                 
                                    ˜
                                 
                              
                            between 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           . If there is a point 
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ∈
                              X
                            and a feasible direction 
                              v
                              ∈
                              T
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                            with 
                              det
                              (
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                              ,
                              v
                              )
                              =
                              0
                           , we are done. Otherwise, we have to distinguish between two cases:

Firstly, suppose 
                              det
                              (
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              v
                              )
                              >
                              0
                            for all 
                              v
                              ∈
                              T
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                           . Because of the continuity properties of T (cf. Corollary 19), after possible diminution of 
                              
                                 
                                    [
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           , we can assume X to be empty and
                              
                                 
                                    det
                                    
                                    
                                       (
                                       
                                          
                                             τ
                                          
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       ,
                                       v
                                       )
                                    
                                    >
                                    0
                                    
                                    and
                                    
                                    det
                                    
                                    
                                       (
                                       
                                          
                                             τ
                                          
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       ,
                                       w
                                       )
                                    
                                    <
                                    0
                                    
                                    for all 
                                    v
                                    ∈
                                    T
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                     and 
                                    w
                                    ∈
                                    T
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    .
                                 
                              
                            Then the mapping 
                              l
                              :
                              
                                 
                                    [
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              →
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              ,
                              x
                              ↦
                              l
                              (
                              x
                              )
                            is a continuous selection of the set-valued mapping 
                              T
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          ]
                                       
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           , where 
                              l
                              (
                              x
                              )
                            denotes the left extremal direction of 
                              T
                              (
                              x
                              )
                           . The mapping 
                              f
                              (
                              x
                              )
                              :
                              =
                              det
                              (
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              x
                              )
                              ,
                              l
                              (
                              x
                              )
                              )
                            is continuous. By the intermediate value theorem we thus obtain a point 
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                            on 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            between 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                            with 
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              0
                            since 
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                              <
                              0
                            and 
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              )
                              >
                              0
                           . Therefore, again the Homotopy-Lemma 20 yields: 
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              l
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                              ∈
                              ∂
                              T
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                           .

Let us now consider the other case: If there is a direction 
                              v
                              ∈
                              T
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                            with 
                              det
                              (
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              v
                              )
                              ⩽
                              0
                           , there exists a 
                              v
                              ∈
                              T
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                            with 
                              det
                              (
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              v
                              )
                              =
                              0
                           , i.e. 
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              ±
                              v
                            since 
                              T
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                            is connected. By the Homotopy-Lemma we have 
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                              ∈
                              T
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                           . Wlog we can assume that ω has exactly three alternating restriction points 
                              (
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                              )
                           . If 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                            equals 
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                           , the claimed is shown. Otherwise, ‘
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    ≻
                                 
                                 
                                    ω
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                           ’, and it can be shown that 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              :
                              =
                              
                                 
                                    τ
                                 
                                 
                                    ω
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                            is an extremal direction. Hence we can put this case back to the situation above.

Altogether, we have shown that there is a point 
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ∈
                              V
                            on 
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                            with 
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ∈
                              T
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                            where 
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                            is a vertex of P or 
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                            is an extremal direction. Consequently, Theorem 5 and Proposition 1 yield 
                              a
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                            and the addendum as well.  □

In this case we can even choose a segment γ that is extremal, i.e. having at least two alternating restrictions, which is fundamental for a constructive approach and hence for the algorithmic design.

We are now able to characterize the set 
                        
                           
                              C
                           
                           
                              ⁎
                           
                        
                      and analogously the whole set 
                        
                           
                              V
                           
                           
                              2
                           
                        
                     . In particular, we have that 
                        a
                        ∈
                        
                           
                              C
                           
                           
                              ⁎
                           
                        
                      if and only if there exists a visibility arc γ in P, ending in a and satisfying the CC with respect to the window ω of 
                        
                           
                              V
                           
                           
                              1
                           
                        
                        =
                        V
                     . Therefore, characterizing 
                        
                           
                              V
                           
                           
                              2
                           
                        
                      means to use a ‘modified’ tolerance channel with the corresponding window ω as starting segment instead of s. The only differences to the kind of tolerance channels we have seen till now are the more complicated starting requirements, namely the CC regarding ω. Using the abbreviation 
                        E
                        :
                        =
                        (
                        P
                        ,
                        s
                        ,
                        d
                        )
                      we denote this “modified” tolerance channel by 
                        
                           
                              E
                           
                           
                              2
                           
                        
                      and call it continuation channel. Consequently, for a point 
                        a
                        ∈
                        P
                      we have 
                        a
                        ∈
                        
                           
                              V
                           
                           
                              2
                           
                        
                      if and only if a is in the visibility set of 
                        
                           
                              E
                           
                           
                              2
                           
                        
                     .

As the CC shows certain continuity conditions it can be proved that the results presented in the preceding sections hold for continuation channels as well. The arguments are essentially the same. Only the details are more intricate, which are explicated at full length in Maier (2010). Especially, the window and blocking arcs of 
                        
                           
                              V
                           
                           
                              2
                           
                        
                      are characterized in the same manner. Recall that touching the start segment, which is here the window of V, is a left or right restriction point.

We confined ourselves to the case that the window ω has exactly three alternating restriction points. Hence we can use the introduced Connection-Theorems inductively and exploit the properties of the sets 
                        
                           
                              V
                           
                           
                              n
                           
                        
                      when successively dealing with the continuation channels 
                        
                           
                              E
                           
                           
                              n
                           
                        
                     , which can be defined analogously to 
                        
                           
                              E
                           
                           
                              2
                           
                        
                     . This yields a constructive method for computing a SMAP: The outcome is a greedy algorithm, which will be discussed in the next section.

By iteratively exploiting Theorem 21 we can compute a SMAP as follows: We traverse P from s to d in a forward step and back again from d to s in the backward step.


                     The forward step: Firstly, we compute the window 
                        
                           
                              ω
                           
                           
                              1
                           
                        
                        :
                        =
                        ω
                      and corresponding blocking arcs of V by identifying segments with three alternating restrictions. Next, the window 
                        
                           
                              ω
                           
                           
                              2
                           
                        
                      and the blocking arcs of 
                        
                           
                              E
                           
                           
                              2
                           
                        
                      are computed such that the conditions of Theorem 21 and Theorem 13 are satisfied. In particular, 
                        
                           
                              ω
                           
                           
                              2
                           
                        
                      has to satisfy the CC with respect to 
                        
                           
                              ω
                           
                           
                              1
                           
                        
                     . The condition 
                        
                           
                              [
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                           
                              
                                 
                                    ω
                                 
                                 
                                    2
                                 
                              
                           
                        
                        ⊂
                        V
                      in case of 
                        {
                        
                           
                              x
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              x
                           
                           
                              2
                           
                        
                        }
                        =
                        
                           
                              ω
                           
                           
                              1
                           
                        
                        ∩
                        
                           
                              ω
                           
                           
                              2
                           
                        
                      can be checked by taking the blocking arcs into account. We can proceed this way, i.e. compute 
                        
                           
                              ω
                           
                           
                              i
                           
                        
                      and the blocking arcs in 
                        
                           
                              E
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        3
                        ,
                        4
                        ,
                        …
                        ,
                        k
                     . The procedure is stopped when a point of d is circularly visible, and a visibility arc satisfying Theorem 21 and ending in d is computed. As it can be seen in Fig. 7
                     , the windows do not represent a smooth arc spline. However, the computed windows are used in the backward step to generate a SMAP.


                     The backward step: The final segment 
                        
                           
                              ω
                           
                           
                              k
                           
                        
                      represents the last segment of the resulting SMAP. In particular, the minimum segment number is k. Since Theorem 21 is an equivalence, we can be sure that the predecessor segments can then be determined by touching their successor and by two alternating restrictions. The whole procedure is finished when s has been reached. After possibly restricting the particular segments we obtain a SMAP. Consequently, a SMAP can be computed in an iterative way.

In the second row of Fig. 7 the backward step is visualized as well. The dotted segments indicate the windows 
                        
                           
                              ω
                           
                           
                              i
                           
                        
                      which the SMAP segments 
                        
                           
                              γ
                           
                           
                              i
                           
                        
                      have to satisfy the CC with. Algorithm 1
                      summarizes the approach in pseudo code form.

Clearly, the determination of the several windows and blocking arcs is a crucial part of the forward step as well as the computation of the SMAP segments during the backward step. Of course, the characterization by alternating sequences plays an important role for this purpose. A segment with three alternating restrictions can be found by discovering triples 
                        (
                        
                           
                              c
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              c
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              c
                           
                           
                              3
                           
                        
                        )
                     , where 
                        
                           
                              c
                           
                           
                              i
                           
                        
                      is a vertex or an edge of P or the start segment, a predecessor blocking arc or the predecessor window. Computing a circle being tangent to each of them leads to the well known Apollonius Problem (up to eight possible solutions). The general problem is, in principle, solvable by straightedge and compass alone and can be quite easily computed (cf. Maier, 2010). Satisfying the starting condition (e.g. the CC) and staying inside P is not difficult to check. For ensuring that a segment stays in 
                        
                           
                              E
                           
                           
                              i
                           
                        
                      in the case of 
                        i
                        >
                        1
                     , one has to additionally consider the predecessor blocking arcs. The segments in the backward step can be found analogously since they have two alternating restrictions and touch their successor segments which obviously corresponds to a line or a circle.

From a run time complexity point of view this proceeding is not very efficient. However, for many off-line applications this approach is sufficient. An efficient and more detailed algorithmic description can be found in Maier (2010), where a worst case complexity of 
                        O
                        (
                        
                           
                              n
                           
                           
                              2
                           
                        
                        )
                      could be shown for polygons P with n vertices. The proposed implementation uses so-called Circular Visibility Diagrams, which were introduced in Chou and Woo (1995).

We have presented a method for approximating polygonal input data by a smooth arc spline with the minimal number of segments while not exceeding a user-specified tolerance. In particular, we focused on the mathematical characterization of corresponding solutions, i.e. the properties of a SMAP and its segments. The main tools for this purpose were alternating sequences and feasible direction sets. The former are used for the algorithmic design as well. This approach enables an iterative algorithm which generates the breakpoints of the solution curve automatically.

Thus, the SMAP algorithm ensures the (real) minimality of segments which results in a compact representation and allows an efficient further processing. This is decisive for numerous applications. Most important, a minimum number of segments provides a considerably faster computation of point-to-curve distances. Among applications like reverse engineering of planar working pieces (cf. Maier and Schindler, 2011) and the vectorization of pixel graphics (cf. Maier et al., 2012), the SMAP methodology therefore turned out to be very suited for the generation of digital maps of high precision: On behalf of the Ko-FAS research initiative (cf. Ko-fas, http://www.ko-fas.de), a vehicle equipped with a highly accurate sensor system records measuring points on road markings. After reconstructing the extracted points in world coordinates for each marking a tolerance channel is build with an appropriate accuracy (in the magnitude of 0.1 m) and the SMAP algorithm is applied. Regarding the resulting data volume for storage and the efficiency of map calculations the outcome is far superior to digital maps generated by state of the art approaches (cf. Schindler et al., 2012; Brummer et al., 2013).


                     Fig. 8
                      shows a tolerance channel representing a maximum error of 0.5 m and a corresponding SMAP (for visualization reasons the threshold is comparatively big). This example is a small extract of some test data based on a lane of a tortuous mountain road, which were investigated in Brummer et al. (2013). By means of this example and an additional high way track the advantages regarding the accuracy, data compression and curvature reconstruction are highlighted and compared to state of the art methods. In fact, an extension of the SMAP algorithm is applied, which additionally integrates line segments in the approximating arc spline at areas which are likely to belong to straight parts of the lane (cf. Maier et al., 2013). To get an impression of the algorithmic performance note that only 127 SMAP segments are needed for approximating 74 km highway (ca. 35 000 input points) with a maximum error of 0.2 m.

A compact and accurate lane representation is crucial for various advanced driver assistance systems. For instance, it can be used for vehicle self-localization purposes as it enables fast access to map elements in a desired local environment and allows efficient calculations of distances from points to map elements. Based on this issue in Schindler (2013) an approach is proposed that associates locally recognized objects with corresponding elements of the map in order to deduce the pose of the ego vehicle. Experiments have shown that a positioning accuracy significantly below one meter and an orientation accuracy below one degree even at a speed up to 100 km/h in real-time are reached.

In order to represent entire systems of roads and streets, further theoretical and algorithmic requirements of the arc spline approximation have to be considered, such as cyclic structures, crossings and self-intersections. For this purpose, we will work on a solid basis for a completely automatic map development within the research project “Methods for generating High Precision Digital Maps using Circular Arc Splines”. This project is funded by the German Research Foundation (DFG – Deutsche Forschungsgemeinschaft) under grant number MA 5834/1-1.

@&#REFERENCES@&#

