@&#MAIN-TITLE@&#A multiscale decomposition approach to detect abnormal vasculature in the optic disc

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We propose an adaptive vessel segmentation approach to characterize vasculature.


                        
                        
                           
                           We apply AM-FM along with this vessel segmentation method to better capture NVD.


                        
                        
                           
                           We characterize the entire vasculature in the optic disc to detect NVD.


                        
                        
                           
                           This approach is validated on a large dataset and achieves good results.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Amplitude-modulation frequency-modulation

Diabetic retinopathy

Fractal dimension

Granulometry

Neovascularization

@&#ABSTRACT@&#


               
               
                  This paper presents a multiscale method to detect neovascularization in the optic disc (NVD) using fundus images. Our method is applied to a manually selected region of interest (ROI) containing the optic disc. All the vessels in the ROI are segmented by adaptively combining contrast enhancement methods with a vessel segmentation technique. Textural features extracted using multiscale amplitude-modulation frequency-modulation, morphological granulometry, and fractal dimension are used. A linear SVM is used to perform the classification, which is tested by means of 10-fold cross-validation. The performance is evaluated using 300 images achieving an AUC of 0.93 with maximum accuracy of 88%.
               
            

@&#INTRODUCTION@&#

Diabetic retinopathy (DR) is one of the leading causes of blindness in the world [6]. The disease is asymptomatic in its early stages and can be best managed by the patient by maintaining tight blood sugar and blood pressure control. However, as the disease progresses, it can become sight threatening. Studies [4,17] have demonstrated that 50% of type I diabetics and 20% of patients with type II diabetes will progress to advanced stages of DR some time in their lives. One of these advanced stages is proliferative diabetic retinopathy (PDR). PDR is characterized by the appearance of new, abnormal vessels in the retina. Depending on the location of these new vessels, they can be classified as neovascularization on the optic disc (NVD), where new vessels grow on or within 1 disc diameter (DD) of the optic disc, or neovascularization elsewhere (NVE), where the new vessels are present anywhere outside this NVD region. This paper focuses on the detection of NVD. In early stages, NVD appears as loops or networks of fine vessels [16]. As the disease progresses, the vessels extend outside the optic disc margin and their caliber increases. These new vessels are fragile and can grow into the vitreous gel. Vitreous traction with normal eye movement may lead to the rupture of the new vessels, causing hemorrhages and significant vision loss. Timely treatment with laser photocoagulation can slow progression of the disease. Therefore, detection of these new vessels is of critical clinical importance.

Most of the methodologies used to detect DR have been focused on finding other pathologies such as microaneurysms, hemorrhages, and hard exudates, as summarized in Winder et al. [34], while a few have looked for vascular abnormalities [12,9]. An approach to detect NVD has been presented by Goatman et al. [10]. In their paper, vessel segments were separated into abnormal and normal classes. Vessel-like candidate segments on the optic papilla are detected by using watershed lines and ridge strength measurements. Fifteen features, including shape, position, brightness, contrast, and density, were extracted from each candidate. Gaussian-kernel support vector machines (SVM) was used to classify data represented by those features. The results were validated using leave-one-out cross-validation. Based on 38 NVD and 71 normal cases, the method achieved an area under the receiver operator characteristic curve (AUC) of 0.79 for the detection of segments with NVD and an AUC of 0.91 for the detection of optic discs with neovascularization.

Others papers in the literature are focused in the detection of neovascularization in the images such as [13], in which they combine morphology-based operations, Gaussian filtering, and thresholding techniques. In their approach, 11 images that presented neovascularization were analyzed, obtaining an average sensitivity/specificity of 89%/64%. Lee et al. [18] proposed a vessel detection method which includes statistical texture analysis, high order spectrum analysis, and fractal analysis for the detection of neovascularization. They obtained an accuracy of 98.5% but good quality images were hand-picked from DR datasets and 27 out of 137 images present neovascularization.

The fundamental advantages from the use of amplitude-modulation frequency-modulation (AM-FM) features have been previously documented in Pattichis [26] and Murray et al. [22]. In summary, AM-FM models: (i) provide a large number of non-stationary texture features that are meaningful (e.g., instantaneous frequency, instantaneous amplitude), (ii) allow image reconstructions using multi-scale AM-FM decompositions, and (iii) enable the implementation of robust methods (e.g., [23]). A summary of recent medical imaging applications is given in Murray et al. [22]. Beyond DR applications, we note the recent application to MRI images in Loizou et al. [19], and tree image analysis in Ramachandran et al. [29].

In what follows, we present a summary of our prior research and list the new contributions of the current paper. In Agurto et al. [1], we presented an early study of the use of AM-FM methods for DR. The focus of this paper was on the use of AM-FM features for image classification. The results included a summary of classification of retinal images from different risk levels. The statistics for different AM-FM features were compared over regions with different types of lesions. In Agurto et al. [35], we presented a robust method for the detection of the optic disc in DR images. The approach did not use AM-FM features. In Yu et al. [2], we presented a multi-scale approach for detecting exudates regions in DR images. In an earlier conference publication in Agurto et al. [3], we presented preliminary results over a limited dataset, a reduced set of AM-FM features, and a different classification approach.

The current paper makes the following contribution over our prior research:
                        
                           •
                           
                              
                                 Adaptive vessel segmentation method:
                               A new approach for adaptive vessel segmentation is developed that uses feedback to determine jointly optimal parameters for image enhancement and segmentation. This new approach allows the use of different levels of enhancement. The new approach is described in Section 3.1.


                              
                                 Extended texture feature set extraction and comparison:
                               we focus on the development of a multiscale image processing approach to better capture NVD vessel properties such as narrow vessel caliber and tortuosity levels. The paper provides a comparative study that investigates the use of AM-FM features, granulometries, fractal dimension, as well as the combination of all of them together. The paper establishes the performance of each set of texture features independently and shows that the combined use of all of the features yields the best results.


                              
                                 Analysis of the vasculature:
                               We focus in the characterization of the entire vasculature in the optic disc to determine the presence of neovascularization without the need to analyze each vessel segment independently. By doing so, we obtain high accuracy in the detection of NVD, which is the ultimate goal of this research.


                              
                                 Large dataset validation:
                               The approach is tested on a larger database than those used in other papers and it is shown to perform better than current techniques for NVD segmentation and detection.

The organization of this paper is as follows. Section 2 describes the database used to test the proposed approach. The methodology is described in Section 3. Results and discussion based on 300 images are presented in Section 4. Conclusions are presented in Section 5.

The images used to test this approach were acquired at the Retina Institute of South Texas (RIST, San Antonio, TX) and the University of Texas Health Science Center in San Antonio (UTHSC SA). The images were acquired at RIST with a TRC 50EX camera with 50 and 35 degrees of field of view (FOV) and at UTHSC SA with a Canon CF-60uv with 60 and 40 degrees of FOV. The size of the RIST images is 2224×1888 pixels and the size of the UTHSC SA images is 2392×2048 pixels. Although images centered on the optic disc (field 1) were preferred for this study, images centered on the macula (field 2) that included the optic disc were allowed. Since we wanted to evaluate the performance of this algorithm as an independent block which can be added to a DR screening system, we manually selected the optic disc from the retinal images. However, our group previously developed an algorithm for the detection of the optic disc with high accuracy [35]. The dataset consists of 19 NVD and 45 normal cases from RIST and 81 NVD and 155 normal cases from UTHSC SA. Because of the differences in FOV and the variation of disc size diameter between individuals, which is in the range of 0.96–2.91 mm for the vertical axis and 0.91–2.61 mm for the horizontal axis [32], the images were resized so each had an optic disc with a DD=400pixels. Fig. 1
                      shows four examples of normal and NVD cases from the images used in this paper.

@&#METHODOLOGY@&#

Since the green channel provides excellent contrast for vessel segmentation [33,31,24], we restrict our approach to working with the green image. To avoid possible boundary artifacts, a margin of 60 pixels was added to our region of interest (ROI) of 800×800 pixels. However, features were extracted from the ROI only.

The method is summarized in Fig. 2
                     . First, the vessels are segmented using an adaptive vessel segmentation approach. AM-FM features are then extracted from the segmented vessels areas. Next, we compute the fractal dimension and morphological granulometry from the segmented vessels. The extracted features are classified using an SVM with a linear kernel. We provide further details on the approach in the remaining subsections.

In Fig. 3
                        , we present a block diagram that shows the components of the adaptive vessel segmentation. Our vessel segmentation technique is based on the methodology presented in Yu et al. [36]. In Yu et al. [36], the retinal vasculature was segmented after applying a multiscale enhancement with Frangi filters [8] and second order local entropy for thresholding [25]. The same procedure presented in Yu et al. [36] cannot be used to detect the very fine vessels characteristic of NVD. Over-segmenting the retinal vasculature can help to detect small vessels, but it also introduces a high amount of segmented pixels in the avasculature zone (false positives per image). In addition, images taken at different alignment positions, such as those in our dataset, vary in contrast. The optic disc is directly illuminated by the light of the camera in disc-centered images; in macula-centered images, the nasal area receives less light intensity. For these images, different parts of the retina require different levels of enhancement.

In this paper, we introduce an adaptive approach that uses multiple levels to enhance vessel boundaries.

The first step is to analyze overlapping windows of 200×200 pixels that constitute the entire optic disc image (920×920 pixels). The remaining steps of the procedure are applied to these windows to generate our final segmentation.

We reduce non-uniform illumination using shade correction, as described in Yu et al. [36] and Mendoça and Campilho [21], in order to minimize its effects on the segmentation. The background is estimated by creating an over-smoothed version of the image using an average filter. The size of the window is usually set to the width of the largest structure in the retina. In these images, the largest vessel's width is 60 pixels. The original image is divided by the filtered image. By using this technique, the non-uniformities in the fundus images are significantly reduced.

Following non-uniform illumination correction, we use our adaptive image enhancement method. The adaptive approach is iterative as depicted in Fig. 3. It consists of contrast limited adaptive histogram equalization (CLAHE, with clip limit of 0.01, Pizer et al. [28]) followed by anisotropic diffusion [27] (12 iterations), and a feedback loop that is used to decide the number of times that we need to repeat the operation. In what follows, we describe all the components of the approach and then use an example to demonstrate how it works.

Let I
                        
                           S
                        (x, y) be the subimage of I(x, y) located in region S. Let T be the pre-processing operator. A region S being pre-processed i consecutive times is said to have undergone an i-th level of enhancement and is represented as T
                        (i)[I
                        
                           S
                        (x, y)]; where i
                        =1, 2, … The correct level of enhancement for each region is based on the comparison of the segmentation of two consecutive levels of enhancement, as represented by the enhancement control block in Fig. 3.

The comparison of the segmentation of two consecutive levels of enhancement is estimated as follows. Let U be the segmentation operator and |·| denote the cardinality operator, that is, the function that counts the number of positive values of the input argument. Then the difference of the segmentation of two consecutive levels of enhancement of I
                        
                           S
                        (x, y) is given by
                           
                              (1)
                              
                                 
                                    g
                                    S
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 U
                                 [
                                 
                                    T
                                    
                                       (
                                       i
                                       +
                                       1
                                       )
                                    
                                 
                                 [
                                 
                                    I
                                    S
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 ]
                                 ]
                                 −
                                 U
                                 [
                                 
                                    T
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 [
                                 
                                    I
                                    S
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 ]
                                 ]
                              
                           
                        and the number of nonzero pixels on region S is defined by |g
                        
                           S
                        (x, y)|.

Two assumptions were made in order to estimate the best enhancement level based on g
                        
                           S
                        (x, y). If the number of newly segmented pixels in the analyzed region obtained by the segmentation of the last level (i
                        +1) is high and these pixels are spatially distributed in the window, then we assume that the enhancement achieved on this last level has only added non-vessel pixels. On the other hand, if few newly segmented pixels are detected by the segmentation of the last level, it can be concluded that this level has not provided new significant information. By taking into account these two assumptions, three parameters that quantitatively define the aforementioned concepts were set for the adaptive vessel segmentation algorithm as follows.

Let N be the number of pixels on a window. If |g
                        
                           S
                        (x, y)| is in the range [N
                        ×
                        frac
                        
                           lo
                        , N
                        ×
                        frac
                        
                           up
                        ] and it has at least one connected component composed of frac
                        
                           min
                        
                        ×
                        N pixels, level i
                        +1 is preserved and the window undergoes another enhancement level. Otherwise, level i is selected as the optimal enhancement level for the analyzed region.

The parameters frac
                        
                           lo
                         and frac
                        
                           up
                         represent fractions of the total number of pixels that define the lower and upper bounds of the number of pixels that should be added by the segmentation of level i
                        +1 for it not to be discarded, while frac
                        
                           min
                         quantifies the spread criterion by establishing a lower bound to the number of pixels needed for a connected component to be considered significant. If one or more connected components are found, then the pixels added by the segmentation of level i
                        +1 are not considered to be too spread. In our study, since we use 200×200-pixel windows, N
                        =40, 000.

In order to find the optimal values of the frac
                        
                           up
                        , frac
                        
                           lo
                         and frac
                        
                           min
                         parameters, we selected 10 additional images with NVD from our current database. The vessels and new vessels were marked by an experienced technologist. Since we are interested in getting better detection of new vessels, we divided images into regions with new vessels and regions with no vasculature. Thus, normal vessels were not considered in this optimization approach since they did not include new vasculature regions. In addition, instead of using the accuracy metric, we use 2×
                        sensitivity+specificity in order to put more weight on the detection of new vessels without disregarding the false positives per image generated in the process. Here, we note that our segmentation metric performs a more proper parameter validation by also penalizing over-segmentation. To find the optimal values, we applied a grid search of 10 values for each of the parameters, as given by: frac
                        
                           lo
                        
                        =[00.1], frac
                        
                           up
                        
                        =[00.15], and frac
                        
                           min
                        
                        =[00.02]. An additional constraint for these parameters was that: frac
                        
                           min
                        
                        <
                        frac
                        
                           lo
                        
                        <
                        frac
                        
                           up
                        .

The adaptive approach is demonstrated with segmentation corresponding to three different levels of enhancement of a given region shown in Fig. 4
                        . The first enhancement level does not produce complete segmentation of vessels. By applying the second enhancement level, an adequate segmentation with less false positives per image is achieved. The third level introduces more noise than relevant vessel segmentation.

The procedure is repeated for all the windows that cover the image. These regions are overlapped by shifting 50 pixels on both the vertical and horizontal axes.

This technique decomposes an image in terms of a unique sum of amplitude and frequency components given by
                           
                              (2)
                              
                                 I
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    a
                                    n
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 cos
                                 
                                    φ
                                    n
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                           
                        where M is the number of AM-FM components, a
                        
                           n
                        (x, y) denote instantaneous amplitude functions (IA), and φ
                        
                           n
                        (x, y) denote the instantaneous phase functions [14]. For each AM-FM component, the instantaneous frequency (IF) is defined in terms of the gradient of the phase φ
                        
                           n
                        :
                           
                              (3)
                              
                                 IF
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 ∇
                                 
                                    φ
                                    n
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   φ
                                                   n
                                                
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             
                                                ∂
                                                x
                                             
                                          
                                          ,
                                          
                                             
                                                ∂
                                                
                                                   φ
                                                   n
                                                
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             
                                                ∂
                                                y
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Further details on the use of AM-FM decomposition have been presented in Murray et al. [23]. In this paper, our focus will be on the extraction of AM-FM textural features.

In terms of extracting textural features from each component, we are interested in using the instantaneous amplitude (IA) and the magnitude and angle of instantaneous frequency (IF). The IF angle is defined using:
                           
                              (4)
                              
                                 
                                    IF
                                       
                                    angle
                                 
                                 =
                                 arctan
                                 
                                    
                                       
                                          
                                             
                                                
                                                   IF
                                                   y
                                                
                                             
                                             
                                                
                                                   IF
                                                   x
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The IA measures local image smooth variations, while the IF measures local frequency content. The magnitude of IF is rotation invariant and also measures the geometry of the texture. For example, the most appropriate scale to detect a pattern of vessels is the one that captures frequencies with a period that is proportional to their width.

In what follows, we will show that the IF angle can be associated with the level of tortuosity of the segmented vessels. Given the ambiguity in the estimation of the phase, cos
                        φ
                        
                           n
                        (x, y)=cos(−
                        φ
                        
                           n
                        (x, y)), our estimation is restricted to angles from 0 to 180. Fig. 5
                        a shows synthetic curves with different levels of tortuosity. In this synthetic experiment, we use the AM-FM features from a frequency scale that captures the information of the three curves shown in Fig. 5b. The cumulative distribution function (CDF) of the masked IF angle content of the three curves (Fig. 5d) is shown in Fig. 6
                        . Theoretically, most of the pixels of the straight line will have angles near 0 and 180; this can be seen in the abrupt slope of the CDF for angles close to zero. A higher level of tortuosity implies more variability in the pixels’ angle values. In Fig. 6, it can be seen that the CDF of the level 1 tortuous curve rises more slowly than the CDF of the straight line. Even slower is the rise of the CDF of the level 2 tortuous curve, due to the presence of more angle values in its IF angle pixels. These observations support the use of the IF angle in tortuosity detection.

AM-FM components are extracted from different frequency scales using the information of the green channel of the image. We consider the use of 30 bandpass channel filters associated with five frequency scales (6 filters per scale). These correspond to the following bands of frequencies: High (H), Medium (M), Low (L), Very Low (VL), Ultra Low (U). In addition, we also extract the information after applying a Lowpass Filter (LPF) to the image. We merged the frequency bands into 12 different combinations of scales (CoS), as shown in Table 1
                        . We estimate a 3 AM-FM components for each CoS using dominant component analysis [23]. A total of 36 different AM-FM representations (3 estimates × 12 CoS) are obtained for each image.

Once the 36 AM-FM representations are estimated, these are masked by the map of segmented vessels. For each masked image, a normalized histogram of 32 bins is calculated. The values associated with these bins represent the features extracted from AM-FM.

The size distribution of the segmented vessels and NVD can be described using a morphological granulometry [11], which provides a multiscale approach that can be used to describe vessels of different sizes. Granulometry is computed using a series of morphological opening operations (γ) with a structuring element (B) of different sizes (controlled by r). An opening is defined in terms of an erosion (ɛ) followed by dilation (δ) as given by
                           
                              (5)
                              
                                 
                                    γ
                                    rB
                                 
                                 (
                                 X
                                 )
                                 =
                                 
                                    δ
                                    rB
                                 
                                 ⌊
                                 
                                    ɛ
                                    rB
                                 
                                 (
                                 X
                                 )
                                 ⌋
                                 .
                              
                           
                        
                     

When the size of the structural element is increased, objects of corresponding size and smaller in the binary image are eliminated. By subtracting the result of the opening from the original image, which is represented by DwO in (6), we can obtain only the objects that were removed by the opening. In this way, we can construct a distribution G by changing the r as specified below.


                        
                           
                              (6)
                              
                                 DwO
                                 (
                                 r
                                 )
                                 =
                                 X
                                 −
                                 
                                    γ
                                    rB
                                 
                                 (
                                 X
                                 )
                                 .
                              
                           
                        
                        
                           
                              (7)
                              
                                 G
                                 (
                                 r
                                 )
                                 =
                                 
                                    
                                       |
                                       DwO
                                       |
                                    
                                    
                                       |
                                       X
                                       |
                                    
                                 
                                 ,
                              
                           
                        where |·| is the cardinality operator defined in Section 3.1. By using a disk-shaped structural element of radii ranging consecutively from 1 to 32 pixels, we compute the granulometry for the segmented vasculature.

Following the same concept of granulometry for binary images, openings with the same radii and shape of the structure element were applied to the negative of the green channel (as shown in Fig. 7
                        a). By using openings, objects with high intensity values are removed according to the size of the structural element. Contrary to binary images, the pixels of grayscale images will have different intensities. Therefore, instead of counting the number of pixels as it is explained in the previous section, the mean value of the subtraction of the inverse of the green channel with each of its 32 openings is calculated for the segmented area. Fig. 7 shows three examples of the difference of the inverse of the green channel and its openings, which are extracted after using different sizes of structural elements. The example demonstrates the multiscale properties of morphological openings.

Fractal dimensions are computed to measure vascular changes associated with the multiscale, granulometric decomposition. For this approach, we generate 32 binary images from the outputs of the difference in openings of consecutive radii, as explained in the previous section. Each binary image is skeletonized and used in computing the fractal dimension.

Our approach is motivated by the earlier use of fractal analysis in Avakian et al. [5]. To determine the fractal dimension, we use box counting on the skeletonized vessels as described in MacGillivray and Patton [20]. Box counting covers the skeleton image with boxes of increasing size (2
                           n
                        ), where the maximally sized boxes cover the whole analyzed area, which in this case is composed of 1024 pixels. For each box size, the number of boxes (N
                        
                           B
                        ) that contains at least one pixel of the skeleton images is counted. To obtain the fractal dimension (D
                        
                           f
                        ), we calculate the slope of the best fit line to the plot of ln(N
                        
                           B
                        ) vs. n
                        ln(2).

A total of 39 types of features were obtained with the methods described in the previous sections. Thirty-six types of features come from the histograms of the AM-FM features constrained to the segmented vessels. The size distribution of the segmented vessels obtained with the granulometry computation provided one more type of features. Another type of feature was calculated using the grayscale information of the image with the method described in Section 3.4. The last type of feature was calculated using the fractal dimension approach. As it was explained in each section, each type of feature is composed of 32 elements. In the case of AM-FM, each type of feature has 32 bins; for the other ones, each type of features has 32 elements since r
                        =1, 2, …, 32. Therefore, each ROI is represented by a feature vector of 1248 elements (39 types of features × 32). Features are standardized prior to being input to the classifier to have zero mean and a standard deviation of one 
                           (
                           
                              x
                              ¯
                           
                           =
                           0
                           ,
                           SD
                           =
                           1
                           )
                        .

In order to validate our results, we used stratified k-fold cross-validation by maintaining the same ratio of NVD and normal cases on each fold. The choice of k depends upon the amount of available data. If the number of cases is small, then leave-one-out cross-validation, where the number of folds equals the number of cases, is the method of choice. This allows the classifier to be trained on as much data as possible. However, the classification accuracy estimate, although nearly unbiased, has high variance, since the training sets are very similar to each other. When a relatively large number of cases are available (which is the case in this study), the bias of the cross-validation estimate is reduced, making it safe to reduce the number of folds. Generally, it is advised to use 10-fold cross-validation in these scenarios [30].

The classifier used to predict the presence of NVD in the optic disc is a support vector machine (SVM) with a linear kernel. A nested 10-fold cross validation (CV) was used to evaluate the performance of the extracted features in the detection of neovascularization as well as to find the optimal parameters of the classifier. At each round of the main CV, which was used to estimate the classification accuracy, the inner CV was used to select the appropriate value of tradeoff parameter C 
                        [7]. This value was picked from 20 logarithmically spaced points in the range [0.1 100].

@&#RESULTS AND DISCUSSION@&#

We first discuss the results from parameter optimization for our proposed segmentation method. Based on our validation procedure, we found the performance to be high and stable in the range of frac
                        
                           lo
                        
                        =[0.040.06], frac
                        
                           up
                        
                        =[0.070.15], frac
                        
                           min
                        
                        =[0.0050.01]. Therefore, we set the parameters to be frac
                        
                           lo
                        
                        =0.05, frac
                        
                           up
                        
                        =0.1, and frac
                        
                           min
                        
                        =0.01. Fig. 8
                         shows a plot of the obtained values for frac
                        
                           min
                         fixed to 0.01.

As discussed earlier, our goal was not to provide accurate segmentation of new vessels, but to detect most of the vasculature that includes new vessels. In order to confirm that our adaptive vessel segmentation was able to capture most of the neovascularization, a certified retinal reader also marked all the new vessels in 25% of our cases with NVD (25 images). The results of our segmentation cover 80% of all the new vessels. Fig. 9
                         shows a comparison with the non-adaptive approach in an optic disc with neovascularization. This assures that our features are going to be more accurate by using this adaptive segmentation approach since they are extracted from regions that cover the vasculature including new vessels in the optic disc and avoid unwanted information such as background.

In Fig. 10
                        , we show the response of the IA using CoS 11 (see Table 1) for an image with NVD. In Fig. 10c we can observe how the vessels with small caliber (most of them being neovascularization) are characterized by high intensity. In order to analyze the IA reponse for different structures, we masked the content of three groups, background, normal vessels, and neovascularization, by using the annotated image in Fig. 10b. In the histograms presented in Fig. 10d, the difference between the number of pixels of NVD and normal vessels increases for high values of IA. Even though the background presents more pixels than normal vessels in that range, there is a significant difference with respect to the NVD histogram. And since we only analyzed the segmented vessel regions by using the adaptive vessel segmentation, the contribution of the background is significantly reduced.


                        Fig. 11
                         shows the average of the normalized histograms of one AM-FM representation (the magnitude of the IF – CoS 11) for NVD and normal cases in our dataset. It can be seen that NVD cases have more pixels at higher frequencies than the normal cases. This indicates that the magnitude of IF is also an informative feature that can help differentiate between normal and NVD cases.


                        Fig. 12
                         shows the differences between the distributions of the two groups for the first eight different radii (r
                        =1–8). A two-sample t-test was computed for each, and the largest p-value was 0.0092 for radius=6, which indicates that the means of the distributions for each radius of NVD and normal cases are statistically different. This suggests that there are more small objects (thin vessels) in NVD cases than on normal optic discs.

The same analysis described in Section 4.3 was performed for the 32 features obtained with grayscale morphology. The p-values were found to be in the range of [3.04×10−5 4.6×10−2], which indicates that the estimated feature is useful for the classification of NVD and normal cases as it provides statistically significant difference between groups.

In theory, as the retinal structure increases in complexity, the value of the fractal dimension is higher. It has already been noted that NVD adds more complexity to the vasculature, due to the convoluted spatial distribution and tortuosity of the new vessels. For this reason, NVD should have a higher fractal dimension than normal vasculature. This statement is supported by the results shown in the boxplots in Fig. 13
                        , where the first eight extracted features for fractal dimension for NVD and normal cases are shown. We also performed the two sample t-test for the distributions in each radius, as was done for granulometry. The maximum obtained p-value was 1.791×10−5. This suggests that there is a significant difference between the means of the distributions of the two groups.

We tested our system using 300 images (100 NVD, 200 normal). After following the validation procedure explained in Section 3.6, we found out that the classification was insensitive to the value of C. Therefore, we set C
                        =1 obtaining an AUC of 0.93. In addition, we also tested the SVM with Gaussian kernels. To do so, we performed a grid search by setting 100 logarithmically spaced points in the recommended ranges by Hsu et al. [15] of [2−5, 215] for C, and [0.25, 128] for σ. We found that the optimal values are in the interval of [3.65 12.87] for C and [26.5 46.7] for σ. Table 2
                         presents the results for both linear and Gaussian kernels. It can be seen that linear SVM outperforms Gaussian SVM for all combinations of features except for fractal dimension. For this reason, we analyzed the linear SVM results to compare the classification performance using AM-FM features only and all of the extracted features.

A McNemar test was applied to compare the information provided by both sets of features as they are derived from the same set of subjects (related samples). From the ROC curves, we picked the points of maximum accuracy (88% for all features and 85.7% for AM-FM only features) The results of the chi-squared test yielded a p-value of 0.0218. Thus, we found that the inclusion of all of the features is statistically significant for classification. Overall, we found 19 out of 300 cases where the two feature sets gave different classification results.

The sensitivity and specificity rates achieved by the point of maximum accuracy using all features (88%) were equal to 78% and 94%, respectively. Other points in the ROC curve gave us sens/spec=92%/73%, and 95%/68% (Fig. 14
                        ).

In Figs. 15 and 16
                        
                         we analyze two misclassified cases, one false positive (FP) and one false negative (FN). In Fig. 17
                         we present a challenging NVD case that was correctly detected.

The FP case in Fig. 15a presents thin vessels with some degree of tortuosity, which are usually characteristic of NVD. By analyzing the results of the adaptive vessel segmentation shown in Fig. 15b, we confirm that we are extracting features from these vessels. However, these are just normal vessels that follow a pattern similar to NVD.


                        Fig. 16 shows the FN case. The highlighted regions of Fig. 15a show NVD present on this image. It can be seen that the spatial extent of these vessels is very small. In fact, only one of them is captured by our segmentation procedure (Fig. 16b). This case demonstrates very subtle NVD which would take a robust ophthalmic evaluation to detect. On the other hand, Fig. 17 presents a case with subtle NVD that was correctly classified. The main difference with respect to the FN case is that there are more regions with NVD. Therefore, the adaptive vessel segmentation approach has a greater chance of capturing them.

@&#CONCLUSIONS@&#

This paper presents a novel methodology for the detection of neovascularization in the optic disc. The focus of this method is not to characterize segments of the vasculature as performed by [10]. Instead, we characterize the vasculature as normal or abnormal. The proposed adaptive vessel segmentation method adequately detects neovascularization, allowing us to correctly extract features of these structures, thus minimizing the inclusion of spurious information from other structures in the retina. By combining an adaptive vessel segmentation approach with the features extracted using AM-FM, granulometry, and spatial information with fractal dimensionality, we have improved upon previous results presented in the automatic classification of NVD [10]. The significance of these results is supported by the fact that we used a medium-scale database composed of 300 images, achieving a high generalization capacity. This method can be further improved by optimizing empirically set parameters, the adaptive vessel segmentation iteration, and feature selection. This system can be used in conjunction with an automatic DR screening algorithm to ensure that no sight-threatening conditions due to neovascularization are missed.

@&#ACKNOWLEDGEMENTS@&#

The authors thank Dr. Wendall Bauman for his medical review and for providing data for the research. We also thank The University of Texas Health Sciences Center in San Antonio and the Retina Institute of South Texas for providing our dataset.

@&#REFERENCES@&#

