@&#MAIN-TITLE@&#Analysis-suitable adaptive T-mesh refinement with linear complexity

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a new algorithm for the adaptive refinement of T-meshes.


                        
                        
                           
                           The algorithm preserves Analysis-Suitability and produces nested T-spline spaces.


                        
                        
                           
                           Any two generated meshes have an analysis-suitable overlay.


                        
                        
                           
                           We prove linear complexity of the refinement algorithm.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Isogeometric analysis

T-splines

Analysis-suitability

Nestedness

Adaptive mesh refinement

@&#ABSTRACT@&#


               
               
                  We present an efficient adaptive refinement procedure that preserves analysis-suitability of the T-mesh, that is, the linear independence of the T-spline blending functions. We prove analysis-suitability of the overlays and boundedness of their cardinalities, nestedness of the generated T-spline spaces, and linear computational complexity of the refinement procedure in terms of the number of marked and generated mesh elements.
               
            

@&#INTRODUCTION@&#

T-splines (Sederberg et al., 2003) have been introduced as a free-form geometric technology and are one of the most promising features in the Isogeometric Analysis (IGA) framework introduced by Hughes et al. (2005), Cottrell et al. (2009). At present, the main interest in IGA is in finding discrete function spaces that integrate well into CAD applications and, at the same time, can be used for Finite Element Analysis. Throughout the last years, hierarchical B-Splines (Scott et al., 2014; Kuru et al., 2014) and LR-Splines (Dokken et al., 2013; Johannessen et al., 2014) have arisen as alternative approaches to T-Splines for the establishment of an adaptive B-Spline technology. While none of these strategies has outperformed the other competing approaches until today, this paper aims to push forward and motivate the T-Spline technology.

Since T-splines can be locally refined (Sederberg et al., 2004), they potentially link the powerful geometric concept of Non-Uniform Rational B-Splines (NURBS) to meshes with T-junctions (referred as “hanging nodes” in the Finite Element context) and, hence, the well-established framework of adaptive mesh refinement. However, Buffa et al. (2010) have shown that T-meshes can induce linear dependent T-spline blending functions. This prohibits the use of T-splines as a basis for analytical purposes such as solving a partial differential equation. In particular, the mesh refinement algorithm presented by Sederberg et al. (2004) does not preserve analysis-suitability in general. This insight motivated the research on T-meshes that guarantee the linear independence of the corresponding T-spline blending functions, referred to as analysis-suitable T-meshes. Analysis-suitability has been characterized in terms of topological mesh properties in 2d (Li et al., 2012) and, in an alternative approach, through the equivalent concept of Dual-Compatibility (da Veiga et al., 2012), which allows for generalization to three-dimensional meshes.

A refinement procedure that preserves the analysis-suitability of two-dimensional T-meshes was finally presented by Scott et al. (2012). The procedure first refines the marked elements, producing a mesh that is not analysis-suitable in general, and then computes a refinement which is analysis-suitable and generates a T-spline space that is a superspace of the previous one. This second refinement involves heuristic local estimates on how much refinement is needed to achieve the desired properties. Hence, the reliable theoretical analysis of the algorithm is very difficult and so is the analysis of corresponding automatic mesh refinement algorithms driven by a posteriori error estimators. Such analysis is currently available only for triangular meshes (Carstensen et al., 2014; Cascon et al., 2008; Stevenson, 2007), but is necessary to reliably point out the advantages of adaptive mesh refinement.

In this paper, we present a new refinement algorithm which provides
                        
                           1.
                           the preservation of analysis-suitability and nestedness of the generated T-spline spaces,

a bounded cardinality of the overlay (which is the coarsest common refinement of two meshes),

linear computational complexity of the refinement procedure in the sense that there is a constant bound, depending only on the polynomial degree of the T-spline blending functions, on the ratio between the number of generated elements in the fine mesh and the number of marked elements in all refinement steps.

This paper is organized as follows. We define the refinement algorithm along with a class of admissible meshes in Section 2. In Section 3, we prove that all admissible meshes are analysis-suitable. Section 4 proves essential properties of the overlay of two admissible meshes, and in Section 5 we prove nestedness of the T-spline spaces corresponding to admissible refinements. Section 6 shows linear complexity of the refinement procedure, and conclusions and an outlook to future work are finally given in Section 7. Sections 3, 4 and 6 independently rely on the definitions and results of Section 2, Section 5 also makes use of the definitions from Section 4.

This section defines the new refinement algorithm and characterizes the class of meshes which is generated by this algorithm. The initial mesh is assumed to have a very simple structure. In the context of IGA, the partitioned rectangular domain is referred to as index domain. This is, we assume that the physical domain (on which, e.g., a PDE is to be solved) is obtained by a continuous map from the active region (cf. Section 3), which is a subset of the index domain. Throughout this paper, we focus on the mesh refinement only, and therefore we will only consider the index domain. For the parametrization and refinement of the T-spline blending functions, we refer to Scott et al. (2012). 
                        Definition 2.1
                        Initial mesh, element


                        Given positive numbers 
                              M
                              ,
                              N
                              ∈
                              N
                           , the initial mesh 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                            is a tensor product mesh consisting of closed squares (also denoted elements) with side length 1, i.e.,
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          0
                                       
                                    
                                    :
                                    =
                                    {
                                    [
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    ]
                                    ×
                                    [
                                    n
                                    −
                                    1
                                    ,
                                    n
                                    ]
                                    |
                                    m
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    M
                                    }
                                    ,
                                    n
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                    }
                                    }
                                    .
                                 
                              
                            The domain partitioned by 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                            is denoted by 
                              
                                 Ω
                                 ¯
                              
                              :
                              =
                              ⋃
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                           .

The key property of the refinement algorithm will be that refinement of an element K is allowed only if elements in a certain neighbourhood are sufficiently fine. The size of this neighbourhood, which is denoted 
                        (
                        p
                        ,
                        q
                        )
                     
                     -patch and defined through the definitions below, depends on the size of K and the polynomial bi-degree 
                        (
                        p
                        ,
                        q
                        )
                      of the T-spline blending functions.


                     
                        Definition 2.2
                        Level


                        The level of an element K is defined by
                              
                                 
                                    ℓ
                                    (
                                    K
                                    )
                                    :
                                    =
                                    −
                                    
                                       
                                          log
                                       
                                       
                                          2
                                       
                                    
                                    ⁡
                                    |
                                    K
                                    |
                                    ,
                                 
                              
                            where 
                              |
                              K
                              |
                            denotes the volume of K. This implies that all elements of the initial mesh have level zero and that the bisection of an element K yields two elements of level 
                              ℓ
                              (
                              K
                              )
                              +
                              1
                           .


                     
                        Definition 2.3
                        Vector-valued distance


                        Given 
                              x
                              ∈
                              
                                 Ω
                                 ¯
                              
                            and an element K, we define their distance as the componentwise absolute value of the difference between x and the midpoint of K,
                              
                                 
                                    Dist
                                    (
                                    K
                                    ,
                                    x
                                    )
                                    :
                                    =
                                    abs
                                    (
                                    mid
                                    (
                                    K
                                    )
                                    −
                                    x
                                    )
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                            For two elements 
                              
                                 
                                    K
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    K
                                 
                                 
                                    2
                                 
                              
                           , we define the shorthand notation
                              
                                 
                                    Dist
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    :
                                    =
                                    abs
                                    (
                                    mid
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    −
                                    mid
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    .
                                 
                              
                           
                        


                     
                        Definition 2.4
                        Given an element K and polynomial degrees p and q, the 
                              (
                              p
                              ,
                              q
                              )
                           -patch is defined by
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    K
                                    )
                                    :
                                    =
                                    {
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    G
                                    |
                                    Dist
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    K
                                    )
                                    ≤
                                    
                                       
                                          D
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    ℓ
                                    (
                                    K
                                    )
                                    )
                                    }
                                    ,
                                 
                              
                            where
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    k
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      k
                                                      /
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   ⌊
                                                   
                                                      p
                                                      2
                                                   
                                                   ⌋
                                                   +
                                                   
                                                      1
                                                      2
                                                   
                                                   ,
                                                   
                                                   ⌈
                                                   
                                                      q
                                                      2
                                                   
                                                   ⌉
                                                   +
                                                   
                                                      1
                                                      2
                                                   
                                                   )
                                                
                                             
                                             
                                                if 
                                                k
                                                 is even
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                      /
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   ⌈
                                                   
                                                      p
                                                      2
                                                   
                                                   ⌉
                                                   +
                                                   
                                                      1
                                                      2
                                                   
                                                   ,
                                                   
                                                   2
                                                   ⌊
                                                   
                                                      q
                                                      2
                                                   
                                                   ⌋
                                                   +
                                                   1
                                                   )
                                                
                                             
                                             
                                                if 
                                                k
                                                 is odd
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                            Note as a technical detail that this definition does not require that 
                              K
                              ∈
                              G
                           .


                     
                        Remark
                        In a uniform even-leveled mesh, 
                              ⋃
                              
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                            is obtained by extending K by a face extension length (cf. Definition 3.4) above and below and by an edge extension length to the left and to the right (Fig. 1
                           ). In a uniform odd-leveled mesh, 
                              ⋃
                              
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                            is obtained by extending K by a face extension length to the left and to the right and by an edge extension length above and below. The 
                              (
                              p
                              ,
                              q
                              )
                           -patch will be used to enforce a local quasi-uniformity of the mesh. Throughout the rest of this paper, we assume 
                              p
                              ,
                              q
                              ≥
                              2
                           . This guarantees that neighboring elements of K (elements that share an edge or vertex with K) are always in 
                              
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                           , and that nested elements 
                              
                                 
                                    K
                                 
                                 
                                    ˇ
                                 
                              
                              ⊆
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                            have nested 
                              (
                              p
                              ,
                              q
                              )
                           -patches 
                              
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    K
                                 
                                 
                                    ˇ
                                 
                              
                              )
                              ⊆
                              
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           .

In the subsequent definitions, we will give a detailed description of the elementary bisection steps and then present the new refinement algorithm.


                     
                        Definition 2.5
                        Bisection of an element


                        Given an arbitrary element 
                              K
                              =
                              [
                              μ
                              ,
                              μ
                              +
                              
                                 
                                    μ
                                 
                                 
                                    ˜
                                 
                              
                              ]
                              ×
                              [
                              ν
                              ,
                              ν
                              +
                              
                                 
                                    ν
                                 
                                 
                                    ˜
                                 
                              
                              ]
                           , where 
                              μ
                              ,
                              ν
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    ˜
                                 
                              
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    ˜
                                 
                              
                              ∈
                              R
                            and 
                              
                                 
                                    μ
                                 
                                 
                                    ˜
                                 
                              
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    ˜
                                 
                              
                              >
                              0
                           , we define the operators
                              
                                 
                                    
                                       
                                          bisect
                                       
                                       
                                          x
                                       
                                    
                                    (
                                    K
                                    )
                                    :
                                    =
                                    {
                                    
                                    [
                                    μ
                                    ,
                                    μ
                                    +
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             ˜
                                          
                                       
                                       2
                                    
                                    ]
                                    ×
                                    [
                                    ν
                                    ,
                                    ν
                                    +
                                    
                                       
                                          ν
                                       
                                       
                                          ˜
                                       
                                    
                                    ]
                                    ,
                                    
                                    [
                                    μ
                                    +
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             ˜
                                          
                                       
                                       2
                                    
                                    ,
                                    μ
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          ˜
                                       
                                    
                                    ]
                                    ×
                                    [
                                    ν
                                    ,
                                    ν
                                    +
                                    
                                       
                                          ν
                                       
                                       
                                          ˜
                                       
                                    
                                    ]
                                    
                                    }
                                    
                                    and
                                    
                                    
                                       
                                          bisect
                                       
                                       
                                          y
                                       
                                    
                                    (
                                    K
                                    )
                                    :
                                    =
                                    {
                                    
                                    [
                                    μ
                                    ,
                                    μ
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          ˜
                                       
                                    
                                    ]
                                    ×
                                    [
                                    ν
                                    ,
                                    ν
                                    +
                                    
                                       
                                          
                                             ν
                                          
                                          
                                             ˜
                                          
                                       
                                       2
                                    
                                    ]
                                    ,
                                    
                                    [
                                    μ
                                    ,
                                    μ
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          ˜
                                       
                                    
                                    ]
                                    ×
                                    [
                                    ν
                                    +
                                    
                                       
                                          
                                             ν
                                          
                                          
                                             ˜
                                          
                                       
                                       2
                                    
                                    ,
                                    ν
                                    +
                                    
                                       
                                          ν
                                       
                                       
                                          ˜
                                       
                                    
                                    ]
                                    
                                    }
                                    .
                                 
                              
                            Note that 
                              
                                 
                                    bisect
                                 
                                 
                                    x
                                 
                              
                            adds an edge in y-direction, while 
                              
                                 
                                    bisect
                                 
                                 
                                    y
                                 
                              
                            adds an edge in x-direction.

Given a mesh 
                              G
                            and an element 
                              K
                              ∈
                              G
                           , we denote by 
                              bisect
                              (
                              G
                              ,
                              K
                              )
                            the mesh that results from a level-dependent bisection of K,
                              
                                 
                                    bisect
                                    (
                                    G
                                    ,
                                    K
                                    )
                                    :
                                    =
                                    G
                                    ∖
                                    {
                                    K
                                    }
                                    ∪
                                    child
                                    (
                                    K
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    with
                                    
                                    child
                                    (
                                    K
                                    )
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      bisect
                                                   
                                                   
                                                      x
                                                   
                                                
                                                (
                                                K
                                                )
                                             
                                             
                                                if 
                                                ℓ
                                                (
                                                K
                                                )
                                                 is even
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      bisect
                                                   
                                                   
                                                      y
                                                   
                                                
                                                (
                                                K
                                                )
                                             
                                             
                                                if 
                                                ℓ
                                                (
                                                K
                                                )
                                                 is odd
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We introduce the shorthand notation 
                              bisect
                              (
                              G
                              ,
                              M
                              )
                            for the bisection of several elements 
                              M
                              =
                              {
                              
                                 
                                    K
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    K
                                 
                                 
                                    J
                                 
                              
                              }
                              ⊆
                              G
                           , defined by successive bisections in an arbitrary order,
                              
                                 
                                    bisect
                                    (
                                    G
                                    ,
                                    M
                                    )
                                    :
                                    =
                                    bisect
                                    (
                                    bisect
                                    (
                                    …
                                    bisect
                                    (
                                    G
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ,
                                    …
                                    )
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          J
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

We will now define the new refinement algorithm through the bisection of a superset 
                        
                           
                              clos
                           
                           
                              G
                           
                           
                              p
                              ,
                              q
                           
                        
                        (
                        M
                        )
                      of the marked elements 
                        M
                     . In the remaining part of this section, we characterize the class of meshes generated by this refinement algorithm.


                     
                        Algorithm 2.8
                        Closure


                        Given a mesh 
                              G
                            and a set of marked elements 
                              M
                              ⊆
                              G
                            to be bisected, the closure 
                           
                              
                                 
                                    clos
                                 
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              M
                              )
                            of 
                              M
                            is computed as follows.
                              
                                 
                              
                           
                        


                     
                        Algorithm 2.9
                        Refinement


                        Given a mesh 
                              G
                            and a set of marked elements 
                              M
                              ⊆
                              G
                            to be bisected, 
                              
                                 
                                    ref
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              G
                              ,
                              M
                              )
                            is defined by
                              
                                 
                                    
                                       
                                          ref
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    G
                                    ,
                                    M
                                    )
                                    :
                                    =
                                    bisect
                                    (
                                    G
                                    ,
                                    
                                       
                                          clos
                                       
                                       
                                          G
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    M
                                    )
                                    )
                                    .
                                 
                              
                           
                        


                           Figs. 2, 3 and 4
                           
                           
                            illustrate three successive applications of Algorithm 2.9 with 
                              p
                              =
                              q
                              =
                              3
                           . In each case, only one element K is marked. In the first case, the patch of K is as fine as K and hence no additional refinement is necessary. In the second case, one additional iteration of Algorithm 2.8 is needed to compute 
                              
                                 
                                    clos
                                 
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              {
                              K
                              }
                              )
                           . In the third case, the algorithm stops after three iterations.

In the subsequent definitions, we introduce a class of admissible meshes. We will then prove that Algorithm 2.9 preserves admissibility.


                     
                        Definition 2.11
                        
                           
                              (
                              p
                              ,
                              q
                              )
                           -admissible bisections


                        Given a mesh 
                              G
                            and an element 
                              K
                              ∈
                              G
                           , the bisection of K is called 
                              (
                              p
                              ,
                              q
                              )
                           
                           -admissible if all 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                            satisfy 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              )
                              ≥
                              ℓ
                              (
                              K
                              )
                           .

In the case of several elements 
                              M
                              =
                              {
                              
                                 
                                    K
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    K
                                 
                                 
                                    J
                                 
                              
                              }
                              ⊆
                              G
                           , the bisection 
                              bisect
                              (
                              G
                              ,
                              M
                              )
                            is 
                              (
                              p
                              ,
                              q
                              )
                           -admissible if there is an order 
                              (
                              σ
                              (
                              1
                              )
                              ,
                              …
                              ,
                              σ
                              (
                              J
                              )
                              )
                            (this is, if there is a permutation σ of 
                              {
                              1
                              ,
                              …
                              ,
                              J
                              }
                           ) such that
                              
                                 
                                    bisect
                                    (
                                    G
                                    ,
                                    M
                                    )
                                    =
                                    bisect
                                    (
                                    bisect
                                    (
                                    …
                                    bisect
                                    (
                                    G
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          σ
                                          (
                                          1
                                          )
                                       
                                    
                                    )
                                    ,
                                    …
                                    )
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          σ
                                          (
                                          J
                                          )
                                       
                                    
                                    )
                                 
                              
                            is a concatenation of 
                              (
                              p
                              ,
                              q
                              )
                           -admissible bisections.

A refinement 
                              G
                            of 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                            is 
                              (
                              p
                              ,
                              q
                              )
                           
                           -admissible if there is a sequence of meshes 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                              
                              =
                              G
                            and markings 
                              
                                 
                                    M
                                 
                                 
                                    j
                                 
                              
                              ⊆
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                            for 
                              j
                              =
                              0
                              ,
                              …
                              ,
                              J
                              −
                              1
                           , such that 
                              
                                 
                                    G
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              =
                              bisect
                              (
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    j
                                 
                              
                              )
                            is a 
                              (
                              p
                              ,
                              q
                              )
                           -admissible bisection for all 
                              j
                              =
                              0
                              ,
                              …
                              ,
                              J
                              −
                              1
                           . The set of all 
                              (
                              p
                              ,
                              q
                              )
                           -admissible meshes, which is the initial mesh and its 
                              (
                              p
                              ,
                              q
                              )
                           -admissible refinements, is denoted by 
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                           . For the sake of legibility, we write ‘admissible’ instead of ‘
                              (
                              p
                              ,
                              q
                              )
                           -admissible’ throughout the rest of this paper.

This definition refers to the understanding of ‘admissible meshes’ in FE analysis. It does not match the definitions of admissible meshes from da Veiga et al. (2013), Li and Scott (2014).


                     
                        Proposition 2.13
                        
                           Any admissible mesh 
                           
                              G
                            
                           and any set of marked elements 
                           
                              M
                              ⊆
                              G
                            
                           satisfy 
                           
                              
                                 
                                    ref
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              G
                              ,
                              M
                              )
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                           
                           .
                        

The proof of Proposition 2.13 given at the end of this section relies on the subsequent results.


                     
                        Lemma 2.14
                        Local quasi-uniformity


                        
                           Given 
                           
                              K
                              ∈
                              G
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                           
                           , any 
                           
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                            
                           satisfies 
                           
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              )
                              ≥
                              ℓ
                              (
                              K
                              )
                              −
                              1
                           
                           .
                        

For 
                              ℓ
                              (
                              K
                              )
                              =
                              0
                           , the assertion is always true. For 
                              ℓ
                              (
                              K
                              )
                              >
                              0
                           , consider the parent 
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                            of K (i.e., the unique element 
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                              ∈
                              ⋃
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            with 
                              K
                              ∈
                              child
                              (
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           ). Since K results from the bisection of 
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                           , we also have that
                              
                                 
                                    d
                                    (
                                    K
                                    )
                                    :
                                    =
                                    Dist
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      (
                                                      ℓ
                                                      (
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      )
                                                      +
                                                      4
                                                      )
                                                      /
                                                      2
                                                   
                                                
                                                ,
                                                0
                                                )
                                             
                                             
                                                if 
                                                ℓ
                                                (
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                )
                                                 is even
                                             
                                          
                                          
                                             
                                                (
                                                0
                                                ,
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      (
                                                      ℓ
                                                      (
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      )
                                                      +
                                                      3
                                                      )
                                                      /
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                if 
                                                ℓ
                                                (
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                )
                                                 is odd
                                             
                                          
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                (
                                                0
                                                ,
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      (
                                                      ℓ
                                                      (
                                                      K
                                                      )
                                                      +
                                                      2
                                                      )
                                                      /
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                if 
                                                ℓ
                                                (
                                                K
                                                )
                                                 even,
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      (
                                                      ℓ
                                                      (
                                                      K
                                                      )
                                                      +
                                                      3
                                                      )
                                                      /
                                                      2
                                                   
                                                
                                                ,
                                                0
                                                )
                                             
                                             
                                                if 
                                                ℓ
                                                (
                                                K
                                                )
                                                 odd.
                                             
                                          
                                       
                                    
                                 
                              
                            Since 
                              G
                            is admissible, there are admissible meshes 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                              
                              =
                              G
                            and some 
                              j
                              ∈
                              {
                              0
                              ,
                              …
                              ,
                              J
                              −
                              1
                              }
                            such that 
                              K
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              =
                              bisect
                              (
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                              ,
                              {
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                              }
                              )
                           . The admissibility 
                              
                                 
                                    G
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            implies that any 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                              )
                            satisfies 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              )
                              ≥
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                              )
                              =
                              ℓ
                              (
                              K
                              )
                              −
                              1
                           . Since levels do not decrease during refinement, we get
                              
                                 (1)
                                 
                                    ℓ
                                    (
                                    K
                                    )
                                    −
                                    1
                                    ≤
                                    min
                                    ⁡
                                    {
                                    ℓ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    |
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    
                                       
                                          G
                                       
                                       
                                          j
                                       
                                    
                                     and 
                                    Dist
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ≤
                                    
                                       
                                          D
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    ℓ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    )
                                    }
                                    ≤
                                    min
                                    ⁡
                                    {
                                    ℓ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    |
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    G
                                     and 
                                    Dist
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ≤
                                    
                                       
                                          D
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    ℓ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    )
                                    }
                                    =
                                    min
                                    ⁡
                                    {
                                    ℓ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    |
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    G
                                     and 
                                    Dist
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ≤
                                    
                                       
                                          D
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    ℓ
                                    (
                                    K
                                    )
                                    −
                                    1
                                    )
                                    }
                                    ≤
                                    min
                                    ⁡
                                    {
                                    ℓ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    |
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    G
                                     and 
                                    Dist
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    +
                                    d
                                    (
                                    K
                                    )
                                    ≤
                                    
                                       
                                          D
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    ℓ
                                    (
                                    K
                                    )
                                    −
                                    1
                                    )
                                    }
                                    .
                                 
                              
                            One easily computes 
                              
                                 
                                    D
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              ℓ
                              (
                              K
                              )
                              −
                              1
                              )
                              −
                              d
                              (
                              K
                              )
                              >
                              
                                 
                                    D
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              ℓ
                              (
                              K
                              )
                              )
                           , which concludes the proof.  □


                     
                        Corollary 2.15
                        
                           Let 
                           
                              K
                              ∈
                              G
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            
                           and
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                U
                                             
                                             ¯
                                          
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    K
                                    )
                                    :
                                    =
                                    {
                                    x
                                    ∈
                                    
                                       Ω
                                       ¯
                                    
                                    |
                                    Dist
                                    (
                                    K
                                    ,
                                    x
                                    )
                                    ≤
                                    
                                       
                                          D
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    ℓ
                                    (
                                    K
                                    )
                                    )
                                    }
                                    ,
                                 
                              
                            
                           then
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    K
                                    )
                                    =
                                    {
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    G
                                    |
                                    |
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ∩
                                    
                                       
                                          
                                             
                                                
                                                U
                                             
                                             ¯
                                          
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    K
                                    )
                                    |
                                    >
                                    0
                                    }
                                    .
                                 
                              
                           
                        

This is a consequence of Lemma 2.14 in the strong version (1) that involves a bigger patch of K.  □


                     
                        Proof of Proposition 2.13
                        Given the mesh 
                              G
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            and marked elements 
                              M
                              ⊆
                              G
                            to be bisected, we have to show that there is a sequence of meshes that are subsequent admissible bisections, with 
                              G
                            being the first and 
                              
                                 
                                    ref
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              G
                              ,
                              M
                              )
                            the last mesh in that sequence. Set 
                              
                                 M
                                 ∼
                              
                              :
                              =
                              
                                 
                                    clos
                                 
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              M
                              )
                            and
                              
                                 (2)
                                 
                                    
                                       
                                          
                                             
                                             L
                                          
                                          ¯
                                       
                                       :
                                       =
                                       max
                                       ⁡
                                       ℓ
                                       (
                                       
                                          M
                                          ∼
                                       
                                       )
                                       ,
                                       
                                       
                                          L
                                          ̲
                                       
                                       :
                                       =
                                       min
                                       ⁡
                                       ℓ
                                       (
                                       
                                          M
                                          ∼
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                       :
                                       =
                                       {
                                       K
                                       ∈
                                       
                                          M
                                          ∼
                                       
                                       |
                                       ℓ
                                       (
                                       K
                                       )
                                       =
                                       j
                                       }
                                       
                                       for
                                       
                                       j
                                       =
                                       
                                          L
                                          ̲
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                             L
                                          
                                          ¯
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             
                                                L
                                                ̲
                                             
                                          
                                       
                                       :
                                       =
                                       G
                                       ,
                                       
                                       
                                          
                                             G
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       :
                                       =
                                       bisect
                                       (
                                       
                                          
                                             G
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       
                                       for
                                       
                                       j
                                       =
                                       
                                          L
                                          ̲
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                             L
                                          
                                          ¯
                                       
                                       .
                                    
                                 
                              
                            It follows that 
                              
                                 
                                    ref
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              G
                              ,
                              M
                              )
                              =
                              
                                 
                                    G
                                 
                                 
                                    
                                       
                                          
                                          L
                                       
                                       ¯
                                    
                                    +
                                    1
                                 
                              
                           . We will show by induction over j that all bisections in (2) are admissible.

For the first step 
                              j
                              =
                              
                                 L
                                 ̲
                              
                           , we know 
                              {
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 M
                                 ∼
                              
                              |
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              )
                              <
                              
                                 L
                                 ̲
                              
                              }
                              =
                              ∅
                           , and by construction of 
                              
                                 M
                                 ∼
                              
                            that for each 
                              K
                              ∈
                              
                                 
                                    
                                       M
                                       ∼
                                    
                                 
                                 
                                    
                                       L
                                       ̲
                                    
                                 
                              
                            holds 
                              {
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                              |
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              )
                              <
                              ℓ
                              (
                              K
                              )
                              }
                              ⊆
                              
                                 M
                                 ∼
                              
                           . Together with 
                              ℓ
                              (
                              K
                              )
                              =
                              
                                 L
                                 ̲
                              
                            follows for any 
                              K
                              ∈
                              
                                 
                                    
                                       M
                                       ∼
                                    
                                 
                                 
                                    
                                       L
                                       ̲
                                    
                                 
                              
                            that there is no 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                            with 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              )
                              <
                              ℓ
                              (
                              K
                              )
                           . This is, the bisections of all 
                              K
                              ∈
                              
                                 
                                    
                                       M
                                       ∼
                                    
                                 
                                 
                                    
                                       L
                                       ̲
                                    
                                 
                              
                            are admissible independently of their order and hence 
                              bisect
                              (
                              
                                 
                                    G
                                 
                                 
                                    
                                       L
                                       ̲
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       M
                                       ∼
                                    
                                 
                                 
                                    
                                       L
                                       ̲
                                    
                                 
                              
                              )
                            is admissible.

Consider an arbitrary step 
                              j
                              ∈
                              {
                              
                                 L
                                 ̲
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                    L
                                 
                                 ¯
                              
                              }
                            and assume that 
                              
                                 
                                    G
                                 
                                 
                                    
                                       L
                                       ̲
                                    
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                            are admissible meshes. Assume for contradiction that there is 
                              K
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    j
                                 
                              
                            of which the bisection is not admissible, i.e., there exists 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                            with 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              )
                              <
                              ℓ
                              (
                              K
                              )
                            and consequently 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∉
                              
                                 M
                                 ∼
                              
                           , because 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                            has not been bisected yet. It follows from the closure Algorithm 2.8 that 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∉
                              G
                           . Hence, there is 
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                              ∈
                              G
                            such that 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ⊂
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                           . We have 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                              )
                              <
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              )
                              <
                              ℓ
                              (
                              K
                              )
                           , which implies 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                              )
                              <
                              ℓ
                              (
                              K
                              )
                              −
                              1
                           . Note that 
                              K
                              ∈
                              G
                            because 
                              
                                 
                                    M
                                 
                                 
                                    j
                                 
                              
                              ⊆
                              
                                 M
                                 ∼
                              
                              ⊆
                              G
                           . Moreover, from 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ⊂
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                            and 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                            it follows with Corollary 2.15 that 
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                           . Together with 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ˆ
                                 
                              
                              )
                              <
                              ℓ
                              (
                              K
                              )
                              −
                              1
                           , Lemma 2.14 implies that 
                              G
                            is not admissible, which contradicts the assumption.  □

In this section, we give a brief review on the concept of Analysis-Suitability, using the notation from da Veiga et al. (2013). We prove that all admissible meshes (in the sense of Definition 2.12) are analysis-suitable and hence provide linearly independent T-spline blending functions. In this paper, we omit the definition of the T-spline blending functions and details on their linear independence. We refer the reader to Li et al. (2012), da Veiga et al. (2012) and, in particular for the case of non-cubic T-splines (da Veiga et al., 2013).


                     
                        Definition 3.1
                        Active nodes


                        Consider an admissible mesh 
                              G
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                           . The set of vertices (nodes) of 
                              G
                            is denoted by 
                              N
                           . We define the active region
                           
                              
                                 
                                    
                                       AR
                                    
                                    :
                                    =
                                    [
                                    ⌈
                                    
                                       p
                                       2
                                    
                                    ⌉
                                    ,
                                    M
                                    −
                                    ⌈
                                    
                                       p
                                       2
                                    
                                    ⌉
                                    ]
                                    ×
                                    [
                                    ⌈
                                    
                                       q
                                       2
                                    
                                    ⌉
                                    ,
                                    N
                                    −
                                    ⌈
                                    
                                       q
                                       2
                                    
                                    ⌉
                                    ]
                                 
                              
                            and the set of active nodes 
                           
                              
                                 
                                    N
                                 
                                 
                                    A
                                 
                              
                              :
                              =
                              N
                              ∩
                              
                                 AR
                              
                           .

To each active node T, we associate local index vectors 
                        x
                        (
                        T
                        )
                      and 
                        y
                        (
                        T
                        )
                      that are defined below, depending on the mesh in the neighbourhood of T. These local index vectors are used to construct a tensor-product B-spline 
                        
                           
                              B
                           
                           
                              T
                           
                        
                     , referred to as T-spline blending function.


                     
                        Definition 3.2
                        Skeleton


                        We denote by hSk (resp. vSk) the horizontal (resp. vertical) skeleton, which is the union of all horizontal (resp. vertical) edges. Note that 
                              
                                 hSk
                              
                              ∩
                              
                                 vSk
                              
                              =
                              N
                           .


                     
                        Definition 3.3
                        Global index sets


                        For any y in the closed interval 
                              [
                              ⌈
                              
                                 q
                                 2
                              
                              ⌉
                              ,
                              N
                              −
                              ⌈
                              
                                 q
                                 2
                              
                              ⌉
                              ]
                           , we set
                              
                                 
                                    X
                                    (
                                    y
                                    )
                                    :
                                    =
                                    {
                                    z
                                    ∈
                                    [
                                    0
                                    ,
                                    M
                                    ]
                                    |
                                    (
                                    z
                                    ,
                                    y
                                    )
                                    ∈
                                    
                                       vSk
                                    
                                    }
                                    ,
                                 
                              
                            and for any 
                              x
                              ∈
                              [
                              ⌈
                              
                                 p
                                 2
                              
                              ⌉
                              ,
                              M
                              −
                              ⌈
                              
                                 p
                                 2
                              
                              ⌉
                              ]
                           ,
                              
                                 
                                    Y
                                    (
                                    x
                                    )
                                    :
                                    =
                                    {
                                    z
                                    ∈
                                    [
                                    0
                                    ,
                                    N
                                    ]
                                    |
                                    (
                                    x
                                    ,
                                    z
                                    )
                                    ∈
                                    
                                       hSk
                                    
                                    }
                                    .
                                 
                              
                            Note that in an admissible mesh, the entries 
                              {
                              0
                              ,
                              …
                              ,
                              ⌈
                              
                                 p
                                 2
                              
                              ⌉
                              −
                              1
                              ,
                              
                              M
                              −
                              ⌈
                              
                                 p
                                 2
                              
                              ⌉
                              +
                              1
                              ,
                              …
                              ,
                              M
                              }
                            are always included in 
                              X
                              (
                              y
                              )
                            (and analogously for 
                              Y
                              (
                              x
                              )
                           ).

(See da Veiga et al., 2013, Section 2.1.) We denote by 
                              T
                              ⊂
                              
                                 
                                    N
                                 
                                 
                                    A
                                 
                              
                            the set of all active nodes with valence three (i.e., active nodes that are endpoints of exactly three edges) and refer to them as T-junctions. Following the literature (Li et al., 2012; da Veiga et al., 2012), we adopt the notation ⊥, ⊤, ⊢, ⊣ to indicate the four possible orientations of the T-junctions. T-junctions of type ⊣ and ⊢ (⊥, ⊤, respectively) and their extensions are called horizontal (vertical, resp.). For the sake of simplicity, let us consider a T-junction 
                              T
                              =
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              ∈
                              T
                            of type ⊣. Clearly, 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                            is one of the entries of 
                              X
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                           . We extract from 
                              X
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                            the 
                              p
                              +
                              1
                            consecutive indices 
                              
                                 
                                    i
                                 
                                 
                                    −
                                    ⌊
                                    p
                                    /
                                    2
                                    ⌋
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    i
                                 
                                 
                                    ⌈
                                    p
                                    /
                                    2
                                    ⌉
                                 
                              
                            such that 
                              
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                           . We denote
                              
                                 
                                    
                                       
                                          ext
                                       
                                       
                                          e
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    T
                                    )
                                    :
                                    =
                                    [
                                    
                                       
                                          i
                                       
                                       
                                          −
                                          ⌊
                                          p
                                          /
                                          2
                                          ⌋
                                       
                                    
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    ]
                                    ×
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    }
                                    ,
                                    
                                    
                                       
                                          ext
                                       
                                       
                                          f
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    T
                                    )
                                    :
                                    =
                                    
                                    ]
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          ⌈
                                          p
                                          /
                                          2
                                          ⌉
                                       
                                    
                                    ]
                                    ×
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    }
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          ext
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    T
                                    )
                                    :
                                    =
                                    
                                       
                                          ext
                                       
                                       
                                          f
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    T
                                    )
                                    ∪
                                    
                                       
                                          ext
                                       
                                       
                                          e
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    T
                                    )
                                    ,
                                 
                              
                            where 
                              
                                 
                                    ext
                                 
                                 
                                    e
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              T
                              )
                            is denoted edge-extension, 
                              
                                 
                                    ext
                                 
                                 
                                    f
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              T
                              )
                            is denoted face-extension and 
                              
                                 
                                    ext
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              T
                              )
                            is just the extension of the T-junction T.

(See da Veiga et al., 2013, Definition 2.5.) A mesh is analysis-suitable if horizontal T-junction extensions do not intersect vertical T-junction extensions.

The main result of this section is the following theorem. 
                        Theorem 3.6
                        
                           All admissible meshes (in the sense of 
                           
                              Definition 2.12
                           
                           ) are analysis-suitable.
                        

We prove the theorem by induction over admissible bisections. We know that the initial mesh 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                            is analysis-suitable because it is a tensor-product mesh without any T-junctions. Consider a sequence 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                              
                            of successive admissible bisections such that 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    G
                                 
                                 
                                    J
                                    −
                                    1
                                 
                              
                            are analysis-suitable. Without loss of generality we shall assume that elements are refined in ascending order with respect to their level, i.e., for 
                              
                                 
                                    G
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              =
                              bisect
                              (
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                              )
                           , we assume that 
                              0
                              =
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    0
                                 
                              
                              )
                              ≤
                              …
                              ≤
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    J
                                    −
                                    1
                                 
                              
                              )
                           . There is such a sequence for any admissible mesh; see the proof of Proposition 4.3. We have to show that 
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                              
                            is analysis-suitable as well.

We denote 
                              K
                              :
                              =
                              
                                 
                                    K
                                 
                                 
                                    J
                                    −
                                    1
                                 
                              
                              =
                              [
                              μ
                              ,
                              μ
                              +
                              
                                 
                                    μ
                                 
                                 
                                    ˜
                                 
                              
                              ]
                              ×
                              [
                              ν
                              ,
                              ν
                              +
                              
                                 
                                    ν
                                 
                                 
                                    ˜
                                 
                              
                              ]
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    J
                                    −
                                    1
                                 
                              
                           , and we assume without loss of generality that 
                              ℓ
                              (
                              K
                              )
                            is even. The assumption that elements are refined in ascending order with respect to their level implies that no element finer than K has been bisected yet, i.e.,
                              
                                 (3)
                                 
                                    max
                                    ⁡
                                    ℓ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          J
                                       
                                    
                                    )
                                    =
                                    ℓ
                                    (
                                    K
                                    )
                                    +
                                    1
                                    .
                                 
                              
                            Denote by
                              
                                 (4)
                                 
                                    
                                       
                                          G
                                       
                                       
                                          u
                                          |
                                          k
                                       
                                    
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             K
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       ⋃
                                       
                                          
                                             A
                                          
                                          
                                             p
                                             ,
                                             q
                                          
                                       
                                       |
                                       ℓ
                                       (
                                       
                                          
                                             K
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       =
                                       k
                                       }
                                    
                                    
                                    ∈
                                    
                                       
                                          A
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                 
                              
                            the k-th uniform refinement of 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                           . Then 
                              
                                 
                                    G
                                 
                                 
                                    u
                                    |
                                    ℓ
                                    (
                                    K
                                    )
                                    +
                                    1
                                 
                              
                            is a refinement of 
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                              
                           , in particular
                              
                                 (5)
                                 
                                    
                                       hSk
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          J
                                       
                                    
                                    )
                                    
                                    ⊆
                                    
                                    
                                       hSk
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          u
                                          |
                                          ℓ
                                          (
                                          K
                                          )
                                          +
                                          1
                                       
                                    
                                    )
                                    
                                    =
                                    
                                    
                                       hSk
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          u
                                          |
                                          ℓ
                                          (
                                          K
                                          )
                                       
                                    
                                    )
                                    ,
                                 
                              
                            since 
                              ℓ
                              (
                              K
                              )
                            is even. Since 
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                              
                            is admissible, all elements in 
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                            are at least of level 
                              ℓ
                              (
                              K
                              )
                            and hence
                              
                                 (6)
                                 
                                    
                                       hSk
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          J
                                       
                                    
                                    )
                                    ∩
                                    
                                       
                                          
                                             
                                                
                                                U
                                             
                                             ¯
                                          
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    K
                                    )
                                    
                                    ⊇
                                    
                                    
                                       hSk
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          u
                                          |
                                          ℓ
                                          (
                                          K
                                          )
                                       
                                    
                                    )
                                    ∩
                                    
                                       
                                          
                                             
                                                
                                                U
                                             
                                             ¯
                                          
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    K
                                    )
                                    ,
                                 
                              
                            and
                              
                                 (7)
                                 
                                    ∀
                                    
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                    ∈
                                    
                                       
                                          G
                                       
                                       
                                          J
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    K
                                    )
                                    :
                                    
                                    size
                                    (
                                    ℓ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    )
                                    ≤
                                    size
                                    (
                                    ℓ
                                    (
                                    K
                                    )
                                    )
                                 
                              
                            with the level-dependent size
                              
                                 (8)
                                 
                                    size
                                    (
                                    ℓ
                                    (
                                    K
                                    )
                                    )
                                    :
                                    =
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          ˜
                                       
                                    
                                    ,
                                    
                                       
                                          ν
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      ℓ
                                                      (
                                                      K
                                                      )
                                                      /
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      ℓ
                                                      (
                                                      K
                                                      )
                                                      /
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                if 
                                                ℓ
                                                (
                                                K
                                                )
                                                 even
                                                ,
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      (
                                                      ℓ
                                                      (
                                                      K
                                                      )
                                                      +
                                                      1
                                                      )
                                                      /
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      (
                                                      ℓ
                                                      (
                                                      K
                                                      )
                                                      −
                                                      1
                                                      )
                                                      /
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                if 
                                                ℓ
                                                (
                                                K
                                                )
                                                 odd
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                            Together, (5) and (6) read
                              
                                 (9)
                                 
                                    
                                       hSk
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          J
                                       
                                    
                                    )
                                    ∩
                                    
                                       
                                          
                                             
                                                
                                                U
                                             
                                             ¯
                                          
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    K
                                    )
                                    
                                    =
                                    
                                    
                                       hSk
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          u
                                          |
                                          ℓ
                                          (
                                          K
                                          )
                                       
                                    
                                    )
                                    ∩
                                    
                                       
                                          
                                             
                                                
                                                U
                                             
                                             ¯
                                          
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    K
                                    )
                                    .
                                 
                              
                            Consider a T-junction 
                              T
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    J
                                 
                              
                              ∖
                              
                                 
                                    T
                                 
                                 
                                    J
                                    −
                                    1
                                 
                              
                            that is generated by the bisection of K. Then T is a vertical T-junction on the boundary of K, and with (7) follows
                              
                                 
                                    
                                       
                                          ext
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    T
                                    )
                                    ⊆
                                    {
                                    μ
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          ˜
                                       
                                    
                                    /
                                    2
                                    }
                                    ×
                                    [
                                    ν
                                    −
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          K
                                          )
                                          /
                                          2
                                       
                                    
                                    ⌈
                                    
                                       q
                                       2
                                    
                                    ⌉
                                    ,
                                    
                                    ν
                                    +
                                    
                                       
                                          ν
                                       
                                       
                                          ˜
                                       
                                    
                                    +
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          K
                                          )
                                          /
                                          2
                                       
                                    
                                    ⌈
                                    
                                       q
                                       2
                                    
                                    ⌉
                                    ]
                                    .
                                 
                              
                            Consider an arbitrary horizontal T-junction 
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                              =
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              ∈
                              T
                           . We will prove that 
                              
                                 
                                    ext
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                              )
                            does not intersect 
                              
                                 
                                    ext
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              T
                              )
                           . From (5) we conclude that 
                              
                                 
                                    ext
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                              )
                              ⊆
                              
                                 hSk
                              
                              (
                              
                                 
                                    G
                                 
                                 
                                    u
                                    |
                                    ℓ
                                    (
                                    K
                                    )
                                 
                              
                              )
                           , and (9) implies that the vertex 
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                            is not in the interior of the 
                              (
                              p
                              ,
                              q
                              )
                           -patch of K and not on its top or bottom boundary, i.e.
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ˜
                                       
                                    
                                    ∉
                                    ]
                                    μ
                                    −
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          K
                                          )
                                          /
                                          2
                                       
                                    
                                    ⌊
                                    
                                       p
                                       2
                                    
                                    ⌋
                                    ,
                                    
                                    μ
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          ˜
                                       
                                    
                                    +
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          K
                                          )
                                          /
                                          2
                                       
                                    
                                    ⌊
                                    
                                       p
                                       2
                                    
                                    ⌋
                                    [
                                    
                                    ×
                                    
                                    [
                                    ν
                                    −
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          K
                                          )
                                          /
                                          2
                                       
                                    
                                    ⌈
                                    
                                       q
                                       2
                                    
                                    ⌉
                                    ,
                                    
                                    ν
                                    +
                                    
                                       
                                          ν
                                       
                                       
                                          ˜
                                       
                                    
                                    +
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          K
                                          )
                                          /
                                          2
                                       
                                    
                                    ⌈
                                    
                                       q
                                       2
                                    
                                    ⌉
                                    ]
                                    .
                                 
                              
                            See Fig. 5
                            for a sketch. Assume without loss of generality that 
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                            is on the left side of K, this is,
                              
                                 (10)
                                 
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    ≤
                                    μ
                                    −
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          K
                                          )
                                          /
                                          2
                                       
                                    
                                    ⌊
                                    
                                       p
                                       2
                                    
                                    ⌋
                                    .
                                 
                              
                            If 
                              type
                              (
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                              )
                              =
                              ⊢
                           , then the edge-extension 
                              
                                 
                                    ext
                                 
                                 
                                    e
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                              )
                            points towards K in the sense that
                              
                                 
                                    ∀
                                    
                                    (
                                    x
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    ∈
                                    
                                       
                                          ext
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    :
                                    
                                    x
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    ≤
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          K
                                          )
                                          /
                                          2
                                       
                                    
                                    ⌊
                                    
                                       p
                                       2
                                    
                                    ⌋
                                    
                                       ≤
                                       
                                          (10)
                                       
                                    
                                    μ
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    
                                    ⇔
                                    
                                    ∀
                                    
                                    (
                                    x
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    ∈
                                    
                                       
                                          ext
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    :
                                    
                                    x
                                    ≤
                                    μ
                                    <
                                    μ
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          ˜
                                       
                                    
                                    /
                                    2
                                    .
                                 
                              
                            This means that 
                              
                                 
                                    ext
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                              )
                            does not intersect 
                              
                                 
                                    ext
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              T
                              )
                           . See Fig. 6
                            for an illustration.

If 
                              type
                              (
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                              )
                              =
                              ⊣
                           , then there is an odd-level element 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                            on the right side of 
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                           , and two finer even-level elements on the left side. Since there are no elements in 
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                              
                            with a level higher than 
                              ℓ
                              (
                              K
                              )
                              +
                              1
                           , which is odd, the two elements on the left side of 
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                            have at most level 
                              ℓ
                              (
                              K
                              )
                           , and hence 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              )
                              ≤
                              ℓ
                              (
                              K
                              )
                              −
                              1
                           . Consequently, 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∉
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                           , and the length of the intersection of the face extension 
                              
                                 
                                    ext
                                 
                                 
                                    f
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                              )
                            with the 
                              (
                              p
                              ,
                              q
                              )
                           -patch of K is at most 
                              
                                 
                                    2
                                 
                                 
                                    −
                                    ℓ
                                    (
                                    K
                                    )
                                    /
                                    2
                                 
                              
                              (
                              ⌈
                              
                                 p
                                 2
                              
                              ⌉
                              −
                              1
                              )
                              ≤
                              
                                 
                                    2
                                 
                                 
                                    −
                                    ℓ
                                    (
                                    K
                                    )
                                    /
                                    2
                                 
                              
                              ⌊
                              
                                 p
                                 2
                              
                              ⌋
                           . This leads to the same result as the previous case and is illustrated in Fig. 6. Since 
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                            was chosen arbitrary, 
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                              
                            is analysis-suitable. This concludes the proof.  □


                     
                        Corollary 3.7
                        
                           All admissible meshes provide T-spline blending functions that are non-negative, linearly independent, and form a partition of unity (
                           
                              da Veiga et al., 2013, 2014
                           
                           ). Moreover, on each element 
                           
                              K
                              ∈
                              G
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                           
                           , there are not more than 
                           
                              2
                              (
                              p
                              +
                              1
                              )
                              (
                              q
                              +
                              1
                              )
                            
                           T-spline basis functions that have support on K (
                           
                              da Veiga et al., 2014, Proposition 7.6
                           
                           ).
                        

This means that on each element, each T-Spline function communicates only with a finite number of other T-spline functions, independent of the total number of functions. This is an important requirement for sparsity of the linear system to be solved in Finite Element Analysis, in the sense that every row and every column of a corresponding stiffness or mass matrix is a sparse vector.

This section discusses the coarsest common refinement of two meshes 
                        
                           
                              G
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              G
                           
                           
                              2
                           
                        
                        ∈
                        
                           
                              A
                           
                           
                              p
                              ,
                              q
                           
                        
                     , called overlay and denoted by 
                        
                           
                              G
                           
                           
                              1
                           
                        
                        ⊗
                        
                           
                              G
                           
                           
                              2
                           
                        
                     . We prove that the overlay of two admissible meshes is also admissible and has bounded cardinality in terms of the involved meshes. This is a classical result in the context of adaptive simplicial meshes and will be crucial for further analysis of adaptive algorithms (cf. Assumption (2.10) from Carstensen et al., 2014).


                     
                        Definition 4.1
                        Overlay


                        We define the operator 
                              
                                 
                                    Min
                                 
                                 
                                    ⊆
                                 
                              
                            which yields all minimal elements of a set that is partially ordered by “⊆”,
                              
                                 
                                    
                                       
                                          Min
                                       
                                       
                                          ⊆
                                       
                                    
                                    (
                                    M
                                    )
                                    :
                                    =
                                    {
                                    K
                                    ∈
                                    M
                                    |
                                    ∀
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    M
                                    :
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ⊆
                                    K
                                    ⇒
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    K
                                    }
                                    .
                                 
                              
                            The overlay of 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            is defined by
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          Min
                                       
                                       
                                          ⊆
                                       
                                    
                                    (
                                    
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    
                                    )
                                    .
                                 
                              
                           
                        


                     
                        Proposition 4.2
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            
                           is the coarsest refinement of 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                            
                           and 
                           
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            
                           in the sense that for any 
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                            
                           being a refinement of 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                            
                           and 
                           
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                           
                           , and 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            
                           being a refinement of 
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           , it follows that 
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                           
                           .
                        


                     
                        Proof
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                            is a refinement of 
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            if and only if for each 
                              
                                 
                                    K
                                 
                                 
                                    1
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           , there is 
                              
                                 
                                    K
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            with 
                              
                                 
                                    K
                                 
                                 
                                    1
                                 
                              
                              ⊆
                              
                                 
                                    K
                                 
                                 
                                    2
                                 
                              
                           , which is equivalent to 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                           . Given that 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                            and 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              =
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           , we have
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                    =
                                    
                                       
                                          Min
                                       
                                       
                                          ⊆
                                       
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    ∪
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          Min
                                       
                                       
                                          ⊆
                                       
                                    
                                    (
                                    
                                       
                                          Min
                                       
                                       
                                          ⊆
                                       
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    ∪
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          Min
                                       
                                       
                                          ⊆
                                       
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    ∪
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          Min
                                       
                                       
                                          ⊆
                                       
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          Min
                                       
                                       
                                          ⊆
                                       
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    ∪
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    )
                                    =
                                    
                                       
                                          Min
                                       
                                       
                                          ⊆
                                       
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          Min
                                       
                                       
                                          ⊆
                                       
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                    =
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                    .
                                 
                              
                             □


                     
                        Proposition 4.3
                        
                           For any admissible meshes 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                           
                           , the overlay 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            
                           is also admissible.
                        


                     
                        Proof
                        Consider the set of admissible elements which are coarser than elements of the overlay,
                              
                                 
                                    M
                                    :
                                    =
                                    {
                                    K
                                    ∈
                                    ⋃
                                    
                                    
                                       
                                          A
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    |
                                    ∃
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    :
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ⫋
                                    K
                                    }
                                    .
                                 
                              
                            Then 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            is the coarsest partition of 
                              
                                 Ω
                                 ¯
                              
                            into elements from 
                              ⋃
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            that refines all elements occurring in 
                              M
                           . Note also that 
                              M
                            satisfies
                              
                                 (11)
                                 
                                    ∀
                                    
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    ⋃
                                    
                                       
                                          A
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    :
                                    
                                    K
                                    ∈
                                    M
                                    ∧
                                    K
                                    ⊆
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ⇒
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    M
                                    .
                                 
                              
                            For 
                              j
                              =
                              0
                              ,
                              …
                              ,
                              J
                              =
                              max
                              ⁡
                              ℓ
                              (
                              M
                              )
                            and 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              :
                              =
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                           , set
                              
                                 (12)
                                 
                                    
                                       
                                          M
                                       
                                       
                                          j
                                       
                                    
                                    :
                                    =
                                    {
                                    K
                                    ∈
                                    M
                                    |
                                    ℓ
                                    (
                                    K
                                    )
                                    =
                                    j
                                    }
                                    
                                    and
                                    
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    :
                                    =
                                    bisect
                                    (
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        


                           
                              Claim 1
                              
                                 For all 
                                 
                                    j
                                    ∈
                                    {
                                    0
                                    ,
                                    …
                                    ,
                                    J
                                    }
                                  
                                 holds 
                                 
                                    
                                       
                                          M
                                       
                                       
                                          j
                                       
                                    
                                    ⊆
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                 
                                 .
                              

This is shown by induction over j. For 
                              j
                              =
                              0
                           , the claim is true because all admissible elements with zero level are in 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                           . Assume the claim to be true for 
                              0
                              ,
                              …
                              ,
                              j
                              −
                              1
                            and assume for contradiction that there exists 
                              K
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    j
                                 
                              
                              ∖
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                           .

Since K has not been bisected yet, 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                            does not contain any 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                            with 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ⊂
                              K
                           . Consequently, there exists 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                            with 
                              K
                              ⊂
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                            and hence 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              )
                              <
                              ℓ
                              (
                              K
                              )
                              =
                              j
                           . From (11) follows 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    ℓ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              
                              ∈
                              M
                           , and 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              )
                              <
                              j
                            implies that 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                            has been refined in a previous step. This yields 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∉
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                           , which is the desired contradiction.


                           
                              Claim 2
                              
                                 For all 
                                 
                                    j
                                    ∈
                                    {
                                    0
                                    ,
                                    …
                                    ,
                                    J
                                    }
                                 
                                 , the bisection 
                                 (12) 
                                 is admissible.
                              

Consider 
                              K
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    j
                                 
                              
                            for an arbitrary j. By definition of 
                              M
                           , there exists 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              ⊆
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ∪
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            with 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ⫋
                              K
                           . Without loss of generality, we assume 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           . Since 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                           , there is a sequence of admissible meshes 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    G
                                 
                                 
                                    1
                                    |
                                    0
                                 
                              
                              ,
                              
                                 
                                    G
                                 
                                 
                                    1
                                    |
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    G
                                 
                                 
                                    1
                                    |
                                    I
                                 
                              
                              =
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                            and 
                              i
                              ∈
                              {
                              0
                              ,
                              …
                              ,
                              I
                              −
                              1
                              }
                            such that 
                              
                                 
                                    G
                                 
                                 
                                    1
                                    |
                                    i
                                    +
                                    1
                                 
                              
                              =
                              bisect
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                    |
                                    i
                                 
                              
                              ,
                              {
                              K
                              }
                              )
                           . The fact that 
                              
                                 
                                    G
                                 
                                 
                                    1
                                    |
                                    i
                                    +
                                    1
                                 
                              
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            (and that levels do not decrease during refinement) implies
                              
                                 (13)
                                 
                                    min
                                    ⁡
                                    ℓ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    K
                                    )
                                    )
                                    ≥
                                    min
                                    ⁡
                                    ℓ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                          |
                                          i
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    K
                                    )
                                    )
                                    ≥
                                    ℓ
                                    (
                                    K
                                    )
                                    =
                                    j
                                    .
                                 
                              
                            Assume for contradiction that there is 
                              
                                 
                                    K
                                 
                                 
                                    ˜
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                            with 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ˜
                                 
                              
                              )
                              <
                              ℓ
                              (
                              K
                              )
                              =
                              j
                           . This implies 
                              
                                 
                                    K
                                 
                                 
                                    ˜
                                 
                              
                              ∉
                              M
                            (otherwise 
                              
                                 
                                    K
                                 
                                 
                                    ˜
                                 
                              
                            would have been bisected in a previous step). Moreover, (13) and Corollary 2.15 yield that there is 
                              
                                 
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                            with 
                              
                                 
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              ⊂
                              
                                 
                                    K
                                 
                                 
                                    ˜
                                 
                              
                            and hence 
                              
                                 
                                    K
                                 
                                 
                                    ˜
                                 
                              
                              ∈
                              M
                            in contradiction to 
                              
                                 
                                    K
                                 
                                 
                                    ˜
                                 
                              
                              ∉
                              M
                            from before. This proves Claim 2.

The proven claims show 
                              
                                 
                                    M
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                              ∖
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                            for all 
                              j
                              =
                              0
                              ,
                              …
                              ,
                              J
                            and hence for the admissible mesh 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    J
                                    +
                                    1
                                 
                              
                            that there is no coarser partition of 
                              
                                 Ω
                                 ¯
                              
                            into elements from 
                              ⋃
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            that refines all elements in 
                              M
                           . This property defines a unique partition and hence
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          J
                                          +
                                          1
                                       
                                    
                                    ∈
                                    
                                       
                                          A
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    .
                                 
                              
                             □


                     
                        Lemma 4.4
                        
                           For all 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            
                           holds
                           
                              
                                 
                                    #
                                    
                                       (
                                       
                                          
                                             G
                                          
                                          
                                             1
                                          
                                       
                                       ⊗
                                       
                                          
                                             G
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    #
                                    
                                       
                                          G
                                       
                                       
                                          0
                                       
                                    
                                    ≤
                                    #
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    #
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    
                                    .
                                 
                              
                           
                        

By definition, the overlay is a subset of the union of the two involved meshes, i.e.,
                              
                                 (14)
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    
                                    =
                                    
                                    
                                       
                                          Min
                                       
                                       
                                          ⊆
                                       
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    
                                    ⊆
                                    
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    
                                    .
                                 
                              
                            Define the shorthand notation 
                              G
                              (
                              K
                              )
                              :
                              =
                              {
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              G
                              |
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ⊆
                              K
                              }
                           . To prove the lemma, it suffices to show
                              
                                 
                                    ∀
                                    
                                    K
                                    ∈
                                    
                                       
                                          G
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                    #
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    (
                                    K
                                    )
                                    +
                                    1
                                    ≤
                                    #
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    K
                                    )
                                    +
                                    #
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    K
                                    )
                                    
                                    .
                                 
                              
                            
                           Case 1. 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              (
                              K
                              )
                              ⊆
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                              (
                              K
                              )
                           . This implies equality and hence
                              
                                 
                                    #
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    (
                                    K
                                    )
                                    +
                                    1
                                    =
                                    #
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    K
                                    )
                                    +
                                    1
                                    ≤
                                    #
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    K
                                    )
                                    +
                                    #
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    K
                                    )
                                    
                                    .
                                 
                              
                            
                           Case 2. There exists 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              (
                              K
                              )
                              ∖
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                              (
                              K
                              )
                           . Then 
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                              (
                              K
                              )
                              =
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⊗
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                              (
                              K
                              )
                              ∖
                              {
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              }
                            and hence
                              
                                 
                                    #
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    (
                                    K
                                    )
                                    
                                    =
                                    
                                    #
                                    
                                       (
                                       (
                                       
                                          
                                             G
                                          
                                          
                                             1
                                          
                                       
                                       ⊗
                                       
                                          
                                             G
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       (
                                       K
                                       )
                                       ∖
                                       {
                                       
                                          
                                             K
                                          
                                          
                                             ′
                                          
                                       
                                       }
                                       )
                                    
                                    
                                    
                                       ≤
                                       
                                          (14)
                                       
                                    
                                    
                                    #
                                    
                                       (
                                       (
                                       
                                          
                                             G
                                          
                                          
                                             1
                                          
                                       
                                       ∪
                                       
                                          
                                             G
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       (
                                       K
                                       )
                                       ∖
                                       {
                                       
                                          
                                             K
                                          
                                          
                                             ′
                                          
                                       
                                       }
                                       )
                                    
                                    ≤
                                    
                                    #
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ∖
                                    {
                                    K
                                    }
                                    )
                                    +
                                    #
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    K
                                    )
                                    
                                    =
                                    
                                    #
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    K
                                    )
                                    −
                                    1
                                    +
                                    #
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    K
                                    )
                                    .
                                 
                              
                             □

This section investigates the nesting behavior of the T-spline spaces corresponding to admissible meshes. In order to prove that nested admissible meshes induce nested spline spaces, we make use of Theorem 6.1 from Li and Scott (2014). Before presenting the theorem, we briefly introduce necessary notations.


                     
                        Definition 5.1
                        Refinement relation


                        For any partitions 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            of 
                              
                                 Ω
                                 ¯
                              
                           , we introduce the refinement relation “⪯”, which is defined using the overlay (see Section 4),
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⪯
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    
                                    ⇔
                                    
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⊗
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        


                     
                        Corollary 5.2
                        
                           Denote the skeleton of a mesh 
                           
                              G
                            
                           by 
                           
                              
                                 Sk
                              
                              (
                              G
                              )
                              :
                              =
                              
                                 hSk
                              
                              (
                              G
                              )
                              ∪
                              
                                 vSk
                              
                              (
                              G
                              )
                           
                           . Then for rectangular partitions 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                           , 
                           
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            
                           of 
                           
                              
                                 Ω
                                 ¯
                              
                            
                           holds the equivalence
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ⪯
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    
                                    ⇔
                                    
                                    
                                       Sk
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ⊆
                                    
                                       Sk
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        


                     
                        Definition 5.3
                        Extended mesh


                        Given a rectangular partition 
                              G
                            of 
                              
                                 Ω
                                 ¯
                              
                           , denote by 
                              
                                 
                                    ext
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              G
                              )
                            the union of all T-junction extensions in the mesh 
                              G
                           . Then the extended mesh 
                           
                              
                                 
                                    G
                                 
                                 
                                    ext
                                 
                              
                            is defined as the unique rectangular partition of 
                              
                                 Ω
                                 ¯
                              
                            such that
                              
                                 
                                    
                                       Sk
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          ext
                                       
                                    
                                    )
                                    =
                                    
                                       Sk
                                    
                                    (
                                    G
                                    )
                                    ∪
                                    
                                       
                                          ext
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    G
                                    )
                                    .
                                 
                              
                           
                        


                     
                        Definition 5.4
                        Mesh perturbation


                        Given a partition 
                              G
                            of 
                              
                                 Ω
                                 ¯
                              
                            into axis-aligned rectangles, we define by 
                              Ptb
                              (
                              G
                              )
                            the set of all continuous and invertible mappings 
                              δ
                              :
                              
                                 Ω
                                 ¯
                              
                              →
                              
                                 Ω
                                 ¯
                              
                            such that the corners 
                              (
                              0
                              ,
                              0
                              )
                           , 
                              (
                              M
                              ,
                              0
                              )
                           , 
                              (
                              M
                              ,
                              N
                              )
                           , 
                              (
                              0
                              ,
                              N
                              )
                            are fixed points of δ and
                              
                                 
                                    δ
                                    (
                                    G
                                    )
                                    =
                                    {
                                    δ
                                    (
                                    K
                                    )
                                    |
                                    K
                                    ∈
                                    G
                                    }
                                 
                              
                            is also a partition of 
                              
                                 Ω
                                 ¯
                              
                            into axis-aligned rectangles.

This definition differs from the definition of perturbations given in Li and Scott (2014), which we found difficult to reproduce in a formal manner. The subsequent Proposition 5.5 shows that our definition includes the understanding of perturbations from Li and Scott (2014).


                     
                        Remark
                        For 
                              δ
                              ∈
                              Ptb
                              (
                              G
                              )
                           , the perturbed mesh 
                              δ
                              (
                              G
                              )
                            has the skeleton 
                              
                                 Sk
                              
                              (
                              δ
                              (
                              G
                              )
                              )
                              =
                              δ
                              (
                              
                                 Sk
                              
                              (
                              G
                              )
                              )
                           . Hence, global index vectors can be defined according to Definition 3.3, and since all T-junctions in 
                              δ
                              (
                              G
                              )
                            are of axis-parallel types (
                              ⊢
                              ,
                              ⊥
                              ,
                              ⊣
                           , or ⊤), we can also apply Definition 3.4 for T-junction extensions in the perturbed mesh. Note in particular that the perturbation δ does not in general map T-junction extensions to the corresponding extensions in the perturbed mesh, i.e., if T is a T-junction in 
                              G
                           , then
                              
                                 
                                    
                                       
                                          ext
                                       
                                       
                                          δ
                                          (
                                          G
                                          )
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    δ
                                    (
                                    T
                                    )
                                    )
                                    
                                    ≠
                                    
                                    δ
                                    (
                                    
                                       
                                          ext
                                       
                                       
                                          G
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    T
                                    )
                                    )
                                    .
                                 
                              
                           
                        


                     
                        Proposition 5.5
                        
                           For any rectangular partition 
                           
                              G
                            
                           of 
                           
                              
                                 Ω
                                 ¯
                              
                           
                           , there is some 
                           
                              
                                 
                                    δ
                                 
                                 
                                    ⁎
                                 
                              
                              ∈
                              Ptb
                              (
                              G
                              )
                            
                           such that any two T-junction face extensions in 
                           
                              
                                 
                                    δ
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              G
                              )
                            
                           are disjoint.
                        

In the context of Li and Scott (2014), this means that 
                        
                           
                              δ
                           
                           
                              ⁎
                           
                        
                        (
                        G
                        )
                      has no crossing vertices and no overlap vertices.


                     
                        Proof
                        If all T-junction extensions in 
                              G
                            are pairwise disjoint, then 
                              
                                 
                                    δ
                                 
                                 
                                    ⁎
                                 
                              
                            is the identity map. If there exist T-junctions 
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                            in 
                              G
                            with intersecting face extensions, then 
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                            are either both vertical or both horizontal T-junctions. Assume w.l.o.g. that 
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                            are vertical T-junctions. Since their (vertical) face extensions overlap, both T-junctions have the same x-coordinate 
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                           . Let 
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              =
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                            and 
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                              =
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                           , and assume 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              <
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                           . There exists 
                              
                                 
                                    t
                                 
                                 
                                    1.5
                                 
                              
                            with 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ≤
                              
                                 
                                    t
                                 
                                 
                                    1.5
                                 
                              
                              ≤
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                            such that at least one of the open segments 
                              {
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              }
                              ×
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1.5
                                 
                              
                              )
                            and 
                              {
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              }
                              ×
                              (
                              
                                 
                                    t
                                 
                                 
                                    1.5
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                            does not intersect with the vertical skeleton 
                              
                                 vSk
                              
                              (
                              G
                              )
                           . Assume that 
                              {
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              }
                              ×
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1.5
                                 
                              
                              )
                              ∩
                              
                                 vSk
                              
                              (
                              G
                              )
                              =
                              ∅
                            and define
                              
                                 
                                    
                                       
                                          
                                             Ω
                                             ¯
                                          
                                       
                                       
                                          x
                                          =
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    :
                                    =
                                    
                                       {
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ∈
                                       
                                          Ω
                                          ¯
                                       
                                       |
                                       x
                                       =
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       }
                                    
                                    
                                    and
                                    
                                    
                                    
                                       
                                          G
                                       
                                       
                                          x
                                          =
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    :
                                    =
                                    
                                       {
                                       K
                                       ∈
                                       G
                                       |
                                       K
                                       ∩
                                       
                                          
                                             
                                                Ω
                                                ¯
                                             
                                          
                                          
                                             x
                                             =
                                             
                                                
                                                   t
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       ≠
                                       ∅
                                       }
                                    
                                    .
                                 
                              
                            Let h be the length of the shortest edge in 
                              G
                           , and set 
                              ε
                              :
                              =
                              h
                              /
                              2
                           . We define 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          T
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            by
                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                T
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             
                                                if 
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                ∈
                                                ⋃
                                                (
                                                G
                                                ∖
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      x
                                                      =
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                (
                                                x
                                                −
                                                ε
                                                ,
                                                y
                                                )
                                             
                                             
                                                if 
                                                x
                                                =
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                                 and 
                                                y
                                                <
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                x
                                                +
                                                ε
                                                ,
                                                y
                                                )
                                             
                                             
                                                if 
                                                x
                                                =
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                                 and 
                                                y
                                                >
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1.5
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                x
                                                +
                                                
                                                   
                                                      ε
                                                      
                                                      (
                                                      2
                                                      y
                                                      −
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            1.5
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            1.5
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ,
                                                y
                                                )
                                             
                                             
                                                if 
                                                x
                                                =
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                                 and 
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ≤
                                                y
                                                ≤
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1.5
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            and elsewhere by horizontal linear interpolation, which is illustrated in Fig. 7
                           . The map 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          T
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            then satisfies the following properties.
                              
                                 1.
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   T
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                     is in 
                                       Ptb
                                       (
                                       G
                                       )
                                    .

The T-junction extensions of 
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   T
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             1
                                          
                                       
                                       )
                                     and 
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   T
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             2
                                          
                                       
                                       )
                                     do not intersect.


                                    
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   T
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                     does not lead to intersecting of T-junction extensions that did not intersect in the unperturbed mesh 
                                       G
                                    .


                     
                        Theorem 5.6
                        
                           (See 
                           
                              Li and Scott, 2014
                           
                           , Theorem 6.1.) Given two analysis-suitable meshes 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                            
                           and 
                           
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                           
                           , if for all 
                           
                              δ
                              ∈
                              Ptb
                              (
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                            
                           holds
                           
                              
                                 
                                    
                                       
                                          (
                                          δ
                                          (
                                          
                                             
                                                G
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                       
                                       
                                          ext
                                       
                                    
                                    ⪯
                                    
                                       
                                          (
                                          δ
                                          (
                                          
                                             
                                                G
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          )
                                       
                                       
                                          ext
                                       
                                    
                                    ,
                                 
                              
                            
                           then the T-spline spaces corresponding to 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                            
                           and 
                           
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            
                           are nested.
                        

The main result of this section is the following.


                     
                        Theorem 5.7
                        
                           Any two meshes 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            
                           that are nested in the sense 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⪯
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            
                           satisfy for all 
                           
                              δ
                              ∈
                              Ptb
                              (
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           
                              
                                 
                                    
                                       
                                          (
                                          δ
                                          (
                                          
                                             
                                                G
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                       
                                       
                                          ext
                                       
                                    
                                    ⪯
                                    
                                       
                                          (
                                          δ
                                          (
                                          
                                             
                                                G
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          )
                                       
                                       
                                          ext
                                       
                                    
                                    .
                                 
                              
                           
                        


                     
                        Proof
                        According to Corollary 5.2, we have to show that
                              
                                 
                                    
                                       
                                          ext
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                    ∪
                                    
                                       Sk
                                    
                                    (
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                    
                                    ⊆
                                    
                                    
                                       
                                          ext
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    ∪
                                    
                                       Sk
                                    
                                    (
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    .
                                 
                              
                            We prove this for 
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            being an admissible bisection of 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           . The claim then follows inductively for all admissible refinements of 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           . Let 
                              K
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            and 
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              :
                              =
                              bisect
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ,
                              K
                              )
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                           . Since “⪯” denotes an elementwise subset relation, it is preserved under the mapping δ. Thus, from 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⪯
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            follows 
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              )
                              ⪯
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                            and consequently 
                              
                                 Sk
                              
                              (
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              )
                              )
                              ⊆
                              
                                 Sk
                              
                              (
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                              )
                           . It remains to prove that
                              
                                 
                                    
                                       
                                          ext
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                    
                                    ⊆
                                    
                                    
                                       
                                          ext
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    ∪
                                    
                                       Sk
                                    
                                    (
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    .
                                 
                              
                            Denote by 
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                            the set of T-junctions in 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                           , respectively. Assume w.l.o.g. that 
                              ℓ
                              (
                              K
                              )
                            is even, and consider an arbitrary T-junction 
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                            in the mesh 
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              )
                           . Since δ is continuous and invertible, there is a one-to-one correspondence between the T-junctions in 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                            and 
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              )
                           , i.e., there is 
                              T
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                            with 
                              δ
                              (
                              T
                              )
                              =
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                           , and T and 
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                            are of the same type (⊢, ⊥, ⊣, or ⊤).


                           Case 1. 
                           
                              T
                              ∉
                              K
                           . Then T is still a T-junction after bisecting K, i.e., 
                              T
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                           . Consequently, 
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                            is also a T-junction in 
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                           .


                           Case 1a. T is a vertical T-junction. Since 
                              ℓ
                              (
                              K
                              )
                            is assumed to be even, its bisection does not affect the horizontal skeleton, i.e., 
                              
                                 hSk
                              
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              
                                 hSk
                              
                              (
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                            and hence 
                              
                                 hSk
                              
                              (
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              )
                              )
                              =
                              
                                 hSk
                              
                              (
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                              )
                           . Consequently, the T-junction extensions of T and 
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                            are preserved,
                              
                                 
                                    
                                       
                                          ext
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    T
                                    )
                                    =
                                    
                                       
                                          ext
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    T
                                    )
                                    
                                    and
                                    
                                    
                                       
                                          ext
                                       
                                       
                                          δ
                                          (
                                          
                                             
                                                G
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          δ
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          ext
                                       
                                       
                                          δ
                                          (
                                          
                                             
                                                G
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          δ
                                       
                                    
                                    )
                                    ⊆
                                    
                                       
                                          ext
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    .
                                 
                              
                           
                        


                           Case 1b. T is a horizontal T-junction. We will show that the corresponding T-junction extension in the perturbed mesh is preserved, i.e.,
                              
                                 
                                    
                                       
                                          ext
                                       
                                       
                                          δ
                                          (
                                          
                                             
                                                G
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          δ
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          ext
                                       
                                       
                                          δ
                                          (
                                          
                                             
                                                G
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          δ
                                       
                                    
                                    )
                                    .
                                 
                              
                            Assume for contradiction that 
                              
                                 
                                    ext
                                 
                                 
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                              )
                              ≠
                              
                                 
                                    ext
                                 
                                 
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                              )
                           . The bisection of K generates a vertical edge 
                              
                                 
                                    E
                                 
                                 
                                    K
                                 
                              
                              ⊇
                              
                                 vSk
                              
                              (
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                              ∖
                              
                                 vSk
                              
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              )
                           , and we denote
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          K
                                       
                                       
                                          δ
                                       
                                    
                                    :
                                    =
                                    δ
                                    (
                                    
                                       
                                          E
                                       
                                       
                                          K
                                       
                                    
                                    )
                                    ⊇
                                    
                                       vSk
                                    
                                    (
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    ∖
                                    
                                       vSk
                                    
                                    (
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                    .
                                 
                              
                            Obviously, 
                              
                                 
                                    E
                                 
                                 
                                    K
                                 
                                 
                                    δ
                                 
                              
                            intersects with 
                              
                                 
                                    ext
                                 
                                 
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                              )
                           , otherwise the T-junction extension would be the same in 
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                           . Given 
                              K
                              =
                              [
                              μ
                              ,
                              μ
                              +
                              
                                 
                                    μ
                                 
                                 
                                    ˜
                                 
                              
                              ]
                              ×
                              [
                              ν
                              ,
                              ν
                              +
                              
                                 
                                    ν
                                 
                                 
                                    ˜
                                 
                              
                              ]
                           , we define the half-open domain 
                              
                                 
                                    K
                                 
                                 
                                    ho
                                 
                              
                              :
                              =
                              
                                 ]
                                 μ
                                 ,
                                 μ
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       ˜
                                    
                                 
                                 [
                              
                              ×
                              [
                              ν
                              ,
                              ν
                              +
                              
                                 
                                    ν
                                 
                                 
                                    ˜
                                 
                              
                              ]
                           , which is the rectangle K without its vertical edges. Then 
                              
                                 
                                    E
                                 
                                 
                                    K
                                 
                              
                              ⊂
                              
                                 
                                    K
                                 
                                 
                                    ho
                                 
                              
                            and hence 
                              
                                 
                                    E
                                 
                                 
                                    K
                                 
                                 
                                    δ
                                 
                              
                              ⊂
                              
                                 
                                    K
                                 
                                 
                                    ho
                                 
                                 
                                    δ
                                 
                              
                              :
                              =
                              δ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ho
                                 
                              
                              )
                           . Together, we have that 
                              
                                 
                                    ext
                                 
                                 
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                              )
                            intersects with 
                              
                                 
                                    K
                                 
                                 
                                    ho
                                 
                                 
                                    δ
                                 
                              
                           . Since the bisection of K is admissible, we know from the proof of Theorem 3.6 that 
                              
                                 
                                    ext
                                 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              T
                              )
                            does not intersect with 
                              
                                 
                                    K
                                 
                                 
                                    ho
                                 
                              
                            in the unperturbed mesh 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           . Define the T-environment
                              
                                 
                                    
                                       
                                          
                                          U
                                       
                                       ¯
                                    
                                    (
                                    T
                                    )
                                    :
                                    =
                                    
                                       ⋃
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         ho
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ∩
                                                   
                                                      
                                                         ext
                                                      
                                                      
                                                         p
                                                         ,
                                                         q
                                                      
                                                   
                                                   (
                                                   T
                                                   )
                                                   ≠
                                                   ∅
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                 
                              
                            as the union of all 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                            such that 
                              
                                 
                                    ext
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              T
                              )
                            intersects the corresponding half-open 
                              
                                 
                                    K
                                 
                                 
                                    ho
                                 
                                 
                                    ′
                                 
                              
                           . Then 
                              
                                 
                                    
                                    U
                                 
                                 ¯
                              
                              (
                              T
                              )
                            is a rectangular domain that does not intersect with 
                              
                                 
                                    K
                                 
                                 
                                    ho
                                 
                              
                           . Since for each 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ⊆
                              
                                 
                                    
                                    U
                                 
                                 ¯
                              
                              (
                              T
                              )
                           , the image 
                              δ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              )
                            is a rectangle and since δ is continuous, 
                              δ
                              (
                              
                                 
                                    
                                    U
                                 
                                 ¯
                              
                              (
                              T
                              )
                              )
                            is a rectangular domain that does not intersect with 
                              
                                 
                                    K
                                 
                                 
                                    ho
                                 
                                 
                                    δ
                                 
                              
                           . Moreover, since all edges and vertices in 
                              
                                 
                                    
                                    U
                                 
                                 ¯
                              
                              (
                              T
                              )
                            are continuously mapped into 
                              δ
                              (
                              
                                 
                                    
                                    U
                                 
                                 ¯
                              
                              (
                              T
                              )
                              )
                           , we have 
                              
                                 
                                    
                                    U
                                 
                                 ¯
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                              )
                              ⊆
                              δ
                              (
                              
                                 
                                    
                                    U
                                 
                                 ¯
                              
                              (
                              T
                              )
                              )
                           . Together, we get that 
                              
                                 
                                    
                                    U
                                 
                                 ¯
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                              )
                            does not intersect with 
                              
                                 
                                    K
                                 
                                 
                                    ho
                                 
                                 
                                    δ
                                 
                              
                           , hence 
                              
                                 
                                    ext
                                 
                                 
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                              )
                            does not intersect with 
                              
                                 
                                    K
                                 
                                 
                                    ho
                                 
                                 
                                    δ
                                 
                              
                           , which is the desired contradiction.


                           Case 2. 
                           
                              T
                              ∈
                              K
                           . In Section 2, we assumed that 
                              p
                              ,
                              q
                              ≥
                              2
                           . This implies that all neighbors of K are in 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              K
                              )
                            and that K is in the patch of all those neighbors as well. Since 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                            is admissible, the level of a neighbor of K is either 
                              ℓ
                              (
                              K
                              )
                            or 
                              ℓ
                              (
                              K
                              )
                              +
                              1
                           . Since 
                              ℓ
                              (
                              K
                              )
                            is even, T must be a vertical T-junction, and 
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                            is a vertical T-junction as well. Since T is on the boundary of K, and the bisection of K generates a vertical edge, T is not a T-junction anymore in 
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                           . Hence 
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                            is a vertex, but not a T-junction in 
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                           . The T-junction extension 
                              
                                 
                                    ext
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                              )
                            hence only exists in 
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              )
                           . Consider the edge extension of 
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                           .


                           Case 2a. 
                           
                              
                                 
                                    ext
                                 
                                 
                                    e
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                              )
                              ⊆
                              
                                 vSk
                              
                              (
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                              )
                           . There is no problem with that.


                           Case 2b. 
                           
                              
                                 
                                    ext
                                 
                                 
                                    e
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                              )
                              ⊈
                              
                                 vSk
                              
                              (
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                              )
                           . Then there exists some 
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    δ
                                 
                              
                              ∈
                              
                                 
                                    ext
                                 
                                 
                                    e
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                              )
                            which is a T-junction in 
                              δ
                              (
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              )
                           , such that
                              
                                 
                                    
                                       
                                          ext
                                       
                                       
                                          e
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          δ
                                       
                                    
                                    )
                                    ⊂
                                    
                                       
                                          ext
                                       
                                       
                                          δ
                                          (
                                          
                                             
                                                G
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          δ
                                       
                                    
                                    )
                                    ⊆
                                    
                                       
                                          ext
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    .
                                 
                              
                           
                        

Cases 2a and 2b hold analogously for the face extension 
                              
                                 
                                    ext
                                 
                                 
                                    f
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    δ
                                 
                              
                              )
                           . Together, we have
                              
                                 
                                    
                                       
                                          ext
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          δ
                                       
                                    
                                    )
                                    ⊆
                                    
                                       
                                          ext
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    ∪
                                    
                                       vSk
                                    
                                    (
                                    δ
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    ,
                                 
                              
                            which concludes the proof.  □

The combination of Theorems 5.6 and 5.7 reads as follows. 
                        Corollary 5.8
                        
                           For any two meshes 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            
                           that are nested in the sense 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ⪯
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                           
                           , the corresponding T-spline spaces are also nested.
                        

This section is devoted to a complexity estimate in the style of a famous estimate for the Newest Vertex Bisection on triangular meshes given by Binev et al. (2004) and, in an alternative version, by Stevenson (2007). The estimate reads as follows.


                     
                        Theorem 6.1
                        
                           Any sequence of admissible meshes 
                           
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                              
                            
                           with
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          ref
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          j
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          j
                                          −
                                          1
                                       
                                    
                                    )
                                    ,
                                    
                                    
                                       
                                          M
                                       
                                       
                                          j
                                          −
                                          1
                                       
                                    
                                    ⊆
                                    
                                       
                                          G
                                       
                                       
                                          j
                                          −
                                          1
                                       
                                    
                                    
                                    
                                       for
                                    
                                    
                                    j
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    J
                                    }
                                 
                              
                            
                           satisfies
                           
                              
                                 
                                    
                                       |
                                       
                                          
                                             G
                                          
                                          
                                             J
                                          
                                       
                                       ∖
                                       
                                          
                                             G
                                          
                                          
                                             0
                                          
                                       
                                       |
                                    
                                    
                                    ≤
                                    
                                    
                                       
                                          C
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          J
                                          −
                                          1
                                       
                                    
                                    |
                                    
                                       
                                          M
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    
                                    ,
                                 
                              
                            
                           with 
                           
                              
                                 
                                    C
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              =
                              (
                              3
                              +
                              
                                 2
                              
                              )
                              (
                              4
                              
                                 
                                    d
                                 
                                 
                                    p
                                 
                              
                              +
                              1
                              )
                              (
                              4
                              
                                 
                                    d
                                 
                                 
                                    q
                                 
                              
                              +
                              
                                 2
                              
                              )
                            
                           and 
                           
                              
                                 
                                    d
                                 
                                 
                                    p
                                 
                              
                           
                           , 
                           
                              
                                 
                                    d
                                 
                                 
                                    q
                                 
                              
                            
                           from 
                           
                              Lemma 6.4
                            
                           below.
                        


                           Theorem 6.1 shows that, with regard to possible mesh gradings, the refinement algorithm is as flexible as successive bisection without the closure step. However, this result is non-trivial. Given a mesh 
                              G
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            and an element 
                              K
                              ∈
                              G
                            to be bisected, there is no uniform bound on the number of generated elements 
                              #
                              (
                              
                                 
                                    ref
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              G
                              ,
                              {
                              K
                              }
                              )
                              ∖
                              G
                              )
                           . This is illustrated by the following example.

Consider the case 
                              p
                              =
                              q
                              =
                              2
                            and the initial mesh 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                            given through 
                              M
                              =
                              3
                            and 
                              N
                              =
                              4
                           . Mark the element in the lower left corner of the mesh and compute the corresponding refinement 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           ; repeat this step k times. Then there exists an element 
                              
                                 
                                    K
                                 
                                 
                                    k
                                 
                              
                            in 
                              
                                 
                                    G
                                 
                                 
                                    k
                                 
                              
                            such that 
                              #
                              (
                              
                                 
                                    ref
                                 
                                 
                                    1
                                    ,
                                    1
                                 
                              
                              (
                              
                                 
                                    G
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    K
                                 
                                 
                                    k
                                 
                              
                              )
                              ∖
                              
                                 
                                    G
                                 
                                 
                                    k
                                 
                              
                              )
                              ≥
                              k
                           . This is illustrated in Fig. 8
                           .


                     
                        Example 6.3
                        The large constant 
                              
                                 
                                    C
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            is not observed in practice. For 
                              p
                              =
                              q
                              =
                              3
                           , we constructed for each 
                              J
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              2000
                              }
                            a sequence 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                              
                            with 
                              
                                 
                                    G
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              =
                              bisect
                              (
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                              )
                            and 
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                            of uniform random choice. The ratio 
                              
                                 |
                                 
                                    
                                       G
                                    
                                    
                                       J
                                    
                                 
                                 |
                              
                              /
                              J
                            was below 6 (see Fig. 9
                           ), instead of the theoretical upper bound 
                              
                                 
                                    C
                                 
                                 
                                    3
                                    ,
                                    3
                                 
                              
                              ≈
                              6042
                            from Theorem 6.1. We applied this procedure for 
                              p
                              ,
                              q
                              =
                              2
                              ,
                              …
                              ,
                              9
                           . The results are listed in Fig. 10
                           . In Fig. 11
                           , we listed similar results for 
                              J
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              100
                              }
                           , always marking the element in the lower left corner. In that case, the observed ratios are higher, but still orders of magnitude below the corresponding theoretical bounds.

We devote the rest of this section to proving Theorem 6.1. 
                        Lemma 6.4
                        
                           Given 
                           
                              M
                              ⊆
                              G
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            
                           and 
                           
                              K
                              ∈
                              
                                 
                                    ref
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              G
                              ,
                              M
                              )
                              ∖
                              G
                           
                           , there exists 
                           
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              M
                            
                           such that 
                           
                              ℓ
                              (
                              K
                              )
                              ≤
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              )
                              +
                              1
                            
                           and
                           
                              
                                 
                                    Dist
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ≤
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          K
                                          )
                                          /
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          d
                                       
                                       
                                          q
                                       
                                    
                                    )
                                    ,
                                 
                              
                            
                           with “≤” understood componentwise and constants
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          p
                                       
                                    
                                    :
                                    =
                                    (
                                    1
                                    +
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                    )
                                    
                                    p
                                    +
                                    1
                                    +
                                    
                                       5
                                       4
                                    
                                    
                                       2
                                    
                                    ,
                                    
                                    
                                       
                                          d
                                       
                                       
                                          q
                                       
                                    
                                    :
                                    =
                                    (
                                    1
                                    +
                                    
                                       2
                                    
                                    )
                                    
                                    q
                                    +
                                    
                                       3
                                       2
                                    
                                    +
                                    
                                       2
                                    
                                    .
                                 
                              
                           
                        

The coefficient 
                              
                                 
                                    D
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              k
                              )
                            from Definition 2.4 is bounded by
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    (
                                    k
                                    )
                                    ≤
                                    (
                                    (
                                    p
                                    +
                                    
                                       2
                                    
                                    )
                                    
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                          −
                                          k
                                          /
                                          2
                                       
                                    
                                    ,
                                    
                                    (
                                    q
                                    +
                                    
                                       2
                                    
                                    )
                                    
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          k
                                          +
                                          1
                                          )
                                          /
                                          2
                                       
                                    
                                    )
                                    
                                    for all 
                                    k
                                    ∈
                                    N
                                    .
                                 
                              
                            Hence for 
                              
                                 
                                    K
                                 
                                 
                                    ˜
                                 
                              
                              ∈
                              G
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                           , any 
                              
                                 
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    K
                                 
                                 
                                    ˜
                                 
                              
                              )
                            satisfies
                              
                                 (15)
                                 
                                    Dist
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ≤
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                          /
                                          2
                                       
                                    
                                    
                                    (
                                    
                                       
                                          p
                                          +
                                          
                                             2
                                          
                                       
                                       2
                                    
                                    ,
                                    
                                    
                                       q
                                       
                                          2
                                       
                                    
                                    +
                                    1
                                    )
                                    .
                                 
                              
                            The existence of 
                              K
                              ∈
                              
                                 
                                    ref
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              G
                              ,
                              M
                              )
                              ∖
                              G
                            means that Algorithm 2.9 bisects 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    K
                                 
                                 
                                    J
                                 
                              
                              ,
                              
                                 
                                    K
                                 
                                 
                                    J
                                    −
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    K
                                 
                                 
                                    0
                                 
                              
                            such that 
                              
                                 
                                    K
                                 
                                 
                                    j
                                    −
                                    1
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                              (
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                              )
                            and 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    j
                                    −
                                    1
                                 
                              
                              )
                              <
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                              )
                            for 
                              j
                              =
                              J
                              ,
                              …
                              ,
                              1
                           , having 
                              
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              M
                            and 
                              K
                              ∈
                              child
                              (
                              
                                 
                                    K
                                 
                                 
                                    0
                                 
                              
                              )
                           , with ‘child’ from Definition 2.6. Lemma 2.14 yields 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    j
                                    −
                                    1
                                 
                              
                              )
                              =
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                              )
                              −
                              1
                            for 
                              j
                              =
                              J
                              ,
                              …
                              ,
                              1
                           , which allows for the estimate
                              
                                 
                                    Dist
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    
                                    ≤
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       J
                                    
                                    Dist
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          j
                                          −
                                          1
                                       
                                    
                                    )
                                    
                                    
                                       ≤
                                       
                                          (15)
                                       
                                    
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       J
                                    
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          /
                                          2
                                       
                                    
                                    
                                    (
                                    
                                       
                                          p
                                          +
                                          
                                             2
                                          
                                       
                                       2
                                    
                                    ,
                                    
                                    
                                       q
                                       
                                          2
                                       
                                    
                                    +
                                    1
                                    )
                                    =
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       J
                                    
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          +
                                          j
                                          )
                                          /
                                          2
                                       
                                    
                                    
                                    (
                                    
                                       
                                          p
                                          +
                                          
                                             2
                                          
                                       
                                       2
                                    
                                    ,
                                    
                                    
                                       q
                                       
                                          2
                                       
                                    
                                    +
                                    1
                                    )
                                    <
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          /
                                          2
                                       
                                    
                                    
                                    (
                                    
                                       
                                          p
                                          +
                                          
                                             2
                                          
                                       
                                       2
                                    
                                    ,
                                    
                                    
                                       q
                                       
                                          2
                                       
                                    
                                    +
                                    1
                                    )
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       ∞
                                    
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          j
                                          /
                                          2
                                       
                                    
                                    =
                                    (
                                    1
                                    +
                                    
                                       2
                                    
                                    )
                                    
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          /
                                          2
                                       
                                    
                                    
                                    (
                                    
                                       
                                          p
                                          +
                                          
                                             2
                                          
                                       
                                       2
                                    
                                    ,
                                    
                                    
                                       q
                                       
                                          2
                                       
                                    
                                    +
                                    1
                                    )
                                    =
                                    (
                                    2
                                    +
                                    
                                       2
                                    
                                    )
                                    
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          K
                                          )
                                          /
                                          2
                                       
                                    
                                    
                                    (
                                    
                                       
                                          p
                                          +
                                          
                                             2
                                          
                                       
                                       2
                                    
                                    ,
                                    
                                    
                                       q
                                       
                                          2
                                       
                                    
                                    +
                                    1
                                    )
                                    .
                                 
                              
                            The estimate 
                              Dist
                              (
                              
                                 
                                    K
                                 
                                 
                                    0
                                 
                              
                              ,
                              K
                              )
                              ≤
                              
                                 
                                    2
                                 
                                 
                                    −
                                    2
                                    −
                                    ℓ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    /
                                    2
                                 
                              
                              
                              (
                              1
                              ,
                              
                                 2
                              
                              )
                            and a triangle inequality conclude the proof.  □


                     
                        Proof of Theorem 6.1
                        
                           (1) For 
                              K
                              ∈
                              ⋃
                              
                                 
                                    A
                                 
                                 
                                    p
                                    ,
                                    q
                                 
                              
                            and 
                              
                                 
                                    K
                                 
                                 
                                    ˜
                                 
                              
                              ∈
                              M
                              :
                              =
                              
                                 
                                    M
                                 
                                 
                                    0
                                 
                              
                              ∪
                              ⋯
                              ∪
                              
                                 
                                    M
                                 
                                 
                                    J
                                    −
                                    1
                                 
                              
                           , define 
                              λ
                              (
                              K
                              ,
                              
                                 
                                    K
                                 
                                 
                                    ˜
                                 
                              
                              )
                            by
                              
                                 
                                    λ
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      (
                                                      ℓ
                                                      (
                                                      K
                                                      )
                                                      −
                                                      ℓ
                                                      (
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                      )
                                                      )
                                                      /
                                                      2
                                                   
                                                
                                             
                                             
                                                if 
                                                ℓ
                                                (
                                                K
                                                )
                                                ≤
                                                ℓ
                                                (
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                )
                                                +
                                                1
                                                 and 
                                                Dist
                                                (
                                                K
                                                ,
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                )
                                                ≤
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      1
                                                      −
                                                      ℓ
                                                      (
                                                      K
                                                      )
                                                      /
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      q
                                                   
                                                
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                           (2) 
                           Main idea of the proof.
                           
                              
                                 
                                    
                                       |
                                       
                                          
                                             G
                                          
                                          
                                             J
                                          
                                       
                                       ∖
                                       
                                          
                                             G
                                          
                                          
                                             0
                                          
                                       
                                       |
                                    
                                    =
                                    
                                       ∑
                                       
                                          K
                                          ∈
                                          
                                             
                                                G
                                             
                                             
                                                J
                                             
                                          
                                          ∖
                                          
                                             
                                                G
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    1
                                    
                                       ≤
                                       
                                          (4)
                                       
                                    
                                    
                                       ∑
                                       
                                          K
                                          ∈
                                          
                                             
                                                G
                                             
                                             
                                                J
                                             
                                          
                                          ∖
                                          
                                             
                                                G
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          
                                             
                                                K
                                             
                                             
                                                ˜
                                             
                                          
                                          ∈
                                          M
                                       
                                    
                                    λ
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    
                                       ≤
                                       
                                          (3)
                                       
                                    
                                    
                                       ∑
                                       
                                          
                                             
                                                K
                                             
                                             
                                                ˜
                                             
                                          
                                          ∈
                                          M
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    =
                                    
                                       
                                          C
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          J
                                          −
                                          1
                                       
                                    
                                    |
                                    
                                       
                                          M
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    .
                                 
                              
                           
                        


                           (3) 
                           For all 
                           
                              j
                              ∈
                              {
                              0
                              ,
                              …
                              ,
                              J
                              −
                              1
                              }
                            
                           and 
                           
                              
                                 
                                    K
                                 
                                 
                                    ˜
                                 
                              
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    j
                                 
                              
                            
                           holds
                           
                              
                                 
                                    
                                       ∑
                                       
                                          K
                                          ∈
                                          
                                             
                                                G
                                             
                                             
                                                J
                                             
                                          
                                          ∖
                                          
                                             
                                                G
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    λ
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    
                                    ≤
                                    
                                    (
                                    3
                                    +
                                    
                                       2
                                    
                                    )
                                    (
                                    4
                                    
                                       
                                          d
                                       
                                       
                                          p
                                       
                                    
                                    +
                                    1
                                    )
                                    (
                                    4
                                    
                                       
                                          d
                                       
                                       
                                          q
                                       
                                    
                                    +
                                    
                                       2
                                    
                                    )
                                    
                                    =
                                    
                                    
                                       
                                          C
                                       
                                       
                                          p
                                          ,
                                          q
                                       
                                    
                                    
                                    .
                                 
                              
                            This is shown as follows. By definition of λ, we have
                              
                                 
                                    
                                       ∑
                                       
                                          K
                                          ∈
                                          
                                             
                                                G
                                             
                                             
                                                J
                                             
                                          
                                          ∖
                                          
                                             
                                                G
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    λ
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    ≤
                                    
                                       ∑
                                       
                                          K
                                          ∈
                                          ⋃
                                          
                                             
                                                A
                                             
                                             
                                                p
                                                ,
                                                q
                                             
                                          
                                          ∖
                                          
                                             
                                                G
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    λ
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    =
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          2
                                       
                                       
                                          (
                                          j
                                          −
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                          )
                                          /
                                          2
                                       
                                    
                                    
                                    #
                                    
                                       
                                          
                                             {
                                             K
                                             ∈
                                             ⋃
                                             
                                                
                                                   A
                                                
                                                
                                                   p
                                                   ,
                                                   q
                                                
                                             
                                             |
                                             ℓ
                                             (
                                             K
                                             )
                                             =
                                             j
                                              and 
                                             Dist
                                             (
                                             K
                                             ,
                                             
                                                
                                                   K
                                                
                                                
                                                   ˜
                                                
                                             
                                             )
                                             ≤
                                             
                                                
                                                   2
                                                
                                                
                                                   1
                                                   −
                                                   j
                                                   /
                                                   2
                                                
                                             
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   p
                                                
                                             
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   q
                                                
                                             
                                             )
                                             }
                                          
                                          ︸
                                       
                                       B
                                    
                                    .
                                 
                              
                            Since we know by definition of the level that 
                              ℓ
                              (
                              K
                              )
                              =
                              j
                            implies 
                              |
                              K
                              |
                              =
                              
                                 
                                    2
                                 
                                 
                                    −
                                    j
                                 
                              
                           , we know that 
                              
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                              
                                 |
                                 ⋃
                                 B
                                 |
                              
                            is an upper bound of #B. The rectangular set 
                              ⋃
                              B
                            is the union of all admissible elements of level j having their midpoints inside a rectangle of size
                              
                                 
                                    
                                       
                                          2
                                       
                                       
                                          2
                                          −
                                          j
                                          /
                                          2
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          p
                                       
                                    
                                    
                                    ×
                                    
                                    
                                       
                                          2
                                       
                                       
                                          2
                                          −
                                          j
                                          /
                                          2
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          q
                                       
                                    
                                    .
                                 
                              
                            An admissible element of level j is not bigger than 
                              
                                 
                                    2
                                 
                                 
                                    −
                                    j
                                    /
                                    2
                                 
                              
                              
                              ×
                              
                              
                                 
                                    2
                                 
                                 
                                    (
                                    1
                                    −
                                    j
                                    )
                                    /
                                    2
                                 
                              
                           . Together, we have
                              
                                 
                                    
                                       |
                                       ⋃
                                       B
                                       |
                                    
                                    ≤
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          j
                                       
                                    
                                    (
                                    4
                                    
                                       
                                          d
                                       
                                       
                                          p
                                       
                                    
                                    +
                                    1
                                    )
                                    (
                                    4
                                    
                                       
                                          d
                                       
                                       
                                          q
                                       
                                    
                                    +
                                    
                                       2
                                    
                                    )
                                    ,
                                 
                              
                            and hence 
                              #
                              B
                              ≤
                              (
                              4
                              
                                 
                                    d
                                 
                                 
                                    p
                                 
                              
                              +
                              1
                              )
                              (
                              4
                              
                                 
                                    d
                                 
                                 
                                    q
                                 
                              
                              +
                              
                                 2
                              
                              )
                           . The claim is shown with
                              
                                 
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          2
                                       
                                       
                                          (
                                          j
                                          −
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                          )
                                          /
                                          2
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                          −
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                       
                                       1
                                    
                                    
                                       
                                          2
                                       
                                       
                                          j
                                          /
                                          2
                                       
                                    
                                    <
                                    
                                       2
                                    
                                    +
                                    
                                       ∑
                                       
                                          j
                                          =
                                          0
                                       
                                       ∞
                                    
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          j
                                          /
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          2
                                          
                                             2
                                          
                                          −
                                          1
                                       
                                       
                                          
                                             2
                                          
                                          −
                                          1
                                       
                                    
                                    =
                                    3
                                    +
                                    
                                       2
                                    
                                    .
                                 
                              
                           
                        


                           (4) 
                           Each 
                           
                              K
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                              
                              ∖
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                            
                           satisfies
                           
                              
                                 
                                    
                                       ∑
                                       
                                          
                                             
                                                K
                                             
                                             
                                                ˜
                                             
                                          
                                          ∈
                                          M
                                       
                                    
                                    λ
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    
                                    ≥
                                    
                                    1
                                    .
                                 
                              
                            Consider 
                              K
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    J
                                 
                              
                              ∖
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                           . Set 
                              
                                 
                                    j
                                 
                                 
                                    1
                                 
                              
                              <
                              J
                            such that 
                              K
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    1
                                 
                              
                              ∖
                              
                                 
                                    G
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           . Lemma 6.4 states the existence of 
                              
                                 
                                    K
                                 
                                 
                                    1
                                 
                              
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                            with 
                              Dist
                              (
                              K
                              ,
                              
                                 
                                    K
                                 
                                 
                                    1
                                 
                              
                              )
                              ≤
                              
                                 
                                    2
                                 
                                 
                                    −
                                    ℓ
                                    (
                                    K
                                    )
                                    /
                                    2
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    p
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    q
                                 
                              
                              )
                            and 
                              ℓ
                              (
                              K
                              )
                              ≤
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    1
                                 
                              
                              )
                              +
                              1
                           . Hence 
                              λ
                              (
                              K
                              ,
                              
                                 
                                    K
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              
                                 
                                    2
                                 
                                 
                                    ℓ
                                    (
                                    K
                                    )
                                    −
                                    ℓ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              >
                              0
                           . The repeated use of Lemma 6.4 yields 
                              
                                 
                                    j
                                 
                                 
                                    1
                                 
                              
                              >
                              
                                 
                                    j
                                 
                                 
                                    2
                                 
                              
                              >
                              
                                 
                                    j
                                 
                                 
                                    3
                                 
                              
                              >
                              …
                            and 
                              
                                 
                                    K
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    K
                                 
                                 
                                    3
                                 
                              
                              ,
                              …
                            with 
                              
                                 
                                    K
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    1
                                 
                              
                              ∖
                              
                                 
                                    G
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            such that
                              
                                 (16)
                                 
                                    Dist
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ≤
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          )
                                          /
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          q
                                       
                                    
                                    )
                                    
                                    and
                                    
                                    ℓ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    ≤
                                    ℓ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    +
                                    1
                                    .
                                 
                              
                            We repeat applying Lemma 6.4 as 
                              λ
                              (
                              K
                              ,
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              )
                              >
                              0
                            and 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              )
                              >
                              0
                           , and we stop at the first index L with 
                              λ
                              (
                              K
                              ,
                              
                                 
                                    K
                                 
                                 
                                    L
                                 
                              
                              )
                              =
                              0
                            or 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    L
                                 
                              
                              )
                              =
                              0
                           . If 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    L
                                 
                              
                              )
                              =
                              0
                            and 
                              λ
                              (
                              K
                              ,
                              
                                 
                                    K
                                 
                                 
                                    L
                                 
                              
                              )
                              >
                              0
                           , then
                              
                                 
                                    
                                       ∑
                                       
                                          
                                             
                                                K
                                             
                                             
                                                ˜
                                             
                                          
                                          ∈
                                          M
                                       
                                    
                                    λ
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    ≥
                                    λ
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          L
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          2
                                       
                                       
                                          (
                                          ℓ
                                          (
                                          K
                                          )
                                          −
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                L
                                             
                                          
                                          )
                                          )
                                          /
                                          2
                                       
                                    
                                    ≥
                                    
                                       2
                                    
                                    .
                                 
                              
                            If 
                              λ
                              (
                              K
                              ,
                              
                                 
                                    K
                                 
                                 
                                    L
                                 
                              
                              )
                              =
                              0
                            because 
                              ℓ
                              (
                              K
                              )
                              >
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    L
                                 
                              
                              )
                              +
                              1
                           , then (16) yields 
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    L
                                    −
                                    1
                                 
                              
                              )
                              ≤
                              ℓ
                              (
                              
                                 
                                    K
                                 
                                 
                                    L
                                 
                              
                              )
                              +
                              1
                              <
                              ℓ
                              (
                              K
                              )
                            and hence
                              
                                 
                                    
                                       ∑
                                       
                                          
                                             
                                                K
                                             
                                             
                                                ˜
                                             
                                          
                                          ∈
                                          M
                                       
                                    
                                    λ
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    ≥
                                    λ
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          L
                                          −
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          2
                                       
                                       
                                          (
                                          ℓ
                                          (
                                          K
                                          )
                                          −
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                L
                                                −
                                                1
                                             
                                          
                                          )
                                          )
                                          /
                                          2
                                       
                                    
                                    ≥
                                    
                                       2
                                    
                                    .
                                 
                              
                            If 
                              λ
                              (
                              K
                              ,
                              
                                 
                                    K
                                 
                                 
                                    L
                                 
                              
                              )
                              =
                              0
                            because 
                              Dist
                              (
                              K
                              ,
                              
                                 
                                    K
                                 
                                 
                                    L
                                 
                              
                              )
                              >
                              
                                 
                                    2
                                 
                                 
                                    1
                                    −
                                    ℓ
                                    (
                                    K
                                    )
                                    /
                                    2
                                 
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    p
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    q
                                 
                              
                              )
                           , then a triangle inequality shows
                              
                                 
                                    
                                       
                                          2
                                       
                                       
                                          1
                                          −
                                          ℓ
                                          (
                                          K
                                          )
                                          /
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          q
                                       
                                    
                                    )
                                    
                                    <
                                    
                                    Dist
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          L
                                          −
                                          1
                                       
                                    
                                    Dist
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    )
                                    
                                    ≤
                                    
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          K
                                          )
                                          /
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          q
                                       
                                    
                                    )
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          L
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          /
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          q
                                       
                                    
                                    )
                                    ,
                                 
                              
                            and hence 
                              
                                 
                                    2
                                 
                                 
                                    −
                                    ℓ
                                    (
                                    K
                                    )
                                    /
                                    2
                                 
                              
                              ≤
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    L
                                    −
                                    1
                                 
                              
                              
                                 
                                    2
                                 
                                 
                                    −
                                    ℓ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    /
                                    2
                                 
                              
                           . The proof is concluded with
                              
                                 
                                    1
                                    
                                    ≤
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          L
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          2
                                       
                                       
                                          (
                                          ℓ
                                          (
                                          K
                                          )
                                          −
                                          ℓ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          )
                                          /
                                          2
                                       
                                    
                                    
                                    =
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          L
                                          −
                                          1
                                       
                                    
                                    λ
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    
                                    ≤
                                    
                                    
                                       ∑
                                       
                                          
                                             
                                                K
                                             
                                             
                                                ˜
                                             
                                          
                                          ∈
                                          M
                                       
                                    
                                    λ
                                    (
                                    K
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    .
                                 
                              
                             □

@&#CONCLUSION@&#

We presented an adaptive refinement algorithm for a subclass of analysis-suitable T-meshes that produces nested T-spline spaces, and we proved theoretical properties that are crucial for the analysis of adaptive schemes driven by a posteriori error estimators. As an example, compare Assumptions (2.9) and (2.10) from Carstensen et al. (2014) to Theorem 6.1 and Lemma 4.4, respectively. The presented refinement algorithm can be extended to the three-dimensional case, which is our current work. The factor 
                        
                           
                              C
                           
                           
                              p
                              ,
                              q
                           
                        
                      from the complexity estimate is affine in each of the parameters p, q and increases exponentially with growing dimension. We aim to apply the proposed algorithm to proof the rate-optimality of an adaptive algorithm for the numerical solution of second-order linear elliptic problems using T-splines as ansatz functions. Similar results have been proven for simple FE discretizations of the Poisson model problem by Stevenson (2007), Cascon et al. (2008), and recently for a wide range of discretizations and model problems by Carstensen et al. (2014).

@&#ACKNOWLEDGEMENTS@&#

The authors gratefully acknowledge support by the Deutsche Forschungsgemeinschaft in the Priority Program 1748 “Reliable simulation techniques in solid mechanics. Development of non-standard discretization methods, mechanical and mathematical analysis” under the project “Adaptive isogeometric modeling of propagating strong discontinuities in heterogeneous materials”.

@&#REFERENCES@&#

