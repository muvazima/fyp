@&#MAIN-TITLE@&#Multifiber pathway reconstruction using bundle constrained streamline

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Multiple orientations based method for fiber pathways reconstruction.


                        
                        
                           
                           Use of neighboring fiber consistency constraint in the pathway reconstruction.


                        
                        
                           
                           Results on Fiber Cup dataset have shown that the proposed method outperformed the contest winner's method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

@&#ABSTRACT@&#


               
               
                  Fiber tractography techniques in diffusion magnetic resonance imaging have become a primary tool for studying the fiber architecture of biological tissues both noninvasively and in vivo. Streamline tracking, as a simple and efficient tractography technique, is widely used to reconstruct fiber pathways. It is however very sensitive to noisy estimation of local fiber orientations. In this paper, we propose a bundle constrained streamline method to accurately reconstruct multifiber pathways. The method introduces neighboring fiber consistency constraint in the tracking process and reconstructs fiber pathways that have optimal tradeoff between consistency with local fiber orientation estimations and similarity with neighboring fiber segment orientations. Results on synthetic, physical phantom and real human brain DW images show that the proposed method allows regular fiber pathways to be reconstructed and outperforms existing techniques.
               
            

@&#INTRODUCTION@&#

Diffusion magnetic resonance imaging (dMRI) tractography provides a primary tool for studying the fiber architecture of biological tissues both noninvasively and in vivo. The technique allows us to estimate neuronal tract pathways to determine both the structure and the connectivity of the brain.

Diffusion tensor imaging (DTI) based streamline tracking was the first technique proposed and has been largely used to reconstruct fiber pathways in the human brain [1]. However, the DTI has been shown to fail in regions presenting intravoxel orientational heterogeneity such as fiber or fiber bundle crossing and branching. A number of more sophisticated models for estimating multiple fiber orientations (MFOs) within a voxel have been proposed in order to overcome the single orientation limitation of DTI. We cite, for instance, multitensor based models [2–4], high-order diffusion tensor [5], Q-Ball [6,7], diffusion spectrum imaging [8], spherical deconvolution [9–11], independent component analysis (ICA) from DTI [12], etc. More details can be found in [13,14].

To reconstruct multifiber pathways form the MFO system, several extensions of DTI-based streamline have been proposed for white matter tractography. A modified fiber assignment using the continuous tracking method was proposed to reconstruct tracts along the MFOs obtained from Q-Ball imaging [15]. Two-tensor based streamline tractography was successfully obtained in the regions of crossing fibers [16]. ICA based streamline was also developed to conduct human brain tractography from diffusion data [17]. In the above-mentioned streamline tracking techniques, fiber pathways are constructed based on local fiber orientation estimation in a step-by-step way. Therefore, the accuracy of the reconstruction is sensitive to the estimation of intravoxel fiber orientations and suffers from cumulative errors along the tracking path.

Recently, global optimization based methods have been reported to reconstruct the most probable paths in the whole brain. These methods estimate fiber pathways by a cost function minimization or posterior probability maximization process. Some of the global methods consider the optimization of the path between two designated regions to produce optimal trajectories [18–21]. Others reconstruct full fiber tracts over the whole brain at once [22–25]. The global methods are less affected by the noisy estimation of local fiber orientations and the cumulative errors. However, they are generally computationally intensive and may not satisfy the requirement of practical uses.

In this paper, we propose a bundle constrained streamline (BCS) method which introduces the orientation information of neighboring fibers in the process of the streamline tracking to overcome the sensitivity to the local uncertainty in the estimation of intravoxel fiber orientations. Based on the assumption of local fiber consistency (i.e. the neighboring fiber pathways are similar in local orientation), the method reconstructs fiber pathways that have optimal tradeoff between consistency with local fiber orientation estimations and similarity with neighboring fiber segment orientations.

@&#METHODOLOGY@&#

The proposed fiber pathway reconstruction method is depicted in Fig. 1
                     . It consists essentially of two main elements: fiber pathway reconstruction according to BCS tracking rules and fiber pathway smoothing.

The streamline tracking method reconstructs fiber pathways in a step-by-step way. The process starts with a predefined point in the region containing fibers, called the seed point, and iteratively moves the point along local diffusion orientations until a stopping criterion is fulfilled. In general, the stopping criteria include the exiting from the region of interest, intersection at voxels having low anisotropy values and large local curvature of the trajectory. The iterative tracking process can be descripted by the updating formula:
                           
                              (1)
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          p
                                       
                                       i
                                    
                                    +
                                    
                                       s
                                       t
                                    
                                    
                                       
                                          d
                                       
                                       i
                                    
                                 
                              
                           
                        where s
                        
                           t
                         is the step size, p
                        
                           i+1 the next position determined by the previous position p
                        
                           i
                        , and d
                        
                           i
                         the local diffusion orientation at ith step. Due to the influence of noise in dMRI data on local diffusion orientations, the streamline method often generates inaccurate fiber reconstruction.

Like the streamline, the BCS tracking also reconstructs fiber pathways in a step-by-step way. However, in each step of BCS tracking, we determine the next fiber segment position p
                        
                           i+1 according to the local fiber orientation estimation as well as the mean fiber orientation of all or part of the fiber sets Θ, where each fiber passes through the neighborhood of seed point p
                        0 with radius R
                        
                           D
                        .

The determination of the next fiber segment position p
                        
                           i+1 is illustrated in Fig. 2
                        . Assuming that multiple fiber bundles probably exist in Θ, we divide Θ into one or more fiber sets denoted by 
                           
                              
                                 Θ
                                 1
                              
                              ,
                              
                                 Θ
                                 2
                              
                              ,
                              …
                              ,
                              
                                 Θ
                                 
                                    
                                       N
                                       C
                                    
                                 
                              
                           
                        , where N
                        
                           C
                         is the number of sets. In the present study, to divide Θ, we use a simple agglomerative hierarchical clustering, where a distance threshold H
                        TC between two subnodes of hierarchical clustering tree is used as the criterion for forming clusters. The distance metric between two fibers is defined as the arithmetic mean of the distances between the corresponding points on two fibers.

In Fig. 2, the curved surface S
                        
                           k
                         is a part of the sphere at p
                        
                           i
                         with radius s
                        
                           t
                         (step size), and any point q
                        ∈
                        S
                        
                           k
                         satisfies the angle between q–p
                        
                           i
                         and d
                        
                           i+1 (i.e. 
                           
                              
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       i
                                    
                                    −
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 /
                                 
                                    
                                       s
                                       t
                                    
                                 
                              
                           
                        ) is smaller than an angle threshold θ
                        
                           s
                        . We determine the next fiber segment position p
                        
                           i+1 as the solution of the optimization problem:
                           
                              (2)
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          arg
                                          min
                                       
                                       
                                          q
                                          ∈
                                          
                                             S
                                             k
                                          
                                       
                                    
                                    
                                       
                                          
                                             E
                                             D
                                          
                                          
                                             
                                                q
                                             
                                          
                                          +
                                          μ
                                          
                                             E
                                             F
                                          
                                          
                                             
                                                q
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where μ is the control parameter which provides a tradeoff between “diffusion potential energy” 
                           
                              
                                 E
                                 D
                              
                              
                                 
                                    q
                                 
                              
                           
                         and “flow potential energy” 
                           
                              
                                 E
                                 F
                              
                              
                                 
                                    q
                                 
                              
                           
                        .

The “diffusion potential energy” reflects the dissimilarity between the local fiber orientation estimate d
                        
                           D
                         (main diffusion direction) and the fiber segment direction 
                           
                              
                                 
                                    d
                                 
                                 i
                              
                              =
                              
                                 
                                    (
                                    
                                       q
                                    
                                    −
                                    
                                       
                                          p
                                       
                                       i
                                    
                                    )
                                 
                                 /
                                 
                                    
                                       s
                                       t
                                    
                                 
                              
                           
                         at p
                        
                           i
                        , and is defined as
                           
                              (3)
                              
                                 
                                    
                                       E
                                       D
                                    
                                    
                                       
                                          q
                                       
                                    
                                    =
                                    1
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   D
                                                   T
                                                
                                                
                                                   
                                                      d
                                                   
                                                   i
                                                
                                             
                                          
                                       
                                       2
                                    
                                    .
                                 
                              
                           
                        
                     

Note that multiple fiber orientations at p
                        
                           i
                         are possible. In this case, d
                        
                           D
                         is the nearest orientation to d
                        
                           i
                        . Especially, if there is no fiber orientation at p
                        
                           i
                         (invalid voxel or with very low fractional anisotropy value), we set 
                           
                              
                                 E
                                 D
                              
                              
                                 
                                    q
                                 
                              
                              =
                              ∞
                           
                        .

The “flow potential energy” measures the dissimilarity between the fiber segment direction d
                        
                           i
                         and the mean flow directions d
                        
                           Fj
                         of fiber sets Θ
                        
                           j
                        (j
                        =1, 2, …, N
                        
                           C
                        ) at p
                        
                           i
                        , and is defined as
                           
                              (4)
                              
                                 
                                    
                                       E
                                       F
                                    
                                    
                                       
                                          q
                                       
                                    
                                    =
                                    1
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   i
                                                   T
                                                
                                                
                                                   
                                                      d
                                                   
                                                   F
                                                
                                             
                                          
                                       
                                       2
                                    
                                    ,
                                 
                              
                           
                        where d
                        
                           F
                         is one of d
                        
                           Fj
                         which is the nearest to d
                        
                           i
                        . Especially, if there is no valid d
                        
                           Fj
                        , we set 
                           
                              
                                 E
                                 F
                              
                              
                                 
                                    q
                                 
                              
                              =
                              ∞
                           
                        .

The computation of the mean flow direction d
                        
                           Fj
                         is shown in Fig. 3
                        . The plane S
                        
                           p
                         passes through p
                        
                           i
                         and perpendicular to d
                        
                           i–1; the kth fiber in Θ
                        
                           j
                         passes through S
                        
                           p
                         at point p
                        
                           jk
                        , and p
                        
                           ik
                         is the fiber segment direction of the kth fiber at p
                        
                           jk
                        . We compute d
                        
                           Fj
                         as
                           
                              (5)
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          F
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         N
                                                         j
                                                      
                                                   
                                                
                                                
                                                   
                                                      f
                                                      w
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     j
                                                                     k
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  i
                                                               
                                                            
                                                         
                                                         ,
                                                         arccos
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           d
                                                                        
                                                                        
                                                                           j
                                                                           k
                                                                        
                                                                        T
                                                                     
                                                                     
                                                                        
                                                                           d
                                                                        
                                                                        
                                                                           i
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                
                                                   N
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                f
                                                w
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               j
                                                               k
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               p
                                                            
                                                            i
                                                         
                                                      
                                                   
                                                   ,
                                                   arccos
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     d
                                                                  
                                                                  
                                                                     j
                                                                     k
                                                                  
                                                                  T
                                                               
                                                               
                                                                  
                                                                     d
                                                                  
                                                                  
                                                                     i
                                                                     −
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where N
                        
                           j
                         designates the number of fibers in Θ
                        
                           j
                         and f
                        
                           w
                         is a weighting function defined by
                           
                              (6)
                              
                                 
                                    
                                       f
                                       w
                                    
                                    
                                       
                                          x
                                          ,
                                          y
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            −
                                                            x
                                                         
                                                         
                                                            
                                                               R
                                                               d
                                                            
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ≤
                                                      x
                                                      ≤
                                                      
                                                         R
                                                         d
                                                      
                                                      ,
                                                      y
                                                      ≤
                                                      
                                                         θ
                                                         s
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where x is the distance between two points, y is the angle between two fiber segments, and R
                        
                           d
                         and θ
                        
                           s
                         are the parameters allowing omitting the fibers that obviously deviate from p
                        
                           i
                        .

In practice, to reduce the computational complexity of (2), we uniformly select 100 points on S
                        
                           k
                        , and choose the point having the minimum energy as the solution of (1).

The stop criterion of BCS tracking is 
                           
                              
                                 E
                                 D
                              
                              
                                 
                                    q
                                 
                              
                              +
                              μ
                              
                                 E
                                 F
                              
                              
                                 
                                    q
                                 
                              
                              =
                              ∞
                              ,
                                 
                              ∀
                              
                                 q
                              
                              ∈
                              
                                 S
                                 k
                              
                           
                        .

We smooth fiber pathways using simple neighborhood averaging method. To a fiber pathway F are linked a series of points p
                        1, p
                        2, …, p
                        
                           s
                        , …, p
                        
                           n
                        , where p
                        
                           s
                         denotes the seed point of F. Each point is smoothed with odd span r
                        
                           s
                         as
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          ′
                                       
                                       i
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            i
                                                            −
                                                            (
                                                            
                                                               r
                                                               s
                                                            
                                                            −
                                                            1
                                                            )
                                                            /
                                                            2
                                                         
                                                         
                                                            i
                                                            +
                                                            (
                                                            
                                                               r
                                                               s
                                                            
                                                            −
                                                            1
                                                            )
                                                            /
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  j
                                                               
                                                            
                                                            
                                                               
                                                                  r
                                                                  s
                                                               
                                                            
                                                         
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      i
                                                      ≠
                                                      s
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         s
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      i
                                                      =
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The position of seed point is preserved for the subsequent analysis.

The BCS tracking procedure is described as follows:
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          Algorithm 1 BCS tracking
                                       
                                    
                                    
                                       
                                          Input:
                                       
                                       Step size s
                                          
                                             t
                                          , parameters R
                                          
                                             D
                                          , H
                                          
                                             TC
                                          , μ, θ
                                          
                                             s
                                          , R
                                          
                                             d
                                          , smoothing radius r
                                          
                                             s
                                          , number of iterations N
                                          iter, seed points P
                                          seeds, and MFO field.
                                    
                                    
                                       
                                          Output:
                                       
                                       Fiber pathway set Φ.
                                    
                                    
                                       1:
                                       Φ←Streamline tracking
                                    
                                    
                                       2:
                                       
                                          For 
                                          i
                                          
                                             t
                                          
                                          =1 to N
                                          iter 
                                          do
                                       
                                    
                                    
                                       3:
                                       
                                          
                                          For ∀F
                                          ∈
                                          Φ 
                                          do
                                       
                                    
                                    
                                       4:
                                       
                                          
                                          Remove F from Φ
                                    
                                    
                                       5:
                                       
                                          
                                          
                                          P
                                          0←The seed point of F
                                       
                                    
                                    
                                       6:
                                       
                                          
                                          Θ←Find neighboring fibers of p
                                          0 with radius 
                                          
                                          R
                                          
                                             d
                                          
                                       
                                    
                                    
                                       7:
                                       
                                          
                                          
                                          
                                             
                                                {
                                                
                                                   Θ
                                                   1
                                                
                                                ,
                                                
                                                   Θ
                                                   2
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   Θ
                                                   
                                                      
                                                         N
                                                         C
                                                      
                                                   
                                                
                                                }
                                                ←
                                             
                                          Agglomerative hierarchical 
                                          clustering
                                    
                                    
                                       8:
                                       
                                          
                                          
                                          i
                                          ←0
                                    
                                    
                                       9:
                                       
                                          
                                          
                                          Repeat
                                       
                                    
                                    
                                       10:
                                       
                                          
                                          
                                          
                                          S
                                          
                                             k
                                          ← A part of the sphere at p
                                          
                                             i
                                           with radius s
                                          
                                             t
                                           (Fig. 2)
                                    
                                    
                                       11:
                                       
                                          
                                          
                                          Uniformly select 100 points 
                                          
                                          
                                          Q
                                          ={q
                                          1, q
                                          2, …, q
                                          100} on S
                                          
                                             k
                                          
                                       
                                    
                                    
                                       12:
                                       
                                          
                                          
                                          
                                          For ∀q
                                          ∈
                                          Q do
                                       
                                    
                                    
                                       13:
                                       
                                          
                                          
                                          
                                          Compute energy 
                                             
                                                
                                                   E
                                                   D
                                                
                                                
                                                   
                                                      q
                                                   
                                                
                                             
                                           using (2)
                                    
                                    
                                       14:
                                       
                                          
                                          
                                          
                                          Compute energy 
                                             
                                                
                                                   E
                                                   F
                                                
                                                
                                                   
                                                      q
                                                   
                                                
                                             
                                           using (3)
                                    
                                    
                                       15:
                                       
                                          
                                          
                                          
                                          End For
                                       
                                    
                                    
                                       16:
                                       
                                          
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                ←
                                                
                                                   
                                                      arg
                                                      min
                                                   
                                                   
                                                      q
                                                      ∈
                                                      Q
                                                   
                                                
                                                
                                                   
                                                      
                                                         E
                                                         D
                                                      
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      +
                                                      μ
                                                      
                                                         E
                                                         F
                                                      
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       17:
                                       
                                          
                                          
                                          
                                          i
                                          ←
                                          i
                                          +1
                                    
                                    
                                       18:
                                       
                                          
                                          
                                          Until 
                                          
                                             
                                                
                                                   E
                                                   D
                                                
                                                
                                                   
                                                      q
                                                   
                                                
                                                +
                                                μ
                                                
                                                   E
                                                   F
                                                
                                                
                                                   
                                                      q
                                                   
                                                
                                                ≠
                                                ∞
                                                ,
                                                ∀
                                                
                                                   q
                                                
                                                ∈
                                                
                                                   Q
                                                
                                             
                                          
                                       
                                    
                                    
                                       19:
                                       
                                          
                                          
                                          F
                                          ←{p
                                          0, p
                                          1, …, p
                                          
                                             i
                                          }
                                    
                                    
                                       20:
                                       
                                          
                                          Smoothing F using (6)
                                    
                                    
                                       21:
                                       
                                          
                                          Add F to Φ
                                    
                                    
                                       22:
                                       
                                          
                                          
                                          End For
                                       
                                    
                                    
                                       23:
                                       
                                          
                                          End For
                                       
                                    
                                 
                              
                           
                        
                     

The proposed method involves several parameters, so we briefly discuss the impact of the parameters in this section. We suggest that some parameters are chosen according to the smallest spacing between two neighboring voxels s
                        
                           m
                        . Empirically, we give our default choice of these parameters used in the present work.

The step size s
                        
                           t
                         should be reasonably small. However, if s
                        
                           t
                         is too small, it will lead to increased computational workload. As a default, we choose s
                        
                           t
                        
                        =0.5s
                        
                           m
                        .

The radius R
                        
                           D
                         is used to determine the fiber set Θ around a seed point. The parameter R
                        
                           D
                         should be reasonably large such that Θ contains a sufficient number of fibers. An excessively large R
                        
                           D
                         will not lead to bad results but will increase numerical complexity. Our default choice is R
                        
                           D
                        
                        =2s
                        
                           m
                        .

The parameter H
                        TC is a distance threshold used to divide Θ. A too small H
                        TC may lead to a fiber set Θ that will be divided into too many clusters, while a too large H
                        TC may lead to one cluster containing several fiber bundles diverging in different directions. In both the extreme cases, the reconstruction error will become relatively higher. In our experiments, we set H
                        TC
                        =30mm.

The parameter μ is an important parameter which ensures the tradeoff between diffusion potential and flow potential. The choice of this parameter should take into account the noise level of data. In the case of high level noise, a large μ would be advised because of the low reliability of the local fiber orientation estimations. As a default, we choose μ
                        =6.

The parameter θ
                        
                           s
                         defining the fiber segment direction is limited to a reasonable extent. Our default choice is θ
                        
                           s
                        
                        =30 degrees.

The parameter R
                        
                           d
                         combined with θ
                        
                           s
                         determines which fibers in Θ
                        
                           j
                         are to be used to compute the mean flow direction. As a default, we choose R
                        
                           d
                        
                        =
                        s
                        
                           m
                         degrees.

The radius r
                        
                           s
                         controls the level of fiber smoothing. Our default choice is r
                        
                           s
                        
                        =3.

For the number of iterations N
                        iter, a choice of 3 to 5 is generally sufficient. A too large N
                        iter will lead to unnecessary numerical complexity. Our default choice is N
                        iter
                        =5.

@&#EXPERIMENTS AND RESULTS@&#

The proposed method is evaluated on synthetic, physical phantom and real human brain data. In all our experiments, the local fiber orientation is estimated using the constrained compressed sensing (CCS) method [3]. As a default, we set the fractional anisotropy threshold as 0.1 and angle threshold as 30 degrees for the streamline method.

The diffusion-weighted (DW) data of size 16×16 were synthesized from the multitensor model with b-value of 1000s/mm2 and 30 gradient directions. The diffusion tensor eigenvalues were set to (1.2, 0.3, 0.3)×10−3
                        mm2/s. The fiber architecture of the simulated data (noise free) is shown in Fig. 4a, which consists of two fiber bundles form a crossing configuration. Rician noise is added to generate the noisy data with a signal-to-noise ratio (SNR) of 17. In the present paper, the SNR of the simulation data was defined as the ratio of nondiffusion-weighted signal intensity to the noise standard deviation.

In the simulation experiment, we set the parameters r
                        
                           s
                        
                        =2 and N
                        iter
                        =3 for the BCS method. Fig. 4b and c shows the fiber pathways reconstructed using the streamline and BCS methods, respectively. The seed points were marked with the small red circles and the intravoxel fiber structures were shown as the background. It can be seen that, at the SNR of 17, the streamline method is very sensitive to the local fiber orientation estimation, which results in some fibers showing premature termination (marked by the red ellipse in Fig. 4d), divagation (marked by the black ellipse in Fig. 4d) or inflection (marked by the yellow ellipses in Fig. 4d). However, the fibers from the BCS method are well consistent with the ground truth, without premature termination, divagation, or inflection at all.

We used the diffusion phantom data published for the Fiber Cup at MICCAI 2009 [26], specifically the data with b-value of 1500s/mm2, 64 gradient directions, imaging matrix of 64×64×3, and isotropic spatial resolution of 3mm. The phantom data were designed to compare the performance of fiber tractography algorithms. It simulates a coronal section of the human brain, containing several fiber crossing and kissing configurations with different curvatures.

In the Fiber Cup challenge, a total of 16 seed points and the corresponding 16 fiber pathways (see Fig. 7a) were supplied as the ground truth to compare the performance of different methods. Three metrics were used for the contest: spatial metric, tangent metric, and curve metric [27].

Some seed points are selected manually and marked as the small red circles in Fig. 6. In particular, the selected seed points contain the 16 seed points initially designed for the contest. A mask has been defined to exclude the background region for better visualization and reducing computation workload. In all the experiments on the phantom data, we set the fractional anisotropy threshold to 0.01 for the streamline method. The parameters of the BCS method were optimized in terms of the three metrics used for the contest. The optimization process starts with a set of empirical parameters (the first row in Table 1
                        ), and varies one parameter at each time. Fig. 5
                         shows the impact of main parameters on the results. In some cases, we observe the curve metric inconsistent with the spatial metric and tangent metric. For example, in Fig. 5d the spatial metric and tangent metric indicate better performance when H
                        TC
                        =21 to 30mm, while the curve metric indicates the contrary results. Generally, the spatial metric reflects more adequately the similarities between pathways [28]. Table 1 summarizes the range of optimal parameters and that used in the present work.


                        Fig. 6
                         shows the fiber tracking results obtained using the streamline and BCS methods with the selected seed points. By visually comparing the fiber tracking results, the BCS method is obviously superior to the streamline method.


                        Fig. 7b and c shows the results of the winner's method [29] reported in the Fiber Cup and our BCS method, respectively. It can be seen that the fiber pathways, reconstructed by both methods, grossly follow the ground truth. However, close inspections reveal that the winner's method tends to generate fiber pathways that confuse the spatial position of adjacent fibers with different seed points, such as Fiber 3 and Fiber 4. Furthermore, the Fiber 12 was incorrectly reconstructed using the winner's method, whereas the shapes of all the fiber pathways reconstructed using the BCS method were similar to the ground truth.


                        Table 2
                         gives the quantitative results of the BCS method and the winner's method in terms of the three metrics. The best values have been highlighted by a bold font. The scores indicate that the BCS method has better performance.

The real human brain data come from the open data collection at http://hdl.handle.net/1926/1687. The datasets were acquired on a 3T GE system using an echo planar imaging (EPI) DTI Tensor sequence. Each DW volume consists of 86 contiguous axial slices of size 144×144. The acquisition parameters were: TR=17,000ms, TE=78ms, FOV=24cm, slice thickness=1.7mm, diffusion sensitivity factor b
                        =900s/mm2, and diffusion gradient directions=51.

In the real data experiment, we randomly select about 20 thousands seed points in the whole brain. Fig. 8
                         shows the fiber pathways reconstructed using the streamline and BCS methods, respectively. The fiber pathways are colored by their local orientation. The reconstructions contain approximately 13 thousands fiber pathways longer than 20mm. The mean fiber-length of the two results is 57mm and 76mm, respectively.

To analyze the details of the reconstructions, we define three regions of interest (Fig. 9
                        ) and extracted fiber bundles of the corpus callosum, the corticospinal tract, and the cingulate cortex, respectively. The MITK Diffusion toolkit [30] was used for the fiber extraction and visualization work. Fig. 10
                         shows the results of fiber extraction. For the corpus callosum, the streamline method has less fibers going to the apical cortex and the most lateral projections are missing, while our BCS method shows more widespread projections and covers larger cortical areas in both hemispheres. For the corticospinal tract and cingulate cortex reconstruction, our BCS method exhibits better local consistence and many more fibers than the streamline. Furthermore, the results reconstructed using our BCS method were more consistent with known neuroanatomy in comparison with tracts from the streamline.

@&#DISCUSSION AND CONCLUSION@&#

We have proposed a BCS tracking method for reconstructing multifiber pathways based on multiple fiber orientations in a voxel. The method presents the particularity of achieving optimal tradeoff between consistency with local fiber orientation estimations and similarity with neighboring fiber segment orientation. The results on synthetic, physical phantom and real human brain data consistently demonstrated that the proposed BCS tracking method enables regular fiber pathways to be reconstructed and presents improved performance over the commonly used streamline and contest winner's method.

In comparison with the streamline method, the proposed BCS method does not exhibit premature termination, divagation, or inflection. The reason is that the streamline method tracks fiber pathways strictly based on the inaccurate MFO estimation caused by noise in the data or improper model fitting. In contrast, the proposed BCS method introduces the neighboring fiber consistency constraint to overcome the problems of premature termination and divagation and smooth the fiber pathways to diminish the inflection.

The computational complexity of the BCS method depends on the fiber counts of initial reconstruction. Generally, more fibers mean more complexity of searching neighboring fibers and calculating the mean fiber orientation. In this case, we suggest searching neighboring fibers in a random subset of initial reconstruction as a compromise proposal.

The BCS method is based on the assumption that fiber bundles are locally smooth. Therefore, at voxels where the local smoothness assumption is obviously violated, such as trauma or pathology region, the neighboring fiber orientation information may lead to inaccurate reconstruction. In this case, the results obtained should be interpreted with precaution since fiber pathways could be altered.

None of the authors declare any conflicts of interest.

@&#ACKNOWLEDGMENTS@&#

This work was supported by the National Natural Science Foundation of China (61271092), International S&T Cooperation Project of China, Ministry of Science and Technology of China (2007DFB30320), the Program PHC-Cai Yuanpei 2012, the Applied Technology Research and Development Program of Heilongjiang Province, Office of Science and Technology in Heilongjiang Province (GC13A311), the applied technology research and development program for Harbin Creative Talents (2014RFXXJ102), the Fundamental Research Funds for the Central Universities (HIT. NSRIF. 2015021), Scientific Research Startup Fund for the HIT Future Faculty, and the French ANR under ANR-13-MONU-0009-01.

@&#REFERENCES@&#

