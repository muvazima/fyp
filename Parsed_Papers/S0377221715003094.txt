@&#MAIN-TITLE@&#An efficient two-stage algorithm for decentralized scheduling of micro-CHP units

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We develop an efficient algorithm for scheduling CHP units with electric vehicles.


                        
                        
                           
                           Our method is tested within a case study of two German households.


                        
                        
                           
                           We apply individual short-term load forecasting approach implemented as an ANFIS.


                        
                        
                           
                           The computing time could be reduced to about 
                                 
                                    1
                                    15
                                 
                               compared to the MILP.


                        
                        
                           
                           The deviations from the MILP solution regarding the annual supply costs are small.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in energy

PEMFC micro-combined heat and power

Predictive scheduling and optimization

Mixed-integer programming

Algorithmic approach

@&#ABSTRACT@&#


               
               
                  In this paper we present an efficient two-stage hierarchical decomposition algorithm aiming at determining economically improved operation schedules for residential proton exchange membrane fuel cell micro-combined heat and power (PEMFC micro-CHP) units and optimizing local charging of electric vehicles (EV) in the same household. Based on an individual short-term load forecasting (STLF) approach (imperfect forecast) for households implemented as an adaptive network-based fuzzy inference system (ANFIS), a mixed-integer linear program (MILP) and a two-stage greedy algorithm are used for determining optimized schedules based on a rolling-window approach. The results of the case study performed for eight variants in exemplary German households reveal that with both the MILP and the algorithmic approach, significant economic savings can be achieved compared to the standard heat-led strategy. Compared to the MILP, however, the two-stage algorithm has the additional advantage of a reduced computing time of only about 
                        
                           1
                           15
                        
                     . Deviations from the MILP solutions are mostly smaller than 3 percent regarding the annual supply costs. Moreover, the comparison between the use of perfect and imperfect demand forecasts quantifies additional average losses due to forecasting errors of 2 percent and 3.3 percent at the maximum. Altogether, the algorithmic approach seems to be convincing for real applications in households due to its good results, high reliability, easy implementation, and short computing times. The combination of a micro-CHP unit and an EV is highly synergetic.
               
            

@&#INTRODUCTION@&#

Ongoing extensive research, development, and funding activities regarding micro-combined heat and power units (micro-CHP units) are likely to enhance their distribution in small and medium-sized households. In Germany this is supported by legal measures designed to leverage the governmental target of doubling the share of CHP electricity generation from about 12 percent in 2012 to 25 percent by 2020 (Federal Republic of Germany, 2012). The target will only be reached if the share of domestic micro-CHP units will grow above average compared to large-scale and industrial CHP (Westner & Madlener, 2011). To reach this ambitious goal, profitable micro-CHP solutions have to be developed. These are also highly efficient in terms of emission reduction. With proton exchange membrane fuel cell (PEMFC)-based micro-CHP units, the coupled generation of electricity and heat allows for a more efficient use of primary energy due to their comparably high power to heat ratio (ρ). A PEMFC micro-CHP includes a reformer for generating hydrogen and a PEMFC for generating electricity and heat (cf. Fig. 2). While PEMFC systems reach values of ρ ≈ 0.6, other technologies like mostly applied gas engines (ρ ≈ 0.4) or Stirling engines (ρ ≈ 0.3) only reach lower values (Pehnt & Colijn, 2006; Thomas, 2011). However, especially the promising and efficient PEMFC systems suffer from a limited operational flexibility (Hawkes, Brett, & Brandon, 2009) leading to economic disadvantages and, hence, to the necessity of special methods to address the challenge of reaching economically optimized operation.

The key advantages of domestic micro-CHP mentioned above are only valid, if two important aspects are fulfilled:

                           
                              1.
                              The unit is operated to such an extent only that all thermal energy produced can be used in the local building either directly or with the help of a thermal buffer storage and

the electricity generated on-site is used by the household to the largest possible extent (which also is economically reasonable).

The legal framework in Germany accounts for these two key requirements by funding the whole electricity generated with micro-CHP units via a CHP-bonus within the first half of the expected lifetime of 20 years, while the co-produced thermal energy is to be used locally and not allowed to be dumped (Federal Republic of Germany, 2012). From the micro-CHP operator’s point of view, it is therefore economically reasonable to maximize the own consumption rate of self-generated electricity. This is due to the CHP-bonus payments and the generated savings that correspond to the electricity purchase price (≈0.25 € /kilowatt-hour, estimated conservatively) which are higher than the total feed-in tariff ( ≈ 0.11 € /kilowatt-hour) paid to the unit’s owner, if the electricity produced is fed into the grid. However, most micro-CHP units in Germany are still operated in heat-led based modes (cf. Section 2), because there is a lack of intelligent control algorithms providing for an optimized operation with respect to the time-dependent local demand of electric energy, which is not necessarily correlated perfectly with the local heat demand (particularly in times of low heat consumption).

Beyond scheduling the operation of a PEMFC micro-CHP unit tailored to the temporal characteristics of the local electricity demand, the presence of an electric vehicle (EV) which is mainly charged at home can influence the unit’s profitability. The latter might possibly become more common due to a predicted increasing market share of EV between 3 and 30 percent until 2030 (Kay, Hill, & Newman, 2013). As a result of the vehicle’s commonly high electricity demand and long parking times at home, significant degrees of freedom are generated, which may be utilized by a load shifting approach in order to maximize own consumption of locally produced electricity (Grässle, Becker, Knapp, Allerding, Schmeck, & Wagner, 2011). The methods used in the following case study take all these case-specific aspects into account by an integrated modeling approach which includes both the optimization of PEMFC micro-CHP operation and the charging time of an EV aiming at minimizing a household’s total supply costs. To do so, an online optimization of the operating strategy is developed.

@&#RELATED WORK@&#

Based on the specific problem setting described, we present a concept for the determination of improved operating strategies through an auto-adaptive approach which individually takes each household’s customs into account. Standard methods of optimizing the operation of micro-CHP units are mostly based on deterministic optimization models, which neglect the lack of perfect information in reality (cf. e.g. Hawkes, Aguiar, Hernandez-Aramburo, Leach, Brandon et al., 2006; Oh, Kim, Oh, & Kwak, 2012; Pehnt, Mellwig, Steinborn, Lehr, Lutz et al., 2012). Therefore, without additional effort, they are not suited for the online optimization of the operating strategy. Extended by an adaptive method of load forecasting in the first stage, delivering the most likely single realization (so called point forecast) of the short-term development of the household’s demand, however, the optimization methods may also be used online. Successful works are presented in Thoma (2007); Wille-Haussmann, Erge, and Wittwer (2010) on a more aggregated level and in Cho, Luck, Eksioglu, and Chamra (2009); Collazos, Marechal, and Gähler (2009); Yun, Cho, Luck, and Mago (2011) for single households. The latter works, however, are non-generic at least referring to the households considered, as they are based on detailed building models which are highly complex to implement for every household under consideration. Besides, some works (Boait, Rylatt, & Stokes, 2006; Hawkes & Leach, 2007) could be identified, which try to implement rule-based control, which, however, is also fairly limited to the special circumstances assumed in the development process. Other authors developed methods for scheduling interconnected fleets of micro-CHP units (e.g. Bosman, Bakker, Molderink, Hurink, & Smit, 2012; Hu, Weir, & Wu, 2010) and large CHP power plants (e.g. Rong, Hakonen, & Lahdelma, 2008a; Rong & Lahdelma, 2007; Rong, Lahdelma, & Luh, 2008a,b).

Closely connected to our problem setting is classical literature for unit commitment problems, which, however, mostly deals with larger energy systems and multiple units with heterogeneous characteristics regarding outputs and flexibility, that apply a multitude of different methods (cf. Padhy, 2004; Sheble & Fahd, 1994). An extensive overview of works focusing on the short-term operation planning on cogeneration systems can be found in Salgado and Pedrero (2008), where the authors argue that the scheduling problem is frequently addressed in the form of a mixed-integer programming (MIP) problem. In addition, several works regarding unit commitment can be found, which account for demand uncertainties by using multi-stage stochastic programming methods separating decisions into long-term policies and short-term corrective actions, e.g. Carøe and Schultz (1998); Handschin, Neise, Neumann, and Schultz (2006); Nowak and Römisch (2000). Due to the computational effort, decomposition techniques like those described in Carøe and Schultz (1999) are frequently used. More methodological aspects are addressed in Ruszczynski and Shapiro (2003); Sahinidis (2004), for example. Further work regarding unit commitment applies stochastic multi-objective models (Chang & Fu, 1998), chance-constrained programming techniques (Ozturk, Mazumdar, & Norman, 2004), and multi-objective particle swarm optimization (Wang & Singh, 2008).

An optimized operation of independent decentralized systems, such as the PEMFC micro-CHP unit investigated in our case study, is a highly complex problem (cf. Kim & Edgar, 2014; Rieder, Christidis, & Tsatsaronis, 2014 and Section 5). However, our units are equipped neither with powerful computers nor with sophisticated solver software. Hence, our goal is to provide for an encapsulated modeling approach which tackles the problems described in a computationally manageable way without requiring additional computing power and also satisfying the need of incorporating demand uncertainties. The methodological approach used in our case study focuses on applicable integrated methods to find a cost-minimized schedule for both the operation of a given domestic PEMFC micro-CHP unit and the charging of an EV. In a preliminary step, this is achieved by load forecasting for each individual household and deterministic optimization methods based on these individual point forecasts. The methodological approach is also outlined in Fig. 1.
                     

The first task is to address household-specific demand uncertainties, which is achieved by using a short-term load forecasting (STLF) approach based on the neuro-fuzzy model ANFIS (adaptive network based fuzzy inference system) (Jang, 1993). It is aimed at overcoming the lack of perfect information regarding near-future (day-ahead) demand patterns in reality by daily generating household individual (thermal and electric) point forecasts based on both historic data and exogenous influencing factors (weather, type of day, holiday indicator, etc.). Hence, the STLF approach addresses the uncertainties already in a preliminary stage, which keeps the following optimization manageable even in highly decentralized systems with low computing power and avoids the use of computationally expensive stochastic programming methods which would also cause the forecasting procedure to be much more complex. Our problem-specific implementation of ANFIS is described in Schönfelder, Jochem, and Fichtner (2012). Various other works successfully use ANFIS (cf. e.g. Ying & Pan, 2008; Yun, Quan, Caixin, Shaolan, Yumin, & Yang, 2008) or other methods, such as neural networks (Hsu & Chen, 2003) or support vector machines (Pai & Hong, 2005) for STLF purposes, mostly on a more aggregated level.

The second task of our methodological approach is to create the optimized operation and charging schedules based on forecasted demand patterns. For this purpose, an MILP (cf. Section 3.1) is defined and implemented in a rolling window optimization fashion (cf. Section 3.2). Due to the common lack of sophisticated solver software in embedded systems, an additional algorithmic approach is developed, which is easy to implement and less computationally expensive than the optimization approach (cf. Section 4). Consequently, it is better suited for the direct integration into real applications. Both methods integrate (energetic) model-endogenous simulation to fix storage levels deviating from reality in case of the occurrence of thermal forecasting errors after each iteration. This procedure is not necessary in reality, because the actual storage level can be measured directly before each iteration of the optimization. Due to the at least near-optimal solution generated by the MILP, it can also serve as a benchmark for the algorithmic approach. Furthermore, both methods can be also used with actual demand patterns instead of forecasted ones to define an upper bound for achievable savings for both of the optimization methods used (benchmark solution).

Final results for each method are obtained in a third step by simulation runs in which the application of optimized schedules
                              1
                           
                           
                              1
                              Schedules are optimized under partly uncertain demand conditions, if forecasted demand data are used. If actual demand data are used, the results of the simulation give an upper bound for the savings which may be generated by the optimization method applied.
                            is simulated using actual demand patterns. Therefore, simulation represents the performance which could have been reached in an actual application. The simulation also includes rule-based application of short-term corrective actions, such as additional use of the backup (peak load) system in case of unforeseen thermal shortages or emergency shutdowns of the micro-CHP unit, if the thermal buffer storage system is filled unexpectedly, which very rarely happens due to forecasting errors (max. five times per year in our analysis). Hence, the simulation also represents online control in reality. To further improve the accuracy of simulation, actual demand patterns are synthesized to a temporal resolution of 1 minute (maintaining the boundary conditions given by the real demand patterns and using profiles in high resolution from VDI, 2008). This corrects averaging effects due to the use of discrete demand data in larger temporal resolution (cf. Section 3).

As a synopsis, the methods are finally compared with respect to their economic results within the framework of our case study (cf. Section 5). The results are additionally assessed with respect to their solutions’ quality depending on the method and quality of information (use of actual vs. forecasted demand patterns). Section 6 concludes our findings and gives a critical review of our work.

The following section describes different approaches to scheduling micro-CHP units and their usability in real applications with the focus on PEMFC units. At first, we introduce the heat-led strategy, which serves together with equalized EV charging as the reference case in our case study.

In the case of a heat-led strategy, the operation of the micro-CHP unit is solely triggered by the thermal load of the building in which the unit is located. Assuming the presence of a thermal storage system, the signal for starting the operation of the CHP-unit is the drop of the thermal storage temperature below a specified lower temperature limit. Then, the unit works until the storage temperature reaches a specified upper limit again.

The heat-led strategy is the most common operating strategy of micro-CHP units today (Schönfelder, 2013), as it meets the primary goal of covering the household’s thermal demand rather than delivering electricity to it. However, the legal situation in Germany favors own consumption of self-produced electricity in a direct (CHP bonus payment) and an indirect way (feed-in tariffs below purchase price of electricity) (Federal Republic of Germany, 2012).

The economically optimized operating strategy is to provide for the supply of a local building with thermal energy and electricity at minimum total operation costs.
                           2
                        
                        
                           2
                           Simply following the local electric load with the electric output power of the micro-CHP unit is, however, not possible due to technical reasons (Thomas, 2011).
                         The main variables of the optimization are the electrical and thermal output power of the micro-CHP unit at each time step t within the period under consideration T. Several parameters may be defined within an optimization model, such as variable electricity prices and feed-in tariffs, varying fuel prices, and technical restrictions of the unit like maximum cycles per time period, minimum up- and downtimes, ramp rates, and efficiency functions. However, as regards the level of technical detailing, a good compromise between accuracy of the results and the duration of the optimization has to be found in order to allow for an application in reality.

Apart from the parameters mentioned, the knowledge of the future temporal development of thermal and electrical demand of the considered household is crucial for the optimization. This is a major problem in practice, as these values vary as a function of the day, time, habits of the occupants, and many other properties of the household. Due to the lack of information, the cost-minimized strategy is often proclaimed in literature (Hawkes et al., 2006; Oh et al., 2012) but not yet implemented in practice. Our approach to STLF is based on demand patterns forecasted by our neuro-fuzzy model ANFIS. All parameters of the adaptive nodes are part of the fuzzy inference system and modifiable during the learning procedure. As the accuracy of STLF increases with decreasing time horizon and term of the learning data, one iteration (learning based on recent load profiles and forecast of future load profile) per day seems to be suitable for our application. The scope of each forecasting iteration is at least 2 days. We use a multi-model approach (Hippert, Pedreira, & Souza, 2001) with separate models for each type of day (regular working days, Fridays, Saturdays, Sundays, holidays). Training is based on historic data collected iteratively after the system’s installation. The scope of the training data set was determined by sensitivity analyses and is 12 days of the same type per model in our examples. More detailed information on our forecast model is given by Schönfelder (2013) and Schönfelder et al. (2012).

The economically optimized operation of the CHP unit under consideration is defined to be the strategy with minimal operating costs that respects all techno-economic constraints. For the determination of the optimal unit operation, we use initially an MILP. The objective function comprises all relevant economic factors which are influenced by unit operation. The driving force of the MILP is (forecasted) local demand for thermal energy and electricity. Further constraints are formulated regarding technical properties of the PEMFC micro-CHP unit below. An outline of the system is given in Fig. 2 and a comprehensive description can be found in Schönfelder (2013).

The following notations are introduced to formulate the problem.


                        
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          
                                             Variables
                                          
                                       
                                       
                                    
                                    
                                       
                                          
                                             
                                                B
                                                
                                                   1
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                          
                                       
                                       (
                                             
                                                B
                                                
                                                   2
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                          ) binary variable for the first (second) operating point of CHP in 
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                B
                                                
                                                   t
                                                
                                                on
                                             
                                          
                                       
                                       binary variable indicating unit startup in 
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                B
                                                
                                                   t
                                                
                                                off
                                             
                                          
                                       
                                       binary variable indicating unit shutdown in 
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                B
                                                
                                                   t
                                                
                                                c
                                             
                                          
                                       
                                       binary variable for counting operation cycles of CHP
                                    
                                    
                                       
                                          
                                             C
                                          
                                       
                                       total costs for household supply during T (€ )
                                    
                                    
                                       
                                          
                                             
                                                D
                                                t
                                                EV
                                             
                                          
                                       
                                       electric demand of the EV in 
                                             t
                                           (kilowatt-hour)
                                    
                                    
                                       
                                          
                                             
                                                F
                                                
                                                   ec
                                                   ,
                                                   t
                                                
                                                
                                                   u
                                                   ,
                                                   
                                                      u
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       energy/material flow of 
                                             
                                                e
                                                c
                                             
                                           from 
                                             
                                                u
                                                ∈
                                                U
                                             
                                           to 
                                             
                                                
                                                   u
                                                   ′
                                                
                                                ∈
                                                U
                                             
                                           in 
                                             t
                                           (kilowatt-hour)
                                    
                                    
                                       
                                          
                                             
                                                L
                                                
                                                   th
                                                   ,
                                                   t
                                                
                                                TS
                                             
                                          
                                       
                                       level of thermal storage 
                                             TS
                                           in 
                                             t
                                           (kilowatt-hour)
                                    
                                    
                                       
                                          
                                             
                                                S
                                                
                                                   ec
                                                   ,
                                                   t
                                                
                                                node
                                             
                                          
                                       
                                       energy supply 
                                             ec
                                           in 
                                             t
                                           at node 
                                             node
                                           (kilowatt-hour)
                                    
                                 
                              
                           
                        
                     


                        
                           
                              
                                 
                                 
                                 
                                    
                                       
                                       
                                    
                                    
                                       
                                          
                                             Parameters
                                          
                                       
                                       
                                    
                                    
                                       
                                          
                                             
                                                η
                                                ec
                                                u
                                             
                                          
                                       
                                       process efficiency at node 
                                             u
                                           regarding 
                                             ec
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   B
                                                   ¯
                                                
                                                c
                                             
                                          
                                       
                                       maximum count of cycles per time period
                                    
                                    
                                       
                                          
                                             
                                                D
                                                
                                                   ec
                                                   ,
                                                   t
                                                
                                             
                                          
                                       
                                       demand for energy carrier 
                                             ec
                                           in time step 
                                             t
                                           (kilowatt-hour)
                                    
                                    
                                       
                                          
                                             
                                                h
                                                t
                                             
                                          
                                       
                                       length of each time step 
                                             t
                                           (hour)
                                    
                                    
                                       
                                          
                                             
                                                τ
                                                ̲
                                             
                                          
                                       
                                       minimum downtime of the unit (given as number of timesteps)
                                    
                                    
                                       
                                          
                                             
                                                τ
                                                ¯
                                             
                                          
                                       
                                       minimum uptime of the unit (given as number of timesteps)
                                    
                                    
                                       
                                          
                                             
                                                P
                                                ec
                                                
                                                   u
                                                   ,
                                                   max
                                                
                                             
                                          
                                       
                                       maximum power at node 
                                             u
                                           regarding 
                                             ec
                                           (kilowatt)
                                    
                                    
                                       
                                          
                                             
                                                p
                                                
                                                   ec
                                                   ,
                                                   t
                                                
                                             
                                          
                                       
                                       price of 
                                             ec
                                           in 
                                             t
                                           (€ /kilowatt-hour)
                                    
                                    
                                       
                                          
                                             ρ
                                          
                                       
                                       power to heat ratio
                                    
                                    
                                       
                                          
                                             
                                                σ
                                                
                                                   ec
                                                   ,
                                                   type
                                                   ,
                                                   t
                                                
                                             
                                          
                                       
                                       subsidy 
                                             type
                                           regarding 
                                             ec
                                           in 
                                             t
                                           (€ /kilowatt-hour)
                                    
                                 
                              
                           
                        
                     


                        
                           
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       
                                          
                                             Indexes
                                          
                                       
                                       
                                       
                                          
                                             Nodes
                                          
                                       
                                       
                                    
                                    
                                       
                                          
                                             ec
                                          
                                       
                                       energy carrier
                                       
                                          
                                             BS
                                          
                                       
                                       thermal backup system
                                    
                                    
                                       
                                          
                                             el
                                          
                                       
                                       electric
                                       
                                          
                                             D
                                          
                                       
                                       demand node
                                    
                                    
                                       
                                          
                                             fit
                                          
                                       
                                       feed-in tariff
                                       
                                          
                                             EV
                                          
                                       
                                       electric vehicle
                                    
                                    
                                       
                                          
                                             ng
                                          
                                       
                                       natural gas
                                       
                                          
                                             CHP
                                          
                                       
                                       PEMFC micro-CHP unit
                                    
                                    
                                       
                                          
                                             oc
                                          
                                       
                                       own consumption
                                       
                                          
                                             Gr
                                          
                                       
                                       electricity grid
                                    
                                    
                                       
                                          
                                             sl
                                          
                                       
                                       charging slot (EV)
                                       
                                          
                                             NG
                                          
                                       
                                       natural gas source
                                    
                                    
                                       
                                          
                                             st
                                          
                                       
                                       start
                                       
                                          
                                             TS
                                          
                                       
                                       thermal buffer storage
                                    
                                    
                                       
                                          
                                             stp
                                          
                                       
                                       stop
                                       
                                          
                                             Index sets
                                          
                                       
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                       
                                       time step
                                       
                                          
                                             EC
                                          
                                       
                                       set of energy carriers 
                                             ec
                                          
                                       
                                    
                                    
                                       
                                          
                                             tax
                                          
                                       
                                       energy taxes
                                       
                                          
                                             T
                                          
                                       
                                       set of time steps 
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             th
                                          
                                       
                                       thermal
                                       
                                          
                                             SL
                                          
                                       
                                       set of charging slots 
                                             sl
                                          
                                       
                                    
                                    
                                       
                                          
                                             u
                                          
                                       
                                       node
                                       
                                          
                                             U
                                          
                                       
                                       set of nodes 
                                             u
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Then the MILP can be formulated as follows.

                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                          
                                             min
                                             C
                                             =
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               F
                                                               
                                                                  ng
                                                                  ,
                                                                  t
                                                               
                                                               
                                                                  NG
                                                                  ,
                                                                  BS
                                                               
                                                            
                                                            ·
                                                            
                                                               p
                                                               
                                                                  ng
                                                                  ,
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         +
                                                      
                                                      
                                                         
                                                            
                                                               F
                                                               
                                                                  ng
                                                                  ,
                                                                  t
                                                               
                                                               
                                                                  NG
                                                                  ,
                                                                  CHP
                                                               
                                                            
                                                            ·
                                                            
                                                               p
                                                               
                                                                  ng
                                                                  ,
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         +
                                                      
                                                      
                                                         
                                                            
                                                               F
                                                               
                                                                  el
                                                                  ,
                                                                  t
                                                               
                                                               
                                                                  Gr
                                                                  ,
                                                                  D
                                                               
                                                            
                                                            ·
                                                            
                                                               p
                                                               
                                                                  el
                                                                  ,
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                      
                                                      
                                                         
                                                            
                                                               F
                                                               
                                                                  el
                                                                  ,
                                                                  t
                                                               
                                                               
                                                                  CHP
                                                                  ,
                                                                  Gr
                                                               
                                                            
                                                            ·
                                                            
                                                               σ
                                                               
                                                                  el
                                                                  ,
                                                                  fit
                                                                  ,
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                      
                                                      
                                                         
                                                            
                                                               F
                                                               
                                                                  el
                                                                  ,
                                                                  t
                                                               
                                                               
                                                                  CHP
                                                                  ,
                                                                  D
                                                               
                                                            
                                                            ·
                                                            
                                                               σ
                                                               
                                                                  el
                                                                  ,
                                                                  oc
                                                                  ,
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                      
                                                      
                                                         
                                                            
                                                               F
                                                               
                                                                  ng
                                                                  ,
                                                                  t
                                                               
                                                               
                                                                  NG
                                                                  ,
                                                                  CHP
                                                               
                                                            
                                                            ·
                                                            
                                                               σ
                                                               
                                                                  ng
                                                                  ,
                                                                  tax
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                F
                                                
                                                   th
                                                   ,
                                                   t
                                                
                                                
                                                   TS
                                                   ,
                                                   D
                                                
                                             
                                             +
                                             
                                                F
                                                
                                                   th
                                                   ,
                                                   t
                                                
                                                
                                                   CHP
                                                   ,
                                                   D
                                                
                                             
                                             =
                                             
                                                D
                                                
                                                   th
                                                   ,
                                                   t
                                                
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                F
                                                
                                                   el
                                                   ,
                                                   t
                                                
                                                
                                                   CHP
                                                   ,
                                                   D
                                                
                                             
                                             +
                                             
                                                F
                                                
                                                   el
                                                   ,
                                                   t
                                                
                                                
                                                   Gr
                                                   ,
                                                   D
                                                
                                             
                                             −
                                             
                                                D
                                                t
                                                EV
                                             
                                             =
                                             
                                                D
                                                
                                                   el
                                                   ,
                                                   t
                                                
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   
                                                      T
                                                      sl
                                                   
                                                
                                             
                                             
                                                D
                                                t
                                                EV
                                             
                                             =
                                             
                                                D
                                                sl
                                                EV
                                             
                                             
                                             ∀
                                             sl
                                             ∈
                                             SL
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       L
                                       
                                          th
                                          ,
                                          t
                                       
                                       TS
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      L
                                                      
                                                         th
                                                         ,
                                                         t
                                                         −
                                                         1
                                                      
                                                      TS
                                                   
                                                   ·
                                                   
                                                      η
                                                      st
                                                      TS
                                                   
                                                   +
                                                   
                                                      F
                                                      
                                                         th
                                                         ,
                                                         t
                                                      
                                                      
                                                         CHP
                                                         ,
                                                         TS
                                                      
                                                   
                                                   ·
                                                   
                                                      η
                                                      in
                                                      TS
                                                   
                                                
                                             
                                          
                                          
                                             
                                                +
                                             
                                             
                                                
                                                   
                                                      F
                                                      
                                                         th
                                                         ,
                                                         t
                                                      
                                                      
                                                         BS
                                                         ,
                                                         TS
                                                      
                                                   
                                                   ·
                                                   
                                                      η
                                                      in
                                                      TS
                                                   
                                                   −
                                                   
                                                      F
                                                      
                                                         th
                                                         ,
                                                         t
                                                      
                                                      
                                                         TS
                                                         ,
                                                         D
                                                      
                                                   
                                                   /
                                                   
                                                      η
                                                      out
                                                      TS
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                    ∀
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                L
                                                
                                                   th
                                                   ,
                                                   t
                                                
                                                TS
                                             
                                             ≤
                                             
                                                L
                                                th
                                                
                                                   TS
                                                   ,
                                                   max
                                                
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                L
                                                
                                                   th
                                                   ,
                                                   t
                                                
                                                TS
                                             
                                             ≥
                                             
                                                L
                                                th
                                                
                                                   TS
                                                   ,
                                                   min
                                                
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                S
                                                
                                                   ec
                                                   ,
                                                   t
                                                
                                                u
                                             
                                             ·
                                             
                                                h
                                                t
                                                
                                                   −
                                                   1
                                                
                                             
                                             ≤
                                             
                                                P
                                                ec
                                                
                                                   u
                                                   ,
                                                   max
                                                
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             ,
                                             ∀
                                             u
                                             ∈
                                             U
                                             ,
                                             ∀
                                             ec
                                             ∈
                                             EC
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                D
                                                t
                                                EV
                                             
                                             ·
                                             
                                                h
                                                t
                                                
                                                   −
                                                   1
                                                
                                             
                                             ≤
                                             
                                                P
                                                el
                                                
                                                   EV
                                                   ,
                                                   max
                                                
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                S
                                                
                                                   ec
                                                   ,
                                                   t
                                                
                                                u
                                             
                                             =
                                             
                                                ∑
                                                
                                                   
                                                      u
                                                      ′
                                                   
                                                   ∈
                                                   U
                                                
                                             
                                             
                                                F
                                                
                                                   ec
                                                   ,
                                                   t
                                                
                                                
                                                   u
                                                   ,
                                                   
                                                      u
                                                      ′
                                                   
                                                
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             ,
                                             ∀
                                             u
                                             ∈
                                             U
                                             ,
                                             ∀
                                             ec
                                             ∈
                                             EC
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                S
                                                
                                                   el
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             +
                                             
                                                S
                                                
                                                   th
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             =
                                             
                                                η
                                                tot
                                                CHP
                                             
                                             ·
                                             
                                                F
                                                
                                                   ng
                                                   ,
                                                   t
                                                
                                                
                                                   NG
                                                   ,
                                                   CHP
                                                
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                S
                                                
                                                   th
                                                   ,
                                                   t
                                                
                                                BS
                                             
                                             =
                                             
                                                η
                                                th
                                                BS
                                             
                                             ·
                                             
                                                F
                                                
                                                   ng
                                                   ,
                                                   t
                                                
                                                
                                                   NG
                                                   ,
                                                   BS
                                                
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               P
                                                               
                                                                  el
                                                                  ,
                                                                  1
                                                               
                                                               CHP
                                                            
                                                            ·
                                                            
                                                               B
                                                               
                                                                  1
                                                                  ,
                                                                  t
                                                               
                                                               CHP
                                                            
                                                            +
                                                            
                                                               P
                                                               
                                                                  el
                                                                  ,
                                                                  2
                                                               
                                                               CHP
                                                            
                                                            ·
                                                            
                                                               B
                                                               
                                                                  2
                                                                  ,
                                                                  t
                                                               
                                                               CHP
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             ·
                                             
                                                h
                                                t
                                             
                                             =
                                             
                                                S
                                                
                                                   el
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                S
                                                
                                                   el
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             =
                                             
                                                S
                                                
                                                   th
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             ·
                                             ρ
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                B
                                                
                                                   1
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             +
                                             
                                                B
                                                
                                                   2
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             ≤
                                             1
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                B
                                                
                                                   t
                                                
                                                on
                                             
                                             −
                                             
                                                B
                                                
                                                   t
                                                
                                                off
                                             
                                             =
                                             
                                                (
                                                
                                                   B
                                                   
                                                      1
                                                      ,
                                                      t
                                                   
                                                   CHP
                                                
                                                +
                                                
                                                   B
                                                   
                                                      2
                                                      ,
                                                      t
                                                   
                                                   CHP
                                                
                                                )
                                             
                                             −
                                             
                                                (
                                                
                                                   B
                                                   
                                                      1
                                                      ,
                                                      t
                                                      −
                                                      1
                                                   
                                                   CHP
                                                
                                                +
                                                
                                                   B
                                                   
                                                      2
                                                      ,
                                                      t
                                                      −
                                                      1
                                                   
                                                   CHP
                                                
                                                )
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                {
                                                T
                                                |
                                                t
                                                >
                                                1
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                B
                                                
                                                   t
                                                
                                                on
                                             
                                             +
                                             
                                                B
                                                
                                                   t
                                                
                                                off
                                             
                                             ≤
                                             1
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   
                                                      t
                                                      st
                                                   
                                                
                                                
                                                   
                                                      t
                                                      st
                                                   
                                                   +
                                                   
                                                      τ
                                                      ¯
                                                   
                                                   −
                                                   1
                                                
                                             
                                             
                                                B
                                                
                                                   1
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             +
                                             
                                                B
                                                
                                                   2
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             ≥
                                             
                                                τ
                                                ¯
                                             
                                             
                                             ∀
                                             
                                                t
                                                st
                                             
                                             :
                                             
                                                B
                                                
                                                   
                                                      t
                                                      st
                                                   
                                                
                                                on
                                             
                                             =
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   
                                                      t
                                                      stp
                                                   
                                                
                                                
                                                   
                                                      t
                                                      stp
                                                   
                                                   +
                                                   
                                                      τ
                                                      ̲
                                                   
                                                   −
                                                   1
                                                
                                             
                                             1
                                             −
                                             
                                                B
                                                
                                                   1
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             −
                                             
                                                B
                                                
                                                   2
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             ≥
                                             
                                                τ
                                                ̲
                                             
                                             
                                             ∀
                                             
                                                t
                                                stp
                                             
                                             :
                                             
                                                B
                                                
                                                   
                                                      t
                                                      stp
                                                   
                                                
                                                off
                                             
                                             =
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                B
                                                
                                                   t
                                                
                                                c
                                             
                                             ≤
                                             
                                                
                                                   B
                                                   ¯
                                                
                                                c
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                S
                                                
                                                   ec
                                                   ,
                                                   t
                                                
                                                u
                                             
                                             ,
                                             
                                                F
                                                
                                                   e
                                                   c
                                                   ,
                                                   t
                                                
                                                
                                                   u
                                                   ,
                                                   
                                                      u
                                                      ′
                                                   
                                                
                                             
                                             ,
                                             
                                                D
                                                t
                                                EV
                                             
                                             ∈
                                             
                                                R
                                                +
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             ,
                                             ∀
                                             u
                                             ,
                                             
                                                u
                                                ′
                                             
                                             ∈
                                             U
                                             ,
                                             ∀
                                             ec
                                             ∈
                                             EC
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             
                                                B
                                                
                                                   t
                                                
                                                on
                                             
                                             ,
                                             
                                                B
                                                
                                                   t
                                                
                                                off
                                             
                                             ,
                                             
                                                B
                                                
                                                   1
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             ,
                                             
                                                B
                                                
                                                   2
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             ,
                                             
                                                B
                                                
                                                   t
                                                
                                                c
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The objective function of the MILP (Eq. (1)) minimizes the sum of all system-relevant costs of the operator in each time step t ∈ T, where T is the set of all time steps within the time horizon. Energy flows are denoted as 
                           
                              
                                 F
                                 
                                    e
                                    c
                                    ,
                                    t
                                 
                                 
                                    u
                                    ,
                                    
                                       u
                                       ′
                                    
                                 
                              
                              ,
                           
                         where ec ∈ EC indicates the energy carrier (ng = natural gas, el = electricity, th = thermal energy). The model’s nodes to which the superscripts u, u′ ∈ U of energy flows refer are NG for the natural gas source, Gr for the electricity grid, BS for the backup system, CHP for the PEMFC micro-CHP unit, TS for the thermal storage system, EV for the electric vehicle, and D for the demand. Time-flexible prices of energy carriers are labeled p
                        
                           ec, t
                         and specific subsidies from the operation of the unit are referred to as σ
                        
                           ec, type, t
                         (type: oc = own consumption, fit = feed-in tariff, tax = tax savings). The operation of the micro-CHP unit is restricted in multiple respects. Besides the driving force of covering the thermal demand (constraint (2)), the model also has to ensure the coverage of the electrical demand either through local production or through the grid (constraint (3)). Concerning the demand restrictions, it is to be noted that the electrical demand of a possibly present EV 
                           
                              D
                              t
                              EV
                           
                         is not a parameter, but a decision variable. Constraint (4) makes the model shift the charging process of the vehicle in an optimal manner with respect to individual temporal limits of each charging slot sl ∈ SL = {sl
                        1, …, sln
                        } while covering the slot demand 
                           
                              D
                              sl
                              
                                 E
                                 V
                              
                           
                        . The total charging demand 
                           
                              D
                              sl
                              
                                 E
                                 V
                              
                           
                         of each charging slot sl ∈ SL as well as the individually associated quantity of time steps Tsl
                         are exogenous parameters.

Thermal demands may be covered directly or through the storage system TS. The model has to consider both the upper and lower (energetic) limit of the storage level (constraints (6) and (7)) as well as the (dis-)charging rate and storage efficiency (
                           
                              η
                              
                                 in
                                 /
                                 out
                              
                              TS
                           
                         and 
                           
                              η
                              st
                              TS
                           
                        ) according to constraint (5). The output power of the thermal storage system is not restricted due to the assumption that it is designed to meet the maximum thermal loads in the considered household.

Technical restrictions are defined regarding the power constraints of the micro-CHP unit and the backup system (constraint (8)) as well as in terms of maximum EV charging power (constraint (9)) for all time steps under consideration of time step’s duration ht
                        . Further technical and physical constraints are subject to the energy and material balances for all nodes u and each energy carrier (constraint (10)).

A major cost driver is fuel consumption that depends on the operation and the efficiency 
                           
                              η
                              tot
                              CHP
                           
                         of the PEMFC micro-CHP and the backup system (constraints (11) and (12)). Due to the limited flexibility of PEMFC micro-CHP units, it is assumed that the unit allows for two fixed operating points (for our reference system these are 50 percent and 100 percent of nominal electrical power) apart from being switched off (constraint (13)). For modeling, binary variables 
                           
                              B
                              
                                 1
                                 ,
                                 t
                              
                              CHP
                           
                         and 
                           
                              B
                              
                                 2
                                 ,
                                 t
                              
                              CHP
                           
                         are implemented. The assumption of a fixed relation of electrical to thermal power (power to heat ratio (ρ), constraint (14)) leads to the simplification that it is sufficient to limit the process level of one output energy carrier only (constraint (15)). Of course, these constraints can be adjusted easily when other micro-CHP technologies are studied.

The technological based minimum up- (
                           
                              τ
                              ¯
                           
                        ) and downtimes ( 
                           τ
                         ) of the PEMFC micro-CHP are defined in constraints (18) and (19) with the help of the binary variables 
                           
                              B
                              
                                 t
                              
                              on
                           
                         and 
                           
                              B
                              
                                 t
                              
                              off
                           
                         indicating the start (in t = tst
                        ) and stop (in t = tstp
                        ) of the CHP operation (constraints (16) and (17)). Because minimum downtimes of the PEMFC micro-CHP are very low ( 
                           τ
                         = 1) (cf. Wakui & Yokoyama, 2015), constraint (19) was never binding. Therefore, we do not consider minimum downtimes 
                           τ
                         in the following. Additionally, the technical restricted maximum number of cycles 
                           
                              
                                 B
                                 ¯
                              
                              c
                           
                         is considered where one cycle is defined as switch-on and complete switch-off (
                           
                              B
                              
                                 t
                              
                              c
                           
                        ) (constraint (20)).

In the real application of the optimization problem defined in the previous section, several special circumstances have to be considered. First, there is a considerable uncertainty regarding the future demand patterns of the household in which the PEMFC micro-CHP unit is located. This is addressed via the household individual load forecast (cf. Section 2.2). However, even when utilizing point forecasting methods, there is only a short time horizon in which the demand is approximately known. Second, in case of an implementation of the methods described in an embedded system (preferably at low costs), limited computing power must be expected. This is mainly due to the goal of not significantly increasing the necessary investments for unit control. The solution of both problems is to perform the optimization in a repeated manner, e.g. once per day. This leads to permanently updated demand data and to a decreasing problem size (depending on the time horizon chosen). Technically, this way of optimizing corresponds to a time-based decomposition of the global optimization into several static sub-problems (Bassett, Pekny, & Reklaitis, 1996). Other decomposition techniques, e.g. disassembling the problem into multiple stages (cf. Section 4), are likely to have higher negative effects, because the interdependencies between all parts of the problems are considerably strong. Also the global optimization for 1 year would neither be reasonable due to lacking information nor practicable, because the number of binaries (more than 140,000 binaries for 1 year in quarter-hourly resolution) would exceed common computing resources.

In connection with the given type of problem, there are two different ways of time-based decomposition:

                           
                              (1)
                              Construct several static and distinct sub-problems, e.g. daily optimization with the data of 1 day, or

construct several overlapping sub-problems, e.g. daily optimization with a time horizon longer than 1 day.

Alternative (1) corresponds to the so-called myopic optimization (Ball, 2006; Chu, 1995; Babrowski, Heffels, Jochem, & Fichtner, 2014) which neglects any data beyond the time horizon for which the operation is to be optimized. Hence, any influence of future demand patterns is ignored, which will obviously lead to suboptimal behavior in the sense of the global problem. For example, the optimization might stop CHP operation as soon as all remaining thermal loads can be covered by the storage system, which leads to thermal shortages at the very beginning of the following day. However, in Chu (1995) some other cases are discussed, in which a myopic approach does lead to global optimality or at least to the so-called near-optimality. Another problem of the myopic approach is that a small time window might cause infeasibilities although the global problem actually has feasible solutions (Bassett et al., 1996).

Alternative (2) describes the principle of a rolling window optimization (also called receding horizon optimization). Every sub-problem comprises several days and determines optimal operation for the given time horizon. However, only the schedule of the actual day remains as a fixed solution and the subsequent sub-problem will partly overwrite the solution determined the day before. Hence, consistency is achieved, because each optimization also takes future demand patterns into account (at least to the extent these are already known). The principle of rolling window optimization has been widely and successfully used in many areas (Li & Ierapetritou, 2010; Ovacik & Uzsoy, 1994; Zhang, Xi, & Gu, 2007). An extensive overview and classification of works on rolling window optimization and control is given in Chand, Hsu, and Sethi (2002).

Due to the necessity of binary variables in the optimization model, the time and algorithmic effort to solve the model increase significantly compared to a purely linear problem. As the objective is to provide for an approach which is easily transferable to real applications, however, a simpler approach is desirably. Moreover, the long-term objective of an embedded system at low costs, which schedules the operation of the PEMFC micro-CHP unit, is associated with limited computing power and a lack of sophisticated solver
                        3
                     
                     
                        3
                        Open-source solvers could, however, be used if sufficient computing power was given.
                      software in real applications. Therefore, we developed a two-stage algorithm, which allows for the computation of a good operating strategy in a daily repeated manner, is easy to implement, and modest regarding the necessary computing power. In Section 5 the results of both approaches (MILP and two-stage algorithm) are compared. Like the MILP, the two-stage algorithm can be used as a myopic or n-day rolling window approach (cf. Section 3). The first stage of the algorithm is to determine an improved operation of the PEMFC micro-CHP unit (Section 4.1). The second stage assigns an economically improved charging strategy for an EV. A complete integration of both scheduling tasks (micro-CHP and charging of EV) in one single stage is not reasonable in the algorithmic approach, as this would significantly increase the iterations necessary to compute a feasible solution.

The algorithm is designed to use the household individual load forecasts based on ANFIS (cf. Section 2.2). To also demonstrate the unaltered quality of results, however, besides forecasted demand patterns, also perfectly known actual data is used in the later analysis. This enables a detailed comparison of all variants and, hence, investigating both the influences of forecasting errors and the quality of the algorithm in comparison to the MILP. Furthermore, all techno-economic constraints described in Section 3.1 are fully integrated in the algorithmic approach, although they are partly not mentioned again in the following sections. The following notations are used in the algorithm.


                     
                        
                           b
                        
                        
                           time block of CHP operation

level of CHP-operation

set of days per iteration

thermal demand in t (kilowatt-hour)

electric demand in t (kilowatt-hour)

total EV electric demand in sl
                           

electric demand of EV in t (kilowatt-hour)

min. EV electric demand for each t
                           

max. EV electric demand for each t
                           

length of time step t (hour)

level of thermal storage in t (kilowatt-hour)

max. level of thermal storage in t
                           

min. level of thermal storage in t
                           

min. operating time of CHP (hour)

electricity price in t (€ /kilowatt-hour)

electrical power of CHP at time t
                           

thermal power of CHP at time t
                           

max. thermal power of CHP (kilowatt)

rate of t (Del, t · pel, t
                              )

rate of block starting with tstb
                              
                           

highest rate of blocks considered

thermal supply by CHP in t (kilowatt-hour)

electrical supply by CHP in t (kilowatt-hour)

set of charging slots in T
                           

charging slots sl ∈ SL
                           

set of time steps t
                           

first t of block b
                           

last t of block b
                           

first t of slot sl
                           

last t of slot sl
                           

The algorithm’s first stage is designed to determine the daily operation of the PEMFC micro-CHP unit and consists of the mathematical implementation of rules which are easy to formulate in linguistic form. According to the number of days d considered and the applied temporal resolution of 15 minutes (ht
                         = 0.25h), the count of set members in set T equals to d · 96. Furthermore, in all calculations within our case study we use a 2-day rolling window (i.e. we consider the actual and the following day). However, the algorithm is also compatible with higher resolutions, e.g. 
                           
                              
                                 h
                                 t
                              
                              =
                              
                                 1
                                 60
                              
                              h
                           
                        .

In the following sections the variable 
                           
                              B
                              t
                              CHP
                           
                         represents the operation level of the CHP-unit. As valid points of operation, three different levels (0 percent, 50 percent, and 100 percent of maximum power) are assumed, which are represented by 
                           
                              
                                 B
                                 t
                                 CHP
                              
                              ∈
                              
                                 {
                                 0
                                 ,
                                 0.5
                                 ,
                                 1
                                 }
                              
                           
                        . The resulting electricity supply 
                           
                              S
                              
                                 el
                                 ,
                                 t
                              
                              CHP
                           
                         is then calculated depending on the maximum electric power of the unit 
                           
                              P
                              
                                 el
                                 ,
                                 t
                              
                              CHP
                           
                         and the length of the time steps ht
                         (Eq. (23)). Thermal supply 
                           
                              S
                              
                                 th
                                 ,
                                 t
                              
                              CHP
                           
                         is determined accordingly (Eq. (24)). Hence, 
                           
                              B
                              t
                              CHP
                           
                         also represents the fraction of full-load operation in time step t. The number of full-load hours can therefore be computed as 
                           
                              
                                 ∑
                                 
                                    t
                                    ∈
                                    T
                                 
                              
                              
                                 B
                                 t
                                 CHP
                              
                              ·
                              
                                 h
                                 t
                              
                           
                        .

                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             S
                                             
                                                el
                                                ,
                                                t
                                             
                                             CHP
                                          
                                       
                                       
                                          
                                             =
                                             
                                                B
                                                t
                                                CHP
                                             
                                             ·
                                             
                                                P
                                                
                                                   el
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             ·
                                             
                                                h
                                                t
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             S
                                             
                                                th
                                                ,
                                                t
                                             
                                             CHP
                                          
                                       
                                       
                                          
                                             =
                                             
                                                B
                                                t
                                                CHP
                                             
                                             ·
                                             
                                                P
                                                
                                                   th
                                                   ,
                                                   t
                                                
                                                CHP
                                             
                                             ·
                                             
                                                h
                                                t
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        The first step of the algorithm is to determine whether the thermal demand of the following time steps t ∈ T minus the current thermal storage level does exceed the maximum thermal supply of the micro-CHP unit (in Eq. (25)). If this is true, the unit is operated at maximum power for the next d · 96 hours (Eq. (26)). 
                           
                              L
                              
                                 th
                                 ,
                                 0
                              
                              TS
                           
                         is the storage level at the beginning of time step t = 1 and 
                           
                              L
                              th
                              
                                 TS
                                 ,
                                 min
                              
                           
                         is the minimum level of thermal storage in t. If additional thermal energy is needed temporarily, the backup system has to be put in operation as well (ensured with the last step of the algorithm).

                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             If
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         T
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         D
                                                         
                                                            th
                                                            ,
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      L
                                                      
                                                         th
                                                         ,
                                                         0
                                                      
                                                      TS
                                                   
                                                   +
                                                   
                                                      L
                                                      th
                                                      
                                                         TS
                                                         ,
                                                         min
                                                      
                                                   
                                                
                                                
                                                   P
                                                   th
                                                   
                                                      CHP
                                                      ,
                                                      max
                                                   
                                                
                                             
                                             >
                                             d
                                             ·
                                             96
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       
                                          
                                             then
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                B
                                                t
                                                CHP
                                             
                                             =
                                             1
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       
                                          
                                             else
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   B
                                                   ^
                                                
                                                t
                                                CHP
                                             
                                             =
                                             0
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        If the first condition is false, there are degrees of freedom in the unit’s operation. Hence, the stored operational values 
                           
                              
                                 B
                                 ^
                              
                              t
                              CHP
                           
                         are initialized as zero (Eq. (27)).

Now, it is to be checked whether a t
                        * ∈ T
                        * exists, in which a thermal energy shortage occurs. Accordingly, the whole considered time period is split up into (at least) two parts with part 1 ending in t
                        * (cf. expression (31)). Now, we compute a ranking of the technically valid temporal blocks of operation within this first part equal to the minimum operation time 
                           
                              τ
                              ¯
                           
                         (given as a number of time steps). The minimum downtime is not binding and therefore not considered here. As depicted above, minimum downtimes 
                           τ
                         of the PEMFC micro-CHP units are neglected here, as they are not relevant for this technology. The blockwise rates Rstb
                        , which are based on the stepwise rates Rt
                        , are derived as the sum of all time step’s rates, starting at time step 
                           
                              
                                 t
                                 
                                    s
                                    t
                                    b
                                 
                              
                              ∈
                              
                                 T
                                 ˜
                              
                           
                         with 
                           
                              
                                 T
                                 ˜
                              
                              =
                              
                                 {
                                 t
                                 ∈
                                 T
                                 |
                                 t
                                 +
                                 
                                    τ
                                    ¯
                                 
                                 ≤
                                 
                                    t
                                    *
                                 
                                 }
                              
                           
                         and ending at 
                           
                              
                                 t
                                 
                                    e
                                    b
                                 
                              
                              =
                              
                                 t
                                 
                                    s
                                    t
                                    b
                                 
                              
                              +
                              
                                 τ
                                 ¯
                              
                           
                        . The stepwise rates Rt
                         are defined as the product of the entire local electricity demand in time step t and the (possibly time-dependent) electricity price p
                        
                           el, t
                        . This considers already the simplified equalized electricity demand by EV during the charging slot (SL starting at time step tstsl
                         and ending at tesl
                        ) (cf. expression (34)). This way of deriving the stepwise rates ensures the compatibility of the algorithm with time-flexible electricity prices. Based on the block ranking of all eligible blocks in this first part of the considered time period, we choose the best rated one (maximum rate) to run the micro-CHP unit (expressions (32)–(37)). Hence, the variable 
                           
                              
                                 B
                                 t
                                 CHP
                              
                              ,
                           
                         indicating the operation level of the unit, is increased for the best rated block beginning in time step tstb
                         (
                           
                              B
                              t
                              CHP
                           
                         is restricted to a maximum value of 1). Then, the values of 
                           
                              B
                              t
                              CHP
                           
                         are stored to 
                           
                              
                                 B
                                 ^
                              
                              t
                              CHP
                           
                         and the procedure is repeated iteratively. The rates and ranks are updated before the next iteration until no further shortage occurs or no further degrees of freedom exist. The algorithm is not only able to add new blocks of operation, but also to extend those blocks already planned in previous steps (which then means a block of operation longer than 
                           
                              τ
                              ¯
                           
                        ). In case of missing degrees of freedom, the backup system is used to provide the thermal energy lacking (determined in the last step of the algorithm).

                           
                              (28)
                              
                                 
                                    
                                       
                                          
                                             Let
                                             
                                          
                                       
                                       
                                          
                                             
                                                T
                                                *
                                             
                                             =
                                             
                                                {
                                                t
                                                ∈
                                                T
                                                |
                                                
                                                   L
                                                   
                                                      th
                                                      ,
                                                      t
                                                   
                                                   TS
                                                
                                                −
                                                
                                                   L
                                                   th
                                                   
                                                      TS
                                                      ,
                                                      min
                                                   
                                                
                                                <
                                                
                                                   D
                                                   
                                                      th
                                                      ,
                                                      t
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             and
                                             
                                          
                                       
                                       
                                          
                                             
                                                T
                                                ˜
                                             
                                             =
                                             
                                                {
                                                t
                                                ∈
                                                T
                                                |
                                                t
                                                +
                                                
                                                   τ
                                                   ¯
                                                
                                                ≤
                                                
                                                   t
                                                   *
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       
                                          
                                             and
                                             
                                          
                                       
                                       
                                          
                                             S
                                             
                                                L
                                                *
                                             
                                             =
                                             
                                                {
                                                
                                                   s
                                                   l
                                                
                                                ∈
                                                
                                                   S
                                                   L
                                                
                                                |
                                                
                                                   t
                                                   
                                                      s
                                                      t
                                                      b
                                                   
                                                
                                                ≤
                                                
                                                   t
                                                   
                                                      s
                                                      t
                                                      s
                                                      l
                                                   
                                                
                                                ≤
                                                
                                                   t
                                                   
                                                      e
                                                      b
                                                   
                                                
                                                ∨
                                                
                                                   t
                                                   
                                                      s
                                                      t
                                                      b
                                                   
                                                
                                                ≤
                                                
                                                   t
                                                   
                                                      e
                                                      s
                                                      l
                                                   
                                                
                                                ≤
                                                
                                                   t
                                                   
                                                      e
                                                      b
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             if
                                             
                                          
                                       
                                       
                                          
                                             ∃
                                             
                                                t
                                                *
                                             
                                             ∈
                                             
                                                T
                                                *
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (32)
                              
                                 
                                    
                                       
                                          
                                             then
                                             
                                          
                                       
                                       
                                          
                                             calculate
                                             
                                             the
                                             
                                             corresponding
                                             
                                             rates
                                             
                                             
                                                R
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                R
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   
                                                      t
                                                      
                                                         s
                                                         t
                                                         b
                                                      
                                                   
                                                
                                                
                                                   
                                                      t
                                                      
                                                         s
                                                         t
                                                         b
                                                      
                                                   
                                                   +
                                                   
                                                      τ
                                                      ¯
                                                   
                                                
                                             
                                             
                                                R
                                                t
                                             
                                             
                                             ∀
                                             
                                                t
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                             ∈
                                             
                                                T
                                                ˜
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (33)
                              
                                 
                                    
                                       
                                          
                                             with
                                             
                                          
                                       
                                       
                                          
                                             
                                                R
                                                t
                                             
                                             =
                                             
                                                (
                                                
                                                   D
                                                   
                                                      el
                                                      ,
                                                      t
                                                   
                                                
                                                +
                                                
                                                   D
                                                   t
                                                   EV
                                                
                                                −
                                                
                                                   S
                                                   
                                                      el
                                                      ,
                                                      t
                                                   
                                                   CHP
                                                
                                                )
                                             
                                             ·
                                             
                                                p
                                                
                                                   el
                                                   ,
                                                   t
                                                
                                             
                                             
                                             ∀
                                             
                                                t
                                                *
                                             
                                             ∈
                                             
                                                T
                                                *
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (34)
                              
                                 
                                    
                                       
                                          
                                             with
                                             
                                          
                                       
                                       
                                          
                                             
                                                D
                                                t
                                                EV
                                             
                                             =
                                             
                                                1
                                                
                                                   
                                                      t
                                                      
                                                         e
                                                         s
                                                         l
                                                      
                                                   
                                                   −
                                                   
                                                      t
                                                      
                                                         s
                                                         t
                                                         s
                                                         l
                                                      
                                                   
                                                
                                             
                                             ·
                                             
                                                D
                                                
                                                   s
                                                   l
                                                
                                                EV
                                             
                                             
                                             ∀
                                             
                                                s
                                                l
                                             
                                             ∈
                                             
                                                S
                                                
                                                   L
                                                   *
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (35)
                              
                                 
                                    
                                       
                                          
                                             set
                                             
                                          
                                       
                                       
                                          
                                             
                                                R
                                                
                                                   m
                                                   a
                                                   x
                                                
                                             
                                             =
                                             max
                                             
                                                {
                                                
                                                   R
                                                   
                                                      s
                                                      t
                                                      b
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (36)
                              
                                 
                                    
                                       
                                          
                                             then
                                             
                                          
                                       
                                       
                                          
                                             increase
                                             
                                             operation
                                             
                                             level
                                             
                                             of
                                             
                                             CHP
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                B
                                                t
                                                CHP
                                             
                                             =
                                             min
                                             
                                                {
                                                1
                                                ,
                                                
                                                   
                                                      B
                                                      ^
                                                   
                                                   t
                                                   CHP
                                                
                                                +
                                                0.5
                                                }
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             ∀
                                             t
                                             ∈
                                             {
                                             
                                                t
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                             ,
                                             
                                                t
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                             +
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                t
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                             +
                                             
                                                τ
                                                ¯
                                             
                                             |
                                             
                                                R
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                             =
                                             
                                                R
                                                
                                                   m
                                                   a
                                                   x
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (37)
                              
                                 
                                    
                                       
                                          
                                             set
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   B
                                                   ^
                                                
                                                t
                                                CHP
                                             
                                             =
                                             
                                                
                                                   B
                                                
                                                t
                                                CHP
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        The following step of the algorithm (expressions (38)–(43)) is applied, if no or no further thermal energy shortage occurs but the minimum total operating time is not yet reached and, hence, degrees of freedom still exist. This step is especially relevant, if high degrees of freedom exist, e.g. in summer months. Together with the previous step, this is the key difference to the heat-led strategy commonly used today.

In this situation, where the minimum total operating time is not yet reached, a block ranking is calculated again. However, now the entire time horizon is considered. Based on the ranking, those operating times are preferred, which promise a high rate of own consumption of locally produced electricity or which have the highest ranking based on time-flexible electricity prices. This is equivalent to the goal of economic improvements from the investor’s point of view.

Once more, an iterative approach is selected to supplement the blocks of operation with further time steps or to add whole blocks of operation. The iteration ends as soon as the minimum operating time, necessary to cover the heat demand of the considered days, is reached.

                           
                              (38)
                              
                                 
                                    
                                       
                                          
                                             If
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                t
                                                
                                                   C
                                                   H
                                                   P
                                                
                                             
                                             ·
                                             
                                                h
                                                t
                                             
                                             <
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         T
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         D
                                                         
                                                            t
                                                            h
                                                            ,
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      L
                                                      
                                                         t
                                                         h
                                                         ,
                                                         0
                                                      
                                                      
                                                         T
                                                         S
                                                      
                                                   
                                                   +
                                                   
                                                      L
                                                      th
                                                      
                                                         TS
                                                         ,
                                                         min
                                                      
                                                   
                                                
                                                
                                                   P
                                                   th
                                                   
                                                      CHP
                                                      ,
                                                      max
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (39)
                              
                                 
                                    
                                       
                                          
                                             then
                                             
                                          
                                       
                                       
                                          
                                             calculate
                                             
                                             for
                                             
                                             all
                                             
                                             t
                                             ∈
                                             T
                                             
                                             the
                                             
                                             corresponding
                                             
                                             rates
                                             
                                             
                                                R
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                R
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   
                                                      t
                                                      
                                                         s
                                                         t
                                                         b
                                                      
                                                   
                                                
                                                
                                                   
                                                      t
                                                      
                                                         s
                                                         t
                                                         b
                                                      
                                                   
                                                   +
                                                   
                                                      τ
                                                      ¯
                                                   
                                                
                                             
                                             
                                                R
                                                t
                                             
                                             
                                             ∀
                                             
                                                t
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (40)
                              
                                 
                                    
                                       
                                          
                                             with
                                             
                                          
                                       
                                       
                                          
                                             
                                                R
                                                t
                                             
                                             =
                                             
                                                (
                                                
                                                   D
                                                   
                                                      el
                                                      ,
                                                      t
                                                   
                                                
                                                +
                                                
                                                   D
                                                   t
                                                   EV
                                                
                                                −
                                                
                                                   S
                                                   
                                                      el
                                                      ,
                                                      t
                                                   
                                                   CHP
                                                
                                                )
                                             
                                             ·
                                             
                                                p
                                                
                                                   el
                                                   ,
                                                   t
                                                
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (41)
                              
                                 
                                    
                                       
                                          
                                             set
                                             
                                          
                                       
                                       
                                          
                                             
                                                R
                                                
                                                   m
                                                   a
                                                   x
                                                
                                             
                                             =
                                             max
                                             
                                                {
                                                
                                                   R
                                                   
                                                      s
                                                      t
                                                      b
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (42)
                              
                                 
                                    
                                       
                                          
                                             then
                                             
                                          
                                       
                                       
                                          
                                             increase
                                             
                                             operation
                                             
                                             level
                                             
                                             of
                                             
                                             CHP
                                             
                                             operation
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                B
                                                t
                                                CHP
                                             
                                             =
                                             min
                                             
                                                {
                                                1
                                                ,
                                                
                                                   
                                                      B
                                                      ^
                                                   
                                                   t
                                                   CHP
                                                
                                                +
                                                0.5
                                                }
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             ∀
                                             t
                                             ∈
                                             {
                                             
                                                t
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                             ,
                                             
                                                t
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                             +
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                t
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                             +
                                             
                                                τ
                                                ¯
                                             
                                             |
                                             
                                                R
                                                
                                                   s
                                                   t
                                                   b
                                                
                                             
                                             =
                                             
                                                R
                                                
                                                   m
                                                   a
                                                   x
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (43)
                              
                                 
                                    
                                       
                                          
                                             set
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   B
                                                   ^
                                                
                                                t
                                                CHP
                                             
                                             =
                                             
                                                B
                                                t
                                                CHP
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        In the last step of the first stage all remaining thermal shortages are treated through the operation of the backup system. Furthermore, it is checked whether one or more time steps 
                           
                              t
                              ¯
                           
                         exist, in which the maximum thermal storage level 
                           
                              L
                              th
                              
                                 TS
                                 ,
                                 max
                              
                           
                         is exceeded. In this case, the operation of the PEMFC micro-CHP unit is adapted accordingly. In an iterative approach the algorithm sanctions the time steps 
                           
                              t
                              ≤
                              
                                 t
                                 ¯
                              
                           
                         with the lowest stepwise rates so that the operation is shifted to the time after the storage level is exceeded. By a repetition of the algorithm’s first stage, the validity of the new solution is ensured.

After the completion of the algorithm’s first stage, the second one is applied to determine an improved charging strategy for the EV compared to the equalized strategy assumed in algorithm one. This second stage is described in the following section.

Monotonous charging of the EV (i.e. charging the required electricity during the whole parking time at constant (low) load) assumed in the first stage of the algorithm is not necessarily economically advantageous. However, a simultaneous determination of optimal operation of the micro-CHP unit and optimal charging of the EV is highly complex and requires high computing time. Hence, a simple stepwise approach is selected on the algorithmic level. The first assumption of monotonous charging increases the probability of the unit operating in times when the EV is present. Possible degrees of freedom regarding the charging process are generated and now utilized with the second stage of the algorithm.

In the first step of stage 2 the number of charging slots SL in the considered time horizon is detected. If the number is higher than zero, the limits (begin tstsl
                         and end tesl
                        ) of each temporal slot are determined and the aggregated electrical demand of the EV 
                           
                              D
                              sl
                              EV
                           
                         of each slot sl ∈ SL is calculated with the assumption of complete charging, if possible (Eq. (45)). If |SL| = 0, the algorithm ends, because either the household is not equipped with an EV or the EV is not present in the considered time horizon or there is no need for charging, because the battery already is fully charged. Again, for algorithmic reasons, the slot demands are stored in the auxiliary variables 
                           
                              
                                 D
                                 ^
                              
                              sl
                              EV
                           
                        .

                           
                              (44)
                              
                                 
                                    
                                       
                                          
                                             If
                                             
                                             
                                          
                                       
                                       
                                          
                                             |
                                             SL
                                             |
                                             >
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (45)
                              
                                 
                                    
                                       
                                          
                                             then
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                D
                                                sl
                                                EV
                                             
                                             =
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   
                                                      t
                                                      stsl
                                                   
                                                
                                                
                                                   t
                                                   esl
                                                
                                             
                                             
                                                D
                                                t
                                                EV
                                             
                                             
                                             ∀
                                             sl
                                             ∈
                                             SL
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (46)
                              
                                 
                                    
                                       
                                          
                                             set
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   D
                                                   ^
                                                
                                                sl
                                                EV
                                             
                                             =
                                             
                                                D
                                                sl
                                                EV
                                             
                                             
                                             ∀
                                             sl
                                             ∈
                                             SL
                                          
                                       
                                    
                                 
                              
                           
                        The second step of the algorithm calculates the times to charge the EV for every slot sl in a way which maximizes the own consumption of the locally produced electricity 
                           
                              S
                              
                                 el
                                 ,
                                 t
                              
                              CHP
                           
                         in each time step t ∈ {tstsl
                        , …, tesl
                        }. Potentially time-flexible electricity prices are only considered, if no further own consumption can be generated. This is due to the assumption, that own consumption is generally preferable, if possible. The algorithm now plans the charging process of the EV with respect to technical constraints, such as minimum and maximum charging power (expressed by minimum D
                        
                           EV, min
                         and maximum D
                        
                           EV, max
                         energy per time step) as well as in accordance with the requirement of charging the vehicle as soon as possible, if no further economic advantages can be generated (
                           
                              p
                              el
                              ′
                           
                         represents the lowest possible charging tariff in compliance with technical constraints). Again, the algorithm is implemented as an iterative approach performed for each charging slot sl ∈ SL according to the equations below (expressions (47)–(53)). The iterations are stopped when the maximum electricity demand by EV 
                           
                              D
                              sl
                              EV
                           
                         is satisfied for all charging slots.

                           
                              (47)
                              
                                 
                                    
                                       
                                       
                                          
                                             For
                                             
                                             all
                                             
                                             s
                                             l
                                             ∈
                                             S
                                             L
                                             
                                             do
                                             
                                             iteratively
                                          
                                       
                                    
                                    
                                       
                                          
                                             If
                                             
                                          
                                       
                                       
                                          
                                             ∃
                                             
                                                t
                                                *
                                             
                                             ∈
                                             
                                                {
                                                
                                                   t
                                                   stsl
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   t
                                                   esl
                                                
                                                
                                                   |
                                                
                                                
                                                   S
                                                   
                                                      el
                                                      ,
                                                      
                                                         t
                                                         *
                                                      
                                                   
                                                   CHP
                                                
                                                −
                                                
                                                   D
                                                   
                                                      el
                                                      ,
                                                      
                                                         t
                                                         *
                                                      
                                                   
                                                
                                                >
                                                0
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (48)
                              
                                 
                                    
                                       
                                          
                                             then
                                             
                                          
                                       
                                       
                                          
                                             
                                                D
                                                sl
                                                EV
                                             
                                             =
                                             
                                                
                                                   D
                                                   ^
                                                
                                                sl
                                                EV
                                             
                                             −
                                             
                                                D
                                                
                                                   t
                                                   *
                                                
                                                EV
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (49)
                              
                                 
                                    
                                       
                                          
                                             with
                                             
                                          
                                       
                                       
                                          
                                             
                                                D
                                                
                                                   t
                                                   *
                                                
                                                EV
                                             
                                             =
                                             min
                                             
                                                {
                                                
                                                   D
                                                   
                                                      EV
                                                      ,
                                                      max
                                                   
                                                
                                                ;
                                                max
                                                
                                                   {
                                                   
                                                      D
                                                      
                                                         EV
                                                         ,
                                                         min
                                                      
                                                   
                                                   ;
                                                   
                                                      S
                                                      
                                                         el
                                                         ,
                                                         
                                                            t
                                                            *
                                                         
                                                      
                                                      CHP
                                                   
                                                   −
                                                   
                                                      D
                                                      
                                                         el
                                                         ,
                                                         
                                                            t
                                                            *
                                                         
                                                      
                                                   
                                                   }
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (50)
                              
                                 
                                    
                                       
                                          
                                             set
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   D
                                                   ^
                                                
                                                sl
                                                EV
                                             
                                             =
                                             
                                                D
                                                sl
                                                EV
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (51)
                              
                                 
                                    
                                       
                                          
                                             else
                                             
                                          
                                       
                                       
                                          
                                             iteratively
                                             
                                             repeat
                                             
                                             for
                                             
                                             all
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                t
                                                ′
                                             
                                             ∈
                                             
                                                {
                                                
                                                   t
                                                   stsl
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   t
                                                   esl
                                                
                                                
                                                   |
                                                   0
                                                   <
                                                
                                                
                                                   D
                                                   
                                                      t
                                                      ′
                                                   
                                                   EV
                                                
                                                <
                                                
                                                   D
                                                   
                                                      EV
                                                      ,
                                                      max
                                                   
                                                
                                                ∧
                                                
                                                   p
                                                   
                                                      el
                                                      ,
                                                      
                                                         t
                                                         ′
                                                      
                                                   
                                                
                                                =
                                                
                                                   p
                                                   el
                                                   ′
                                                
                                                }
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                
                                                   D
                                                   ^
                                                
                                                
                                                   t
                                                   ′
                                                
                                                EV
                                             
                                             =
                                             
                                                D
                                                
                                                   t
                                                   ′
                                                
                                                EV
                                             
                                             ∧
                                             
                                                
                                                   D
                                                   ^
                                                
                                                sl
                                                EV
                                             
                                             =
                                             
                                                D
                                                sl
                                                EV
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (52)
                              
                                 
                                    
                                       
                                          
                                             set
                                             
                                          
                                       
                                       
                                          
                                             
                                                D
                                                sl
                                                EV
                                             
                                             =
                                             
                                                
                                                   D
                                                   ^
                                                
                                                sl
                                                EV
                                             
                                             −
                                             min
                                             
                                                {
                                                
                                                   
                                                      D
                                                      ^
                                                   
                                                   sl
                                                   EV
                                                
                                                ;
                                                
                                                   D
                                                   
                                                      EV
                                                      ,
                                                      max
                                                   
                                                
                                                −
                                                
                                                   D
                                                   
                                                      t
                                                      ′
                                                   
                                                   EV
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (53)
                              
                                 
                                    
                                       
                                          
                                             with
                                             
                                             
                                                D
                                                
                                                   t
                                                   ′
                                                
                                                EV
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             min
                                             
                                                {
                                                
                                                   D
                                                   
                                                      EV
                                                      ,
                                                      max
                                                   
                                                
                                                ;
                                                
                                                   
                                                      D
                                                      ^
                                                   
                                                   
                                                      t
                                                      ′
                                                   
                                                   EV
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             min
                                             
                                                {
                                                
                                                   
                                                      D
                                                      ^
                                                   
                                                   sl
                                                   EV
                                                
                                                ;
                                                
                                                   
                                                      D
                                                      ^
                                                   
                                                   
                                                      EV
                                                      ,
                                                      max
                                                   
                                                
                                                −
                                                
                                                   D
                                                   
                                                      t
                                                      ′
                                                   
                                                   EV
                                                
                                                }
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        Since the results of the algorithm are valid integer solutions, they can also be used as starting solution for the MILP described in Section 3. Usually, this accelerates the solution process of the MILP, especially if long time horizons for the sub-problems are applied. In contrast to the first stage of the algorithm (cf. Section 4.1), the second stage (EV charging) assumes a perfect foresight for the availability of the EV. The resulting costs could be therefore interpreted as a lower bound.

The application of both the two-stage algorithm and the MILP in our case study is to analyze the economic benefits from both methodologies and to compare them to the results from the standard heat-led strategy and monotonous charging of the EV. Furthermore, we compare the computing time of both approaches. For the results of the case study to be perfectly comparable, the analysis is performed both based on forecasted demand patterns (based on our STLF approach) and under the assumption of perfectly knowing future demand patterns in advance (each in quarter-hourly temporal resolution). Using forecasted demand patterns as input for the optimization represents the realistic case, while the use of actual demand data prevents disturbing influences of possible forecasting errors and allows for a principle statement regarding the solution quality of the two-stage algorithm. The quality measure is the percentage deviation from the benchmark solution which is calculated by solving the MILP. In total, there are four different methodological variants to be analyzed per household:

                        
                           1.
                           MILP (act): MILP based on actual demand data to calculate a schedule representing a benchmark for all other versions,

MILP (fc): MILP based on forecasted demand patterns to present the MILP’s results under realistic uncertainty conditions (benchmark for 4.),

Alg. (act): two-stage algorithm based on actual demand data to calculate the best possible schedule delivered by the algorithm (can be compared to 1 to evaluate the quality of the algorithm),

Alg. (fc): two-stage algorithm based on forecasted demand patterns to present the algorithm’s results under realistic demand uncertainty.

The MILPs are implemented in the modeling system GAMS (general algebraic modeling system (Corporation, 2012)). The solver used is CPLEX 12.0 (IBM, 2012) which applies the branch-and-cut algorithm for the solution of the MILP sub-problems. Every sub-problem includes 2075 real-valued variables, 760 binaries, and 1592 restrictions. As the proof of optimality for MIP problems can be very expensive because they are NP-hard (Karp, 1972; Tseng, 1996), we applied a relative optimality criterion oc = 0.01 as a good compromise between quality of the solution and computing time. This means that an integer-feasible solution with a deviation of 1 percent from the actual dual bound is accepted as optimal. To illustrate the effects of the selection of the optimality criterion, we varied it in a typical application for household 2, as presented in Fig. 3
                     . While the value of the objective function decreases approximately linearly, the computing time ct increases rapidly for very small values of the optimality criterion. In our test runs no solution was found after 20 hours of computing time with oc < 0.005. Hence, we found oc = 0.01 to be the best compromise between quality of the solution and computing time. We carried out all experiments in a 64 bit Windows 7 environment on a 3.3 gigahertz Quad Core machine with 16 gigabyte of RAM. The computing time with the applied relative optimality criterion oc = 0.01 amounts to about 66 minutes for the MILP.

The rolling window approach (cf. Section 3.2) with a time horizon of 2 days shows significantly lower annual supply costs of households as a time horizon of 1 day and only very marginal higher costs as larger time horizons. Simultaneously, the computing time and the number of binaries per sub-problem both increase linearly with increasing numbers of days considered (Schönfelder, 2013). We, therefore, applied the 2-day rolling window approach.

Final results for all variants are derived using the simulation as described in Section 1.3 and including all additional short-term corrective actions necessary due to forecasting errors. To evaluate economic effects, all results are compared with those of the standard case of the heat-led strategy. The definition of error and quality measures capturing all dimensions of the comparison of different variants is given in Section 5.2 in connection with the results.

Our case study comprises the two exemplary households defined in Table 1. Each of these households is represented with thermal and electrical demand data of 1 year. These two households are chosen to represent the main target group of PEMFC micro-CHP units in Germany, namely small and medium-sized households with average heat demand (Federal Republic of Germany, 2009). Besides the different sums of yearly electricity demand, the yearly heat demand is given per household, which results in slightly differing degrees of freedom for the unit commitment. The system specifications of the PEMFC micro-CHP unit have been defined before and satisfies all requirements (cf. Schönfelder, 2013). The operation of the CHP in both households is once optimized with the presence of an EV and once without. Its electricity demand is derived from a measured driving profile and amounts to 2549 kilowatt-hour per year (IIP, 2012). This corresponds to an annual mileage of approx. 13,000 kilometer. The mobility pattern is compliant with representative German mobility surveys (Infas, DLR, & DIW, 2010; KIT & TNS, 2012). The thermal demand patterns are derived using actual weather data from Germany’s meteorological service (DWD) and according to the calculation rules from VDI (2008) indicating values with a temporal resolution of up to 1 minute. Electric load profiles were measured in 66 real German households over 1 year with quarter-hourly temporal resolution (IIP, 2012). Out of this data set we selected two profiles matching the average annual electricity demand of households of the considered size. Furthermore, the variants defined are analyzed both with constant and time-flexible electricity tariffs. The latter is to demonstrate the optimization methods’ ability of utilizing time-dependent differences in electricity prices by adapting both the operation and the charging schedule. In total, the two different households, the distinction between the presence or absence of an EV, and the differentiation of a constant and time-flexible tariff structure lead to a total of eight variants (cf. Table 2
                        ) which are investigated with two different optimization methods (MILP and Algorithm) and two different qualities of information (actual and forecasted demand patterns).

Demand forecasting with the ANFIS model (cf. Section 2.2) results in overall median absolute percentage errors (MdAPE) of 
                           
                              
                                 MdAPE
                                 
                                    el
                                    ,
                                    hh
                                    1
                                 
                              
                              =
                              13
                           
                         percent and 
                           
                              
                                 MdAPE
                                 
                                    el
                                    ,
                                    hh
                                    2
                                 
                              
                              =
                              22
                           
                         percent for the electrical forecasts and 
                           
                              
                                 MdAPE
                                 th
                              
                              ≈
                              15
                           
                         percent for both thermal forecasts. Compared to STLF on an aggregated level, these error values, which also nearly represent the range of errors in the whole case study considering four households in total,
                           4
                        
                        
                           4
                           The worst MdAPE is about 29 percent for the electrical demand forecasts.
                         are not completely satisfying. However, they are due to the highly fluctuating demand structure of single households and, hence, have to be judged according to these special circumstances. Nevertheless, the following analyses will show that the forecasting quality is good enough to allow for major improvements in the operation of the micro-CHP unit. This is mainly due to the fact that exactly meeting absolute values are not as important as correctly anticipating rough times of high household demand in our application. Yet, it is clear that positive effects are finally dependent on the overall forecasting quality. Certainly, there are households in which the proposed methods fail when they are not adapted to special circumstances. For example, this could be necessary in shift workers’ households with a stochastic shift distribution. Further limitations of our approach are discussed in Section 6 in the form of a critical review.

The reference system considered for both households is a PEMFC-based micro-CHP unit with a maximum electric power of 1.2 kilowatt
                           el
                        . The system’s output power is chosen to fit the annual thermal demand of both households, resulting in approx. 5000 annual full load hours. This corresponds to well-established dimensioning rules for fuel cell-based micro-CHP units in Germany (Thomas, 2011). The PEMFC unit used in our case study is highly efficient compared to other technologies like CHP systems based on gas engines for example, but still suffers from its high price and its limited flexibility which is mainly due to the necessity of decentralized conversion of natural gas into hydrogen (Pehnt et al., 2012; Thomas, 2011). This is reflected by a minimum operation time which is assumed to be 2 hours ( = 8 time steps) as well as by fixed operating points at 0, 50, and 100 percent of the nominal power. The overall efficiency of the unit is ηchp
                         = 0.91. As described above, household electricity prices are estimated conservatively and assumed to be either constant over the entire time horizon (p
                        
                           el, t
                         = 0.25 € /kilowatt-hour ∀t ∈ T) or time-dependent (p
                        
                           el, t
                         ∈ {0.18, 0.25, 0.32} € /kilowatt-hour) with a tariff structure inspired by Gerpott and Paukert (2013) and exogenously given depending on the residual grid load (grid load minus feed-in of non-controllable renewable energy sources). The latter tariffs are likely to become more common in the near future due to the necessity of better integrating fluctuating feed-ins from renewable energy sources (Hirsch, Hillemacher, Block, Schuller, & Möst, 2010). Other economic parameters like natural gas prices (png
                         = 64.3 € /megawatt hour) or CHP bonus payments (σ
                        
                           el, oc
                         = 0.0541 € /kilowatt-hour) (Federal Republic of Germany, 2012) correspond to current market values for residential customers in Germany.

The following sections describe numerical results for the two illustrative households defined in Table 1. Computing times for the MILP and the algorithmic approach are rather constant for all scenarios due to similar problem sizes. The differences between energy economic values are, however, substantial.

The absolute values of the results given in Table 2 show that the coupled generation of heat and electricity is advantageous for both households considered, even with the heat-led strategy compared to the uncoupled supply (Cuc
                           , representing household supply with electricity solely from the grid and thermal energy from a decentral heating based on natural gas). However, this does not guarantee any positive net present value (NPV) in total, because only operational costs, but not the investments are considered in this analysis. Furthermore, the analysis reveals that the schedules determined by the MILP or by the two-stage algorithm result in lower annual costs than in case of the heat-led strategy. Obviously, the positive effects strongly depend on the degrees of freedom in the unit commitment. The slightly lower total thermal energy demand of hh2 combined with its higher electricity demand results in the possibility of larger improvements than in hh1. Consequently, slightly oversized units will profit more from the optimization, while undersized units might be better driven heat-led, because no significant improvements are to be expected. Summing up the results of our case study with the well-dimensioned system, yearly savings (ΔC) of about 7.5–16.9 percent are possible, which mainly depends on the method and the quality of information (actual vs. forecasted data) used. Here, all short-term corrective actions (determined in the simulation of the schedules) which would have been necessary in a real application are already included. For example, for hh2 and the schedule derived by the algorithmic approach based on forecasted demand patterns, the simulation calculates an increase of the backup system’s application due to thermal forecasting errors of approx. 5 percent compared to the value originally stated by the two-stage algorithm. Furthermore, compared to unaltered algorithmic results (where forecasts are assumed to be correct), the simulation shows increasing electricity purchase from the grid of approx. 7 percent which results in an equivalent unexpected feed-in of locally produced electricity and, hence, a decrease of own consumption. The latter is the main reason for the difference of economic results between optimization based on actual and forecasted demand patterns.

Beside absolute values, Table 2 also provides energy economic performance indicators regarding the scale-transformed (percentage scale) loss of the solution’s quality due to the use of a non-optimal algorithm and due to forecasting errors. The latter also includes economic impacts of all short-term corrective actions described above. Consequently, error measures are introduced as depicted in Fig. 4
                           . Starting point for the calculation of the change of annual costs (ΔC) is the reference case of heat-led strategy. ΔC is given separately for each combination of method and quality of information. The loss due to forecasting errors is expressed by π as a percentage for both methods. However, the comparison of πMIP
                            and πAlg
                            does not necessarily reveal whether one of the two methods handles forecasting errors better than the other due to the different reference values. Nevertheless, it gives interesting information on each method’s individual sensitivity to the forecast errors. The third error measure ε is defined relatively to the MILP solution serving as a benchmark for the given quality of information. ε
                              act
                            and ε
                              fc
                            express to what an extent the annual costs calculated in the simulation of the schedule determined by the algorithm deviate from the corresponding value of the MILP schedule. Together, π and ε explain the overall loss due to imperfect information on future demand patterns and the non-optimal solution of the two-stage algorithm. Furthermore, a measure ζ is used to evaluate the overall goal achievement of one method relative to the ex-post optimal solution given by the MILP’s solution based on actual demand data. Mathematical definition of all measures mentioned is given in the following set of equations.

                              
                                 (54a-c)
                                 
                                    
                                       
                                          ζ
                                          
                                             Alg
                                             ,
                                             act
                                          
                                       
                                       =
                                       
                                          
                                             Δ
                                             
                                                C
                                                
                                                   Alg
                                                   ,
                                                   act
                                                
                                             
                                          
                                          
                                             Δ
                                             
                                                C
                                                
                                                   MIP
                                                   ,
                                                   act
                                                
                                             
                                          
                                       
                                       
                                       
                                          ζ
                                          
                                             MIP
                                             ,
                                             fc
                                          
                                       
                                       =
                                       
                                          
                                             Δ
                                             
                                                C
                                                
                                                   MIP
                                                   ,
                                                   fc
                                                
                                             
                                          
                                          
                                             Δ
                                             
                                                C
                                                
                                                   MIP
                                                   ,
                                                   act
                                                
                                             
                                          
                                       
                                       
                                       
                                          ζ
                                          
                                             Alg
                                             ,
                                             fc
                                          
                                       
                                       =
                                       
                                          
                                             Δ
                                             
                                                C
                                                
                                                   Alg
                                                   ,
                                                   fc
                                                
                                             
                                          
                                          
                                             Δ
                                             
                                                C
                                                
                                                   MIP
                                                   ,
                                                   act
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (55a,b)
                                 
                                    
                                       
                                          π
                                          Alg
                                       
                                       =
                                       
                                          
                                             
                                                C
                                                
                                                   Alg
                                                   ,
                                                   fc
                                                
                                             
                                             −
                                             
                                                C
                                                
                                                   Alg
                                                   ,
                                                   act
                                                
                                             
                                          
                                          
                                             C
                                             
                                                Alg
                                                ,
                                                act
                                             
                                          
                                       
                                       
                                       
                                          π
                                          MIP
                                       
                                       =
                                       
                                          
                                             
                                                C
                                                
                                                   MIP
                                                   ,
                                                   fc
                                                
                                             
                                             −
                                             
                                                C
                                                
                                                   MIP
                                                   ,
                                                   act
                                                
                                             
                                          
                                          
                                             C
                                             
                                                MIP
                                                ,
                                                act
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (56a,b)
                                 
                                    
                                       
                                          ϵ
                                          act
                                       
                                       =
                                       
                                          
                                             
                                                C
                                                
                                                   Alg
                                                   ,
                                                   fc
                                                
                                             
                                             −
                                             
                                                C
                                                
                                                   MIP
                                                   ,
                                                   act
                                                
                                             
                                          
                                          
                                             C
                                             
                                                MIP
                                                ,
                                                act
                                             
                                          
                                       
                                       
                                       
                                          ϵ
                                          fc
                                       
                                       =
                                       
                                          
                                             
                                                C
                                                
                                                   Alg
                                                   ,
                                                   fc
                                                
                                             
                                             −
                                             
                                                C
                                                
                                                   MIP
                                                   ,
                                                   fc
                                                
                                             
                                          
                                          
                                             C
                                             
                                                MIP
                                                ,
                                                fc
                                             
                                          
                                       
                                    
                                 
                              
                           The values of πMIP
                            range between 1.2 and 4.0 percent, while πAlg
                            lies between 0.52 and 3.0 percent (cf. Table 2) and therefore the two-stage algorithm perform similar with forecasting errors than the MILP. However, due to its non-optimal solution in general, its total performance is, as expected, slightly worse than for the MILP. The latter is expressed by the values of ε
                              act
                            between 1.1 and 3.8 percent and ε
                              fc
                            ranging between 0.64 and 2.94 percent. The presence of an EV increases these differences because the two-stage algorithmic planning approach is, compared to the MILP, less able to take interdependencies between CHP scheduling and EV charging into account. While the relative goal achievement of the algorithm is at least closer to the result of the MILP than to the heat-led strategy (ζ
                           
                              Alg, fc
                            between 64.3 and 80.7 percent), the value is considerably higher for the perfect foresight scenario (ζ
                           
                              Alg, act
                            between 81.05 and 90.78 percent). The average computing time on a desktop computer could be reduced from about 66 minutes for the MILP (cf. Section 5) to about 4 minutes for 1 year optimization on the average for the algorithm for all eight variants considered. Even though the computing time might be somewhat higher for low-cost embedded systems, our approach seems to be very promising for real applications.

Comparing the standard case of the heat-led strategy and the operation based on the algorithmic optimization on a monthly basis in hh2 with the assumption of a constant tariff, it becomes obvious, that the amount of electricity produced each month strongly depends on the corresponding thermal demand which directly determines the maximum time of CHP operation. A rough classification of the months leads to three substantially different phases which are mainly weather-dependent. The first one is the winter period with a high thermal demand, mainly due to the requirement of heating the household. The micro-CHP unit normally operates at full power throughout this period. There are hardly any degrees of freedom to be exploited by the optimization, which is why only few positive effects can be generated. Another period in which the optimization is barely able to generate improvements is the summer period. This is due to a thermal household demand near to zero (only for warm water), which means that the CHP-unit is hardly running and, hence, does not produce much electricity. The third period may be classified as transition period and is characterized by constantly decreasing (between winter and summer) or increasing (between summer and winter) thermal demand. This period provides significant degrees of freedom regarding the operation and, hence, the potential for generating positive effects in terms of increasing the share of own consumption (marked as φ
                              el, prod
                            in Table 2). Furthermore, the presence of an EV seems to have positive effects on the own consumption rate in all seasons due to the increase of the household’s total electricity demand.

We presented a case study based on a comprehensive approach to determining improved residential PEMFC micro-CHP operating strategies. As information about the short-term local demand patterns is imperfect in real applications, we used an STLF model (cf. Section 2.2). It is based on ANFIS addressing the demand uncertainty in a first stage via so-called point forecasts representing the most likely realization of the short-term local demand. Subsequently, both an MILP and a two-stage algorithmic method were presented. They use the point forecasts to derive economically optimized schedules in a rolling window optimization fashion. Hence, we address demand uncertainty by load forecasting instead of using stochastic programming, as it is more realistic for real applications. The schedules derived in a daily repeated manner are then analyzed in a simulation using actual demand patterns in a temporal resolution of 1 minute to derive all necessary short-term corrective actions and, hence, the performance which could have been realized in the real application. The results obtained with the schedule generated by the algorithmic approach in our case study mostly deviated by less than 3 percent from those of the MILP’s integer optimal solution and computing time could be reduced by a factor of 15. Furthermore, the two-stage algorithm might have further advantages in being implemented in current PEMFC micro-CHP units and not to be dependent on sophisticated hardware and solver software and therefore operating more reliable than MILP based systems during the unit lifetime of about 20 years.

However, the absolute advantages generated by both approaches compared to the standard case of heat-led operation strongly depend on the individual household’s characteristics. If only few degrees of freedom in unit operation exist, it might be easier to apply the heat-led strategy (e.g. in winter months). Nevertheless, especially in transition periods and with the presence of an EV, the methods developed yield significantly improved solutions. For example, for an illustrative household in our case study, overall discounted savings of approximately 2500 € were reached compared to the heat-let strategy using forecasted load patterns under the assumption of time-flexible electricity prices. This is equivalent to nearly twice the current governmental funding for PEMFC micro-CHP units at 1.2 kilowatt
                        el
                      in Germany (BMUB, 2012), while the electricity prices used in our case study were estimated very conservatively. As the results are quite sensitive to the electricity price, increasing prices will further enhance the positive effects achieved.

It should be noted that the effects achieved by the application of the methods used depend on the quality of the forecast demand patterns. In turn, the quality of the forecast strongly depends on the individual household’s characteristics (Schönfelder, 2013). Certainly, some households are not suited for the application due to highly differing demand patterns which are not predictable with the STLF models. This may be a household in which all residents are shift workers who do not always follow fixed shift plans. The analysis also revealed, however, that the rough prediction of household-specific peak load times often already allows to significantly improve the operation of the PEMFC micro-CHP unit. Nevertheless, further enhancement of the forecast quality is likely to intensify positive economic effects. The upper bound of these positive effects is given by the assumption of perfectly knowing the actual demand in advance.

Another weakness of the developed methods is the fact that the results obtained, even if they are positive, do not necessarily mean that the installation of a PEMFC micro-CHP unit generally is economically advantageous compared to uncoupled supply. Moreover, due to the case study character of our investigation, the results are not necessarily generalizable.

@&#ACKNOWLEDGMENTS@&#

The authors are thankful to three anonymous reviewers for their helpful comments and suggestions.

@&#REFERENCES@&#

