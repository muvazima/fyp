@&#MAIN-TITLE@&#Global obstacle avoidance and minimum workpiece setups in five-axis machining

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Classification of different types of obstacles encountered in five-axis NC machining.


                        
                        
                           
                           Efficient numerical algorithms on how to represent dynamic obstacles.


                        
                        
                           
                           Efficient computing of feasible regions considering all types of obstacles.


                        
                        
                           
                           A heuristic optimization algorithm for finding the best workpiece setup.


                        
                        
                           
                           A thorough analysis of both static and dynamic obstacles.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Five-axis NC machining

Accessibility

Workpiece setup

V-map




                     




                        




                           




                              




                                 F




                              




                           




                           




                              




                                 I




                              




                           




                        




                     -map and 




                        




                           




                              




                                 F




                              




                           




                           




                              




                                 II




                              




                           




                        




                     -map

Tool path generation

@&#ABSTRACT@&#


               
               
                  The state-of-the-art tool path computation algorithms for five-axis machining consider only the workpiece and clamping device for collision avoidance. However, in a real five-axis machining process, there are many other types of obstacles beyond workpiece and clamps that the tool assembly must avoid, e.g., sensors and other intrusive devices. In such cases, the only solution at present is by means of computer simulation of the machining process after the tool path has been computed. If collision is found, it requires re-computing the tool path and/or changing the setup of the workpiece. This process is then re-iterated until all the collisions are resolved. As a result, the process is time consuming and requires excessive human intervention. In this paper, we present rigorous analyses of the obstacles in five-axis machining and propose efficient numerical algorithms for calculating and representing them. Using our results, the obstacle-free tool orientations can be determined completely at the tool path planning stage, rather than relying on the simulation afterward. In addition, as a direct application of our mathematical modeling, we present a heuristic-based solution to the optimal workpiece setups problem: finding a minimum number of workpiece setups for an arbitrary sculpture part surface so that it can be machined completely on a given five-axis machine without colliding with the obstacles. We use orthogonal table–table five-axis machines as an example and work out a numerical experiment using the proposed solution.
               
            

@&#INTRODUCTION@&#

Five-axis machining enjoys tremendous advantages over traditional three-axis machining, including larger range of tool accessibility, faster material removal rate, better surface finishing quality, and so on. It is especially suitable for machining parts with high precision sculptured surfaces such as aircraft structure parts, turbine blades, propellers and impellers, molds and dies, etc. In five-axis machining, at the tool path planning stage, when determining the tool orientation for the tool to contact any particular point on the part surface, the minimum yet also the most critical condition is that the tool must avoid the obstacles during the entire machining process.

Before any further discussion, it is imperative to give a clear classification of the obstacles encountered during a five-axis machining operation, as follows.


                     Type  0 Obstacle 
                     
                        
                           (
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 0
                              
                           
                           )
                        
                     : The obstacle is part of the workpiece, including the part surface itself or in-process geometry model of the workpiece.


                     Type  1 Obstacle (
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                     ): The obstacle is attached to or fixed on the machine table (e.g., clamps and fixtures). Once the workpiece is set up on the machine table, an 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      can be considered the same as an 
                        
                           
                              
                                 Obs
                              
                           
                           
                              0
                           
                        
                     .


                     Type  2 Obstacle (
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                     ): The obstacle is attached to or fixed on the machine’s base (e.g., sensors of the drive system).


                     
                        
                           
                              
                                 Obs
                              
                           
                           
                              0
                           
                        
                      is static with respect to the part surface, since it is defined on the workpiece, and it is the most common obstacle type. 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      and 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                      are those defined on the table and on the machine’s base, respectively. They are usually the clamps, the online measurement devices and some ancillary pieces of equipment used in the machining process. 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      and 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                      do exist in the machining process. However, they are both ignored in almost all the existing tool path generation algorithms. Specifically, current five-axis tool path generation algorithms bear the following two major caveats: 
                        
                           (1)
                           When deciding the obstacle-free orientations of the tool, only static obstacles (i.e., 
                                 
                                    
                                       
                                          Obs
                                       
                                    
                                    
                                       0
                                    
                                 
                              ) are considered, leaving both 
                                 
                                    
                                       
                                          Obs
                                       
                                    
                                    
                                       
                                          I
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          Obs
                                       
                                    
                                    
                                       
                                          II
                                       
                                    
                                 
                               unattended.

The relative orientation and position of the part surface (i.e., the setup of the workpiece) on the machine table are usually disregarded.

The fact that only 
                        
                           
                              
                                 Obs
                              
                           
                           
                              0
                           
                        
                      is considered when deciding the tool orientations causes two serious problems. First, since 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      is not considered, after the workpiece is mounted and clamped on the machine table, some originally collision-free tool axes at some contact points may now collide with the 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                     . The second, which occurs during the machining process and is perhaps more troublesome, is that the tool assembly, according to an originally assigned tool axis, will either collide with the 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                      or the required machine table rotation angles are out of the working ranges of the rotary axes. At present, the only solution to both these two is by means of computer simulation of the machining process after the tool path has been computed. If collision or out-of-range is found, it requires re-computing the tool axes and/or changing the setup of the workpiece. This process is then re-iterated until all the collisions are resolved. As a result, the process is time-consuming and requires excessive human intervention.

Since both 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      and 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                      vary (with respect to the part surface) depending on how the workpiece is set on the machine table, the workpiece setup problem itself is integrally related to the general global obstacle avoidance problem. Different workpiece setups on the machine table bring different tool accessibility and multiple setups may be required to cover the whole part. Generally speaking, when machining a part, fewer workpiece setups means less auxiliary time and less errors resulting from the remounting and recalibrating operations. Therefore, finding the minimum number of setups for a given workpiece (ideally only a single one) has great significance in five-axis machining.

Motivated by the above two problems and also the related workpiece setup problem, this paper has set forth two objectives: (1) to establish a rigorous classification of the algebraic structures of obstacles of all the three types and then propose efficient numerical algorithms for calculating and representing them; and (2) as a direct application of (1), to devise an optimization algorithm that will find a minimum number of workpiece setups for machining a given sculpture surface, attending to all the three types of obstacles.

While past works pertaining to the first objective are scarce, the minimum workpiece setup problem has drawn a great deal of attention over the last two decades. Past works primarily have been focusing on the calculation of static Visibility Maps (
                        
                           V
                        
                     -map) and finding the relationship between the 
                        
                           V
                        
                     -maps, the (set of) Tool Access Directions (TAD), and feasible tool orientations in tool path generation, to be reviewed next.

Previous works in workpiece setup focus on different objectives. For the dynamic error reduction problem, Anotaipaiboon et al.  [1] minimized the kinematics errors by choosing an appropriate workpiece setup, and the optimization process is carried out by the least square method. While considering the design specification of the part, Zhang et al.  [2] used the tolerance analysis chart to get the optimal workpiece setup from the perspective of tolerance control. Contini and Tolio  [3] investigated and analyzed the machining requirement before generating a workpiece setup plan in the machining process. For the problem of accessibility and minimal number of workpiece setups, Radzevich and Goodman  [4] utilized the Gaussian map (G-map) of the part surface and the cutting surface of the cutter, taking both the number of setups and the optimal cutting condition into consideration, to determine the optimal workpiece orientation on the table; Gupta et al.  [5] used the concept of geometric duality and proposed a greedy heuristic method to find the optimal workpiece orientation which maximizes the number of (polygonal) faces machined in a single setup; Tang et al.  [6–8] conducted a series of works in finding the minimal number of workpiece setups for four-axis machining. However, all these works in accessibility and the minimum workpiece setup problem ignored the obstacles on the machine table and machine’s base; in other words, they can only treat static obstacles. There are also works done in workpiece setup for other purposes. Lee et al.  [9] proposed a manufacturability evaluation method and built a software module for the workpiece setup analysis for three, four and five axis machines; Kang and Suh  [10] gave a brute-force based method for finding a workpiece setup on the 
                           A
                           –
                           B
                         type and 
                           C
                           –
                           A
                         type five-axis machines that would minimize the maximum rotation angles of 
                           A
                           –
                           B
                        , or 
                           A
                           –
                           C
                         axis; Hu and Tang  [11] incorporated the workpiece setup into the kinematics chain of a five-axis machine, and improved the dynamics of machine’s rotary axes by finding the optimal workpiece setup; Cai et al.  [12] proposed an adaptive method for the setup planning in the machining of prismatic parts.

TAD is the set of feasible tool orientations provided by the machine in the workpiece coordinate system (WCS), which is decided by the travel ranges of the machine’s rotary axes and can be represented by a great arc or spherical area on the Gaussian sphere (G-sphere) in four-axis or five-axis machining, respectively. In the existing works, Tang et al.  [6–8] divided the TAD of four-axis machining, i.e. a great arc, into three types according to the travel range of the rotary axis; Woo  [13] classified the TAD with different degrees of freedom (DOFs) into a great arc or spherical area on the G-sphere; Kang and Suh  [10] classified the TAD of five-axis machining into two types of 
                           C
                           –
                           A
                         and 
                           A
                           –
                           B
                         according to the configuration of the machine’s two rotary axes, and further work by Cai et al.  [12] tested the effectiveness of such a division of TAD in a five-axis machine.

For each point on the part surface, the 
                           
                              V
                           
                        -map is the set of collision-free orientations of the tool on the G-sphere defined in the WCS. The notion of the 
                           
                              V
                           
                        -map was introduced by Chen et al.  [14] and Woo  [13], deriving from the definition of the G-map. In the existing research, the 
                           
                              V
                           
                        -map was usually calculated as part of the work in the planning of the collision-free tool path  [15–19]. Wang and Tang  [20] proposed a fast iterative method of calculating the 
                           
                              V
                           
                        -map. Based on the continuity property of the 
                           
                              V
                           
                        -map on smooth surfaces, they calculated the 
                           
                              V
                           
                        -map of one point by taking its neighboring points as the references and proposed a boundary tracking algorithm to calculate the 
                           
                              V
                           
                        -map for the entire surface. Elber proposed an algorithm to calculate the 
                           
                              V
                           
                        -map of external obstacles with the restriction of tool orientation along the surface normal  [21], and later, he proposed another global solution to extend the method for the case of arbitrary tool orientations  [22]. Lacalle  [23] analyzed the issues in the 
                           
                              V
                           
                        -map, and pointed out that the interference between the tool and fixture on the machine table and base was still an unsolved problem in the CAM system. Again, in all these works, only static obstacles are considered.

Augmenting 
                           
                              V
                           
                        -maps, some other types of constraints, which are equally important in tool path generation, have been added to further restrain or guide the tool orientation. Gong and Wang  [24] took the ball-end machined surface as a constraint for bounding the tool orientation in flank milling. Castagnetti et al.  [25] introduced the concept of Domain of Admissible Orientation (DAO) to restrain the allowable tool orientations at each CC point, which is defined according to the functional constraints specified by the machining requirements, and the tool orientation smoothing is carried out in the DAO. Hu and Tang  [11] defined the Domain of Geometrical Constraint (DGC) for the tool orientation based on the variation of the effective cutting radius in the iso-parametric tool path, and tool orientation smoothing for the dynamics of machine’s rotary axis was then carried out within the DGC. Considering the local geometry constraints of the surface,  [26–29] restricted the tool orientation in the local gouging-free region and carried out optimizations for different purposes. Lasemi et al.  [30] presented a comprehensive summary of the tool path generation algorithms in five-axis machining, together with a variety of constraints for the tool orientation.

This paper is organized as follows. In Section  2, rigorous mathematical models of the minimum workpiece setup problem with 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 0
                              
                           
                         only and with all the three–
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        –are established, respectively. A brief description about how to compute a 
                           
                              V
                           
                        -map is given in Section  3. In Sections  4 and 5, two important algebraic structures called Forbidden Map Type 1 (
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        -map) and Forbidden Map Type 2 (
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        -map) are introduced, which cater to 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        , respectively. In Section  6, we present our heuristic optimization algorithm for the minimum workpiece setups problem. Finally, in Section  7, we present a preliminary computer simulation experiment, followed by the summary.

Throughout this paper, without loss of generality, we exclusively focus on orthogonal table–table five-axis machines—namely, the machine with two rotary axes 
                        A
                      and 
                        C
                      on the table, and three linear axes 
                        
                           (
                           X
                           Y
                           Z
                           )
                        
                      of the tool, as shown in Fig. 1
                     .

The workpiece setup on the table can be defined by a 6-tuple vector: 
                        
                           (1)
                           
                              
                                 setup
                              
                              =
                              
                                 (
                                 a
                                 ,
                                 b
                                 ,
                                 c
                                 ,
                                 φ
                                 ,
                                 θ
                                 ,
                                 ψ
                                 )
                              
                           
                        
                      where: 
                        
                           
                              
                                 setup
                              
                           
                           
                              I
                           
                        
                        =
                        
                           (
                           a
                           ,
                           b
                           ,
                           c
                           )
                        
                      is the first part of 
                        
                           setup
                        
                     , which represents the position of the origin of the WCS, e.g., 
                        
                           
                              o
                           
                           
                              w
                           
                        
                      in Fig. 1, in the Table Coordinate System (TCS); while 
                        
                           
                              
                                 setup
                              
                           
                           
                              
                                 II
                              
                           
                        
                        =
                        
                           (
                           φ
                           ,
                           θ
                           ,
                           ψ
                           )
                        
                      is the second part of 
                        
                           setup
                        
                     , which is composed of three Euler angles and represents the orientation of the WCS in the TCS. The details of the transformation can be found in  [11].

As already stated, the TAD represents the range of tool orientations on the G-sphere in the WCS. From  [6,10], it is known that, with the specification of the ranges of 
                        A
                      and 
                        C
                      axis, the TAD is a function of 
                        
                           (
                           φ
                           ,
                           θ
                           ,
                           ψ
                           )
                        
                      only, which can be expressed as: 
                        
                           (2)
                           
                              
                                 TAD
                              
                              =
                              f
                              
                                 (
                                 
                                    
                                       
                                          setup
                                       
                                    
                                    
                                       
                                          II
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

To algebraically define the TAD, we will use as an example the orthogonal table–table five-axis machine in Fig. 1, in which the orientation of the tool 
                        
                           
                              T
                           
                           
                              M
                           
                        
                      is fixed in the MCS, i.e., 
                        
                           
                              T
                           
                           
                              M
                           
                        
                        =
                        
                           [
                           0
                           ,
                           0
                           ,
                           1
                           ]
                        
                     . With the specification of the range of (
                        A
                     , 
                        C
                     ), for example 
                        A
                        ∈
                        
                           [
                           −
                           2
                           π
                           /
                           9
                           ,
                           
                           2
                           π
                           /
                           9
                           ]
                        
                      and 
                        C
                        ∈
                        
                           [
                           −
                           π
                           ,
                           
                           π
                           ]
                        
                        ,
                        
                           
                              T
                           
                           
                              M
                           
                        
                      forms a region on the G-sphere in the TCS: 
                        
                           (3)
                           
                              
                                 
                                    
                                       [
                                       
                                          
                                             T
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       0
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 Rot
                              
                              
                                 (
                                 z
                                 ,
                                 −
                                 C
                                 )
                              
                              ∗
                              
                                 Rot
                              
                              
                                 (
                                 x
                                 ,
                                 −
                                 A
                                 )
                              
                              ∗
                              
                                 
                                    
                                       [
                                       
                                          
                                             T
                                          
                                          
                                             M
                                          
                                       
                                       ,
                                       0
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              .
                           
                        
                     
                  

Expanding Eq. (3) yields: 
                        
                           (4)
                           
                              
                                 
                                    T
                                 
                                 
                                    T
                                 
                              
                              
                                 =
                              
                              
                                 (
                                 
                                    
                                       
                                          sin
                                          
                                             (
                                             A
                                             )
                                          
                                          sin
                                          
                                             (
                                             C
                                             )
                                          
                                       
                                    
                                    
                                       
                                          sin
                                          
                                             (
                                             A
                                             )
                                          
                                          cos
                                          
                                             (
                                             C
                                             )
                                          
                                       
                                    
                                    
                                       
                                          cos
                                          
                                             (
                                             A
                                             )
                                          
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

From Eq. (4), it is apparent that the TAD in the TCS is generated by revolving an arc 
                        χ
                      about the 
                        
                           
                              z
                           
                           
                              t
                           
                        
                      axis with a revolving angle 
                        C
                     , as illustrated in Fig. 2
                     (a), and 
                        χ
                      is expressed as: 
                        
                           
                              χ
                              =
                              
                                 [
                                 0
                                 ,
                                 sin
                                 
                                    (
                                    A
                                    )
                                 
                                 ,
                                 cos
                                 
                                    (
                                    A
                                    )
                                 
                                 ]
                              
                              ,
                              
                              A
                              ∈
                              
                                 [
                                 −
                                 2
                                 π
                                 /
                                 9
                                 ,
                                 
                                 2
                                 π
                                 /
                                 9
                                 ]
                              
                              .
                           
                        
                     
                  

After revolving 
                        χ
                      about the 
                        C
                      axis for 
                        2
                        π
                     , the TAD in the TCS is the double of the cap region on the G-sphere (Fig. 2(a)). This cap then is transformed to the WCS, as shown in Fig. 2(b): 
                        
                           (5)
                           
                              
                                 
                                    
                                       [
                                       
                                          
                                             T
                                          
                                          
                                             W
                                          
                                       
                                       ,
                                       0
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    T
                                 
                                 
                                    T
                                    →
                                    W
                                 
                              
                              ∗
                              
                                 
                                    
                                       [
                                       
                                          
                                             T
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       0
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                           
                        
                      where: 
                        
                           
                              T
                           
                           
                              T
                              →
                              W
                           
                        
                      is a function of the setup, representing transformation from the TCS to the WCS, and its exact definition will be left till Section  4 (Eq. (11)). Apparently, with the change of setup (Eq. (1)), only the center of the TAD moves around on the G-sphere in the WCS, with its shape and area unchanged.

A 
                        
                           V
                        
                     -map is the mapping of directions in the visibility cone (V-cone) (which considers 
                        
                           
                              
                                 Obs
                              
                           
                           
                              0
                           
                        
                      only) on the G-sphere, also in the WCS. For each point on the workpiece, there is a V-cone and a corresponding 
                        
                           V
                        
                     -map on the G-sphere, as illustrated in Fig. 3
                     . Because only 
                        
                           
                              
                                 Obs
                              
                           
                           
                              0
                           
                        
                      is considered, 
                        
                           V
                        
                     -maps are static on the G-sphere of WCS, independent of workpiece setups.

For all the sample points on the part surface, their 
                        
                           V
                        
                     -maps are defined and calculated on the same G-sphere, and the tool accessibility of any point is represented by the intersection between its 
                        
                           V
                        
                     -map and TAD, per Eq. (5). For example, in Fig. 3(b): in this particular setup, the corresponding TAD intersects the 
                        
                           V
                        
                     -maps of 
                        
                           
                              p
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              p
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              4
                           
                        
                      (i.e. 
                        
                           
                              V
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              V
                           
                           
                              4
                           
                        
                     ), but not that of 
                        
                           
                              p
                           
                           
                              3
                           
                        
                     , meaning that 
                        
                           
                              p
                           
                           
                              3
                           
                        
                      is inaccessible in this setup.

Note that in the above analysis TAD and all the 
                        
                           V
                        
                     -maps are mapped onto the G-sphere in the WCS. The reason for this lies in the fact that there are in general a large number of sample points on the part surface which is defined in the WCS, but only one TAD defined in the Machine Coordinate System (MCS). It is much more computationally efficient to convert one TAD to the WCS than to transform hundreds or thousands of 
                        
                           V
                        
                     -maps to the MCS. For the same reason, hereafter all our accessibility checks will be carried out in the WCS.

It becomes clear that if only 
                        
                           
                              
                                 Obs
                              
                           
                           
                              0
                           
                        
                      is considered, in a given setup, the obstacle-free tool orientations for any point on the part surface are exactly the intersection between the TAD (per Eq. (5)) and the 
                        
                           V
                        
                     -map of that point. When 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      and 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                      are considered, however, things become much more complicated.

Let us start with the analysis of the kinematic chain of the machine in Fig. 1, as depicted in Fig. 4
                     . In the left branch of the chain, the table of the machine is mounted on the machine’s base, with two DOFs, i.e., rotary axes 
                        A
                      and 
                        C
                     , and the workpiece is mounted on the table with the relative position and orientation defined by the setup, whereas in the right branch of the chain, the tool can move with three DOFs along the 
                        x
                        ,
                        y
                      and 
                        z
                      axes. In the kinematic chain, 
                        
                           
                              H
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      are the 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      and 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                      fixed in the machine’s table and machine’s base, respectively.


                     
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                     , e.g., 
                        
                           
                              H
                           
                           
                              1
                           
                        
                      in both Figs. 1 and 4, is defined in the TCS and fixed on the machine table. From Fig. 4 it is seen that the setup is the only chain between the workpiece and 
                        
                           
                              H
                           
                           
                              1
                           
                        
                     . Suppose that the geometric entities (such as vertices and vectors) of 
                        
                           
                              H
                           
                           
                              1
                           
                        
                      defined in the TCS are represented by 
                        
                           
                              M
                              H
                           
                           
                              1
                           
                           
                              T
                           
                        
                     , the mapping of 
                        
                           
                              H
                           
                           
                              1
                           
                        
                      from the TCS to the WCS gives: 
                        
                           (6)
                           
                              
                                 
                                    M
                                    H
                                 
                                 
                                    1
                                 
                                 
                                    W
                                 
                              
                              =
                              
                                 
                                    T
                                 
                                 
                                    T
                                    →
                                    W
                                 
                              
                              ∗
                              
                                 
                                    M
                                    H
                                 
                                 
                                    1
                                 
                                 
                                    T
                                 
                              
                           
                        
                      where: 
                        
                           
                              M
                              H
                           
                           
                              1
                           
                           
                              W
                           
                        
                      represents the geometric entities of 
                        
                           
                              H
                           
                           
                              1
                           
                        
                      defined in the WCS; 
                        
                           
                              T
                           
                           
                              T
                              →
                              W
                           
                        
                      is a function of setup, to be defined later (by Eq. (11)).

For any setup, the whole or part of a 
                        
                           V
                        
                     -map can be obscured by 
                        
                           
                              H
                           
                           
                              1
                           
                        
                      in the WCS, which will be called the Forbidden Map I (
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map). To reflect this obstruction on the G-sphere, the 
                        
                           V
                        
                     -map must be eclipsed by the 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map.

From Eq. (6), 
                        
                           
                              M
                              H
                           
                           
                              1
                           
                           
                              W
                           
                        
                      is a function of setup. Different setups will have different 
                        
                           
                              M
                              H
                           
                           
                              1
                           
                           
                              W
                           
                        
                     , and hence different 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -maps on the G-sphere. For 
                        
                           
                              H
                           
                           
                              1
                           
                        
                     , both 
                        
                           
                              
                                 setup
                              
                           
                           
                              I
                           
                        
                      and 
                        
                           
                              
                                 setup
                              
                           
                           
                              I
                              I
                           
                        
                      can affect the 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map.

For 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                     , e.g., 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      in both Figs. 1 and 4, we observe that, as 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      is defined in the MCS and fixed on the machine base, the kinematic chain between the workpiece and 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      is made of both setup and the two rotary axes 
                        A
                      and 
                        C
                     . Let 
                        
                           
                              M
                              H
                           
                           
                              2
                           
                           
                              M
                           
                        
                      represent the geometric entities of 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      in the MCS, transforming it from the MCS to the WCS gives: 
                        
                           (7)
                           
                              
                                 
                                    M
                                    H
                                 
                                 
                                    2
                                 
                                 
                                    W
                                 
                              
                              =
                              
                                 
                                    T
                                 
                                 
                                    T
                                    →
                                    W
                                 
                              
                              ∗
                              
                                 
                                    T
                                 
                                 
                                    M
                                    →
                                    T
                                 
                              
                              
                                 (
                                 A
                                 ,
                                 C
                                 )
                              
                              ∗
                              
                                 
                                    M
                                    H
                                 
                                 
                                    2
                                 
                                 
                                    M
                                 
                              
                           
                        
                      where: 
                        
                           
                              M
                              H
                           
                           
                              2
                           
                           
                              W
                           
                        
                      represents the geometric entities for 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      in the WCS, 
                        
                           
                              T
                           
                           
                              T
                              →
                              W
                           
                        
                      is the same as that in Eq. (5), and 
                        
                           
                              T
                           
                           
                              M
                              →
                              T
                           
                        
                        
                           (
                           A
                           ,
                           C
                           )
                        
                      is a matrix representing the forward kinematics for two rotary axes 
                        A
                      and 
                        C
                     .

From Eq. (7), 
                        
                           
                              M
                              H
                           
                           
                              2
                           
                           
                              W
                           
                        
                      is also a function of setup. Similar to 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                     , there will also be 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 II
                              
                           
                        
                     -maps for 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      and, for the same reason, both 
                        
                           
                              
                                 setup
                              
                           
                           
                              I
                           
                        
                      and 
                        
                           
                              
                                 setup
                              
                           
                           
                              
                                 II
                              
                           
                        
                      will affect 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 II
                              
                           
                        
                     -maps on the G-sphere in the WCS.

In the presence of 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      and 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                     , a 
                        
                           V
                        
                     -map is eclipsed by both its 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map and 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 II
                              
                           
                        
                     -map. We then define another map on the G-sphere in the WCS, the Global Visibility Map (
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map): 
                        
                           (8)
                           
                              
                                 
                                    
                                       V
                                    
                                 
                                 
                                    g
                                 
                              
                              -
                              
                                 map
                              
                              =
                              
                                 V
                              
                              -map
                              −
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    
                                       I
                                    
                                 
                              
                              -map
                              −
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              -map .
                           
                        
                     
                  

In Fig. 5
                     (a), an example of a 
                        
                           V
                        
                     -map, a 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map and a 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 II
                              
                           
                        
                     -map is shown, and Fig. 5(b) shows its final 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map. In Eq. (8), the 
                        
                           V
                        
                     -map is static, but not the 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map and the 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 II
                              
                           
                        
                     -map, both of which are functions of setup. Consequently, the 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map is also a function of setup.

Therefore, with 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      and 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                      added, the final set of obstacle-free tool axes for any point on the part surface should be the intersection between the 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map of the point and the TAD, both of which depend on the workpiece setup. It is clear that on a globally gouging-free tool path, the tool orientation should always be bounded inside the 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map with any particular setup. In the following three sections, algorithmic methods for computing the 
                        
                           V
                        
                     -map, 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map, and 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 II
                              
                           
                        
                     -map will be proposed, respectively.

For the part surface as well as any obstacles or fixtures that are static with respect to the part (together they form the workpiece), they are first sampled into triangles with 
                        n
                      nodes, which will be the sample points for checking the tool accessibility. For example, shown in Fig. 6
                     (a) is the upper part of a car seat, and in Fig. 6(b) is the corresponding triangulation with the nodes as the sample points. Since these nodes are uniformly sampled and the surface is smooth enough, we can use the accessibility of these nodes to represent that for the entire smooth surface.

We adopt the algorithm in  [20] to calculate the 
                        
                           V
                        
                     -maps of the sample nodes.

First, the space on the G-sphere is mapped into a plane defined by the two sphere angles 
                        α
                      and 
                        β
                      in the Local Coordinate System (LCS) 
                        
                           
                              o
                           
                           
                              L
                           
                        
                        
                           
                              x
                           
                           
                              L
                           
                        
                        
                           
                              y
                           
                           
                              L
                           
                        
                        
                           
                              z
                           
                           
                              L
                           
                        
                     , as shown in Fig. 7
                     . The LCS is a Cartesian coordinate system with the origin at the sample node and the three principal axes parallel to their respective counterparts in the WCS. Because of this parallelism, the G-sphere in the LCS is the same as in the WCS. The two sphere angles for the G-sphere are shown in Fig. 7(a), with their intervals 
                        α
                        ∈
                        
                           [
                           0
                           ,
                           π
                           ]
                        
                     , and 
                        β
                        ∈
                        
                           (
                           −
                           π
                           ,
                           π
                           ]
                        
                     . In practice, the 
                        α
                        –
                        β
                      plane is always discretized in computation. Specifically, the sphere angle ranges are discretized into an 
                        m
                        ×
                        n
                      grid, as shown in Fig. 7(b). A 
                        
                           V
                        
                     -map then is stored as a binary matrix of 
                        m
                        ×
                        n
                     .

An initial node on the part surface, e.g., 
                        p
                      in Fig. 6(b), is selected, and its 
                        
                           V
                        
                     -map is calculated by a brute-force-like method as proposed in  [20]. Note that this calculation only needs to be done once.

Starting from this initial point, whose 
                        
                           V
                        
                     -map is already available, its one-ring neighbors are then fetched, e.g., 
                        
                           
                              q
                           
                           
                              1
                           
                        
                        –
                        
                           
                              q
                           
                           
                              7
                           
                        
                      of 
                        p
                      in Fig. 6. As the part surface is smooth, so will be the change of the 
                        
                           V
                        
                     -maps between neighboring nodes. Therefore, the 
                        
                           V
                        
                     -map of 
                        
                           
                              q
                           
                           
                              i
                           
                        
                      can be constructed by incrementally updating that of 
                        p
                     , via a boundary-tracking algorithm as proposed in  [20]. The whole process can then propagate outward toward the boundary of the surface, until all the nodes are processed.

The above iterative procedure is efficient for calculating 
                        
                           V
                        
                     -maps of an entire surface. Except for the lone initial node, whose 
                        
                           V
                        
                     -map calculation may need a certain noticeable computing time, the 
                        
                           V
                        
                     -map calculations for all the other nodes are generally very fast, thus affording high sampling density.

To simplify the computation of the 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map, we approximate the shape of an 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      (and all other types of obstacles as well) with its convex hull. This will guarantee safety with the sacrifice of slightly smaller visibility region, which is worthwhile for the greater benefit of performance and ease. For any obstacle of concave shape, it can be decomposed into multiple convex components. Hereafter, we use a box as an example of an 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      but the algorithm can be easily extended to cover any other arbitrary convex hulls.

As 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      is defined in the TCS, in order to get the 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map, the first step is to transform 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      to the LCS.

From Fig. 4 and Eq. (6), we see that the kinematic chain between 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         and workpiece is the setup itself. For each point on the part surface, e.g., 
                           p
                         in Fig. 1, its 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        -map is defined in its own LCS.

Calculation of a box 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         in the LCS takes the following three steps.

(Step 1). Get vertices of 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         in the TCS. 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           =
                           
                              {
                              
                                 
                                    o
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    o
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    o
                                 
                                 
                                    8
                                 
                              
                              }
                           
                        , and 
                           
                              
                                 o
                              
                              
                                 i
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                                 
                                    L
                                 
                              
                              )
                           
                         is the 
                           i
                        th vertex of 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           ,
                           
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           8
                        . These are the input data.

(Step 2). Get vertices of 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         in the WCS. Let 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         in the WCS be 
                           
                              
                                 H
                              
                              
                                 1
                              
                              
                                 W
                              
                           
                           =
                           
                              {
                              
                                 
                                    o
                                 
                                 
                                    1
                                 
                                 
                                    W
                                 
                              
                              ,
                              
                                 
                                    o
                                 
                                 
                                    2
                                 
                                 
                                    W
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    o
                                 
                                 
                                    8
                                 
                                 
                                    W
                                 
                              
                              }
                           
                        , and 
                           
                              
                                 o
                              
                              
                                 i
                              
                              
                                 W
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    W
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                                 
                                    W
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                                 
                                    W
                                 
                              
                              )
                           
                           ,
                           
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           8
                        . Transform from the TCS to the WCS: 
                           
                              (9)
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                o
                                             
                                             
                                                i
                                             
                                             
                                                W
                                             
                                          
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       T
                                       →
                                       W
                                    
                                 
                                 ∗
                                 
                                    
                                       
                                          [
                                          
                                             
                                                o
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                              
                           
                         where: 
                           
                              
                                 T
                              
                              
                                 T
                                 →
                                 W
                              
                           
                         is the transformation matrix from the TCS to the WCS, which, according to the kinematic chain, is a function of the six setup parameters 
                           
                              (
                              a
                              ,
                              b
                              ,
                              c
                              ,
                              φ
                              ,
                              θ
                              ,
                              ψ
                              )
                           
                        . From  [11] we have: 
                           
                              (10)
                              
                                 
                                    
                                       T
                                    
                                    
                                       W
                                       →
                                       T
                                    
                                 
                                 =
                                 
                                    Trans
                                 
                                 
                                    (
                                    a
                                    ,
                                    b
                                    ,
                                    c
                                    )
                                 
                                 ∗
                                 
                                    Rot
                                 
                                 
                                    (
                                    z
                                    ,
                                    ψ
                                    )
                                 
                                 ∗
                                 
                                    Rot
                                 
                                 
                                    (
                                    x
                                    ,
                                    θ
                                    )
                                 
                                 ∗
                                 
                                    Rot
                                 
                                 
                                    (
                                    z
                                    ,
                                    φ
                                    )
                                 
                              
                           
                         where 
                           
                              Trans
                           
                         and 
                           
                              Rot
                           
                         are standard translation and rotation matrices, respectively. Thus, 
                           
                              (11)
                              
                                 
                                    
                                       T
                                    
                                    
                                       T
                                       →
                                       W
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             W
                                             →
                                             T
                                          
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    Rot
                                 
                                 
                                    (
                                    z
                                    ,
                                    −
                                    φ
                                    )
                                 
                                 ∗
                                 
                                    Rot
                                 
                                 
                                    (
                                    x
                                    ,
                                    −
                                    θ
                                    )
                                 
                                 ∗
                                 
                                    Rot
                                 
                                 
                                    (
                                    z
                                    ,
                                    −
                                    ψ
                                    )
                                 
                                 ∗
                                 
                                    Trans
                                 
                                 
                                    (
                                    −
                                    a
                                    ,
                                    −
                                    b
                                    ,
                                    −
                                    c
                                    )
                                 
                                 .
                              
                           
                        
                     

Substitute Eq. (11) into Eq. (9), we obtain 
                           
                              
                                 o
                              
                              
                                 i
                              
                              
                                 W
                              
                           
                           ,
                           
                           
                              (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              8
                              )
                           
                        .

(Step 3). Get vertices of 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         in the LCS. Let 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         in the LCS of 
                           p
                         be 
                           
                              
                                 H
                              
                              
                                 1
                              
                              
                                 L
                              
                           
                           =
                           
                              {
                              
                                 
                                    o
                                 
                                 
                                    1
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                                 
                                    o
                                 
                                 
                                    2
                                 
                                 
                                    L
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    o
                                 
                                 
                                    8
                                 
                                 
                                    L
                                 
                              
                              }
                           
                           ,
                           
                              
                                 p
                              
                              
                                 W
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    p
                                 
                                 
                                    W
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                                 
                                    W
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    p
                                 
                                 
                                    W
                                 
                              
                              )
                           
                         be the coordinates of 
                           p
                         in the WCS. Transform from the WCS to the LCS: 
                           
                              (12)
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                o
                                             
                                             
                                                i
                                             
                                             
                                                L
                                             
                                          
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    Trans
                                 
                                 
                                    (
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          p
                                       
                                       
                                          W
                                       
                                    
                                    ,
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          p
                                       
                                       
                                          W
                                       
                                    
                                    ,
                                    
                                       
                                          −
                                          z
                                       
                                       
                                          p
                                       
                                       
                                          W
                                       
                                    
                                    )
                                 
                                 ∗
                                 
                                    
                                       
                                          [
                                          
                                             
                                                o
                                             
                                             
                                                i
                                             
                                             
                                                W
                                             
                                          
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     

Substitute Eq. (9) into Eq. (12): 
                           
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                o
                                             
                                             
                                                i
                                             
                                             
                                                L
                                             
                                          
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    Trans
                                 
                                 
                                    (
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          p
                                       
                                       
                                          W
                                       
                                    
                                    ,
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          p
                                       
                                       
                                          W
                                       
                                    
                                    ,
                                    
                                       
                                          −
                                          z
                                       
                                       
                                          p
                                       
                                       
                                          W
                                       
                                    
                                    )
                                 
                                 ∗
                                 
                                 
                                    
                                       T
                                    
                                    
                                       T
                                       →
                                       W
                                    
                                 
                                 ∗
                                 
                                    
                                       
                                          [
                                          
                                             
                                                o
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 
                                 
                                    (
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    8
                                    )
                                 
                                 .
                              
                           
                        
                     

For any point 
                           p
                         on the part surface, after 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         is mapped into its LCS, we need to identify all the tool axes with which the tool will interfere with 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         if to contact 
                           p
                        . These tool axes are therefore forbidden directions. Conceivably, this identification problem becomes inordinately difficult and complicated when both the shape and size of the tool are considered. As an alternative, we will first consider the degenerate case when the tool is simply a line (i.e., the tool radius is zero), while eventually the thus obtained forbidden maps will be amended to reflect the actual tool size (see Appendix). Although such a simplification might mistakenly label some otherwise forbidden directions as feasible, it makes the solution computationally affordable.

We begin with the introduction of the visibility from a point to a convex polyhedron, with the example of box 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         shown in Fig. 8
                        . As seen in the figure, only some of the faces and vertices of 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         are visible from point 
                           p
                        . For those visible faces, we borrow a concept in computing the 3-D convex hull from  [31], the horizon of 
                           p
                        , which is defined as the outmost enclosed edges of those faces visible from 
                           p
                        . For example, in Fig. 8, the horizon of 
                           p
                         is the closed poly-curve with the vertex of 
                           
                              {
                              
                                 
                                    o
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    o
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    o
                                 
                                 
                                    6
                                 
                              
                              ,
                              
                                 
                                    o
                                 
                                 
                                    7
                                 
                              
                              ,
                              
                                 
                                    o
                                 
                                 
                                    8
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          o
                                       
                                       
                                          4
                                       
                                    
                                    ,
                                    o
                                 
                                 
                                    1
                                 
                              
                              }
                           
                        . Clearly, the horizon of 
                           p
                         defines the largest set of visible directions for 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         from point 
                           p
                        . In other words, the 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        -map of 
                           p
                         should be the set of those rays that emit from 
                           p
                         and lie inside its horizon.

In Fig. 8, the horizon of 
                           p
                         for 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         is a closed poly-curve composed of six vertices out of eight in the box, which means not all the vertices are involved in the calculation of 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        -map. Also, for 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                        , the horizon of 
                           p
                         is determined by its relative position and orientation with respect to 
                           p
                        . Fig. 9
                         shows a 2-D case illustrating the above statement—when the rectangle (with edges 
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 e
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 4
                              
                           
                        ) moves or rotates in the LCS 
                           
                              
                                 x
                              
                              
                                 l
                              
                           
                           p
                           
                              
                                 z
                              
                              
                                 l
                              
                           
                         of 
                           p
                        , its horizon changes. More specifically, since the position and orientation of an 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         are functions of the setup, so is the horizon of 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        .

With a fixed setup, by projecting all the vertices and edges of 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         onto a plane, e.g., 
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                         in Fig. 8, when viewed from 
                           p
                        , the projection of the horizon is easily seen to be the 2-D convex hull of all the projected vertices in that plane. This statement holds whenever 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         is convex. Thus the calculation of the forbidden directions of 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         is equivalent to the well-solved 2-D convex hull problem in a projection plane. However, we must ensure that such a projection plane 
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                         always exists. Indeed, since the obstacle 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         is assumed to be convex, 
                           p
                         is outside the convex hull (
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         itself actually), and all the rays originating from 
                           p
                         and hitting 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         form a cone which is strictly smaller than a hemisphere with 
                           p
                         being the center. The boundary of this cone is made exactly of the rays contributed by the horizon of 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                        . Obviously, any plane 
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                         suits our need as long as it intersects the entirety of the boundary of the cone. For instance, as adopted in our implementation, we can first find the closest point 
                           
                              
                                 p
                              
                              
                                 ∗
                              
                           
                         on 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         from 
                           p
                        ; any plane that is orthogonal to and intercepts the line segment (
                           p
                           ,
                           
                              
                                 p
                              
                              
                                 ∗
                              
                           
                        ) can be a candidate for 
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                        . Note that this selection is valid as long as the obstacle is convex, not limited to boxes only. Once the vertices of the obstacle are projected to this plane, well-known 2-D convex hull algorithms (e.g., from  [23]) can then be adopted to compute the convex hull.

The 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        -map calculation begins with the calculation of the two spherical angles 
                           α
                         and 
                           β
                        . For each of the forbidden directions, there is a corresponding mapping point in the 
                           α
                           –
                           β
                         plane. For any line segment in the LCS of 
                           p
                        , e.g., line segment 
                           l
                         through 
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 2
                              
                           
                         in Fig. 10
                        (a), it can be represented as: 
                           
                              
                                 l
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    (
                                    1
                                    −
                                    t
                                    )
                                 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 t
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 ;
                                 
                                 t
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 .
                              
                           
                        
                     

Let 
                           l
                           
                              (
                              t
                              )
                           
                           =
                           
                              (
                              x
                              
                                 (
                                 t
                                 )
                              
                              ,
                              y
                              
                                 (
                                 t
                                 )
                              
                              ,
                              z
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                         be an edge of the projected 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         in plane 
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                        . Its two spherical angles are also functions of 
                           t
                        , i.e., 
                           
                              (
                              α
                              
                                 (
                                 t
                                 )
                              
                              ,
                              β
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                        , and 
                           
                              
                                 (13)
                                 
                                    α
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    a
                                    
                                    
                                       cos
                                    
                                    
                                       (
                                       z
                                       
                                          (
                                          t
                                          )
                                       
                                       /
                                       
                                          |
                                          l
                                          
                                             (
                                             t
                                             )
                                          
                                          |
                                       
                                       )
                                    
                                 
                              
                              
                                 (14)
                                 
                                    β
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    a
                                    
                                    
                                       tan
                                    
                                    
                                    2
                                    
                                       (
                                       y
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                       x
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                 
                              
                           
                         where: 
                           a
                           
                           
                              tan
                           
                           
                           2
                           
                              (
                              y
                              ,
                              x
                              )
                           
                         is a function defined as: 
                           
                              
                                 a
                                 
                                 
                                    tan
                                 
                                 
                                 2
                                 
                                    (
                                    y
                                    ,
                                    x
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             a
                                             
                                             
                                                tan
                                             
                                             
                                                (
                                                y
                                                /
                                                x
                                                )
                                             
                                             −
                                             π
                                             ,
                                             
                                             x
                                             ,
                                             y
                                             <
                                             0
                                             ;
                                          
                                       
                                       
                                          
                                             a
                                             
                                             
                                                tan
                                             
                                             
                                                (
                                                y
                                                /
                                                x
                                                )
                                             
                                             ,
                                             
                                             x
                                             ≥
                                             0
                                             ;
                                          
                                       
                                       
                                          
                                             a
                                             
                                             
                                                tan
                                             
                                             
                                                (
                                                y
                                                /
                                                x
                                                )
                                             
                                             +
                                             π
                                             ,
                                             
                                             x
                                             <
                                             0
                                             ,
                                             y
                                             ≥
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Let 
                           
                              
                                 l
                              
                              
                                 x
                                 y
                              
                           
                           
                              (
                              t
                              )
                           
                         denote the projection of 
                           l
                           
                              (
                              t
                              )
                           
                         in the 
                           
                              
                                 x
                              
                              
                                 l
                              
                           
                           
                              
                                 y
                              
                              
                                 l
                              
                           
                         plane of the LCS. In Eq. (13), for 
                           α
                           
                              (
                              t
                              )
                           
                           ∈
                           
                              [
                              0
                              ,
                              π
                              ]
                           
                        , it is continuous for all 
                           t
                           ∈
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        . However, in Eq. (14), for 
                           β
                           
                              (
                              t
                              )
                           
                           ∈
                           
                              (
                              −
                              π
                              ,
                              π
                              ]
                           
                        , it is discontinuous in two cases: 
                           
                              (1)
                              
                                 
                                    x
                                    
                                       (
                                       t
                                       )
                                    
                                    <
                                    0
                                  and 
                                    y
                                    
                                       (
                                       t
                                       )
                                    
                                  changes sign. This case happens when 
                                    
                                       
                                          l
                                       
                                       
                                          x
                                          y
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  intersects the 
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          l
                                       
                                    
                                  axis, i.e. when 
                                    t
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          ∗
                                       
                                    
                                 , as shown Fig. 10(b). In this case, 
                                    β
                                    
                                       (
                                       t
                                       )
                                    
                                  has a jump of 
                                    2
                                    π
                                 .


                                 
                                    
                                       
                                          l
                                       
                                       
                                          x
                                          y
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  passes through the origin. In this case, 
                                    β
                                    
                                       (
                                       t
                                       )
                                    
                                  has a jump of 
                                    π
                                 .

The discontinuity of 
                           β
                           
                              (
                              t
                              )
                           
                         sometimes may divide an 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        -map in the 
                           α
                           –
                           β
                         plane with 
                           α
                           ∈
                           
                              [
                              0
                              ,
                              π
                              ]
                           
                         and 
                           β
                           ∈
                           
                              (
                              −
                              π
                              ,
                              π
                              ]
                           
                         into two separate regions even though the forbidden directions themselves are always continuous.

For a given convex polygon (CP) obstacle shown in Fig. 8, if its 
                           β
                         falls into one of the two discontinuity cases, it needs to be divided into two parts by the 
                           
                              
                                 x
                              
                              
                                 l
                              
                           
                           p
                           
                              
                                 z
                              
                              
                                 l
                              
                           
                         plane, and the 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        -map in the plane of 
                           α
                           –
                           β
                         is calculated separately by Eqs. (13) and (14) for the two divided parts.

When CP has continuous 
                           β
                           
                              (
                              t
                              )
                           
                        , the 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        -map is calculated with Eqs. (13) and (14) for the entirety. The theoretical solutions of 
                           α
                         and 
                           β
                         for a CP are a complicated curve in the 
                           α
                           –
                           β
                         plane. For simplicity of computation, we approximate this curve by a polygon in the 
                           α
                           –
                           β
                         plane, e.g., Fig. 11
                        .

It is important to clarify that, projecting 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         into a convex polygon in plane 
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                         is only for the purpose of convenience, the corresponding solution curves per Eqs. (13) and (14) in the 
                           α
                           –
                           β
                         plane are algebraic and in general may not be convex at all, neither is this required by us.

To recap, to calculate the 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        -map of a sample point 
                           p
                         due to
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        , the vertices of the 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         are first transformed to the LCS of 
                           p
                        ; next, this 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         is projected into a chosen plane in the LCS; the convex hull CP of the projected vertices is then built; afterward, we calculate the 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        -map of the CP tending to both continuous and discontinuous situations; finally, the 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        -map is transformed to the 
                           α
                           –
                           β
                         plane and then approximated into a polygon and finally its grid form.


                        
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                         is defined in the MCS and fixed on the machine’s base. Akin to 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        , a tetrahedron 
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                         with vertices 
                           
                              {
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    b
                                 
                                 
                                    4
                                 
                              
                              }
                           
                         is used to represent 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        , as shown in Fig. 1. Similar to that of 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        , the first step for calculating the 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        -map is to transform 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                         from the MCS to the LCS of the sample node, e.g., point 
                           p
                         in Fig. 1. From Eq. (7), it is obvious that the kinematic chain between 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                         and the LCS, in addition to the setup, also includes the 
                           A
                         and the 
                           C
                         axis.

To characterize the 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        -map, we first need to define a tool contact configuration to be called double touching: the bottom of the tool contacts the part surface 
                           S
                         at a point 
                           p
                        , while at the same time its shank touches a boundary edge of 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        , e.g., line 
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           
                              
                                 b
                              
                              
                                 4
                              
                           
                         at point 
                           q
                         in Fig. 12
                        (a). For the five-axis machine given in Fig. 1, since the tool axis is always parallel to 
                           
                              [
                              0
                              ,
                              0
                              ,
                              1
                              ]
                           
                         in the MCS, with the simplification of the cutter to a line, it is clear that both 
                           p
                         and 
                           q
                         lie on the same vertical line (in the MCS) in the double touching condition. Let us project the 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                         into the 
                           
                              
                                 x
                              
                              
                                 m
                              
                           
                           
                              
                                 o
                              
                              
                                 m
                              
                           
                           
                              
                                 y
                              
                              
                                 m
                              
                           
                         plane in the MCS system; in the simplest case, this projection is a triangle, e.g., 
                           △
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                         in Fig. 12(b), which is static in MCS. With 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        , the forbidden condition for 
                           p
                         is to check whether the 
                           x
                         and 
                           y
                         coordinates of 
                           p
                         in the MCS are inside the projection 
                           △
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                        .

From Figs. 1 and 4, it is evident that the coordinates of point 
                           p
                         in the MCS depend on both the workpiece setup and the rotary angles of 
                           A
                         and 
                           C
                        . For a fixed setup, with 
                           A
                         and 
                           C
                         changing in their corresponding ranges, 
                           p
                         in the MCS forms, in general, a 3D surface, to be denoted by 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 3
                              
                           
                        . By projecting 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 3
                              
                           
                         into the 
                           
                              
                                 x
                              
                              
                                 m
                              
                           
                           
                              
                                 o
                              
                              
                                 m
                              
                           
                           
                              
                                 y
                              
                              
                                 m
                              
                           
                         plane, it becomes a feasible region, i.e., 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                        , which describes the possible region of 
                           p
                         in the 
                           
                              
                                 x
                              
                              
                                 m
                              
                           
                           
                              
                                 o
                              
                              
                                 m
                              
                           
                           
                              
                                 y
                              
                              
                                 m
                              
                           
                         plane due to the specified ranges of 
                           A
                         and 
                           C
                        . From the above analysis, the forbidden condition between 
                           p
                         and 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                         can be regarded as checking the intersection condition between 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                         and 
                           △
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                        : if 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                           ∩
                           △
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                           ≠
                           0̸
                        , then collision happens; and for any collision configuration 
                           f
                           ∈
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                           ∩
                           △
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                        , there is a least one corresponding 
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    f
                                 
                              
                              ,
                              
                              
                                 
                                    C
                                 
                                 
                                    f
                                 
                              
                              )
                           
                         from the Inverse Kinematic Transformation (IKT). Thus, the 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                         in the LCS can be derived from the Forward Kinematic Transformation (FKT) based on the calculated 
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    f
                                 
                              
                              ,
                              
                              
                                 
                                    C
                                 
                                 
                                    f
                                 
                              
                              )
                           
                        . It becomes clear now that all the possible IKTs of 
                           A
                         and 
                           C
                         for all the points inside 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                           ∩
                           △
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                         should be identified, and the FKTs transforming 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                         to the LCS of 
                           p
                         should then be calculated correspondingly.

As already stated, for any five-axis machine, its two rotary axes have limited ranges, e.g., the machine tool shown in Fig. 1 has 
                           C
                           ∈
                           
                              [
                              −
                              π
                              ,
                              π
                              ]
                           
                         and 
                           A
                           ∈
                           
                              [
                              −
                              2
                              π
                              /
                              9
                              ,
                              
                              2
                              π
                              /
                              9
                              ]
                           
                        . With an arbitrary setup, the position of a point 
                           p
                         on the part surface in the MCS is bounded by the ranges of the two rotary axes.

Let 
                           
                              
                                 
                                    Set
                                 
                              
                              
                                 ∗
                              
                           
                           =
                           
                              (
                              
                                 
                                    a
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    φ
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                         be an arbitrary setup and 
                           
                              
                                 p
                              
                              
                                 W
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    p
                                 
                                 
                                    W
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                                 
                                    W
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    p
                                 
                                 
                                    W
                                 
                              
                              )
                           
                         be the coordinates of 
                           p
                         in the WCS. Let 
                           
                              
                                 p
                              
                              
                                 T
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              )
                           
                         be the coordinates of 
                           p
                         in the TCS, which is related to 
                           
                              
                                 p
                              
                              
                                 W
                              
                           
                         by: 
                           
                              (15)
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                p
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       W
                                       →
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 ∗
                                 
                                    
                                       
                                          [
                                          
                                             
                                                p
                                             
                                             
                                                W
                                             
                                          
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                              
                           
                         where: 
                           
                              
                                 T
                              
                              
                                 W
                                 →
                                 T
                              
                              
                                 ∗
                              
                           
                         is the transformation matrix defined by the setup 
                           
                              
                                 
                                    Set
                                 
                              
                              
                                 ∗
                              
                           
                        ; according to Eq. (10), 
                           
                              
                                 T
                              
                              
                                 W
                                 →
                                 T
                              
                              
                                 ∗
                              
                           
                           =
                           
                              Trans
                           
                           
                              (
                              
                                 
                                    a
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                           ∗
                           
                              Rot
                           
                           
                              (
                              z
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                           ∗
                           
                              Rot
                           
                           
                              (
                              x
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                           ∗
                           
                              Rot
                           
                           
                              (
                              z
                              ,
                              
                                 
                                    φ
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                        .

In Fig. 1, the origins of the TCS and MCS are set to coincide with each other, i.e. 
                           
                              
                                 o
                              
                              
                                 l
                              
                           
                         and 
                           
                              
                                 o
                              
                              
                                 m
                              
                           
                         are the same, which are just the crossing point between the 
                           A
                         and the 
                           C
                         axis. Obviously, with different 
                           A
                         and/or 
                           C
                         angles, the corresponding 
                           p
                         in the MCS are different. In other words, for the same 
                           
                              
                                 p
                              
                              
                                 T
                              
                           
                        , the ranges of 
                           A
                         and 
                           C
                         induce a set of 3-D points in the MCS, which is exactly 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 3
                              
                           
                        .

Explicitly, 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 3
                              
                           
                         is formed by two rotations.

(1) Rotation about the 
                           C
                         axis: a circle.

Since 
                           C
                           ∈
                           
                              [
                              −
                              π
                              ,
                              π
                              ]
                           
                        , when 
                           p
                         rotates about the 
                           C
                         axis, it forms a circle. Let this circle be 
                           
                              
                                 C
                              
                              
                                 p
                              
                           
                           
                              (
                              u
                              )
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    c
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    c
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              )
                           
                         with parameter 
                           u
                        . Then: 
                           
                              (16)
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   c
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   c
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   c
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             r
                                             cos
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          
                                             r
                                             sin
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   p
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                         where: 
                           r
                           =
                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                p
                                             
                                             
                                                T
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       +
                                       
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                p
                                             
                                             
                                                T
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        , and 
                           u
                           ∈
                           
                              [
                              −
                              π
                              ,
                              π
                              ]
                           
                         is the parameter of the rotation angle about the 
                           C
                         axis. We can define 
                           u
                         in terms of the 
                           C
                         angle: 
                           
                              (17)
                              
                                 u
                                 =
                                 C
                                 +
                                 α
                                 ;
                              
                           
                         where: 
                           α
                           =
                           a
                           
                           
                              tan
                           
                           
                           2
                           
                              (
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    p
                                 
                              
                              )
                           
                        , and 
                           a
                           
                           
                              tan
                           
                           
                           2
                         is the function defined in Eq. (14).

(2) Rotation about the 
                           A
                         axis: the 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 3
                              
                           
                        .

Rotate the circle 
                           
                              
                                 C
                              
                              
                                 p
                              
                           
                           
                              (
                              u
                              )
                           
                         about the 
                           A
                         axis, then the surface swept by the circle is 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 3
                              
                           
                        : 
                           
                              (18)
                              
                                 
                                    
                                       
                                          Reg
                                       
                                    
                                    
                                       p
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    Rot
                                 
                                 
                                    (
                                    x
                                    ,
                                    v
                                    )
                                 
                                 ∗
                                 
                                    
                                       
                                          [
                                          
                                             
                                                C
                                             
                                             
                                                p
                                             
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     

Substituting Eq. (16) into Eq. (18), we have 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 3
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    R
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    R
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    R
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              )
                           
                         and: 
                           
                              (19)
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   R
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   R
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   R
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             r
                                             cos
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          
                                             r
                                             sin
                                             
                                                (
                                                u
                                                )
                                             
                                             cos
                                             
                                                (
                                                v
                                                )
                                             
                                             
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   p
                                                
                                                
                                                   T
                                                
                                             
                                             sin
                                             
                                                (
                                                v
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                   sin
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   ∗
                                                   sin
                                                   
                                                      (
                                                      v
                                                      )
                                                   
                                                   
                                                   +
                                                   z
                                                
                                                
                                                   p
                                                
                                                
                                                   T
                                                
                                             
                                             cos
                                             
                                                (
                                                v
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                         where: 
                           v
                         is the parameter of 
                           
                              
                                 C
                              
                              
                                 p
                              
                           
                           
                              (
                              u
                              )
                           
                        ’s rotation angle about the 
                           A
                         axis, as shown in Fig. 13
                        ; setting 
                           v
                           =
                           A
                        , so that 
                           v
                           ∈
                           
                              [
                              −
                              2
                              π
                              /
                              9
                              ,
                              
                              2
                              π
                              /
                              9
                              ]
                           
                        .

In Eq. (19), change 
                           
                              
                                 y
                              
                              
                                 R
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         into another form: 
                           
                              (20)
                              
                                 
                                    
                                       y
                                    
                                    
                                       R
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       +
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      p
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 sin
                                 
                                    (
                                    v
                                    −
                                    ω
                                    )
                                 
                              
                           
                         where: 
                           ω
                         is a function of 
                           u
                        , and: 
                           
                              (21)
                              
                                 ω
                                 =
                                 a
                                 
                                 
                                    tan
                                 
                                 
                                    (
                                    r
                                    sin
                                    
                                       (
                                       u
                                       )
                                    
                                    /
                                    
                                       
                                          z
                                       
                                       
                                          p
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Now, we can get 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    R
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              ,
                              
                              
                                 
                                    y
                                 
                                 
                                    R
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              )
                           
                         by projecting 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 3
                              
                           
                         into the 
                           
                              
                                 x
                              
                              
                                 m
                              
                           
                           
                              
                                 o
                              
                              
                                 m
                              
                           
                           
                              
                                 y
                              
                              
                                 m
                              
                           
                         plane, i.e.: 
                           
                              (22)
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   R
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   R
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             r
                                             cos
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  p
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             sin
                                             
                                                (
                                                v
                                                −
                                                ω
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     


                        
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                         is exactly the 2D region as defined by Eq. (22). In Fig. 15(a), one example of 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                         is shown for some point 
                           p
                         on a part surface with a given setup 
                           
                              
                                 
                                    Set
                                 
                              
                              
                                 ∗
                              
                           
                        . Next, we give a detailed geometric and algebraic analysis of 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                        , with special attention paid to its partitioning in the 
                           
                              
                                 x
                              
                              
                                 m
                              
                           
                           
                              
                                 o
                              
                              
                                 m
                              
                           
                           
                              
                                 y
                              
                              
                                 m
                              
                           
                         plane.

To account for all the possible 
                           A
                         and 
                           C
                         for the forbidden condition of 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        , we divide 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                         into two parts–
                           
                              
                                 
                                    
                                       
                                          Reg
                                       
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          Reg
                                       
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        –according to its parametric domain, which is needed for obtaining definite IKT solutions, as to be described next. For 
                           
                              
                                 
                                    
                                       
                                          Reg
                                       
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                           :
                           u
                           ∈
                           
                              [
                              −
                              π
                              ,
                              0
                              ]
                           
                        , and 
                           v
                           ∈
                           
                              [
                              −
                              2
                              π
                              /
                              9
                              ,
                              
                              2
                              π
                              /
                              9
                              ]
                           
                        ; for 
                           
                              
                                 
                                    
                                       
                                          Reg
                                       
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                           :
                           
                           u
                           ∈
                           
                              [
                              0
                              ,
                              π
                              ]
                           
                        , and 
                           v
                           ∈
                           
                              [
                              −
                              2
                              π
                              /
                              9
                              ,
                              
                              2
                              π
                              /
                              9
                              ]
                           
                        . Let 
                           
                              
                                 H
                              
                              
                                 
                                    I
                                 
                              
                           
                         and 
                           
                              
                                 H
                              
                              
                                 
                                    II
                                 
                              
                           
                         denote their respective boundaries. We next give a detailed analysis on the algebraic structures of these two parts.


                        
                           
                              
                                 
                                    
                                       
                                          Reg
                                       
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        .

For all 
                           u
                           ∈
                           
                              [
                              −
                              π
                              ,
                              0
                              )
                           
                           ,
                           
                              
                                 x
                              
                              
                                 R
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         is monotonic, while for each 
                           u
                         both the maximal and minimal 
                           
                              
                                 y
                              
                              
                                 R
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         lie on the boundary 
                           
                              
                                 H
                              
                              
                                 
                                    I
                                 
                              
                           
                        . Thus, for each 
                           u
                           ,
                           
                              
                                 H
                              
                              
                                 
                                    I
                                 
                              
                           
                         can be defined by finding the minimal and maximal value of 
                           
                              
                                 y
                              
                              
                                 R
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         with 
                           v
                           ∈
                           
                              [
                              −
                              2
                              π
                              /
                              9
                              ,
                              
                              2
                              π
                              /
                              9
                              ]
                           
                        .

In five-axis machining, the part surface always lies above the machine table, that is, 
                           
                              
                                 z
                              
                              
                                 p
                              
                              
                                 T
                              
                           
                           >
                           0
                        . By definition, 
                           r
                           ≥
                           0
                        . Also, when 
                           u
                           ∈
                           
                              [
                              −
                              π
                              ,
                              0
                              )
                           
                           ,
                           sin
                           
                              (
                              u
                              )
                           
                           ≤
                           0
                        . From Eq. (21) and all these constraints, we have 
                           ω
                           ∈
                           
                              (
                              −
                              π
                              /
                              2
                              ,
                              
                              0
                              ]
                           
                        .

The minimum of 
                           
                              
                                 y
                              
                              
                                 R
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         can be divided into two cases: 
                           
                              
                                 min
                                 
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          R
                                       
                                       
                                          
                                             I
                                          
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  p
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                             2
                                             π
                                             /
                                             9
                                             −
                                             ω
                                             ≥
                                             π
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  p
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                             sin
                                             
                                                (
                                                2
                                                π
                                                /
                                                9
                                                −
                                                ω
                                                )
                                             
                                             ,
                                             2
                                             π
                                             /
                                             9
                                             −
                                             ω
                                             <
                                             π
                                             /
                                             2
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The maximum of 
                           
                              
                                 y
                              
                              
                                 R
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         is: 
                           
                              
                                 max
                                 
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          R
                                       
                                       
                                          
                                             I
                                          
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       +
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      p
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                 sin
                                 
                                    (
                                    −
                                    2
                                    π
                                    /
                                    9
                                    −
                                    ω
                                    )
                                 
                                 .
                              
                           
                        
                     


                        
                           
                              
                                 H
                              
                              
                                 
                                    I
                                 
                              
                           
                         is therefore composed of four curves, i.e., 
                           
                              
                                 H
                              
                              
                                 
                                    I
                                 
                              
                           
                           =
                           
                              {
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                                 
                                    
                                       I
                                    
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    2
                                 
                                 
                                    
                                       I
                                    
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    3
                                 
                                 
                                    
                                       I
                                    
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    4
                                 
                                 
                                    
                                       I
                                    
                                 
                              
                              }
                           
                        , with: 
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                    
                                    
                                       
                                          I
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             r
                                             cos
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          
                                             min
                                             
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      R
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                )
                                             
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ;
                                 
                                 
                                    
                                       e
                                    
                                    
                                       2
                                    
                                    
                                       
                                          I
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             r
                                             cos
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          
                                             max
                                             
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      R
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                )
                                             
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ;
                              
                           
                        
                     


                        
                           
                              
                                 e
                              
                              
                                 3
                              
                              
                                 
                                    I
                                 
                              
                           
                         is a line with two end points: 
                           
                              
                                 
                                    (
                                    −
                                    r
                                    ,
                                    
                                    
                                       
                                          −
                                          z
                                       
                                       
                                          p
                                       
                                       
                                          T
                                       
                                    
                                    sin
                                    
                                       (
                                       2
                                       π
                                       /
                                       9
                                       )
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                         and 
                           
                              
                                 
                                    (
                                    −
                                    r
                                    ,
                                    
                                    
                                       
                                          z
                                       
                                       
                                          p
                                       
                                       
                                          T
                                       
                                    
                                    sin
                                    
                                       (
                                       2
                                       π
                                       /
                                       9
                                       )
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                        ;


                        
                           
                              
                                 e
                              
                              
                                 4
                              
                              
                                 
                                    I
                                 
                              
                           
                         is a line with two end points: 
                           
                              
                                 
                                    (
                                    r
                                    ,
                                    
                                    
                                       
                                          −
                                          z
                                       
                                       
                                          p
                                       
                                       
                                          T
                                       
                                    
                                    sin
                                    
                                       (
                                       2
                                       π
                                       /
                                       9
                                       )
                                    
                                    
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                         and 
                           
                              
                                 
                                    (
                                    r
                                    ,
                                    
                                    sin
                                    
                                       (
                                       2
                                       π
                                       /
                                       9
                                       )
                                    
                                    
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                        .

An example of these four curves is given in Fig. 14
                        (a).

We define one more curve 
                           
                              
                                 c
                              
                              
                                 
                                    I
                                 
                              
                           
                         with 
                           v
                           =
                           2
                           π
                           /
                           9
                         for 
                           u
                           ∈
                           
                              [
                              −
                              π
                              ,
                              0
                              )
                           
                        : 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       
                                          I
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             r
                                             cos
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  p
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                             sin
                                             
                                                (
                                                2
                                                π
                                                /
                                                9
                                                −
                                                ω
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                     


                        
                           
                              
                                 c
                              
                              
                                 
                                    I
                                 
                              
                           
                         will coincide with 
                           
                              
                                 e
                              
                              
                                 1
                              
                              
                                 
                                    I
                                 
                              
                           
                         if, 
                           ∀
                           u
                           ∈
                           
                              [
                              −
                              π
                              ,
                              0
                              )
                           
                           ,
                           2
                           π
                           /
                           9
                           −
                           ω
                           ≤
                           π
                           /
                           2
                        ; otherwise there will be a closed region formed by 
                           
                              
                                 c
                              
                              
                                 
                                    I
                                 
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 1
                              
                              
                                 
                                    I
                                 
                              
                           
                        , i.e. Region Type 1 (
                           R
                           
                              
                                 T
                              
                              
                                 1
                              
                           
                        ) in Fig. 14(a). In case of a non-empty 
                           R
                           
                              
                                 T
                              
                              
                                 1
                              
                           
                        , let 
                           
                              
                                 B
                              
                              
                                 
                                    I
                                 
                              
                           
                           =
                           
                              {
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                                 
                                    
                                       I
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    c
                                 
                                 
                                    
                                       I
                                    
                                 
                              
                              }
                           
                         denote its boundary.


                        
                           
                              
                                 
                                    
                                       
                                          Reg
                                       
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        .

For 
                           u
                           ∈
                           
                              [
                              0
                              ,
                              π
                              ]
                           
                           ,
                           
                              
                                 x
                              
                              
                                 R
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         is also monotonic. Because 
                           
                              
                                 
                                 z
                              
                              
                                 p
                              
                              
                                 T
                              
                           
                           >
                           0
                           ,
                           
                           r
                           ≥
                           0
                        , and 
                           sin
                           
                              (
                              u
                              )
                           
                           ≥
                           0
                        , from Eq. (21) we have 
                           ω
                           ∈
                           
                              [
                              0
                              ,
                              π
                              /
                              2
                              )
                           
                        . Similar to 
                           
                              
                                 
                                    
                                       
                                          Reg
                                       
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        , we find the minimal and maximal value of 
                           
                              
                                 
                                 y
                              
                              
                                 R
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         as:

The minimum 
                           
                              
                                 
                                 y
                              
                              
                                 R
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         is: 
                           min
                           
                              (
                              
                                 
                                    y
                                 
                                 
                                    R
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              )
                           
                           
                           =
                           −
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       sin
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                p
                                             
                                             
                                                T
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                           sin
                           
                              (
                              2
                              π
                              /
                              9
                              −
                              ω
                              )
                           
                        .

The maximum 
                           
                              
                                 y
                              
                              
                                 R
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         can be divided into two cases: 
                           
                              
                                 max
                                 
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          R
                                       
                                       
                                          
                                             II
                                          
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  p
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                             
                                                (
                                                2
                                                π
                                                /
                                                9
                                                +
                                                ω
                                                )
                                             
                                             ≥
                                             π
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  p
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             sin
                                             
                                                (
                                                −
                                                2
                                                π
                                                /
                                                9
                                                −
                                                ω
                                                )
                                             
                                             ,
                                             
                                                (
                                                2
                                                π
                                                /
                                                9
                                                +
                                                ω
                                                )
                                             
                                             <
                                             π
                                             /
                                             2
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Thus, 
                           
                              
                                 H
                              
                              
                                 
                                    II
                                 
                              
                           
                         is also made of four curves, i.e., 
                           
                              
                                 H
                              
                              
                                 
                                    II
                                 
                              
                           
                           =
                           
                              {
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    2
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    3
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    4
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              }
                           
                        , as shown in Fig. 14(b): 
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                    
                                    
                                       
                                          II
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             r
                                             cos
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          
                                             max
                                             
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      R
                                                   
                                                   
                                                      
                                                         II
                                                      
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                )
                                             
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ;
                                 
                                 
                                    
                                       e
                                    
                                    
                                       2
                                    
                                    
                                       
                                          II
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             r
                                             cos
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          
                                             min
                                             
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      R
                                                   
                                                   
                                                      
                                                         II
                                                      
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                )
                                             
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ;
                              
                           
                        
                     


                        
                           
                              
                                 e
                              
                              
                                 3
                              
                              
                                 
                                    II
                                 
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 4
                              
                              
                                 
                                    II
                                 
                              
                           
                         are lines coinciding with 
                           
                              
                                 e
                              
                              
                                 3
                              
                              
                                 
                                    I
                                 
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 4
                              
                              
                                 
                                    I
                                 
                              
                           
                        , respectively.

Akin to 
                           
                              
                                 c
                              
                              
                                 
                                    I
                                 
                              
                           
                        , we define a curve 
                           
                              
                                 c
                              
                              
                                 
                                    II
                                 
                              
                           
                         with 
                           v
                           =
                           −
                           2
                           π
                           /
                           9
                         for 
                           u
                           ∈
                           
                              [
                              0
                              ,
                              π
                              ]
                           
                        : 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       
                                          II
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             r
                                             cos
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  p
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                             sin
                                             
                                                (
                                                −
                                                2
                                                π
                                                /
                                                9
                                                −
                                                ω
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Similar to that for 
                           
                              
                                 c
                              
                              
                                 
                                    I
                                 
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 
                                    II
                                 
                              
                           
                         will coincide with 
                           
                              
                                 e
                              
                              
                                 1
                              
                              
                                 
                                    II
                                 
                              
                           
                         if, 
                           ∀
                           u
                           ∈
                           
                              [
                              0
                              ,
                              π
                              ]
                           
                           ,
                           
                           2
                           π
                           /
                           9
                           +
                           ω
                           ≤
                           π
                           /
                           2
                        ; otherwise there will be a closed region formed by 
                           
                              
                                 c
                              
                              
                                 
                                    II
                                 
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 1
                              
                              
                                 
                                    II
                                 
                              
                           
                        , e.g., 
                           R
                           
                              
                                 T
                              
                              
                                 5
                              
                           
                         in Fig. 14(b). Similarly, for a non-empty 
                           R
                           
                              
                                 T
                              
                              
                                 5
                              
                           
                        , its boundary is defined as 
                           
                              
                                 B
                              
                              
                                 
                                    II
                                 
                              
                           
                           =
                           
                              {
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    c
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              }
                           
                        .

Examples of 
                           
                              
                                 H
                              
                              
                                 
                                    I
                                 
                              
                           
                           ,
                           
                              
                                 
                                 H
                              
                              
                                 
                                    II
                                 
                              
                           
                           ,
                           
                              
                                 B
                              
                              
                                 
                                    I
                                 
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 
                                    II
                                 
                              
                           
                         are shown in Fig. 14. For the 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                         defined by Eq. (22), 
                           
                              
                                 
                                    
                                       
                                          Reg
                                       
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                         includes 
                           R
                           
                              
                                 T
                              
                              
                                 2
                              
                           
                           ,
                           R
                           
                              
                                 T
                              
                              
                                 3
                              
                           
                         and the double of 
                           R
                           
                              
                                 T
                              
                              
                                 1
                              
                           
                         (if any); while 
                           
                              
                                 
                                    
                                       
                                          Reg
                                       
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                         includes 
                           R
                           
                              
                                 T
                              
                              
                                 3
                              
                           
                           ,
                           R
                           
                              
                                 T
                              
                              
                                 4
                              
                           
                         and the double of 
                           R
                           
                              
                                 T
                              
                              
                                 5
                              
                           
                         (if any).

Let us take a closer look at the examples in Figs. 14 and 15(a). For a point 
                           p
                         on the part surface, its 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                         represents the ranges of the 
                           A
                         and 
                           C
                         axis with which 
                           p
                         is accessible to the tool. For any point 
                           
                              
                                 p
                              
                              
                                 ∗
                              
                           
                         in 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                        , there may be more than one way for 
                           A
                         and 
                           C
                         to rotate to make the 
                           p
                         coincide with 
                           
                              
                                 p
                              
                              
                                 ∗
                              
                           
                         in the 
                           
                              
                                 x
                              
                              
                                 m
                              
                           
                           
                              
                                 o
                              
                              
                                 m
                              
                           
                           
                              
                                 y
                              
                              
                                 m
                              
                           
                         plane. This is exactly the multiple Inverse Kinematics Solution (IKS) problem in five-axis machining (cf.  [32,33]). With any 
                           
                              
                                 
                                 p
                              
                              
                                 ∗
                              
                           
                        , the IKS of 
                           A
                         or 
                           C
                         will have multiple solutions when 
                           
                              
                                 p
                              
                              
                                 ∗
                              
                           
                         lies in 
                           R
                           
                              
                                 T
                              
                              
                                 1
                              
                           
                           ,
                           R
                           
                              
                                 T
                              
                              
                                 3
                              
                           
                         and 
                           R
                           
                              
                                 T
                              
                              
                                 5
                              
                           
                        , but only a single solution when 
                           
                              
                                 p
                              
                              
                                 ∗
                              
                           
                         lies in 
                           R
                           
                              
                                 T
                              
                              
                                 2
                              
                           
                         and 
                           R
                           
                              
                                 T
                              
                              
                                 4
                              
                           
                        . The exact solution branches and their ranges for the IKT of 
                           A
                         and 
                           C
                         are listed inTable 1
                        .

For 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        , its projection in the 
                           
                              
                                 x
                              
                              
                                 m
                              
                           
                           
                              
                                 o
                              
                              
                                 m
                              
                           
                           
                              
                                 y
                              
                              
                                 m
                              
                           
                         plane, to be denoted as 
                           
                              
                                 
                                    MCS
                                 
                              
                              
                                 x
                                 o
                                 y
                              
                           
                           
                              (
                              
                                 
                                    
                                       Obs
                                    
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              )
                           
                        , represents the potential forbidden ranges of the 
                           A
                         and 
                           C
                         axis. For an arbitrary point 
                           p
                         on the part surface, to reflect the obstruction by this 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                           ,
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                         should intersect with 
                           
                              
                                 
                                    MCS
                                 
                              
                              
                                 x
                                 o
                                 y
                              
                           
                           
                              (
                              
                                 
                                    
                                       Obs
                                    
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              )
                           
                        ; or to be more specific, its 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                                 
                              
                           
                         must be eclipsed by 
                           
                              
                                 
                                    MCS
                                 
                              
                              
                                 x
                                 o
                                 y
                              
                           
                           
                              (
                              
                                 
                                    
                                       Obs
                                    
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              )
                           
                        . For simplicity of discussion, let 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                         be a tetrahedron whose 
                           
                              
                                 x
                              
                              
                                 m
                              
                           
                           
                              
                                 o
                              
                              
                                 m
                              
                           
                           
                              
                                 y
                              
                              
                                 m
                              
                           
                         projection is a triangle 
                           △
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                         (see Fig. 12). From Table 1, 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                         can be partitioned into four sub-regions, i.e., 
                           R
                           
                              
                                 T
                              
                              
                                 1
                              
                           
                           ,
                           R
                           
                              
                                 T
                              
                              
                                 3
                              
                           
                           ∪
                           
                              
                                 R
                                 T
                              
                              
                                 2
                              
                           
                           ∪
                           
                              
                                 R
                                 T
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 R
                                 T
                              
                              
                                 5
                              
                           
                           ∪
                           
                              
                                 R
                                 T
                              
                              
                                 4
                              
                           
                           ∪
                           
                              
                                 R
                                 T
                              
                              
                                 3
                              
                           
                        , and 
                           
                              
                                 R
                                 T
                              
                              
                                 5
                              
                           
                        , and their corresponding ranges of 
                           A
                         and 
                           C
                         are given in Table 2
                        . Intersection between 
                           △
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                         and all the sub-regions should be performed, as shown in Fig. 15(b)–(e). Any point in the intersection, e.g., the sub-region shown in Fig. 15(b), will pose a forbidden direction after 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                         is transformed into the LCS of 
                           p
                         by FKT. Note that the region 
                           
                           
                              {
                              △
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    m
                                 
                                 
                                    3
                                 
                              
                              −
                              
                                 
                                    
                                       Reg
                                    
                                 
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                              }
                           
                        , if non-empty as shown in Fig. 15(f), has no impact on the 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        -map of 
                           p
                        .

The intersection between 
                           △
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                         and the sub-regions of 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                                 
                              
                              
                                 2
                                 
                              
                           
                         involves calculating the intersections between lines (edges of 
                           △
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 y
                              
                              
                                 m
                              
                           
                         axis) and the four groups of boundary curves 
                           
                              
                                 H
                              
                              
                                 
                                    I
                                 
                              
                           
                           ,
                           
                              
                                 H
                              
                              
                                 
                                    II
                                 
                              
                           
                           ,
                           
                              
                                 B
                              
                              
                                 
                                    I
                                 
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 
                                    II
                                 
                              
                           
                        , resulting in intersection points such as 
                           
                              {
                              
                                 
                                    n
                                 
                                 
                                    b
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    n
                                 
                                 
                                    b
                                    2
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    b
                                    3
                                 
                              
                              }
                           
                         and 
                           
                              {
                              
                                 
                                    n
                                 
                                 
                                    c
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    n
                                 
                                 
                                    c
                                    2
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    c
                                    3
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    c
                                    4
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    c
                                    5
                                 
                              
                              }
                           
                         in Fig. 15(b) and (c). These intersection points are calculated analytically as all the 
                           
                              
                                 H
                              
                              
                                 
                                    I
                                 
                              
                           
                           ,
                           
                           
                              
                                 H
                              
                              
                                 
                                    II
                                 
                              
                           
                           ,
                           
                              
                                 B
                              
                              
                                 
                                    I
                                 
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 
                                    II
                                 
                              
                           
                         are algebraic. However, since their expressions are very complex, the details are omitted here.

One note is needed: when defining the double-touching condition (Fig. 12), the entire tool assembly is assumed to be a line. But in real situation, the size of the tool and its holder can never be ignored. Our remedy for this is to replace 
                           
                              
                                 
                                    MCS
                                 
                              
                              
                                 x
                                 o
                                 y
                              
                           
                           
                              (
                              
                                 
                                    
                                       Obs
                                    
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              )
                           
                         with its outward offset, with an offsetting distance of 2
                           d
                        . If the tool assembly and spindle head are modeled as several cylinders with different radii, to guarantee the safety of machining process, we adopt the most conservative method: 
                           d
                         is chosen as the largest radius among all the cylinders. With 
                           d
                         specified, the 
                           △
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                         in Sections  5.2 and 5.3 should all be replaced by its outward offset.

With a given setup 
                           
                              
                                 
                                    Set
                                 
                              
                              
                                 ∗
                              
                           
                        , the intersection region 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                           ∩
                           
                              
                                 
                                    MCS
                                 
                              
                              
                                 x
                                 o
                                 y
                              
                           
                           
                              (
                              
                                 
                                    
                                       Obs
                                    
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              )
                           
                         (Fig. 15) can be found; we next need to calculate the IKS of 
                           A
                         and 
                           C
                         for every point in this region. For this task, Table 2 must be referred to, as 
                           A
                         and 
                           C
                         have different ranges in different sub-regions of 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                           ∩
                           
                              
                                 
                                    MCS
                                 
                              
                              
                                 x
                                 o
                                 y
                              
                           
                           
                              (
                              
                                 
                                    
                                       Obs
                                    
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              )
                           
                        .

Let 
                           S
                           R
                           =
                           
                              {
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    k
                                 
                              
                              }
                           
                           ,
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    n
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    n
                                    i
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    n
                                    i
                                 
                              
                              )
                           
                        , be the vertices on the boundary of such an intersection sub-region, e.g., 
                           
                              {
                              
                                 
                                    n
                                 
                                 
                                    c
                                    1
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    c
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    c
                                    5
                                 
                              
                              }
                           
                         in Fig. 15(c). For a point 
                           p
                         on the part surface shown in Fig. 1, per Eq. (15), its coordinates in the TCS are 
                           
                              
                                 p
                              
                              
                                 T
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              )
                           
                        , which are then transformed to 
                           
                              
                                 p
                              
                              
                                 M
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    p
                                 
                                 
                                    M
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                                 
                                    M
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    p
                                 
                                 
                                    M
                                 
                              
                              )
                           
                         in the MCS by:
                           
                              (23)
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                p
                                             
                                             
                                                M
                                             
                                          
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    Rot
                                 
                                 
                                    (
                                    x
                                    ,
                                    A
                                    )
                                 
                                 ∗
                                 
                                    Rot
                                 
                                 
                                    (
                                    z
                                    ,
                                    C
                                    )
                                 
                                 ∗
                                 
                                    
                                       
                                          [
                                          
                                             
                                                p
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     

Substitute 
                           
                              
                                 p
                              
                              
                                 T
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              )
                           
                         into Eq. (23) and expand it, we get the projection of 
                           
                              
                                 p
                              
                              
                                 M
                              
                           
                         in the 
                           
                              
                                 x
                              
                              
                                 m
                              
                           
                           
                              
                                 o
                              
                              
                                 m
                              
                           
                           
                              
                                 y
                              
                              
                                 m
                              
                           
                         plane: 
                           
                              (24)
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   p
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   p
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   p
                                                
                                                
                                                   T
                                                
                                             
                                             cos
                                             
                                                (
                                                C
                                                )
                                             
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   p
                                                
                                                
                                                   T
                                                
                                             
                                             sin
                                             
                                                (
                                                C
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   p
                                                
                                                
                                                   T
                                                
                                             
                                             cos
                                             
                                                (
                                                A
                                                )
                                             
                                             sin
                                             
                                                (
                                                C
                                                )
                                             
                                             +
                                             
                                                
                                                   y
                                                
                                                
                                                   p
                                                
                                                
                                                   T
                                                
                                             
                                             cos
                                             
                                                (
                                                A
                                                )
                                             
                                             cos
                                             
                                                (
                                                C
                                                )
                                             
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   p
                                                
                                                
                                                   T
                                                
                                             
                                             sin
                                             
                                                (
                                                A
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

If 
                           
                              
                                 p
                              
                              
                                 M
                              
                           
                         is inside 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                           ∩
                           
                              
                                 
                                    MCS
                                 
                              
                              
                                 x
                                 o
                                 y
                              
                           
                           
                              (
                              
                                 
                                    
                                       Obs
                                    
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              )
                           
                           ,
                           p
                         will be inaccessible due to 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        . In particular, suppose a pair of angles (
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                        ) rotates 
                           p
                         to coincide with 
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                        , i.e., 
                           
                              (25)
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          p
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          p
                                       
                                       
                                          M
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          n
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          n
                                          i
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Combine Eq. (24) with Eq. (25), we can solve the analytical solutions of 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                        : 
                           
                              (26)
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             2
                                             
                                             a
                                             
                                             
                                                tan
                                             
                                             
                                                (
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            p
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      ±
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           p
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           p
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           n
                                                                           i
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            p
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            n
                                                            i
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             2
                                             
                                             a
                                             
                                             
                                                tan
                                             
                                             
                                                (
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            p
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      ±
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           p
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     sin
                                                                     
                                                                        (
                                                                        C
                                                                        )
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           p
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     cos
                                                                     
                                                                        (
                                                                        C
                                                                        )
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           p
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           n
                                                                           i
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            n
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            p
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      sin
                                                      
                                                         (
                                                         C
                                                         )
                                                      
                                                      +
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            p
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      cos
                                                      
                                                         (
                                                         C
                                                         )
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

As seen in Eq. (26), we must decide the correct ranges for solving both 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                        . In Eq. (26), the range of 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         is 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           ∈
                           
                              [
                              −
                              π
                              ,
                              π
                              ]
                           
                        , with the range length of 
                           2
                           π
                        . However, from Eq. (17) we know that 
                           C
                         is a function of 
                           u
                         and its range is 
                           
                              [
                              −
                              π
                              −
                              α
                              ,
                              
                              π
                              −
                              α
                              ]
                           
                        . Define 
                           
                              
                                 u
                              
                              
                                 i
                              
                              
                                 ∗
                              
                           
                         according to the value of 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         for the two following cases: 
                           
                              (1)
                              When 
                                    α
                                    ≥
                                    0
                                 : 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                             
                                                ∗
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      a
                                                      −
                                                      2
                                                      π
                                                      ,
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      a
                                                      >
                                                      π
                                                      ;
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      a
                                                      ,
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      a
                                                      ≤
                                                      π
                                                      −
                                                      a
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

When 
                                    α
                                    <
                                    0
                                 : 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                             
                                                ∗
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      a
                                                      +
                                                      2
                                                      π
                                                      ,
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      a
                                                      ≤
                                                      −
                                                      π
                                                      ;
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      a
                                                      ,
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      a
                                                      >
                                                      −
                                                      π
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

Because the range of 
                           C
                         in each sub-region of 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                           ∩
                           
                              
                                 
                                    MCS
                                 
                              
                              
                                 x
                                 o
                                 y
                              
                           
                           
                              (
                              
                                 
                                    
                                       Obs
                                    
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              )
                           
                         is represented by the range of 
                           u
                           ,
                           
                              
                                 u
                              
                              
                                 i
                              
                              
                                 ∗
                              
                           
                         is defined for the purpose of choosing the correct analytical solution in each sub-region. From Table 2, the two angles 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         are constrained to certain different ranges depending on the sub-regions. For example, for the sub-region in Fig. 15(c), 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ∈
                           
                              [
                              −
                              π
                              /
                              2
                              +
                              ω
                              ,
                              
                              2
                              π
                              /
                              9
                              ]
                           
                         and 
                           
                              
                                 u
                              
                              
                                 i
                              
                              
                                 ∗
                              
                           
                           ∈
                           
                              [
                              0
                              ,
                              π
                              ]
                           
                        . With the constraints of 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 u
                              
                              
                                 i
                              
                              
                                 ∗
                              
                           
                         from Table 2, we can find only one IKS for (
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ,
                           
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                        ). Let 
                           I
                           A
                           =
                           
                              {
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ,
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              ,
                              …
                              ,
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       C
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              }
                           
                         represent the thus obtained unique IK solutions for 
                           S
                           R
                           =
                           
                              {
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    k
                                 
                              
                              }
                           
                        . The IKT process is carried out for all the nodes of the four sub-regions; those IKSs of 
                           A
                         and 
                           C
                         are then used to calculate 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                         in the LCS of 
                           p
                         by FKT.

Similar to the construction of the 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        -map, to build the 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        -map of a 
                           p
                         due to an 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                           ,
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                         needs to be transformed to the LCS of 
                           p
                        . Our final step in building the 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        -map of 
                           p
                         is to, for a given setup and 
                           I
                           A
                        , transform the 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                         from the MCS to the LCS of 
                           p
                        . Let us use the tetrahedral 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                           
                              {
                              b
                              1
                              ,
                              b
                              2
                              ,
                              b
                              3
                              ,
                              b
                              4
                              }
                           
                         in Fig. 12(a) as an example, where 
                           
                              
                                 b
                              
                              
                                 j
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    b
                                    j
                                 
                                 
                                    M
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    b
                                    j
                                 
                                 
                                    M
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    b
                                    j
                                 
                                 
                                    M
                                 
                              
                              )
                           
                         for 
                           j
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           4
                        . Consider any one (
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ,
                           
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                        ) in 
                           I
                           A
                        , e.g., 
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              )
                           
                        , and let 
                           
                              
                                 b
                              
                              
                                 j
                              
                              
                                 L
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    b
                                    j
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    b
                                    j
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    b
                                    j
                                 
                                 
                                    L
                                 
                              
                              )
                           
                         be the vertex 
                           
                              
                                 b
                              
                              
                                 j
                              
                           
                         in the LCS due to (
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                        ). We have: 
                           
                              (27)
                              
                                 
                                    Rot
                                 
                                 
                                    (
                                    x
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∗
                                 
                                    Rot
                                 
                                 
                                    (
                                    z
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∗
                                 
                                    
                                       T
                                    
                                    
                                       W
                                       →
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    Trans
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          p
                                       
                                       
                                          W
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          p
                                       
                                       
                                          W
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          p
                                       
                                       
                                          W
                                       
                                    
                                    )
                                 
                                 ∗
                                 
                                    
                                       
                                          [
                                          
                                             
                                                b
                                             
                                             
                                                j
                                             
                                             
                                                L
                                             
                                          
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       
                                          [
                                          
                                             
                                                b
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     

Then: 
                           
                              (28)
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                b
                                             
                                             
                                                j
                                             
                                             
                                                L
                                             
                                          
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    Trans
                                 
                                 
                                    (
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          p
                                       
                                       
                                          W
                                       
                                    
                                    ,
                                    
                                       
                                          −
                                          y
                                       
                                       
                                          p
                                       
                                       
                                          W
                                       
                                    
                                    ,
                                    
                                       
                                          −
                                          z
                                       
                                       
                                          p
                                       
                                       
                                          W
                                       
                                    
                                    )
                                 
                                 ∗
                                 
                                    
                                       T
                                    
                                    
                                       T
                                       →
                                       W
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    Rot
                                 
                                 
                                    (
                                    z
                                    ,
                                    −
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∗
                                 
                                    Rot
                                 
                                 
                                    (
                                    x
                                    ,
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∗
                                 
                                    
                                       
                                          [
                                          
                                             
                                                b
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                          1
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                              
                           
                         where: 
                           
                              
                                 p
                              
                              
                                 W
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    p
                                 
                                 
                                    W
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                                 
                                    W
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    p
                                 
                                 
                                    W
                                 
                              
                              )
                           
                         is the coordinates of point 
                           p
                         in the WCS; 
                           
                              
                                 T
                              
                              
                                 T
                                 →
                                 W
                              
                              
                                 ∗
                              
                           
                         is the transformation given in Eq. (11).

Therefore, under the 
                           A
                        –
                           C
                         rotation 
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , the tetrahedral 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                           
                              {
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    4
                                 
                              
                              }
                           
                         is transformed into four vertices 
                           
                              {
                              
                                 
                                    b
                                 
                                 
                                    i
                                    ,
                                    1
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                              
                                 
                                    b
                                 
                                 
                                    i
                                    ,
                                    2
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    i
                                    ,
                                    3
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                              
                                 
                                    b
                                 
                                 
                                    i
                                    ,
                                    4
                                 
                                 
                                    L
                                 
                              
                              }
                           
                         in the LCS of 
                           p
                        . As there are 
                           k
                         such 
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         in 
                           I
                           A
                        , in total there will be 
                           4
                           k
                         such vertices in the LCS of 
                           p
                        , to be expressed as 
                           
                              
                                 N
                              
                              
                                 p
                                 ,
                                 S
                                 R
                              
                           
                           =
                           
                              {
                              
                                 
                                    b
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    L
                                 
                              
                              |
                              
                                 (
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 k
                                 )
                              
                              ,
                              
                              
                                 (
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 4
                                 )
                              
                              }
                           
                        . We next generate the 3-D convex hull 
                           
                              
                                 C
                                 H
                              
                              
                                 3
                              
                           
                           
                              (
                              
                                 
                                    N
                                 
                                 
                                    p
                                    ,
                                    S
                                    R
                                 
                              
                              )
                           
                         of 
                           
                              
                                 N
                              
                              
                                 p
                                 ,
                                 S
                                 R
                              
                           
                        . All the rays from 
                           p
                         to 
                           
                              
                                 C
                                 H
                              
                              
                                 3
                              
                           
                           
                              (
                              
                                 
                                    N
                                 
                                 
                                    p
                                    ,
                                    S
                                    R
                                 
                              
                              )
                           
                         are then regarded as the forbidden directions of 
                           p
                         due to the 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                           
                              {
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    4
                                 
                              
                              }
                           
                        .

Note that the above procedure pertains to only one sub-region in the intersection 
                           
                              
                                 
                                    Reg
                                 
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                           ∩
                           
                              
                                 
                                    MCS
                                 
                              
                              
                                 x
                                 o
                                 y
                              
                           
                           
                              (
                              
                                 
                                    
                                       Obs
                                    
                                 
                                 
                                    
                                       II
                                    
                                 
                              
                              )
                           
                        . If there are multiple such sub-regions, e.g., Fig. 15, they are processed separately. Also, while tremendously simplifying the complexity of the algorithm, using the convex hull 
                           
                              
                                 C
                                 H
                              
                              
                                 3
                              
                           
                           
                              (
                              
                                 
                                    N
                                 
                                 
                                    p
                                    ,
                                    S
                                    R
                                 
                              
                              )
                           
                         from the IKT of nodes in each sub-region nonetheless might be too conservative. Alternatively, one could sample more points on the boundary of the sub-region, obtain a larger 
                           
                              
                                 N
                              
                              
                                 p
                                 ,
                                 S
                                 R
                              
                           
                        , and use it directly instead of its convex hull.

As 
                           
                              
                                 C
                                 H
                              
                              
                                 3
                              
                           
                           
                              (
                              
                                 
                                    N
                                 
                                 
                                    p
                                    ,
                                    S
                                    R
                                 
                              
                              )
                           
                         is now defined in the LCS of 
                           p
                        , its treatment for calculation the discretized 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        -map in 
                           α
                           –
                           β
                         plane will be identical to that for the 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    I
                                 
                              
                           
                        . The final 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        -map for 
                           p
                         is then the union of all the 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        -maps due to all the sub-regions of all the 
                           
                              
                                 
                                    Obs
                                 
                              
                              
                                 
                                    II
                                 
                              
                           
                        .

We have accomplished our primary task. To summarize, given a mesh part surface 
                        S
                      (the workpiece), the specific 
                        A
                     –
                        C
                      type five-axis machine (Fig. 1), the Type 1 obstacle 
                        
                           
                              H
                           
                           
                              1
                           
                        
                      and Type 2 obstacle 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      represented as convex polyhedrons, and an arbitrary 6-tuple setup parameters 
                        
                           (
                           a
                           ,
                           b
                           ,
                           c
                           ,
                           φ
                           ,
                           θ
                           ,
                           ψ
                           )
                        
                     , for any vertex 
                        p
                      on 
                        S
                     , all the tool orientations for the tool to contact it without any obstacle-collision are uniquely represented by its global visibility map 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map(
                        p
                     ), which is a continuous region in its spherical angle 
                        α
                        –
                        β
                      plane. From Eq. (8), 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map (
                        p
                     ) can be constructed by subtracting 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map (
                        p
                     ) and 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 II
                              
                           
                        
                     -map (
                        p
                     ) from 
                        
                           V
                        
                     -map (
                        p
                     ), and for this purpose, we have presented efficient algorithms to compute the 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map and 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 II
                              
                           
                        
                     -map and established rigorous analytical expressions for 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map (
                        p
                     ) as functions of 
                        
                           (
                           a
                           ,
                           b
                           ,
                           c
                           ,
                           φ
                           ,
                           θ
                           ,
                           ψ
                           )
                        
                     . When planning a tool path for machining 
                        S
                     , once the workpiece setup is decided, the tool axis direction for point 
                        p
                      then can be chosen from 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map (
                        p
                     ), which is guaranteed to be collision free in the machining process.

To verify our results, we utilize 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -maps and present a heuristic algorithm for the minimum workpiece setups problem: find a minimum set of setups so that every (sample) point on part surface 
                        S
                      can be accessed by the tool without any obstacle-collision. A computationally feasible approach to this apparently NP-hard problem is the following greedy method: each time a setup is sought that tries to maximize the number of accessible point among the remaining sample points; these sample points are then removed from the set of remaining sample points and another setup is sought for the now smaller set of remaining sample points, until all the sample points are taken care of (cf.  [6]). In our setting, this means finding a setup that will maximize the number of the 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -maps that are intersected by the TAD, with both the 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -maps and TAD being functions of the setup. Understandably, due to the concern of numerical stability and also the desire for more freedom in selecting the tool axis, a larger intersection area between the 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map and TAD is preferred. In other words, given two setups that realize the same number of 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -maps intersected by the TAD, the one whose TAD intersects a larger area of the 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -maps should be preferred. For instance, in the example shown in Fig. 16
                     , although the TADs of both setups intersect three 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -maps, Setup 1 should obviously be preferred.

To tend to both the number of intersected 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -maps and the actual intersection area, the following weighted maximization optimization formulation is adopted by us: 
                        
                           (29)
                           
                              F
                              
                                 (
                                 a
                                 ,
                                 b
                                 ,
                                 c
                                 ,
                                 φ
                                 ,
                                 θ
                                 ,
                                 ψ
                                 )
                              
                              =
                              M
                              ∗
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 Index
                              
                              
                                 (
                                 i
                                 )
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              S
                              
                                 (
                                 i
                                 )
                              
                           
                        
                      where:


                     
                        n
                      is the number of sample points on the part surface;


                     
                        M
                      is a large positive number, which ensures that the intersection number has higher priority over intersection area;


                     Index is an 
                        n
                     -vector that represents the intersection relation between the TAD and the 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -maps: if TAD(
                        
                           setup
                        
                     ) intersects the 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map of the 
                        i
                     th sample point, 
                        
                           Index
                        
                        
                           (
                           i
                           )
                        
                        =
                        1
                     ; otherwise, 
                        
                           Index
                        
                        
                           (
                           i
                           )
                        
                        =
                        0
                     ;


                     
                        S
                        
                           (
                           i
                           )
                        
                      is the intersection area between TAD(
                        
                           setup
                        
                     ) and the 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map of the 
                        i
                     th sample point in its discretized 
                        α
                        –
                        β
                      plane, which is a non-negative integer (the number of the intersected grid).

Eq. (29) is then our reduced optimization problem. Due to the inordinately high complexity of both 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map and 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 II
                              
                           
                        
                     -map as functions of 
                        
                           (
                           a
                           ,
                           b
                           ,
                           c
                           ,
                           φ
                           ,
                           θ
                           ,
                           ψ
                           )
                        
                     , it is virtually impossible to solve the problem analytically. Instead, heuristic-based numerical optimization methods should be adopted. In our current system, a Genetic Algorithm (GA) is used.

The whole optimization procedure for the minimum workpiece setups problem in five-axis machining can be outlined as follows.


                     Procedure Minimum_Workpiece_Setups
                  


                     
                        Input
                     . 
                        n
                      sample points on the part surface, as 
                        
                           
                              P
                           
                           
                              s
                           
                        
                        =
                        
                           {
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 p
                              
                              
                                 n
                              
                           
                           }
                        
                     ; 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      in the TCS; 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                      in MCS; the radius 
                        r
                      of tool (see Appendix); and other necessary sampling thresholds.


                     
                        Output
                     . A set 
                        Ω
                      of setups 
                        
                           1.
                           Calculate the 
                                 
                                    V
                                 
                              -maps of the 
                                 n
                               sample points using the method in Section  3, taking 
                                 r
                               into consideration; set 
                                 Ω
                               to nil.


                              WHILE
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                                 ≠
                                 0̸
                               Do { 
                                 
                                    2.1
                                    
                                       
                                          
                                             
                                                
                                                   Setup
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                          ←
                                        Result of applying GA to the optimization Eq. (29) for the points in 
                                          
                                             
                                                P
                                             
                                             
                                                s
                                             
                                          
                                       
                                    

Remove from 
                                          
                                             
                                                P
                                             
                                             
                                                s
                                             
                                          
                                        those sample points whose 
                                          
                                             
                                                
                                                   V
                                                
                                             
                                             
                                                g
                                             
                                          
                                       -maps under 
                                          
                                             
                                                
                                                   Setup
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                        have non-empty intersections with TAD(
                                          
                                             
                                                
                                                   Setup
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                       ).

Add 
                                          
                                             
                                                
                                                   Setup
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                        to 
                                          Ω
                                       .}


                              END
                           

To ratify the results obtained in this paper, a prototype computer program is implemented using MATLab on an averagely configured PC and a preliminary experiment in simulation is conducted to test the presented heuristic optimization algorithm for the minimum workpiece setups problem. Refer to Fig. 17
                      for the setting of the experiment. There are four 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      (yellow boxes) defined in the TCS and two 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                      (red tetrahedrons) defined in the MCS. (Note that physically 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      should never collide with 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                      when the machine table rotates.) We choose the five-axis machine shown in Fig. 1 as the machine and the car seat surface in Fig. 6 as the part surface for the test. The rotary ranges for 
                        A
                      and 
                        C
                      are set to be consistent throughout the paper, i.e., 
                        A
                        ∈
                        
                           [
                           −
                           2
                           π
                           /
                           9
                           ,
                           
                           2
                           π
                           /
                           9
                           ]
                        
                      and 
                        C
                        ∈
                        
                           [
                           −
                           π
                           ,
                           
                           π
                           ]
                        
                     . The tool is of flat-end type with a radius of 
                        r
                        =
                        20
                      units, whereas the grid sampling thresholds for 
                        a
                      and 
                        b
                      are set to be 
                        △
                        α
                        =
                        1
                        °
                      and 
                        △
                        β
                        =
                        2
                        °
                     .

For the workpiece mounted on the table, there are two limitations for its setup. The first is that the workpiece should never collide with 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      and 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                     ; the other is that the setup of the workpiece should be within the dimensional limits of the table. Assume that the workpiece lies inside a bounding sphere, and the range of the setup can be determined by restraining the bounding sphere to be both on the table and collision-free of 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      and 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                     . In this experiment,with these two constraints, the lower and upper bounds for the six parameters of setup are 
                        
                           [
                           −
                           325
                           ,
                           
                           −
                           50
                           ,
                           
                           −
                           10
                           ,
                           −
                           π
                           ,
                           
                           0
                           ,
                           
                           −
                           π
                           ]
                        
                      and 
                        
                        
                           [
                           325
                           ,
                           
                           820
                           ,
                           
                           100
                           ,
                           
                           π
                           ,
                           
                           π
                           /
                           2
                           ,
                           
                           π
                           ]
                        
                     , respectively.

The experiment is first carried out with some arbitrary yet intuitive setups, which are usually chosen in real machining.

The first setup is 
                        
                           setup
                        
                        
                           1
                        
                        =
                        
                           [
                           0
                           ,
                           
                           0
                           ,
                           
                           0
                           ,
                           
                           0
                           ,
                           
                           0
                           ,
                           
                           0
                           ]
                        
                     , which means the WCS coincides with the TCS, as shown in Fig. 18
                     (b). For 
                        
                           setup
                        
                        
                           1
                        
                     , based on our algorithm, 83 out of the total of 102 sample points can be collision-freely accessed by the tool, as marked by the black dots in Fig. 18(a). In Fig. 18, the triangles that are accessible to the tool with 
                        
                           setup
                        
                        
                           1
                        
                      are colored red (assuming the sample density is high enough that a triangle is accessible if all its three vertices are accessible).

For the inaccessible sample points left after 
                        
                           setup
                        
                        
                           1
                        
                     , another setup 
                        
                           setup
                        
                        
                           2
                        
                        =
                        
                           [
                           100
                           ,
                           
                           400
                           ,
                           
                           0
                           ,
                           
                           0
                           ,
                           
                           0
                           ,
                           
                           0
                           ]
                        
                      is added. Geometrically this means to move the workpiece on the table with only translation from the last setup, with the position of the workpiece now set in the middle of the table, as shown in Fig. 19
                     (b). In 
                        
                           setup
                        
                        
                           2
                        
                     , 14 out of the remaining 19 sample points now become accessible, marked also by the black dots, and the newly added accessible triangles are colored yellow in Fig. 19.

As there is still some area in the part surface remaining inaccessible after the two setups, a third setup 
                        
                           setup
                        
                        
                           3
                        
                        =
                        
                           [
                           100
                           ,
                           
                           400
                           ,
                           
                           0
                           ,
                           
                           0
                           ,
                           
                           0
                           ,
                           
                           π
                           /
                           3
                           ]
                        
                      is adopted; this time, the workpiece is rotated on the TCS without translation, as shown in Fig. 20
                     (b). With 
                        
                           setup
                        
                        
                           3
                        
                     , our algorithm finds four out of the five remaining sample points to be accessible, as darkened in Fig. 20(a), which adds 14 more accessible triangles (colored in magenta).

To finish off the process, we need one more setup 
                        
                           setup
                        
                        
                           4
                        
                        =
                        
                           [
                           325
                           ,
                           
                           820
                           ,
                           
                           0
                           ,
                           
                           π
                           /
                           3
                           ,
                           
                           π
                           /
                           4
                           ,
                           
                           π
                           /
                           5
                           ]
                        
                     , as shown in Fig. 21
                     (b). The workpiece this time is set on the right end of the table, with an arbitrary orientation 
                        
                           [
                           π
                           /
                           3
                           ,
                           
                           π
                           /
                           4
                           ,
                           
                           π
                           /
                           5
                           ]
                        
                     . With this setup, the lone remaining inaccessible sample point as well as its incident four triangles becomes accessible (shown in black and cyan respectively in Fig. 21).

With the above four setups, the whole surface can be machined.

In 
                        
                           setup
                        
                        
                           1
                        
                      and 
                        
                           setup
                        
                        
                           2
                        
                      the workpiece has different positions (although of the same orientation) on the table. From the results shown in Figs. 18 and 19, we see that with 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      and 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                     , the position of the WCS on the TCS can affect the accessibility of the part surface. This confirms the statements made in Section  2. On the other hand,with 
                        
                           setup
                        
                        
                           2
                        
                      and 
                        
                           setup
                        
                        
                           3
                        
                     , the workpiece has different orientations only (i.e., the origin of the WCS remains the same), and the results in Figs. 19 and 20 also show the impact on the accessibility.

Next, we run our optimization procedure Minimum_Workpiece_Setups, with an initial setup 
                        
                           [
                           0
                           ,
                           0
                           ,
                           0
                           ,
                           0
                           ,
                           0
                           ,
                           0
                           ]
                        
                     , the program outputs only one setup 
                        
                           
                              
                                 setup
                              
                           
                           
                              ∗
                           
                        
                        =
                        
                           [
                           0.94
                           ,
                           
                           0.73
                           ,
                           
                           0.16
                           ,
                           
                           0.40
                           ,
                           
                           0.34
                           ,
                           
                           0.08
                           ]
                        
                     , as shown in Fig. 22
                     (b). With this single setup, all the sample points on the part surface are now accessible to the tool, free of 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      and 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 II
                              
                           
                        
                      and within the ranges of the 
                        A
                      and 
                        C
                      axis.

Regarding the computational efficiency, for one point on the part surface in a certain setup, the calculation of its 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map and 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 II
                              
                           
                        
                     -map is purely analytical and obviously takes constant 
                        O
                        
                           (
                           1
                           )
                        
                      time. As a result, for 
                        n
                      sample points, their 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -maps (except the 
                        
                           V
                        
                     -map which is calculated only once in the whole process) can be calculated in 
                        O
                        
                           (
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           )
                        
                      time (as a 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map itself may have in the worst case 
                        O
                        
                           (
                           n
                           )
                        
                      edges, although in our experiment on average it is much less than 
                        n
                     ). For the 102 sample points in the above example, their 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -maps calculation took less than 1 s in our experiment. With a specified threshold in the GA algorithm, the algorithm runs for less than 15 min to yield the final result (Fig. 22), with about 2500 iterations. Since this is an offline optimization and done only once, higher sampling density is conceivably affordable.

The above minimum workpiece setup problem is just one application of the 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map. It aims at maximizing the region on the part surface which can be accessed by the tool, thus reducing the total number of setups. This is of great importance since every extra workpiece setup brings along additional auxiliary time due to the workpiece remounting and the surface cutting errors due to the recalibration of the machine tool. Besides this application, the more fundamental usage of the 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -map is in providing the complete set of global collision-free directions for the tool axis (catering to all the different types of obstacles). It can be incorporated into a current CAM system as a constraint in the five-axis tool path generation process. Together with the local gouging-free constraint  [11,25–29], the 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -maps make possible automatically generating gouging-free (both local and global) five-axis tool paths, given the specific machine and the workpiece setup. A typical five-axis tool path generation procedure utilizing the proposed methods would look like the following. Firstly, a (near-) minimum number of workpiece setups are identified which consider all the types of obstacles. Next, for each identified setup, the corresponding 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -maps are calculated. Finally, for each setup, commercial (or own-developed) CAM software is executed to generate an initial tool path which is made of CC curves and the associated tool orientations; this initial tool path is then amended by modifying the tool orientations such that they all fall into the corresponding 
                        
                           
                              
                                 V
                              
                           
                           
                              g
                           
                        
                     -maps, in addition to maybe other constraints on the tool orientation (e.g., kinematics, dynamics, etc.).

@&#SUMMARY@&#

Traditionally in five-axis machining, when determining the tool orientations that are accessible to a point on a part surface, only static obstacles (i.e., only the part surface itself) are considered. In the presence of non-static obstacles such as fixtures and clamps on the machine table (which are not static with respect to the part surface depending on how it is set up on the machine table) and devices fixed in the space (which are dynamic even with respect to the rotation of the machine table), collision checking is performed by computer simulation on the fly and, if collision is found, a complete re-computation of the tool path is usually required. As a result, five-axis tool path computation has been a tedious and iterative process, requiring excessive human intervention.

In this paper, we have conducted a rigorous analysis of the algebraic structures of non-static obstacles in the five-axis machining environment and proposed efficient numerical representations for them. Based on these, we then have presented a practical algorithmic solution to the problem of finding a minimum set of workpiece setups for machining a free form surface on a five-axis machine, attending to both static and non-static obstacles. Not limited to the minimum workpiece setup problem, the mathematical models and algorithms developed in this paper are expected to help fill a long-standing hole in five-axis machining: determining correct tool orientations at the stage of tool path planning beforehand rather than relying on computer simulation on the fly in the later stage.

@&#ACKNOWLEDGMENT@&#

This work is partially supported by the Hong Kong Government RGC General Research Fund
                  619212.

First, we consider the case of simplifying the tool assembly and spindle head as a single cylinder.

Refer to Fig. A.1
                      and consider a flat-end type tool with non-zero radius. The vertices of the obstacle have been transformed into the LCS of point 
                        p
                      and projected into the plane 
                        
                           
                              S
                           
                           
                              p
                           
                        
                      to form a polygon 
                        
                           
                              P
                           
                           
                              o
                           
                        
                        =
                        
                        
                           {
                           
                              
                                 o
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 o
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 o
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 o
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 o
                              
                              
                                 5
                              
                           
                           ,
                           
                              
                                 o
                              
                              
                                 6
                              
                           
                           }
                        
                     . In double-touching, the bottom edge of the tool gouge-freely contacts 
                        p
                      while its shank touches 
                        
                           
                              P
                           
                           
                              o
                           
                        
                      at a point 
                        o
                     . Obviously, plane 
                        
                           
                              S
                           
                           
                              p
                           
                        
                      intercepts the shank into an ellipse, i.e., 
                        E
                        
                           (
                           o
                           )
                        
                      in Fig. A.1(b). Both the contact point 
                        o
                      and the ellipse 
                        E
                        
                           (
                           o
                           )
                        
                      are functions of the tool orientation. To make the analysis and solution computationally feasible, we will consider only the worst and hence most conservative situation. Intuitively, the easiest solution is simply to offset the polygon 
                        
                           
                              P
                           
                           
                              o
                           
                        
                      outward by a distance equal to the diameter of the tool. We however propose a more stringent method. For point 
                        o
                     , let 
                        
                           
                              o
                           
                           
                              s
                           
                        
                      denote its offset point which is perpendicular to 
                        
                           
                              o
                           
                           
                              1
                           
                        
                        
                           
                              o
                           
                           
                              2
                           
                        
                      and at a distance 
                        d
                        
                           (
                           o
                           )
                        
                      from 
                        o
                     . In Fig. A.1(a), 
                        
                           
                              
                                 n
                              
                           
                           
                              
                                 s
                              
                           
                        
                      is the normal of 
                        
                           
                              S
                           
                           
                              p
                           
                        
                        ,
                        
                           op
                        
                      is the vector from 
                        o
                      to 
                        p
                     . 
                        
                           
                              γ
                           
                           
                              o
                           
                        
                      is the angle between 
                        
                           
                              
                                 n
                              
                           
                           
                              
                                 s
                              
                           
                        
                      and 
                        
                           op
                        
                      and is defined by: 
                        
                           (A.1)
                           
                              
                                 
                                    γ
                                 
                                 
                                    o
                                 
                              
                              =
                              a
                              
                              
                                 cos
                              
                              
                                 [
                                 
                                    (
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          
                                             s
                                          
                                       
                                    
                                    ⋅
                                    
                                       op
                                    
                                    )
                                 
                                 /
                                 
                                    |
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          
                                             s
                                          
                                       
                                    
                                    ⋅
                                    
                                       op
                                    
                                    |
                                 
                                 ]
                              
                              .
                           
                        
                     
                  

We use 
                        
                           
                              γ
                           
                           
                              o
                           
                        
                      to approximate the angle between the bottom plane of the tool and 
                        
                           
                              S
                           
                           
                              p
                           
                        
                     . Define 
                        d
                        
                           (
                           o
                           )
                        
                      as (
                        r
                      is the radius of the tool): 
                        
                           (A.2)
                           
                              d
                              
                                 (
                                 o
                                 )
                              
                              =
                              2
                              r
                              /
                              cos
                              
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       o
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

It is not hard to see that no matter what the 
                        
                           
                              γ
                           
                           
                              o
                           
                        
                      and 
                        
                           op
                        
                        ,
                        E
                        
                           (
                           o
                           )
                        
                      will always lie inside the disc with the center of 
                        o
                      and radius of 
                        d
                        
                           (
                           o
                           )
                        
                     , as shown in Fig. A.1(b). Rather than using this variable offset 
                        d
                        
                           (
                           o
                           )
                        
                      for line 
                        
                           
                              o
                           
                           
                              1
                           
                        
                        
                           
                              o
                           
                           
                              2
                           
                        
                     , as a conservative simplification, the offset of line 
                        
                           
                              o
                           
                           
                              1
                           
                        
                        
                           
                              o
                           
                           
                              2
                           
                        
                      is replaced by a line segment of a constant distance 
                        
                           max
                        
                        
                           (
                           d
                           
                              (
                              o
                              )
                           
                           :
                           o
                           ∈
                           
                              [
                              
                                 
                                    o
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    o
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                           )
                        
                     . Between two such neighboring offset line segments, a Hermite spline is used to connect them. Altogether, an offset polygon 
                        O
                        S
                        
                           (
                           
                              
                                 P
                              
                              
                                 o
                              
                           
                           )
                        
                      is defined (Fig. A.1(b)) which then will replace 
                        
                           
                              P
                           
                           
                              o
                           
                        
                      in the calculation of the 
                        
                           
                              
                                 F
                              
                           
                           
                              
                                 I
                              
                           
                        
                     -map of 
                        p
                     .

Simplifying the tool assembly and spindle head into a single cylinder may be too conservative. This problem can be mitigated by modeling them into several cylinders with different radii. Here, we present the case of two cylinders 
                        
                           
                              T
                           
                           
                              r
                           
                        
                      and 
                        
                           
                              T
                           
                           
                              R
                           
                        
                     , with the radii 
                        r
                      and 
                        R
                        
                        
                           (
                           R
                           >
                           r
                           )
                        
                     , and their length 
                        
                           
                              l
                           
                           
                              r
                           
                        
                      and 
                        
                           
                              l
                           
                           
                              R
                           
                        
                      respectively, as shown in Fig. A.2
                     (a). If considering only one cylinder, e.g., 
                        
                           
                              T
                           
                           
                              r
                           
                        
                      or 
                        
                           
                              T
                           
                           
                              R
                           
                        
                     , the offset in plane 
                        
                           
                              S
                           
                           
                              p
                           
                        
                      can be calculated with the above method, i.e., 
                        O
                        S
                        
                           (
                           
                              
                                 P
                              
                              
                                 r
                              
                           
                           )
                        
                      or 
                        O
                        S
                        
                           (
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                           )
                        
                      shown in Fig. A.2(b).

To consider both 
                        
                           
                              T
                           
                           
                              r
                           
                        
                      and 
                        
                           
                              T
                           
                           
                              R
                           
                        
                      at the same time, the situation is different. For point 
                        o
                      in 
                        
                           
                              S
                           
                           
                              p
                           
                        
                     , its corresponding point on the edge of 
                        
                           
                              
                                 Obs
                              
                           
                           
                              
                                 I
                              
                           
                        
                      is 
                        
                           
                              o
                           
                           
                              ∗
                           
                        
                     , the offset of point 
                        o
                      in 
                        
                           
                              S
                           
                           
                              p
                           
                        
                      is different for different cases:

If 
                        
                           
                              T
                           
                           
                              R
                           
                        
                      touches point 
                        
                           
                              o
                           
                           
                              ∗
                           
                        
                     , then the offset of 
                        o
                      is on 
                        O
                        S
                        
                           (
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                           )
                        
                     , i.e., 
                        
                           
                              o
                           
                           
                              t
                           
                        
                      in Fig. A.2(b).

Otherwise, the offset of 
                        o
                      can have two different situations: 
                        
                           (1)
                           If 
                                 
                                    
                                       T
                                    
                                    
                                       r
                                    
                                 
                               touches point 
                                 
                                    
                                       o
                                    
                                    
                                       ∗
                                    
                                 
                               but circle 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               does not touch any face of 
                                 
                                    
                                       
                                          Obs
                                       
                                    
                                    
                                       
                                          I
                                       
                                    
                                 
                              , then the offset of 
                                 o
                               is on 
                                 O
                                 S
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          r
                                       
                                    
                                    )
                                 
                              , i.e., 
                                 
                                    
                                       o
                                    
                                    
                                       s
                                    
                                 
                               in Fig. A.2(b); or

If circle 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               touches some face of 
                                 
                                    
                                       
                                          Obs
                                       
                                    
                                    
                                       
                                          I
                                       
                                    
                                 
                               (e.g., point 
                                 
                                    
                                       o
                                    
                                    
                                       ′
                                    
                                 
                               in Fig. A.2(a)) before 
                                 
                                    
                                       T
                                    
                                    
                                       r
                                    
                                 
                               touches point 
                                 
                                    
                                       o
                                    
                                    
                                       ∗
                                    
                                 
                              , then the offset of 
                                 o
                               is on 
                                 
                                    
                                       l
                                    
                                    
                                       ⊥
                                    
                                 
                               and is between 
                                 
                                    
                                       o
                                    
                                    
                                       s
                                    
                                 
                               and 
                                 
                                    
                                       o
                                    
                                    
                                       t
                                    
                                 
                              , e.g., the 
                                 
                                    
                                       o
                                    
                                    
                                       r
                                    
                                 
                               in Fig. A.2(a). From the constraints that 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               is tangent to the face of the 
                                 
                                    
                                       
                                          Obs
                                       
                                    
                                    
                                       
                                          I
                                       
                                    
                                 
                               and 
                                 
                                    
                                       o
                                    
                                    
                                       r
                                    
                                 
                               lies on the line 
                                 
                                    
                                       l
                                    
                                    
                                       ⊥
                                    
                                 
                                 ,
                                 
                                    
                                       o
                                    
                                    
                                       r
                                    
                                 
                               can be obtained as the offset point of 
                                 o
                              .

With the offset of each point on 
                        
                           
                              P
                           
                           
                              o
                           
                        
                      calculated by the above method, the offset of 
                        
                           
                              P
                           
                           
                              o
                           
                        
                      can be constructed, this method can be extended (in theory) to more than two cylinders, although with a considerably greater amount of analysis. Our current work only supports the one-cylinder case, leaving the multiple cylinders case to future research.

@&#REFERENCES@&#

