@&#MAIN-TITLE@&#Meaningful spatial prediction and aggregation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We introduce a new notion of meaningfulness of spatial prediction and aggregation.


                        
                        
                           
                           Observation, prediction, and aggregation procedures are formalized as functions.


                        
                        
                           
                           We show how datasets can be described as results of executing such procedures.


                        
                        
                           
                           We propose formal checks of meaningfulness based on functional correspondence.


                        
                        
                           
                           Meaningfulness checks on the type level are implemented in the R software and OWL.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Meaningfulness

Knowledge-based environmental modelling

Spatial Statistics

Spatial prediction

Spatiotemporal aggregation

@&#ABSTRACT@&#


               
               
                  The appropriateness of spatial prediction methods such as Kriging, or aggregation methods such as summing observation values over an area, is currently judged by domain experts using their knowledge and expertise. In order to provide support from information systems for automatically discouraging or proposing prediction or aggregation methods for a dataset, expert knowledge needs to be formalized. This involves, in particular, knowledge about phenomena represented by data and models, as well as about underlying procedures. In this paper, we introduce a novel notion of meaningfulness of prediction and aggregation. To this end, we present a formal theory about spatio-temporal variable types, observation procedures, as well as interpolation and aggregation procedures relevant in Spatial Statistics. Meaningfulness is defined as correspondence between functions and data sets, the former representing data generation procedures such as observation and prediction. Comparison is based on semantic reference systems, which are types of potential outputs of a procedure. The theory is implemented in higher-order logic (HOL), and theorems about meaningfulness are proved in the semi-automated prover Isabelle. The type system of our theory is available as a Web Ontology Language (OWL) pattern for use in the Semantic Web. In addition, we show how to implement a data-model recommender system in the statistics tool environment R. We consider our theory groundwork to automate semantic interoperability of data and models.
               
            

@&#INTRODUCTION@&#

Summing temperature measurements or interpolating point source emissions is not meaningful. This paper formalises meaningfulness of applying prediction and aggregation procedures to data. With ever increasing data volumes (Bell et al., 2009) of diverse origin and nature (Parsons et al., 2011), we observe an increase in importance of information semantics to the application of Spatial Statistics and environmental modelling (Villa et al., 2009). Although we do have access to more and more data, the distance between those who collect the data and those who analyse it has become larger. Also, in interdisciplinary settings, data from heterogeneous sources are combined by researchers without specific domain knowledge, increasing the risk of inappropriate analysis (Pebesma et al., 2011). Making sense of these large data volumes exceeds the limits and competence of a particular group of scientists (Weinberger, 2011), and thus there is a need for semantic metadata that can bridge the gap of knowledge which exists between groups (Gray et al., 2005).

NASA has recently argued that model reuse and data-model interoperability has a significant added value, as about 60% of the time of NASA scientists is spent on making data and models compatible (National Aeronautics and Space Administration, 2012). In order to achieve integrated environmental modelling, standards that allow to describe and publish data and models in an automated fashion need to be developed (Laniak et al., 2013). When integrating environmental models, it is crucial to avoid “constructs that are perfectly valid as software, but ugly or even useless as models” (Voinov and Shugart, 2013, p.149).

Observations form the basis of empirical and physical sciences. They provide samples for a process of interest, enabling us to infer knowledge about this process and to evaluate assumptions and hypotheses. In order to infer knowledge or test hypotheses about a process, statistical models and procedures can be applied to observations. The syntactical integration of observations in statistical modelling frameworks is not an issue (R Development Core Team, 2011). However, the semantic integration of observations in such systems still forms a major challenge (Sheth et al., 2008), since not all syntactically possible applications are meaningful. Although there are already ontologies for describing observable properties and sensing devices such as the NASA SWEET ontologies
                        1
                     
                     
                        1
                        The SWEET ontologies are accessible at http://sweet.jpl.nasa.gov/ontology/.
                      or the W3C SSN ontology (Compton et al., 2012), a formalization of analysis procedures is missing. In this paper, we address the challenge of meaningful interpolation of a set of environmental observations and of meaningful aggregation in space and time. While there are sophisticated methods for interpolation and aggregation, such as Kriging (Journel and Huijbregts, 1978), determining which method is appropriate for which kind of data in an automated fashion is an open research question.

To illustrate the problem, consider two real datasets from the atmospheric domain shown in Fig. 1
                     : (i) total emissions of CO2 for the year 2007 from power plants in Germany
                        2
                     
                     
                        2
                        The data is accessible for free at http://www.carma.org.
                      and (ii) daily mean concentrations of fine dust (PM10) measured at air quality stations in Germany.
                        3
                     
                     
                        3
                        The data is available at http://www.eea.europa.eu/themes/air/airbase.
                      Both datasets have an indistinguishable data structure: records of scalar values indexed by points in space and time. Hence, the datasets are often treated as the same in spatial analysis. However, though both datasets can be easily interpolated spatially (right column of Fig. 1), interpolation of points is only meaningful for PM10 concentration and not for total emissions of CO2 from power plants. Users unaware of the data semantics may apply inappropriate procedures because they do not distinguish between datasets with equivalent structure representing incommensurable phenomena. A comparable problem concerns the application of statistical measures in spatio-temporal aggregation, such as summing up observation values within spatial regions. Computing the sum of the total CO2 emissions of power plants over Germany may be meaningful, while the sum of PM10 concentrations over an area may not.

Though basic prediction and aggregation functionality for spatial data is often available in Geographical Information System (GIS) or statistical software in an adhoc fashion, the choice of a particular method is usually up to the user and its appropriateness is not checked by the system. Furthermore, while measurement scales (Stevens, 1946; Suppes and Zinnes, 1967; Chrisman, 1995) are well established, in many cases, allowable operations are unknown for a dataset. It is, e.g., not meaningful to compute the mean value of a numerical ordinal variable, although it is possible from a computational viewpoint.

We argue that the problem of meaningful prediction and aggregation requires knowledge about the meaning of data, i.e., semantic knowledge, in machine readable form to help users determine which prediction or aggregation method can be applied to which dataset. In this paper, we suggest a way how the notion of meaningfulness can be operationalized:
                        
                           1.
                           Formal specifications make some of the knowledge underlying meaningful statistics more explicit and readable for machines.

In a rough approximation, a statistical prediction or aggregation method can be said to be meaningfully applicable to a data set, if it is semantically interpretable in the observation context of the data. This context can be captured, to a significant degree, by (semantic) reference systems (Kuhn, 2003).

On this basis, the well-known conceptual distinction between (marked) point pattern, geostatistical variables and lattice data (Illian et al., 2008; Burrough and Mcdonnell, 1998; Cressie and Wikle, 2011), can be made formally explicit.

Meaningfulness of prediction can then be checked by testing whether prediction functions underlying statistical models formally correspond to observation functions underlying data, where both are typed by semantic reference systems.

Meaningfulness of summation can be checked by testing whether regions over which the data is aggregated formally correspond to the observed window of the data to be aggregated.

This shows a way to design a recommender tool in Spatial Statistics,
                                 4
                              
                              
                                 4
                                 In this paper, we follow the distinction introduced by Cressie and Wikle (2011), where statistics refers to summaries of data and Statistics to the Statistical Science. The same is applied to Spatial Statistics and Geostatistics.
                               in which data and variables can be linked to interpolation and aggregation methods.

The contribution of this paper is a formalization of meaningfulness of spatial prediction and aggregation with respect to datasets. Out of scope are the semantic description of observable properties, of statistical models, and of application problems. We make the case for our notion of meaningfulness based on the two scenarios from the atmospheric domain introduced above (air quality and CO2 emissions). We test our theory and prove meaningfulness in Isabelle/HOL, a higher-order theorem prover. A preliminary Web Ontology Language (OWL) pattern, which can be used by statistical applications on the Web, and a prototypical implementation in R illustrate some of its potential.

The remainder of this paper is structured as follows. The next section introduces the background of our work including overviews on Spatial Statistics, on spatio-temporal aggregation, on meaningfulness in measurement theory, and on semantic reference systems. Afterwards our functional approach to formalize Spatial Statistical knowledge is described in detail. Then, a description of a prototypical implementation, an R package that extends the package sp, is introduced. Finally, after discussion of our approach, conclusions and directions for future research are presented.

@&#BACKGROUND@&#

This section provides background and a preliminary discussion of the problem of meaningfulness. First, basic variable types are introduced which are relevant for meaningful Spatial Statistics. Then, we describe our notion of spatio-temporal aggregation. Afterwards, we discuss the definition of meaningfulness in measurement theory. Finally, semantic reference systems for space, time, as well as for thematic domains are described, and it is argued why they are useful for making the necessary distinctions.

Spatial Statistics (Ripley, 1981; Cressie, 1993; Cressie and Wikle, 2011) is a branch of Statistics that deals with spatial and spatio-temporal processes. Although all observations are taken under circumstances that can be characterized by a location and time, in many cases location and time do play a minor role, for instance where controlled experiments in lab conditions eliminate the role of space and time. In case of medical experiments, the subject's identity and age may form the major reference. However, when observations are taken outside a lab, non-controllable factors typically cause them to be correlated in space and/or over time. Spatial Statistical models address such correlations, allow inferences, and are used for the prediction of phenomena in space and time.

For spatio-temporal processes, Cressie and Wikle (2011) use the following notation:
                           
                              (1)
                              
                                 
                                    Z
                                    
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                    ,
                                    
                                    s
                                    
                                    ∈
                                    W
                                    ,
                                    
                                    W
                                    ⊂
                                    
                                       R
                                       d
                                    
                                 
                              
                           
                        with Z(s) an observed or unobserved value at s, the combination of spatial location and time; W the spatial and temporal domain or window over which Z is defined; and d the dimensionality of space-time (e.g., three in case of two-dimensional space plus time). The location s, the spatial and/or temporal support, is a region in a spatial and/or temporal reference system and may be represented as a point.

Two basic forms can be distinguished. First, Z is defined for every possible value of s (hence Z is total). In Geostatistics, one assumes that s is a continuous index. In this case, Z(s) is a geostatistical variable, and the challenge often lies in predicting values Z for unobserved locations s
                        0, based on a limited set of n observations Z(s
                        1),…,Z(s
                        
                           n
                        ).

The second form is that of point pattern variables (Illian et al., 2008), where not for every point s
                        
                           i
                         
                        Z is defined (hence Z is partial). A pure point pattern consists only of those locations. Marked point patterns include the Z values (the marks). Typical questions in point pattern modelling are whether point density variations can be considered random, whether points interact (e.g., attract or repulse), and how point density, interactions, or marks depend on known covariates. For analysing point pattern data, it is important to know the observation window W (Baddeley and Turner, 2005), as the latter allows discriminating between where we know there are no points from where nothing is known.

If values are considered results of a random process, the values cannot be chosen arbitrarily and we call that variable a random variable. In contrast, we call a variable a fixed variable, if the values can be fixed, i.e., the values can be selected arbitrarily. Point pattern analysis considers s = s
                        1,…,s
                        
                           n
                         as a random set, meaning that locations are random variables. Given the locations, the marks of a marked point process Z(s) are considered random variables. For geostatistical variables, only Z is considered random, as observation and prediction locations s can be chosen arbitrarily.

In the case of Lattice data, observed values reflect aggregations over a set of covering regions rather than (values for) points. The union of regions forms the area of study W. The observed variable is usually modelled as a random field, the regions are not random. Images are often considered as a special case of lattice data. Typical problems are modelling spatial dependence, assessing whether spatial patterns might be completely random, and finding relations with covariates.

The challenge is to bring this knowledge into a semantically explicit, machine-readable form, which can be used for automated reasoning about meaningful application of methods to the various kinds of data.

Statistical measures are computed on aggregates of observations. Spatio-temporal aggregation (Jeong et al., 2004; Vega Lopez et al., 2005; Stasch et al., 2012) aggregates observations to some coarser spatial regions and/or temporal extents using some spatial or temporal grouping predicate, usually spatial or temporal regions. Then, an aggregation function is applied to the observed values of each group in a spatial and/or temporal region. These regions are the supports of the aggregated values and indicate a change of support. In this work, we focus on spatio-temporal aggregation processes where grouping predicates indicate selection of observations for point pattern or geostatistical variables within spatial and temporal regions and where aggregation functions are simple functions such as mean, sum or median.

A specific problem is using the sum as aggregation function. This problem is identified in the Online Analytical Processing (OLAP) and statistical database community as the summarizability problem (Lenz and Shoshani, 1997; Mazón et al., 2009), but has not yet been specifically investigated for the spatial domain. While in general, from the measurement theory viewpoint, the summation is meaningful as long as the measurement scale of the quality is interval or ratio scale, using the sum as an aggregation function is sometimes meaningful, but sometimes not. In this paper, we argue that observed values that are distributed in space can only be meaningfully summed, if we have complete knowledge about the extent over which values are summed. This may be the case for point patterns, but not for geostatistical data.

As there are different notions of probability in statistical theory, there are different approaches to meaningfulness in measurement theory that may lead to different statistical models and conclusions (Hand, 1996). In the representational approach, which is the most widely adopted, real world objects, their properties, and their relationships are modelled by empirical relational systems, and measurements are expressed as mappings from object properties to numbers in a numerical system (Suppes and Zinnes, 1967).

Usually, empirical properties can be mapped to numerical systems in different ways, according to different measurement scales. For example, the length of an object can be expressed in metres or in inches. Transformations between such different numerical representations, which preserve the relationships of objects in the empirical system, are called permissible transformations. Scale types of measurement are defined as classes of permissible transformations among numerical representations. In the length example, the length is of a ratio scale type since the permissible transformations are positive similarity transformations (multiplication with a scalar value).


                        Stevens (1946) introduced the notion of meaningfulness to Statistics. He defined four measurement scale types (nominal, ordinal, interval, ratio). Meaningful statistics are those that are invariant over permissible transformations of each scale type. As pointed out by many authors (Chrisman, 1995; Suppes and Zinnes, 1967), there are more practically relevant scale types than the ones defined by Stevens. For example, wind direction is usually provided on a cyclic scale (degrees from north axis). Furthermore, Adams (1966) emphasized that meaningfulness also depends on the context in which the statistics are used.

We understand meaningful statistics and prediction in a more specific sense, which goes beyond the distinction of scale types and is rather located on the level of particular scales that allow to differentiate observed phenomena as well as underlying observation procedures. In our approach, statistical operations are meaningful with respect to data, if these operations are interpretable in the context in which the data was generated. We use semantic reference systems to capture this pragmatic context.

According to Berners-Lee et al. (2001, p.35), “The Semantic Web is not a separate Web but an extension of the current one, in which information is given well-defined meaning, better enabling computers and people to work in cooperation.” Formalized knowledge, usually provided in the form of ontologies (Gruber, 1993), is used in the Semantic Web to support interoperability and to make documents discoverable, readable, and interpretable for machines. A common language for creating, exchanging, and publishing ontologies in the Web is the Web Ontology Language (OWL).
                           5
                        
                        
                           5
                           
                              http://www.w3.org/TR/owl2-overview/.
                         The question now is which formal distinctions need to be captured in an ontology in order to formalize meaningfulness.

Deciding about meaningfulness of data for certain prediction methods or descriptive statistics requires formal distinctions that safeguard the application or at least caution against an inappropriate choice. These distinctions need to go beyond well-understood mathematical abstractions of statistical theory to capture some of the meaning of the data to which statistical models are to be applied. Regardless of whether the data is a product of prediction or observation, what makes it meaningful to us is knowing how to interpret it. This involves, essentially, knowing how to refer to the phenomena underlying data in the context of its generation (Scheider, 2012). The latter competence is called reference and involves knowledge about repeatable human and technical operations that allow to share phenomena, such as observation, abstraction and prediction procedures. Statistical inference and modelling critically depend on the observation and abstraction process itself, not only on the world that is being observed or on the cognitive and linguistic aspects of its representation. For example, a statistical model critically depends on the resolution of the data sample, and this resolution is a consequence of certain observation and abstraction procedures (Frank, 2009). Therefore, we suggest to follow a pragmatic approach to data semantics, requiring that the generation procedure needs to be somehow reflected in the semantic description of statistical data.

One approach to reference systems, in this pragmatic sense, are measurement scales. However, current ontologies about measurement scales, such as (Rijgersberg et al., 2012), are not sufficient for our purpose. The reason is that Statistics is not only (and only in limited cases) about measurable qualities. In particular, Spatial Statistics needs to refer to a wide range of other spatio-temporal phenomena, including discrete objects and events. Therefore a more general notion of a reference system is required.

Semantic reference systems were first proposed by Kuhn (2003). This concept generalizes spatial and temporal reference systems. Spatial reference systems are, for example, physically anchored mathematical ellipsoids that allow to unambiguously refer to locations on the earth surface. They are grounded in conventional standard directions and positions that geodesists can refer to. Semantic reference systems, as a generalization, are formal theories anchored in conventionally established observation procedures. They provide reference for arbitrary observable phenomena, also for phenomena described by complex geometries or attributes in a Geographic Information System (GIS). There are, e.g., reference systems for time in terms of calendars, for places in terms of postal addresses, as well as for other kinds of observable phenomena. For many spatio-temporal phenomena, such as geographic objects and events, reference systems can be constructed in a similar way, based on repeatable observation and abstraction procedures (Scheider, 2012).

In this paper, we will just make use of the discriminative power of reference systems regarding domains of phenomena of interest, while the question of constructing and grounding them is not in focus. Therefore, we will presuppose that we have reference systems of an appropriate kind at our disposal, and we will preserve the term referent to speak about an individualized phenomenon in the domain of a reference system. The meaning of the latter is conventionally established.

Since reference systems are formal theories grounded in repeatable procedures, their domain can be viewed as the structured set of all possible entities that can be the result of such a procedure. For example, the set of all potentially observable colours makes a colour space, or the set of all potentially observable locations makes a spatial reference domain. By a procedure, we understand in this paper any conventionally shared instruction to generate entities of a reference system, in particular mathematical functions. This is regardless of whether this instruction is explicit in the form of a computational rule, such as a prediction algorithm in Geostatistics, or whether it is implicit in the form of human action schemes.

In this section, we introduce the formalism that enables to infer whether applications of prediction and aggregation procedures to datasets are meaningful, provided that their underlying observation procedures are known. First, an overview is given of the approach (Section 3.1), followed by an introduction to our formal notation (Section 3.2), and subsections for each core concept in our formalism (Sections 3.3–3.8).

@&#OVERVIEW@&#

The basic idea of our formalism is a formal distinction between representations of procedures as functions, which capture knowledge about potential operations such as observing or predicting phenomena, and representations of data sets as predicates over function domains, which denote limited (finite) results of applying such operations. This distinction allows us to compare data and procedures in terms of the underlying data generation capabilities. We explain this idea first in an informal way.

An observation procedure is an operational description how to observe a phenomenon. For example, the observation procedure for observing PM10 involves localization of the measurement device in space, time measurement by a clock, and the use of a PM10 sensor, whose technical specification describes the measurement procedure in more detail. By executing this procedure, one takes unique measurements at arbitrary points in time and space. Therefore, we can specify the observation procedure by a continuous observation function, a mapping from arbitrary locations and times to concentrations. Similarly to an observation procedure, a particular prediction procedure is specified by a prediction function in our formalism. An example of a prediction procedure is the description of ordinary kriging in a statistical book (Cressie and Wikle, 2011, p.145), which can be specified as a function from continuous space and time to predicted values. Hence, our formalism consists of functional specifications, shown in yellow colour in Fig. 2
                        , which allow to distinguish the different types of Spatial Statistical variables: point pattern, marked point pattern, and geostatistical variables, in terms of different types of functions.

The meaning of the functional domains and ranges, i.e., of the types of entities being related by a function, is given in terms of reference systems shown as blue concept in Fig. 2. More precisely, functions are mappings from certain reference domains to other ones, where the latter are specified as formal types.

As an example, the function specifying PM10 observations in Germany in the year 2008 is a mapping WGS84 ⇒ UTC2008 ⇒ PM10 from the spatial reference domain given in the World Geodetic System 1984 (WGS84), WGS84 coordinates in Germany, and the temporal reference domain UTC2008, the year 2008 in Universal Time Coordinated (UTC), to a sensor reference domain PM10 defining concentration values in μg/m3. Such an observation function is of a geostatistical type, since it maps points in continuous space and time to quality values.

The observation procedure, which is specified as an observation function, stands for potential observations, whereas executing the procedure generates actual observations, i.e., data. Since the procedure can be executed only finitely many times, data is always finite, in contrast to the corresponding observation function. However, annotating data with an observation function allows us to link it with the underlying observation procedure, and thus, to take possible observations into account when deciding about meaningfulness. More precisely, in order to check whether a prediction procedure can be meaningfully applied to a dataset, we propose to check whether the respective observation function corresponds in a certain sense to the prediction function which specifies the prediction procedure (compare Fig. 2).

How does this approach help us to distinguish the geostatistical from the point pattern scenario? Since the function formalism captures procedures in the sense of potential observations or predictions, it allows, for example, to capture the difference between continuously observable space and discretely observable objects, even though the actual datasets are discrete in both cases and, thus, may not be distinguishable. The difference between continuously observable space and discretely observable objects is, in essence, the difference between a geostatistical and a point pattern variable. Furthermore, a prediction function, which specifies what can be done with a prediction procedure such as Kriging interpolation, can only be considered meaningful with respect to an observation dataset, if the underlying observation procedure supplies possible observations for each predictable case. For example, in the case of CO2 emissions of power plants, a geostatistical interpolation generates values at locations where no power plants are located, and, hence, an interpolation of power plant emissions becomes meaningless.

In a similar way, the observed window, which is the extent to which an observation dataset “covers” a spatio-temporal domain, can be used to determine whether an aggregation procedure can be meaningfully applied to a dataset or not. For example, since the observation of PM10 cannot cover a continuous spatial aggregation region, such as the spatial region of Germany, by a discrete data sample, using the sum to aggregate this dataset is meaningless. However, summing up emissions from discrete power plants may be meaningful, provided that the observed window covers the whole region of Germany. Note that also in this case, the essential idea is that a specification of an observation procedure accounts for what can be observed in contrast to the limited sample of an actual dataset.

The formalism is written, implemented and tested in Isabelle/HOL, a typed higher-order logic (HOL) which allows for reasoning over functions. Isabelle comes with a generic proof assistant which is available as jEdit plugin,
                           6
                        
                        
                           6
                           
                              http://www.cl.cam.ac.uk/research/hvg/isabelle/.
                         and which offers interactive syntax and type checking, as well as interactive proof support in natural deduction style. We adopted the notational style of Isabelle, since it follows ordinary conventions known from logic and mathematics books, and thus should be easily readable. Furthermore, we also tested and proved all our theorems with Isabelle.
                           7
                        
                        
                           7
                           The Isabelle theory is available online at: http://www.meaningfulspatialstatistics.org/theories/Miptheory.thy.
                        
                     

A theory in Isabelle consists of (1) declarations of (basic) types and type definitions, using type constructors such as ′a ⇒ ′b for function types, ′a × ′b for tuple types, and ′a set for the type of sets with elements of type ′a, with variables ′a,′b,′c standing for some types. We also use sum types ′a + ′b, i.e., types that are the union of two other types. Sum types allow us to express a kind of type hierarchy similar to object oriented programming.
                           8
                        
                        
                           8
                           In order to simplify our syntax, we do not use any “upcasting” sign for sum types. “Downcasting” sum types is done with the Isabelle function sum_case :: (a′ ⇒ ′b) ⇒ (c′ ⇒ ′b) ⇒ a′ + ′c ⇒ ′b.
                         In this paper, types are written in uppercase letters. Theories furthermore consist of declarations of (2) constants, which include functions and object constants in lowercase. Declaring constant c or variable v to be of a certain type T is done using double colons, e.g., (v :: T) or (c :: T). Predicates are just functions that map into the predefined type bool, e.g., (p :: T ⇒ bool). Isabelle theories furthermore may contain (3) non-recursive definitions, which are introduced in this paper by the numbered Definition environment with the symbol ≡ in a straightforward way, as well as (4) axioms as arbitrary sentences in HOL. For the latter we use the numbered Axiom environment. We will not make use of Isabelle's recursive functions and definitions.

Logical symbols include → for implication, ∧ for conjunction, ∨ for disjunction, ¬ for negation, ∀ for quantifier all, and ∃ for existential quantifier. We also use Isabelle's syntactic sugar, such as if…then…else. As in functional programming, f a means applying function f to a, and λx.b denotes the function that takes an x and returns b. ιx.P x denotes the unique x that satisfies the predicate P. Functions are always curried, i.e., function domains are written as a (right-associative) concatenation of functional types:

(((f :: ′a ⇒ ′b ⇒ ′c)(a :: ′a) :: ′b ⇒ ′c)(b :: ′b) :: ′c). Furthermore, in Isabelle, all functions are assumed to be total. In order to deal with partial functions, i.e., functions that cannot be applied to their entire domain, we use a special overloaded object constant (error :: ′a), which is declared to be of any type, and into which partial functions map. We furthermore use Isabelle's straightforward notation for set definitions {x.P x}, set membership x ∈ s, and finiteness of a set finite s.

As explained above, our approach utilizes reference systems as formal types in order to describe functions that stand for data generation procedures. In this section, we discuss those reference systems that are needed to specify the observation and prediction procedures in our scenarios, and we introduce basic types for them.


                        Table 1
                         shows types of reference systems that are used in our approach. Besides domains of spatial and temporal reference systems, such as coordinate systems and calendars, we assume domains for quality reference systems including, for example, measurement scales or observed qualities such as colour, as well as domains for discrete entities. Discrete entities may be further distinguished into physical objects and events, following top-level ontologies as described in Gangemi et al. (2003). Note, however, that we do not make any further commitment, e.g., as to whether qualities need to inhere in objects. However, the distinction between spatial, temporal, quality, and discrete domains of reference will already enable us to introduce a new notion of meaningfulness in Spatial Statistics.

Each domain of reference comes with its own formal structure, the latter being a result of a data generation procedure. This structure includes formal relations on these domains, such as the order relation in a calendar, or the metric relation between spatial coordinates, as well as cardinality properties of the domains, such as finiteness, infinity, density, and continuity. For example, spatial and temporal domains of measurement are usually considered infinitely dense, meaning that there are infinitely many potentially distinguishable locations, such that each pair of distinguishable ordered locations contains another potentially measurable location in between. The domain structure can be formally specified in Isabelle, and this will be used in Section 3.7 in order to prove for our CO2 and PM10 guiding scenario that continuous interpolation procedures are not meaningfully applicable in the CO2 case. For this purpose, we need to formalize strict cardinality orders among reference domains, D
                        
                           d
                         ⊂
                           c
                         D
                        
                           s
                         ∧ D
                        
                           d
                         ⊂
                           c
                         D
                        
                           t
                        . Even though in Isabelle, we cannot directly handle relations on types, we can do this indirectly by restricting injective functions on them (see Appendix A). That is, even though finiteness, discreteness, and continuity have further formal implications, in this paper, we only use the fact that they imply different set cardinalities, i.e., different sizes, together with the following mathematical fact about finite and infinite sets:
                           Axiom 1
                           
                              Infinite sets are bigger than finite sets:


                              “∀s s′. finite s ∧¬ finite s′ → (∃x.x ∈ s′ ∧¬ x ∈ s) ”
                           

For quality reference systems, the type of measurement scale is another formal structure which is of importance to decide on the applicability of statistics (see Section 2.3). As there are, in theory, “a nondenumerable infinity of types of scales…, but most of them are not of any real empirical significance” (Suppes and Zinnes, 1967, p.14), we focus exemplary on Stevens' measurement scale types (Stevens, 1946) and indicate them by nominal (
                           
                              
                                 D
                                 q
                                 n
                              
                           
                        ), ordinal (
                           
                              
                                 D
                                 q
                                 o
                              
                           
                        ), interval (
                           
                              
                                 D
                                 q
                                 i
                              
                           
                        ), and ratio (
                           
                              
                                 D
                                 q
                                 r
                              
                           
                        ) types.

The reference domains D
                        
                           s
                        , D
                        
                           t
                        , and D
                        
                           q
                         include granules (entities that cannot be divided into smaller entities of that reference system). However, granules can be aggregated to sets which we call regions.
                           9
                        
                        
                           9
                           We are aware of the fact that spatio-temporal regions, too, have further formal properties, such as continuity and regularity. However, for our purpose, these distinctions are not necessary.
                         Thus, region types of some reference domain D can be defined in Isabelle simply by the “set” type constructor, i.e., 
                           rD = D set. For example, a spatial reference system WGS84 can be used to refer to locations as singular coordinate tuples, and so WGS84 set can be used to refer to regions of coordinate tuples. The regions may be finite as well as infinite sets of granules (regardless of the fact that their computer representation is always finite). Furthermore, while a domain of regions 
                           rD contains the power set of the set of granules, what is of interest are usually particular finite collections of them. Such collections are specified formally below as predicates over region domains, similar to other kinds of datasets (Section 3.6).

Spatial Statistical variables are representations of spatio-temporal processes. In this section, we show how to distinguish variable types relevant in Spatial Statistics in terms of types of functions in our formalism. These types are a key to deciding whether procedures can be meaningfully applied to data, as discussed in Section 2.1. Spatial Statistical variables can be specified as functions, since one normally assumes that there is only one target value for a particular represented process at a particular “support”, i.e., for a particular location or object in time
                           10
                        
                        
                           10
                           Stochastic variables (i.e., joint probability distributions) can be specified as functions from reference types into probability space. However, probability distributions are not in focus in this paper.
                        . The domain of the function (left part of the functional type) can be considered fixed (i.e., a matter of choice), whereas the range (the right part) can be considered the result of some random process (i.e., it cannot be influenced).


                        Table 2
                         shows the functional types of point patterns in Spatial Statistics. Spatial point patterns (SPP) provide spatial locations for discrete entities, e.g., locations of longleaf pines within 4 ha of a natural forest (Cressie and Wikle, 2011, p.204). In this example, the domain of discrete entities (D
                        
                           d
                        ) is a set of longleaf pines that are mapped to spatial positions in the forest (D
                        
                           s
                         ⊂ 
                           
                              R
                           
                        
                        2), the latter being considered the result of a random process. If there are additional attribute values for each location (e.g., the diameter of the longleaf pines), the variable is a marked spatial point pattern (MSPP). Temporal point patterns (TPP) are similar to their spatial counterparts, but their defining function is a mapping from discrete entities to temporal positions. The occurrence of earthquakes in a particular US state is a temporal point pattern where the discrete reference domain D
                        
                           d
                         is the set of earthquakes and the temporal reference domain D
                        
                           t
                         contains the times within the observation period. In analogy to space, in a marked temporal point pattern (MTPP), quality values are attached to the time positions, e.g., magnitude in addition to the position of an earthquake.

If the locations in space and time are fixed, but the quality values are considered being the result of some random process, the variables are called geostatistical or lattice, as defined in Table 3
                        . Geostatistical variables (GEOST) provide quality values for granular locations in space. Hence, they are specified as functions that map from points in space and time to quality values that are considered a result of a stochastic process. In the object and field view (see for example Galton (2004)), the geostatistical variables implement the field view, whereas point patterns provide values for discrete entities, thus implementing the object view.

Examples for a geostatistical variable are PM10 concentrations measured across Europe. The spatial domain consists of positions within Europe (D
                        
                           s
                         ⊂ 
                           
                              R
                           
                        
                        2), the temporal domain contains the time positions within the observation period (D
                        
                           t
                         ⊂ 
                           
                              R
                           
                        ), and the quality domain is the PM10 scale in degree Fahrenheit, thus an interval scaled quality domain (
                           
                              
                                 D
                                 q
                                 i
                              
                              ⊂
                              R
                           
                        ). If the fixed locations in space are not granular but regional entities, we call that variable a lattice variable (LAT). Often, lattice data is point data that has been aggregated for particular reasons, e.g., privacy in medical data. As an example, the doctor-prescription amounts per consultation in cantons of the Midi-Pyrenees (Cressie and Wikle, 2011, pp.189–191) are computed from individual doctor-prescriptions at particular locations of the Midi-Pyrenees at particular times.

Another variable type are trajectories (Table 4
                        ). Trajectories (TRAJECT) are mappings from discrete objects and times to spatial locations, e.g., paths of tracked animals. Similar to point patterns, marks may be attached to the spatial positions, e.g., the body temperature of the tracked animals. Spatial point patterns can be derived from trajectories by fixing the time.

In this subsection, we show how observation functions can be defined which capture essential knowledge about observation procedures underlying our example scenarios. Examples of functions representing primitive procedures are listed in Table 5
                        . Other procedures may be defined on this basis. The object localization procedure obs
                        
                           loc
                         locates discrete objects at particular times in space. Another example is the measurement of an object property, defined as obs
                        
                           prop
                         in our formalism. Note that formal specifications of these observation functions represent the observation procedure, but functions are not identical with procedures. First, observation functions are fictions, as the set of tuples that constitutes the function (the functions' extension) is largely unknown. Second, the procedures involve a lot more knowledge about conventions and measurement operations which are not explicit in the functional specification. For example, spatial localization of objects involves the whole geodetic apparatus of measurement as well as a perceptual procedure for objects. However, it is these procedures which give the observation functions their specific intended meaning.

The observation procedures are represented as total functions, meaning that the functions are defined over their whole functional domain such that they do not produce any errors. For example, the function obs
                        
                           loc
                         always returns a spatial location for all discrete entities. Observation procedures are specified as functions because there can only be one observed value for a particular phenomenon at a particular location in time and space. For example, the surface temperature only takes a certain value at a particular location in space and time. In addition, they are total functions without errors, since observation procedures fully capture observation potentials over a domain of interest. Even though we cannot travel back in time to observe phenomena in the past, and even though – for practical reasons – it may not be possible at times and places in the future, observation procedures represent the potential of generating a response in every single case described by the application domain. Hence, observation functions express potential observations, providing a way to talk about potential actions, i.e., actions that may be intended, but, for some reason, remain unperformed. Isabelle functions are always total, so, the only thing we need to assert is that observation functions do not produce errors:
                           Axiom 2
                           
                              Totality of observation functions:


                              
                                 
                                    
                                       
                                          “
                                          ∀
                                          
                                          x
                                          
                                          y
                                          .
                                          o
                                          b
                                          
                                             s
                                             
                                                p
                                                r
                                                o
                                                p
                                             
                                          
                                          
                                          x
                                          
                                          y
                                          ≠
                                          e
                                          r
                                          r
                                          o
                                          r
                                          ”
                                          
                                          and
                                       
                                    
                                 
                              
                           


                              
                                 
                                    
                                       
                                          “
                                          ∀
                                          
                                          x
                                          
                                          y
                                          .
                                          o
                                          b
                                          
                                             s
                                             
                                                c
                                                p
                                                h
                                                e
                                                n
                                             
                                          
                                          
                                          x
                                          
                                          y
                                          ≠
                                          e
                                          r
                                          r
                                          o
                                          r
                                          ”
                                          
                                          and
                                       
                                    
                                 
                              
                           


                              
                                 
                                    
                                       
                                          “
                                          ∀
                                          
                                          x
                                          
                                          y
                                          .
                                          o
                                          b
                                          
                                             s
                                             
                                                l
                                                o
                                                c
                                             
                                          
                                          
                                          x
                                          
                                          y
                                          ≠
                                          e
                                          r
                                          r
                                          o
                                          r
                                          ”
                                       
                                    
                                 
                              
                           

More complex observation procedures can be generated by functional compositions. For example, the observation of total CO2 emissions from coal power plants at a particular year, which is a marked spatial point pattern, may be generated by a function obs
                        
                           mspp
                         as in Definition 1.
                           Definition 1
                           (Marked Spatial Point Pattern Observation). obs
                              
                                 mspp
                               :: MSPP where
                              
                                 
                                    
                                       
                                          “
                                          
                                             
                                                (
                                                
                                                   o
                                                   b
                                                   
                                                      s
                                                      
                                                         m
                                                         s
                                                         p
                                                         p
                                                      
                                                   
                                                   
                                                   d
                                                
                                                )
                                             
                                          
                                          ≡
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            o
                                                            b
                                                            
                                                               s
                                                               
                                                                  l
                                                                  o
                                                                  c
                                                               
                                                            
                                                            
                                                            d
                                                            
                                                            
                                                               t
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         (
                                                         
                                                            o
                                                            b
                                                            
                                                               s
                                                               
                                                                  p
                                                                  r
                                                                  o
                                                                  p
                                                               
                                                            
                                                            
                                                            d
                                                            
                                                            
                                                               t
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          ”
                                       
                                    
                                 
                              
                              with t
                              1 :: D
                              
                                 t
                               
                              standing for a temporal instance.

The function obs
                        
                           mspp
                         is a composition of the object localization function (obs
                        
                           loc
                        ) and the object property observation function (obs
                        
                           prop
                        ). Note that in this definition, the time of the primitive observation functions is implicitly fixed by a constant t
                        1, which does not appear anymore in the defined observation function obs
                        
                           mspp
                        . In this way, it is possible to derive new observation functions from primitive procedures, as well as to prove their formal properties.

Once an observation procedure is executed, data is produced. While an observation function describes potentially limitless observations, a particular dataset consists of a finite sample. Correspondingly, we specify data as a predicate over an observation function which just picks out a finite sample of tuples from the set that constitutes the total function. For example, while the observation function obs
                        
                           cphen
                         specifies observations of PM10 concentrations for all possible locations and times, a particular dataset, such as data
                        
                           geostat
                         in Table 8, consists of a finite subset of tuples at some locations in space, namely where monitoring stations are located. A selection of relevant data types for Spatial Statistics is shown in Table 6
                        , additional data types used in our formalism are defined in Table 7
                         and example instances of data are defined in Table 8
                        .

How can these data properties be formalized? We assume that data sets are always finite and non-empty (Definition 2). Definition 2 asserts this for the overloaded sum type DATA.
                           11
                        
                        
                           11
                           We use a simplified operator sum_case* for better readability. In Isabelle, this operator needs to be implemented as a cascading downcasting.
                        
                        
                           Definition 2
                           (Data properties). Data :: “DATA ⇒ bool” where
                              
                                 
                                    
                                       “
                                       D
                                       a
                                       t
                                       a
                                       
                                       m
                                       
                                       ≡
                                       
                                       s
                                       u
                                       m
                                       _
                                       c
                                       a
                                       s
                                       
                                          e
                                          ∗
                                       
                                       
                                       
                                          (
                                          λ
                                          m
                                          .
                                          
                                             (
                                             f
                                             i
                                             n
                                             i
                                             t
                                             e
                                             
                                             
                                                {
                                                
                                                
                                                   (
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   c
                                                   )
                                                
                                                .
                                                
                                                m
                                                
                                                a
                                                
                                                b
                                                
                                                c
                                                }
                                             
                                             )
                                          
                                          
                                          ∧
                                          
                                          
                                             (
                                             ∃
                                             
                                             a
                                             
                                             b
                                             
                                             c
                                             .
                                             
                                             m
                                             
                                             a
                                             
                                             b
                                             
                                             c
                                             )
                                          
                                          )
                                       
                                       
                                          (
                                          λ
                                          m
                                          .
                                          
                                             (
                                             f
                                             i
                                             n
                                             i
                                             t
                                             e
                                             
                                             
                                                {
                                                
                                                
                                                   (
                                                   a
                                                   ,
                                                   b
                                                   )
                                                
                                                .
                                                
                                                m
                                                
                                                a
                                                
                                                b
                                                }
                                             
                                             )
                                          
                                          
                                          ∧
                                          
                                          
                                             (
                                             ∃
                                             
                                             a
                                             
                                             b
                                             .
                                             
                                             m
                                             
                                             a
                                             
                                             b
                                             )
                                          
                                          )
                                       
                                       
                                          (
                                          λ
                                          m
                                          .
                                          
                                             (
                                             f
                                             i
                                             n
                                             i
                                             t
                                             e
                                             
                                             
                                                {
                                                
                                                a
                                                .
                                                
                                                m
                                                
                                                a
                                                }
                                             
                                             )
                                          
                                          
                                          ∧
                                          
                                          
                                             (
                                             ∃
                                             
                                             a
                                             .
                                             
                                             m
                                             
                                             a
                                             )
                                          
                                          )
                                       
                                       
                                       m
                                       ”
                                    
                                 
                              
                           

Lattices are specified as a special kind of data, namely as a finite collection of infinite (continuous) regions in space and time (Table 9
                         and Axiom 3). The latter follows from Definition 2, Axiom 3 and Axiom 4.
                           Axiom 3
                           
                              Lattice properties:

“∀ l. Lattice l → (∀ r. l r → ¬ finite r) ∧ Data l”

We can now assert data properties defined in Definition 2 for all data sets introduced in Table 8:
                           Axiom 4
                           
                              Properties of data sets:
                                 
                                    
                                       
                                          “
                                          D
                                          a
                                          t
                                          a
                                          
                                          d
                                          a
                                          t
                                          
                                             a
                                             
                                                g
                                                e
                                                o
                                                s
                                                t
                                             
                                          
                                          
                                          ∧
                                          
                                          D
                                          a
                                          t
                                          a
                                          
                                          d
                                          a
                                          t
                                          
                                             a
                                             
                                                s
                                                p
                                                p
                                             
                                          
                                          
                                          ∧
                                          
                                          L
                                          a
                                          t
                                          t
                                          i
                                          c
                                          e
                                          
                                          s
                                          l
                                          a
                                          t
                                          t
                                          i
                                          c
                                          e
                                          ”
                                       
                                    
                                 
                              
                           

Even though data sets are bound to be finite, it is important to keep the spatio-temporal observation context of the data, and this context may be infinite. For example, in case of point patterns, where only spatial and/or temporal locations are stored, the continuous area which is covered by observation needs to be known for further calculations, e.g., for computing density. This contextual knowledge is an outcome of the actual performed observation which generated the data. More precisely, it may be regarded as an outcome of particular acts of focussing attention on continuous places in the environment (Scheider, 2012), or, correspondingly, as an outcome of technical sensors having continuous sensoric ranges in space and time (compare Fig. 3
                        ). This accounts for the information coverage, i.e., for knowledge about where and when an observed phenomenon occurred and did not occur. In logical terms, it provides knowledge about the spatio-temporal extent to which the observation supplies “closed world” knowledge about a domain (including negations).

It is important to know that objects, such as animals, occurred or did not occur within an area, or whether there are knowledge gaps. Observers know this because their window of attention can focus on whole places and they can detect all objects of a type in them (Fig. 3). In order to represent this knowledge in our formalism, the observed spatial window (windowSpace) is declared in Table 10
                         as a mapping from a data set to a spatial region. For this region, the dataset encodes complete knowledge about whether or not the underlying phenomenon occurred while observing. That is, the observer knows that in the space inside this regions which is not covered by data the phenomenon did not occur. Analogously, the observed temporal window (windowTime) is defined as mapping from data to some temporal region, for which the data set encodes complete knowledge.

Observed windows can be continuous and, thus, infinite. For example, the window is continuous in case the observer has focused his attention on a continuous phenomenon, e.g., an extended place or an object as a chunk of space. This is the case for point patterns (see Fig. 3) and formalized in Axiom 5. Similarly, remote sensors, e.g., satellite sensors, can cover a continuous space by a finite number of cells. This is a case for lattice observation (Fig. 3).
                           Axiom 5
                           
                              Non-finiteness of an observed spatial window of spatial point pattern data:

“∀ (f :: SPPD) s′. windowSpace f = s′ → ¬ finite s′”

However, in case the observer or sensor focused attention on point-like locations in a spatial reference system, the observed window is discrete. This is the case for geostatistical observations (see Fig. 3) and is formalized in Axiom 6. In this latter case, the observed window coincides with the spatio-temporal domain of the data function (and can thus be left away). Whereas in the former case, the observed window is an important kind of information about a data set.
                           Axiom 6
                           
                              Finiteness of an observed spatial window of geostatistical data:

“∀ (f :: GEOSTD) s′. windowSpace f = s′ → finite s′”

Prediction is the act of generating (estimating) values at locations/times at which values are unknown. We suggest that meaningful prediction requires that predictions are interpretable in terms of underlying observation procedures. Thus, meaningful prediction can be defined (Definition 3) as the application of a prediction procedure to data derived by an observation procedure, such that the corresponding observation function is defined for each predicted value. In other words, meaningfulness requires that there is a possible observation for each predicted value:
                           Definition 3
                           (Meaningful Prediction). MeaningfulPred :: “(′a ⇒ ′b ⇒ ′c) ⇒ (′a ⇒ ′b ⇒ ′c) ⇒ bool” where “MeaningfulPred pred obs ≡ ∀ x y z. (pred x y = z) → (obs x y ≠ error)”

This definition needs to be overloaded for different types of observation functions with differing arities. Definition 3 is defined for binary function types such as GEOST.

To test meaningfulness of a prediction more generally, over a given set of data with their annotated observation functions, the computational challenge lies in first generating all possible observation functions (which may be logical compositions of primitive ones), and then searching for one corresponding pair of prediction and observation function that satisfies Definition 3. In searching, one can easily skip all pairs in which functions have a different type, as they cannot satisfy the necessary condition. Automatic proofs can thus be reduced efficiently to those cases when functional types coincide. Even checking function types without generating logical compositions is very useful, since it restricts the set of possibly meaningful predictions, and thus helps the user choose an adequate prediction procedure.

In our example scenarios of CO2 emissions of coal power plants and PM10 concentrations, Definition 3 allows to automatically determine whether a spatial interpolation such as ordinary kriging is meaningful or not based on comparing observation and prediction functions. Ordinary kriging interpolation is specified as the function pred
                        
                           geost
                         of type GEOST (see Table 11
                        ) and, hence, is defined for all locations in continuous space and time.

How can we prove meaningfulness in these cases? By Axiom 2, the function obs
                        
                           cphen
                         is defined, i.e., has a non-error response, for every tuple in its domain. This domain coincides with the domain of pred
                        
                           geost
                        . Thus, it follows immediately that the interpolation of PM10 concentration measurements using ordinary kriging is meaningful according to Definition 3:
                           Theorem 1
                           (Meaningful Prediction). “MeaningfulPred pred
                              
                                 geost
                               
                              obs
                              
                                 cphen
                              ”

While the ordinary kriging interpolation of PM10 concentrations is meaningful, interpolating CO2 emissions from coal power plants becomes meaningless. How can we disprove meaningfulness? First, the available observation functions obs
                        
                           loc
                         and obs
                        
                           prop
                         obviously cannot be meaningfully interpolated according to Definition 3, since their functional domains do not correspond to pred
                        
                           geost
                        . Second, we need to exclude the possibility that there is a derived observation function which may be meaningfully interpolated. For this purpose, we need to generate observation functions with a corresponding functional type. In fact, the phenomenon of CO2 emissions from coal power plants may be represented by a derived function obs
                        
                           geost∗ of the required type. For illustration of this issue, an observation function obs
                        
                           invloc
                         is given in Definition 4 that is the inverse of the object localization function obs
                        
                           loc
                        . The function obs
                        
                           invloc
                         returns a discrete object for a spatial location, if the discrete object is observed at the spatial location, and an error otherwise.
                           Definition 4
                           
                              obs
                              
                                 invloc
                               :: “D
                              
                                 s
                               ⇒ D
                              
                                 t
                               ⇒ D
                              
                                 d
                              ” where
                           

“obs
                              
                                 invloc
                               
                              s t ≡ (if (∃! d. obs
                              
                                 loc
                               
                              d t = s) then (ι d. (obs
                              
                                 loc
                               
                              d t = s)) else (error :: D
                              
                                 d
                              ))”

The observation function obs
                        
                           geost∗ is defined (Definition 5) as a composition of the inverse localization observation obs
                        
                           invloc
                         and the object property observation obs
                        
                           prop
                        . It represents the spatio-temporal occurrence of CO2 emissions from power plants. Note that the type of this function is not distinguishable from a geostatistical variable, namely a set of tuples of space, time and measured value. And in fact, there are cases where the phenomenon actually needs to be represented in this way, e.g., in a geographic map of emission values. This illustrates the semantic challenge, because the function now resembles a geostatistical function, i.e., a function to predict CO2 emission values for continuous spatial locations.
                           Definition 5
                           
                              obs
                              
                                 geost∗ :: GEOST where
                           

“obs
                              
                                 geost∗ 
                              s t ≡ if (obs
                              
                                 invloc
                               ≠ error) then (ι q. obs
                              
                                 prop
                               (obs
                              
                                 invloc
                               
                              s t) t = q) else (error :: D
                              
                                 q
                              )”

However, note that in our formalism, the functional specifications of obs
                        
                           prop
                         and obs
                        
                           invloc
                         allow to make the necessary distinction: we can infer that the function obs
                        
                           geost* is not defined over the whole spatial domain D
                        
                           s
                        . Hence, predicting values with pred
                        
                           geost
                         for obs
                        
                           geost* is not meaningful, as there are predicted values for locations in space and time where the underlying observation function is not defined (Theorem 2):
                           Theorem 2
                           (Meaningless Prediction). “¬ MeaningfulPred pred
                              
                                 geost
                               
                              obs
                              
                                 geost∗”

The proof of Theorem 2 requires the whole formal mechanism introduced so far and is provided in Appendix B.

Spatio-temporal aggregation procedures describe how to generate lattice data from point pattern or geostatistical data. They consist of two steps: First, groups are composed according to spatio-temporal predicates, usually referred to as group composition. Then, an aggregate value is computed for each group of objects. For example, the spatial grouping predicates for PM10 observations might be containment in the federal states of Germany. Applying these grouping predicates to observation data sets results in groups of observations per each federal state. As we focus on the generation of lattice data from point data, the grouping predicates in our case correspond to spatial and/or temporal lattices.

Summing a quality that is distributed in space requires that the quality has been observed completely over the extent over which it should be aggregated. This is the case for a marked point pattern aggregated on a lattice that is covered by its observed window. However, it is not the case for geostatistical data, as it is not possible to gather observations at continuous locations. Hence, we do not know about unobserved places in the lattice, and thus are not able to compute a meaningful sum.

We can formalize meaningful summation in Definition 6 by utilizing our definition of the observed window (Table 10). Applying the sum to compute aggregates from data is meaningful, if all locations in the lattice are also part of the observed window. This condition ensures that the lattice regions have been observed completely.
                           Definition 6
                           (Meaningful Summation). MeaningfulSum :: “DATA ⇒ SR ⇒ bool” where
                           

“MeaningfulSum (data :: DATA) (lat :: SR) ≡ (Lattice lat) ∧

(∀ (x :: D
                              
                                 s
                              ) x′. (lat x′ ∧ x ∈ x′ → (x ∈ windowSpace(data))))”

With Definition 6 and the axioms and definitions introduced so far, it can be proved that summation of data
                        
                           geost
                         to regions in slattice is not meaningful. The proof of Theorem 3 is explained in Annex Appendix C.
                           Theorem 3
                           (Meaningless Summation). “¬ MeaningfulSum data
                              
                                 geost
                               
                              slattice”

For meaningfulness of other aggregation functions than the sum, one can utilize measurement scales. As an example, we are using the classification of Stevens (Stevens, 1946) in nominal, ordinal, interval and ratio scale in order to find permissible descriptive statistics as shown in Table 12
                        . Point pattern processes can be considered as nominal values, as they are pointing to locations for a certain type of objects or events, for example positions of Pine trees or of earthquakes. Thus, the only applicable aggregation function is count. In case of marked point patterns with nominal marks, an applicable statistic is mode, e.g., in case of different tree species the dominant species in a certain area. Marks of point patterns, and observed values of geostatistical or lattice variables can be of any scale type, and hence aggregation functions can be applied as shown in Table 12. This allows, for example, to compute the mean for geostatistical variables. However, the aggregates are only relevant in the context of the observed window.

@&#IMPLEMENTATION@&#

A prototypical implementation of our approach is provided for the R software that is a widely used statistical software environment (R Development Core Team, 2011). R also allows for Spatial Statistical analysis through several R packages that extend the R's core functionality (Bivand et al., 2008). However, at the moment, the different spatial packages do not restrict models to particular variable types. It is, for example, possible to apply an inverse distance interpolation to marked point patterns in the spatstat R package. The result of such an interpolation is shown in Fig. 4
                     .

In order to disallow or allow particular interpolation and aggregation methods, we extend the sp package of R (Pebesma and Bivand, 2005) as shown in Fig. 5
                     .
                        12
                     
                     
                        12
                        The R script is available online at https://svn.52north.org/svn/geostatistics/main/meaningful/tools/R/implementation.R.
                      The classes PointPatternDataFrame and GeostatisticalDataFrame extend the SpatialPointsDataFrame and the class LatticeDataFrame extends the SpatialPolygonsDataFrame. The subclass PointPatternDataFrame has an additional property observedWindow that represents the observed window as defined in our formalism (Section 3.6) and is of type SpatialPolygons.

Encouraging or discouraging aggregations and predictions is now implemented as a simple type-checking according to our formalism. The generic aggregation function is augmented for the PointPatternDataFrame and GeostatisticalDataFrame classes. In case a non-meaningful interpolation is applied, i.e., spatial interpolation is applied to data of a PointatternDataFrame, a warning message is printed in the console as shown in Fig. 6
                     .

In addition to the R implementation, a preliminary version of the theory's types as an ontology pattern in OWL is published on the Web.
                        13
                     
                     
                        13
                        The pattern is available online at http://www.meaningfulspatialstatistics.org/theories/MeaningfulSpatialStatistics.owl. A diagram of the pattern is available online at http://www.meaningfulspatialstatistics.org/theories/MeaningfulSpatialStatistics.
                      It can be utilized to implement our approach not just for the R software, but also for other tools such as ArcGIS or Web services defined by the Open Geospatial Consortium as illustrated in Fig. 7
                     . Semantic annotations referencing the concepts in the OWL pattern can be added to datasets as described by Janowicz et al. (2010). OWL reasoners can be used to automatically determine which type of function has generated the data and which predictions or aggregations are applicable, based on type checks with subsumption reasoning. This replaces the issue of a manual declaration (see Fig. 6, first line in code) and of implementing type-based meaningfulness checks within each particular tool, enabling the creation of smarter data instead of smarter applications.

@&#DISCUSSION@&#

Due to the increasing variety and volume of data sources which have to be dealt with in automatic systems that support prediction and analysis, it becomes necessary to take the semantics of models and data explicitly into account in order to support data-model interoperability (Bell et al., 2009; Parsons et al., 2011). In this paper, we present a formal theory for meaningfulness of spatial prediction and aggregation that addresses this interoperability problem. We consider it as a first step towards recommender tools for spatio-temporal modelling.

In order to be used as a recommender service, the formal check of meaningfulness, which was performed in this paper in a semi-automated fashion, needs to be performed by tractable automated reasoning tools that allow to be used on the Web or in statistical software, since higher-order logic (HOL) reasoning is not decidable. The challenge therefore consists in constraining the reasoning problem, the matching of functions and data sets, sufficiently as to be fully automated. In this paper, we have made some suggestions and started with a preliminary recommender system based only on type-checks for spatial data in R (Pebesma and Bivand, 2005). It guides the users of spatial data in the application of appropriate aggregation and interpolation methods. While a first version of an OWL pattern representing the types defined in our formalism is available in the Web, further work needs to be done to implement the pattern in the Web as shown in Fig. 7.

In our approach, data needs to be classified as representing either (marked) point patterns, geostatistical, or lattice variables. We are aware that this is not a deterministic decision and there is a large degree of freedom in semantic conceptualization (compare the discussion in Scheider (2012), Chapter 4). This is also related to the well-known distinction between object-based and field-based approaches in GIS, which is a matter of information purpose and design (Couclelis, 1992) as well as observation (Frank, 2009). Our formal framework serves to make this decision explicit and transparent.

Since our approach explicitly takes into account data abstraction procedures, data at point support in a spatial reference system with a certain granularity might also be represented by spatial and/or temporal regions in another reference system with finer granularity. We have proposed to include the observed window in the observation procedure description, and shown how aggregation can be used to convert from one granularity to another.

Information about the sampling procedure might be of importance for statistical modelling, e.g., whether design-based methods can be applied (de Gruijter et al., 2006). This kind of information was not included in this paper, but may be incorporated in the observation procedure description and then used as additional information for reasoning about the meaningfulness of a particular prediction or aggregation.

Our notion of meaningfulness in aggregation requires that the regions over which data should be summed needs to be observed completely. In the OLAP and Statistical database community, several authors try to address the issue of summarizability as well (Lenz and Shoshani, 1997; Mazón et al., 2009; Niemi and Niinimäki, 2010) and also define a completeness condition. However, their definition of completeness states that each non-aggregated observation needs to be covered by at least one region. Instead, we require that knowledge is needed for the whole region over which data should be summed, which is the case for point pattern variables, but not for geostatistical variables. Our approach for spatio-temporal aggregation can be seen as a complementary contribution to this issue, as the work on the summarizability so far does not explicitly consider different types of spatial variables.

In our approach, we focus on the aggregation of point data (either point patterns or geostatistical variables) to areal data. However, the resulting areal data might be, in turn, aggregated to larger areas and so forth. It appears that the distinction between point patterns (i.e., discrete entities that are represented by some space-time geometry) and geostatistical variables (continuous phenomena in space/time) is still valid also for areal data. As an example, the sum of discrete entities still makes sense for areal data, e.g., summing the total CO2 emissions of power plants per each European country to the sum of Europe, while summing the temperature appears still not appropriate for polygonal data.

An example of an aggregation of the air quality variable PM10 is shown in Fig. 8
                     , which was published by the European Environmental Agency (2012). In this report, a section on Europe-wide survey of PM shows time trends in PM10 concentrations averaged over monitoring network stations with complete measurement records. Below the figure it notes that “in the diagrams a geographical bias exists towards central Europe where there is a higher density of stations”, but it is not made clear whether this bias refers to selection, to estimation, or both. We argue that these trends relate to the stations selected, rather than an area (Europe). Areal mean values can be predicted, e.g., by block kriging (Journel and Huijbregts, 1978).

While we have proposed meaningfulness of predictions based on reference systems, we have not yet considered meaningfulness of statistical models. An example is the decision for which area we may assume second order stationarity of a phenomenon. Interpolating PM10 values measured at traffic stations (Fig. 8) to areas with rural, traffic-free conditions (and vice versa) may not be meaningful. Towards such meaningful models, further work is needed to determine and formalize the additional required information. Our approach can be a starting point towards choosing such meaningful models. In the context of evaluating model performance (Bennett et al., 2013), our theory covers meaningfulness of spatial prediction and aggregation of model residuals. Furthermore, we do not include semantic descriptions of concrete application problems. An example of this would be predicting air quality over Beijing. The formalization of this application problem would allow matching appropriate data and prediction procedures with the application goal.

For meaningfulness of other aggregation functions than the sum, we are using Stevens' classification scheme (Stevens, 1946) and emphasize that point patterns might be considered as nominal data, whereas the application of statistical measures to marked point patterns, geostatistical and lattice data depends on the measurement scale of the quality values that are observed. As pointed out by several authors (Suppes and Zinnes, 1967; Hand, 1996; Chrisman, 1995), Stevens' classification of four measurement scale types is quite limited and there are several other types of measurement scales. For example, Chrisman (1995) proposes an extended framework for geographical measurement, which introduces additional measurement scale types (e.g., cyclic scale or absolute scale for probabilities) and which incorporates information whether space, time, or attributes have been fixed during the measurements. His work is based on earlier work of Sinton who distinguishes different variables related to its representation in thematic maps (Sinton, 1978). Similarly, we distinguish the different variable types in Spatial Statistics based upon fixed domains and those being considered as the result of a random process and show how these affect the meaningfulness of aggregation in case of using the sum as aggregation function. While we believe, that, in general, the other permissible statistics in Stevens' classification are meaningful for quality domains of marked point patterns and geostatistical data, more work needs to be done to examine other common aggregation functions and their meaningfulness regarding specific variable types and reference domains. Furthermore, different measurement scale types allow for different representations of the same process: The occurrence of longleaf pines can be represented as a point pattern (nominal scale) or as a Geostatistical variable with binary scale (false, if there are no pines, true otherwise) or as an absolute scale [0,1] showing the probability of longleaf pines presence as a derived measurement.

Finally, one might have concerns and argue that data exploration is always dealing with finding the unexpected and that the application of particular prediction or aggregation methods should not be restricted at all. While we, in general, agree that methods should not be disallowed, we believe that support on finding appropriate methods, and warnings in case inappropriate methods are applied, is useful as it increases awareness on the risk of drawing false conclusions due to inappropriate use of predictions or aggregations.

@&#CONCLUSION@&#

We introduced a new notion of meaningfulness of prediction and aggregation and formally specified it in a semantic theory in higher order logic (HOL). The theory consists of functional specifications of observation procedures, prediction procedures, aggregation procedures, as well as datasets based on semantic reference systems as types. Our notion of meaningfulness is based on the formal distinction between observation, prediction, and aggregation procedures on the one hand, which describe potential data, and data on the other hand, which is generated by executing these procedures. The different procedures are represented as functions of different types, which correspond to known variable types in Spatial Statistics. Data are represented by predicates on the domain and range of these functions, i.e., they are a finite subset of the tuples defined by a function. Meaningfulness checks are implemented in our formalism as correspondence checks: Meaningful prediction is introduced based on a correspondence check between observation functions and prediction functions that ensures that there is a possible observation for each prediction. Meaningful aggregation is based on checking whether an observed window corresponds to the target regions of an aggregation, hence testing the condition, that the target region needs to be observed completely in case of using the sum as an aggregation function. The theory, including definitions, axioms, and theorems, was implemented and tested with Isabelle/HOL, a semi-automated theory prover.

One challenge for future work consists in tractable implementations of meaningfulness checks in open Semantic Web environments as well as in statistical software. As environmental models always deal with uncertain data (Bastin et al., 2013), and since uncertainty can be seen as a consequence of observation (Frank, 2009), its inclusion in our formalism would be natural. Future work may also address the extension of our theory to cover other related notions of meaningfulness, the incorporation of sampling procedures, other types of aggregation and prediction, as well as further measurement scales.

@&#ACKNOWLEDGEMENTS@&#

The presented work was developed within the 52° North geostatistics community, and partly funded by the European Project UncertWeb (FP7-248488, see http://www.uncertweb.org/) and the International Research Training Group on Semantic Integration of Geospatial Information funded by the DFG (German Research Foundation), GRK 1498. Simon Scheider's contribution was partly funded by a research fellowship grant (DFG SCHE 1796/1-1) and the ICT-FP7-249120 ENVISION project.


                     Partial cardinality orders among domains can be formalized based on the existence of embeddings, i.e., injective total functions f :: X ⇒ Y from type X into the one with higher cardinality Y. Partial cardinality order on types, X ⊆
                        c
                      Y, thus, can be expressed in Isabelle as follows:
                        
                           
                              
                                 ∃
                                 
                                    (
                                    f
                                    :
                                    :
                                    X
                                    ⇒
                                    Y
                                    )
                                 
                                 .
                                 i
                                 n
                                 j
                                 
                                 f
                              
                           
                        
                     A strict cardinality order X ⊂
                        c
                      Y can be formalized accordingly by requiring that all mappings f :: X ⇒ Y are non-surjective, i.e., they do not fully cover Y. We formally capture this by an axiom that denies surjectivity:
                        Axiom 7
                        
                           Strict cardinality order on reference domains:
                              
                                 
                                    
                                       ¬
                                       
                                          (
                                          ∃
                                          
                                             (
                                             f
                                             :
                                             :
                                             
                                                D
                                                d
                                             
                                             ⇒
                                             
                                                D
                                                s
                                             
                                             )
                                          
                                          .
                                          s
                                          u
                                          r
                                          j
                                          
                                          f
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       ¬
                                       
                                          (
                                          ∃
                                          
                                             (
                                             f
                                             :
                                             :
                                             
                                                D
                                                d
                                             
                                             ⇒
                                             
                                                D
                                                t
                                             
                                             )
                                          
                                          .
                                          s
                                          u
                                          r
                                          j
                                          
                                          f
                                          )
                                       
                                    
                                 
                              
                           
                        

Which is how we translate the cardinality differences D
                     
                        d
                      ⊂
                        c
                      D
                     
                        s
                      ∧ D
                     
                        d
                      ⊂
                        c
                      D
                     
                        t
                      into Isabelle.

In order to prove that the prediction of CO2 emissions of coal power plants, represented by obs
                     
                        geost∗, with an Ordinary Kriging interpolation procedure, represented by pred
                     
                        geost
                     , is not meaningful (Theorem 2), it needs to be shown that Definition 3 is not satisfied by the functions obs
                     
                        geost∗ and pred
                     
                        geost
                     , i.e., that there are spatial and temporal locations at which the prediction function provides a quality value, but where the corresponding observation function returns an error. The following is a description of substeps of the automated proof which is available online.
                        14
                     
                     
                        14
                        
                           http://www.meaningfulspatialstatistics.org/theories/Miptheory.thy.
                     
                  


                     Proof. First, using Axiom 7 and the definition of surjectivity, it can be proved that all functions of type D
                     
                        d
                      ⇒ D
                     
                        s
                      (mappings from discrete entities into space) miss some entity in their range as specified in Theorem 4.
                        Theorem 4
                        
                           Non-surjectivity of object-space mappings: “∀ (f :: D
                           
                              d
                            ⇒ D
                           
                              s
                           ).(∃ (s :: D
                           
                              s
                           ).¬ (∃ (d :: D
                           
                              d
                           ). s = f d))”

Using only Theorem 4, it can be directly proved that the object localization function obs
                     
                        loc
                      misses entities in its range at all times (Theorem 5):
                        Theorem 5
                        
                           Non-surjectivity of obs
                           
                              loc
                           : “∀ t.(∃ s.¬ (∃ d. s = obs
                           
                              loc
                            
                           d t))”

Hence, using Definition 4 and Theorem 5, it can be proved that the inverse function obs
                     
                        invloc
                      generates errors for some spatial locations at all times:
                        Theorem 6
                        
                           Errors in obs
                           
                              invloc
                           : “∀ t. (∃ s. obs
                           
                              invloc
                            
                           s t = error)”

Thus, the pseudo-geostatistical observation function obs
                     
                        geost∗ produces errors, too, as it is constructed with obs
                     
                        invloc
                     . This can be proved by Theorem 6 and Definition 5:
                        Theorem 7
                        
                           Errors in obs
                           
                              geost∗ : “(∃ y x. obs
                           
                              geost∗ 
                           x y = error)”

Hence, the domain of obs
                     
                        geost∗ is of lower cardinality, i.e., defined only for a true discrete subset of D
                     
                        s
                     , reflecting the fact that CO2 emissions (in contrast to concentration) need emitters that are discrete objects (coal power plants). Thus, there are predictions that are not parallelled by any observation. Our goal was to show that predicting obs
                     
                        geost∗ with pred
                     
                        geost
                      is not meaningful (Theorem 2). This follows immediately from Theorem 7 and Definition 3. □

In order to show that the computation of a sum of geostatistical values, such as data
                     
                        geost
                     , over spatial lattices, such as slattice, is not meaningful (Theorem 3), we need to show that there exist locations in the spatial lattice that are not contained in the observed window of the observation data, corresponding to Definition 6. The following is a description of substeps of the automated proof which is available online.
                        15
                     
                     
                        15
                        
                           http://www.meaningfulspatialstatistics.org/theories/Miptheory.thy.
                     
                  


                     Proof. First, based on Axiom 6, we infer that the observed spatial window of data
                     
                        geost
                      needs to be finite:
                        Theorem 8
                        
                           Finiteness of observed spatial window of data
                           
                              geost
                           : “finite (windowSpace data
                           
                              geost
                           )”

In addition, based on Axioms 3 and 4, we can prove that regions in the spatial lattice slattice are not finite (actually, they are continuous sets of points):
                        Theorem 9
                        
                           Non-finiteness of lattice regions: “∀ x. slattice x → ¬ finite x”

Using the very same axioms together with Definition 2 for data properties, it can also be shown that there is at least one region in slattice.
                        Theorem 10
                        
                           Existence of region in slattice: “∃ x. slattice x”

From Theorems 8, 9, and Axiom 1, it follows that there is a spatial location in a region of the spatial lattice that is not part of the observed spatial window of data
                     
                        geost
                      :
                        Theorem 11
                        
                           Cardinality of observed window and regions: “∀ x. slattice x → (∃ z. (z ∈ x) ∧ ¬ (z: windowSpace data
                           
                              geost
                           ))”

Hence, the observed spatial window of data
                     
                        geost
                      is of lower cardinality than the regions in slattice. Theorems 11 and 10 together with Definition 6 for meaningful sum allow to derive Theorem 3 immediately. □

@&#REFERENCES@&#

