@&#MAIN-TITLE@&#Birational quadrilateral maps

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We show how to make a quad map be birational by assigning one control point weight.


                        
                        
                           
                           The weight is computed using a simple closed-form equation.


                        
                        
                           
                           For convex quads, the weight is positive and the pre-image is the 
                                 [
                                 0
                                 ,
                                 1
                                 ]
                                 ×
                                 [
                                 0
                                 ,
                                 1
                                 ]
                               domain.


                        
                        
                           
                           Any planar quad mesh can be made piecewise 
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                 
                               birational by using this method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Quadrilateral meshes

Birational map

@&#ABSTRACT@&#


               
               
                  A generic planar quadrilateral defines a 2:1 bilinear map. We show that by assigning an appropriate weight to one vertex of any planar quadrilateral, we can create a map whose inverse is rational linear.
               
            

@&#INTRODUCTION@&#

A planar quadrilateral with vertices 
                        
                           
                              P
                           
                           
                              i
                              j
                           
                        
                        =
                        (
                        
                           
                              x
                           
                           
                              i
                              j
                           
                        
                        ,
                        
                           
                              y
                           
                           
                              i
                              j
                           
                        
                        )
                      defines a bilinear map
                        
                           (1)
                           
                              P
                              (
                              s
                              ,
                              t
                              )
                              =
                              
                                 
                                    P
                                 
                                 
                                    00
                                 
                              
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                              +
                              
                                 
                                    P
                                 
                                 
                                    10
                                 
                              
                              s
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                              +
                              
                                 
                                    P
                                 
                                 
                                    01
                                 
                              
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              t
                              +
                              
                                 
                                    P
                                 
                                 
                                    11
                                 
                              
                              s
                              t
                           
                        
                      where 
                        
                           
                              s
                           
                           
                              ¯
                           
                        
                        =
                        (
                        1
                        −
                        s
                        )
                      and 
                        
                           
                              t
                           
                           
                              ¯
                           
                        
                        =
                        (
                        1
                        −
                        t
                        )
                     . If the quad is a trapezoid, the map is 1:1. Otherwise, the map is generally 2:1 and the inverse involves a square root (Wolberg, 1990). For point E in Fig. 1
                     .a,
                        
                           
                              s
                              =
                              
                                 
                                    x
                                    −
                                    4
                                    y
                                    +
                                    36
                                    ±
                                    
                                       
                                          f
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                    
                                 
                                 24
                              
                              ,
                              
                              t
                              =
                              
                                 
                                    −
                                    x
                                    +
                                    4
                                    y
                                    +
                                    36
                                    ±
                                    
                                       
                                          f
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                    
                                 
                                 32
                              
                              ,
                           
                        
                      where 
                        f
                        (
                        x
                        ,
                        y
                        )
                        =
                        
                           
                              x
                           
                           
                              2
                           
                        
                        −
                        8
                        x
                        y
                        +
                        16
                        
                           
                              y
                           
                           
                              2
                           
                        
                        −
                        72
                        x
                        −
                        96
                        y
                        +
                        1296
                     . So E has pre-images 
                        (
                        s
                        ,
                        t
                        )
                        =
                        (
                        
                           1
                           3
                        
                        ,
                        
                           3
                           4
                        
                        )
                      and 
                        (
                        s
                        ,
                        t
                        )
                        =
                        (
                        2
                        ,
                        2
                        )
                     . Fig. 1.b shows that E lies on two different t-isoparameter lines: 
                        t
                        =
                        
                           3
                           4
                        
                      and 
                        t
                        =
                        2
                     .

This paper proves that assigning a weight 
                        
                           
                              w
                           
                           
                              i
                              j
                           
                        
                      to one control point, the map defined by any non-degenerate quadrilateral can be forced to be generally 1:1 with a rational linear inverse.

For example, in Fig. 2
                     .a we assign 
                        
                           
                              w
                           
                           
                              01
                           
                        
                        =
                        
                           5
                           3
                        
                      to the quad in Fig. 1. In this case, point E lies on a single s- and t-isoparameter line. The inversion equations are 
                        s
                        =
                        
                           
                              3
                              x
                              −
                              4
                              y
                           
                           
                              26
                              −
                              4
                              y
                           
                        
                      and 
                        t
                        =
                        
                           
                              2
                              y
                           
                           
                              20
                              −
                              x
                           
                        
                      and the pre-image of E is 
                        (
                        s
                        ,
                        t
                        )
                        =
                        (
                        
                           2
                           5
                        
                        ,
                        
                           2
                           3
                        
                        )
                     . This is an example of a birational map, meaning that both the map and its inverse can be expressed as a polynomial divided by a polynomial.

As illustrated in Fig. 2.a, birational quadrilateral maps are characterized by the fact that each family of isoparameter lines form a pencil, that is, they pivot about axis points 
                        
                           
                              A
                           
                           
                              s
                           
                        
                      and 
                        
                           
                              A
                           
                           
                              t
                           
                        
                     , respectively. We now show how those pencils can be created by assigning a single control point weight.

Given a triple 
                        Q
                        =
                        (
                        a
                        ,
                        b
                        ,
                        c
                        )
                      of homogeneous projective coordinates, 
                        
                           Point
                        
                        (
                        Q
                        )
                      denotes the point whose Cartesian coordinates are 
                        (
                        a
                        /
                        c
                        ,
                        b
                        /
                        c
                        )
                      and 
                        
                           Line
                        
                        (
                        Q
                        )
                      denotes the line 
                        a
                        x
                        +
                        b
                        y
                        +
                        c
                        =
                        0
                     . Given triples 
                        
                           
                              Q
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              Q
                           
                           
                              2
                           
                        
                     , 
                        
                           Line
                        
                        (
                        
                           
                              Q
                           
                           
                              1
                           
                        
                        )
                      and 
                        
                           Line
                        
                        (
                        
                           
                              Q
                           
                           
                              2
                           
                        
                        )
                      intersect at 
                        
                           Point
                        
                        (
                        
                           
                              Q
                           
                           
                              1
                           
                        
                        ×
                        
                           
                              Q
                           
                           
                              2
                           
                        
                        )
                      and 
                        
                           Point
                        
                        (
                        
                           
                              Q
                           
                           
                              1
                           
                        
                        )
                      and 
                        
                           Point
                        
                        (
                        
                           
                              Q
                           
                           
                              2
                           
                        
                        )
                      lie on 
                        
                           Line
                        
                        (
                        
                           
                              Q
                           
                           
                              1
                           
                        
                        ×
                        
                           
                              Q
                           
                           
                              2
                           
                        
                        )
                     . The projective coordinates robustly express the intersection of two parallel lines as a point at infinity, i.e., a point for which 
                        c
                        =
                        0
                     .

If 
                        
                           
                              Q
                           
                           
                              1
                           
                        
                        ⋅
                        
                           
                              Q
                           
                           
                              2
                           
                        
                        =
                        0
                     , 
                        
                           Point
                        
                        (
                        
                           
                              Q
                           
                           
                              1
                           
                        
                        )
                      lies on 
                        
                           Line
                        
                        (
                        
                           
                              Q
                           
                           
                              2
                           
                        
                        )
                     . If 
                        Q
                        (
                        t
                        )
                        =
                        (
                        a
                        (
                        t
                        )
                        ,
                        b
                        (
                        t
                        )
                        ,
                        c
                        (
                        t
                        )
                        )
                      is a triple of polynomials, 
                        
                           Point
                        
                        (
                        Q
                        (
                        t
                        )
                        )
                      is a rational curve and 
                        
                           Line
                        
                        (
                        Q
                        (
                        t
                        )
                        )
                      is called a moving line (Sederberg et al., 1994), i.e., a line that moves as a function of t. Denoting 
                        
                           
                              Q
                           
                           
                              i
                              j
                           
                        
                        =
                        (
                        
                           
                              x
                           
                           
                              i
                              j
                           
                        
                        ,
                        
                           
                              y
                           
                           
                              i
                              j
                           
                        
                        ,
                        1
                        )
                      and 
                        
                           
                              
                                 
                                    Q
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              i
                              j
                           
                        
                        =
                        
                           
                              w
                           
                           
                              i
                              j
                           
                        
                        
                           
                              Q
                           
                           
                              i
                              j
                           
                        
                     ,
                        
                           (2)
                           
                              Q
                              (
                              s
                              ,
                              t
                              )
                              =
                              
                                 Point
                              
                              (
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    00
                                 
                              
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    10
                                 
                              
                              s
                              
                                 
                                    t
                                 
                                 
                                    ¯
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    01
                                 
                              
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              t
                              +
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    11
                                 
                              
                              s
                              t
                              )
                           
                        
                      defines a rational bilinear map. In Fig. 2.b,
                        
                           (3)
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       00
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       01
                                    
                                 
                                 )
                                 ×
                                 (
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       10
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       11
                                    
                                 
                                 )
                                 ,
                                 
                                 
                                    
                                       A
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       00
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       10
                                    
                                 
                                 )
                                 ×
                                 (
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       01
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       11
                                    
                                 
                                 )
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       01
                                    
                                 
                                 +
                                 s
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       11
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       C
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       00
                                    
                                 
                                 +
                                 s
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       10
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       10
                                    
                                 
                                 +
                                 s
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       11
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       00
                                    
                                 
                                 +
                                 s
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       01
                                    
                                 
                                 .
                              
                           
                        
                      For a generic quadrilateral, the families of s- and t-isoparameter lines are 
                        
                           Line
                        
                        (
                        
                           
                              I
                           
                           
                              s
                           
                        
                        (
                        s
                        )
                        )
                      and 
                        
                           Line
                        
                        (
                        
                           
                              I
                           
                           
                              t
                           
                        
                        (
                        t
                        )
                        )
                     , where
                        
                           
                              
                                 
                                    I
                                 
                                 
                                    s
                                 
                              
                              (
                              s
                              )
                              =
                              
                                 
                                    B
                                 
                                 
                                    s
                                 
                              
                              (
                              s
                              )
                              ×
                              
                                 
                                    C
                                 
                                 
                                    s
                                 
                              
                              (
                              s
                              )
                              ,
                              
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    B
                                 
                                 
                                    t
                                 
                              
                              (
                              t
                              )
                              ×
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                              (
                              t
                              )
                              .
                           
                        
                      
                     
                        
                           Line
                        
                        (
                        
                           
                              I
                           
                           
                              s
                           
                        
                        (
                        s
                        )
                        )
                      is a pencil with axis 
                        
                           Point
                        
                        (
                        
                           
                              A
                           
                           
                              s
                           
                        
                        )
                      if 
                        
                           
                              A
                           
                           
                              s
                           
                        
                        ⋅
                        
                           
                              I
                           
                           
                              s
                           
                        
                        (
                        s
                        )
                        ≡
                        0
                     . This implies
                        
                           (4)
                           
                              
                                 
                                    w
                                 
                                 
                                    01
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    10
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    s
                                 
                              
                              ⋅
                              
                                 
                                    Q
                                 
                                 
                                    01
                                 
                              
                              ×
                              
                                 
                                    Q
                                 
                                 
                                    10
                                 
                              
                              +
                              
                                 
                                    w
                                 
                                 
                                    11
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    00
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    s
                                 
                              
                              ⋅
                              
                                 
                                    Q
                                 
                                 
                                    11
                                 
                              
                              ×
                              
                                 
                                    Q
                                 
                                 
                                    00
                                 
                              
                              =
                              0
                              
                              or
                              
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          00
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          11
                                       
                                    
                                 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          01
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          10
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    ⋅
                                    
                                       
                                          Q
                                       
                                       
                                          01
                                       
                                    
                                    ×
                                    
                                       
                                          Q
                                       
                                       
                                          10
                                       
                                    
                                 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    ⋅
                                    
                                       
                                          Q
                                       
                                       
                                          00
                                       
                                    
                                    ×
                                    
                                       
                                          Q
                                       
                                       
                                          11
                                       
                                    
                                 
                              
                              .
                           
                        
                      Likewise, 
                        
                           Line
                        
                        (
                        
                           
                              I
                           
                           
                              t
                           
                        
                        (
                        t
                        )
                        )
                      is a pencil with axis 
                        
                           Point
                        
                        (
                        
                           
                              A
                           
                           
                              t
                           
                        
                        )
                      if
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          00
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          11
                                       
                                    
                                 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          01
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          10
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    ⋅
                                    
                                       
                                          Q
                                       
                                       
                                          10
                                       
                                    
                                    ×
                                    
                                       
                                          Q
                                       
                                       
                                          01
                                       
                                    
                                 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    ⋅
                                    
                                       
                                          Q
                                       
                                       
                                          00
                                       
                                    
                                    ×
                                    
                                       
                                          Q
                                       
                                       
                                          11
                                       
                                    
                                 
                              
                              .
                           
                        
                      Letting 
                        |
                        
                           ABC
                        
                        |
                      denote 
                        A
                        ×
                        B
                        ⋅
                        C
                     , and applying to (3) the identity
                        
                           
                              (
                              A
                              ×
                              B
                              )
                              ×
                              (
                              C
                              ×
                              D
                              )
                              =
                              
                                 (
                                 A
                                 ⋅
                                 (
                                 B
                                 ×
                                 D
                                 )
                                 )
                              
                              C
                              −
                              
                                 (
                                 A
                                 ⋅
                                 (
                                 B
                                 ×
                                 C
                                 )
                                 )
                              
                              D
                              ,
                           
                        
                      
                     (4) and (5) become equivalent to
                        
                           (6)
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          00
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          11
                                       
                                    
                                 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          01
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          10
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    |
                                    
                                       
                                          Q
                                       
                                       
                                          01
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          00
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          10
                                       
                                    
                                    |
                                    |
                                    
                                       
                                          Q
                                       
                                       
                                          10
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          11
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          01
                                       
                                    
                                    |
                                 
                                 
                                    |
                                    
                                       
                                          Q
                                       
                                       
                                          11
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          01
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          00
                                       
                                    
                                    |
                                    |
                                    
                                       
                                          Q
                                       
                                       
                                          00
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          10
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          11
                                       
                                    
                                    |
                                 
                              
                              =
                              ρ
                           
                        
                      where ρ is a constant. For trapezoids, 
                        ρ
                        =
                        1
                      so all weights can be one.

The main contribution of this paper is the observation that if (6) holds, 
                        
                           Line
                        
                        (
                        
                           
                              I
                           
                           
                              s
                           
                        
                        (
                        s
                        )
                        )
                      and 
                        
                           Line
                        
                        (
                        
                           
                              I
                           
                           
                              t
                           
                        
                        (
                        t
                        )
                        )
                      each form a pencil. Hence the map (2) is birational and we can find rational linear inversion equations as follows. If (6) holds and no three vertices are collinear,
                        
                           (7)
                           
                              
                                 Line
                              
                              
                                 (
                                 
                                    
                                       I
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 s
                                 )
                                 )
                              
                              =
                              
                                 Line
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       s
                                    
                                 
                                 ×
                                 
                                    
                                       B
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 s
                                 )
                                 )
                              
                              =
                              
                                 Line
                              
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       s
                                    
                                 
                                 ×
                                 
                                    
                                       C
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 s
                                 )
                                 )
                              
                              .
                           
                        
                      Point 
                        P
                        =
                        (
                        x
                        ,
                        y
                        ,
                        1
                        )
                      lies on 
                        
                           Line
                        
                        (
                        
                           
                              I
                           
                           
                              s
                           
                        
                        (
                        s
                        )
                        )
                      at the value of s for which 
                        |
                        
                           
                              A
                           
                           
                              s
                           
                        
                        
                           
                              B
                           
                           
                              s
                           
                        
                        (
                        s
                        )
                        P
                        |
                        =
                        0
                     :
                        
                           (8)
                           
                              s
                              =
                              
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          01
                                       
                                    
                                    P
                                    |
                                 
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          01
                                       
                                    
                                    P
                                    |
                                    −
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          11
                                       
                                    
                                    P
                                    |
                                 
                              
                              .
                           
                        
                      
                     P also lies on 
                        
                           Line
                        
                        (
                        
                           
                              I
                           
                           
                              s
                           
                        
                        (
                        s
                        )
                        )
                      at the value of s for which 
                        |
                        
                           
                              A
                           
                           
                              s
                           
                        
                        
                           
                              C
                           
                           
                              s
                           
                        
                        (
                        s
                        )
                        P
                        |
                        =
                        0
                     :
                        
                           (9)
                           
                              s
                              =
                              
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          00
                                       
                                    
                                    P
                                    |
                                 
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          00
                                       
                                    
                                    P
                                    |
                                    −
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          10
                                       
                                    
                                    P
                                    |
                                 
                              
                              .
                           
                        
                      In similar manner, we obtain two inversion equations for t as
                        
                           (10)
                           
                              t
                              =
                              
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          10
                                       
                                    
                                    P
                                    |
                                 
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          10
                                       
                                    
                                    P
                                    |
                                    −
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          11
                                       
                                    
                                    P
                                    |
                                 
                              
                           
                        
                     
                     
                        
                           (11)
                           
                              t
                              =
                              
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          00
                                       
                                    
                                    P
                                    |
                                 
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          00
                                       
                                    
                                    P
                                    |
                                    −
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          01
                                       
                                    
                                    P
                                    |
                                 
                              
                              .
                           
                        
                     
                  

If no three vertices are collinear, (8) and (9) produce the same value of s and (10) and (11) produce the same value of t, so all four are valid inversion equations. If 
                        
                           
                              Q
                           
                           
                              10
                           
                        
                     , 
                        
                           
                              Q
                           
                           
                              11
                           
                        
                     , and 
                        
                           
                              Q
                           
                           
                              01
                           
                        
                      are collinear, as shown in Fig. 3
                     .a, (6) requires 
                        
                           
                              w
                           
                           
                              11
                           
                        
                        =
                        0
                      and the geometry produces 
                        
                           
                              A
                           
                           
                              s
                           
                        
                        =
                        
                           
                              Q
                           
                           
                              01
                           
                        
                      and 
                        
                           
                              A
                           
                           
                              t
                           
                        
                        =
                        
                           
                              Q
                           
                           
                              10
                           
                        
                     . Consequently, (9) and (11) are valid inversion equations but (8) and (10) are not. The same discussion applies to the “hanging” vertex example in Fig. 3.b.

In the case of a non-convex quadrilateral, the weight of the concave vertex is negative, as illustrated in Fig. 4
                     .a. While the inversion equations work in this case, only points within the region bounded by quadrilateral 
                        
                           
                              Q
                           
                           
                              00
                           
                        
                        
                           
                              A
                           
                           
                              t
                           
                        
                        
                           
                              Q
                           
                           
                              11
                           
                        
                        
                           
                              A
                           
                           
                              s
                           
                        
                      have pre-images in the 
                        [
                        0
                        ,
                        1
                        ]
                        ×
                        [
                        0
                        ,
                        1
                        ]
                      domain. The inversion equations work properly in the self-intersection case shown in Fig. 4.b, and the pre-image of each point in the twisted quadrilateral lie in the 
                        [
                        0
                        ,
                        1
                        ]
                        ×
                        [
                        0
                        ,
                        1
                        ]
                      domain. In this example, all weights are positive, even though two of the triple-products in (6) are negative. We can also satisfy (6) by assigning 
                        
                           
                              w
                           
                           
                              10
                           
                        
                        =
                        
                           
                              w
                           
                           
                              01
                           
                        
                        =
                        −
                        2
                     , however the inversion equation for s applied to points in the twisted quadrilateral lie outside 
                        [
                        0
                        ,
                        1
                        ]
                     .

The birational maps we have presented are generally 1:1, but not everywhere. Pencils 
                        
                           Line
                        
                        (
                        
                           
                              I
                           
                           
                              s
                           
                        
                        (
                        s
                        )
                        )
                      and 
                        
                           Line
                        
                        (
                        
                           
                              I
                           
                           
                              t
                           
                        
                        (
                        t
                        )
                        )
                      have one line in common: 
                        
                           Line
                        
                        (
                        
                           
                              A
                           
                           
                              s
                           
                        
                        ×
                        
                           
                              A
                           
                           
                              t
                           
                        
                        )
                     . From (8)–(11), all points on that line have an s parameter
                        
                           
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              s
                              =
                              
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          01
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    |
                                 
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          01
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    |
                                    −
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          11
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    |
                                 
                              
                              =
                              
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          00
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    |
                                 
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          00
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    |
                                    −
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          10
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    |
                                 
                              
                              ,
                           
                        
                      and a t parameter
                        
                           
                              
                                 
                                    t
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          10
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    |
                                 
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          10
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    |
                                    −
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          11
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    |
                                 
                              
                              =
                              
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          00
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    |
                                 
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          00
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    |
                                    −
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          01
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                    
                                    |
                                 
                              
                              .
                           
                        
                      Thus, point 
                        (
                        s
                        ,
                        t
                        )
                        =
                        (
                        
                           
                              s
                           
                           
                              ˆ
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              ˆ
                           
                        
                        )
                      “blows up” to 
                        
                           Line
                        
                        (
                        
                           
                              A
                           
                           
                              s
                           
                        
                        ×
                        
                           
                              A
                           
                           
                              t
                           
                        
                        )
                     .

Since all s-isoparameter lines pass through 
                        
                           
                              A
                           
                           
                              s
                           
                        
                      and all t-isoparameter lines pass through 
                        
                           
                              A
                           
                           
                              t
                           
                        
                     , the pre-image of 
                        
                           
                              A
                           
                           
                              s
                           
                        
                      is the line 
                        t
                        =
                        
                           
                              t
                           
                           
                              ˆ
                           
                        
                      and the pre-image of 
                        
                           
                              A
                           
                           
                              t
                           
                        
                      is the line 
                        s
                        =
                        
                           
                              s
                           
                           
                              ˆ
                           
                        
                     . In other words,
                        
                           
                              
                                 Point
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    s
                                 
                              
                              )
                              =
                              
                                 Point
                              
                              
                                 (
                                 Q
                                 (
                                 s
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                                 )
                              
                              ,
                              
                              
                                 Point
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                              )
                              =
                              
                                 Point
                              
                              
                                 (
                                 Q
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 t
                                 )
                                 )
                              
                              .
                           
                        
                     
                  

The map (2) is bilinear in s, t. If we convert (2) to power basis, the st coefficient is 
                        
                           
                              
                                 
                                    Q
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              00
                           
                        
                        −
                        
                           
                              
                                 
                                    Q
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              10
                           
                        
                        −
                        
                           
                              
                                 
                                    Q
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              01
                           
                        
                        +
                        
                           
                              
                                 
                                    Q
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              11
                           
                        
                     , which vanishes if
                        
                           (12)
                           
                              
                                 
                                    w
                                 
                                 
                                    00
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    00
                                 
                              
                              −
                              
                                 
                                    w
                                 
                                 
                                    10
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    10
                                 
                              
                              −
                              
                                 
                                    w
                                 
                                 
                                    01
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    01
                                 
                              
                              +
                              
                                 
                                    w
                                 
                                 
                                    11
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    11
                                 
                              
                              =
                              0
                              .
                           
                        
                      The general-case solution to (12) is
                        
                           (13)
                           
                              
                                 
                                    w
                                 
                                 
                                    00
                                 
                              
                              :
                              
                                 
                                    w
                                 
                                 
                                    10
                                 
                              
                              :
                              
                                 
                                    w
                                 
                                 
                                    01
                                 
                              
                              :
                              
                                 
                                    w
                                 
                                 
                                    11
                                 
                              
                              =
                              |
                              
                                 
                                    Q
                                 
                                 
                                    10
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    01
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    11
                                 
                              
                              |
                              :
                              |
                              
                                 
                                    Q
                                 
                                 
                                    00
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    01
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    11
                                 
                              
                              |
                              :
                              |
                              
                                 
                                    Q
                                 
                                 
                                    00
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    11
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    10
                                 
                              
                              |
                              :
                              |
                              
                                 
                                    Q
                                 
                                 
                                    00
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    01
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    10
                                 
                              
                              |
                           
                        
                      The fact that a quad map (2) is affine if it satisfies (13) is algebraically equivalent to a well-known result for mapping the vertices of a quad to the vertices of a square by solving a 
                        4
                        ×
                        4
                      linear system (Wolberg, 1990). Affine maps are birational, and weights that satisfy (13) also satisfy (6).

@&#DISCUSSION@&#

The main contribution of this paper is (6). This result says that we can assign weights to any three vertices of a planar quad and solve for the fourth weight using (6) such that the quad will be birational. Thus, birationality can be obtained by imposing a single scalar constraint.

Using this insight, a planar mesh of quads whose map is 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      can be constructed by growing the mesh one quad at a time and solving for the free weight(s) using (6). By contrast, the condition (13) for affine map has no degrees of freedom, so if quads in a mesh were each made birational using the method in Section 5, the map derived from such a mesh would be 
                        
                           
                              C
                           
                           
                              −
                              1
                           
                        
                     .


                     Fig. 1.b can be interpreted as the projection of a doubly-ruled quadric surface, a topic studied in classical projective geometry (Semple and Kneebone, 1979) where it is well-known, for example, that the envelope curve shown in Fig. 1.b is a conic. However, to our knowledge, the result in (6) has not appeared in the literature, either classical or recent.

While the results in this paper apply only to planar quadrilaterals, non-planar bilinear patches are always birational, for any choice of weights (Sederberg et al., 1984).

Quadrilaterals and quad meshes have played an important role in computer graphics, geometric design, and analysis for several decades, and it is somewhat surprising that the insight in Section 2 has been overlooked. While the result is relatively simple, its importance is amplified because quad meshes are ubiquitous. The concept can be of value in algorithms where inverse maps need to be calculated, such as image warping, morphing, and texture mapping in ray tracing.

@&#REFERENCES@&#

