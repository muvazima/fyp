@&#MAIN-TITLE@&#Robust quadratic assignment problem with budgeted uncertain flows

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A robust approach for quadratic assignment problem (RQAP) with budgeted uncertainty.


                        
                        
                           
                           An exact and two heuristic methods to solve RQAP.


                        
                        
                           
                           Extensive experiments to show performance of methods and quality of solutions.


                        
                        
                           
                           RQAP can be solved significantly faster than minmax regret QAP.


                        
                        
                           
                           RQAP has adjustable conservativeness while minmax regret QAP has not.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Robust optimization

Budgeted uncertainty

Quadratic assignment problem

2-Opt

Tabu search

@&#ABSTRACT@&#


               
               
                  We consider a generalization of the classical quadratic assignment problem, where material flows between facilities are uncertain, and belong to a budgeted uncertainty set. The objective is to find a robust solution under all possible scenarios in the given uncertainty set. We present an exact quadratic formulation as a robust counterpart and develop an equivalent mixed integer programming model for it. To solve the proposed model for large-scale instances, we also develop two different heuristics based on 2-Opt local search and tabu search algorithms. We discuss performance of these methods and the quality of robust solutions through extensive computational experiments.
               
            

@&#INTRODUCTION@&#


                     [1] introduced the standard quadratic assignment problem (QAP). Standard QAP deals with choosing an optimal way to assign 
                        n
                      facilities to 
                        n
                      locations to minimize the total material handling cost, given all distances between locations and the amount of material flow between each pair of facilities. A more general form of the QAP was proposed by  [2].  [3,4] considered multi-dimensional QAP.

QAP is one of the hardest problems in combinatorial optimization  [5,6] and even finding a constant-factor approximate solution for the QAP is NP-hard  [7]. However, some specific cases of QAP are easy to solve  [8,9]. Many exact and heuristic methods have been developed to solve different cases of QAP. Approximated dynamic programming  [10], genetic algorithm  [11], parallel algorithms  [12,13], hybrid algorithms  [14], teaching learning based optimization  [15], semidefinite programming relaxations  [16,17], mixed integer linear programming reformulation  [18–22], reformulation linearization technique (RLT)  [23–25], formulation reductions  [26], and exploiting data structure  [27] are some of these techniques.

QAP has numerous applications such as backboard wiring  [28], scheduling problems  [29], economic problems  [30], designing typewriter keyboards  [31], facility layout  [32–34], assembling printed circuit boards  [35] and many other applications. For a detailed discussion about applications and solution methods for QAP see  [36,6,37,38].

In deterministic optimization, it is assumed that input data (e.g. flows between facilities and distances between locations in QAP) are precisely known in advance. Although this assumption can be true in some applications, it is not realistic in many others  [39]. [40] proposed a design for robust facility layout under the dynamic demand environment. In their approach, the layout of expected flow or expected demand is applied in all the periods. [41] developed a fuzzy model to address uncertainty in QAP. [42] reviewed facility location problems under uncertainty.  [43] studied integration of facility layout design and flow assignment problem under demand uncertainty. [44] considered uncertainty in a hospital layout problem and proposed a robust model for this problem. QAP with uncertain locations was studied in  [39].  [45] used a robust deviation (minmax regret) approach to deal with uncertainty in material flows.

In uncertain optimization problems with discrete variables, in addition to robust deviation, we can use budgeted uncertainty which has the same complexity as the original model and adjustable conservativeness  [46,47]. In practice, for an uncertain mixed integer programming (MIP) problem with interval data, solving robust counterparts for budgeted uncertainty sets is much easier than finding the minmax regret solution. For example, in redundancy allocation problems, this difference is obvious by comparing the results in  [48–51], respectively. In addition, former method can find solutions with different levels of conservativeness, while the latter approach outputs only one conservative solution.

In this paper, we consider a generalization of the QAP where the flows are uncertain for some subset 
                        J
                      of pairs of facilities. For the flow between each pair of facilities only an interval estimate (uncertainty interval) is available, and the flow can take on any value from the corresponding uncertainty interval. But, for a given protection level 
                        Γ
                        ∈
                        
                           [
                           0
                           ,
                           
                              |
                              J
                              |
                           
                           ]
                        
                     , it is assumed that at most 
                        
                           ⌊
                           Γ
                           ⌋
                        
                      of uncertain flows are allowed to change, and one flow changes by a ratio of at most 
                        
                           (
                           Γ
                           −
                           
                              ⌊
                              Γ
                              ⌋
                           
                           )
                        
                      of its uncertainty interval. We are interested in an assignment which minimizes the maximum cost for any possible realization of flows. In other words, because it is unlikely that all uncertain flows adversely affect the cost of assignment, it is assumed that only a subset of uncertain flows change from their nominal values.

This paper is organized as follows. In Section  2, we present notation and problem statement for deterministic and uncertain QAP, and an efficient MIP equivalent for QAP. In Section  3, we develop a mathematical programming formulation of the problem as well as an equivalent MIP model. Then, two heuristic algorithms are described in Section  4. Experimental results are discussed in Section  5, and conclusions are presented in Section  6.

In this section, we first present notation and problem statement for classical QAP which is mostly quoted from  [45] with some slight adjustments. Then, we present an efficient MIP equivalent for QAP from the literature. Finally, we introduce budgeted uncertainty in flow between facilities and describe some concepts related to the proposed uncertain QAP.

In the standard version of QAP, it is assumed that there are 
                           n
                         facilities that should be assigned to 
                           n
                         locations, in order to minimize the total material handling cost  [1]. Let 
                           N
                           =
                           
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              }
                           
                        . For each pair 
                           i
                           ,
                           j
                           ∈
                           N
                         of facilities, let 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                           
                           ≥
                           0
                         be the flow from facility 
                           i
                         to facility 
                           j
                        . In addition, for each pair 
                           k
                           ,
                           l
                           ∈
                           N
                         of locations, let 
                           
                              
                                 d
                              
                              
                                 k
                                 l
                              
                           
                           ≥
                           0
                         be the travel distance from location 
                           k
                         to location 
                           l
                        . An assignment of facilities to locations can be represented by an 
                           n
                           ×
                           n
                         binary matrix 
                           X
                        , where
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             if facility  
                                             i
                                               is assigned to location  
                                             k
                                             ,
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise.
                                          
                                       
                                    
                                 
                              
                           
                        In any feasible assignment 
                           X
                           ∈
                           
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                              
                              
                                 n
                                 ×
                                 n
                              
                           
                        , each location must be assigned exactly to one facility, and similarly each facility must be located exactly in one location. Therefore, the set 
                           P
                         of all possible assignments is defined by constraints 
                           
                              
                                 (1)
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    =
                                    1
                                    
                                    ∀
                                    i
                                    ∈
                                    N
                                    ,
                                 
                              
                              
                                 (2)
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    =
                                    1
                                    
                                    ∀
                                    k
                                    ∈
                                    N
                                    ,
                                 
                              
                              
                                 (3)
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    i
                                    ,
                                    k
                                    ∈
                                    N
                                    .
                                 
                              
                           
                        
                     

For any 
                           X
                           ∈
                           P
                        , let 
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                              
                                 X
                              
                           
                         denote the location assigned to facility 
                           i
                         in assignment 
                           X
                        . Let 
                           
                              
                                 d
                              
                              
                                 i
                                 j
                              
                              
                                 X
                              
                           
                         be the distance between facilities 
                           i
                         and 
                           j
                         in assignment 
                           X
                        . Therefore, 
                           
                              (4)
                              
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       X
                                    
                                 
                                 ≔
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                          
                                             X
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                          
                                             X
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       k
                                       l
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       j
                                       l
                                    
                                 
                                 .
                              
                           
                         Given an 
                           n
                           ×
                           n
                         flow matrix 
                           f
                           =
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                           
                         and an assignment 
                           X
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                    k
                                 
                              
                              )
                           
                           ∈
                           P
                        , let 
                           
                              〈
                              f
                              ,
                              X
                              〉
                           
                         denote the corresponding cost of the assignment, 
                           
                              (5)
                              
                                 
                                    〈
                                    f
                                    ,
                                    X
                                    〉
                                 
                                 ≔
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       k
                                       l
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       j
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       X
                                    
                                 
                                 .
                              
                           
                        
                     

For a given flow matrix 
                           f
                        , the classical QAP is: 
                           
                              (6)
                              
                                 
                                    QAP
                                 
                                 
                                    (
                                    f
                                    )
                                 
                                 :
                                 
                                 Minimize  
                                 
                                    {
                                    
                                       〈
                                       f
                                       ,
                                       X
                                       〉
                                    
                                    
                                    |
                                    
                                    X
                                    ∈
                                    P
                                    }
                                 
                                 .
                              
                           
                        
                     


                        [2] proposed a more general form of the QAP as follows: 
                           
                              (7)
                              
                                 
                                    
                                       min
                                    
                                    
                                       X
                                       ∈
                                       P
                                    
                                 
                                 
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                       k
                                       l
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       j
                                       l
                                    
                                 
                              
                           
                         where 
                           
                              
                                 c
                              
                              
                                 i
                                 j
                                 k
                                 l
                              
                           
                           ≥
                           0
                        , 
                           i
                           ,
                           j
                           ,
                           k
                           ,
                           l
                           ∈
                           N
                         are given coefficients. Note that QAP(
                           f
                        ) is a special case of (7) where 
                           
                              
                                 c
                              
                              
                                 i
                                 j
                                 k
                                 l
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                           
                           
                              
                                 d
                              
                              
                                 k
                                 l
                              
                           
                        , for all 
                           i
                           ,
                           j
                           ,
                           k
                           ,
                           l
                           ∈
                           N
                        . As discussed in  [6], different approaches have been developed to linearize the general QAP (7).  [22] demonstrated experimentally that  [19] linearization is quite effective as a MIP formulation for the general QAP. The Xia-Yuan linearization for general QAP (7) is: 
                           
                              
                                 (8)
                                 
                                    
                                       
                                          min
                                       
                                       
                                          X
                                          ∈
                                          P
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                             k
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             i
                                             k
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             k
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 (9)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    ≥
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                j
                                                ≠
                                                i
                                             
                                          
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                l
                                                =
                                                1
                                             
                                             
                                                l
                                                ≠
                                                k
                                             
                                          
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          j
                                          k
                                          l
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          j
                                          l
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             k
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    ∀
                                    i
                                    ,
                                    k
                                    ∈
                                    N
                                    ,
                                 
                              
                              
                                 (10)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    ≥
                                    
                                       
                                          l
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    ,
                                    
                                    ∀
                                    i
                                    ,
                                    k
                                    ∈
                                    N
                                    ,
                                 
                              
                           
                         where 
                           
                              (11)
                              
                                 
                                    
                                       l
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             X
                                             ∈
                                             P
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                   k
                                                
                                             
                                             =
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             j
                                             ≠
                                             i
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             l
                                             =
                                             1
                                          
                                          
                                             l
                                             ≠
                                             k
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                       k
                                       l
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       j
                                       l
                                    
                                 
                                 ,
                                 
                                 and
                                 
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       
                                          
                                             X
                                             ∈
                                             P
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                   k
                                                
                                             
                                             =
                                             1
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             j
                                             ≠
                                             i
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             l
                                             =
                                             1
                                          
                                          
                                             l
                                             ≠
                                             k
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                       k
                                       l
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       j
                                       l
                                    
                                 
                                 .
                              
                           
                         Observe that constants 
                           
                              
                                 l
                              
                              
                                 i
                                 k
                              
                           
                        , 
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 k
                              
                           
                         are obtained by means of solving the regular linear assignment problems (11) which can be done in polynomial time  [6]. Values 
                           
                              
                                 l
                              
                              
                                 i
                                 k
                              
                           
                         are called Gilmore–Lawler constants  [6]. Formulation (8)–(10) has 
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                         binary variables, 
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                         continuous variables, and 
                           2
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           +
                           2
                           n
                         linear constraints.


                        QAP(
                           f
                        ) is a valid optimization problem as long as the values of flows and distances are known precisely. However, flows between facilities are typically only estimated within most likely intervals. In the remainder of the paper, we deal with uncertain flows.

Suppose that for any 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                           ∈
                           N
                           ×
                           N
                        , two numbers 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 −
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 +
                              
                           
                         are given, 
                           0
                           ≤
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 −
                              
                           
                           ≤
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 +
                              
                           
                        , where 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 −
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 +
                              
                           
                         are lower and upper bounds for 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                           
                        , respectively. Let 
                           J
                           ⊂
                           N
                           ×
                           N
                         be the set of pairs 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                         of facilities with uncertain flow; that is, 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 −
                              
                           
                           <
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 +
                              
                           
                         for all 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                           ∈
                           J
                        , and 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 −
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 +
                              
                           
                         for all 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                           ∈
                           
                              
                                 J
                              
                              
                                 c
                              
                           
                           =
                           
                              (
                              N
                              ×
                              N
                              )
                           
                           ∖
                           J
                        . Assume that the flow 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                           
                         can take any value on 
                           
                              [
                              
                                 
                                    f
                                 
                                 
                                    i
                                    j
                                 
                                 
                                    −
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    i
                                    j
                                 
                                 
                                    +
                                 
                              
                              ]
                           
                        . To normalize the uncertainty set, suppose that 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 −
                              
                           
                           +
                           
                              
                                 δ
                              
                              
                                 i
                                 j
                              
                           
                           
                              
                                 ξ
                              
                              
                                 i
                                 j
                              
                           
                        , where 
                           
                              
                                 δ
                              
                              
                                 i
                                 j
                              
                           
                           ≔
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 +
                              
                           
                           −
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 −
                              
                           
                         is the interval length and 
                           
                              
                                 ξ
                              
                              
                                 i
                                 j
                              
                           
                         is an uncertain variable in 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        . Let 
                           
                              
                                 f
                              
                              
                                 −
                              
                           
                        , 
                           
                              
                                 f
                              
                              
                                 +
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 =
                              
                           
                         be the scenarios (flow matrices) where for all 
                           i
                           ,
                           j
                           ∈
                           N
                        , 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                           
                         equals to 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 −
                              
                           
                        , 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 +
                              
                           
                         and 
                           0.5
                           ×
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    i
                                    j
                                 
                                 
                                    −
                                 
                              
                              +
                              
                                 
                                    f
                                 
                                 
                                    i
                                    j
                                 
                                 
                                    +
                                 
                              
                              )
                           
                        , respectively. For a given protection level 
                           Γ
                           ∈
                           
                              [
                              0
                              ,
                              
                                 |
                                 J
                                 |
                              
                              ]
                           
                        , the set 
                           
                              (12)
                              
                                 
                                    
                                       U
                                    
                                    
                                       Γ
                                    
                                 
                                 ≔
                                 
                                    {
                                    ξ
                                    ∈
                                    
                                       
                                          ℜ
                                       
                                       
                                          
                                             |
                                             J
                                             |
                                          
                                       
                                    
                                    :
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ≤
                                    Γ
                                    ,
                                    
                                    0
                                    ≤
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ≤
                                    1
                                    ,
                                    
                                    ∀
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    J
                                    }
                                 
                              
                           
                         is called a budgeted uncertainty set.  [46] introduced budgeted uncertainty to construct robust counterparts for LP and MIP models with adjustable conservativeness. While 
                           Γ
                           =
                           0
                         gives the most optimistic solution (deterministic problem with 
                           f
                           =
                           
                              
                                 f
                              
                              
                                 −
                              
                           
                        ), 
                           Γ
                           =
                           
                              |
                              J
                              |
                           
                         generates the most pessimistic one (deterministic problem with 
                           f
                           =
                           
                              
                                 f
                              
                              
                                 +
                              
                           
                        ).

For any perturbation vector 
                           ξ
                        , denote the corresponding flow matrix by 
                           f
                           
                              (
                              ξ
                              )
                           
                        . Then, the uncertainty set for flow matrix 
                           f
                         is: 
                           
                              (13)
                              
                                 
                                    
                                       V
                                    
                                    
                                       Γ
                                    
                                 
                                 ≔
                                 
                                    {
                                    f
                                    ∈
                                    
                                       
                                          ℜ
                                       
                                       
                                          n
                                          ×
                                          n
                                       
                                    
                                    :
                                    ∃
                                    ξ
                                    ∈
                                    
                                       
                                          U
                                       
                                       
                                          Γ
                                       
                                    
                                      such that  
                                    f
                                    =
                                    f
                                    
                                       (
                                       ξ
                                       )
                                    
                                    }
                                 
                                 =
                                 
                                    {
                                    f
                                    ∈
                                    
                                       
                                          ℜ
                                       
                                       
                                          n
                                          ×
                                          n
                                       
                                    
                                    :
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                −
                                             
                                          
                                       
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    ≤
                                    Γ
                                    ,
                                    
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          −
                                       
                                    
                                    ≤
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ≤
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          +
                                       
                                    
                                    ,
                                    ∀
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    N
                                    ×
                                    N
                                    }
                                 
                                 .
                              
                           
                         For a given 
                           Γ
                           ∈
                           
                              [
                              0
                              ,
                              
                                 |
                                 J
                                 |
                              
                              ]
                           
                        , the robust QAP is formulated as follows: 
                           
                              (14)
                              
                                 
                                    RQAP
                                 
                                 :
                                 
                                 
                                    
                                       min
                                    
                                    
                                       X
                                       ∈
                                       P
                                    
                                 
                                 
                                 
                                    
                                       max
                                    
                                    
                                       f
                                       ∈
                                       
                                          
                                             V
                                          
                                          
                                             Γ
                                          
                                       
                                    
                                 
                                 
                                 
                                    〈
                                    f
                                    ,
                                    X
                                    〉
                                 
                                 .
                              
                           
                        
                     

For any assignment 
                           X
                           ∈
                           P
                        , the value 
                           
                              (15)
                              
                                 Z
                                 
                                    (
                                    X
                                    )
                                 
                                 ≔
                                 
                                    
                                       max
                                    
                                    
                                       f
                                       ∈
                                       
                                          
                                             V
                                          
                                          
                                             Γ
                                          
                                       
                                    
                                 
                                 
                                 
                                    〈
                                    f
                                    ,
                                    X
                                    〉
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       ξ
                                       ∈
                                       
                                          
                                             U
                                          
                                          
                                             Γ
                                          
                                       
                                    
                                 
                                 
                                 
                                    〈
                                    f
                                    
                                       (
                                       ξ
                                       )
                                    
                                    ,
                                    X
                                    〉
                                 
                              
                           
                         is called the worst-case or robust cost for 
                           X
                        . A maximizer in (15) is called a worst-case scenario for 
                           X
                        , which is denoted by 
                           
                              
                                 f
                              
                              
                                 X
                              
                           
                        . The corresponding worst-case perturbation vector is 
                           
                              
                                 ξ
                              
                              
                                 X
                              
                           
                         where 
                           
                              
                                 f
                              
                              
                                 X
                              
                           
                           =
                           f
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    X
                                 
                              
                              )
                           
                        . RQAP seeks a feasible solution with the smallest robust cost. Let 
                           
                              
                                 Z
                              
                              
                                 ∗
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 ∗
                              
                           
                         be the optimal objective value and solution for RQAP, respectively.

Let 
                           R
                           C
                           
                              (
                              X
                              )
                           
                         denotes the difference between 
                           Z
                           
                              (
                              X
                              )
                           
                         and 
                           
                              〈
                              
                                 
                                    f
                                 
                                 
                                    −
                                 
                              
                              ,
                              X
                              〉
                           
                         (i.e. the robust and optimistic costs of 
                           X
                        , respectively) which is called the robustness cost of assignment 
                           X
                        . In other words, 
                           
                              (16)
                              
                                 R
                                 C
                                 
                                    (
                                    X
                                    )
                                 
                                 ≔
                                 Z
                                 
                                    (
                                    X
                                    )
                                 
                                 −
                                 
                                    〈
                                    
                                       
                                          f
                                       
                                       
                                          −
                                       
                                    
                                    ,
                                    X
                                    〉
                                 
                                 .
                              
                           
                         By substituting 
                           
                              〈
                              f
                              ,
                              X
                              〉
                           
                         from (5) into (15), we have 
                           
                              (17)
                              
                                 Z
                                 
                                    (
                                    X
                                    )
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       ξ
                                       ∈
                                       
                                          
                                             U
                                          
                                          
                                             Γ
                                          
                                       
                                    
                                 
                                 
                                 
                                    {
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          X
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       ξ
                                       ∈
                                       
                                          
                                             U
                                          
                                          
                                             Γ
                                          
                                       
                                    
                                 
                                 
                                 
                                    {
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             −
                                          
                                       
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          X
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       −
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       X
                                    
                                 
                                 +
                                 
                                    
                                       max
                                    
                                    
                                       ξ
                                       ∈
                                       
                                          
                                             U
                                          
                                          
                                             Γ
                                          
                                       
                                    
                                 
                                 
                                 
                                    {
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          X
                                       
                                    
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    〈
                                    
                                       
                                          f
                                       
                                       
                                          −
                                       
                                    
                                    ,
                                    X
                                    〉
                                 
                                 +
                                 
                                    
                                       max
                                    
                                    
                                       ξ
                                       ∈
                                       
                                          
                                             U
                                          
                                          
                                             Γ
                                          
                                       
                                    
                                 
                                 
                                 
                                    {
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          X
                                       
                                    
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    }
                                 
                              
                           
                         where the first and last equalities hold by definition. The second equality is true because 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 −
                              
                           
                           +
                           
                              
                                 δ
                              
                              
                                 i
                                 j
                              
                           
                           
                              
                                 ξ
                              
                              
                                 i
                                 j
                              
                           
                        , 
                           ∀
                           i
                           ,
                           j
                        . The third equality follows from the facts that for a given 
                           X
                        , 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                              
                                 −
                              
                           
                           
                              
                                 d
                              
                              
                                 i
                                 j
                              
                              
                                 X
                              
                           
                         is a constant 
                           ∀
                           i
                           ,
                           j
                        , and 
                           
                              
                                 δ
                              
                              
                                 i
                                 j
                              
                           
                           =
                           0
                         if 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                           ∉
                           J
                        . Eqs. (16) and (17) imply 
                           
                              (18)
                              
                                 R
                                 C
                                 
                                    (
                                    X
                                    )
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       ξ
                                       ∈
                                       
                                          
                                             U
                                          
                                          
                                             Γ
                                          
                                       
                                    
                                 
                                 
                                 
                                    {
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          X
                                       
                                    
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

In the following proposition, we show how to find a worst-case scenario for a given 
                           X
                        .


                        
                           Proposition 1
                           
                              Consider a fixed 
                              
                                 Γ
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    
                                       |
                                       J
                                       |
                                    
                                    ]
                                 
                              
                              , and a given 
                              
                                 X
                                 ∈
                                 P
                               
                              . Based on the value of 
                              
                                 Γ
                              
                              , a worst-case scenario for 
                              
                                 X
                               
                              can be found as follows:
                              
                                 
                                    •
                                    
                                       If 
                                       
                                          Γ
                                        
                                       is an integer, a scenario with 
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          1
                                        
                                       for 
                                       
                                          Γ
                                        
                                       pairs 
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                        
                                       with the largest values of 
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                X
                                             
                                          
                                       
                                       , and 
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          0
                                        
                                       for the remaining pairs is a worst-case scenario for 
                                       
                                          X
                                       
                                       .
                                    


                                       If 
                                       
                                          Γ
                                        
                                       is not integer valued, a scenario with 
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          1
                                        
                                       for 
                                       
                                          
                                             ⌊
                                             Γ
                                             ⌋
                                          
                                        
                                       pairs 
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                        
                                       with the largest values of 
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                X
                                             
                                          
                                       
                                       , 
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          
                                             (
                                             Γ
                                             −
                                             
                                                ⌊
                                                Γ
                                                ⌋
                                             
                                             )
                                          
                                        
                                       for the next largest value of 
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                X
                                             
                                          
                                       
                                       , and 
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          0
                                        
                                       for the remaining pairs is a worst-case scenario for 
                                       
                                          X
                                       
                                       .
                                    


                        
                           Proof
                           The distance matrix has non-negative elements which implies 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       X
                                    
                                 
                                 ≥
                                 0
                              , for all 
                                 i
                                 ,
                                 j
                                 ∈
                                 N
                              . Therefore, 
                                 
                                    〈
                                    f
                                    ,
                                    X
                                    〉
                                 
                               is a non-decreasing linear function of 
                                 f
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       Γ
                                    
                                 
                              , or equivalently 
                                 
                                    〈
                                    f
                                    
                                       (
                                       ξ
                                       )
                                    
                                    ,
                                    X
                                    〉
                                 
                               is a non-decreasing linear function of 
                                 ξ
                                 ∈
                                 
                                    
                                       U
                                    
                                    
                                       Γ
                                    
                                 
                              . That is, for any pair of matrices 
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       Γ
                                    
                                 
                               if 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 ≤
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                               for all 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 ∈
                                 N
                              , then 
                                 
                                    〈
                                    
                                       
                                          f
                                       
                                       
                                          ̃
                                       
                                    
                                    ,
                                    X
                                    〉
                                 
                                 ≤
                                 
                                    〈
                                    
                                       
                                          f
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    X
                                    〉
                                 
                              . Thus, there exists an extreme point 
                                 
                                    
                                       ξ
                                    
                                    
                                       X
                                    
                                 
                               of polytope 
                                 
                                    
                                       U
                                    
                                    
                                       Γ
                                    
                                 
                               such that 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       ∈
                                       J
                                    
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       X
                                    
                                 
                                 =
                                 Γ
                               and 
                                 
                                    
                                       ξ
                                    
                                    
                                       X
                                    
                                 
                               is a worst-case scenario for 
                                 X
                               maximizing 
                                 
                                    〈
                                    f
                                    
                                       (
                                       ξ
                                       )
                                    
                                    ,
                                    X
                                    〉
                                 
                               over 
                                 ξ
                                 ∈
                                 
                                    
                                       U
                                    
                                    
                                       Γ
                                    
                                 
                              . Note that in all extreme points of 
                                 
                                    
                                       U
                                    
                                    
                                       Γ
                                    
                                 
                               with 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       ∈
                                       J
                                    
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       X
                                    
                                 
                                 =
                                 Γ
                              , 
                                 
                                    ⌊
                                    Γ
                                    ⌋
                                 
                               of the 
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       X
                                    
                                 
                               are equal to 1, up to one 
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       X
                                    
                                 
                               is 
                                 
                                    (
                                    Γ
                                    −
                                    
                                       ⌊
                                       Γ
                                       ⌋
                                    
                                    )
                                 
                              , and the remaining are 0. □

It is worth mentioning that for a given assignment, finding the worst-case scenario requires sorting 
                           
                              
                                 δ
                              
                              
                                 i
                                 j
                              
                           
                           
                              
                                 d
                              
                              
                                 i
                                 j
                              
                              
                                 X
                              
                           
                         for 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                           ∈
                           J
                         which can be done in 
                           O
                           
                              (
                              
                                 |
                                 J
                                 |
                              
                              log
                              
                                 (
                                 
                                    |
                                    J
                                    |
                                 
                                 )
                              
                              )
                           
                        , i.e polynomial time in size of 
                           J
                         and consequently in 
                           n
                        . In contrast, obtaining the worst-case scenario in minmax regret QAP requires solving a general QAP which is NP-hard  [45].

In this section, we propose a mixed integer quadratic programming (MIQP) formulation of RQAP and a linear MIP equivalent.

An alternative formulation for RQAP (14) is 
                           
                              (19)
                              
                                 
                                    
                                       min
                                    
                                    
                                       X
                                       ∈
                                       P
                                    
                                 
                                 
                                    {
                                    
                                       〈
                                       
                                          
                                             f
                                          
                                          
                                             −
                                          
                                       
                                       ,
                                       X
                                       〉
                                    
                                    +
                                    
                                       
                                          max
                                       
                                       
                                          ξ
                                          ∈
                                          
                                             
                                                U
                                             
                                             
                                                Γ
                                             
                                          
                                       
                                    
                                    
                                       {
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             J
                                          
                                       
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             X
                                          
                                       
                                       }
                                    
                                    }
                                 
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       X
                                       ∈
                                       P
                                    
                                 
                                 
                                    {
                                    
                                       〈
                                       
                                          
                                             f
                                          
                                          
                                             −
                                          
                                       
                                       ,
                                       X
                                       〉
                                    
                                    +
                                    R
                                    C
                                    
                                       (
                                       X
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                         An equivalent MIQP for (19) is proposed in Proposition 2.


                        
                           Proposition 2
                           
                              Problem   (19)   is equivalent to problem   (20)
                              –
                              (21)
                              .
                              
                                 
                                    
                                       (20)
                                       
                                          
                                             
                                                min
                                             
                                             
                                                q
                                                ∈
                                                
                                                   
                                                      ℜ
                                                   
                                                   
                                                      +
                                                   
                                                
                                                ,
                                                r
                                                ∈
                                                
                                                   
                                                      ℜ
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         |
                                                         J
                                                         |
                                                      
                                                   
                                                
                                                ,
                                                X
                                                ∈
                                                P
                                             
                                          
                                          
                                          
                                             〈
                                             
                                                
                                                   f
                                                
                                                
                                                   −
                                                
                                             
                                             ,
                                             X
                                             〉
                                          
                                          +
                                          Γ
                                          q
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                J
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    
                                       (21)
                                       
                                          q
                                          +
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                X
                                             
                                          
                                          ,
                                          
                                          ∀
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                          .
                                       
                                    
                                 
                              
                           


                        
                           Proof
                           By using the same idea as  [46], one can substitute the inner maximization problem in (19) with its dual 
                                 
                                    
                                       (22)
                                       
                                          
                                             
                                                min
                                             
                                             
                                                q
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      +
                                                   
                                                
                                                ,
                                                r
                                                ∈
                                                
                                                   
                                                      ℜ
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         |
                                                         J
                                                         |
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          Γ
                                          q
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                J
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    
                                       (23)
                                       
                                          q
                                          +
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                X
                                             
                                          
                                          ,
                                          
                                          ∀
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                          ,
                                       
                                    
                                 
                               which results in problem (20)–(21). □

Note that by definitions (4) and (5), 
                           
                              
                                 d
                              
                              
                                 i
                                 j
                              
                              
                                 X
                              
                           
                         and 
                           
                              〈
                              
                                 
                                    f
                                 
                                 
                                    −
                                 
                              
                              ,
                              X
                              〉
                           
                         are quadratic functions of 
                           x
                        . Thus, (20)–(21) is a MIQP problem with a quadratic objective function, 
                           
                              |
                              J
                              |
                           
                         quadratic and 
                           2
                           n
                         linear constraints, 
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                         binary and 
                           
                              |
                              J
                              |
                           
                           +
                           1
                         continuous variables. To solve RQAP with an off the shelf MIP solver, we need to linearize the objective function and constraints in (20)–(21).

Next, we extend  [19] linearization to RQAP. 
                           Proposition 3
                           
                              Problem   (24)
                              –
                              (27)   is a MIP equivalent of problem   (20)
                              –
                              (21)
                              .
                              
                                 
                                    
                                       (24)
                                       
                                          
                                             
                                                min
                                             
                                             
                                                
                                                   
                                                      X
                                                      ∈
                                                      P
                                                      ,
                                                      w
                                                      ∈
                                                      
                                                         
                                                            ℜ
                                                         
                                                         
                                                            N
                                                            ×
                                                            N
                                                         
                                                      
                                                   
                                                   
                                                      q
                                                      ∈
                                                      
                                                         
                                                            ℜ
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      ,
                                                      r
                                                      ∈
                                                      
                                                         
                                                            ℜ
                                                         
                                                         
                                                            +
                                                         
                                                         
                                                            
                                                               |
                                                               J
                                                               |
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                   i
                                                
                                                
                                                   −
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   k
                                                   k
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                   k
                                                
                                             
                                             )
                                          
                                          +
                                          Γ
                                          q
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                J
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    
                                       (25)
                                       
                                          
                                             
                                                w
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          ≥
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      j
                                                      ≠
                                                      i
                                                   
                                                
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   
                                                      l
                                                      ≠
                                                      k
                                                   
                                                
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                f
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                −
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                k
                                                l
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                j
                                                l
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                   k
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          k
                                          ∈
                                          N
                                          ;
                                       
                                    
                                    
                                       (26)
                                       
                                          
                                             
                                                w
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          ≥
                                          
                                             
                                                l
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          ,
                                          
                                          
                                          ∀
                                          i
                                          ,
                                          k
                                          ∈
                                          N
                                          ,
                                       
                                    
                                    
                                       (27)
                                       
                                          q
                                          +
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   ∑
                                                
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   k
                                                   l
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             +
                                             
                                                
                                                   d
                                                
                                                
                                                   k
                                                
                                                
                                                   max
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                −
                                                1
                                                )
                                             
                                             )
                                          
                                          ,
                                          
                                          ∀
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                          ,
                                          
                                          ∀
                                          k
                                          ∈
                                          N
                                       
                                    
                                 
                              
                              where,
                              
                                 
                                    (28)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                             
                                             
                                                =
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      
                                                         
                                                            X
                                                            ∈
                                                            P
                                                         
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                                  k
                                                               
                                                            
                                                            =
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            j
                                                            ≠
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            l
                                                            =
                                                            1
                                                         
                                                         
                                                            l
                                                            ≠
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      −
                                                   
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      k
                                                      l
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                ,
                                                
                                                ∀
                                                i
                                                ,
                                                k
                                                ∈
                                                N
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                             
                                             
                                                =
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            X
                                                            ∈
                                                            P
                                                         
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                                  k
                                                               
                                                            
                                                            =
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            j
                                                            ≠
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            l
                                                            =
                                                            1
                                                         
                                                         
                                                            l
                                                            ≠
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      −
                                                   
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      k
                                                      l
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                ,
                                                
                                                ∀
                                                i
                                                ,
                                                k
                                                ∈
                                                N
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      max
                                                   
                                                
                                             
                                             
                                                =
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      l
                                                      ∈
                                                      N
                                                   
                                                
                                                
                                                
                                                   {
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         k
                                                         l
                                                      
                                                   
                                                   }
                                                
                                                ,
                                                
                                                ∀
                                                k
                                                ∈
                                                N
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           


                        
                           Proof
                           Note that equivalence of problems (20)–(21) and (24)–(27) can be easily checked by using the same insights in  [19]. First part of the objective function in (24) together with constraints (25) and (26) correspond to the minimization of 
                                 
                                    〈
                                    
                                       
                                          f
                                       
                                       
                                          −
                                       
                                    
                                    ,
                                    X
                                    〉
                                 
                               in (20). Moreover, in any 
                                 X
                                 ∈
                                 P
                              , for all 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 ∈
                                 J
                               and 
                                 k
                                 ∈
                                 N
                              
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             k
                                             l
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             j
                                             l
                                          
                                       
                                       +
                                       
                                          
                                             d
                                          
                                          
                                             k
                                          
                                          
                                             max
                                          
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          −
                                          1
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         l
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         k
                                                         l
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         X
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   
                                                     if  
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                         k
                                                      
                                                   
                                                   =
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         l
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         k
                                                         l
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   ≤
                                                   0
                                                   ,
                                                
                                                
                                                     otherwise.
                                                
                                             
                                          
                                       
                                    
                                 
                               Therefore, (27) is a valid linearization of (21). □

Formulation (24)–(27) has 
                           2
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           +
                           n
                           
                              (
                              2
                              +
                              
                                 |
                                 J
                                 |
                              
                              )
                           
                         linear constraints and 
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                         binary and 
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           +
                           
                              |
                              J
                              |
                           
                           +
                           1
                         continuous variables.

Due to difficulty of the regular QAP, only relatively small instances can be solved by exact methods  [6]. To solve larger problems, a number of heuristics have been developed in the literature  [36,6]. Since the robust QAP is at least as hard as regular QAP, heuristics are needed even more. In this section, we extend the 2-Opt local search  [52] and tabu search  [53,54] for classical QAP to solve RQAP.


                        [52] used a local search based on 2-Opt neighborhood to solve the general QAP (7). In this method, a neighbor of a current solution 
                           
                              
                                 X
                              
                              
                                 1
                              
                           
                         is obtained by swapping locations of any two facilities. Suppose that 
                           
                              
                                 X
                              
                              
                                 2
                              
                           
                         is obtained from 
                           
                              
                                 X
                              
                              
                                 1
                              
                           
                         by swapping locations of facilities 
                           a
                           ,
                           b
                           ∈
                           N
                        , 
                           a
                           ≠
                           b
                        . Then, 
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                    
                                       
                                          
                                             X
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                          
                                             ∀
                                             i
                                             ≠
                                             a
                                               and  
                                             i
                                             ≠
                                             b
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   b
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             =
                                             a
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   a
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             =
                                             b
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The difference between the objective values of 
                           
                              
                                 X
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 1
                              
                           
                         is 
                           
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       a
                                       b
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          a
                                          b
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          c
                                       
                                       
                                          a
                                          b
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          b
                                          a
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          c
                                       
                                       
                                          b
                                          a
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          a
                                          a
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          c
                                       
                                       
                                          a
                                          a
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          b
                                          b
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          c
                                       
                                       
                                          b
                                          b
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                       ,
                                       i
                                       ≠
                                       a
                                       ,
                                       b
                                    
                                    
                                       n
                                    
                                 
                                 
                                    [
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             a
                                             i
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   b
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             a
                                             i
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   a
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             a
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   b
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             a
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   a
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                       ,
                                       i
                                       ≠
                                       a
                                       ,
                                       b
                                    
                                    
                                       n
                                    
                                 
                                 
                                    [
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             b
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   a
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             b
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   b
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             b
                                             i
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   a
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             b
                                             i
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   b
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     

In RQAP (19), the objective function consists of two parts 
                           
                              〈
                              
                                 
                                    f
                                 
                                 
                                    −
                                 
                              
                              ,
                              X
                              〉
                           
                         and 
                           R
                           C
                           
                              (
                              X
                              )
                           
                        . Next, we extend the 2-Opt procedure to heuristically solve RQAP. For this purpose, we need to change the way of computing 
                           
                              
                                 Δ
                              
                              
                                 a
                                 b
                              
                           
                         values. For all 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                           ∈
                           J
                        , let 
                           
                              
                                 g
                              
                              
                                 i
                                 j
                              
                              
                                 X
                              
                           
                           ≔
                           
                              
                                 δ
                              
                              
                                 i
                                 j
                              
                           
                           
                              
                                 d
                              
                              
                                 i
                                 j
                              
                              
                                 X
                              
                           
                        . For each pair of facilities 
                           a
                         and 
                           b
                        , let 
                           
                              
                                 Δ
                              
                              
                                 a
                                 b
                              
                           
                         be as follows:
                           
                              (29)
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       a
                                       b
                                    
                                 
                                 =
                                 
                                    
                                       Δ
                                    
                                    
                                       a
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       Δ
                                    
                                    
                                       a
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where, 
                           
                              (30)
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       a
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    〈
                                    
                                       
                                          f
                                       
                                       
                                          −
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          2
                                       
                                    
                                    〉
                                 
                                 −
                                 
                                    〈
                                    
                                       
                                          f
                                       
                                       
                                          −
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          1
                                       
                                    
                                    〉
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       −
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       −
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          a
                                          b
                                       
                                       
                                          −
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          f
                                       
                                       
                                          a
                                          b
                                       
                                       
                                          −
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          b
                                          a
                                       
                                       
                                          −
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          f
                                       
                                       
                                          b
                                          a
                                       
                                       
                                          −
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          a
                                          a
                                       
                                       
                                          −
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          f
                                       
                                       
                                          a
                                          a
                                       
                                       
                                          −
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          b
                                          b
                                       
                                       
                                          −
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          f
                                       
                                       
                                          b
                                          b
                                       
                                       
                                          −
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                       ,
                                       i
                                       ≠
                                       a
                                       ,
                                       b
                                    
                                    
                                       n
                                    
                                 
                                 
                                    [
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             a
                                             i
                                          
                                          
                                             −
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   b
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             a
                                             i
                                          
                                          
                                             −
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   a
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                             a
                                          
                                          
                                             −
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   b
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             i
                                             a
                                          
                                          
                                             −
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   a
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                       ,
                                       i
                                       ≠
                                       a
                                       ,
                                       b
                                    
                                    
                                       n
                                    
                                 
                                 
                                    [
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                             b
                                          
                                          
                                             −
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   a
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             i
                                             b
                                          
                                          
                                             −
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   b
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             b
                                             i
                                          
                                          
                                             −
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   a
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             b
                                             i
                                          
                                          
                                             −
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   b
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 ,
                              
                           
                         and 
                           
                              (31)
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       a
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 R
                                 C
                                 
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 −
                                 R
                                 C
                                 
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       ξ
                                       ∈
                                       
                                          
                                             U
                                          
                                          
                                             Γ
                                          
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          
                                             
                                                X
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    }
                                 
                                 −
                                 
                                    
                                       max
                                    
                                    
                                       ξ
                                       ∈
                                       
                                          
                                             U
                                          
                                          
                                             Γ
                                          
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       ξ
                                       ∈
                                       
                                          
                                             U
                                          
                                          
                                             Γ
                                          
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          g
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          
                                             
                                                X
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    }
                                 
                                 −
                                 
                                    
                                       max
                                    
                                    
                                       ξ
                                       ∈
                                       
                                          
                                             U
                                          
                                          
                                             Γ
                                          
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          g
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

Note that for the cases with 
                           i
                           ≠
                           a
                           ,
                           b
                           ,
                           
                           j
                           ≠
                           a
                           ,
                           b
                        , we have 
                           
                              
                                 g
                              
                              
                                 i
                                 j
                              
                              
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           =
                           
                              
                                 g
                              
                              
                                 i
                                 j
                              
                              
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                              
                           
                        . Therefore, we only need to update 
                           
                              
                                 g
                              
                              
                                 i
                                 j
                              
                           
                        , for other pairs of 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                           ∈
                           J
                         as follows. 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       
                                          
                                             X
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   a
                                                   b
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         b
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         a
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             =
                                             a
                                             ,
                                             
                                             j
                                             =
                                             b
                                          
                                       
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   b
                                                   a
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         a
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         b
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             =
                                             b
                                             ,
                                             
                                             j
                                             =
                                             a
                                          
                                       
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   a
                                                   a
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         b
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         b
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             i
                                             =
                                             a
                                             ,
                                             
                                             j
                                             =
                                             a
                                          
                                       
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   b
                                                   b
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         a
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         a
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             =
                                             b
                                             ,
                                             
                                             j
                                             =
                                             b
                                          
                                       
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   a
                                                   j
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         b
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             =
                                             a
                                             ,
                                             
                                             j
                                             ≠
                                             a
                                             ,
                                             b
                                          
                                       
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   b
                                                   i
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         a
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             =
                                             b
                                             ,
                                             
                                             j
                                             ≠
                                             a
                                             ,
                                             b
                                          
                                       
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   a
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         b
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             ≠
                                             a
                                             ,
                                             b
                                             ,
                                             
                                             j
                                             =
                                             a
                                          
                                       
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   b
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         a
                                                      
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             ≠
                                             a
                                             ,
                                             b
                                             ,
                                             
                                             j
                                             =
                                             b
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        To compute 
                           
                              
                                 Δ
                              
                              
                                 a
                                 b
                              
                              
                                 2
                              
                           
                         in (31), we need to update 
                           
                              
                                 g
                              
                              
                                 i
                                 j
                              
                              
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         for all 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                           ∈
                           J
                        , and then sort them. Afterward, by Proposition 1, 
                           R
                           C
                           
                              (
                              
                                 
                                    X
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         can be easily computed.

Suppose the algorithm is started from a random assignment and (29)–(31) are exploited to compute 
                           
                              
                                 Δ
                              
                              
                                 a
                                 b
                              
                           
                         for all 
                           a
                           ,
                           b
                           ∈
                           N
                        , 
                           a
                           ≠
                           b
                        . Let 
                           
                              
                                 Δ
                              
                              
                                 
                                    min
                                 
                              
                           
                           =
                           
                              
                                 min
                              
                              
                                 a
                                 ,
                                 b
                              
                           
                           
                              {
                              
                                 
                                    Δ
                                 
                                 
                                    a
                                    b
                                 
                              
                              }
                           
                        . If 
                           
                              
                                 Δ
                              
                              
                                 
                                    min
                                 
                              
                           
                           <
                           0
                        , swap the locations of the corresponding facilities, otherwise terminate the algorithm. This procedure may be trapped in a local optimal solution. To remedy this issue, we can use multi random initial assignments or extend Taillard’s general QAP tabu search  [55] to solve RQAP.

Tabu search  [53,54] is a technique to overcome local optimality in local search algorithms. For details of the general QAP tabu search, the reader is referred to  [55]. A step of tabu search will be called a swap as it is based on an attempt to swap locations of two facilities. Next, we extend Taillard’s tabu search procedure to solve RQAP. In this method, we use (29)–(31) to compute 
                           
                              
                                 Δ
                              
                              
                                 a
                                 b
                              
                           
                         and the rest of the procedure is similar to  [55].

Note that the 2-Opt and tabu search algorithms do not provide any lower bound for RQAP. But, they provide upper bounds for RQAP while the robust (minmax regret) QAP tabu search in  [45] provides neither a lower bound nor an upper bound.

@&#EXPERIMENTAL RESULTS@&#

We tested our proposed methods on uncertain QAP instances presented in  [45]. These instances have been categorized into two main families. 
                           
                              •
                              
                                 Euclidean Random (ER) instances: In this family, locations are chosen randomly on the 1000×1000 Euclidean grid as locations. For each pair of facilities 
                                    i
                                    ,
                                    j
                                  where 
                                    i
                                    <
                                    j
                                 , 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          +
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          −
                                       
                                    
                                    =
                                    0
                                  with probability 0.5, and with probability 0.5, 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          +
                                       
                                    
                                    ∈
                                    
                                       [
                                       0
                                       ,
                                       1000
                                       ]
                                    
                                  and 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          −
                                       
                                    
                                    ∈
                                    
                                       [
                                       0
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             +
                                          
                                       
                                       ]
                                    
                                  has been randomly generated. Based on the number of facilities and locations, 
                                    n
                                 , these instances are categorized into groups ER-07, ER-08, ER-09, ER-10, ER-11, ER-12, ER-13, ER-15, ER-20, ER-25, and ER-30.


                                 QAPLIB instances: Instances of this family are generated from some classical QAP instances available in the QAPLIB library

(http://www.seas.upenn.edu/qaplib/inst.html).

The algorithms were coded in C++. IBM ILOG CPLEX, version 12.5.1, was used for solving the linearization of RQAP in the exact approaches. All experiments were conducted on a UNIX machine restricted to use of only one core with 2.27 GHz speed and 20 GB RAM.

In the 2-Opt algorithm, we started the method from a random assignment. The best possible swap was chosen to produce the largest reduction in the objective function. Swapping the locations of facilities was continued until there was no potential swap with cost reduction. The method restarted 
                           10
                           ×
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                         times to reduce the chance of being trapped in a local optimal solution. In tabu search, we started the method from a random assignment with a termination criterion of 
                           100
                           ×
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                         iterations.

In the Exact method, we used CPLEX (default parameters) to solve MIP model (24)–(27) with time limit 7,200 s and memory limit 20 GB. Relative optimality gap tolerance was set to 10−6. In addition, the CPLEX internal “MIPEmphasis” switch was set to “emphasize optimality over feasibility”. For each instance RQAP was solved for all 
                           Γ
                           ∈
                           
                              {
                              1
                              ,
                              2
                              ,
                              4
                              ,
                              8
                              ,
                              16
                              ,
                              32
                              ,
                              64
                              ,
                              128
                              ,
                              256
                              }
                           
                         such that 
                           Γ
                           ≤
                           
                              |
                              J
                              |
                           
                         for that instance.

The quality of the robust solutions are examined in this subsection. For this purpose, we compare the solutions of the RQAP model for an uncertain QAP with 
                           n
                           =
                           9
                        . The 
                           
                              
                                 f
                              
                              
                                 +
                              
                           
                        , 
                           
                              
                                 f
                              
                              
                                 −
                              
                           
                         and 
                           d
                         matrices are presented in Table 1
                        . This example has 
                           
                              |
                              J
                              |
                           
                           =
                           34
                         uncertain flows. The solutions of RQAP for all values of 
                           Γ
                           ∈
                           
                              [
                              0
                              ,
                              34
                              ]
                           
                         are presented in Table 2
                        . In this table, 
                           
                              
                                 X
                              
                              
                                 7
                              
                           
                         is the minmax regret solution. In addition, 
                           O
                           p
                           t
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    −
                                 
                              
                              )
                           
                           =
                           
                              
                                 X
                              
                              
                                 1
                              
                           
                        , 
                           O
                           p
                           t
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    =
                                 
                              
                              )
                           
                           =
                           
                              
                                 X
                              
                              
                                 4
                              
                           
                        , and 
                           O
                           p
                           t
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    +
                                 
                              
                              )
                           
                           =
                           
                              
                                 X
                              
                              
                                 6
                              
                           
                        .


                        Fig. 1
                         depicts robust cost, 
                           Z
                           
                              (
                              X
                              )
                           
                        , of solutions 
                           
                              
                                 X
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 X
                              
                              
                                 7
                              
                           
                         versus 
                           Γ
                           ∈
                           
                              [
                              0
                              ,
                              34
                              ]
                           
                        . In this figure, it is clear which assignment has the best (minimum) robust cost for each value of 
                           Γ
                        . Note that 
                           Z
                           
                              (
                              X
                              )
                           
                         of 
                           
                              
                                 X
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 5
                              
                           
                         are very similar to 
                           
                              
                                 X
                              
                              
                                 3
                              
                           
                        . Therefore, for clarity of the graphs in Fig. 2
                        , the graphs corresponding to 
                           
                              
                                 X
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 5
                              
                           
                         are omitted.

For 10,000 runs we generated uncertain flow 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                           
                        , 
                           ∀
                           
                              (
                              i
                              ,
                              j
                              )
                           
                           ∈
                           J
                        , and simulated total cost. For this purpose, we used truncated normal, symmetric triangular, and uniform distributions in 
                           
                              [
                              
                                 
                                    f
                                 
                                 
                                    −
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    +
                                 
                              
                              ]
                           
                         to generate random flows. The results of the simulations are presented in Table 3
                         and Fig. 2. Let 
                           C
                           
                              (
                              X
                              )
                           
                           =
                           
                              〈
                              f
                              ,
                              X
                              〉
                           
                         be the random cost of assignment 
                           X
                        , which depends on the realization of 
                           f
                        . In Table 3, 
                           E
                           
                              (
                              C
                              
                                 (
                                 X
                                 )
                              
                              )
                           
                         and 
                           σ
                           
                              (
                              C
                              
                                 (
                                 X
                                 )
                              
                              )
                           
                         are empirical estimations of the expectation and standard deviation of 
                           C
                           
                              (
                              X
                              )
                           
                        , respectively. Moreover, 
                           
                              
                                 C
                              
                              
                                 0.95
                              
                           
                           
                              (
                              X
                              )
                           
                         and 
                           
                              
                                 C
                              
                              
                                 0.99
                              
                           
                           
                              (
                              X
                              )
                           
                         are the 0.95 and 0.99 quantiles of 
                           C
                           
                              (
                              X
                              )
                           
                        , respectively. 
                           
                              
                                 C
                              
                              
                                 m
                                 a
                                 x
                              
                           
                           
                              (
                              X
                              )
                           
                         is the maximum observed 
                           C
                           
                              (
                              X
                              )
                           
                         in the simulation. For all three simulated distributions, 
                           
                              
                                 X
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 6
                              
                           
                         have the least 
                           E
                           
                              (
                              C
                              
                                 (
                                 X
                                 )
                              
                              )
                           
                         and 
                           σ
                           
                              (
                              C
                              
                                 (
                                 X
                                 )
                              
                              )
                           
                        , respectively. 
                           
                              
                                 X
                              
                              
                                 4
                              
                           
                         has also the least 
                           
                              
                                 C
                              
                              
                                 0.95
                              
                           
                           
                              (
                              X
                              )
                           
                         for normal and the least 
                           
                              
                                 C
                              
                              
                                 0.95
                              
                           
                           
                              (
                              X
                              )
                           
                         and 
                           
                              
                                 C
                              
                              
                                 0.99
                              
                           
                           
                              (
                              X
                              )
                           
                         for triangular distribution. 
                           
                              
                                 X
                              
                              
                                 3
                              
                           
                         has the minimum 
                           
                              
                                 C
                              
                              
                                 0.99
                              
                           
                           
                              (
                              X
                              )
                           
                         and 
                           
                              
                                 C
                              
                              
                                 max
                              
                           
                           
                              (
                              X
                              )
                           
                         for normal and triangular distributions, respectively. It has also the least 
                           
                              
                                 C
                              
                              
                                 0.95
                              
                           
                           
                              (
                              X
                              )
                           
                         and 
                           
                              
                                 C
                              
                              
                                 0.99
                              
                           
                           
                              (
                              X
                              )
                           
                         for uniform distribution. Minimum 
                           
                              
                                 C
                              
                              
                                 max
                              
                           
                           
                              (
                              X
                              )
                           
                         for normal and uniform distributions is found for 
                           
                              
                                 X
                              
                              
                                 5
                              
                           
                        . Although 
                           O
                           p
                           t
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    +
                                 
                              
                              )
                           
                           =
                           
                              
                                 X
                              
                              
                                 6
                              
                           
                        , 
                           
                              
                                 X
                              
                              
                                 6
                              
                           
                         did not provide the minimum 
                           
                              
                                 C
                              
                              
                                 max
                              
                           
                           
                              (
                              X
                              )
                           
                         for any of the simulated distributions.

According to the results in Table 3 and Fig. 2, assignments 
                           
                              
                                 X
                              
                              
                                 3
                              
                           
                        , 
                           
                              
                                 X
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 5
                              
                           
                         outperform the other assignments almost in all of the metrics and distributions. As illustrated in this example, RQAP with budgeted uncertainty provides a pool of robust assignments depending on the value of 
                           Γ
                        . Then, the decision makers can pick one of these assignments based on their risk preferences.

In this subsection, we present the extensive results of implementing the proposed robust methods on “easy”, “moderate” and “hard” instances. Recalling from Section  4, each of the proposed exact and heuristic methods for RQAP provides an upper bound for optimal robust cost of RQAP. Let 
                           u
                           
                              
                                 b
                              
                              
                                 EX
                              
                           
                        , 
                           u
                           
                              
                                 b
                              
                              
                                 2O
                              
                           
                         and 
                           u
                           
                              
                                 b
                              
                              
                                 TS
                              
                           
                         be the upper bounds obtained by Exact, 2-Opt and tabu search, respectively. Note that only the Exact method provides lower bounds, which we denote by 
                           l
                           
                              
                                 b
                              
                              
                                 EX
                              
                           
                        . We define 
                           g
                           a
                           
                              
                                 p
                              
                              
                                 EX
                              
                           
                         as
                           
                              
                                 g
                                 a
                                 
                                    
                                       p
                                    
                                    
                                       EX
                                    
                                 
                                 =
                                 
                                    
                                       u
                                       
                                          
                                             b
                                          
                                          
                                             EX
                                          
                                       
                                       −
                                       l
                                       
                                          
                                             b
                                          
                                          
                                             EX
                                          
                                       
                                    
                                    
                                       u
                                       
                                          
                                             b
                                          
                                          
                                             EX
                                          
                                       
                                    
                                 
                                 ×
                                 100
                                 .
                              
                           
                        
                     


                        Table 4
                         reports CPU time in seconds spent by CPLEX on Exact method to solve MIP model (24)–(27). This time is denoted by 
                           
                              
                                 t
                              
                              
                                 EX
                              
                           
                        . 
                           
                              |
                              J
                              |
                           
                         indicates the number of uncertain flows. In all of these instances, Exact method was able to find the optimal solution, i.e.  
                           g
                           a
                           
                              
                                 p
                              
                              
                                 EX
                              
                           
                           =
                           0
                         and 
                           u
                           
                              
                                 b
                              
                              
                                 EX
                              
                           
                           =
                           l
                           
                              
                                 b
                              
                              
                                 EX
                              
                           
                         for all easy instances.

According to Table 4, for almost all easy instances, increasing 
                           Γ
                         results in a significant increase in 
                           
                              
                                 t
                              
                              
                                 EX
                              
                           
                        . This observation is also true for moderate instances in Table 10. That means that increasing 
                           Γ
                         loosens linearization (24)–(27) for RQAP.

By comparing 
                           
                              
                                 t
                              
                              
                                 EX
                              
                           
                         in Table 4 with the time spent to obtain minmax regret solutions (Tables 2 and 3 in  [45]), it is observed that even for large values of 
                           Γ
                        , 
                           
                              
                                 t
                              
                              
                                 EX
                              
                           
                         is about 10%–30% of minmax regret solution time for most of the easy instances.


                        Table 5
                         presents the CPU time in seconds spent on 2-Opt (
                           
                              
                                 t
                              
                              
                                 2O
                              
                           
                        ) and tabu search (
                           
                              
                                 t
                              
                              
                                 TS
                              
                           
                        ) to heuristically solve RQAP for easy instances. Unlike 
                           
                              
                                 t
                              
                              
                                 EX
                              
                           
                        , increasing 
                           Γ
                         did not affect 
                           
                              
                                 t
                              
                              
                                 2O
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 TS
                              
                           
                         systematically. Therefore, for moderate and hard instances, we only report average CPU times for different values of 
                           Γ
                        .

To assess the quality of solutions obtained from heuristics, we used 
                           u
                           
                              
                                 b
                              
                              
                                 2O
                              
                           
                         and 
                           u
                           
                              
                                 b
                              
                              
                                 TS
                              
                           
                        , upper bounds from heuristics, and 
                           l
                           
                              
                                 b
                              
                              
                                 EX
                              
                           
                        , the best lower bound from the Exact method. We defined 
                           g
                           a
                           
                              
                                 p
                              
                              
                                 2O
                              
                           
                         and 
                           g
                           a
                           
                              
                                 p
                              
                              
                                 TS
                              
                           
                         as
                           
                              
                                 g
                                 a
                                 
                                    
                                       p
                                    
                                    
                                       2O
                                    
                                 
                                 =
                                 
                                    
                                       u
                                       
                                          
                                             b
                                          
                                          
                                             2O
                                          
                                       
                                       −
                                       l
                                       
                                          
                                             b
                                          
                                          
                                             EX
                                          
                                       
                                    
                                    
                                       u
                                       
                                          
                                             b
                                          
                                          
                                             2O
                                          
                                       
                                    
                                 
                                 ×
                                 100
                                 
                                   and  
                                 
                                 g
                                 a
                                 
                                    
                                       p
                                    
                                    
                                       TS
                                    
                                 
                                 =
                                 
                                    
                                       u
                                       
                                          
                                             b
                                          
                                          
                                             TS
                                          
                                       
                                       −
                                       l
                                       
                                          
                                             b
                                          
                                          
                                             EX
                                          
                                       
                                    
                                    
                                       u
                                       
                                          
                                             b
                                          
                                          
                                             TS
                                          
                                       
                                    
                                 
                                 ×
                                 100
                                 .
                              
                           
                         In group chr15c, for 
                           Γ
                           =
                           1
                           ,
                           2
                           ,
                           8
                         and 16 the 
                           g
                           a
                           
                              
                                 p
                              
                              
                                 TS
                              
                           
                         was 0.01%, 0.08%, 0.06% and 0.47%, respectively. This gap for chr15b and 
                           Γ
                           =
                           8
                         was 0.04%. For the rest of cases, tabu search found the optimal robust solutions. For chr15c and 
                           Γ
                           =
                           1
                           ,
                           2
                           ,
                           4
                           ,
                           8
                         and 16, 
                           g
                           a
                           
                              
                                 p
                              
                              
                                 2O
                              
                           
                         was 0.01%, 0.03%, 0.33%, 0.52% and 0.12%, respectively. This gap for chr15a and 
                           Γ
                           =
                           1
                           ,
                           2
                           ,
                           4
                         and 8 was 0.10%, 0.07%, 0.24% and 0.38%, respectively. Moreover, 
                           g
                           a
                           
                              
                                 p
                              
                              
                                 2O
                              
                           
                           =
                           0.18
                           %
                         for chr12c and 
                           Γ
                           =
                           8
                        . For the rest of cases, 2-Opt found the optimal robust solutions.


                        Tables 6–11
                        
                        
                        
                        
                        
                         represent the numerical results for moderate instances. For each group and 
                           Γ
                        , Table 6 shows the number of instances (out of 10) which were solved optimally by Exact method within 7,200 s. Some moderate instances were not solved optimally, and a positive optimality gap remained for these cases.Table 7 reports the average optimality gap (among 10 instances) for each group and 
                           Γ
                        . Tables 8 and 9 present the number (in thousands) of all nodes and the remaining nodes, respectively, in the branch-and-cut tree explored by CPLEX.

In all of the moderate instances, 
                           u
                           
                              
                                 b
                              
                              
                                 2O
                              
                           
                           =
                           u
                           
                              
                                 b
                              
                              
                                 TS
                              
                           
                           ≤
                           u
                           
                              
                                 b
                              
                              
                                 EX
                              
                           
                        . In other words, the exact method was not able to outperform the heuristics in any of the moderate instances. Moreover, in all of these instances, 2-Opt and tabu search got the same solutions, which outperform the solutions of Exact method.


                        Table 10 reports 
                           
                              
                                 t
                              
                              
                                 EX
                              
                           
                         for moderate instances. 
                           
                              
                                 t
                              
                              
                                 2O
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 TS
                              
                           
                         for these instances are reported in Table 11. Moreover, the effective time 
                           
                              
                                 t
                              
                              
                                 2O
                              
                              
                                 eff
                              
                           
                         (
                           
                              
                                 t
                              
                              
                                 TS
                              
                              
                                 eff
                              
                           
                        ) and the effective iteration 
                           
                              
                                 iter
                              
                              
                                 2O
                              
                              
                                 eff
                              
                           
                         (
                           
                              
                                 iter
                              
                              
                                 TS
                              
                              
                                 eff
                              
                           
                        ) for 2-Opt (tabu search), which are the time and iteration count of discovering the best solution in these algorithms, are reported in this table. We see that the robust cost was not improved by 2-Opt or tabu search after their effective time and iteration count. Based on the results in Table 11, 
                           
                              
                                 t
                              
                              
                                 2O
                              
                              
                                 eff
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 TS
                              
                              
                                 eff
                              
                           
                         are almost 5% of 
                           
                              
                                 t
                              
                              
                                 2O
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 TS
                              
                           
                        , respectively. Note that 
                           
                              
                                 t
                              
                              
                                 2O
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 TS
                              
                           
                         depend on iteration limits that we set for 2-Opt and tabu search, respectively. Similarly, we denoted the number of effective restarts in tabu search by 
                           
                              
                                 Restart
                              
                              
                                 2O
                              
                              
                                 eff
                              
                           
                        .

Hard instances were solved heuristically by 2-Opt and tabu search methods for all values of the protection level 
                           Γ
                           ∈
                           
                              {
                              1
                              ,
                              2
                              ,
                              4
                              ,
                              8
                              ,
                              16
                              ,
                              32
                              ,
                              64
                              ,
                              128
                              ,
                              256
                              }
                           
                         such that 
                           Γ
                           ≤
                           
                              
                                 Γ
                              
                              
                                 max
                              
                           
                        , and the results are reported in Table 12
                        . We omitted Exact method for these instances, because there was no hope to solve them exactly. For these cases, we reported 
                           g
                           a
                           
                              
                                 p
                              
                              
                                 2O
                              
                              
                                 #
                              
                           
                         and 
                           g
                           a
                           
                              
                                 p
                              
                              
                                 TS
                              
                              
                                 #
                              
                           
                         in Table 12 which are defined as 
                           
                              
                                 g
                                 a
                                 
                                    
                                       p
                                    
                                    
                                       2O
                                    
                                    
                                       #
                                    
                                 
                                 =
                                 
                                    
                                       u
                                       
                                          
                                             b
                                          
                                          
                                             2O
                                          
                                       
                                       −
                                       min
                                       
                                          {
                                          u
                                          
                                             
                                                b
                                             
                                             
                                                2O
                                             
                                          
                                          ,
                                          u
                                          
                                             
                                                b
                                             
                                             
                                                TS
                                             
                                          
                                          }
                                       
                                    
                                    
                                       u
                                       
                                          
                                             b
                                          
                                          
                                             2O
                                          
                                       
                                    
                                 
                                 ×
                                 100
                                 ,
                              
                           
                         and 
                           
                              
                                 g
                                 a
                                 
                                    
                                       p
                                    
                                    
                                       TS
                                    
                                    
                                       #
                                    
                                 
                                 =
                                 
                                    
                                       u
                                       
                                          
                                             b
                                          
                                          
                                             TS
                                          
                                       
                                       −
                                       min
                                       
                                          {
                                          u
                                          
                                             
                                                b
                                             
                                             
                                                2O
                                             
                                          
                                          ,
                                          u
                                          
                                             
                                                b
                                             
                                             
                                                TS
                                             
                                          
                                          }
                                       
                                    
                                    
                                       u
                                       
                                          
                                             b
                                          
                                          
                                             TS
                                          
                                       
                                    
                                 
                                 ×
                                 100
                                 .
                              
                           
                        
                     

Note that for the cases with the same value of 
                           n
                        , increasing 
                           
                              |
                              J
                              |
                           
                         results in a significant increase in 
                           
                              
                                 t
                              
                              
                                 2O
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 TS
                              
                           
                        . This is because, in each iteration of 2-Opt and tabu search, computing 
                           
                              
                                 Δ
                              
                              
                                 a
                                 b
                              
                              
                                 2
                              
                           
                         for each pair of facilities 
                           a
                           ,
                           b
                           ∈
                           N
                         in (31) requires sorting a vector of length 
                           
                              |
                              J
                              |
                           
                        .

Recalling from Section  5.2, we used an iteration limit of 
                           100
                           ×
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                         for tabu search and 
                           10
                           ×
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                         restarts for 2-Opt. With this setting, according to Tables 11 and 12, for most of the moderate and hard instances, 
                           
                              
                                 t
                              
                              
                                 2O
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 TS
                              
                           
                         are very close to each other. But, 
                           
                              
                                 t
                              
                              
                                 TS
                              
                              
                                 eff
                              
                           
                         and 
                           
                              
                                 iter
                              
                              
                                 TS
                              
                              
                                 eff
                              
                           
                         are almost half of 
                           
                              
                                 t
                              
                              
                                 2O
                              
                              
                                 eff
                              
                           
                         and 
                           
                              
                                 iter
                              
                              
                                 2O
                              
                              
                                 eff
                              
                           
                        , respectively, in most cases. Furthermore, based on the values of 
                           g
                           a
                           
                              
                                 p
                              
                              
                                 2O
                              
                              
                                 #
                              
                           
                         and 
                           g
                           a
                           
                              
                                 p
                              
                              
                                 TS
                              
                              
                                 #
                              
                           
                         in Table 12, for most hard instances, the quality of solutions obtained from tabu search is better than 2-Opt.

By comparing 
                           
                              
                                 t
                              
                              
                                 2O
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 TS
                              
                           
                         in Table 12, with the time spent to obtain approximate minmax regret solutions (Tables 6 and 7 in  [45]), it is observed that 
                           
                              
                                 t
                              
                              
                                 2O
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 TS
                              
                           
                         are about 10%–30% of minmax regret solution time for most hard instances.

We studied the robust quadratic assignment problem where uncertain interfacility flows belong to a budgeted uncertainty set. Unlike minmax regret QAP, in the robust optimization approach with budgeted uncertainty framework, finding the worst-case scenario and evaluating the robust cost of a given assignment can be done in polynomial time. Therefore, the proposed heuristic and exact methods for RQAP in this paper are significantly faster than heuristic and exact methods, respectively, for minmax regret QAP. Moreover, the robust approach with budgeted uncertainty has an adjustable conservativeness, and the decision maker can get a pool of solutions with different levels of conservativeness. The main contributions of the paper are as follows: 
                        
                           1.
                           A mathematical programming formulation of the RQAP under budgeted uncertainty.

A linearized MIP formulation for RQAP which was solved by CPLEX as an exact method.

Two heuristic methods (2-Opt and tabu search) to solve RQAP.

Extensive experimental results.

The main conclusions are as follows: 
                        
                           1.
                           The Exact method is well-suited for easy instances (e.g. instances with 
                                 n
                                 ≤
                                 11
                              ).

In the Exact method, CPU time significantly increases by increasing the protection level 
                                 Γ
                              .

In 2-Opt and tabu search, for the cases with the same 
                                 n
                              , CPU times significantly increase by increasing the number of uncertain flows 
                                 
                                    |
                                    J
                                    |
                                 
                              .

In all moderate instances, 2-Opt and tabu search methods outperformed the Exact method.

In most hard instances, in the same time and number of iterations, tabu search outperformed 2-Opt. Thus, tabu search is recommended for larger instances.

A possible direction for future research may be developing tighter formulations for the linear equivalent of RQAP. Moreover, researchers can design other heuristic methods to solve RQAP and compare the results with 2-Opt and tabu search.

@&#REFERENCES@&#

