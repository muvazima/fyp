@&#MAIN-TITLE@&#Design of an anonymity-preserving three-factor authenticated key exchange protocol for wireless sensor networks

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We observed that Farash et al.’s authentication protocol for WSN is susceptible to many security attacks.


                        
                        
                           
                           The protocol is also unable to preserve user anonymity.


                        
                        
                           
                           We designed an anonymity preserving authentication scheme for WSN.


                        
                        
                           
                           We analyze the security of the proposed protocol using AVISPA S/W.


                        
                        
                           
                           The proposed protocol is secure against active and passive attacks and more efficient than other protocols.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Anonymity preserving

Key exchange protocol

Wireless sensor network

Internet of Things

Sensor node

Gateway node

@&#ABSTRACT@&#


               
               
                  Recently, Farash et al. pointed out some security weaknesses of Turkanović et al.’s protocol, which they extended to enhance its security. However, we found some problems with Farash et al.’s protocol, such as a known session-specific temporary information attack, an off-line password-guessing attack using a stolen-smartcard, a new-smartcard-issue attack, and a user-impersonation attack. Additionally, their protocol cannot preserve user-anonymity, and the secret key of the gateway node is insecure. The main intention of this paper is to design an efficient and robust smartcard-based user authentication and session key agreement protocol for wireless sensor networks that use the Internet of Things. We analyze its security, proving that our protocol not only overcomes the weaknesses of Farash et al.’s protocol, but also preserves additional security attributes, such as the identity change and smartcard revocation phases. Moreover, the results of a simulation using AVISPA show that our protocol is secure against active and passive attacks. The security and performance of our work are also compared with a number of related protocols.
               
            

@&#INTRODUCTION@&#

A wireless sensor network (WSN) is composed of many low-cost and low-power sensor devices. These sensor nodes are deployed manually or randomly over any target region. The WSN has become an emergent and popular technology for potential applications in environmental monitoring, agriculture, health-care, disaster management, domestic setting, and surveillance systems [1]. Initially, WSNs were homogenous in nature; that is all sensor nodes were equivalent in terms of battery power, storage, computation power, and so on. However, with the rapid development of computer networks and the Internet, a heterogenous infrastructure of WSNs has also been observed. In this paper, we assume that the network model is heterogenous. In such an environment, all sensor nodes forward information to the nearby gateway node (GWN) and to the user, who resides outside the network and accesses the data for various purposes. As the communications network is insecure by nature, an attacker or adversary can intercept, insert, delete, and re-route these messages. Therefore, user authentication, message integrity, and privacy are important design factors for such kinds of unreliable networks [2,3]. For secure data communication over an unreliable channel, the entities require between them a shared session key agreement protocol in which mutual authentication as well as the user-anonymity property a equally important.

As stated in [4], the Internet of Things (IoT) includes all the devices within the global network, accessible and interconnected through the Internet. The IoT can be understood as a multi-layered infrastructure that allows information from remote products, sensors, machines, assets, and other entities to be used anywhere, by any authorized party. It uses multiple communications technologies and a variety of embedded-intelligence technologies, including sensors and actuators. It can be applied in many domains, including health-care, WSN, smart cities, retail, and smart transport. Therefore, the IoT has nowadays become an important field of research. The IoT can also be applied in industry, which is termed the Industrial Internet of Things (IIoT). The IIoT enables new business models through secure, remote access to connected machines and other devices. In this paper, the architecture of the presented WSN is based on the concept of the IoT in which all sensor nodes and the GWN are interconnected through the Internet. Note that WSN covers a wide range of application fields and thus plays a vital role in the IoT. In such an environment, a user can access any sensor node, that is part of a WSN through a GWN.

In two-factor authentication protocols based on a password and a smartcard, users favour low-entropy passwords selected from a small dictionary. As a result, an adversary performs an off-line procedure to guess the user’s password within polynomial time. Therefore, two-factor authentication systems cannot provide high security due to this off-line password-guessing attack. Three-factor authentication protocols based on a password, smartcard, and biometrics (e.g., fingerprint, iris, retina) have thus gained popularity. In a three-factor authentication protocol, the user enjoys higher security than a two-factor protocol because (i) biometric data cannot be forgotten, and (ii) biometric data cannot be guessed easily. In order to tackle the password-guessing attack, Huang et al. [5] proposed a framework to upgrade two-factor authentication systems to three-factor systems. In this paper, we have adopted the existing bio-hashing operation [6,7] in our protocol to generate a cancellable biometric template. The bio-hashing operation, as a non-invertible function, can generate a protected biometric template. Numerous authentication protocols [8,9] have utilized a protected biometric template to identify the genuine user.

In WSNs, sensor nodes that are deployed in a hostile environment are powered by small batteries, and recharge or replacement of these batteries may not always be possible. Although it is challenging to prolong network service, energy conservation specifically of the sensor nodes of WSNs is mandatory. Sensor nodes include a transceiver, external memory, micro-controller, power source, and one or more sensor(s), with the transceiver responsible for receiving and forwarding messages. As mentioned in [10], the energy consumed by transmitting or receiving, respectively, a message of l-bits over or from a distance (d) are measured by Eqs. (1) and (2). Here, the free-space model is used if d is less than a threshold d
                        0; otherwise, a multi-path model is used.

                           
                              (1)
                              
                                 
                                    
                                       E
                                       T
                                    
                                    
                                       (
                                       l
                                       ,
                                       d
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   l
                                                   
                                                      E
                                                      
                                                         e
                                                         l
                                                         e
                                                         c
                                                      
                                                   
                                                   +
                                                   l
                                                   
                                                      
                                                         ɛ
                                                      
                                                      
                                                         f
                                                         s
                                                      
                                                   
                                                   
                                                      d
                                                      2
                                                   
                                                
                                             
                                             
                                                for
                                             
                                             
                                                
                                                   d
                                                   <
                                                   
                                                      d
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   l
                                                   
                                                      E
                                                      
                                                         e
                                                         l
                                                         e
                                                         c
                                                      
                                                   
                                                   +
                                                   l
                                                   
                                                      
                                                         ɛ
                                                      
                                                      
                                                         m
                                                         p
                                                      
                                                   
                                                   
                                                      d
                                                      4
                                                   
                                                
                                             
                                             
                                                for
                                             
                                             
                                                
                                                   d
                                                   ≥
                                                   
                                                      d
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       E
                                       R
                                    
                                    
                                       (
                                       l
                                       )
                                    
                                    =
                                    l
                                    
                                       E
                                       
                                          e
                                          l
                                          e
                                          c
                                       
                                    
                                 
                              
                           
                        where Eelec
                         is the energy required by the electronic circuit, and ε
                           fs
                         and ε
                           mp
                         are the energy required by the amplifier in free space and the multi-path model, respectively.

                           Remark 1
                           The above discussion shows that the communication cost of the sensor node depends on the transmitted and received messages, and is also directly proportional to the distance between the sensor node and the target entity. Compared to the sensor device, the GWN has huge energy resources; thus, to reduce power consumption, the distance between the GWN and the sensor nodes should be as small as possible for IoT-based WSNs.

The network model proposed in [4,11] is presented in Fig. 1
                         and includes three entities: the GWN, the user (Ui
                        ), and the sensor node (Sj
                        ). Note that the main task of Sj
                         is to sense real-time data, which is accessed by Ui
                         after mutual authentication. In the model presented in Fig. 1, Ui
                         collects the sensed data from Sj
                         directly. For user authentication in IoT-based WSNs, the GWN provides a registration facility for Sj
                        . In Section 1.1, we analyzed that the power consumption of Sj
                         for receiving and transmitting data is directly proportional to the distance between Sj
                         and Ui
                        . Since Ui
                         accesses the data from outside of the network, the distance between Sj
                         and Ui
                         would be high. Therefore, the network model presented in Fig. 1 is not appropriate for IoT-based WSNs.

To upgrade the functionality and security of WSNs, many user authentication and key agreement protocols [12–15] have been proposed in the literature. Now, we will describe briefly the security loopholes of the authentication protocols proposed for IoT-based WSNs. In 2004, Watro et al. [12] proposed a user authentication protocol using RSA 
                        [16]. Later, it was demonstrated that this protocol cannot withstand the man-in-the middle attack. Thereafter, Xu et al. [13] and Song [14] proposed two different authentication protocols based on RSA. However, the protocols in [13,14] required high memory overhead because all the public keys of the sensor nodes and users were stored. To overcome this problem, Yeh et al. [15] offered an authentication protocol based on the elliptic curve cryptography. In 2006, Wong et al. [17] proposed another authentication protocol using a hash function. The following year, Tseng et al. [18] proposed a dynamic-identity-based authentication protocol. However, Vaidya et al. [19] claimed that the protocols in [17,18] suffer from the forgery attacks, replay attacks and man-in-the-middle attacks. They further contributed an improved protocol. Afterwards, Das [20] proposed an authentication protocol against the protocol designed in [17].

In 2010, Khan and Alghathbar [21] described how Das’s protocol [20] is susceptible to a gateway-node-bypassing attack and a privileged-insider attack. In the same year, He et al. [22] also proposed an improvement of Das’s protocol. Later, Vaidya et al. [23] again demonstrated that the protocols in [20,21] suffer from the privileged-insider and user-impersonation attacks, presenting an extended two-factor user authentication protocol as a remedy. Fan et al. [24] introduced a user authentication protocol for two-tiered WSNs 
                        [25]. Yuan et al. [26] claimed that the protocol in [12] is insecure against forgery attack, contributing a biometric-based, three-factor user authentication protocol for WSNs. In 2011, Kumar and Lee [27] proved that He at al.’s protocol [22] is vulnerable to an information-leakage attack and is unable to preserve the user-anonymity and mutual authentication properties. They further demonstrated that the protocol in [21] cannot achieve the mutual authentication property. Das et al. [28] and Xue et al. [29] proposed two user authentication protocols. Later, Xu and Wang [30] and, Turkanović and Hölbl [31] claimed that the protocol in [28] is imperfect, proposing two enhanced protocols. Li et al. [32], and Turkanović and Hölbl [31] also presented different vulnerabilities of Xue et al.’s protocol [29] and provided an improved protocol. Unfortunately, He et al. [33] improved the security of the protocol in [29]. Wang and Wang [34] addressed the security loopholes of the protocol in [28] and then put forward another improved protocol. Further, they provided a solution against the sensor node capture attack.

In 2014, Turkanović et al. [4] proposed a hash-function-based, lightweight user authentication protocol for heterogenous, ad-hoc WSNs using the concept of the IoT. The main aim of their protocol was to be energy-efficient and anonymous with high security and low computational cost. However, Ruhul and Biswas [35], and Farash et al. [11] claimed that this protocol is not suitable for practical applications because of its security weaknesses. Additionally, Ruhul and Biswas proposed a secure multi-gateway-based user authentication protocol using a smartcard.

Recently, Farash et al. [11] proposed an improved protocol. We have examined Farash et al.’s protocol [11] and found that it cannot withstand the user-anonymity problem, stolen-smartcard attack, off-line password-guessing attack, new-smartcard-issue attack, user-impersonation attack and known session-specific temporary information attack. We have also identified that the network architecture used in [4,11] is inefficient for those environments where energy is a big issue. Therefore, we have modified the architecture (see Fig. 6), designing a secure user authentication protocol using a password, a smartcard and biometrics. The AVISPA software simulation and informal security analysis strongly suggest that our protocol can withstand all the relevant security attacks and meet relevant requirements. In addition, the proposed protocol contributes post-deployment, identity change, password change, and smartcard revocation phases.

The rest of this paper is arranged as follows. We review Farash et al.’s protocol in Section 2, explaining its security weaknesses in Section 3. We propose an improved protocol in Section 4. The results of the AVISPA software simulation of our protocol are given in Section 5, and rigorous security analysis appears in Section 6. We evaluate the performance of our protocol against other protocols, as presented in Section 7. Finally, we conclude the paper in Section 8.

In this section, we briefly review Farash et al.’s protocol, which includes the following phases: pre-deployment, registration for the user and the sensor node, login, authentication, password change, and dynamic node addition. The list of notations used in this paper is given in Table 1
                     .

This setup phase is executed in off-line mode by the system administrator (SA). In this phase, the GWN generates and stores a shared password 
                           
                              X
                              
                                 G
                                 W
                                 N
                                 −
                                 
                                    S
                                    j
                                 
                              
                           
                         (1 ≤ j ≤ m) for each Sj
                        , where m represents the number of sensor nodes within the network.

                           Remark 2
                           The shared password 
                                 
                                    X
                                    
                                       G
                                       W
                                       N
                                       −
                                       
                                          S
                                          j
                                       
                                    
                                 
                               is used during sensor node registration. In Farash et al.’s protocol, 
                                 
                                    X
                                    
                                       G
                                       W
                                       N
                                       −
                                       
                                          S
                                          j
                                       
                                    
                                 
                               is deleted from the memory of the GWN, whereas Turkanović et al.’s protocol stores it permanently in the GWN.

After deploying the sensor nodes, two registration phases are required, as described below.

This phase is outlined in Fig. 2.

                              Remark 3
                              We have observed that GWN does not store the hash function h(·) on the smartcard. The function h(·) must be included; otherwise, computation of ⟨ei, fi, gi
                                 ⟩ is impossible.

This phase is outlined in Fig. 3
                           .

This phase is outlined in Fig. 4
                        .

This phase is outlined in Fig. 4.

This phase is outlined in Fig. 5
                        .

In this section, we present the security vulnerabilities of Farash et al.’s protocol. The following are the widely accepted, valid assumptions used in analyzing the security of authentication protocols.

                        Assumption 1
                        Adversary 
                              A
                            has the capability to retrieve smartcard information using the power-consumption monitoring methods explained in [36,37].

All messages generated by the protocol during the protocol execution are transmitted through unreliable communications channels such as the Internet. Therefore, 
                              A
                            can intercept, delete, modify, re-route, or re-send the transmitted message over unreliable networks. It is worth noting that 
                              A
                            cannot intercept any information from reliable networks.


                           
                              A
                            knows how to execute the proposed protocol, which means the protocol is public. In addition, 
                              A
                            can act as a legitimate user/client (or vice-versa).

In a password-based user authentication protocol, it is assumed that registered users always use dictionary words as passwords and identities. It is worth to noting that 
                              A
                            cannot guess the identity and password within polynomial time. Let 
                              
                                 
                                    A
                                    i
                                 
                                 =
                                 h
                                 
                                    (
                                    I
                                    
                                       D
                                       i
                                    
                                    ∥
                                    P
                                    
                                       W
                                       i
                                    
                                    )
                                 
                              
                            be known to 
                              A
                           : then it is infeasible to verify the guessed identity and password using Ai
                            in polynomial time.

In cryptography, it is assumed that the secret key and random nonce are sufficiently large (high entropy parameter) that 
                              A
                            cannot guess this information in polynomial time.

Let there be an equation 
                              
                                 
                                    A
                                    i
                                 
                                 =
                                 
                                    B
                                    i
                                 
                                 ⊕
                                 
                                    C
                                    i
                                 
                              
                           . Only the value of Ai
                            is known to 
                              A
                           . It is hard for 
                              A
                            to find Bi
                            or Ci
                            in polynomial time.

Let the length of the identity or password be n characters. The probability of guessing n characters is approximately 
                              
                                 1
                                 
                                    2
                                    
                                       6
                                       n
                                    
                                 
                              
                            
                           [38].

In Farash et al.’s protocol [11], an authorized user Ui
                         can impersonate GWN after extracting the secret key XGWN
                        . Assume that Ui
                         retrieves the information ⟨ei, fi, gi, ri
                        ⟩ from his or her smartcard (see Assumption 1), where 
                           
                              
                                 e
                                 i
                              
                              =
                              h
                              
                                 (
                                 M
                                 
                                    P
                                    i
                                 
                                 ∥
                                 I
                                 
                                    D
                                    i
                                 
                                 )
                              
                              ,
                              
                                 d
                                 i
                              
                              =
                           
                         
                        h(IDi
                        ∥XGWN
                        ), 
                           
                              
                                 g
                                 i
                              
                              =
                              h
                              
                                 (
                                 
                                    X
                                    
                                       G
                                       W
                                       N
                                    
                                 
                                 )
                              
                              ⊕
                              h
                              
                                 (
                                 M
                                 
                                    P
                                    i
                                 
                                 ∥
                                 
                                    d
                                    i
                                 
                                 )
                              
                              ,
                           
                         and 
                           
                              
                                 f
                                 i
                              
                              =
                              
                                 d
                                 i
                              
                              ⊕
                              h
                              
                                 (
                                 M
                                 
                                    P
                                    i
                                 
                                 ∥
                                 
                                    e
                                    i
                                 
                                 )
                              
                           
                        . Then, Ui
                         computes 
                           
                              M
                              
                                 P
                                 i
                              
                              =
                              h
                              
                                 (
                                 
                                    r
                                    i
                                 
                                 ∥
                                 P
                                 
                                    W
                                    i
                                 
                                 )
                              
                           
                         and 
                           
                              
                                 d
                                 i
                              
                              =
                              
                                 f
                                 i
                              
                              ⊕
                              h
                              
                                 (
                                 M
                                 
                                    P
                                    i
                                 
                                 ∥
                                 
                                    e
                                    i
                                 
                                 )
                              
                           
                        . Based on ⟨gi, MPi di
                        ⟩, Ui
                         computes 
                           
                              h
                              
                                 (
                                 
                                    X
                                    
                                       G
                                       W
                                       N
                                    
                                 
                                 )
                              
                              =
                              
                                 g
                                 i
                              
                              ⊕
                              h
                              
                                 (
                                 M
                                 
                                    P
                                    i
                                 
                                 ∥
                                 
                                    d
                                    i
                                 
                                 )
                              
                           
                        . Now, Ui
                         can impersonate GWN since the secret key XGWN
                         is now known to him or her.

User-anonymity states that adversary 
                           A
                         should not be able to detect by any means a user’s identity from the login and authentication messages. Farash et al. claim that IDi
                         of Ui
                         is protected from 
                           A
                        . However, we have observed that Farash et al.’s protocol does not protect user-anonymity, as presented below:

                           
                              (1)
                              In Section 3.1, we described how h(XGWN
                                 ) can be known to an authorized user Uj
                                 , who acts as an adversary 
                                    A
                                 .


                                 Uj
                                  intercepts Ui
                                 ’s login message 
                                    
                                       M
                                       S
                                       
                                          G
                                          1
                                       
                                       
                                          =
                                          〈
                                       
                                       
                                          M
                                          1
                                       
                                       ,
                                    
                                  
                                 M
                                 2, M
                                 3, T
                                 1⟩ during protocol execution, where 
                                    
                                       
                                          M
                                          1
                                       
                                       =
                                       I
                                       
                                          D
                                          i
                                          ′
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          h
                                          
                                             (
                                             
                                                X
                                                
                                                   G
                                                   W
                                                   N
                                                
                                             
                                             )
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          M
                                          2
                                       
                                       =
                                       
                                          K
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             d
                                             i
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                       ,
                                    
                                  and 
                                    
                                       
                                          M
                                          3
                                       
                                       =
                                       h
                                       
                                          (
                                          
                                             M
                                             1
                                          
                                          ∥
                                          
                                             M
                                             2
                                          
                                          ∥
                                          
                                             K
                                             i
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                    
                                 .


                                 Uj
                                  computes 
                                    
                                       I
                                       
                                          D
                                          i
                                          ′
                                       
                                       =
                                       
                                          M
                                          1
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          h
                                          
                                             (
                                             
                                                X
                                                
                                                   G
                                                   W
                                                   N
                                                
                                             
                                             )
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                       ,
                                    
                                  which is the original identity of Ui
                                 .

Thus, Uj
                         (
                           A
                        ) can compute Ui
                        ’s identity and easily break the user-anonymity property of Farash et al.’s protocol.

In this attack, 
                           A
                         needs a smartcard of a legal user Ui
                        , obtained either by stealing or by some other means. After that, 
                           A
                         extracts the information ⟨ei, fi, gi, ri
                        ⟩ from the smartcard (see Assumption 1), where 
                           
                              
                                 e
                                 i
                              
                              =
                              h
                              
                                 (
                                 M
                                 
                                    P
                                    i
                                 
                                 ∥
                                 I
                                 
                                    D
                                    i
                                 
                                 )
                              
                              ,
                           
                        
                        
                           
                              
                                 d
                                 i
                              
                              =
                              h
                              
                                 (
                                 I
                                 
                                    D
                                    i
                                 
                                 ∥
                                 
                                    X
                                    
                                       G
                                       W
                                       N
                                    
                                 
                                 )
                              
                              ,
                           
                        
                        
                           
                              
                                 g
                                 i
                              
                              =
                              h
                              
                                 (
                                 
                                    X
                                    
                                       G
                                       W
                                       N
                                    
                                 
                                 )
                              
                              ⊕
                              h
                              
                                 (
                                 M
                                 
                                    P
                                    i
                                 
                                 ∥
                                 
                                    d
                                    i
                                 
                                 )
                              
                              ,
                           
                         and 
                           
                              
                                 f
                                 i
                              
                              =
                              
                                 d
                                 i
                              
                              ⊕
                              h
                              
                                 (
                                 M
                                 
                                    P
                                    i
                                 
                                 ∥
                                 
                                    e
                                    i
                                 
                                 )
                              
                           
                        . Later, 
                           A
                         launches the following attacks against Farash et al.’s protocol.

In Section 3.2, we illustrated that an authorized but malicious user Uj
                            (
                              A
                           ) can extract identity IDi
                            of another legal user Ui
                           . Then, 
                              A
                            can launch an off-line password-guessing attack to learn the password PWi
                            of Ui
                           . We describe the off-line password-guessing attack procedure in Algorithm 1.


                           
                              
                                 
                              
                           
                        

This is a very serious attack on any smartcard-based authentication protocol in which 
                              A
                            attempts to prepare a new smartcard without altering the identity IDi
                            of Ui
                            or GWN’s information. We have noticed that Farash et al.’s protocol suffers from such a type of attack if the smartcard of Ui
                            has been stolen, as presented below:

                              
                                 (1)
                                 In Sections 3.1 and 3.3.1, we explained that 
                                       A
                                     can derive the IDi
                                     and PWi
                                     of Ui
                                    .

Based on IDi
                                     and PWi
                                    , 
                                       A
                                     computes 
                                       
                                          M
                                          
                                             P
                                             i
                                          
                                          =
                                          h
                                          
                                             (
                                             
                                                r
                                                i
                                             
                                             ∥
                                             P
                                             
                                                W
                                                i
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             e
                                             i
                                          
                                          =
                                          h
                                          
                                             (
                                             M
                                             
                                                P
                                                i
                                             
                                             ∥
                                             I
                                             
                                                D
                                                i
                                             
                                             )
                                          
                                          ,
                                       
                                     and 
                                       
                                          
                                             d
                                             i
                                             a
                                          
                                          =
                                          
                                             d
                                             i
                                          
                                          =
                                          
                                             f
                                             i
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             M
                                             
                                                P
                                                i
                                             
                                             ∥
                                             
                                                e
                                                i
                                             
                                             )
                                          
                                       
                                    .


                                    
                                       A
                                     guesses a password 
                                       
                                          P
                                          
                                             W
                                             i
                                             a
                                          
                                       
                                     and computes 
                                       
                                          M
                                          
                                             P
                                             i
                                             a
                                          
                                          =
                                          h
                                          
                                             (
                                             
                                                r
                                                i
                                             
                                             ∥
                                             P
                                             
                                                W
                                                i
                                                a
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             e
                                             i
                                             a
                                          
                                          =
                                          h
                                          
                                             (
                                             M
                                             
                                                P
                                                i
                                                a
                                             
                                             ∥
                                             I
                                             
                                                D
                                                i
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             g
                                             a
                                          
                                          =
                                          h
                                          
                                             (
                                             
                                                X
                                                
                                                   G
                                                   W
                                                   N
                                                
                                             
                                             )
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             M
                                             
                                                P
                                                i
                                                a
                                             
                                             ∥
                                             
                                                d
                                                i
                                                a
                                             
                                             )
                                          
                                          ,
                                       
                                     and 
                                       
                                          
                                             f
                                             i
                                             a
                                          
                                          =
                                          
                                             d
                                             i
                                             a
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             M
                                             
                                                P
                                                i
                                                a
                                             
                                             ∥
                                             
                                                e
                                                i
                                                a
                                             
                                             )
                                          
                                       
                                    .


                                    
                                       A
                                     selects a new smartcard and embeds 
                                       
                                          〈
                                          
                                             e
                                             i
                                             a
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             g
                                             i
                                             a
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             f
                                             i
                                             a
                                          
                                          ,
                                       
                                     
                                    ri
                                    ⟩ its memory.

After preparing the new smartcard, 
                              A
                            can easily login into the system on behalf of Ui
                            using IDi
                            and 
                              
                                 P
                                 
                                    W
                                    i
                                    a
                                 
                              
                           . Thus, 
                              A
                            does launch the new-smartcard-issue attack.

In this attack, 
                              A
                            attempts to generate GWN’s login message after intercepting the login message during protocol execution. The execution of the user-impersonation attack by 
                              A
                            is given below.

                              
                                 (1)
                                 During protocol execution, 
                                       A
                                     intercepts 
                                       
                                          M
                                          S
                                          
                                             G
                                             1
                                          
                                          
                                             =
                                             〈
                                          
                                          
                                             M
                                             1
                                          
                                          ,
                                       
                                     
                                    M
                                    2, M
                                    3, T
                                    1⟩, where 
                                       
                                          
                                             M
                                             1
                                          
                                          =
                                          I
                                          
                                             D
                                             i
                                             ′
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             h
                                             
                                                (
                                                
                                                   X
                                                   
                                                      G
                                                      W
                                                      N
                                                   
                                                
                                                )
                                             
                                             ∥
                                             
                                                T
                                                1
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             M
                                             2
                                          
                                          =
                                          
                                             K
                                             i
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             
                                                d
                                                i
                                             
                                             ∥
                                             
                                                T
                                                1
                                             
                                             )
                                          
                                          ,
                                       
                                     and 
                                       
                                          
                                             M
                                             3
                                          
                                          =
                                          h
                                          
                                             (
                                             
                                                M
                                                1
                                             
                                             ∥
                                             
                                                M
                                                2
                                             
                                             ∥
                                             
                                                K
                                                i
                                             
                                             ∥
                                             
                                                T
                                                1
                                             
                                             )
                                          
                                       
                                    . Note that Ki
                                     and T
                                    1 are the random number and timestamp, respectively.


                                    
                                       A
                                     generates a new random number 
                                       
                                          K
                                          i
                                          a
                                       
                                     and the system’s fresh timestamp 
                                       
                                          
                                             T
                                             1
                                             a
                                          
                                          ,
                                       
                                     computing 
                                       
                                          
                                             M
                                             1
                                          
                                          =
                                          I
                                          
                                             D
                                             i
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             h
                                             
                                                (
                                                
                                                   X
                                                   
                                                      G
                                                      W
                                                      N
                                                   
                                                
                                                )
                                             
                                             ∥
                                             
                                                T
                                                1
                                                a
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             M
                                             2
                                          
                                          =
                                          
                                             K
                                             i
                                             a
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             
                                                d
                                                i
                                             
                                             ∥
                                             
                                                T
                                                1
                                             
                                             )
                                          
                                          ,
                                       
                                     and 
                                       
                                          
                                             M
                                             3
                                          
                                          =
                                          h
                                          
                                             (
                                             
                                                M
                                                1
                                             
                                             ∥
                                             
                                                M
                                                2
                                             
                                             ∥
                                             
                                                K
                                                i
                                                a
                                             
                                             ∥
                                             
                                                T
                                                1
                                                a
                                             
                                             )
                                          
                                       
                                    .


                                    
                                       A
                                     transmits ⟨M
                                    1, M
                                    2, M
                                    3, 
                                       
                                          
                                             T
                                             1
                                             a
                                          
                                          
                                             〉
                                          
                                       
                                     to Sj
                                     through an unreliable channel.

The message ⟨M
                                    1, M
                                    2, M
                                    3, 
                                       
                                          
                                             T
                                             1
                                             a
                                          
                                          
                                             〉
                                          
                                       
                                     can be verified as valid. Thus, 
                                       A
                                     can launch a user-impersonation attack.

Resilience against the known-session specific temporary information attack requires that the attacker cannot compute a session key even if short-term confidential information, such as the session’s random numbers, be known. Farash et al.’s protocol computes a session key 
                           
                              S
                              K
                              =
                              h
                              (
                              
                                 K
                                 i
                              
                              ⊕
                              
                                 K
                                 j
                              
                              )
                           
                         between Ui
                         and Sj
                        , where Ki
                         and Kj
                         are the random nonces generated by Ui
                         and Sj
                        , respectively. Since the session key is reliant only on Ki
                         and Kj
                        , the computation of SK by 
                           A
                         is not hard with the disclosure of these random numbers. Therefore, the protocol in [11] cannot withstand this attack.

As discussed in Section 1.2, the network model [4,11] given in Fig. 1 is inappropriate for the IoT. Thus, we present a modified model in Fig. 6
                     
                     , which solves the issues as discussed in Section 1.2. Based on our network model, we present an efficient remote-user authentication and session key agreement protocol for WSNs using the concept of IoT.

In our protocol, we use a bio-hashing function. As discussed in [39], that bio-hashing function can generate a cancellable fingerprint (i.e., protected) template. However, if a noisy biometric 
                        
                           f
                           n
                           
                              g
                              
                                 i
                              
                              *
                           
                        
                      and accurate biometric fngi
                      of the same user Ui
                      are of the same class, 
                        
                           f
                           n
                           
                              g
                              
                                 i
                              
                              *
                           
                        
                      is roughly equivalent to fngi
                     . Note that the biometric features of different samples of the same class are not exactly identical, so an exactly accurate biometric key needs to be extracted before using the hash function.

For this purpose, a biometric key generation and extraction function BK() is required that can produce the same biometric key from different biometric templates of the same class. A description and concrete explanation of the function BK() can be found in [40]. Our protocol comprises system setup, sensor node registration, user registration, login, authentication and session key agreement, password change, and smartcard revocation phases all of which are presented below.

This phase is executed by the system administrator (SA) in off-line mode. This phase is described below.

                           
                              
                                 Step 1.
                              
                              
                                 SA chooses the identity IDj
                                  of Sj
                                  (1 ≤ j ≤ m).


                                 SA selects a master secret key XGWN
                                 , which is only known to GWN, and then computes 
                                    
                                       
                                          X
                                          j
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             j
                                          
                                          ∥
                                          
                                             X
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                  which is the secret key of Sj
                                  (1 ≤ j ≤ m), different for each sensor node.


                                 SA selects a random number Rshrd
                                 , which is shared between GWN and Sj
                                 . Finally, SA embeds ⟨IDj, Xj, Rshrd
                                 ⟩ into the tamper-proof memory of Sj
                                  in a secure manner. We assume that an adversary 
                                    A
                                  cannot extract ⟨IDj, Xj, Rshrd
                                 ⟩ from the memory of Sj
                                  even if it is compromised.
                              

After system setup, SA deploys all Sj
                         and a single GWN on the target field to form a sensor network. This phase is described in Fig. 7. For the purpose of registration, each Sj
                         executes the following with GWN:

                           
                              
                                 Step 1.
                              
                              
                                 Sj
                                  computes 
                                    
                                       
                                          S
                                          1
                                       
                                       =
                                       I
                                       
                                          D
                                          j
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             R
                                             
                                                s
                                                h
                                                r
                                                d
                                             
                                          
                                          ∥
                                          T
                                          
                                             s
                                             1
                                          
                                          )
                                       
                                    
                                  and 
                                    
                                       
                                          S
                                          2
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             j
                                          
                                          ∥
                                          
                                             X
                                             j
                                          
                                          ∥
                                          
                                             R
                                             
                                                s
                                                h
                                                r
                                                d
                                             
                                          
                                          ∥
                                          T
                                          
                                             s
                                             1
                                          
                                          )
                                       
                                       ,
                                    
                                  and then sends ⟨S
                                 1, S
                                 2, Ts
                                 1⟩ to GWN through an unreliable network, where Ts
                                 1 is the fresh timestamp.


                                 GWN verifies whether 
                                    
                                       
                                          |
                                       
                                       
                                          T
                                          
                                             g
                                             w
                                             n
                                          
                                       
                                       −
                                       T
                                       
                                          s
                                          1
                                       
                                       
                                          |
                                          ≤
                                          Δ
                                          T
                                       
                                    
                                  holds. If it is incorrect, GWN rejects Sj
                                 , otherwise computing 
                                    
                                       I
                                       
                                          D
                                          j
                                          ′
                                       
                                       =
                                       
                                          S
                                          1
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             R
                                             
                                                s
                                                h
                                                r
                                                d
                                             
                                          
                                          ∥
                                          T
                                          
                                             s
                                             1
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          X
                                          j
                                          ′
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             j
                                             ′
                                          
                                          ∥
                                          
                                             X
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                  and 
                                    
                                       
                                          S
                                          2
                                          ′
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             j
                                             ′
                                          
                                          ∥
                                          
                                             X
                                             j
                                             ′
                                          
                                          ∥
                                          
                                             R
                                             
                                                s
                                                h
                                                r
                                                d
                                             
                                          
                                          ∥
                                          T
                                          
                                             s
                                             1
                                          
                                          )
                                       
                                    
                                  and checking whether 
                                    
                                       
                                          S
                                          2
                                          ′
                                       
                                       =
                                       
                                          S
                                          2
                                       
                                    
                                  holds. If it is incorrect, GWN rejects Sj
                                 ; otherwise, GWN authenticates Sj
                                  and stores IDj
                                  into the database.


                                 GWN sends a confirmation message to Sj
                                  after successful completion of the registration phase. After getting the confirmation message, Sj
                                  deletes Rshrd
                                  from memory.

This phase is described in Fig. 8 and below:

                           
                              
                                 Step 1.
                              
                              
                                 Ui
                                  chooses an identity IDi
                                  and sends it along with personal credentials to SA through a reliable channel [4,35]. Note that personal credentials help in re-issuing new smartcard for any Ui
                                  whose smartcard is either stolen or damaged by some means.


                                 SA checks for the existence of IDi
                                  in the database. If it exists, SA requests a fresh identity; otherwise, SA computes 
                                    
                                       
                                          d
                                          i
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          
                                             X
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          )
                                       
                                    
                                  and 
                                    
                                       
                                          L
                                          i
                                       
                                       =
                                       h
                                       
                                          (
                                          S
                                          C
                                          
                                             N
                                             i
                                          
                                          ∥
                                          
                                             X
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                  then embedding ⟨di, Li, SCNi, BK()⟩ in the smartcard and delivering it to Ui
                                  through a reliable channel. Here, BK() denotes the biometric key generation and extraction function. Note that SA maintains a table storing IDi
                                  and the personal credentials of each Ui
                                 .


                                 Ui
                                  inserts the smartcard into a card reader. Ui
                                  inputs ⟨IDi, PWi
                                 ⟩ to the smartcard and fingerprint fngi
                                  at the sensor device. The smartcard computes 
                                    
                                       
                                          B
                                          i
                                       
                                       =
                                       B
                                       K
                                       
                                          (
                                          H
                                          
                                             (
                                             f
                                             n
                                             
                                                g
                                                i
                                             
                                             )
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          e
                                          i
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          P
                                          
                                             W
                                             i
                                          
                                          ∥
                                          
                                             B
                                             i
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          f
                                          i
                                       
                                       =
                                       
                                          d
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          P
                                          
                                             W
                                             i
                                          
                                          )
                                       
                                       ,
                                    
                                  and 
                                    
                                       
                                          g
                                          i
                                       
                                       =
                                       
                                          L
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          P
                                          
                                             W
                                             i
                                          
                                          ⊕
                                          I
                                          
                                             D
                                             i
                                          
                                          )
                                       
                                       ,
                                    
                                  where H(·) is the bio-hashing operation [6,7]. Finally, the smartcard stores ⟨Bi, ei, fi, gi, SCNi, BK()⟩ into its memory and deletes ⟨di, Li
                                 ⟩.

In Turkanović et al.’s and Farash et al.’s protocols, we have observed that GWN issued a smartcard for Ui
                              . However, smartcards are physical devices, so how’s GWN might preparing and delivering a smartcard to Ui
                               without involving a human seems impractical. To solve this issue in our protocol, we perform the user registration phase with SA, not GWN. SA prepares a smartcard and delivers it to Ui
                              .

Whenever any registered user Ui
                         wishes to access sensor information, he or she has to execute this phase to compute the login message, sending it to GWN through an unreliable channel. The description of this phase is given in Fig. 9
                         and below.

                           
                              
                                 Step 1.
                              
                              
                                 Ui
                                  inserts the smartcard and enters the fingerprint fngi
                                  at the sensor device. Then, the smartcard computes 
                                    
                                       
                                          B
                                          i
                                          *
                                       
                                       =
                                       B
                                       K
                                       
                                          (
                                          H
                                          
                                             (
                                             f
                                             n
                                             
                                                g
                                                i
                                             
                                             )
                                          
                                          )
                                       
                                    
                                  and checks whether 
                                    
                                       B
                                       
                                          i
                                       
                                       *
                                    
                                  is equal to Bi
                                 . If the verification is incorrect, smartcard denies Ui
                                 ’s login request; otherwise, it requests his or her identity and password. Then Ui
                                  inputs IDi
                                  and PWi
                                  to the smartcard, and it computes 
                                    
                                       
                                          e
                                          i
                                          *
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          P
                                          
                                             W
                                             i
                                          
                                          ∥
                                          
                                             B
                                             i
                                          
                                          )
                                       
                                    
                                 . The smartcard rejects Ui
                                 ’s login request if 
                                    
                                       e
                                       i
                                       *
                                    
                                  does not match ei
                                 ; otherwise, 
                                    
                                       I
                                       
                                          D
                                          i
                                          *
                                       
                                       =
                                       I
                                       
                                          D
                                          i
                                       
                                    
                                  and 
                                    
                                       P
                                       
                                          W
                                          i
                                          *
                                       
                                       =
                                       P
                                       
                                          W
                                          i
                                       
                                    
                                  hold.

After verifying the legitimacy of Ui
                                 , the smartcard computes 
                                    
                                       
                                          d
                                          i
                                          *
                                       
                                       =
                                       
                                          f
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                             *
                                          
                                          ∥
                                          P
                                          
                                             W
                                             i
                                             *
                                          
                                          )
                                       
                                       ,
                                    
                                  and 
                                    
                                       
                                          L
                                          i
                                          *
                                       
                                       =
                                       
                                          g
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          P
                                          
                                             W
                                             i
                                             *
                                          
                                          ⊕
                                          I
                                          
                                             D
                                             i
                                             *
                                          
                                          )
                                       
                                    
                                 . The smartcard also generates a random number Ki
                                  and a timestamp T
                                 1 and computes 
                                    
                                       
                                          M
                                          1
                                       
                                       =
                                       I
                                       
                                          D
                                          i
                                          *
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             L
                                             i
                                             *
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          M
                                          2
                                       
                                       =
                                       
                                          K
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             d
                                             i
                                             *
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          M
                                          3
                                       
                                       =
                                       h
                                       
                                          (
                                          
                                             d
                                             i
                                             *
                                          
                                          ∥
                                          
                                             K
                                             i
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                    
                                  and 
                                    
                                       S
                                       C
                                       
                                          T
                                          i
                                       
                                       =
                                       S
                                       C
                                       
                                          N
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                    
                                 . The smartcard then asks Ui
                                  for the identity of a sensor node. Ui
                                  chooses a sensor node Sj
                                  and inserts its identity IDj
                                  to the smartcard.

The smartcard computes 
                                    
                                       E
                                       I
                                       
                                          D
                                          j
                                       
                                       =
                                       I
                                       
                                          D
                                          j
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          
                                             K
                                             i
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                    
                                  and sends 
                                    
                                       M
                                       S
                                       
                                          G
                                          1
                                       
                                       
                                          =
                                          〈
                                       
                                       
                                          M
                                          1
                                       
                                       ,
                                    
                                  
                                 M
                                 2, M
                                 3, T
                                 1, SCTi, EIDj
                                 ⟩ to GWN through an unreliable channel.

In this phase, mutual authentication and a session key negotiation is executed between Ui, GWN, and Sj
                        . The description of this phase is given in Fig. 9 and below.

                           
                              
                                 Step 1.
                              
                              After receiving the login message MSG
                                 1 from Ui, GWN computes 
                                    
                                       S
                                       C
                                       
                                          N
                                          i
                                       
                                       =
                                       S
                                       C
                                       
                                          T
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          L
                                          i
                                          ′
                                       
                                       =
                                       h
                                       
                                          (
                                          S
                                          C
                                          
                                             N
                                             i
                                          
                                          ∥
                                          
                                             X
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       I
                                       
                                          D
                                          i
                                          ′
                                       
                                       =
                                       
                                          M
                                          1
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             L
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          d
                                          i
                                          ′
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             X
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          K
                                          i
                                          ′
                                       
                                       =
                                       
                                          M
                                          2
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             d
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                       ,
                                    
                                  and 
                                    
                                       
                                          M
                                          3
                                          ′
                                       
                                       =
                                       h
                                       
                                          (
                                          
                                             d
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             K
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                    
                                 . GWN rejects the current session if 
                                    
                                       M
                                       3
                                       ′
                                    
                                  is not equal to M
                                 3; otherwise, it computes 
                                    
                                       
                                          M
                                          4
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          
                                             d
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                    
                                  and then forwards 
                                    
                                       M
                                       S
                                       
                                          G
                                          2
                                       
                                       =
                                       
                                          〈
                                          
                                             M
                                             4
                                          
                                          〉
                                       
                                    
                                  to Ui
                                  through an unreliable channel.


                                 Ui
                                  computes 
                                    
                                       
                                          M
                                          4
                                          *
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          
                                             d
                                             
                                                i
                                             
                                             *
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                    
                                 . Ui
                                  aborts the session if 
                                    
                                       
                                          M
                                          
                                             4
                                          
                                          *
                                       
                                       ≠
                                       
                                          M
                                          4
                                       
                                       ,
                                    
                                  otherwise computing 
                                    
                                       
                                          M
                                          5
                                       
                                       =
                                       h
                                       
                                          (
                                          
                                             d
                                             
                                                i
                                             
                                             *
                                          
                                          ∥
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          
                                             K
                                             i
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                    
                                  and sending 
                                    
                                       M
                                       S
                                       
                                          G
                                          3
                                       
                                       =
                                       
                                          〈
                                          
                                             M
                                             5
                                          
                                          〉
                                       
                                    
                                  to GWN through an unreliable channel.


                                 GWN computes 
                                    
                                       
                                          M
                                          5
                                          ′
                                       
                                       =
                                       h
                                       
                                          (
                                          
                                             d
                                             i
                                             ′
                                          
                                          ∥
                                          I
                                          
                                             D
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             K
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                    
                                  and aborts the connection if 
                                    
                                       
                                          M
                                          5
                                          ′
                                       
                                       ≠
                                       
                                          M
                                          5
                                       
                                    
                                 ; otherwise it believes that an attacker is not attempting to launch a replay attack.

In Steps 2 and 3, the protocol does not utilize timestamp verification to resist a replay attack. In order to resist a replay attack between Ui
                               and GWN, we execute Steps 2 and 3 in our authentication phase.

In order to prove Ui
                                 ’s and GWN’s legitimacy to Sj, GWN computes 
                                    
                                       I
                                       
                                          D
                                          j
                                          ′
                                       
                                       =
                                       E
                                       I
                                       
                                          D
                                          j
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          
                                             K
                                             i
                                          
                                          ∥
                                          
                                             T
                                             1
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          X
                                          j
                                          ′
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             j
                                             ′
                                          
                                          ∥
                                          
                                             X
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          M
                                          6
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                             ′
                                          
                                          ∥
                                          I
                                          
                                             D
                                             j
                                             ′
                                          
                                          ∥
                                          I
                                          
                                             D
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          ∥
                                          
                                             X
                                             j
                                             ′
                                          
                                          ∥
                                          
                                             K
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             T
                                             2
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          M
                                          7
                                       
                                       =
                                       I
                                       
                                          D
                                          i
                                          ′
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          ∥
                                          
                                             X
                                             j
                                             ′
                                          
                                          ∥
                                          
                                             T
                                             2
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          M
                                          8
                                       
                                       =
                                       
                                          K
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             X
                                             j
                                             ′
                                          
                                          )
                                       
                                    
                                  and then forwards 
                                    
                                       M
                                       S
                                       
                                          G
                                          4
                                       
                                       
                                          =
                                          〈
                                          I
                                       
                                       
                                          D
                                          
                                             G
                                             W
                                             N
                                          
                                       
                                       ,
                                    
                                  
                                 M
                                 6, M
                                 7, M
                                 8, T
                                 2⟩ to Sj
                                  through an unreliable channel.


                                 Sj
                                  checks whether 
                                    
                                       
                                          |
                                       
                                       
                                          T
                                          3
                                       
                                       −
                                       
                                          T
                                          2
                                       
                                       
                                          |
                                          ≤
                                          Δ
                                          T
                                       
                                    
                                  holds, where T
                                 3 is the current timestamp. If it is incorrect, Sj
                                  immediately rejects the connection; otherwise, it computes 
                                    
                                       I
                                       
                                          D
                                          i
                                          
                                             *
                                             *
                                          
                                       
                                       =
                                       
                                          M
                                          7
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          ∥
                                          
                                             X
                                             j
                                          
                                          ∥
                                          
                                             T
                                             2
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          K
                                          i
                                          
                                             *
                                             *
                                          
                                       
                                       =
                                       
                                          M
                                          8
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                             
                                                *
                                                *
                                             
                                          
                                          ∥
                                          
                                             X
                                             j
                                          
                                          )
                                       
                                       ,
                                    
                                  and 
                                    
                                       
                                          M
                                          6
                                          
                                             *
                                             *
                                          
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                             
                                                *
                                                *
                                             
                                          
                                          ∥
                                          I
                                          
                                             D
                                             j
                                          
                                          ∥
                                          I
                                          
                                             D
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          ∥
                                          
                                             X
                                             j
                                          
                                          ∥
                                          
                                             K
                                             i
                                             
                                                *
                                                *
                                             
                                          
                                          ∥
                                          
                                             T
                                             2
                                          
                                          )
                                       
                                    
                                 . Sj
                                  aborts the connection if 
                                    
                                       
                                          M
                                          6
                                          
                                             *
                                             *
                                          
                                       
                                       ≠
                                       
                                          M
                                          6
                                       
                                    
                                 ; otherwise, it believes that Ui
                                  and GWN are authentic entities. Furthermore, Sj
                                  computes 
                                    
                                       S
                                       
                                          K
                                          j
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                             
                                                *
                                                *
                                             
                                          
                                          ∥
                                          I
                                          
                                             D
                                             j
                                          
                                          ∥
                                          
                                             K
                                             i
                                             
                                                *
                                                *
                                             
                                          
                                          ∥
                                          
                                             K
                                             j
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          M
                                          9
                                       
                                       =
                                       h
                                       
                                          (
                                          S
                                          
                                             K
                                             j
                                          
                                          ∥
                                          
                                             X
                                             j
                                          
                                          ∥
                                          
                                             K
                                             j
                                          
                                          ∥
                                          
                                             T
                                             3
                                          
                                          )
                                       
                                       ,
                                    
                                  and 
                                    
                                       
                                          M
                                          10
                                       
                                       =
                                       
                                          K
                                          i
                                          
                                             *
                                             *
                                          
                                       
                                       ⊕
                                       
                                          K
                                          j
                                       
                                       ,
                                    
                                  where Kj
                                  is the random number generated by Sj
                                 . Finally, Sj
                                  forwards 
                                    
                                       M
                                       S
                                       
                                          G
                                          5
                                       
                                       
                                          =
                                          〈
                                       
                                       
                                          M
                                          9
                                       
                                       ,
                                    
                                  
                                 M
                                 10, T
                                 3⟩ to GWN through an unreliable channel.


                                 GWN checks whether 
                                    
                                       
                                          |
                                       
                                       
                                          T
                                          4
                                       
                                       −
                                       
                                          T
                                          3
                                       
                                       
                                          |
                                          ≤
                                          Δ
                                          T
                                       
                                    
                                  holds, where T
                                 4 is the current timestamp. If it is incorrect, GWN aborts the session, otherwise computing 
                                    
                                       
                                          K
                                          j
                                          ′
                                       
                                       =
                                       
                                          M
                                          10
                                       
                                       ⊕
                                       
                                          K
                                          i
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       S
                                       
                                          K
                                          
                                             G
                                             W
                                             N
                                          
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                             ′
                                          
                                          ∥
                                          I
                                          
                                             D
                                             j
                                          
                                          ∥
                                          
                                             K
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             K
                                             j
                                             ′
                                          
                                          )
                                       
                                       ,
                                    
                                  and 
                                    
                                       
                                          M
                                          9
                                          ′
                                       
                                       =
                                       h
                                       
                                          (
                                          S
                                          
                                             K
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          ∥
                                          
                                             X
                                             j
                                             ′
                                          
                                          ∥
                                          
                                             K
                                             j
                                             ′
                                          
                                          ∥
                                          
                                             T
                                             3
                                          
                                          )
                                       
                                    
                                 . GWN rejects the session if 
                                    
                                       
                                          M
                                          9
                                          ′
                                       
                                       ≠
                                       
                                          M
                                          9
                                       
                                       ,
                                    
                                  otherwise computing 
                                    
                                       
                                          M
                                          11
                                       
                                       =
                                       h
                                       
                                          (
                                          S
                                          
                                             K
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          ∥
                                          I
                                          
                                             D
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             d
                                             i
                                          
                                          ∥
                                          
                                             K
                                             j
                                             ′
                                          
                                          )
                                       
                                    
                                 . Finally, GWN forwards 
                                    
                                       M
                                       S
                                       
                                          G
                                          6
                                       
                                       =
                                       
                                          〈
                                          
                                             M
                                             11
                                          
                                          ,
                                          
                                             M
                                             10
                                          
                                          〉
                                       
                                    
                                  to Ui
                                  through an unreliable channel.


                                 Ui
                                  computes 
                                    
                                       
                                          K
                                          j
                                          *
                                       
                                       =
                                       
                                          M
                                          10
                                       
                                       ⊕
                                       
                                          K
                                          i
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       S
                                       
                                          K
                                          i
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          I
                                          
                                             D
                                             j
                                          
                                          ∥
                                          
                                             K
                                             i
                                          
                                          ∥
                                          
                                             K
                                             j
                                             *
                                          
                                          )
                                       
                                    
                                  and 
                                    
                                       
                                          M
                                          
                                             11
                                          
                                          *
                                       
                                       =
                                       h
                                       
                                          (
                                          S
                                          
                                             K
                                             i
                                          
                                          ∥
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          
                                             d
                                             i
                                          
                                          ∥
                                          
                                             K
                                             j
                                          
                                          )
                                       
                                       ,
                                    
                                  aborting the session if 
                                    
                                       
                                          M
                                          
                                             11
                                          
                                          *
                                       
                                       ≠
                                       
                                          M
                                          11
                                       
                                    
                                 . Otherwise, Ui
                                  believes that GWN and Sj
                                  are authentic. Note that the protocol establishes a session key 
                                    
                                       S
                                       
                                          K
                                          i
                                       
                                       =
                                       S
                                       
                                          K
                                          j
                                       
                                       =
                                       S
                                       
                                          K
                                          
                                             G
                                             W
                                             N
                                          
                                       
                                    
                                  between Ui, Sj
                                 , and GWN after performing mutual authentication.

Our protocol negotiates a session key 
                                 
                                    S
                                    
                                       K
                                       i
                                    
                                    =
                                    S
                                    
                                       K
                                       j
                                    
                                    =
                                    S
                                    
                                       K
                                       
                                          G
                                          W
                                          N
                                       
                                    
                                 
                               between Ui, Sj
                              , and GWN, the main objective of which is to maintain a session key for secure, real-time communication over an unreliable channel.

The main aim of this phase is to deploy sensor nodes after forming the network. As a practical issue, one or more sensor node(s) may become damaged, requiring replacement. Assume that a damaged node Sk
                         needs to be replaced by a new sensor node Sl
                         in the target field. To do so, SA chooses the identity IDl
                         of Sl
                        , computes 
                           
                              
                                 X
                                 l
                              
                              =
                              h
                              
                                 (
                                 I
                                 D
                                 l
                                 ∥
                                 
                                    X
                                    
                                       G
                                       W
                                       N
                                    
                                 
                                 )
                              
                              ,
                           
                         and embeds ⟨IDl, Xl, Rshrd
                        ⟩ into the memory of Sl
                        . Now, SA deploys Sl
                         in the target region. After deployment, Sl
                         executes the sensor node registration phase presented in Section 4.2.

The main intention of this phase is to securely update the identity of a registered user. This phase requires the assistance of GWN. Ui
                         inserts his or her smartcard into the card reader and executes Step 1 of the login phase (Section 4.4) to verify Ui
                        ’s legitimacy. Now, the smartcard and GWN compute the following operations:

                           
                              
                                 Step 1.
                              
                              
                                 Ui
                                  inputs a new identity 
                                    
                                       I
                                       
                                          D
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                  and then the smartcard computes 
                                    
                                       
                                          d
                                          
                                             i
                                          
                                          *
                                       
                                       =
                                       
                                          f
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          P
                                          
                                             W
                                             i
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          L
                                          i
                                          *
                                       
                                       =
                                       
                                          g
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          P
                                          
                                             W
                                             i
                                          
                                          ⊕
                                          I
                                          
                                             D
                                             i
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          Z
                                          i
                                       
                                       =
                                       h
                                       
                                          (
                                          
                                             d
                                             i
                                             *
                                          
                                          ∥
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          
                                             T
                                             
                                                i
                                                d
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          W
                                          i
                                       
                                       =
                                       I
                                       
                                          D
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             L
                                             i
                                          
                                          ∥
                                          
                                             T
                                             
                                                i
                                                d
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       S
                                       C
                                       
                                          T
                                          i
                                       
                                       =
                                       S
                                       C
                                       
                                          N
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             T
                                             
                                                i
                                                d
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                  and 
                                    
                                       D
                                       
                                          D
                                          i
                                       
                                       =
                                       I
                                       
                                          D
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             L
                                             i
                                          
                                          ∥
                                          
                                             d
                                             i
                                          
                                          ∥
                                          
                                             T
                                             
                                                i
                                                d
                                             
                                          
                                          )
                                       
                                    
                                 . The smartcard then sends ⟨Zi, Wi, DDi, SCTi, Tid
                                 ⟩ to GWN through an unreliable channel.


                                 GWN computes 
                                    
                                       S
                                       C
                                       
                                          N
                                          i
                                       
                                       =
                                       S
                                       C
                                       
                                          T
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             T
                                             
                                                i
                                                d
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          L
                                          i
                                          ′
                                       
                                       =
                                       h
                                       
                                          (
                                          S
                                          C
                                          
                                             N
                                             i
                                          
                                          ∥
                                          
                                             X
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       I
                                       
                                          D
                                          i
                                          ′
                                       
                                       =
                                       
                                          W
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             L
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             T
                                             
                                                i
                                                d
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          d
                                          i
                                          ′
                                       
                                       =
                                       
                                          d
                                          i
                                          ′
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             X
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                  and 
                                    
                                       
                                          Z
                                          i
                                          ′
                                       
                                       =
                                       h
                                       
                                          (
                                          
                                             d
                                             i
                                             ′
                                          
                                          ∥
                                          I
                                          
                                             D
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             T
                                             
                                                i
                                                d
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                  and then checks whether 
                                    
                                       
                                          Z
                                          i
                                          ′
                                       
                                       =
                                       
                                          Z
                                          i
                                       
                                    
                                  holds. If it holds, GWN believes that the message sent by Ui
                                  is correct. GWN then computes 
                                    
                                       I
                                       
                                          D
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       =
                                       D
                                       
                                          D
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          
                                             L
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             d
                                             i
                                             ′
                                          
                                          ∥
                                          
                                             T
                                             
                                                i
                                                d
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          d
                                          i
                                          
                                             *
                                             *
                                          
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                             
                                                n
                                                e
                                                w
                                             
                                          
                                          ∥
                                          
                                             X
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          Y
                                          i
                                       
                                       =
                                       
                                          d
                                          i
                                          
                                             *
                                             *
                                          
                                       
                                       ⊕
                                       
                                          d
                                          i
                                          ′
                                       
                                       ,
                                    
                                  and 
                                    
                                       Z
                                       
                                          Z
                                          i
                                       
                                       =
                                       h
                                       
                                          (
                                          
                                             d
                                             i
                                             
                                                *
                                                *
                                             
                                          
                                          ∥
                                          
                                             Z
                                             i
                                             ′
                                          
                                          )
                                       
                                    
                                  and sends ⟨ZZi, Yi
                                 ⟩ to the smartcard through an unreliable channel, and updating 
                                    
                                       I
                                       
                                          D
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                    
                                  in the database.

The smartcard computes 
                                    
                                       
                                          d
                                          i
                                          
                                             *
                                             *
                                          
                                       
                                       =
                                       
                                          Y
                                          i
                                       
                                       ⊕
                                       
                                          d
                                          i
                                          ′
                                       
                                       ,
                                    
                                  and 
                                    
                                       Z
                                       
                                          Z
                                          i
                                          *
                                       
                                       =
                                       h
                                       
                                          (
                                          
                                             d
                                             i
                                             
                                                *
                                                *
                                             
                                          
                                          ∥
                                          
                                             Z
                                             i
                                          
                                          )
                                       
                                    
                                  and checks whether 
                                    
                                       Z
                                       
                                          Z
                                          i
                                          *
                                       
                                       =
                                       Z
                                       
                                          Z
                                          i
                                       
                                    
                                  holds. If it holds, the smartcard computes 
                                    
                                       
                                          e
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                             
                                                n
                                                e
                                                w
                                             
                                          
                                          ∥
                                          P
                                          
                                             W
                                             i
                                          
                                          ∥
                                          
                                             B
                                             i
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          f
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       =
                                       
                                          d
                                          i
                                          
                                             *
                                             *
                                          
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                             
                                                n
                                                e
                                                w
                                             
                                          
                                          ∥
                                          P
                                          
                                             W
                                             i
                                          
                                          )
                                       
                                       ,
                                    
                                  and 
                                    
                                       
                                          g
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       =
                                       
                                          L
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          P
                                          
                                             W
                                             i
                                          
                                          ⊕
                                          I
                                          
                                             D
                                             i
                                             
                                                n
                                                e
                                                w
                                             
                                          
                                          )
                                       
                                    
                                 . Finally, the smartcard replaces the old information ⟨ei, fi, gi
                                 ⟩ with the new information 
                                    
                                       〈
                                       
                                          e
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          f
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          g
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       
                                          〉
                                          ,
                                       
                                    
                                  which is stored on the smartcard.

For security reasons, an authorized user Ui
                         will want to update the password PWi
                        . Any password-based authentication protocol must include a password change facility. In order to reduce complexity and network congestion, the password change must be performed without any help from SA or GWN. This phase is described below:

                           
                              
                                 Step 1.
                              
                              
                                 Ui
                                  inserts his or her smartcard into the card reader and executes Step 1 of the login phase (see Section 4.4) to verify the fingerprint, password, and identity.

The smartcard prompts Ui
                                  for a new password, 
                                    
                                       P
                                       
                                          W
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                    
                                 . Ui
                                  then enters 
                                    
                                       P
                                       
                                          W
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                  and the smartcard computes 
                                    
                                       
                                          e
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          P
                                          
                                             W
                                             i
                                             
                                                n
                                                e
                                                w
                                             
                                          
                                          ∥
                                          
                                             B
                                             i
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          d
                                          i
                                          ′
                                       
                                       =
                                       
                                          f
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          P
                                          
                                             W
                                             i
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          f
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       =
                                       
                                          d
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          P
                                          
                                             W
                                             i
                                             
                                                n
                                                e
                                                w
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          L
                                          i
                                          ′
                                       
                                       =
                                       
                                          g
                                          i
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          P
                                          
                                             W
                                             i
                                          
                                          ⊕
                                          I
                                          
                                             D
                                             i
                                          
                                          )
                                       
                                       ,
                                    
                                  and 
                                    
                                       
                                          g
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       =
                                       
                                          L
                                          i
                                          ′
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          P
                                          
                                             W
                                             i
                                             
                                                n
                                                e
                                                w
                                             
                                          
                                          ⊕
                                          I
                                          
                                             D
                                             i
                                          
                                          )
                                       
                                    
                                 .

The smartcard replaces the old information ⟨ei, gi, fi
                                 ⟩ with the new information 
                                    
                                       〈
                                       
                                          e
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          g
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          f
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       
                                          〉
                                       
                                    
                                  in the memory of smartcard, keeping the rest of the parameters unchanged.

As a practical matter the smartcard of a registered user may be stolen or lost. In our protocol, Ui
                         can get a new smartcard by executing the following steps:

                           
                              
                                 Step 1.
                              
                              
                                 Ui
                                  sent his or her identity IDi
                                  along with personal credential to SA using a reliable channel. SA first verifies Ui
                                 ’s credential and, if it is correct, computes 
                                    
                                       
                                          d
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          
                                             X
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          )
                                       
                                    
                                  and 
                                    
                                       
                                          L
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       =
                                       h
                                       
                                          (
                                          S
                                          C
                                          
                                             N
                                             i
                                             
                                                n
                                                e
                                                w
                                             
                                          
                                          ∥
                                          
                                             X
                                             
                                                G
                                                W
                                                N
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                  where 
                                    
                                       S
                                       C
                                       
                                          N
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                    
                                  is the unique number of the new smartcard . Then, SA stores 
                                    
                                       〈
                                       
                                          d
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          L
                                          
                                             i
                                          
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       S
                                       C
                                       
                                          N
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                  
                                 BK()⟩ in the new smartcard’s memory and sends the card securely to Ui
                                 . Then, SA updates the database with 
                                    
                                       S
                                       C
                                       
                                          N
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                    
                                 .


                                 Ui
                                  inserts the smartcard into the card reader. Ui
                                  then keys IDi
                                  and PWi
                                  into the smartcard and provides fingerprint fngi
                                  at the sensor device. The smartcard then computes 
                                    
                                       
                                          B
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       =
                                       B
                                       K
                                       
                                          (
                                          H
                                          
                                             (
                                             f
                                             n
                                             
                                                g
                                                i
                                             
                                             )
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          e
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       =
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          P
                                          
                                             W
                                             i
                                          
                                          ∥
                                          
                                             B
                                             i
                                             
                                                n
                                                e
                                                w
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          f
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       =
                                       
                                          d
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          I
                                          
                                             D
                                             i
                                          
                                          ∥
                                          P
                                          
                                             W
                                             i
                                          
                                          )
                                       
                                       ,
                                    
                                  and 
                                    
                                       
                                          g
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       =
                                       
                                          L
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ⊕
                                       h
                                       
                                          (
                                          P
                                          
                                             W
                                             i
                                          
                                          ⊕
                                          I
                                          
                                             D
                                             i
                                          
                                          )
                                       
                                    
                                 . Finally, the smartcard stores 
                                    
                                       〈
                                       
                                          B
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          e
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          f
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          g
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       S
                                       C
                                       
                                          N
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                  
                                 BK()⟩ into its memory, and deleting 
                                    
                                       〈
                                       
                                          d
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          L
                                          i
                                          
                                             n
                                             e
                                             w
                                          
                                       
                                       
                                          〉
                                       
                                    
                                 .

We simulated our protocol using AVISPA software to verify its security. AVISPA is a widely accepted tool with which the security correctness of many authentication protocols have been proven. We first describe AVISPA and then present the simulation results, followed by the specification of the proposed protocol.


                        AVISPA measures whether a security protocol is SAFE or UNSAFE. AVISPA supports the High Level Protocol Specification Language (HLPSL). The structure of AVISPA is described in [35]. Note that AVISPA 
                        [41] supports four different back-ends and abstraction-based methods, all of which are integrated through HLPSL. The on-the-fly Model-Checker (OFMC) uses symbolic techniques to explore the state space in a demand-driven way. The back-end CL-AtSe (Constraint-Logic-based Attack Searcher) provides a translation from any security protocol specification written as a transition relation in an intermediate format (IF) into a set of constraints, which are effectively used to find security weaknesses of the designed protocol. The model checker SATMC generates propositional formulae, which feed into a state-of-the-art SAT solver; any model found is translated back into an attack. The model checker TA4SP is responsible for approximating an intruder’s knowledge by using regular tree languages. As mentioned above, the HLPSL specification is translated into an intermediate form using the hlpsl2if translator.


                        AVISPA supports role-oriented language, with each participant playing a role during protocol execution. Each role is independent from the others, with some initial information (parameters) and, communicating with the other roles through channels. The intruder is modeled using the Dolev and Yao model [42], with the intruder able to assume a legitimate role in a protocol run. The role system also describes the number of sessions, the number of principals, and the number and types of roles. The OUTPUT FORMAT (OF) is generated based on the four back-ends. After successful execution, OF describes the results: whether the protocol is safe or unsafe, along with under what conditions that output is obtained.

This section briefly presents the role for each participant of the proposed protocol, namely the user Ui, the gateway node GWN, the sensor node Sj, the session, the goal, and the environment. We implemented the Ui’s role in HLPSL language, as presented in Fig. 10
                        . During execution of the user registration phase, Ui sends the registration message Snd(IDi_SKey1) to SA through a reliable channel using the symmetric key SKey1 and the Snd() operation. The type declaration channel(dy) defines that the channel follows the Dolev and Yao threat model [42]. The declaration secret(IDi, subs1, {Ui, GWN, Sj}) indicates that IDi
                         is known to ⟨Ui, GWN, Sj⟩. Since only ⟨Ui, GWN, Sj⟩ know the user’s identity, the protocol provides user-anonymity.

In Transition 2, Ui receives the smartcard information 
                           
                              R
                              c
                              v
                              (
                              
                                 {
                                 D
                                 
                                    i
                                    ′
                                 
                                 .
                                 L
                                 
                                    i
                                    ′
                                 
                                 .
                                 S
                                 C
                                 N
                                 
                                    i
                                    ′
                                 
                                 }
                              
                              _
                              S
                              K
                              e
                              y
                              1
                              )
                           
                         securely using the symmetric key SKey1 and Rcv() operation. After that, Ui generates a random nonce Ki′ and timestamp T1′ using the new() operation. Then Ui sends Snd(M1′.M2′.M3′.T1′.EIDj′.SCNi) to GWN through an unreliable channel. The declaration witness(Ui,GWN,user_gateway, Ki′) indicates that Ui has freshly created Ki′ for GWN, and secret({PWi}, subs2, {Ui}) declares that PWi is only known to Ui. In Transition 3, Ui receives Rcv(M4′) through an unreliable channel and sends Snd(M5′) to GWN over a public channel. In Transition 4, Ui receives another message Rcv(M11′. M10) and then computes a session key. The declarations secret({Ki, Kj}, subs3, {Ui, GWN, Sj}) and secret({SKi′}, subs4, {Ui, GWN, Sj}) indicate that ⟨Ki, Kj, SKi⟩ are known only to ⟨Ui, GWN, Sj⟩.

We present GWN’s role in the HLPSL language in Fig. 11
                        . Initially, GWN receives the registration message 
                           
                              R
                              c
                              v
                              (
                              
                                 {
                                 I
                                 D
                                 
                                    i
                                    ′
                                 
                                 }
                              
                              _
                              S
                              K
                              e
                              y
                              1
                              )
                           
                         securely from Ui using the symmetric key SKey1. Then, GWN generates the smartcard number SCNi and shares key Rshrd. GWN securely forwards the smartcard information 
                           
                              S
                              n
                              d
                              (
                              
                                 {
                                 D
                                 
                                    i
                                    ′
                                 
                                 .
                                 L
                                 
                                    i
                                    ′
                                 
                                 .
                                 S
                                 C
                                 N
                                 
                                    i
                                    ′
                                 
                                 }
                              
                              _
                              S
                              K
                              e
                              y
                              1
                              )
                           
                        . At the same time, GWN starts the registration phase of Sj. The declaration secret({Xgwn}, subs5, {GWN}) indicates that the secret key Xgwn is known only to GWN, while secret({Xj}, subs6, {GWN, Sj}) states that Xj is known only to ⟨GWN, Sj⟩. During the sensor node registration phase, GWN publicly receives the message Rcv(S1′.S2′.Ts1′). In Transition 3, GWN receives the login message Rcv(M1′.M2′.M3′.T1′.EIDj′.SCNi) through an unreliable channel and then sends Snd(M4′) to Ui. In Transition 4, GWN receives Rcv(M5′) and then generates the timestamp T2′. Thereafter, GWN transmits Snd(IDgwn.M6′.M7′.M8′.T2′) to Sj through an unreliable channel. In Transition 5, GWN receives Rcv(M9′.M10′.T3′) and sends Snd(M11′. M10) to Ui after computing the session key.

In Fig. 12
                        , we present Sj′s role in the HLPSL language. Initially, Sj securely receives the message 
                           
                              R
                              c
                              v
                              (
                              
                                 {
                                 I
                                 D
                                 
                                    j
                                    ′
                                 
                                 .
                                 X
                                 
                                    j
                                    ′
                                 
                                 .
                                 R
                                 s
                                 h
                                 r
                                 
                                    d
                                    ′
                                 
                                 }
                              
                              _
                              S
                              K
                              e
                              y
                              2
                              )
                           
                         from GWN with the help of the symmetric key SKey2. Then, Sj forwards Snd(S1′.S2′.Ts1′) to GWN through an unreliable channel. The statement secret({Rshrd}, subs7, {Sj, GWN}) indicates that Rshrd is shared between GWN and Sj. In Transition 2, Sj receives Rcv(IDgwn.M6′.M7′.M8′.T2′) and then generates the random number Kj′ and timestamp T3′ using the new() operation. Finally, Sj sends the message Snd(M9′.M10′.T3′) to GWN. The statement witness(Sj, GWN, gateway_sensor, Kj′) declares that Sj generates a fresh value of Kj′ for GWN.

In Fig. 13
                        , we present the session, goal, and environment roles in the HLPSL language. All the basic roles, as well as the roles for ⟨Ui, GWN, Sj⟩, are instanced with concrete arguments in the session segment. The environment section contains the global constant and composition of one or more session(s), and the intruder’s knowledge is also given. It may be noted that we have provided all the public parameters, including all the messages transmitted between the entities involved in our protocol.

The current version (2006/02/2013) of HLPSL supports standard authentication and secrecy goals. In our implementation, the following seven secrecy goals and two authentications properties were verified.

                           
                              •
                              
                                 G1. The 
                                    
                                       s
                                       e
                                       c
                                       r
                                       e
                                       c
                                       y
                                       _
                                       o
                                       f
                                       s
                                       u
                                       b
                                       s
                                       1
                                    
                                  represents that IDi
                                  is kept secret to (Ui, GWN, Sj) only.


                                 G2. The 
                                    
                                       s
                                       e
                                       c
                                       r
                                       e
                                       c
                                       y
                                       _
                                       o
                                       f
                                       s
                                       u
                                       b
                                       s
                                       2
                                    
                                  represents that PWi
                                  is kept secret to Ui only.


                                 G3. The 
                                    
                                       s
                                       e
                                       c
                                       r
                                       e
                                       c
                                       y
                                       _
                                       o
                                       f
                                       s
                                       u
                                       b
                                       s
                                       3
                                    
                                  represents that the random numbers ⟨Ki, Kj
                                 ⟩ are kept secret to (Ui, GWN, Sj) only.


                                 G4. The 
                                    
                                       s
                                       e
                                       c
                                       r
                                       e
                                       c
                                       y
                                       _
                                       o
                                       f
                                       s
                                       u
                                       b
                                       s
                                       4
                                    
                                  represents that the negotiated secret key is only known to (Ui, GWN, Sj).


                                 G5. The 
                                    
                                       s
                                       e
                                       c
                                       r
                                       e
                                       c
                                       y
                                       _
                                       o
                                       f
                                       s
                                       u
                                       b
                                       s
                                       5
                                    
                                  represents that the secret key Xgwn of GWN is permanently kept secret, known to only GWN.


                                 G6. The 
                                    
                                       s
                                       e
                                       c
                                       r
                                       e
                                       c
                                       y
                                       _
                                       o
                                       f
                                       s
                                       u
                                       b
                                       s
                                       6
                                    
                                  represents that Xj
                                  is only known to (GWN, Sj).


                                 G7. The 
                                    
                                       s
                                       e
                                       c
                                       r
                                       e
                                       c
                                       y
                                       _
                                       o
                                       f
                                       s
                                       u
                                       b
                                       s
                                       7
                                    
                                  represents that the shared secret Rshrd is only known to (GWN, Sj).


                                 A1. The 
                                    
                                       a
                                       u
                                       t
                                       h
                                       e
                                       n
                                       t
                                       i
                                       c
                                       a
                                       t
                                       i
                                       o
                                       n
                                       _
                                       o
                                       n
                                       u
                                       s
                                       e
                                       r
                                       _
                                       g
                                       a
                                       t
                                       e
                                       w
                                       a
                                       y
                                       _
                                       k
                                       i
                                    
                                  represents that Ui generates a random number ki. If GWN securely receives ki through a message, it authenticates Ui.


                                 A2. The 
                                    
                                       a
                                       u
                                       t
                                       h
                                       e
                                       n
                                       t
                                       i
                                       c
                                       a
                                       t
                                       i
                                       o
                                       n
                                       _
                                       o
                                       n
                                       g
                                       a
                                       t
                                       e
                                       w
                                       a
                                       y
                                       _
                                       s
                                       e
                                       n
                                       s
                                       o
                                       r
                                       _
                                       k
                                       j
                                    
                                  represents that Sj generates a random number kj. If GWN securely receives kj through a message, it authenticates Sj.

This section discusses the results obtained after executing the HLPSL code using the web implementation of the AVISPA simulation tool. From these results, which are presented in Figs. 14
                         and15
                        , we find that the proposed protocol is SAFE under OFMC and CL-AtSe against active and passive attacks.

This section further analyzes the security of the proposed protocol against relevant attacks.

                        Proposition 1
                        
                           The proposed protocol is secure against the stolen-smartcard attack.
                        

In this attack, 
                              A
                            attempts to retrieve Ui
                           ’s and GWN’s confidential information after extracting information from the smartcard using the mechanism given in [36,37]. Generally, Ui
                            uses low-entropy identity and password, which are guessable in polynomial time. Therefore, 
                              A
                            attempts not only to extract confidential information but also to guess Ui
                           ’s identity and password. However, this attack is not feasible in our protocol, owing to the following:

                              
                                 (1)
                                 Assume that 
                                       A
                                     knows the smartcard information ⟨Bi, ei, fi, gi, SCNi, BK()⟩ of the legal user Ui
                                    , where 
                                       
                                          
                                             B
                                             i
                                          
                                          =
                                          B
                                          K
                                          
                                             (
                                             H
                                             
                                                (
                                                f
                                                n
                                                
                                                   g
                                                   i
                                                
                                                )
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             e
                                             i
                                          
                                          =
                                          h
                                          
                                             (
                                             I
                                             
                                                D
                                                i
                                             
                                             ∥
                                             P
                                             
                                                W
                                                i
                                             
                                             ∥
                                             
                                                B
                                                i
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             f
                                             i
                                          
                                          =
                                          
                                             d
                                             i
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             I
                                             
                                                D
                                                i
                                             
                                             ∥
                                             P
                                             
                                                W
                                                i
                                             
                                             )
                                          
                                          ,
                                       
                                     and 
                                       
                                          
                                             g
                                             i
                                          
                                          =
                                          
                                             L
                                             i
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             P
                                             
                                                W
                                                i
                                             
                                             ⊕
                                             I
                                             
                                                D
                                                i
                                             
                                             )
                                          
                                       
                                    . Note that di
                                     is unknown to 
                                       A
                                    . According to Assumption 6, 
                                       A
                                     cannot compute 
                                       
                                          
                                             f
                                             i
                                          
                                          =
                                          
                                             d
                                             i
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             I
                                             
                                                D
                                                i
                                             
                                             ∥
                                             P
                                             
                                                W
                                                i
                                             
                                             )
                                          
                                       
                                     without knowing h(IDi
                                    ∥PWi
                                    ). Similarly, 
                                       A
                                     cannot compute Li
                                     using gi
                                     without knowing ⟨IDi, PWi
                                    ⟩. Since IDi
                                     and PWi
                                     are shielded by the hash function in ⟨gi, fi
                                    ⟩, 
                                       A
                                     is not able to extract the required information due to non-invertibility of h(). However, 
                                       A
                                     can guess ⟨IDi, PWi
                                    ⟩ if ⟨gi, fi
                                    ⟩ is known. Note that the computation of ⟨gi, fi
                                    ⟩ is based on ⟨XGWN, IDi, PWi
                                    ⟩, which are unknown to 
                                       A
                                    . According to Assumption 7, the probability of guessing ⟨XGWN, IDi, PWi
                                    ⟩ is approximately equal to 
                                       
                                          
                                             1
                                             
                                                2
                                                
                                                   12
                                                   n
                                                   +
                                                   1024
                                                
                                             
                                          
                                          ,
                                       
                                     which is negligible where the length of the secret key of GWN is 1024 bits.


                                    Bi
                                     and ei
                                     are protected due to the hash function, where 
                                       
                                          
                                             B
                                             i
                                          
                                          =
                                          B
                                          K
                                          
                                             (
                                             H
                                             
                                                (
                                                f
                                                n
                                                
                                                   g
                                                   i
                                                
                                                )
                                             
                                             )
                                          
                                          ,
                                       
                                     and 
                                       
                                          
                                             e
                                             i
                                          
                                          =
                                          h
                                          
                                             (
                                             I
                                             
                                                D
                                                i
                                             
                                             ∥
                                             P
                                             
                                                W
                                                i
                                             
                                             ∥
                                             
                                                B
                                                i
                                             
                                             )
                                          
                                       
                                    . Therefore, 
                                       A
                                     cannot extract Ui
                                    ’s information using ⟨Bi, ei
                                    ⟩. Note that guessing Ui
                                    ’s fingerprint fngi
                                     is hard [8]. Hence, 
                                       A
                                     cannot guess fngi
                                    . On the other hand, 
                                       A
                                     cannot verify the guessed IDi
                                     and PWi
                                     according to Assumption 4.

The above shows that the attacker cannot extract or guess any confidential information of Ui
                            or GWN from a smartcard. Therefore, our protocol is secure against a stolen-smartcard attack.□


                           The proposed protocol is secure against the off-line user-identity guessing attack.
                        

To violate the user-anonymity, 
                              A
                            may attempt to extract or guess Ui
                           ’s IDi
                            either from the smartcard information or from the public messages. However, for 
                              A
                            to extract or guess the identity IDi
                            is not feasible because of the following:

                              
                                 (1)
                                 In Proposition 1, we have illustrated that 
                                       A
                                     cannot derive or guess IDi
                                     from the smartcard information.

During protocol execution, assume that 
                                       A
                                     has intercepted the login message ⟨M
                                    1, M
                                    2, M
                                    3, T
                                    1, SCTi, EIDj
                                    ⟩, where 
                                       
                                          S
                                          C
                                          
                                             T
                                             i
                                          
                                          =
                                          S
                                          C
                                          
                                             N
                                             i
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             
                                                T
                                                1
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             M
                                             1
                                          
                                          =
                                          I
                                          
                                             D
                                             i
                                             *
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             
                                                L
                                                i
                                                *
                                             
                                             ∥
                                             
                                                T
                                                1
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             M
                                             2
                                          
                                          =
                                          
                                             K
                                             i
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             
                                                d
                                                i
                                                *
                                             
                                             ∥
                                             
                                                T
                                                1
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             M
                                             3
                                          
                                          =
                                          h
                                          
                                             (
                                             
                                                d
                                                i
                                                *
                                             
                                             ∥
                                             
                                                K
                                                i
                                             
                                             ∥
                                             
                                                T
                                                1
                                             
                                             )
                                          
                                          ,
                                       
                                     and 
                                       
                                          E
                                          I
                                          
                                             D
                                             j
                                          
                                          =
                                          I
                                          
                                             D
                                             j
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             I
                                             
                                                D
                                                i
                                             
                                             ∥
                                             
                                                K
                                                i
                                             
                                             ∥
                                             
                                                T
                                                1
                                             
                                             )
                                          
                                       
                                    . To derive IDi
                                     using M
                                    1, the correct 
                                       
                                          L
                                          i
                                          *
                                       
                                     is required, which is not possible. On the other hand, IDi
                                     is protected by h() in EIDj
                                    . Hence, 
                                       A
                                     cannot extract it, since the probability of guessing of IDi
                                     would be 
                                       
                                          
                                             1
                                             
                                                2
                                                
                                                   12
                                                   n
                                                   +
                                                   128
                                                
                                             
                                          
                                          ,
                                       
                                     which is negligible.

During the execution of Steps 1 and 2 of Section 4.5, GWN and Ui
                                     forward M
                                    4 and M
                                    5, respectively, through an unreliable channel, where 
                                       
                                          
                                             M
                                             4
                                          
                                          =
                                          h
                                          
                                             (
                                             I
                                             
                                                D
                                                i
                                             
                                             ∥
                                             
                                                d
                                                i
                                             
                                             ∥
                                             
                                                T
                                                1
                                             
                                             )
                                          
                                       
                                     and 
                                       
                                          
                                             M
                                             5
                                          
                                          =
                                          h
                                          
                                             (
                                             
                                                d
                                                i
                                             
                                             ∥
                                             I
                                             
                                                D
                                                i
                                             
                                             ∥
                                             
                                                K
                                                i
                                             
                                             ∥
                                             
                                                T
                                                1
                                             
                                             )
                                          
                                       
                                    . Therefore, 
                                       A
                                     may guess or extract IDi
                                     using ⟨M
                                    4, M
                                    5⟩. Note that M
                                    4 and M
                                    5 are protected by a non-invertible hash function h(), however 
                                       A
                                     is unable to extract IDi
                                     from ⟨M
                                    4, M
                                    5⟩; he or she may attempt to guess IDi
                                    . The probability of guessing IDi
                                     using M
                                    4 and M
                                    5 would be approximately 
                                       
                                          1
                                          
                                             2
                                             
                                                6
                                                n
                                                +
                                                1024
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             1
                                             
                                                2
                                                
                                                   6
                                                   n
                                                   +
                                                   1024
                                                   +
                                                   128
                                                
                                             
                                          
                                          ,
                                       
                                     respectively, which are negligible.

During the execution of the protocol, GWN forwards ⟨IDGWN, M
                                    6, M
                                    7, M
                                    8, T
                                    2⟩ to Sj
                                     through an unreliable channel. Assume that 
                                       A
                                     has intercepted this message, where 
                                       
                                          
                                             M
                                             6
                                          
                                          =
                                          h
                                          
                                             (
                                             I
                                             
                                                D
                                                i
                                                ′
                                             
                                             ∥
                                             I
                                             
                                                D
                                                j
                                                ′
                                             
                                             ∥
                                             I
                                             
                                                D
                                                
                                                   G
                                                   W
                                                   N
                                                
                                             
                                             ∥
                                             
                                                X
                                                j
                                                ′
                                             
                                             ∥
                                             
                                                K
                                                i
                                                ′
                                             
                                             ∥
                                             
                                                T
                                                2
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             M
                                             7
                                          
                                          =
                                          I
                                          
                                             D
                                             i
                                             ′
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             I
                                             
                                                D
                                                
                                                   G
                                                   W
                                                   N
                                                
                                             
                                             ∥
                                             
                                                X
                                                j
                                                ′
                                             
                                             ∥
                                             
                                                T
                                                2
                                             
                                             )
                                          
                                          ,
                                       
                                     and 
                                       
                                          
                                             M
                                             8
                                          
                                          =
                                          
                                             K
                                             i
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             I
                                             
                                                D
                                                i
                                                ′
                                             
                                             ∥
                                             
                                                X
                                                j
                                                ′
                                             
                                             )
                                          
                                       
                                    . In order to derive IDi
                                     using M
                                    7, 
                                       A
                                     needs confidential information Xj
                                    . The identity IDi
                                     is protected by h() in M
                                    6 and M
                                    8, so 
                                       A
                                     cannot retrieve IDi
                                    . If 
                                       A
                                     wants to verify the identity guessed using M
                                    6 and M
                                    8, he or she has to know ⟨IDj, Xj, Ki
                                    ⟩ and ⟨Ki, Xj
                                    ⟩, which is not feasible.

Therefore, 
                              A
                            cannot extract Ui
                           ’s IDi
                            using the public messages MSG
                           5 and MSG
                           6. The above discussion demonstrates that our protocol can withstand the off-line identity-guessing attack. Therefore, our protocol preserves user-anonymity.□


                           The proposed protocol is secure against the off-line sensor-node-identity guessing attack.
                        

Reminiscent of the off-line user-identity guessing attack, 
                              A
                            may attempt to derive or guess the identity IDj
                            of the sensor node Sj
                            in off-line mode. In order to do so, 
                              A
                            intercepts the public messages of the protocol during execution. Note that IDj
                            is not incorporated into the smartcard; therefore, 
                              A
                            cannot get IDj
                            from a stolen-smartcard. However, neither can 
                              A
                            extract or guess IDj
                            from public messages, because

                              
                                 (1)
                                 Assume that 
                                       A
                                     intercepted EIDj
                                     from the public channel and tries to extract or guess IDj
                                    , where 
                                       
                                          E
                                          I
                                          
                                             D
                                             j
                                          
                                          =
                                          I
                                          
                                             D
                                             j
                                          
                                          ⊕
                                          h
                                          
                                             (
                                             I
                                             
                                                D
                                                i
                                             
                                             ∥
                                             
                                                K
                                                i
                                             
                                             ∥
                                             
                                                T
                                                1
                                             
                                             )
                                          
                                       
                                    . Note that 
                                       A
                                     needs ⟨IDi, Ki
                                    ⟩ to derive IDj
                                    . Moreover, it is infeasible for 
                                       A
                                     to guess IDj
                                    , owing to negligible probability, is approximately equal to 
                                       
                                          
                                             1
                                             
                                                2
                                                
                                                   12
                                                   n
                                                   +
                                                   128
                                                
                                             
                                          
                                          ,
                                       
                                     where the length of the random nonce is 128 bits.

Assume that 
                                       A
                                     collects M
                                    6 from the intercepted message MSG
                                    4, where 
                                       
                                          
                                             M
                                             6
                                          
                                          =
                                          h
                                          
                                             (
                                             I
                                             
                                                D
                                                i
                                                ′
                                             
                                             ∥
                                             I
                                             
                                                D
                                                j
                                                ′
                                             
                                             ∥
                                             I
                                             
                                                D
                                                
                                                   G
                                                   W
                                                   N
                                                
                                             
                                             ∥
                                             
                                                X
                                                j
                                                ′
                                             
                                             ∥
                                             
                                                K
                                                i
                                                ′
                                             
                                             ∥
                                             
                                                T
                                                2
                                             
                                             )
                                          
                                       
                                    . Since IDj
                                     is protected by h(), 
                                       A
                                     cannot extract it. Moreover, the probability of guessing IDj
                                     using M
                                    6 is negligible.

In MSG
                                    5 and MSG
                                    6, IDj
                                     is involved in the computation of the session key. As the session key is unknown, it is infeasible for 
                                       A
                                     to derive or guess IDj
                                     using MSG
                                    5 and MSG
                                    6.

The above demonstrates that the proposed protocol is secure against the off-line sensor-node-identity guessing attack. Therefore, our protocol preserves sensor node anonymity.□


                           The proposed protocol is secure against the replay attack.
                        

In cryptography, resisting the replay attack is quite hard, remaining one of the most challenging issues. In our protocol, the attacker may attempt to forge old public messages without any modification of the protocol participants (such as user, gateway node, and sensor node). In general, the timestamp method is used to resist replay attacks; however maintaining time synchronization across large networks is quite intricate. It should be noted that WSN can be applied to a specific target region, thus reducing the time-synchronization problem. So, the timestamp technique can be applied for GWN and Sj
                           . we have employed the timestamp technique in GWN and Sj
                           , where GWN and Sj
                            check the validity of the timestamps before computing any security parameters. If 
                              A
                            forges previous messages of the protocol participants, the protocol closes the connection owing to the invalid timestamp.

Still, maintaining time synchronization in large networks is challenging. Notably, the users access services from any-where, far from the network infrastructure. Therefore, the timestamp method is not appropriate for resisting replay attacks involving user. Since the protocol does not use the timestamp method between the user and the gateway node, 
                              A
                            may attempt to launch a replay attack, which will fail because:

                              
                                 (1)
                                 Assume that 
                                       A
                                     replays the old message 
                                       
                                          M
                                          S
                                          
                                             G
                                             1
                                          
                                          
                                             =
                                             〈
                                          
                                          
                                             M
                                             1
                                          
                                          ,
                                       
                                     
                                    M
                                    2, M
                                    3, T
                                    1, SCTi, EIDj
                                    ⟩ to GWN without any modification.

It is confirmed that the replay message must be authenticated by GWN. According to our protocol, GWN transmits 
                                       
                                          M
                                          S
                                          
                                             G
                                             2
                                          
                                          =
                                          
                                             〈
                                             
                                                M
                                                4
                                             
                                             〉
                                          
                                       
                                     to Ui, GWN and Sj
                                    . Assume that 
                                       A
                                     intercepts 
                                       
                                          M
                                          S
                                          
                                             G
                                             2
                                          
                                          =
                                          
                                             〈
                                             
                                                M
                                                4
                                             
                                             〉
                                          
                                       
                                     from the public channel.


                                    
                                       A
                                     has to compute a valid M
                                    5, which is reliant on the identity IDi
                                    , confidential parameter di
                                    , and the random number Ki
                                    . We earlier illustrated that 
                                       A
                                     has no way to derive ⟨IDi, Ki, di
                                    ⟩. Since 
                                       A
                                     does not know these piece of information, computation of a valid M
                                    5 is not feasible. If 
                                       A
                                     transmits 
                                       
                                          M
                                          5
                                          ′
                                       
                                     to GWN after guessing the required parameters, GWN terminates the connection because 
                                       
                                          M
                                          5
                                          ′
                                       
                                     is invalid.□


                           The proposed protocol is secure against user and sensor node untraceability attacks.
                        

In this attack, 
                              A
                            intercepts two messages from two different sessions and checks whether they are same. If so, 
                              A
                            believes that these two messages belong to the same user. However, 
                              A
                            cannot trace Ui
                            after intercepting one or more public messages. Assume that 
                              A
                            intercepts ⟨M
                           1, M
                           2, M
                           3, T
                           1, SCTi, EIDj
                           ⟩, where 
                              
                                 S
                                 C
                                 
                                    T
                                    i
                                 
                                 =
                                 S
                                 C
                                 
                                    N
                                    i
                                 
                                 ⊕
                                 h
                                 
                                    (
                                    
                                       T
                                       1
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    M
                                    1
                                 
                                 =
                                 I
                                 
                                    D
                                    
                                       i
                                    
                                    *
                                 
                                 ⊕
                                 h
                                 
                                    (
                                    
                                       L
                                       i
                                       *
                                    
                                    ∥
                                    
                                       T
                                       1
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    M
                                    2
                                 
                                 =
                                 
                                    K
                                    i
                                 
                                 ⊕
                                 h
                                 
                                    (
                                    
                                       d
                                       
                                          i
                                       
                                       *
                                    
                                    ∥
                                    
                                       T
                                       1
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    M
                                    3
                                 
                                 =
                                 h
                                 
                                    (
                                    
                                       d
                                       i
                                       *
                                    
                                    ∥
                                    
                                       K
                                       i
                                    
                                    ∥
                                    
                                       T
                                       1
                                    
                                    )
                                 
                                 ,
                              
                            and 
                              
                                 E
                                 I
                                 
                                    D
                                    j
                                 
                                 =
                                 I
                                 
                                    D
                                    j
                                 
                                 ⊕
                                 h
                                 
                                    (
                                    I
                                    
                                       D
                                       i
                                    
                                    ∥
                                    
                                       K
                                       i
                                    
                                    ∥
                                    
                                       T
                                       1
                                    
                                    )
                                 
                              
                           . Note that the computation of ⟨M
                           1, M
                           2, M
                           3, T
                           1, SCTi, EIDj
                           ⟩ is reliant on the timestamp and a random number. Since the timestamp and random number are different in each session, the login messages of each session are also different. It is worth noting that the rest of the messages, such as ⟨MSG
                           2, MSG
                           3, MSG
                           4, MSG
                           5, MSG
                           6⟩, are different in each session too, due to the random numbers and the timestamps. Therefore, our protocol resists user and sensor node untraceability attacks.□


                           The proposed protocol is secure against the off-line password guessing attack.
                        

Resembling the off-line identity-guessing attack, 
                              A
                            can guess a user’s password in polynomial time. In Proposition 1, we have demonstrated that 
                              A
                            cannot guess Ui
                           ’s password PWi
                            using smartcard information. Notably, the public messages of our protocol are independent from PWi
                           . Therefore, guessing or extracting PWi
                            from the public messages is infeasible in our protocol.□


                           The proposed protocol provides strong protection against the user-impersonation attack.
                        

In this attack, 
                              A
                            first intercepts the login message and then attempts to make another, forged login message. However, 
                              A
                            is unable to launch the user-impersonation attack in our protocol. Assume that 
                              A
                            intercepts the login message ⟨M
                           1, M
                           2, M
                           3, T
                           1, SCTi, EIDj
                           ⟩, where 
                              
                                 S
                                 C
                                 
                                    T
                                    i
                                 
                                 =
                                 S
                                 C
                                 
                                    N
                                    i
                                 
                                 ⊕
                                 h
                                 
                                    (
                                    
                                       T
                                       1
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    M
                                    1
                                 
                                 =
                                 I
                                 
                                    D
                                    i
                                    *
                                 
                                 ⊕
                                 h
                                 
                                    (
                                    
                                       L
                                       i
                                       *
                                    
                                    ∥
                                    
                                       T
                                       1
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    M
                                    2
                                 
                                 =
                                 
                                    K
                                    i
                                 
                                 ⊕
                                 h
                                 
                                    (
                                    
                                       d
                                       i
                                       *
                                    
                                    ∥
                                    
                                       T
                                       1
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    M
                                    3
                                 
                                 =
                                 h
                                 
                                    (
                                    
                                       d
                                       i
                                       *
                                    
                                    ∥
                                    
                                       K
                                       i
                                    
                                    ∥
                                    
                                       T
                                       1
                                    
                                    )
                                 
                                 ,
                              
                            and 
                              
                                 E
                                 I
                                 
                                    D
                                    j
                                 
                                 =
                                 I
                                 
                                    D
                                    j
                                 
                                 ⊕
                                 h
                                 
                                    (
                                    I
                                    
                                       D
                                       i
                                    
                                    ∥
                                    
                                       K
                                       i
                                    
                                    ∥
                                    
                                       T
                                       1
                                    
                                    )
                                 
                              
                           . It is confirmed that 
                              A
                            can generate a fresh random nonce 
                              
                                 K
                                 i
                                 a
                              
                            and timestamp 
                              
                                 T
                                 1
                                 a
                              
                           . However, 
                              A
                            needs ⟨IDi, Li
                           ⟩ and ⟨IDi, IDj
                           ⟩ to compute M
                           1 and EIDj
                           , respectively. Similarly, 
                              A
                            requires di
                            to compute ⟨M
                           2, M
                           3⟩. We illustrated above that 
                              A
                            is unable to extract ⟨IDi, IDj, di
                           ⟩ based on the protocol description. Therefore, our protocol provides protection against the user-impersonation attack.□


                           The proposed protocol provides strong protection against the gateway node impersonation attack.
                        

Resembling the user-impersonation attack, 
                              A
                            may attempt to impersonate GWN after intercepting authentication messages during protocol execution. In order to do so, 
                              A
                            needs to compute ⟨M
                           4, IDGWN, M
                           6, M
                           7, M
                           8, T
                           2⟩, where 
                              
                                 
                                    M
                                    6
                                 
                                 =
                                 h
                                 
                                    (
                                    I
                                    
                                       D
                                       i
                                       ′
                                    
                                    ∥
                                    I
                                    
                                       D
                                       j
                                       ′
                                    
                                    ∥
                                    I
                                    
                                       D
                                       
                                          G
                                          W
                                          N
                                       
                                    
                                    ∥
                                    
                                       X
                                       j
                                       ′
                                    
                                    ∥
                                    
                                       K
                                       i
                                       ′
                                    
                                    ∥
                                    
                                       T
                                       2
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    M
                                    7
                                 
                                 =
                                 I
                                 
                                    D
                                    i
                                    ′
                                 
                                 ⊕
                                 h
                                 
                                    (
                                    I
                                    
                                       D
                                       
                                          G
                                          W
                                          N
                                       
                                    
                                    ∥
                                    
                                       X
                                       j
                                       ′
                                    
                                    ∥
                                    
                                       T
                                       2
                                    
                                    )
                                 
                                 ,
                              
                            and 
                              
                                 
                                    M
                                    8
                                 
                                 =
                                 
                                    K
                                    i
                                 
                                 ⊕
                                 h
                                 
                                    (
                                    I
                                    
                                       D
                                       i
                                       ′
                                    
                                    ∥
                                    
                                       X
                                       j
                                       ′
                                    
                                    )
                                 
                              
                           . 
                              A
                            needs ⟨IDi, IDj, Xj
                           ⟩ to compute M
                           6, ⟨IDi, Xj
                           ⟩ to compute M
                           7, and ⟨IDi, Xj
                           ⟩ to compute M
                           6, M
                           7, and M
                           8, respectively. Since ⟨IDi, IDj, Xj
                           ⟩ are unknown, it is infeasible to compute another correct but forged authentication message. Therefore, the protocol can provide security against the gateway node impersonation attack.□


                           The proposed protocol protects the sensor node impersonation attacks.
                        

Similar to the gateway node impersonation attack, 
                              A
                            may try to impersonate Sj
                            after intercepting the authentication messages. To do so, 
                              A
                            needs to generate 
                              
                                 M
                                 S
                                 
                                    G
                                    5
                                 
                                 
                                    =
                                    〈
                                 
                                 
                                    M
                                    9
                                 
                                 ,
                              
                            
                           M
                           10, T
                           3⟩ to impersonate Sj
                           , where 
                              
                                 S
                                 
                                    K
                                    j
                                 
                                 =
                                 h
                                 
                                    (
                                    I
                                    
                                       D
                                       i
                                       
                                          *
                                          *
                                       
                                    
                                    ∥
                                    I
                                    
                                       D
                                       j
                                    
                                    ∥
                                    
                                       K
                                       i
                                       
                                          *
                                          *
                                       
                                    
                                    ∥
                                    
                                       K
                                       j
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    M
                                    9
                                 
                                 =
                                 h
                                 
                                    (
                                    S
                                    
                                       K
                                       j
                                    
                                    ∥
                                    
                                       X
                                       j
                                    
                                    ∥
                                    
                                       K
                                       j
                                    
                                    ∥
                                    
                                       T
                                       3
                                    
                                    )
                                 
                                 ,
                              
                            and 
                              
                                 
                                    M
                                    10
                                 
                                 =
                                 
                                    K
                                    i
                                    
                                       *
                                       *
                                    
                                 
                                 ⊕
                                 
                                    K
                                    j
                                 
                              
                           . Thus, 
                              A
                            needs ⟨IDi, IDj, Xj, Ki
                           ⟩ to compute 
                              
                                 M
                                 S
                                 
                                    G
                                    5
                                 
                                 
                                    =
                                    〈
                                 
                                 
                                    M
                                    9
                                 
                                 ,
                              
                            
                           M
                           10, T
                           3⟩. Since 
                              A
                            has no knowledge of the information ⟨IDi, IDj, Xj, Ki
                           ⟩, it is infeasible to perform the sensor node impersonation attack.□


                           The proposed protocol is secure against the privileged-insider attack.
                        

If an insider of the system obtains the user’s password in some way, she or he can utilize it in a privileged-insider attack to crack other systems in which the user has registered him or herself using the same identity and password. In general, users often employ the same password and identity for a set of servers. According to reports in the literature, most security systems are vulnerable to the insider attack. Therefore, it is an important attack against password-based authentication protocols. During user registration in our protocol, Ui
                            submits only IDi
                            as a registration message; public messages are independent of Ui
                           ’s password. Therefore, an insider has no way to obtain Ui
                           ’s password.□


                           The proposed protocol is secure against the session key computation attack.
                        

In an authenticated session key generation protocol, the session key is typically used to encrypt confidential information during message transmission between entities over unreliable networks. The main feature of a session key is freshness, which means that in each session the session key must be different. In our protocol, Ui, GWN, and Sj
                            negotiate a session key 
                              
                                 S
                                 
                                    K
                                    i
                                 
                                 =
                                 S
                                 
                                    K
                                    
                                       G
                                       W
                                       N
                                    
                                 
                                 =
                                 S
                                 
                                    K
                                    j
                                 
                                 =
                                 h
                                 
                                    (
                                    I
                                    
                                       D
                                       i
                                    
                                    ∥
                                    I
                                    
                                       D
                                       j
                                    
                                    ∥
                                    
                                       K
                                       i
                                    
                                    ∥
                                    
                                       K
                                       j
                                    
                                    )
                                 
                              
                            that relies on the confidential information ⟨IDi, IDj, Ki, Kj
                           ⟩ that are unknown to 
                              A
                           . Therefore, 
                              A
                            cannot compute the session key without knowing ⟨IDi, IDj, Ki, Kj
                           ⟩. It is also notable that the session key in the protocol holds the freshness property because of the random numbers ⟨Ki, Kj
                           ⟩.□


                           The proposed protocol is secure against the known session-specific temporary information attack.
                        

In this attack, assume that 
                              A
                            knows short-term confidential information, such as random numbers ⟨Ki, Kj
                           ⟩ and attempts to compute the session key. The session key of our protocol is 
                              
                                 S
                                 
                                    K
                                    i
                                 
                                 =
                                 S
                                 
                                    K
                                    
                                       G
                                       W
                                       N
                                    
                                 
                                 =
                                 S
                                 
                                    K
                                    j
                                 
                                 =
                                 h
                                 
                                    (
                                    I
                                    
                                       D
                                       i
                                    
                                    ∥
                                    I
                                    
                                       D
                                       j
                                    
                                    ∥
                                    
                                       K
                                       i
                                    
                                    ∥
                                    
                                       K
                                       j
                                    
                                    )
                                 
                              
                           . Note that the session key relies not only reliant on the random numbers ⟨Ki, Kj
                           ⟩ but also depends on ⟨IDi, IDj
                           ⟩. As we have described earlier, 
                              A
                            has no way to compute ⟨IDi, IDj
                           ⟩. Therefore, the protocol
                            provides security against this attack.□


                           The proposed protocol achieves the session key verification property.
                        

The negotiated session key is verified during protocol execution. In Step 6 of the authentication phase, GWN verifies the session key SKj
                            generated by Sj
                            by checking whether 
                              
                                 
                                    M
                                    
                                       9
                                    
                                    ′
                                 
                                 =
                                 
                                    M
                                    9
                                 
                              
                            holds. After that, Ui
                            verifies whether 
                              
                                 
                                    M
                                    
                                       11
                                    
                                    *
                                 
                                 =
                                 
                                    M
                                    11
                                 
                              
                            holds to verify the session key SKGWN
                           , which is generated by GWN. Therefore, the proposed protocol provides the session key verification property.□


                           The proposed protocol preserves mutual authentication.
                        

In light of the fact that the public messages pass over an unreliable communications medium, such as the Internet, mutual authentication between participants must be provided. During the execution of our protocol, each participant authenticates every other. In Step 1 of the authentication phase, GWN verifies Ui
                           , and, in the next step, Ui
                            verifies GWN. In Step 5, Sj
                            verifies the authenticity of Ui
                            and GWN, and GWN verifies Sj
                            in Step 6. Finally, Ui
                            verifies GWN and Sj
                            in Step 7.□


                           The proposed protocol detects unauthorized logins.
                        

Practically, the user may unintentionally enter wrong information at the smartcard reader during login. As a result, the protocol may execute additional computation and thus increase network congestion. Therefore, detection of wrong user information must be provided at the initial stage of the login phase, so that the terminal cannot generate a login message without verifying the user’s legitimacy.

The probability of providing the wrong biometric information is comparatively less than providing the wrong password information. However, if Ui
                            provides the wrong fingerprint 
                              
                                 f
                                 n
                                 
                                    g
                                    i
                                    w
                                 
                                 ,
                              
                            the condition 
                              
                                 
                                    B
                                    i
                                    *
                                 
                                 =
                                 
                                    B
                                    i
                                 
                              
                            would not satisfy, where 
                              
                                 
                                    B
                                    i
                                    *
                                 
                                 =
                                 B
                                 K
                                 
                                    (
                                    H
                                    
                                       (
                                       f
                                       n
                                       
                                          g
                                          i
                                          w
                                       
                                       )
                                    
                                    )
                                 
                              
                           . Assuming that Ui
                            enters the correct fingerprint, but inputs the wrong password 
                              
                                 P
                                 
                                    W
                                    i
                                    w
                                 
                                 ,
                              
                            the smartcard would deny the user’s login request, because 
                              
                                 
                                    e
                                    i
                                    *
                                 
                                 ≠
                                 
                                    e
                                    i
                                 
                                 ,
                              
                            where 
                              
                                 
                                    e
                                    i
                                 
                                 =
                                 h
                                 
                                    (
                                    I
                                    
                                       D
                                       i
                                    
                                    ∥
                                    P
                                    
                                       W
                                       i
                                       w
                                    
                                    ∥
                                    
                                       B
                                       i
                                    
                                    )
                                 
                              
                           .□


                           The proposed protocol offers the post-deployment phase.
                        

A sensor node in the target field may become damaged in some way and require replacement. In addition, the target field may sometimes need to be expanded. SA should deploy the required sensor nodes to expand the target field. In order to provide this facility, the protocol offers a post-deployment phase.□

@&#PERFORMANCE EVALUATION@&#

We evaluate different features, such as storage cost, computational cost, and communications cost of the proposed protocol compared to other protocols. We present the results of this comparison in different tables to measure the effectiveness of our protocol. For practical applications, the designed authentication protocol must resist known attacks, while having required functionality, and low complexity.

In Table 2, we present a number of security attacks as well as functionality requirements comparing the proposed protocol to other, similar protocols. We have found in Table 2 that the protocols in [4,11,15,28,29,31] suffer from the off-line password-guessing, stolen-smartcard, and user-impersonation attacks. We have further found that the protocols in [4,11,15,28,29,31] cannot achieve the user-anonymity property. Table 2 shows that none of the protocols are completely free from security attacks and provides the required functionality except the protocol in [35]. In order to prove security correctness, we have simulated our protocol using the AVISPA software, which shows that it is SAFE under the OFMC and CL-AtSe models. Moreover, informal analysis demonstrates that our protocol protects against all known attacks.

In WSNs, energy is a constraint, so the user authentication protocol must be light-weight in terms of computation. Our protocol only uses the hash function, which is light-weight compared to other operations, including symmetric-key encryption/decryption and public-key cryptographic functions. According to the experimental results executed in [43], the approximate running time of symmetric-key encryption/decryption and the hash function are T
                        
                           e/d
                         ≈ 0.1303 ms and Th
                         ≈ 0.0004 ms, respectively. This experiment was performed using the MIRACLC/C++ Library on a system using the 32-bit Windows 7 operating system, Visual C++ 2008 Software, a 160-bit prime field Fp, 1024-bit cyclic group, the AES symmetric encryption/decryption function, and the SHA-1 hash function.

In Table 3, we summarize the computational cost and running time of the proposed protocol and of existing protocols in [4,11,15,28,29,31,35] for Ui, GWN, and Sj
                        . As WSNs are an energy-constrained environment and the battery power of sensor nodes is much lower than that of the gateway node, the computational cost of the sensor nodes should be minimal in order to achieve better efficiency. The proposed protocol is secured, as shown in Table 2, while also taking nearly the same computational cost and running time compared to the protocols in [4,11,35].

In Section 1.1, we discussed that communications cost is dependent on the length of the received and transmitted messages. To reduce network congestion and to provide fast message transmission, the communication costs of the protocol should be as low as possible. In our protocol, Sj
                         transmits 384 bits and receives 640 bits, Ui
                         transmits 896 bits and receives 384 bits, and GWN transmits 768 bits and receives 896 bits. Therefore, the total communication costs of Sj, Ui
                        , and GWN are 1024 bits, 1270 bits, and 1664 bits, respectively. The communication costs of Sj, Ui
                        , and GWN of our protocol and of the protocols in [4,11,15,28,29,31,35] are given in Table 4
                        . According to this comparison, our protocol achieves better performance in terms of the communications cost of Sj
                         (sensor node).

We summarize the smartcard storage cost in Table 5
                         for our protocol and for the protocols in [4,11,15,28,29,31,35], where CH
                        * denotes the total number of all cluster heads. Note that the protocols in [21,28,31] store the key of all cluster heads into the smartcard. Therefore, the smartcard storage cost of these protocols in [21,28,31] is much higher than that of the other protocols. We assume that the lengths of the identity, password, random number, and output of the hash function are each 128 bits. The smartcard storage required by our protocol is nearly equal to that of the protocols in [4,11,35].

@&#CONCLUSION@&#

In this article, we reviewed Farash et al.’s protocol and demonstrated that it is insecure against the stolen-smartcard, off-line password-guessing, new-smartcard issue, user-impersonation, and known session-specific temporary information attacks. We have further shown that the protocol cannot preserve the user-anonymity property. Moreover, we have identified design flaws in the network model of Farash et al.’s protocol. In this paper, then, we have contributed an efficient architecture for an IoT-based WSN to prolong the lifetime of the network by reducing the energy consumption of the sensor nodes. Then, we have designed a secure, three-factor user authentication protocol for IoT-based WSNs. To prove its security correctness, we simulated our protocol using AVISPA software. The results confirm that it is secure against active and passive attacks. Furthermore, informal cryptanalysis confirmed that our protocol is not only secure, but also achieves the relevant functionality. Performance analysis showed that our protocol is more efficient than existing protocols in terms of the energy consumption of the sensor node, communications cost, storage cost, and running time. Additionally, our protocol also achieves an efficient login phase, a user-friendly password update phase, proper mutual authentication, strong security protection for the session key, a dynamic node-addition phase, an identity change phase, and a smartcard revocation phase. The overall efficiencies, security and functionality of our protocol make it is suitable for use in IoT-based WSNs.

@&#ACKNOWLEDGMENTS@&#

Ruhul Amin is supported by Indian School of Mines, Dhanbad, India. SK Hafizul Islam is supported by OPERA award, BITS Pilani, Rajasthan, India. The authors extend their sincere appreciations to the Deanship of Scientific Research at King Saud University for its funding this Prolific Research Group (PRG-1436-16). This work is also partially supported by National Natural Science Foundation of China (61305010), Science and Technology Research Project of Education Department of Jiangxi Province (GJJ150715), Voyage Project of Jiangxi Province (201450), Open Foundation of Key Laboratory of Jiangxi Province for Image Processing and Pattern Recognition, and Key Foundation of Sichuan Development Research Center of Cultural Industries (WHCY2014A9).

@&#REFERENCES@&#

