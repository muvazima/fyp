@&#MAIN-TITLE@&#Particle filters and occlusion handling for rigid 2D–3D pose tracking

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A robust algorithm for 2D visual tracking and 3D pose estimation is proposed.


                        
                        
                           
                           We focus on partial occlusions that distort the region properties of an object.


                        
                        
                           
                           Optimal pose of an object is estimated via particle filters in a decoupled manner.


                        
                        
                           
                           The degree of trust between system’s predictions and measurements is controlled.


                        
                        
                           
                           The resulting methodology improves tracking performance in clutter and occlusion.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

2D–3D pose estimation

Object tracking

Occlusion handling

Particle filters

@&#ABSTRACT@&#


               
               
                  In this paper, we address the problem of 2D–3D pose estimation. Specifically, we propose an approach to jointly track a rigid object in a 2D image sequence and to estimate its pose (position and orientation) in 3D space. We revisit a joint 2D segmentation/3D pose estimation technique, and then extend the framework by incorporating a particle filter to robustly track the object in a challenging environment, and by developing an occlusion detection and handling scheme to continuously track the object in the presence of occlusions. In particular, we focus on partial occlusions that prevent the tracker from extracting an exact region properties of the object, which plays a pivotal role for region-based tracking methods in maintaining the track. To this end, a dynamical choice of how to invoke the objective functional is performed online based on the degree of dependencies between predictions and measurements of the system in accordance with the degree of occlusion and the variation of the object’s pose. This scheme provides the robustness to deal with occlusions of an obstacle with different statistical properties from that of the object of interest. Experimental results demonstrate the practical applicability and robustness of the proposed method in several challenging scenarios.
               
            

@&#INTRODUCTION@&#

Visual tracking has been a significant topic of research in the field of computer vision; see [1–4] and references therein. The ultimate goal of visual tracking is to continuously identify the 3D location of an object of interest from an image sequence. This amounts to what is known as the 2D–3D pose tracking problem [5,6]. However, due to the difficulty of developing a tractable solution for estimating the 3D position from a 2D scene, many researchers have tacitly restricted the tracking problem to be concerned with only the relative 2D location of the object in which segmentation is often employed in conjunction with Kalman or particle filters [7,8]. Recent techniques attempt to revisit the 2D–3D pose tracking problem for challenging scenarios by leveraging on 2D image segmentation to estimate the 3D location [9–12]. While impressive results have been obtained that rival both pose tracking and segmentation based algorithms, these schemes did not fully exploit the underlying system dynamics that is inherent in any visual tracking task. Thus, in order to effectively treat the temporal nature of the observed 2D scene, we propose to extend a similar framework proposed by [13] in which we now incorporate a particle filter to perform 3D pose estimation of a rigid object. However, before doing so, let us revisit several contributions related to the proposed method.

Several algorithms have been introduced to solve the 2D–3D pose tracking task. In general, they are based on local or region attributes for feature matching. For example, such features include points [14], lines [15], polyhedral shape [16], complete contours [17,18], or surfaces [12]. Specifically, in [16], the authors perform a 2D global affine transformation as an initialization to 3D pose estimation, and then the 3D object pose is computed by an energy minimization process with respect to an approximate polyhedral model of the object. The authors in [18] present a 3D pose estimation algorithm by using visible edges. That is, they use binary space partition trees for finding and determining the visible line to track the edges of the model. However, since these methods rely on local features, the resulting solutions may yield unsatisfactory results in the presence of noise or cluttered environments. To overcome this, an early attempt to couple segmentation and pose estimation is given in [10]. In their work, the authors propose a region-based active contour that employs a unique shape prior, which is represented by a generalized cone based on a single reference view of an object. More recently, authors in [13] as well as Schmaltz et al. [12] propose a region-based model scheme for 2D–3D pose tracking by projecting a 3D object onto a 2D image plane such that the optimal 3D pose transformation coincides with the correct 2D segmentation. In a similar fashion, Kohli et al. [9] proposed a joint segmentation and pose estimation scheme using the graph cut methodology. Although these methods perform exceptionally well for many cases, they do not exploit the underlying dynamics inherent in a typical visual tracking task. We should note, in the context of the proposed work, the incorporation of system dynamics can be viewed as an extension to these baseline algorithms.

In addition to the aforementioned approaches for 2D–3D pose tracking, many works may be found in the literature which purely focus on restricting the visual tracking problem to the 2D domain. Because a complete overview of existing methods is beyond the scope of this paper, we just consider those methods that employ various filtering schemes such as the Kalman filter [19], unscented Kalman filter [7,20], and particle filter [8,21] as well as explicit algorithms for occlusion handling [22,23]. Specifically, the authors in [24,25] employ a finite dimensional parameterization of curves, namely B-splines, in conjunction with the unscented Kalman filter for rigid object tracking. Generalizing the Kalman filter approach, the work in [26] presents an object tracking algorithm based on particle filtering with quasi-random sampling. Since these approaches only track the finite dimensional group parameters, they cannot handle local deformations of the object. As a result, several tracking schemes have been developed to account for deformation of the object via the level set technique [27,28]. In relation to our work, some early attempts for 2D visual tracking using level set methods can be found in [29,30]. In particular, authors in [30] propose a definition of motion for a deformable object. This is done by decoupling an object’s motion into a finite group motion known as deformotion with that of deformation, which is any departure from rigidity. Building on this, authors in [31] introduce a deformable tracking algorithm that utilizes the particle filtering framework in conjunction with geometric active contours. Other approaches closely related to these frameworks are given in [19,32,33]. Here the authors use a Kalman filter for predicting possible movements of the object, while the active contours are employed only for tracking deformations of the corresponding object.

In addition to employing filtering schemes to increase the robustness of tracking, many algorithms invoke a systematic approach to handle occlusions. We should note that although the main contribution of our work focuses on employing particle filtering to estimate the 3D pose during 2D visual tracking, a neat feature of the resulting methodology is its ability to handle occlusions effectively. Thus, we briefly revisit several attempts to specifically handle occlusions in the context of visual tracking [22,34,35]. Such occlusions can occur when another object lies between the target and a camera, or the target occludes parts of itself. In general, in the case of contour tracking, most methods incorporate shape information of an object of interest into a tracking framework online [35] or offline [23] to make up for poor distinguishable statistics between the object and background or missing parts of the object. To this end, a shape prior can be obtained or learnt from linear principal component analysis (PCA) if the assumption of small variations in shape holds [36]. Otherwise, for highly deformable objects, locally linear embedding (LLE) [37] or non-linear PCA [22] may be employed. In the case of template tracking, in which a complete region occupied by the object is not tracked, recently, the L1 tracker [38] is modified to accurately represent occlusions using the trivial templates in [39]. In [39], the energy of the trivial coefficients is adaptively controlled to capture the effect of occlusions.


                     Contribution: The algorithms proposed in this paper are closely related to the works in [13] and [40]. In the work of [13], the authors derive a variational approach to jointly carry out tasks of 2D region based segmentation and 3D pose estimation. This method shows robust performance for segmenting a 2D image and estimating the 3D pose of an object over image sequences even in cluttered environments. However, since this method ignores the temporal nature of the observed images, it cannot handle erratic movements or challenging occlusions. That is, the variational technique relies only on image information to drive the corresponding 3D pose estimate, which may cause unsatisfactory results in the presence of occlusions that are statistically different from that of the object of interest; see the experiments in Section 4.2. In the work of [40], the set of 3D transformation matrices is randomly constructed to find the optimal pose of an object of interest by Monte Carlo sampling on the special Euclidean group, and then a region based statistical energy is applied to evaluate the optimality of 2D projection of each transformed 3D model. This approach shows promising results in estimating 2D–3D pose of the object of interest under a cluttered environment. However, it easily fails to maintain track in the case of its dynamic movement under occlusions; see the experiments in Section 4.2. In addition this framework suffers from high computational complexity due to the nature of a sampling based method.

In this paper, not only to utilize both frameworks above but also to overcome their disadvantages, we extend them by incorporating a particle filter to exploit the underlying dynamics of the system, and by developing an occlusion handling scheme to continuously track the object of interest in a more general and challenging environment. Compared with the approaches described in [13,40], we employ a more natural particle filtering scheme to generate and propagate the translation and rotation parameters in a decoupled manner in order to find the optimal pose of an object of interest. In addition, we focus more on occlusion detection and handling to maintain track in the presence of occlusions. In particular, we deal with partial occlusions that distort the region properties of the tracked object, which is a key feature for region-based tracking methods. To this end, we improve the l-iteration scheme introduced in [31,41] by controlling dependencies between predictions and measurements of the system according to the degree of occlusion and variation of the object’s 3D pose from previous accumulated results; see Section 3.4. This improvement provides the robust method to deal with occlusions of an obstacle with different statistical properties in a tracking framework that relies heavily on region properties of an image. To the best of our knowledge, this is the first attempt to exploit the degree of dependencies between predictions and measurements of the system for these particular case of occlusions taken place in region-based frameworks involving iterative and derivative formulation.

Moreover, in the present work, the variational approach is embedded into the proposed framework in designing a measurement model to reduce computational complexity and to facilitate the effective search of a local optimum in a particle filtering framework. This method allows the samples to move further into modes of a filtering distribution so that only a few samples are necessary; see Section 3.3. Variational methods, such as Mean-shift [42], are typically gradient based optimization methods minimizing a cost functional in order to find the local mode of a probability distribution. To effectively reduce the sample size of the particle filtering framework, variational approaches are embedded into particle filters in a number of works. The authors in [43] present a mean shift embedded particle filter, in which a smaller number of samples is used to estimate the posterior distribution than conventional particle filters by shifting samples to their neighboring modes of the observation so that samples are moved to have large weights. In [44], the underlying probability density function (pdf) is represented with a semi-parametric method using a mean-shift based mode seeking algorithm to solve a tracking problem for high dimensional color imagery. The authors of [45] fuse a deterministic search based on gradient descent and random search guided by a stochastic motion model, then, in object tracking, they effectively switch two search methods according to a momentum using the inter-frame motion difference.

The remainder of this paper is organized as follows. In the next section, we briefly explain an overview of the two fundamental concepts used in the proposed method, particle filtering and the gradient descent flow presented in [13], respectively. Section 3 describes the overall particle filtering approach for 2D object tracking and 3D pose estimation. Specifically, we derive a prediction model, a measurement model, as well as an occlusion handling scheme for the task of object tracking. In Section 4, we provide experiments on both synthetic and real life imagery in hopes of highlighting the viability (and limitations) of the proposed algorithm in the context of visual tracking. Lastly, we conclude and discuss possible future research directions in Section 5.

Sequential Bayesian filtering estimation with Monte Carlo simulation, called particle filtering, was first introduced by Gordon et al. [8]. In recent years, it has proven to be a powerful scheme for non-linear and non-Gaussian estimation problems due to its simplicity and versatility.

The overall objective is to estimate a (hidden) variable of interest governing a particular underlying system with respect to what is being observed or measured. With this goal, we let s
                        
                           t
                         be a state vector and z
                        
                           t
                         be a set of observations. We then model the state transition equation and the observation equation by
                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   u
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             
                                                
                                                   h
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   v
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        where u
                        
                           t
                         and v
                        
                           t
                         are independent and identically distributed (iid) random variables representing noise whose probability density functions (pdfs) are known. Furthermore, we assume that the initial state distribution p(s
                        0) is known.

Drawing N
                        ≫1 samples 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                 
                              
                           
                         from p(s
                        
                           t
                        ∣z
                        1:t
                        ), one can properly construct an empirical estimate of the true hidden state s
                        
                           t
                        . However, generating samples from the posterior distribution p(s
                        
                           t
                        ∣z
                        1:t
                        ) is usually not possible (e.g., f and h are non-linear). Thus, if one can only generate samples from a similar density q(s
                        
                           t
                        ∣z
                        1:t
                        )≈
                        p(s
                        
                           t
                        ∣z
                        1:t
                        ), the problem becomes one of importance sampling. That is, one can form a Monte Carlo estimate of s
                        
                           t
                         by generating N samples according to q(s
                        
                           t
                        ∣z
                        1:t
                        ) with associated importance weights 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                 
                              
                           
                         at each time t. More importantly, as the algorithm progresses and if N is chosen sufficiently large, the proposal distribution can be shown to evolve toward the correct posterior distribution, i.e., q(s
                        
                           t
                        ∣z
                        1:t
                        )=
                        p(s
                        
                           t
                        ∣z
                        1:t
                        ).

Thus, the generic algorithm begins by first sampling N times from initial state distribution, p(s
                        0). Following this, the algorithm can be decomposed in two steps: the prediction step and the update step. Using importance sampling [21], the prediction step is the act of drawing N samples from the alternative proposal distribution q(s
                        
                           t
                        ∣z
                        1:t
                        ). As new information arrives online at time t from the observation z
                        
                           t
                        , one needs to evaluate the fitness of the predicted samples or particles. In other words, as z
                        
                           t
                         becomes available, the measurement or update step in particle filtering is incorporated through the importance weights by the following equation
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       p
                                       
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      t
                                                   
                                                
                                                |
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       p
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                                |
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       q
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                                |
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                      :
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              p
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       
                                          
                                             s
                                          
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                         is the likelihood of the arrived observation at time t. From the above approach, the filtering distribution is represented by a set of samples 
                           
                              
                                 
                                    s
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                         and its associated weights 
                           
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                         as
                           
                              (3)
                              
                                 p
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       z
                                    
                                    
                                       1
                                       :
                                       t
                                    
                                 
                                 )
                                 ≈
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 δ
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          
                                             
                                                s
                                             
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where δ denotes the Dirac function, and 
                           
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                         is the normalized weight of ith particle: 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                        . Moreover, one can now obtain an empirical estimate of the state s
                        
                           t
                         via maximum likelihood or through a different statistical measure. We should note that in all particle filtering methods, a resampling operation is generally performed to eliminate particles with low weights (sample degeneracy). On the other hand, if one resamples inefficiently, there may be a loss of diversity for a set of particles (sample impoverishment). We refer the reader to Section 3 for more information on resampling.

Like [13,40], we assume we have prior knowledge of the 3D shape of interest for which we would like to estimate the corresponding 3D pose from the 2D scene. Let X
                        =[X, Y, Z]
                           T
                         be the coordinates of a point in 
                           
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                         with respect to the referential of the camera. Here, it is assumed that the calibrated camera is already given and is modeled as a pinhole camera: 
                           
                              π
                              :
                              
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                              
                              ↦
                              
                              Ω
                              ;
                              
                              X
                              
                              ↦
                              
                              x
                           
                         where 
                           
                              Ω
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         is the domain of an image I(x) and x
                        =[x, y]
                           T
                        
                        =[X/Z, Y/Z]
                           T
                         denotes coordinates in Ω. 
                           
                              S
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                         is a smooth surface representing the shape of interest and N
                        =[N
                        1, N
                        2, N
                        3]
                           T
                         denotes the outward unit normal to S at each point X
                        ∈
                        S. Let R
                        =
                        
                           π
                        (S)⊂
                        Ω be the region on which the surface S is projected and R
                        
                           c
                        
                        =
                        Ω⧹R be the complementary region of R. Similarly, the curve ĉ=
                        
                           π
                        (C)⊂
                        Ω is the projection of the curve C
                        ⊂
                        S and ĉ also denotes a boundary of R, ĉ=
                        ∂R. Note, the curve ĉ in 2D and the curve C in 3D are referred to as the silhouette and the occluding curve, respectively.

For our particular segmentation problem, we seek to find a boundary that optimally partitions the object of interest or foreground from the corresponding background in a given 2D image. Inspired by region-based active contour models [46–48], the authors in [13] define an objective energy functional based on the global statistics of an image so that the curve ĉ (and 3D pose) is evolved to maximize the image statistical measure of discrepancy between its interior and exterior regions. This is given as follows:
                           
                              (4)
                              
                                 E
                                 =
                                 
                                    ∫
                                    
                                       R
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 I
                                 (
                                 x
                                 )
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             R
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 I
                                 (
                                 x
                                 )
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                                 d
                                 Ω
                              
                           
                        where 
                           
                              
                                 
                                    r
                                 
                                 
                                    o
                                 
                              
                              :
                              χ
                              ,
                              
                              Ω
                              
                              ↦
                              
                              R
                           
                         and 
                           
                              
                                 
                                    r
                                 
                                 
                                    b
                                 
                              
                              :
                              χ
                              ,
                              
                              Ω
                              
                              ↦
                              
                              R
                           
                         are functions measuring the visual consistency of the image pixels with a statistical model over the regions R and R
                        
                           c
                        , respectively. Here, χ is the space that corresponds to photometric variable of interest. In this work, r
                        
                           o
                         and r
                        
                           b
                         are given by:
                           
                              (5)
                              
                                 
                                    
                                       r
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 -
                                 log
                                 (
                                 
                                    
                                       Σ
                                    
                                    
                                       o
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       (
                                       I
                                       (
                                       x
                                       )
                                       -
                                       
                                          
                                             μ
                                          
                                          
                                             o
                                          
                                       
                                       
                                          
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             o
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       r
                                    
                                    
                                       b
                                    
                                 
                                 =
                                 -
                                 log
                                 (
                                 
                                    
                                       Σ
                                    
                                    
                                       b
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       (
                                       I
                                       (
                                       x
                                       )
                                       -
                                       
                                          
                                             μ
                                          
                                          
                                             b
                                          
                                       
                                       
                                          
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             b
                                          
                                       
                                    
                                 
                              
                           
                        Here Σ
                           o
                         and Σ
                           b
                         are variances inside and outside the curve 
                           
                              
                                 
                                    c
                                 
                                 
                                    ˆ
                                 
                              
                           
                        , and are given by
                           
                              (6)
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             R
                                          
                                       
                                       (
                                       I
                                       (
                                       x
                                       )
                                       -
                                       
                                          
                                             μ
                                          
                                          
                                             o
                                          
                                       
                                       
                                          
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       d
                                       Ω
                                    
                                    
                                       
                                          ∫
                                          
                                             R
                                          
                                       
                                       d
                                       Ω
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       Σ
                                    
                                    
                                       b
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   c
                                                
                                             
                                          
                                       
                                       (
                                       I
                                       (
                                       x
                                       )
                                       -
                                       
                                          
                                             μ
                                          
                                          
                                             b
                                          
                                       
                                       
                                          
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       d
                                       Ω
                                    
                                    
                                       
                                          ∫
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   c
                                                
                                             
                                          
                                       
                                       d
                                       Ω
                                    
                                 
                              
                           
                        where
                           
                              (7)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             R
                                          
                                       
                                       I
                                       (
                                       x
                                       )
                                       d
                                       Ω
                                    
                                    
                                       
                                          ∫
                                          
                                             R
                                          
                                       
                                       d
                                       Ω
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   c
                                                
                                             
                                          
                                       
                                       I
                                       (
                                       x
                                       )
                                       d
                                       Ω
                                    
                                    
                                       
                                          ∫
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   c
                                                
                                             
                                          
                                       
                                       d
                                       Ω
                                    
                                 
                              
                           
                        For gray-scale images, μ
                        o/b and Σo/b are scalars and for color images, 
                           
                              
                                 
                                    μ
                                 
                                 
                                    o
                                    /
                                    b
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    o
                                    /
                                    b
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                    ×
                                    3
                                 
                              
                           
                         are vectors and matrices. Note that r
                        
                           o
                         and r
                        
                           b
                         can be chosen as various forms describing the region properties of the pixels located inside and outside the curve (e.g., mean intensities [46], distinct Gaussian densities [47], and generalized histograms [48]). As seen above, r
                        
                           o
                         and r
                        
                           b
                         are chosen to be the region based functional of [47].

Let 
                           
                              
                                 
                                    X
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                         be the coordinates of points on S
                        0 where S
                        0 is the identical reference surface in 3D. By the rigid transformation g
                        ∈
                        SE(3), one can locate S in the camera referential by S
                        =
                        g(S
                        0). Written in a point wise fashion yields X
                        =
                        g(X
                        0)=
                        RX
                        0
                        +
                        T with R
                        ∈
                        SO(3) denoting the rotational group and 
                           
                              T
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                         representing translations. Here, 3D pose motions are represented by a set of six parameters. The parameters of the rigid motion g will be denoted by λ
                        =[λ
                        1, …, λ
                        6]
                           T
                        
                        =[t
                        
                           x
                        , t
                        
                           y
                        , t
                        
                           z
                        , ω
                        
                           x
                        , ω
                        
                           y
                        , ω
                        
                           z
                        ]
                           T
                        . Rotations are represented in exponential coordinates, which is a more compact form than using quaternion (4 entries) or basic rotation matrices in three dimensions (12 entries); see [5]. Now, since we assume that the 3D shape of the rigid object is known, our objective is to minimize energy E in Eq. (4) by exploring only the regions R and R
                        
                           c
                         that result from projecting the surface S onto the image plane. For a calibrated camera, these regions are functions of the transformation g only. Solving for the transformation that minimizes E can be undertaken via gradient descent over the parameters λ. This is described next.

The partial differentials of E with respect to the pose parameters λ
                        
                           i
                        ’s can be computed using the chain-rule:
                           
                              (8)
                              
                                 
                                    
                                       ∂
                                       E
                                    
                                    
                                       ∂
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 I
                                 (
                                 x
                                 )
                                 )
                                 -
                                 
                                    
                                       r
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 I
                                 (
                                 x
                                 )
                                 )
                                 )
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                                 +
                                 
                                    ∫
                                    
                                       R
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      o
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                ∂
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             R
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      b
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                ∂
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 d
                                 Ω
                              
                           
                        where 
                           
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                           
                         is the arc-length parameterization of the silhouette 
                           
                              
                                 
                                    c
                                 
                                 
                                    ˆ
                                 
                              
                           
                         and 
                           
                              
                                 
                                    n
                                 
                                 
                                    ˆ
                                 
                              
                           
                         is the (outward) normal to the curve at x.

Using the arc-length s of C and 
                           
                              J
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                -
                                                1
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        , one has
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ,
                                          J
                                          
                                             
                                                ∂
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                π
                                                (
                                                C
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ,
                                          J
                                          
                                             
                                                ∂
                                                π
                                                (
                                                C
                                                )
                                             
                                             
                                                ∂
                                                s
                                             
                                          
                                       
                                    
                                 
                                 ds
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                X
                                             
                                             
                                                ∂
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            Z
                                                         
                                                         
                                                            -
                                                            Y
                                                         
                                                      
                                                      
                                                         
                                                            -
                                                            Z
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            X
                                                         
                                                      
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            -
                                                            X
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∂
                                                X
                                             
                                             
                                                ∂
                                                s
                                             
                                          
                                       
                                    
                                 
                                 ds
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                X
                                             
                                             
                                                ∂
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                ∂
                                                X
                                             
                                             
                                                ∂
                                                s
                                             
                                          
                                          ×
                                          X
                                       
                                    
                                 
                                 ds
                                 =
                                 
                                    
                                       ‖
                                       X
                                       ‖
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   κ
                                                
                                                
                                                   X
                                                
                                             
                                             
                                                
                                                   κ
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             K
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                X
                                             
                                             
                                                ∂
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ,
                                          N
                                       
                                    
                                 
                                 ds
                              
                           
                        where K denotes the Gaussian curvature, and κ
                        
                           X
                         and κ
                        
                           t
                         denote the normal curvatures in the directions X and t, respectively, where t is the vector tangent to the curve C at the point X, i.e. 
                           
                              t
                              =
                              
                                 
                                    ∂
                                    X
                                 
                                 
                                    ∂
                                    s
                                 
                              
                           
                        . Note that the last two terms in Eq. (8) collapse due to the choice of the r
                        
                           o
                         and r
                        
                           b
                         in Eq. (5). Now we have the following gradient descent flow (see [13] for detailed computation):
                           
                              (10)
                              
                                 
                                    
                                       ∂
                                       E
                                    
                                    
                                       ∂
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       C
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 I
                                 (
                                 π
                                 (
                                 X
                                 )
                                 )
                                 )
                                 -
                                 
                                    
                                       r
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 I
                                 (
                                 π
                                 (
                                 X
                                 )
                                 )
                                 )
                                 )
                                 ·
                                 
                                    
                                       ‖
                                       X
                                       ‖
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   κ
                                                
                                                
                                                   X
                                                
                                             
                                             
                                                
                                                   κ
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             K
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                X
                                             
                                             
                                                ∂
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ,
                                          N
                                       
                                    
                                 
                                 ds
                              
                           
                        where the term 
                           
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             X
                                          
                                          
                                             ∂
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       ,
                                       N
                                    
                                 
                              
                           
                         can be computed for the evolution of the pose parameter λ
                        
                           i
                         which is a translation parameter (i
                        =1, 2, 3) or a rotation parameter (i
                        =4, 5, 6):
                           
                              •
                              For a translation parameter,
                                    
                                       (11)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         X
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   N
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               RX
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         +
                                                         T
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   N
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         T
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   N
                                                
                                             
                                          
                                          =
                                          
                                             
                                                N
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 where the Kronecker symbol δ
                                 
                                    i,j
                                  was used (δ
                                 
                                    i,j
                                 
                                 =1 if i
                                 =
                                 j, and δ
                                 
                                    i,j
                                 
                                 =0 otherwise) and T
                                 =[t
                                 
                                    x
                                 , t
                                 
                                    y
                                 , t
                                 
                                    z
                                 ]
                                    T
                                 
                                 =[λ
                                 1, λ
                                 2, λ
                                 3]
                                    T
                                 .

For a rotation parameter,
                                    
                                       (12)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         X
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   N
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               RX
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   N
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   exp
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              -
                                                                              
                                                                                 
                                                                                    λ
                                                                                 
                                                                                 
                                                                                    6
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    λ
                                                                                 
                                                                                 
                                                                                    5
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    λ
                                                                                 
                                                                                 
                                                                                    6
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                           
                                                                              -
                                                                              
                                                                                 
                                                                                    λ
                                                                                 
                                                                                 
                                                                                    4
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              -
                                                                              
                                                                                 
                                                                                    λ
                                                                                 
                                                                                 
                                                                                    5
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    λ
                                                                                 
                                                                                 
                                                                                    4
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     0
                                                                  
                                                                  
                                                                     -
                                                                     
                                                                        
                                                                           δ
                                                                        
                                                                        
                                                                           6
                                                                           ,
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           δ
                                                                        
                                                                        
                                                                           5
                                                                           ,
                                                                           j
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           δ
                                                                        
                                                                        
                                                                           6
                                                                           ,
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     0
                                                                  
                                                                  
                                                                     -
                                                                     
                                                                        
                                                                           δ
                                                                        
                                                                        
                                                                           4
                                                                           ,
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     -
                                                                     
                                                                        
                                                                           δ
                                                                        
                                                                        
                                                                           5
                                                                           ,
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           δ
                                                                        
                                                                        
                                                                           4
                                                                           ,
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   N
                                                
                                             
                                          
                                       
                                    
                                 
                              

@&#PROPOSED METHOD@&#

In what follows, the location of the object can be characterized by the translation and rotation parameters of a rigid transformation. Thus, the (hidden) variable or state s
                        
                           t
                         that we want to estimate are the pose parameters at time t and is given by
                           
                              (13)
                              
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      W
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        Here, the translation and rotation vectors are T
                        =[t
                        
                           x
                        , t
                        
                           y
                        , t
                        
                           z
                        ]
                           T
                         and W
                        =[ω
                        
                           x
                        , ω
                        
                           y
                        , ω
                        
                           z
                        ]
                           T
                        , respectively. We should mention that many 2D visual tracking schemes involving elastic deformations of the target have a theoretically infinite dimensional state space [49,50]. In contrast, the state variable describing the (perceived) deformation in the 2D domain can now be succinctly represented via a finite set in the 3D space. Note that this only holds for the particular but general case of tracking rigid objects. Lastly, when a new image I
                        
                           t
                         arrives at time t, we obtain an observation z
                        
                           t
                        .

As mentioned previously, it is important to carefully utilize system dynamics in order for a given tracking algorithm to converge to the correct optimum. One may choose a random walk model for the state transition equation. However, since this model is usually only practical with a sufficiently large number of samples in a particle filtering framework, we chose instead to employ a first-order autoregressive (AR) model [1] for the state dynamics. We perform the propagation of translation and rotation parameters in a decoupled manner. Consequently, the system dynamics for predicting pose parameters, 
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              [
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                        , is given by:
                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   T
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             A
                                             (
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   T
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   u
                                                
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   W
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   u
                                                
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        T
                        
                           t−1 and W
                        
                           t−1 are the translation and rotation vectors at time t
                        −1, respectively. The rotation matrix R for each particle 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                 
                              
                           
                         can be computed by 
                           
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              =
                              exp
                              (
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              )
                              ·
                              
                                 
                                    R
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                         where exp(·) denotes the matrix exponential [5] and A is the AR process parameter. The noise model 
                           
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                         is defined as:
                           
                              (15)
                              
                                 
                                    
                                       u
                                    
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 ∼
                                 N
                                 (
                                 0
                                 ,
                                 ρ
                                 ·
                                 
                                    
                                       e
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              N
                              (
                              ·
                              )
                           
                         represents the normal distribution and ρ is a user-defined diffusion weight. Moreover, a motion alignment error 
                           
                              
                                 
                                    e
                                 
                                 
                                    t
                                    -
                                    1
                                 
                                 
                                    i
                                 
                              
                           
                         for each particle 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                 
                              
                           
                         is obtained from the predicted and measured states at time t
                        −1, i.e.,
                           
                              (16)
                              
                                 
                                    
                                       e
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              =
                              [
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ]
                           
                         is the measured state vector at time t
                        −1. Here, it is noted that the proposed decoupled methodology not only provides flexibility in designing the state dynamics of the system, but it also allows us to differently deal with the translational and rotational equations in (14) by controlling the diffusion weight. For example, since an orientation space is wrapped on itself and angles behave linearly within small angle approximation [51], we apply a small perturbation to only the rotational dynamics without affecting the translation equation because of the decoupling.

Now, inspired by [41], we define the bandwidth 
                           
                              
                                 
                                    b
                                 
                                 
                                    t
                                    -
                                    1
                                 
                                 
                                    i
                                 
                              
                           
                         for each particle as the combination of the diffusion weight ρ and the motion alignment error 
                           
                              
                                 
                                    e
                                 
                                 
                                    t
                                    -
                                    1
                                 
                                 
                                    i
                                 
                              
                           
                        . That is, 
                           
                              
                                 
                                    b
                                 
                                 
                                    t
                                    -
                                    1
                                 
                                 
                                    i
                                 
                              
                              =
                              ρ
                              ·
                              
                                 
                                    e
                                 
                                 
                                    t
                                    -
                                    1
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                        . Then the process noise can be represented by a multivariate Gaussian distribution based on the bandwidth term, 
                           
                              
                                 
                                    b
                                 
                                 
                                    t
                                    -
                                    1
                                 
                                 
                                    i
                                 
                              
                           
                        :
                           
                              (17)
                              
                                 
                                    
                                       u
                                    
                                    
                                       t
                                    
                                 
                                 ∼
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       (
                                       2
                                       π
                                       
                                          
                                             )
                                          
                                          
                                             N
                                             /
                                             2
                                          
                                       
                                       |
                                       
                                          
                                             b
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             1
                                             /
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

From the Eq. (17) above, one can see that the particles are driven by the bandwidth term in an online fashion and diffuse in the direction of motion of the object. Next, we discuss the measurement model.

Now we specify the measurement function h(·) for the observed image I
                        
                           t
                         at time t as follows: First, we carry out l-iterations of gradient descent flow in Eq. (10) for each particle 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                 
                              
                           
                        . Here, it should be noted that the choice of l is carefully considered to avoid sample degeneracy and sample impoverishment (see [31] for details). If the tracker reaches a local minimum of the objective functional in Eq. (4) with too large l, the state at time t would lose the temporal coherency with the state at time t
                        −1 (sample degeneracy). On the other hand, if l is selected to be too small, most particles would not move to the region of high likelihood (sample impoverishment). While the authors in [31,41] use a l-iteration scheme for their resampling algorithm, l is experimentally chosen based on the imagery and the type of local optimizer used. In the present work, contrary to previous works, the number of l is dynamically chosen online according to the degree of occlusion and object’s movement. This will be described in Section 3.4.

Next, we assign and update the importance weights associated for each particle. This is done by employing a transitional prior density as the proposal distribution [52]. In doing so, the weight update equation is 
                           
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    t
                                    -
                                    1
                                 
                                 
                                    i
                                 
                              
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    s
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         where the likelihood of the observation is defined as:
                           
                              (18)
                              
                                 p
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       E
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             W
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             I
                                          
                                          
                                             t
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

Lastly, we obtain the measurement for time t. That is, the pose parameters with the minimum energy are taken as the measurement pose. Thus, the projected silhouette is the best fitting curve which makes its interior and exterior statistical properties be maximally different in a 2D image domain (i.e., it minimizes the region-based energy in Eq. (4)).

The presence of occlusions generally hinders tracking algorithms from continuously tracking an object of interest. Occlusion detection is a necessary task before performing occlusion handling. In [35], the authors detect an occlusion using the relative change of the object’s size compared to the average object’s size as well as the distance between the object and an obstacle. However, this method may give ambiguous results if an object’s size changes due to camera zooming. Here, we propose a histogram based occlusion detection technique, which is performed by checking the variation of the histogram of the object during tracking. To do this, we define an appearance model as a normalized histogram h. For color-based imagery, a histogram is calculated by the mean of color intensities (in RGB spaces) for pixels inside 
                           
                              
                                 
                                    c
                                 
                                 
                                    ˆ
                                 
                              
                           
                        . Here, the RGB color space is normalized to remove the effect of intensity variations. Note that better performance could be expected if one uses other color spaces or image feature descriptors such as HSV, m
                        1
                        m
                        2
                        m
                        3 spaces [53], spatiograms [54], and HOG (histograms of oriented gradients) [55]. However, we chose the normalized histogram in the normalized RGB space to construct the appearance model due to their simplicity and usability.

The evaluation of the histogram change is achieved by computing the Bhattacharyya coefficient between two appearance models of the current silhouette curve and of the template model. The template model can be obtained from the initial curve of the first segmentation of the given sequence. The Bhattacharyya distance [56] between two probability density functions (pdfs), p
                        1 and p
                        2, is defined by:
                           
                              (19)
                              
                                 
                                    
                                       D
                                    
                                    
                                       B
                                    
                                 
                                 =
                                 -
                                 log
                                 
                                    
                                       
                                          
                                             ∫
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                x
                                                )
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                x
                                                )
                                             
                                          
                                          d
                                          x
                                       
                                    
                                 
                              
                           
                        Considering discrete densities, such as h
                        
                           t
                        (b) and h
                        
                           template
                        (b), the Bhattacharyya coefficient is defined as:
                           
                              (20)
                              
                                 β
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          b
                                          ∈
                                          R
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       b
                                       )
                                       
                                          
                                             h
                                          
                                          
                                             template
                                          
                                       
                                       (
                                       b
                                       )
                                    
                                 
                              
                           
                        where h
                        
                           t
                        (b) and h
                        
                           template
                        (b), with 
                           
                              b
                              ∈
                              R
                           
                        , are appearance models of the curve 
                           
                              
                                 
                                    c
                                 
                                 
                                    ˆ
                                 
                              
                           
                         at time t and of a template model, respectively. The Bhattacharyya coefficient β varies between 0 and 1 (0 indicates complete mismatch and 1 is a perfect match). Small β indicates that another object has occluded the target being tracked because statistical information inside the tracked object is changed. Thus, in this work, the Bhattacharyya coefficient β is used as the appearance similarity measure between two histograms. Unfortunately, the template model can be influenced by illumination changes and geometric variations as well as through camera angle differences even though no occlusion occurs. To cover the undesired appearance changes, we should periodically update the template model according to the degree of histogram variations between frames. More specifically, if the histogram of the target is changing slowly over time, the template model is updated as the new histogram of the segmented object at a current frame and is preserved otherwise. The update condition for the template model is defined as
                           
                              (21)
                              
                                 β
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       template
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       (
                                       t
                                       -
                                       1
                                       )
                                       
                                          
                                             t
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 )
                                 >
                                 
                                    
                                       β
                                    
                                    
                                       th
                                    
                                 
                                 ,
                                 
                                 (
                                 t
                                 >
                                 1
                                 )
                              
                           
                        where β
                        
                           th
                         is a positive threshold between 0 and 1. The value t
                        
                           d
                         is the user-defined checking interval. Note that the interval for checking should be set large enough because the histogram variance between consecutive frames is generally small even though the occlusion occurs. This approach allows the tracker to keep the histogram of the template model until the sequence finishes. In this work, β
                        
                           th
                         and t
                        
                           d
                         are experimentally selected as [0.7, 0.8] and [10, 20], respectively.

Now, we elucidate the proposed occlusion handling scheme. Recently, region-based pose tracking of [57] deal with occlusions by introducing the visibility function and background manipulation. These methods are used to exclude the occluded points from the interior region of the tracked object and to simplify background region, respectively, in estimating probability density functions (pdfs) for interior and exterior regions of the tracked object and an obstacle. Contrary to the work of [57], in this paper, we propose a method for occlusion handling without manipulating computation of each probability density function (pdf) inside and outside the object. Instead, we follow the underlying concept of Bayesian estimation in the context of visual tracking. The basic idea of occlusion handling for this paper is regularization between the measurement and prediction model of the system. To do this, l-iterations of gradient descent of the objective functional in Eq. (10) is dynamically adjusted in an online manner. Not only is this l-iteration scheme used to resample the particles in Section 3.3, but also it can be interpreted as a function of the Kalman gain in a Kalman filtering like framework. In other words, one can view this parameter as the amount of confidence in the system model with respect to the current measurements [37]. For example, if the object being tracked is not observed appropriately during occlusion, then the degree of trust of the measurement model is reduced. Thus, we should only employ a few iterations within the measurement model so that the method depends more on the prediction model to maintain the track. On the other hand, if one can completely trust the obtained measurement (e.g., the observed image shows a smooth object movement without occlusions), the number of l should be assigned to be relatively large.

While the method proposed is similar to that of [37], a key difference is that we dynamically choose the number of l-iterations online based on both the degree of occlusion (or severity) and the degree of the object’s motion displacement as opposed to an experimental fixed choice of l. In addition, the degree of object’s pose variation is obtained from using the accumulated history of the object’s location; translation and rotation vectors
                           
                              (22)
                              
                                 ν
                                 =
                                 1
                                 -
                                 exp
                                 {
                                 -
                                 var
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       (
                                       t
                                       -
                                       
                                          
                                             t
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       :
                                       t
                                    
                                 
                                 )
                                 }
                              
                           
                        where var(·) is variance of the given variable and the checking interval, t
                        
                           d
                        , indicates how many previous states are used. If the variation of the location over the previous frames is large, we infer that the object is moving during the sequence and l is maintained so that the tracker is able to follow the object’s movement as much as possible.

Now the adjustment parameter γ is computed and the number of l-iterations is assigned online as follows:
                           
                              (23)
                              
                                 γ
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 β
                                 +
                                 ν
                                 )
                                 ,
                                 
                                 l
                                 =
                                 
                                    
                                       l
                                    
                                    
                                       max
                                    
                                 
                                 ·
                                 γ
                              
                           
                        where l
                        
                           max
                         is a maximum allowance iteration number of l. This can also be viewed as a boundary and initial condition of l.

The overview of the proposed occlusion handling scheme is illustrated in Fig. 1
                        . Here, if the occlusion is detected, the adjustment parameter γ decreases according to the displacement variation ν and appearance similarity parameter β. Consequently, it reduces the number of l-iterations of the gradient descent flow. This approach eventually overcomes occlusions in the course of tracking due to the fact that it makes the algorithm depend more on the prediction model in challenging situations.

An overview of the proposed system for 2D–3D object tracking using the particle filtering framework is now described.
                           
                              1.
                              Initialization Step:
                                    
                                       (a)
                                       Initialize state, s
                                          
                                             t
                                          , at t
                                          =0 by using 2D segmentation and 3D pose estimation method introduced in [13] in the first frame of the given sequence.

Obtain the template appearance model, h
                                          
                                             template
                                          (x), at t
                                          =0 from the initial segmented curve in a 2D image plane.

Prediction Step:
                                    
                                       (a)
                                       Generate N transformation parameters, 
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        s
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          , around 
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           by Eq. (14):
                                             
                                                
                                                   
                                                      
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           T
                                                                        
                                                                        
                                                                           ^
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               =
                                                               
                                                                  
                                                                     T
                                                                  
                                                                  
                                                                     t
                                                                     -
                                                                     1
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               +
                                                               A
                                                               (
                                                               
                                                                  
                                                                     
                                                                        
                                                                           T
                                                                        
                                                                        
                                                                           ^
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     t
                                                                     -
                                                                     1
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     T
                                                                  
                                                                  
                                                                     t
                                                                     -
                                                                     1
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               )
                                                               +
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           W
                                                                        
                                                                        
                                                                           ^
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               =
                                                               
                                                                  
                                                                     W
                                                                  
                                                                  
                                                                     t
                                                                     -
                                                                     1
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       

Update Step:
                                    
                                       (a)
                                       Perform l-iterations of the gradient descent flow in Eq. (10) on each generated parameter, 
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        s
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          .

Calculate the importance weights from Eq. (18):
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         -
                                                         E
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              T
                                                                           
                                                                           
                                                                              ^
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              W
                                                                           
                                                                           
                                                                              ^
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          and normalize:
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     ̃
                                                                  
                                                               
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  N
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     ̃
                                                                  
                                                               
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       

Represent the posterior distribution of the system by a set of weighted particles: 
                                             
                                                p
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                   
                                                
                                                |
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                      :
                                                      t
                                                   
                                                
                                                )
                                                =
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                                δ
                                                
                                                   
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          .

Resample N particles according to p(s
                                          
                                             t
                                          ∣z
                                          1:t
                                          ) by using the generic re-sampling scheme introduced in [52]. Note that 
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        s
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                      …
                                                      N
                                                   
                                                
                                             
                                           denote resampled particles.

Adjustment Step:
                                    
                                       (a)
                                       Estimate state, s
                                          
                                             t
                                          , using the mean state of the set 
                                             
                                                
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           and the measurement state 
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                           as follows:
                                             
                                                (24)
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   γ
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   +
                                                   (
                                                   1
                                                   -
                                                   γ
                                                   )
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  N
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     N
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        s
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       

Update the template appearance model, h
                                          
                                             template
                                          , by the condition in Eq. (21) and compute the appearance similarity measure, β(h
                                          
                                             t
                                          , h
                                          
                                             template
                                          ).

Compute the adjustment parameter γ and assign the number of l by Eq. (23).

@&#EXPERIMENTS@&#

Various synthetic and real sequences of different rigid objects were used to demonstrate the robustness of the proposed method to noise, cluttered environments, as well as the algorithm’s ability to cope with partial occlusions and imperfect information. 3D models
                        1
                        All 3D models for rigid objects were acquired from the method presented by Yezzi and Soatto [58,59].
                     
                     
                        1
                      used in this paper consist of an elephant, a car, and a helicopter as shown in Fig. 2
                     . In this section, we provide qualitative and quantitative results of various tracking scenarios including a comparison to the algorithms presented in [13,40]. In particular, in the quantitative experiments, two quantitative results regarding the robustness to noise and occlusion of the proposed method are provided on synthetic data. We also should note that because code of other joint 2D–3D pose estimation/segmentation algorithms were not readily available, our experiments are focused on highlighting the advantages and limitations of exploiting dynamics in visual tracking. However, before doing so, we briefly mention some numerical details associated with the experiments performed.

Implementation details: In these experiments, the parameters used were held fixed across all sequences. Specifically, the value of maximum l-iteration, l
                     
                        max
                     , was selected within [20, 30]. Its range is chosen by depending on the objective functional used and its step-size (e.g. here, the gradient descent flow in Eq. (10)). The number of particles N
                     =40 was empirically chosen to provide good performance without significant computational burden. Note that the setting of minimal amount of samples (N
                     =40) can be realized by embedding the gradient descent flow into measurement function proposed in Section 3.3. Using this scheme allows the particle filtering framework to rely on a small number of particles as opposed to the conventional CONDENSATION filter [60]. Note, this setup is also used for exploration of shape deformation [31] and point set registration [41]. Overall, using un-optimized code for the proposed method shows acceptable performance with computation time of approximately 10s per frame on a 3.6GHz Windows machine with 2GB of RAM. For reference, the running times for the methods of [13,40] were about 0.4 and about 20s per frame on the same system, respectively.

In this subsection, first of all, we show quantitative results regarding the robustness of the proposed method to noise on synthetic data. In generating the synthetic data, we first construct a basic elephant sequence, and then add several diverse noise levels of Gaussian noise whose variance ranges from 
                           
                              
                                 
                                    σ
                                 
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                              %
                           
                         to 
                           
                              
                                 
                                    σ
                                 
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              =
                              100
                              %
                           
                        . The sequences (and results) can be seen in Fig. 3
                        . The translation and rotation parameters linearly increase and decrease throughout the sequences of 200 frames to produce a large variation for the aspect of the object. The size of the sequence images is 242×322. To quantitatively evaluate the tracking results, percent (%)-absolute errors are computed for both translation and rotation over each level of noise sequences:
                           
                              (25)
                              
                                 %
                                 -
                                 absolute
                                 
                                 error
                                 =
                                 
                                    
                                       ‖
                                       
                                          
                                             v
                                          
                                          
                                             measured
                                          
                                       
                                       -
                                       
                                          
                                             v
                                          
                                          
                                             truth
                                          
                                       
                                       ‖
                                    
                                    
                                       ‖
                                       
                                          
                                             v
                                          
                                          
                                             truth
                                          
                                       
                                       ‖
                                    
                                 
                                 ×
                                 100
                              
                           
                        where v
                        measured and v
                        truth are measured and ground-truth of translation and rotation vectors, respectively. Table 1
                         displays average and standard deviation errors of position and rotation of the results from the sequences in Fig. 3. As the noise level increases, the average and standard deviation errors also increase. This is due to the probability of encountering unexpected local minima will also increase given that it is now harder to distinguish the object of interest from the background. However, tracking is still maintained throughout the entirety of each sequence and the tracking errors did not exceed above 3% and 5% for translation and rotation, respectively. Note that the elephant and backgrounds are barely visibly distinguishable in the sequence of noise level 
                           
                              
                                 
                                    σ
                                 
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              =
                              100
                              %
                           
                        .


                        Fig. 4
                         shows several sequences capturing the drastic changes of an object’s pose in a cluttered background. Despite the cluttered background and significant changes of pose, successful tracking results were obtained. The sequence in Fig. 4a is comprised of 1350 frames, while Fig. 4b contains 470 frames. For the sequence shown in Fig. 4c, there are 450 frames available to track. In Figs. 4a and 4b, the red car and the gray elephant are observed under a dynamically moving camera. The elephant is manually moved by a hand as one can see in Fig. 4c. Thus, the corresponding pose of all the objects tested is altered significantly over the various sequences. Nevertheless, the proposed algorithm yields satisfactory tracking results. In particular, the hand holding the elephant partially occludes the elephant in Fig. 4c. However, in this case, since the hand has the similar color to the elephant, it does not have much effect on the statistical property of the elephant, and the track of the elephant is successfully maintained. In the next subsection, we demonstrate the ability of the proposed occlusion handling scheme to deal with partial occlusions and imperfect information in the scenarios including the occlusions that contain a statistically different intensity from that of the object of interest.

In contrast to the previous sequences, the scenarios in this subsection not only include dynamic changes of an object’s pose, but other objects (such as markers, staples, and a dark elephant), which occlude the object of interest, and provide an added difficulty to the overall tracking problem. Moreover, this subsection demonstrates how the proposed method outperformed the approaches of [13,40] in dealing with occlusion handling.

First, to provide quantitative results regarding the robustness of the proposed method in handling occlusions, we generate set of synthetic sequences, in which an obstacle bar exhibiting different levels of gray-scale intensity is added. In these sequences, Gaussian noise with zero mean and variance of 
                           
                              
                                 
                                    σ
                                 
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                              %
                           
                         was added to a binary image of the toy elephant. From a tracking viewpoint, the bar prevents many algorithms, which rely only on image and shape information, from successfully maintaining track of the object. Specifically, we vary the brightness level of the bar from 0.1 to 0.9 where 0 denotes black and 1 denotes white. The results are shown in Fig. 5
                        . In Fig. 5, when the brightness level of the bar is less than 0.5, the methods in [13,40] lose the track, but the proposed tracking algorithm maintains track over the generated sequences. The average values of translation and rotation errors are measured by Eq. (25) and are displayed in Table 2
                        . The table shows the improvement of the proposed method for occlusion handling compared to the methods in [13,40]. More detailed comparison of the proposed algorithms with the methods of [13,40] is discussed in the next experiments on real sequences.


                        Figs. 6 and 7
                        
                         show a red marker (vertically held by a hand) and a white marker (horizontally held by a hand) that pass by the gray elephant from right to left in a cluttered background, respectively. We should mention that the algorithms in [13] works well with the occlusions that are similar in nature to that of the interested object; see Fig. 5. However, due to the fact that the occlusion contains a statistically different intensity from that of the object of interest, the methods in [13] is not able to maintain track as shown in Figs. 6 and 7. Specifically, utilizing only the gradient descent flow presented in Eq. (10), the movement of the marker acts as if it pushes or blows the silhouette curve off of the elephant. This is simply due to the statistical difference between the object and the occlusion. That is, if one were to look at Eq. (10) from a robust statistics point of view, the flow regarding the integration about the occluding curve excludes the possible points on the white marker because they are viewed as outliers. In turn, one cannot properly estimate the 3D pose or maintain track. However, if one exploits the underlying dynamics as done in the proposed algorithm, one achieves a more robust result.

Compared to the sequences of Figs. 6 and 7, Figs. 8 and 9
                        
                         show sequences with moving objects and static occlusions. Fig. 8 shows a white car is moved by a narrow stick and it is occluded by a black elephant while moving. In this sequence, the black board was used as a means for a clutter-free background such that tracking would be not affected from other possible clutter. As shown in Fig. 8a, the tracker in [13] yields unsatisfactory results in tracking the car while the proposed tracker successfully maintains track. In Fig. 9, the helicopter is manually moved throughout several set of staples that are positioned at different heights. While the tracker in [13] fails after the helicopter passes by the second set of staples, the proposed tracker overcomes the continual occlusions and maintains track of the pose of the helicopter as shown in Fig. 9a.

It is interesting to note that the tracker of [40] eventually lost track of the targets (the white car and the yellow helicopter) and got trapped in a local minimum as shown in Figs. 8b and 9b, respectively, even though it continuously estimated the pose of the elephant in the presence of occlusions (i.e., the red or white markers) in Figs. 6 and 7. These results show that the approach of [40] is more vulnerable to occlusions when it tracks a moving object than a stationary object. This is because the work of [40] disregards control of predictions and measurements of the system, which was taken into account in the present occlusion handling scheme. In addition, in the proposed method, in contrast to the work of [40], the separately distributed samples of pose parameters and the embedded variational technique aid the tracker in finding the optimum in a filtering distribution.

@&#CONCLUSION@&#

In this paper, we proposed a robust algorithm for 2D visual tracking and 3D pose estimation using particle filters. In particular, the degree of trust between predictions and measurements of the system is dynamically controlled in an online fashion to provide the reliable occlusion handling regardless of occlusions of an obstacle whose statistical properties are significantly different from those of the object of interest. The resulting methodology was shown to improve tracking performance in continuously locating the target even in the presence of noise, clutter, and occlusions during tracking in several challenging experiments.

The proposed method has some limitations that we intend to investigate in our future work. First of all, the overall algorithm is computationally expensive despite the benefits described in Section 3.3. In addition, our approach could lose the track for non-rigid objects. One possible solution is to incorporate knowledge of multiple 3D shapes as shown in [61]. In other words, for a successful non-rigid tracking framework one should include not only filtering of the pose parameters, but also the shape parameters. This approach would hopefully allow one to track a non-rigid objects of interest in some important scenarios. Moreover, for a number of practical applications, since it is impossible to always know the prior knowledge of the object’s shape before using the proposed algorithms, automatic construction of a 3D shape prior is an important task. This may be accomplished, for example, by collecting information about the object from available 3D shape dictionaries or repositories.

@&#ACKNOWLEDGMENTS@&#

This work was supported in part by grants from NIH, AFOSR, ARO, ONR, and MDA. This work is part of the National Alliance for Medical Image Computing (NA-MIC), funded by the National Institutes of Health through the NIH Roadmap for Medical Research, Grant U54 EB005149. Information on the National Centers for Biomedical Computing can be obtained from http://nihroadmap.nih.gov/bioinformatics. Finally, this project was supported by grants from the National Center for Research Resources (P41-RR-013218) and the National Institute of Biomedical Imaging and Bioengineering (P41-EB-015902) of the National Institutes of Health.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.cviu.2013.04.002.


                     
                        
                           Supplementary video 1
                           
                        
                     
                  


                     
                        
                           Supplementary video 2
                           
                        
                     
                  


                     
                        
                           Supplementary video 3
                           
                        
                     
                  


                     
                        
                           Supplementary video 4
                           
                        
                     
                  


                     
                        
                           Supplementary video 5
                           
                        
                     
                  


                     
                        
                           Supplementary video 6
                           
                        
                     
                  

@&#REFERENCES@&#

