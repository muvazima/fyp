@&#MAIN-TITLE@&#Application of Shearlet transform to classification of surface defects for metals

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We developed a method called DST-KLPP which is effective in classification of surface defects of different metals.


                        
                        
                           
                           DST-KLPP was tested with samples of three typical metals, including slabs, hot-rolled steels and aluminum sheets.


                        
                        
                           
                           DST-KLPP provides higher classification rates than other methods, including Wavelet, Curvelet and Contourlet transform.


                        
                        
                           
                           DST-KLPP can recognize defects from complex backgrounds efficiently.


                        
                        
                           
                           DST-KLPP can recognize tiny defects from low-contrast images availably.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Surface inspection

Feature extraction

Multi-scale geometric analysis

Shearlet transform

Kernel Locality Preserving Projections

@&#ABSTRACT@&#


               
               
                  Surface defects are important factors of surface quality of industrial products. Most of the traditional machine vision based methods for surface defect recognition have some shortcomings such as low detection rate of defects and high rate of false alarms. Different types of defects have special information at some directions and scales of their images, while the traditional methods of feature extraction, such as Wavelet transform, are unable to get the information at all directions. In this study, Shearlet transform is introduced to provide efficient multi-scale directional representation, and a general framework has been developed to analyze and represent surface defect images with anisotropic information. The metal surface images captured from production lines are decomposed into multiple directional subbands with Shearlet transform, and features are extracted from all subbands and combined into a high-dimensional feature vector. Kernel Locality Preserving Projection is applied to the dimension reduction of the feature vector. The proposed method is tested with the surface images captured from different production lines, and the results show that the classification rates of surface defects of continuous casting slabs, hot-rolled steels, and aluminum sheets are 94.35%, 95.75% and 92.5% respectively.
               
            

@&#INTRODUCTION@&#

Surface quality control is one of the most important issues in metal industry. In recent years, computer vision based surface inspection systems have become the mainstream research. With the characteristics of non-contact and fast response, the systems have been widely used in modern manufacturing fields in order to obtain high-quality products. The inspection systems capture surface images of industrial products with CCD cameras under specific lighting conditions; then various algorithms of image processing are applied to the images, and surface defects are identified and classified using the algorithms for the defect detection and recognition. The algorithms are crucial for the inspection systems.

Recently, various algorithms for the defect detection and classification have been developed for the metal surface inspection systems. For example, an algorithm combined with discrete wavelet transform and morphological analysis was developed to detect corner cracks of steel billets from oxide scales [1]; Gabor filters were used to detect thin and corner cracks in raw steel block by minimizing the cost function of energy separation criteria of defect and defect-free regions [2]; defects of structural steel plates were detected using Discrete Fourier Transform Spectral Energy and Artificial Neural Networks [3]; an approach based on 3D profile data of steel slab surfaces was developed for an automated on-line crack detection system, and morphological image processing and logistic regression based statistical classification were integrated in the system [4]; a framework with multiple views was applied to detecting flaws in aluminum castings, and information gathered from multiple views of the scene was combined for the flaw detection [5]. Although the above methods achieved high detection rates of some defects, they were restricted to some specific products or defects, and classification rates of common defects were generally limited. There is a real need to develop algorithms for the detection and classification of common defects with wide-ranging versatility.

There are various defects generated by the same or different production lines of metals; the comprehensiveness and universality of the image features associated with the defects are essential to the classification of these defects. More information of images, including those retrieved from different scales and directions, can help improve the comprehensiveness and universality of the image features. The images are usually represented by low-level feature descriptors focusing on different types of information, such as color, texture, and shape [6]. Traditional methods for multi-scale signal analysis, such as Wavelet and Gabor transforms, are extensively applied to image processing applications. However, these methods fail to effectively extract the directional features due to their isotropic support and limited directional sensitivity. Multi-scale geometric analysis (MGA) is proposed to decompose images into different scales and directions [7]. The most common methods of MGA are Curvelet transform [8,9] and Contourlet transform [9,10]. Curvelet transform is not directly constructed in the discrete domain, but the implementation is more involved with less efficiency. Contourlet transform is a combination of a multi-scale and a directional filter bank in the discrete domain, and it has less clear directional features than Curvelet transform. Curvelet transform and Contourlet transform are both non-adaptive methods of MGA, which means that they cannot deal with images directly without information of image edges and contours. Except the non-adaptive methods, there are adaptive methods of MGA, which utilize known geometric information of an image to improve the approximation ability of the image transform. Bandelet transform is a major adaptive method of MGA [12,13]. Compared with Curvelet transform and Contourlet transform, Bandelet transform not only has the characteristics of multi-scale analysis, time-frequency localization, directionality and anisotropy, but also offers particular properties of strict sampling and adaptability which are very important for image representation. However, Bandelet bases are regular functions with compact support, and the algorithm of searching the best Bandelet basis is very complicated [14].

Shearlet transform is a relatively new method of MGA [15,16]. Compared with other methods of MGA, Shearlet transform can set up different direction numbers at different decomposition scales. Furthermore, Shearlet transform is optimal in approximating 2D smooth functions with discontinuities along C2-curves, and it yields nearly optimal approximation properties. So Shearlet transform is suitable to analyze image textures with complex background.

Kernel Locality Preserving Projections (KLPP) is introduced as a method of dimension reduction. Locality Preserving Projection (LPP) is a well-known dimensionality reduction method, which can project high-dimensional input data into a low-dimensional subspace by linear transformation [17,18]. KLPP is the implementation of LPP in kernel space. Combined with Shearlet transform and KLPP, a feature descriptor called DST-KLPP is proposed in this article. Surface images of metals are decomposed into different scales and directions with Shearlet transform, and KLPP is employed to reduce redundant information and improve the operating efficiency. In order to test the generality and efficiency of the proposed method, sample images acquired from three different production lines were analyzed. Results of the proposed method were compared with the other methods.

The rest of the paper is organized as follows: Section 2 depicts the characteristics of surface images of metals, including the defects and some background information. Section 3 introduces three methods of MGA, which are Curvelet transform, Contourlet transform, and Shearlet transform. Section 4 describes the DST-KLPP method in detail. Experimental results with three typical metal surface images and discussions are presented in Section 5, followed by conclusions in Section 6.

As we know, there are three procedures of metal production, including continuous casting, hot rolling and cold rolling. In each procedure, metals are in different states, and have various defects with different features. In the paper, surface images of continuous casting slabs, hot rolled steels and aluminum sheets are used as samples because they represent three typical defect detection and classification problems to be resolved: 1) surfaces of the continuous casting slabs are very complicated; 2) there are many types of defects with the hot rolled steels; and 3) defects of aluminum sheets are small in size and contrasts of their images are usually low. All these image samples were collected from the production lines with the surface inspection systems developed by the authors [19–21]. Line-scan CCD cameras were used to capture the images with different illuminations. The dimension of the images is 4096 by 1024pixels or 2048 by 1024pixels, depending on the CCD cameras used in the system. However, all sample images are cropped to 128 by 128pixels for image classification. There are noises, non-uniformed lighting effects in the images, which may affect the final results of classification.


                     Fig. 1
                      shows four types of sample images of continuous casting slabs, including cracks, non-uniformed lighting effects, scales and slag marks. Cracks are the genuine defects in the samples of Fig. 1, and the other three types of samples are the pseudo-defects. Cracks are the most common defects and may lead to quality accidents of slabs. However, cracks are very difficult to be detected as non-uniformed lighting effects, scales, and slag marks are sometimes similar to cracks. The most important task of defect detection for continuous casting slabs is to detect cracks from the complicated image backgrounds.

The slabs are inspected immediately after the flame cutting of casting, and the surface temperature is about 1000°C. As demonstrated in Fig. 2
                     , the slabs are illuminated with green linear laser lighting [20]. The wavelength of lasers is 532nm, which is far away from spectrum of high-temperature radiation of slabs. Furthermore, a color filter of narrow band is added to the camera lens, and the central bandwidth of the filter is 532nm. As a result of using the laser lighting and the narrow band filter, most of the high-temperature radiation is filtered out, and only lights of lasers reflected by the slab surface enter into the CCD cameras. Therefore, images with high contrast can be captured from the high-temperature slabs. Three line-scan CCD cameras with 4096pixels are used together to inspect one side of the slab with width of 2500–2800mm, and the scanning width of each camera is 1000mm. So the resolution of image width in Fig. 1 can be calculated as 1000/4096=0.25mm. The resolution of image height, which is the distance between two adjacent lines captured by the CCD camera, must be equal to image width. So the CCD cameras are triggered according to the velocity of the slab detected by a rotator installed with the roller table to keep the distance between two adjacent lines 0.25mm. As the height of an image is 1024pixels, the length of the slab covered by an image is 1024×0.25=256mm. The normal length of a slab is 10m, so the number of images captured by one CCD camera to cover a normal slab is 10,000/256≈40. There are six cameras used together, and the number of images to cover a normal slab is about 40×6=240.


                     Fig. 3
                      shows nine types of image samples of hot rolled steel plates, including transverse scratches (TS), transverse cracks (TC), scar (Sr), pockmarks (Po), chaps (Ch), roll imprints (RI), scales (Sc), longitudinal scratches (LS) and longitudinal cracks (LC). All samples except scales are genuine defects, which will lead to “false detection” as they are always classified as a genuine defect. From Fig. 3, we can see that different types of defects have different geometric characteristics. For examples, the transverse scratches and transverse cracks are extended perpendicular to the direction of rolling, while longitudinal scratches and longitudinal cracks are extended parallel to the direction of rolling. The most important task of defect detection for hot rolled steels is to distinguish between the genuine defects and the scales.

The steel plates are inspected after the hot straightener, and the surface temperature is about 600–800°C. As shown in Fig. 4
                     , the plates are also illuminated with green linear laser lightings [21] so as to remove the high-temperature radiation. Four line-scan CCD cameras of 4096pixels are used together to inspect one side of the plates with a width of 3500–4700mm, and the scanning width of each camera is 1200mm. So the resolution of the image width in Fig. 3 can be calculated as 1200/4096=0.3mm. The resolution of the image height is equal to 0.3mm, and the CCD cameras are also triggered according to the velocity of the steel plate detected by a rotator installed with the roller table to keep the distance between two adjacent lines 0.3mm. As the height of an image is 1024pixels, the length of the steel plate covered by an image is 1024×0.3=307mm. The maximal length of a steel plate is 25m, so the number of images captured by one CCD camera to cover a steel plate with the maximal length is 25,000/307≈81. There are eight cameras used together, and the number of images to cover a steel plate with the maximal length is about 81×8=648.


                     Fig. 5
                      shows eight types of image samples of aluminum sheets, including imprints (Im), scratches (Sc), dents (De), roll marks (RM), wrinkles (Wr), lighting variations (LV), oil stains (OS) and water drops (WD). The first five types in Fig. 5 are genuine defects, while the last three types are pseudo-defects. Imprints and scratches are the most common defects of aluminum sheets. The imprints are very small, and the scratches are very thin. The challenging task of defect detection for aluminum sheets is to detect tiny defects in the images with low contrast.

The aluminum sheets are inspected after the cold straightener, and in the condition of close to room temperature. Different from the inspection of hot-temperature slabs and steel plates, the aluminum sheets are illuminated with white LED lightings [19]. White LED lights provide higher intensity and wider spectral range, which can be used to improve the contrast of small defects in the images. Four line-scan CCD cameras of 2048pixels are used together to inspect one side of the sheets with a width of 1200–1500mm, and the scanning width of each camera is 400mm. So the resolution of the images in Fig. 5 can be calculated as 400/2048=0.2mm. The reason of choosing lower resolution of CCD cameras is that the sensor array used in the CCD camera of 2048pixels has the size of 14μm, while it is 10μm for CCD cameras of 4096pixels. Larger size of sensor array provides higher sensitivity of response to the lights, and improves the contrast of images. The defects in the images shown in Fig. 5 are brighter than the backgrounds as they were captured under dark-field illumination [22] to avoid excessive brightness caused by specular reflection. Unfortunately, excessive brightness is very common in the images of aluminum sheets as the reflection angle varies with the flatness during inspection.

From Fig. 1, Fig. 3 and Fig. 5, it can be seen that most defects have more information in certain directions than in other directions. In addition to the directions, the analysis of defect images at different scales can also produce valuable information.

Curvelet transform is developed on a basis of Ridgelet transform. For any a
                        >0, b
                        ∈
                        R, and θ
                        ∈[0,2π), 2D Ridgelet function ψ
                        
                           a,b,θ
                        (x
                        1,
                        x
                        2):
                        R
                        2
                        →
                        R
                        2 is defined as [23]:
                           
                              (1)
                              
                                 
                                    ψ
                                    
                                       a
                                       ,
                                       b
                                       ,
                                       θ
                                    
                                 
                                 
                                    
                                       x
                                       1
                                    
                                    
                                       x
                                       2
                                    
                                 
                                 =
                                 
                                    a
                                    
                                       −
                                       1
                                       /
                                       2
                                    
                                 
                                 ψ
                                 
                                    
                                       
                                          
                                             
                                                x
                                                1
                                             
                                             cos
                                             θ
                                             +
                                             
                                                x
                                                2
                                             
                                             sin
                                             θ
                                             −
                                             b
                                          
                                       
                                       /
                                       a
                                    
                                 
                              
                           
                        
                     

Then, for 2D function f(x
                        1,
                        x
                        2), continuous Ridgelet transform is defined as:
                           
                              (2)
                              
                                 
                                    R
                                    f
                                 
                                 
                                    a
                                    b
                                    θ
                                 
                                 =
                                 
                                    
                                       ∫
                                       
                                          −
                                          ∞
                                       
                                       
                                          +
                                          ∞
                                       
                                    
                                    
                                       
                                          
                                             ∫
                                             
                                                −
                                                ∞
                                             
                                             
                                                +
                                                ∞
                                             
                                          
                                          
                                             
                                                ψ
                                                
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                       1
                                    
                                    
                                       x
                                       2
                                    
                                 
                                 f
                                 
                                    
                                       x
                                       1
                                    
                                    
                                       x
                                       2
                                    
                                 
                                 d
                                 
                                    x
                                    1
                                 
                                 d
                                 
                                    x
                                    2
                                 
                              
                           
                        
                     

Continuous Ridgelet transform has a close connection with Radon transform which is defined as:
                           
                              (3)
                              
                                 R
                                 f
                                 
                                    θ
                                    t
                                 
                                 =
                                 
                                    
                                       ∫
                                       
                                          −
                                          ∞
                                       
                                       
                                          +
                                          ∞
                                       
                                    
                                    
                                       
                                          
                                             ∫
                                             
                                                −
                                                ∞
                                             
                                             
                                                +
                                                ∞
                                             
                                          
                                          
                                             f
                                             
                                                
                                                   x
                                                   1
                                                
                                                
                                                   x
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 δ
                                 
                                    
                                       
                                          x
                                          1
                                       
                                       cos
                                       θ
                                       +
                                       
                                          x
                                          2
                                       
                                       sin
                                       θ
                                       −
                                       t
                                    
                                 
                                 d
                                 
                                    x
                                    1
                                 
                                 d
                                 
                                    x
                                    2
                                 
                              
                           
                        
                     

Thus, continuous Ridgelet transform can be written as:
                           
                              (4)
                              
                                 
                                    R
                                    f
                                 
                                 
                                    a
                                    b
                                    θ
                                 
                                 =
                                 
                                    
                                       ∫
                                       
                                          −
                                          ∞
                                       
                                       
                                          +
                                          ∞
                                       
                                    
                                    
                                       R
                                       f
                                       
                                          θ
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          a
                                          
                                             −
                                             1
                                             /
                                             2
                                          
                                       
                                       ψ
                                       
                                          
                                             
                                                t
                                                −
                                                b
                                             
                                             a
                                          
                                       
                                    
                                 
                                 d
                                 t
                              
                           
                        
                     

From Eq. (4), the Ridgelet transform of a function can be seen as a Radon transform of the function followed by a 1D wavelet transform. In simple terms, Ridgelet transform applies Radon transform for a mapping from singular line to singular point and then uses wavelet transform to detect all singular points.

The first generation Curvelet transform (CurveletG1) was developed in 1999 [8]. It is essentially a combination of subband filtering and multi-scale Ridgelet transform. The specific algorithm of CurveletG1 includes subband decomposition, smooth partitioning, and Ridgelet analysis.

CurveletG1 produces approximate optimization representation for target function with smooth singular lines. However, CurveletG1 uses overlapping windows to avoid blocking effects in the process of smooth partitioning. This leads to an increase of redundancy of CurveletG1. The redundancy rate of CurveletG1 is up to 16J
                        +1 in which J is the decomposition scale.

The second generation Curvelet transform (CurveletG2) is also called Fast Discrete Curvelet Transform (FDCT) [9]. There are two implementation methods of CurveletG2. The first digital transform is based on unequally-spaced fast Fourier transforms (USFFT) while the second is based on the wrapping of specially selected Fourier samples. Both digital transformations return a table of digital Curvelet coefficients indexed by a scale parameter, an orientation parameter, and a spatial location parameter. The Fourier frequency plane of the image is divided into different concentric rectangles in radial direction and equal components in circumferential direction. After the spectrum is partitioned, many trapezoidal regions are produced and each region obeys the anisotropic scaling law: width
                        ≈
                        length
                        2. So Curvelet transform can represent edges and other singularities along curves sparsely. Compared to CurveletG1, CurveletG2 abandons partitioning operation and Ridgelet transform and hence is simpler, and has faster calculating speed and lower redundancy.

Do and Vetterli proposed the concept of Contourlet transform in 2002 [10] and illustrated its theory thoroughly in 2005 [11]. Contourlet can capture the intrinsic geometrical structure of an image, and it was called a “true” two-dimensional method of image representation. As a kind of non-adaptive multi-scale geometric analysis method, Contourlet transform is able to not only capture the intrinsic geometrical structure of the image, but also deal with the image directly without necessarily knowing the information of image edges and contours. It extends the merits of Wavelet transform to higher-dimensional spaces and can better depict high-dimensional information with lines or surface singularities. Contourlet transform not only has the multi-scale and time-frequency-localization properties of Wavelet transform, but also offers a high degree of directionality and anisotropy. The basic functions of Contourlet transform have elongated supports which can capture linear segments of contours effectively.

Contourlet transform was defined in discrete domain first and then expanded in continuous domain to study its convergence. Discrete Contourlet transform was also called pyramidal directional filter bank, which was composed of Laplacian pyramid (LP) and directional filter banks (DFB). Firstly, LP was applied to decompose an image into a low-pass subband and a band-pass subband. Secondly, the band-pass subband was fed into the DFB to capture directional information. Thus the decomposition of Contourlet transform with one level was completed. The scheme can be iterated on the low-pass subband to keep decomposing at finer scales. Due to the cascade structure of Contourlet, the two stages of multi-scale and directional decomposition are independent of each other. So the numbers of directions can be different at different scales.

Shearlet transform was designed to be applied as a framework of affine systems to extraction of geometrical features of multi-dimensional signals [24]. In 2007, K. Guo and D. Labate studied the construction of irregular Shearlet systems and provided a framework for the construction of a variety of discrete directional multi-scale systems with the ability to detect orientations inherited from continuous Shearlet transform [25]. In 2008, they proposed a Fourier Integral Operator with respect to a Parseval frame of Shearlets and the matrix representation of the method was proved to be sparse and well-organized [26]. In 2010, W. Lim proposed the Extended Discrete Shearlet Transform, adding extra basis elements to Shearlet systems to obtain orthonormal basis for each shear matrix [21]. In this paper, we adopted an efficient discrete Shearlet transform scheme based on a Laplacian pyramid combined with appropriate shearing filters, which was proposed in [16].


                        Fig. 6
                         is the scheme of the discrete Shearlet transform based on a Laplacian pyramid combined with appropriate shearing filters [16]. As shown in Fig. 6, an image is decomposed into a low-pass and a band-pass subband by LP firstly. Then the band-pass subband, which represents the difference between original image and low-pass subband, is fed into appropriate shearing filters to complete multidirectional decomposition. The aforementioned process is executed repeatedly on low-pass subbands to get multi-scale decomposition. Shearlet transform can decompose an image into 
                           2
                           ×
                           
                              2
                              
                                 n
                                 j
                              
                           
                           +
                           1
                         (j is the decomposition level and n
                           j
                         denotes the direction parameter ndir) directional subbands in the horizontal cone and the vertical cone at any scale, respectively. For example, when ndir=[2 1 0], the total number of the directions in both horizontal cone and vertical cone is 2×(9+5+3)=34.

Many subbands are obtained by the decomposition of an image with Shearlet transform, and different subbands contain information of different scales and directions of the image. Features that can be calculated from the subbands include:
                           
                              1)
                              Geometrical features—the geometrical features are used to represent the size and shape of an object. These features have been commonly used in a variety of pattern recognition problems. However, the geometrical features are not very useful for the images in this paper because they are difficult to be segmented for the extraction of the geometrical features.

Statistical features—the statistical features are very useful, and are easy to be calculated. They are scale and rotation invariant. In this study, means and variances are used.

Textural features—the textural features are attributes representing the spatial arrangement of the gray levels of the pixels. Gray Level Co-occurrence Matrix (GLCM) [27] and Wavelet transform [28] are traditional methods of textural feature extraction, and they are very useful in the image recognition. As the textural features are always relevant to scales and directions of images, it is unnecessary to be calculated from subbands which already contain information of scales and directions.

So, only two statistical features, means and variances are calculated from the subbands obtained from the decomposition of the image with Shearlet transform.

A high-dimensional feature vector is built by combining all the features extracted from subbands. Some information with correlation and redundancy may exist in the vector. As a consequence, this increases the complexity of computation and is bad for the defect recognition. Dimension reduction is applied to the high-dimensional feature vector to remove useless features and redundant information.

Kernel Locality Preserving Projections (KLPP) is introduced as a method of dimension reduction. Locality Preserving Projection (LPP) is a well-known dimensionality reduction method, which could project high-dimensional input data into a low-dimensional subspace by linear transformation [17,18]. KLPP is the implementation of LPP in kernel space. KLPP can well preserve local neighborhood information of the high-dimensional data sets and effectively eliminate the impacts of noises and outliers.

A feature descriptor called DST-KLPP is proposed to overcome the drawbacks of the traditional Shearlets transform and improve the performance of Shearlet transform. The step-by-step procedure of DST-KLPP is as follows:
                           
                              Step 1
                              Images are decomposed into multiple subbands at different scales and directions with discrete Shearlet transform; coefficient matrices of subbands are calculated in both horizontal and vertical cones at different scales.

Statistical features, both means and variances, are calculated from all coefficient matrices of subbands obtained in Step 1, and combined into a high-dimensional feature vector.

KLPP is applied to the high-dimensional feature vector for dimension reduction, and a low-dimensional feature vector is obtained.

The low-dimensional feature vectors are fed into a classifier based on support vector machine (SVM) [29] for classification of the defects.

As described in Section 2, three surface image databases from different production lines of metals were used in the experiments to test the performance of the proposed method, including the continuous casting slabs, the hot rolled steels and the aluminum sheets. In the experiments, the number of images representing each defect is proportional to its frequency of occurring at the production lines. The odd numbers of samples were used for training, while the even numbers of samples were used for testing.

The experiments were designed as follows: firstly, each image was decomposed using Shearlet transform with various parameters to test the results produced using different parameters. Then, the means and variances of all directional subbands were calculated as a matrix of feature vectors and KLPP was applied to reduce redundant information of the feature vector matrix. Finally, the obtained feature vectors of all images, both before and after the KLPP, were fed into the classifier for image classification, and then comparison among all the classification results was performed.

To verify the effectiveness of DST-KLPP, the classification results of DST-KLPP were compared with results of two traditional feature extraction methods, which are GLCM and Wavelet transform. Additionally, the performance of DST-KLPP was compared with two other MGA methods, namely Curvelet transform and Contourlet transform. For Contourlet transform, ‘9/7’ [30] and ‘pkva’ [31] were selected as LP (Laplacian Pyramid) and DFB (Directional Filter Banks) filters, respectively. For Curvelet transform, statistical features of the obtained coefficient matrices were calculated, including means and variances, third-order moments, third-order central moments, Hu moments [32] and second-order Zernike moments [33,34]. In the other methods, the means and variances were calculated as statistical features.

In the experiments, the SVM based classifiers were used and Radial Basis Function (RBF) was selected as the kernel function. The error penalty parameter C was set as a default value. The kernel parameter γ was set to [0, 4] with a step length of 0.1.

In the sample images of continuous casting slabs shown in Fig. 1, cracks are regarded as positive samples, and the other three types are labeled as negative samples including non-uniformed lighting effects, scales and slag marks. The numbers of positive samples and negative samples are 222 and 274, respectively.


                        Fig. 7
                         shows classification rates of the testing set based on Shearlets and DST-KLPP while the parameter is set as ndir=[1 1 1 0 0]. The dimension of the feature vectors of DST-KLPP is 20. The peak of the curve is up to 94.35% with DST-KLPP and higher than that with Shearlet transform, which is 85.89%. Besides, the curve of the classification rate with Shearlet transform is very sensitive to kernel parameter γ, while with DST-KLPP it is more stable. This is because the former gets more correlated and redundant features. It can be seen from Fig. 7 that DST-KLPP removes redundant information successfully and keeps a very stable classification rate after initial gentle fluctuation. The figure clearly shows that in this application, the DST-KLPP outperforms the Shearlets in terms of stability and classification rates.


                        Table 1
                         lists classification rates of the testing set achieved by Shearlet transform and DST-KLPP with different decomposition parameters. It is evident that the classification rate is lower when there are less decomposition scales and directions, which shows that the advantage of Shearlet transform in analyzing images at multiple scales and directions is not fully utilized. The classification rate of the testing set increases at first, then decreases as the decomposition scales and direction number increase. Excessive decomposition scales and directions will produce redundant features which are adverse to the image classification rate. KLPP is effective to reduce the redundant information to improve the classification rate. DST-KLPP not only inherits the advantages of Shearlet transform in acquiring comprehensive image information at multiple sales and directions but also reduces most of the redundant information of extracted features.

Comparison of classification rates with different methods is listed in Table 2
                        . DST-KLPP is compared with the two traditional methods (GLCM and Wavelet transform) and the two methods of MGA (Curvelet transform and Contourlet transform). Classification rates of cracks and all samples are given separately. As the features acquired with methods of MGA are numerous, KLPP is applied to reduce the dimensions of the feature vectors for all the methods of MGA used in this study.


                        Table 2 indicates that DST-KLPP achieves higher classification rates than the other methods. It is also seen from Table 2 that the methods of MGA have advantages than the traditional methods. However, it is obvious that the performance of Shearlet transform is better than those of Curvelet transform and Contourlet transform, while the highest classification rate is achieved using DST-KLPP with the fewest features. This is because Shearlet transform makes full use of the geometrical characteristics, which outperforms others in extracting more distinctive information such as direction flow and texture.

With DST-KLPP, the classification rate of cracks reaches 94.59% and the classification rate of all samples is up to 94.35%. This means that both the genuine and pseudo defects can be recognized effectively with DST-KLPP. The results show that DST-KLPP is effective for recognition of cracks from the images of continuous casting slabs.

To verify the performance of the proposed DST-KLPP, sample images of hot rolled steels are analyzed. This is because there are various defects associated with the hot rolled steel surface. If the proposed method works well with this case, it means that the method is capable of identify multiple defects. Table 3
                         shows the numbers of different defects presented in the test samples. There are 1273 samples in the testing dataset, including all types of the images shown in Fig. 3.


                        Table 4
                         lists classification rates of the testing dataset achieved using DST-KLPP with different decomposition parameters. The classification rates are related to the parameters, and with the suitable parameters high classification rate can be achieved.


                        Table 5
                         shows the comparison of the classification rates achieved using different methods. It is evident that the highest classification rate is achieved when using DST-KLPP.

To show the detailed performance of the proposed method, a confusion matrix is presented in Table 6
                        . With the test dataset, the overall classification rate of 95.75% is achieved. From Table 6, we can see that most of the defects are correctly classified, such as transverse cracks, scars, chaps, longitudinal scratches and longitudinal cracks. It should also be noted that the classification rate of scales is 95.96%, which means that the scale defect can also be correctly classified, and the false positive of the scale defect detection is significantly reduced.

To test the performance of the proposed method for the images with low contrast, sample images acquired from aluminum sheets are used in this experiment. Table 7
                         shows the number of sample images for different defects used in the experiment. There are 480 samples in total, including all defects shown in Fig. 5. All pseudo-defects are labeled as the type of “PD” for classification.

Contrast stretching is carried out to enhance all sample images in the experiment. The comparison of classification rates using different methods is shown in Table 8
                        .


                        Table 8 demonstrates that the classification rate achieved using DST-KLPP is higher than that produced from the other three methods including GLCM, Wavelet and Curvelet-KLPP. However, Contourlet-KLPP outperforms the other four methods overall. Even this is the case, the classification rates of imprints and scratches achieved using DST-KLPP are higher than the one produced using Contourlet-KLPP. The fact is that the imprints and scratches are difficult to be detected among all the defects of aluminum sheets. Identifying these two types of defects is very important to surface inspection of aluminum sheets. Table 9
                         shows the confusion matrix for the classification of various defects using the proposed method.


                        Table 9 shows that DST-KLPP is effective for most types of defects such as imprints, dents and pseudo defects. However, 5 scratches are classified as imprints, and 4 roll marks are classified as wrinkles. This is caused by the low contrast images of scratches and roll marks. More effective image enhancement should be conducted to improve the image contrast.

@&#CONCLUSIONS@&#

An effective hybrid feature extraction method, DST-KLPP, is proposed and developed to take the advantages of both Shearlet transform and KLPP. DST-KLPP is applied to the classification of surface defects for 3 different types of metals. Experimental results show that DST-KLPP can produce higher classification rates than the traditional methods such as Gray Level Co-occurrence Matrix and Wavelet transform, and also outperforms the other MGA methods such as Curvelet transform and Contourlet transform.

Experiments with the surface inspection for the continuous casting slabs show that DST-KLPP can recognize longitudinal cracks from the images with complicated background. Experiments with the hot rolled steels demonstrate that DST-KLPP can identify genuine detects from the images with pseudo-defects, such as scales. Experiments with the aluminum sheets illustrate that the DST-KLPP can be used to locate tiny defects from the images with low contrast. In conclusion, the proposed DST-KLPP is a general and effective method for the classification of surface defects for the different types of metals. It can be potentially used in other industrial applications as well.

@&#ACKNOWLEDGMENTS@&#

This work is sponsored by the National Science and Technology Support Program of China (Grant no. 2012BAB19B06), and Doctoral Fund of Ministry of Education of China (Grant no. 20120006110033).

@&#REFERENCES@&#

