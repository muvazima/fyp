@&#MAIN-TITLE@&#Image enhancement using the averaging histogram equalization (AVHEQ) approach for contrast improvement and brightness preservation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A histogram equalization method is proposed to preserve original image brightness.


                        
                        
                           
                           A histogram averaging technique is developed to recover image information lost.


                        
                        
                           
                           A histogram remapping technique is used to reduce artifacts introduced to images.


                        
                        
                           
                           An optimization minimizes the brightness change between input and output images.


                        
                        
                           
                           Results show that image brightness is preserved while image contrast is enhanced.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image contrast enhancement

Histogram smoothing

Brightness preservation

Dynamic stretching

Sub-image separation optimization

@&#ABSTRACT@&#


               
               
                  Image contrast enhancement and brightness preservation are fundamental requirements for many vision based applications. However, these are two conflicting objectives when the image is processed by histogram equalization approaches. Current available methods may not provide results simultaneously satisfying both requirements. In this work, a pipelined approach including color channel stretching, histogram averaging and re-mapping is developed. By using stretching, color information from a scene is restored. Averaging against a uniform distribution enables the output image to recover the information lost. Furthermore, histogram re-mapping reduces artifacts that often arise from the equalization procedure. The technique also employs a search process to find optimal algorithmic parameters, such that the mean brightness difference between the input and output images is minimized. The effectiveness of the proposed method was tested with a set of images captured in adverse environments and compared against available methods. High performing qualitative and quantitative results were obtained.
               
            

@&#INTRODUCTION@&#

Digital imagery is becoming an indispensable source of information in a wide range of contemporary applications. For instance, it is found in hand-held consumer electronic devices [1], where auto-focusing is one of the major functionalities [2]. In engineering, there are even more demands and requirements of image processing technology. This technique can be used in the monitoring of machine operation conditions [3], in the remote sensing of the environment revealing land covers [4]. In robotics, image processing can be used for object tracking [5]. It is also useful in human computer interactions [6] such as hand gesture recognition [7]. The major demand for image enhancement is to restore a captured image from degradations arising from imperfect acquisition conditions. For example, to remove the noise imposed, to correct the color cast [8] and to sharpen the objects that appear in the image [9].

One of the most demanding features in restoring an image is to improve its contrast so that it is pleasant to a human viewer and to easy computer based operations such as object identification [10]. Among these, contrast improvement using histogram equalization (HE) methods has found a lot of real-world applications for its implementation simplicity and effectiveness [11]. In particular, uniform histogram equalization (UNFHE) or conventional histogram equalization is the most common HE method employed in computer vision applications, and the histogram of the output image from this equalization follows a uniform distribution. However, it is also observed that these approaches may produce artifacts due to over-enhancement if the algorithm is not properly designed. Another concern of HE based techniques is the preservation of the output image brightness such that a true reproduction of the scene characteristics can be made available.

There are a number of research works reported in literature that aimed at accomplishing the aforementioned goal. An early attempt was made to separate the input image into two sub-images using the mean intensity or brightness as the threshold in the brightness preserving bi-histogram equalization (BBHE). The two sub-images were then processed independently using histogram equalization with reference to a target uniform histogram [12]. By the design of this method, an exact match between the brightness of input and output images is not generally available. In order to reduce such discrepancy, the separation was made using the median brightness [13]. In the equal area dualistic sub-image histogram equalization method (DSIHE), the numbers of pixels classified in the lower and higher sub-images are equal. It enables a closed form solution to find the output image mean brightness, however, its preservation is still not guaranteed.

Further to the requirement to satisfy mean brightness preservation, avoiding the generation of artifacts due to over-enhancement is also important. A class of methods was hence developed where the peaks of the histogram are clipped to avoid over-enhancement. An original development was suggested; where the image is first separated into two sub-images using the input image mean brightness, known as the bi-histogram equalization with a plateau limit (BHEPL) method [14]. The clipping limits were obtained from the mean values of the histogram heights of individual sub-images and then used as the target histogram in the equalization [15]. Although over-enhancement can be controlled, but due to the deviation of the target histogram from a uniform profile, it is difficult to steer the output image mean brightness to the desired value. The choice of the clipping limit is not automatic but it may be problem specific, such as driven by the exposure or viewing perception [16,17].

The selection of separation thresholds and clipping limits has been addressed in several research works. A variation named the bi-histogram equalization median plateau (BHEPLD) was reported in [18], where the clipping limit was obtained from the median values of the sub-images. In fact, this choice of plateaus does not warrant perfect brightness preservation. Recently, another choice of clipping limit was proposed as the adaptive image enhancement bi-histogram equalization (AIEBHE) [19]. In the work reported therein, the sub-images are separated by the input median brightness. The plateaus were taken from the minimum of the histogram value, mean value and the median value of the sub-image histogram. This choice of limits might fail when the median value tends to zero for images biased toward the two ends of the intensity range. A further variation was reported, known as the median-mean sub-image clipped histogram equalization (MMSICHE) [20]. In the work presented there, the input image was divided into four sub-images. The first separation was carried out using the mean intensity while the division into four sectors used the median values of the two sub-images. The clipping limits for the four obtained sub-images were the median values of individual sectors. As can be seen, this process increases implementation complexity while the preservation of output image brightness cannot be assured.

Other than clipping the histogram to prevent artifacts generation, there have been alternative approaches available. For example, the input image histogram can be smoothed and used as the target distribution in the histogram equalization process called smoothed histogram equalization (SMHEQ) [21]. The smoothing was conducted using a varying weighting divisor as a sliding window across the input image histogram. The next effect was that histogram elements in the middle intensity range were flattened towards a uniform distribution thus contributed to the increase in information content. The low and high intensity elements were only modified to a lesser extend hence reducing the generation of artifacts. By its algorithmic design, this method does not particularly address the brightness preservation problem. On the other hand, this approach had indicated a direction for an automatic process to enhance the image contrast and to preserve the mean brightness by properly manipulating the smoothing process.

In this work, a color image enhancement approach is proposed. The developed procedure is performed in a pipeline called averaging histogram equalization (AVHEQ). The method is formulated towards restoring images degradations due to adverse environmental conditions when they are captured. Improvements are sought in the information content, contrast, and preservation of the mean brightness in order to truly represent the features in the scene. Unlike previous approaches, this method does not need to separate the histogram into sections and it is not necessary to include hard limiting plateaus to clip histogram peaks. Furthermore, an efficient search algorithm is used to optimize the performance without any user involvement.

The rest of the paper is organized as follows. In Section 2, backgrounds in histogram equalization for contrast enhancement and its variations are reviewed. The proposed approach based on the histogram averaging concept is presented in Section 3. Experiments are described in Section 4 and their results are discussed. Section 5 contains the conclusions.

@&#RELATED WORK@&#

Previous works using histogram equalization for color image contrast enhancement are reviewed in this section. Those methods commonly convert the color image into its gray or monochrome equivalence to be processed and re-converted back to the color domain as the enhanced output. These methods include the conventional equalization where a global strategy is adopted and the target histogram follows a uniform distribution. Then, methods based on separating the input image into sub-images for contrast enhancement are discussed. In addition, approaches invoking histogram clipping and histogram smoothing strategies to mitigate artifacts due to over-enhancement are described.

Consider an input color image in red green blue (RGB) format of sized 
                           
                              U
                              ×
                              V
                           
                         in width-by-height is given. The magnitude of each color channel is bounded within 
                           
                              [
                              0
                              
                              L
                              -
                              1
                              ]
                           
                         for typical 8-bit storage, where 
                           
                              L
                              =
                              
                                 
                                    2
                                 
                                 
                                    8
                                 
                              
                              =
                              256
                           
                        . The image can be described by
                           
                              (1)
                              
                                 I
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 {
                                 R
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 
                                 G
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 
                                 B
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 }
                                 ,
                              
                           
                        where 
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         is the pixel coordinate in the image. In most approaches, the color image is converted to a gray image, for example, through the hue saturation intensity (HSI) space and the intensity I-channel I is extracted and enhanced. That is
                           
                              (2)
                              
                                 {
                                 HSI
                                 }
                                 ←
                                 T
                                 (
                                 {
                                 RGB
                                 }
                                 )
                                 ,
                              
                           
                        where 
                           
                              T
                              (
                              ·
                              )
                           
                         is the RGB to HSI transformation, see [10].

In this method, a histogram is first constructed for the input image by
                           
                              (3)
                              
                                 h
                                 (
                                 i
                                 )
                                 =
                                 {
                                 n
                                 (
                                 i
                                 )
                                 }
                                 ,
                              
                           
                        where i is the intensity index and 
                           
                              n
                              (
                              i
                              )
                           
                         is the number of pixels having the ith intensity. A cumulative density function is further obtained from
                           
                              (4)
                              
                                 c
                                 (
                                 i
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          i
                                       
                                    
                                 
                                 n
                                 (
                                 j
                                 )
                                 ,
                                 
                                 c
                                 (
                                 L
                                 -
                                 1
                                 )
                                 =
                                 1
                                 ,
                                 
                                 N
                                 =
                                 U
                                 ×
                                 V
                                 .
                              
                           
                        
                     

The enhanced gray image is then derived from the equalization operation
                           
                              (5)
                              
                                 
                                    
                                       I
                                    
                                    
                                       enh
                                    
                                 
                                 =
                                 
                                    
                                       I
                                    
                                    
                                       min
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       I
                                    
                                    
                                       max
                                    
                                 
                                 -
                                 
                                    
                                       I
                                    
                                    
                                       min
                                    
                                 
                                 )
                                 ×
                                 c
                                 (
                                 i
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    I
                                 
                                 
                                    min
                                 
                              
                           
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    max
                                 
                              
                           
                         are the minimum and maximum target intensities, and usually 
                           
                              
                                 
                                    I
                                 
                                 
                                    min
                                 
                              
                              =
                              0
                           
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    max
                                 
                              
                              =
                              L
                              -
                              1
                           
                        .

Since the output image from conventional histogram equalization, 
                           
                              
                                 
                                    I
                                 
                                 
                                    enh
                                 
                              
                           
                        , follows a uniform distribution, its mean intensity becomes
                           
                              (6)
                              
                                 
                                    
                                       I
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          L
                                          -
                                          1
                                       
                                    
                                 
                                 (
                                 i
                                 ×
                                 
                                    
                                       p
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 i
                                 )
                                 )
                                 ,
                                 
                                 i
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 L
                                 -
                                 1
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    p
                                 
                                 
                                    o
                                 
                              
                              (
                              i
                              )
                              =
                              
                                 
                                    h
                                 
                                 
                                    o
                                 
                              
                              (
                              i
                              )
                              /
                              N
                              =
                              1
                              /
                              L
                           
                         and 
                           
                              
                                 
                                    h
                                 
                                 
                                    o
                                 
                              
                              (
                              i
                              )
                           
                         represents the histogram of the image 
                           
                              
                                 
                                    I
                                 
                                 
                                    enh
                                 
                              
                           
                        . It is deviated from the input image and may be regarded as undesirable [12]. Attempts had been made to remedy this drawback by invoking the brightness preserving concepts in designing the bi-histogram based approaches.

There are methods that separate the input image into two sub-images and then carry out conventional histogram equalization on each sub-image independently [12,13]. The difference is that the former work used the mean brightness as the separation threshold while the latter used the median value. Since the numbers of pixels below and above the threshold are determined by the image content, the output mean brightness is not exactly the same as the input mean brightness.

Following the works with bi-histogram equalization, methods were developed that limited the peaks in the histogram by the mean value and median value of individual sub-images [14,18]. For example, the image is first divided into the low and high portions as
                           
                              (7)
                              
                                 
                                    
                                       I
                                    
                                    
                                       lo
                                    
                                 
                                 =
                                 {
                                 I
                                 (
                                 i
                                 )
                                 
                                 |
                                 
                                 0
                                 <
                                 i
                                 ⩽
                                 
                                    
                                       I
                                    
                                    
                                       m
                                    
                                 
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       I
                                    
                                    
                                       hi
                                    
                                 
                                 =
                                 {
                                 I
                                 (
                                 j
                                 )
                                 
                                 |
                                 
                                 
                                    
                                       I
                                    
                                    
                                       m
                                       +
                                       1
                                    
                                 
                                 <
                                 j
                                 ⩽
                                 L
                                 -
                                 1
                                 }
                                 .
                              
                           
                        
                     

The output image is obtained from the aggregation of two enhanced sub-images as
                           
                              (9)
                              
                                 
                                    
                                       I
                                    
                                    
                                       enh
                                    
                                 
                                 =
                                 
                                    
                                       I
                                    
                                    
                                       enh
                                       ,
                                       lo
                                    
                                 
                                 ∪
                                 
                                    
                                       I
                                    
                                    
                                       enh
                                       ,
                                       hi
                                    
                                 
                                 ,
                              
                           
                        where the enhanced sub-images 
                           
                              
                                 
                                    I
                                 
                                 
                                    enh
                                    ,
                                    lo
                                 
                              
                           
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    enh
                                    ,
                                    hi
                                 
                              
                           
                         are separately generated by performing the conventional histogram equalization discussed in the last section on the two sub-images 
                           
                              
                                 
                                    I
                                 
                                 
                                    lo
                                 
                              
                           
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    hi
                                 
                              
                           
                        . The target distributions of these enhanced sub-images are the clipped sub-histograms.

Conventional histogram equalization methods suffer from over-enhancement effects, which frequently produce unnatural viewing artifacts. It was observed that artifacts arise when the change in intensity is too excessive during equalization. It is mostly observed at intensity levels where there are peaks in the input image histogram.

In the method presented in [20], the input image is divided into four quadrants using the mean to divide into two sub-images, then the median values of each sub-image are further used to divide each into two more sub-images. The clipping limits were chosen as the median values of each of the four sub-images. A further variation was reported in [19] where the input image was divided using the mean intensity. Unlike the others, the clipping limits were chosen from the minimum of the histogram element and the mean and median values of the sub-image. That is
                           
                              (10)
                              
                                 
                                    
                                       P
                                    
                                    
                                       lo
                                    
                                 
                                 (
                                 i
                                 )
                                 =
                                 
                                    min
                                 
                                 {
                                 h
                                 (
                                 i
                                 )
                                 ,
                                 
                                 μ
                                 (
                                 
                                    
                                       i
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                                 ,
                                 
                                 m
                                 (
                                 
                                    
                                       i
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                                 }
                                 ,
                                 
                                 0
                                 <
                                 i
                                 ⩽
                                 
                                    
                                       I
                                    
                                    
                                       m
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       P
                                    
                                    
                                       hi
                                    
                                 
                                 (
                                 j
                                 )
                                 =
                                 
                                    min
                                 
                                 {
                                 h
                                 (
                                 j
                                 )
                                 ,
                                 
                                 μ
                                 (
                                 
                                    
                                       j
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                                 ,
                                 
                                 m
                                 (
                                 
                                    
                                       j
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                                 }
                                 ,
                                 
                                 
                                    
                                       I
                                    
                                    
                                       m
                                       +
                                       1
                                    
                                 
                                 <
                                 j
                                 ⩽
                                 L
                                 -
                                 1
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    i
                                 
                                 
                                    ̃
                                 
                              
                           
                         denotes the sub-image range 
                           
                              0
                              <
                              i
                              ⩽
                              
                                 
                                    I
                                 
                                 
                                    m
                                 
                              
                           
                        , and 
                           
                              μ
                              (
                              
                                 
                                    i
                                 
                                 
                                    ̃
                                 
                              
                              )
                           
                         and 
                           
                              m
                              (
                              
                                 
                                    i
                                 
                                 
                                    ̃
                                 
                              
                              )
                           
                         are the mean and median values of the corresponding sub-image. Variables 
                           
                              μ
                              (
                              
                                 
                                    j
                                 
                                 
                                    ̃
                                 
                              
                              )
                           
                         and 
                           
                              m
                              (
                              
                                 
                                    j
                                 
                                 
                                    ̃
                                 
                              
                              )
                           
                         are defined accordingly for 
                           
                              
                                 
                                    I
                                 
                                 
                                    m
                                    +
                                    1
                                 
                              
                              <
                              j
                              ⩽
                              L
                              -
                              1
                           
                        . The target histograms to be used in the equalization then become
                           
                              (12)
                              
                                 
                                    
                                       h
                                    
                                    
                                       lo
                                    
                                 
                                 (
                                 i
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         lo
                                                      
                                                   
                                                   (
                                                   i
                                                   )
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         lo
                                                      
                                                   
                                                   (
                                                   i
                                                   )
                                                   ⩽
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         lo
                                                      
                                                   
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         lo
                                                      
                                                   
                                                   (
                                                   i
                                                   )
                                                   ,
                                                
                                                
                                                   otherwise
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       h
                                    
                                    
                                       hi
                                    
                                 
                                 (
                                 j
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         hi
                                                      
                                                   
                                                   (
                                                   j
                                                   )
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         hi
                                                      
                                                   
                                                   (
                                                   j
                                                   )
                                                   ⩽
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         hi
                                                      
                                                   
                                                   (
                                                   j
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         hi
                                                      
                                                   
                                                   (
                                                   j
                                                   )
                                                   ,
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

With the modifications and variations originating from the bi-histogram concept, procedures are becoming available to be used in different problem domains. However, it is still non-trivial to arrive at an exact matching of the input and output image mean brightness as well as simultaneously enhancing the image contrast without producing viewing artifacts.

While approaches based on sub-image separation had gained popularity in contrast enhancement and mean brightness preservation, alternatives from a different conceptual perspective are still possible. In order to mitigate artifacts generated from equalization towards a uniform histogram, as commonly practiced in sub-image based processes, the target histogram can be obtained from smoothing the input image histogram [21].

In this method, the input image histogram is smoothed by calculating the average values for each intensity level in the histogram. The averaging is conducted by adopting the dividing factor to the intensity. The process can be described as
                           
                              (14)
                              
                                 h
                                 (
                                 i
                                 )
                                 ←
                                 
                                    
                                       h
                                       (
                                       i
                                       )
                                    
                                    
                                       i
                                       ±
                                       w
                                       (
                                       i
                                       )
                                    
                                 
                                 ,
                              
                           
                        where the range of division is a function of the intensity and is determined from
                           
                              (15)
                              
                                 w
                                 (
                                 i
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   2
                                                   (
                                                   i
                                                   +
                                                   1
                                                   )
                                                   -
                                                   1
                                                   ,
                                                
                                                
                                                   0
                                                   <
                                                   i
                                                   ⩽
                                                   L
                                                   /
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   2
                                                   (
                                                   L
                                                   -
                                                   i
                                                   +
                                                   1
                                                   )
                                                   -
                                                   1
                                                   ,
                                                
                                                
                                                   L
                                                   /
                                                   2
                                                   <
                                                   i
                                                   ⩽
                                                   L
                                                   -
                                                   1
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The resultant smoothed histogram becomes flatter in the middle intensity range and replicates the input histogram at the two ends of the intensity range. The modified histogram is then used as the target distribution in the equalization process. On the other hand, since the histogram is only moderately altered at the two intensity ends the output image contains a reduced amount of artifacts, where they are most noticeable at low and high intensities.

@&#DISCUSSION@&#

It can be noted from the review above that conventional histogram equalization is vulnerable to produce viewing artifacts where the changes of intensities between the input and output are too large. On the other hand, this kind of approach also shifts the mean brightness of the output image. Methods adopting histogram peak clipping are able to reduce the abrupt change of intensities, but it also destroys the matching of input and output mean brightness. The histogram smoothing strategy is able to mitigate artifacts but by its design the maintenance of brightness is not specifically considered. The analysis has thus motivated a new scheme to enhance the image contrast while keeping the change in brightness to a minimum. The latter objective is tackled as an optimization problem and the details are presented below.

The objective of this work can be stated as increasing the image contrast while keeping the mean brightness of the output image unaltered as much as possible. For an input color image, the proposed approach is carried out in a pipeline process as depicted in Fig. 1
                     .

First, a color channel stretching operation is performed allowing the full coverage of the permitted dynamic ranges in order to convey the richest set of color information to the viewer. Then, a histogram averaging process is carried out before it is used in the equalization operation. As it is observed that an image having a uniform histogram carries the highest amount of information, the proposed method proceeds by averaging the given image histogram to a scaled uniform histogram. The purpose is to increase the information content that is obscured by the image capturing conditions.

In particular, the choice of the scale is cast as an optimization problem for the best performance while removing the need for user specifications. An iterative search loop is incorporated, as shown by the dotted line in Fig. 1, where an intermediate enhanced image is compared with the original for brightness error. The error and the input image entropy form an objective function to guide the search for the optimal scale. When the brightness error is minimized and the entropy is maximized then the search terminates. Finally, a histogram re-mapping process is conducted together with the HSI to RGB conversion stage to generate the output image.

The input image is first stretched on every color channel in order to correct for any color distortion arising from unfavorable capturing environment. We have
                           
                              (16)
                              
                                 R
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 ←
                                 
                                    
                                       R
                                       (
                                       u
                                       ,
                                       v
                                       )
                                       -
                                       
                                          
                                             R
                                          
                                          
                                             min
                                          
                                       
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             max
                                          
                                       
                                       -
                                       
                                          
                                             R
                                          
                                          
                                             min
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    R
                                 
                                 
                                    min
                                 
                              
                              =
                              min
                              {
                              R
                              (
                              u
                              ,
                              v
                              )
                              }
                           
                         for all 
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        , and 
                           
                              
                                 
                                    R
                                 
                                 
                                    max
                                 
                              
                              =
                              max
                              {
                              R
                              (
                              u
                              ,
                              v
                              )
                              }
                           
                         for all 
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        . The green (G) and blue (B) channels are stretched in the similar manner. In parallel with the stretching, the input image is converted to its gray scale image and the I-channel is extracted, see Eq. (2). The mean brightness 
                           
                              
                                 
                                    I
                                 
                                 
                                    m
                                 
                              
                           
                         is calculated using Eq. (6). This mean intensity will be used as the reference for the output image brightness.

An image having a uniform intensity distribution is known to carry the maximum amount of information about the scene. However, artifacts often appear as compared to the original image. An optimized combination of histogram equalized image, to a uniform distribution, with the original image would give an enhancement with reduced artifacts.

The stretched color signal is converted to its gray image equivalent for use in contrast enhancement. From the converted I-channel, a histogram is constructed using the procedure given by Eq. (3). The averaging process is illustrated in Fig. 2
                        .

The distribution of the input image occupies the middle intensity range and its information is low. After stretching, the histogram expands and the information increases to a sub-maximum level. A desirable uniform distribution, the straight line in Fig. 2, is then combined in a weighted-sum manner in order to further increase the information content. After optimally weighted, the histogram is normalized such that the sum of the bins is equal to the number of pixels. The averaging process is further elaborated below.

Given the histogram, it is averaged as
                           
                              (17)
                              
                                 
                                    
                                       h
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 i
                                 )
                                 ←
                                 
                                    
                                       h
                                       (
                                       i
                                       )
                                       +
                                       τ
                                       ×
                                       
                                          max
                                       
                                       {
                                       h
                                       (
                                       i
                                       )
                                       }
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 0
                                 <
                                 τ
                                 <
                                 1
                                 ,
                              
                           
                        where 
                           
                              max
                              {
                              h
                              (
                              i
                              )
                              }
                           
                         is taken over all intensity levels 
                           
                              i
                              =
                              0
                              ,
                              …
                              ,
                              L
                              -
                              1
                           
                        . It is further normalized before being used as the target distribution in the histogram equalization process. The normalization is conducted as
                           
                              (18)
                              
                                 
                                    
                                       h
                                    
                                    
                                       ̂
                                    
                                 
                                 (
                                 i
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ¯
                                          
                                       
                                       (
                                       i
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             L
                                             -
                                             1
                                          
                                       
                                       h
                                       (
                                       i
                                       )
                                    
                                 
                                 ×
                                 N
                                 .
                              
                           
                        
                     

With the use of the normalized histogram, an output image 
                           
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    enh
                                 
                              
                           
                         is obtained through conventional histogram equalization such that
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       enh
                                    
                                 
                                 (
                                 i
                                 )
                                 =
                                 (
                                 L
                                 -
                                 1
                                 )
                                 ×
                                 
                                    
                                       c
                                    
                                    
                                       ̂
                                    
                                 
                                 (
                                 i
                                 )
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       ̂
                                    
                                 
                                 (
                                 i
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       ̂
                                    
                                 
                                 (
                                 j
                                 )
                                 .
                              
                           
                        
                     

Note that at this stage, the image in its gray level equivalence is not yet the final enhanced image in colors.

The histogram equalization process is liable to produce abrupt changes in the output image intensities and this effect is undesirable. In order to cope with the drawback, an intensity re-mapping procedure is developed in this work. In most cases, the abrupt change results in the absence of several intensity levels and this can be detected from inspecting the histogram.

First, intensity indices of non-empty bins are identified to give
                           
                              (20)
                              
                                 z
                                 =
                                 {
                                 z
                                 (
                                 k
                                 )
                                 =
                                 
                                    
                                       h
                                    
                                    
                                       ̂
                                    
                                 
                                 (
                                 i
                                 )
                                 
                                 |
                                 
                                 
                                    
                                       h
                                    
                                    
                                       ̂
                                    
                                 
                                 (
                                 i
                                 )
                                 >
                                 0
                                 }
                                 ,
                              
                           
                        where the parameter 
                           
                              k
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    k
                                 
                                 
                                    max
                                 
                              
                           
                         is a variable that counts the number of non-empty bins in the processed image histogram 
                           
                              
                                 
                                    h
                                 
                                 
                                    ̂
                                 
                              
                              (
                              i
                              )
                           
                        . In other words, the set 
                           
                              z
                           
                         is a collection of non-empty histogram bins. The number of entries 
                           
                              
                                 
                                    k
                                 
                                 
                                    max
                                 
                              
                           
                         is less than the intensity levels L if non-empty bins exist. To this end, the set 
                           
                              z
                           
                         is regarded as a compressed histogram where consecutive bins are non-empty. The intensities of pixels in the non-empty bins are then re-mapped to an evenly distributed intensity range spanning across the entire permissible limits in 
                           
                              [
                              0
                              
                              L
                              -
                              1
                              ]
                           
                        . The re-mapping process can be described by
                           
                              (21)
                              
                                 
                                    
                                       z
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 k
                                 )
                                 ←
                                 
                                    
                                       k
                                       -
                                       1
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             max
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 ×
                                 (
                                 L
                                 -
                                 1
                                 )
                                 .
                              
                           
                        
                     


                        Fig. 3
                         illustrates the histogram re-mapping process. It can be seen that the non-empty bins in the histogram of the image 
                           
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    enh
                                 
                              
                              (
                              i
                              )
                           
                         are not spaced equally before re-mapping. On the other hand, the re-mapping process allocated the non-empty bins in an evenly distributed manner after re-mapping. Therefore, abrupt changes in intensities are alleviated and the occurrences of artifacts are reduced.

In order to accomplish the dual objectives in enhancing the image contrast and to maintain the mean brightness, the choice of the averaging threshold τ, see Eq. (17), is cast as an optimization problem and the efficient golden section search algorithm is adopted for its implementation simplicity [22].

To find the optimal averaging threshold, an objective function for optimization is defined from the information content, entropy 
                           
                              (
                              H
                              )
                           
                        , as an indication of the image contrast. Furthermore, to meet the requirement of minimum brightness change, it is used as a penalty term in the objective function. We have
                           
                              (22)
                              
                                 J
                                 =
                                 
                                    
                                       |
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             m
                                             ,
                                             enh
                                          
                                       
                                       -
                                       
                                          
                                             I
                                          
                                          
                                             m
                                          
                                       
                                       
                                       |
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 ×
                                 H
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    m
                                    ,
                                    enh
                                 
                              
                           
                         is the mean brightness of the processed image 
                           
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    enh
                                 
                              
                           
                        . The variable 
                           
                              H
                           
                         is the entropy given by
                           
                              (23)
                              
                                 H
                                 =
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          L
                                          -
                                          1
                                       
                                    
                                 
                                 p
                                 (
                                 i
                                 )
                                 log
                                 p
                                 (
                                 i
                                 )
                                 ,
                                 
                                 p
                                 (
                                 i
                                 )
                                 =
                                 
                                    
                                       h
                                    
                                    
                                       ̂
                                    
                                 
                                 (
                                 i
                                 )
                                 /
                                 N
                                 .
                              
                           
                        
                     

The objective function 
                           
                              J
                           
                         is then to be maximized. After defining the optimization objective function 
                           
                              J
                           
                        , the proper averaging threshold 
                           
                              
                                 
                                    τ
                                 
                                 
                                    ∗
                                 
                              
                           
                         is determined from Algorithm 1 using golden section search. A final enhanced image 
                           
                              
                                 
                                    I
                                 
                                 
                                    enh
                                 
                              
                           
                         is obtained using the optimal averaging threshold.
                           Algorithm 1
                           Optimization of averaging threshold 
                                 
                                    
                                       
                                       
                                          
                                             Input: reference brightness of input image 
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             Output: optimal averaging threshold 
                                                   
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             Set iteration ratio 
                                                   
                                                      ρ
                                                      =
                                                      0.5
                                                      (
                                                      
                                                         
                                                            5
                                                         
                                                      
                                                      -
                                                      1
                                                      )
                                                      =
                                                      0.618
                                                   
                                                
                                             
                                          
                                          
                                             Set trial thresholds, 
                                                   
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      Δ
                                                      τ
                                                      =
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                 for 
                                                   
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      >
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             Set range limit 
                                                   
                                                      α
                                                      →
                                                      ∊
                                                   
                                                
                                             
                                          
                                          
                                             Carry out enhancement process to obtain 
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                 , 
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                while 
                                                
                                                   
                                                      Δ
                                                      τ
                                                      >
                                                      α
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      >
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                
                                                Set 
                                                   
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      ρ
                                                      ×
                                                      Δ
                                                      τ
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                Do enhancement to obtain 
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                end if
                                             
                                          
                                          
                                             
                                                
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      >
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                
                                                Set 
                                                   
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      (
                                                      1
                                                      -
                                                      ρ
                                                      )
                                                      ×
                                                      Δ
                                                      τ
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                Do enhancement to obtain 
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                end if
                                             
                                          
                                          
                                             
                                                Re-calculate range 
                                                   
                                                      Δ
                                                      τ
                                                   
                                                
                                             
                                          
                                          
                                             
                                                end while
                                             
                                          
                                          
                                             Return optimal averaging threshold 
                                                   
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      (
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                      /
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

@&#EXPERIMENTS@&#

Experiments were conducted to verify the effectiveness of the proposed method both qualitatively and quantitatively. A set of 220 color images were used. These include 20 public available images from http://r0k.us/graphics/kodak/. Others are images captured natural scenery under different environmental conditions such as clear day, night time and poor conditions with overcast weather. The images are delivered in JPEG files of 8-bit data format in each RGB color channel. The image sizes are 
                        
                           300
                           ×
                           400
                        
                      width-by-height.

The qualities of the enhanced images are assessed using the brightness error, contrast, gradient and entropy, see Eq. (23). Statistics of results are also collected and evaluated from their corresponding box plots.

The performance of the averaging histogram equalization AVHEQ is compared to available methods including UNFHE, BBHE, DSIHE, BHEPL, BHEPLD, AIEBHE, MMSICHE and SMHEQ.

The brightness error is defined as the difference between the mean brightness of the input image and the mean brightness of the enhanced image. It can be expressed as [14],
                           
                              (24)
                              
                                 
                                    
                                       I
                                    
                                    
                                       m
                                       ,
                                       enh
                                    
                                 
                                 =
                                 
                                    
                                       I
                                    
                                    
                                       m
                                    
                                 
                                 -
                                 
                                    
                                       I
                                    
                                    
                                       m
                                       ,
                                       enh
                                    
                                 
                                 .
                              
                           
                        
                     

A value close to zero indicates that the mean brightness of the enhanced image is preserved with respect to the input image.

The contrast of the image is given by [19],
                           
                              (25)
                              
                                 O
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          ,
                                          v
                                       
                                    
                                 
                                 
                                    
                                       I
                                    
                                    
                                       enh
                                    
                                 
                                 
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      u
                                                      ,
                                                      v
                                                   
                                                
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   enh
                                                
                                             
                                             (
                                             u
                                             ,
                                             v
                                             )
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     

This performance index takes into account the average intensities and their dispersions around a center pixel. A higher value represents a higher contrast.

The gradient is obtained from [10],
                           
                              (26)
                              
                                 G
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          ,
                                          v
                                       
                                    
                                 
                                 (
                                 Δ
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 Δ
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              Δ
                              u
                              =
                              
                                 
                                    I
                                 
                                 
                                    enh
                                 
                              
                              (
                              u
                              ,
                              v
                              )
                              -
                              
                                 
                                    I
                                 
                                 
                                    enh
                                 
                              
                              (
                              u
                              +
                              1
                              ,
                              v
                              )
                           
                         and 
                           
                              Δ
                              v
                              =
                              
                                 
                                    I
                                 
                                 
                                    enh
                                 
                              
                              (
                              u
                              ,
                              v
                              )
                              -
                              
                                 
                                    I
                                 
                                 
                                    enh
                                 
                              
                              (
                              u
                              ,
                              v
                              +
                              1
                              )
                           
                         are the gradients of the enhanced image. A larger value signifies a sharper image as perceived by the viewer.

A sample of six test images and their outputs from different approaches are shown in Figs. 4–9
                        
                        
                        
                        
                        
                        . The first two are from the benchmark images.

The input for Test Image 1 is shown in Fig. 4(a). The image contains a natural outdoor scene. It is observed that outputs from UNFHE, BBHE, and DSIHE are brighter than the input. For outputs obtained from BHEPL, BHEPLD, AIEBHE, MMSICHE and SMHEQ have brightness close to the input. However, viewing artifacts appear particularly in the homogeneous regions in the sky. The result from the AVHEQ method, which is shown in Fig. 4(j), contains no artifacts. Furthermore, the output image appears more appealing to a viewer with a better color tone and higher contrast. In addition, the change in brightness is not noticeable.

Test Image 2, as shown in Fig. 5, is another sample from the benchmark images. Similar to the observations in Test Image 1, outputs are over-enhanced from the first three methods under comparison. It can be seen that darker regions have become darker and fine details are lost. Other approaches give acceptable enhancement effects, where the AVHEQ output is most satisfactory, as illustrated in Fig. 5(j). In particular, the color cast in the input image is corrected and the contrast is increased.

The input image, Test Image 3, is shown in Fig. 6(a). It is an image captured in poor weather conditions that the contrast is low and the color is non-vivid. Fig. 6(b)–(d) are obtained from approaches based on image separation and equalization toward a uniform distribution. It can be seen that due to abrupt changes in intensity, viewing artifacts occur where several regions are too dark or too bright such that feature details are lost. Results from implementations based on histogram peak clipping are given in Fig. 6(e)–(h). It is observed that artifacts are alleviated but improvements in contrast are not noticeable indicating that a trade-off has to be adopted for these two conflicting goals. Fig. 6(i) contains the output from the smoothing approach. The contrast is improved and artifacts are not present. However, the brightness deviates from the input image. The enhanced image from the proposed method is shown in Fig. 6(j). It is noted that the visual perception is improved where the color is more vivid and contrast is increased. Furthermore, a balance between dark and bright regions is maintained to give a mean brightness close to the input image.

Additional test images, Test Image 4, 5, and 6, and their respective outputs from various enhancements are given in Figs. 7–9. It is observed that results from approaches involving flat histograms, either from equalization to a uniform distribution or becoming uniform after clipping, produce artifacts. These approaches include UNFHE, BBHE, DSIHE, BHEPL, BHEPLD, AIEBHE, and MMSICHE. The undesirable artifacts are mostly found in image regions where the content is relatively monotonic. In particular, flat histograms may not be ideal target references in the equalization process. On the other hand, results from AVHEQ are satisfactory.

Statistics of resultant images are collected and used in the quantitative analysis. Assessment criteria are depicted in box plots to illustrate the performance of test methods across the 220 test images.


                        Fig. 10
                         indicates the measures on mean brightness errors between the input and enhanced images. Comparisons are made to the left-most box, that is, the input image having zero error. Methods under comparison give various degrees of brightness error. The largest spread comes from the uniform histogram equalization as expected since there is no mechanism to preserve the brightness. Approaches based on histogram clipping and the smoothing method also result in wide spreads. It can be seen that clipping is not contributing to brightness preservation while the smoothing approach is not designed for this objective. The proposed method produces the smallest error spread despite the small number of outliers. Furthermore, the average value of the brightness error 0.008 is the smallest among all test methods.

Statistics of the information content or entropy criterion are presented in Fig. 11
                        . It is interesting to observe that due to the histogram equalization operation, resultant entropies except for the proposed approach are reduced. These phenomena can be attributed to the fact that the permitted intensity levels have not been fully utilized. On the other hand, because of the color channel stretching and histogram re-mapping processes, the proposed method is able to use the allowed intensity range more effectively and provides a higher average entropy value at 7.520 against the input images at 7.321. Furthermore, the increase in entropy from the developed method is consistent over the test images as indicated by a compact box plot with close 1st and 3rd quartiles.


                        Fig. 12
                         shows the box plots of the performance measure with respect to image contrast. As expected, the uniform histogram equalization method gives the highest contrast. However, as observed from the quantitative analysis, the output images often contain undesirable viewing artifacts. On the other hand, the smoothing approach gives the next high contrast value but the brightness is not preserved. The output contrast from the proposed method gives an average reading of 0.536, as compared to the input at 0.507, which meets our expectation comparing with other methods. A slight trade-off is resulted from the improvement in brightness preservation and mitigation of artifacts.

The performance metric on gradient is shown in the box plots depicted in Fig. 13
                        . Methods using histogram equalization without clipping produce high gradient measures. As seen from the quantitative analysis, the results often contain unwanted artifacts. Approaches employing histogram clipping contain lower gradient values as compromises are made for artifacts reduction. The smoothing based method gives higher gradient but brightness is not preserved. The proposed approach produces an slight increase in gradient at 0.036 against the input at 0.031. Moreover, artifacts are alleviated and the brightness is preserved in this method.

Further to the box plots, hypothetical tests were carried out to evaluate the AVHEQ performance. In the evaluation, a t-test at 0.05 significance level was adopted for the following hypotheses.
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   o
                                                
                                             
                                             :
                                             
                                             input and output result mean values are equal.
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   1
                                                
                                             
                                             :
                                             
                                             input and output result mean values are not equal.
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The performance metrics compared are the brightness error, entropy, contrast, and gradient for the set of 220 test images. Results are summarized in Table 1
                        .

From the brightness error test hypothesis results, we do not reject the null hypothesis for BBHE, DSHE, MMSICHE and AVHEQ. It is also observed that the p-value of the AVHEQ approach is the smallest at 0.285. Thus, the decision not to reject the null hypothesis is more certain for AVHEQ that the output image brightness is not deviated from the input.

For the hypothesis test on entropy, all null hypotheses of all tested approaches are not accepted and the p-values are all zero. It is evident that the entropies are all different from the input whereas the entropy of the AVHEQ approach is the highest at 7.520.

The hypothetical test result for the contrast criterion shows that the SMHEQ approach performs well where the null hypothesis is rejected. However, the mean contrast of the AVHEQ approach is higher than six other approaches in the comparison as observed from the box plot.

For the gradient criterion, the null hypothesis is not accepted while the p-value tends to zero. This indicates a higher contrast was provided by the AVHEQ approach. Moreover, its mean value is larger than the input image gradients.

@&#CONCLUSION@&#

In this paper, a new procedure for color image contrast enhancement and preservation of mean brightness had been presented. This method is able to release the need to separate the input image into sub-images and equalized independently. It also does not need to clip histograms to prevent artifacts. Instead, a histogram averaging strategy was adopted to produce the target distribution used in the histogram equalization process. The choice of the averaging threshold was optimized by the efficient golden section search algorithm. Furthermore, an intensity re-mapping stage was included to alleviate the generation of artifacts. Together with the color channel stretching pre-processing, the proposed approach is able to produce contrast enhanced images that are more desirable than current available methods in terms of brightness preservation, increased information content, object gradient sharpness and global contrast.

@&#REFERENCES@&#

