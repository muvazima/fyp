@&#MAIN-TITLE@&#An optimized Radial Basis Function model for color characterization of a mobile device display

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel method for characterization of a mobile device display based on Radial Basis Functions is presented.


                        
                        
                           
                           An overview of other state of the art methods for color characterization is given.


                        
                        
                           
                           Compared methods are tested on a number of various mobile devices.


                        
                        
                           
                           It is found that proposed method for color calibration is flexible and very accurate.


                        
                        
                           
                           Future research perspective for further optimization of the model is given.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Approximation methods

Characterization

Colorimetry

Color displays

Neural networks

Piecewise linear approximation

Radial Basis Functions

@&#ABSTRACT@&#


               
               
                  This paper presents an optimized color characterization model based on Radial Basis Functions (RBFs). The performance of the proposed model was tested on a number of different mobile devices and compared with the performance of other state of the art color characterization models. We compared the accuracy of models using the CIELAB color difference. Four different models were discussed in detail: Piecewise Linear Model Assuming Variation in Chromaticity, Polynomial regression, Artificial Neural Network, and proposed Radial Basis Function model. For training and evaluation of the models we measured a large number of color samples on various mobile device displays. Results have shown that our optimized RBF model has superior accuracy over other models with median color difference of 0.39. In addition, it has particularly good accuracy for colors on the boundary of device’s gamut with maximum color difference of 0.87, where other models shown unacceptably high (>10) color difference.
               
            

@&#INTRODUCTION@&#

Mobile devices today are ubiquitous and used in wide range of different applications from personal communication to image reproduction. Equipped with powerful imaging and processing hardware, mobile devices enable users to capture and view high resolution static images and interactive content. The expanding functionality of mobile devices is followed by rapid development of transmissive and emissive mobile display technologies.

Most mobile devices on the market feature an Active Matrix Liquid Crystal Display (AMLCD) or an Active Matrix Organic Light-Emitting diode (AMOLED) display. AMLCD is a transmissive display technology based on controlled orientation of molecules in the liquid crystal (LC) layer through which light passes and forms the rendered image on the display. The LC layer is situated between two electrodes, one being controlled by active-matrix backplane and the other situated beneath the color filter. By controlling the voltage difference between the electrodes, molecular array of liquid crystals can be adjusted, thus controlling the intensity of the transmitted light [1]. Several different configurations of molecules in the LC layer, or Liquid Crystal Display Modes, exist: Twisted-Nematic (TN), In-Plane Switching (IPS), Vertical Alignment (VA) and Patterned Vertical Alignment (PVA). AMOLED represents an emissive display technology. AMOLED panels consist of series of organic thin films situated between two electrodes, a metal-based cathode and transparent anode. Instead of usual RGB subpixel array, AMOLED displays found in mobile devices often feature a RG-BG subpixel array, also known as PenTile array [2]. Compared to AMLCDs, AMOLEDs usually offer wider-viewing angles, better contrast ratio, significantly wider gamut and thinner construction, which make this technology attractive for mobile displays.

The progress and widespread use of mobile technology is not adequately followed by research on colorimetric characterization of mobile devices. The display characterization in general is extensively researched. Authors in [3–5] give an extended overview of methods for characterizing CRT displays. While methods for characterization of LCD displays is given in [6–8]. On the other hand, research on characterization focused just on mobile displays is very limited. Only Piecewise Linear Model Assuming Constant Chromaticity (PLCC), Piecewise Linear Model Assuming Variation in Chromaticity (PLVC), and masking models where applied on mobile device displays [9].

The goal of our paper is to broaden the available research on the subject of color characterization of mobile device displays, and to develop flexible and accurate model for color characterization of mobile device display. We propose a model for color characterization of mobile device display based on Radial Basis Functions (RBFs) and compare its performance against other popular approaches for color characterization: Piecewise Linear Model Assuming Variation in Chromaticity (PLVC), Polynomial regression model, Artificial Neural Network (ANN) model. We compare performance of the models in respect to number of training samples needed and color difference between estimated and measured data. For training and evaluation we use data obtained from twenty different mobile devices with different AMLCD and AMOLED display technologies.

The main goal of the colorimetric characterization of a device is to obtain a model that will accurately transform color information from device dependent color space to device independent color space and vice versa. With the obtained model it is possible to estimate exact driving signals of the device for a needed color. A device dependent color space such are RGB and CMYK color spaces are not absolute color spaces, i.e. they differ from device to device. A device independent color space such are CIEXYZ and CIELAB are absolute and describe color as it is seen by a CIE standard observer [10]. In literature X, Y and Z values of CIEXYZ color space are also known as CIE tristimulus values.

According to [11], all methods or models can be classified in three different groups: the methods that try to physically model the behavior of a color device, the methods based on numerical models, and the methods that are using 3D Look Up Tables (3D LUT).

Physical modeling is usually carried out in three steps. Firstly, the linearization of the tone reproduction curves (TRCs) of the devices’ channels is done by modeling curves with a gamma law (CRT) or S-shaped curves (LCD) [12–17]. When the signals are linearized, transformation from device dependent color space (RGB) to the device independent color space (CIEXYZ) is done. Finally, an offset is added to the output (1).
                        
                           (1)
                           
                              
                                 i
                                 =
                                 M
                                 ·
                                 f
                                 (
                                 d
                                 )
                                 +
                                 o
                              
                           
                        
                     where 
                        
                           i
                        
                      denotes output vector in independent color space; d denotes vector with driving signals in dependent color space, 
                        
                           f
                           (
                           ·
                           )
                        
                      is linearization function; 
                        
                           M
                        
                      represent transformation matrix, while 
                        
                           o
                        
                      denotes offset vector.

Generally, physical models assume a number of simplifying conditions such are channel independence, chromaticity constancy, spatial uniformity, and angle view independence. Channel independence assumes that the primaries of the device operate independently from one another. Chromaticity constancy assumes that each primary has constant chromaticity values regardless of the intensity of a driver signal. Spatial uniformity ensures that the output values will be the same, irrespective of the position on the device. Angle view independence assumes constant output values indifferent to the viewing angle. Color characterization of CRT displays was extensively studied in the past [18–20,12,4,21] and these assumptions where tested and validated in experiments [18,22].

Numerical characterization estimate transformation from a device dependent space to a device independent space using a numerical model. This model can be based on a number of different methods such as polynomial regression of n-th degree [23], neural networks [24,25], sequential linear interpolation [26], or Radial Basis Functions (RBFs) [27,28]. In comparison with the physical models, this approach is able to successfully model devices without assumption of channel independence. However, for this to be possible, large number of measurements are needed. It should be noted that numerical methods are extensively used for characterization of printers as well [6,29].

3D LUT models are based on tables with the information how to translate color information from a device dependent space to a device independent space. The accuracy of the model depends on the number of measurements taken to create the table [30], and the interpolation method to transform the color information for data that is between measurement points [31]. The main disadvantage of this approach is the need for large number of measurements. On the other hand, its advantage is that this approach does not imply any assumptions regarding the display technology.

PLVC model was first proposed in 1980 by Farley and Gutmann in [32]. Later it was extensively used and evaluated for CRT displays [12,33,5] and for LCD displays [7,6,34]. It is extension of Piecewise Linear Model Assuming Constant Chromaticity (PLCC), which it supersedes in accuracy, especially for displays where the chromaticity shift for different illuminance levels is high [11].

According to PLVC model, tristimulus values for any driving signal of the device can be expressed as a sum of tristimulus values for each primary for that driving signal. PLVC model can be generalized for any number of primaries, as well as for any number of possible levels of a driving signal. For a device with N primaries with L possible driving signal levels PLVC model is defined in (2). 
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                X
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      N
                                                   
                                                
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      N
                                                   
                                                
                                                )
                                                )
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         i
                                                         =
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         X
                                                         (
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                         )
                                                         -
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                Y
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      N
                                                   
                                                
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      N
                                                   
                                                
                                                )
                                                )
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         i
                                                         =
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Y
                                                         (
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                         )
                                                         -
                                                         
                                                            
                                                               Y
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                Z
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      N
                                                   
                                                
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      N
                                                   
                                                
                                                )
                                                )
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         i
                                                         =
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Z
                                                         (
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                         )
                                                         -
                                                         
                                                            
                                                               Z
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              X
                              ,
                              Y
                              ,
                              Z
                           
                         denote CIE tristimulus values; 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                         is 
                           
                              i
                              th
                           
                         primary (
                           
                              i
                              ∈
                              [
                              0
                              ,
                              N
                              ]
                           
                        ) and 
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                           
                         is a driving signal level for 
                           
                              i
                              th
                           
                         primary (
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              ∈
                              [
                              0
                              ,
                              L
                              ]
                           
                        ). 
                           
                              
                                 
                                    X
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    k
                                 
                              
                           
                         denote tristimulus values for black level, (i.e. 
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                              
                              ∀
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                        ).

Since the values of the black level are included in every measured sample it is important to subtract it first from all samples, and then add it only once to ensure correct standard observer color space [35].

Main advantage of PLVC model is that it needs only a small number of measured samples. In addition, it is very simple to implement. On the other hand, this model does not take into account channel interdependence.

Implementation of PLVC was done using (2) for 
                           
                              N
                              =
                              3
                           
                         primaries (i.e. R, G and B). Nine different driving signals of each primary were used for the model (
                           
                              Sr
                              ,
                              Sg
                              ,
                              Sb
                              ∈
                              [
                              0
                              ,
                              32
                              ,
                              64
                              ,
                              96
                              ,
                              128
                              ,
                              160
                              ,
                              192
                              ,
                              224
                              ,
                              255
                              ]
                           
                        ). To calculate response of the model for other driving signals, linear interpolation was used as this approach was used in previously published research [7,6,34]. Note that the interpolation method can influence the performance of PLVC, however, this is not within the scope of this paper.

Regression models are statistical models used for estimation of relationships among variables. These well-known methods are used in wide range of applications from data fitting to data prediction. Many different regression methods exist, such as linear, polynomial, robust, Bayesian, and non-parametric.

Polynomial regression is a type of linear regression where the relationships between variables are modeled as n-th degree polynomial. It is often used to model complex nonlinear systems such as optical character recognition [36], multimodal biometrics classification [37], and color characterization [38,39]. General n-th degree polynomial regression model using matrix notation is defined as (3).
                           
                              (3)
                              
                                 
                                    y
                                    =
                                    x
                                    ·
                                    a
                                    +
                                    ε
                                 
                              
                           
                        where 
                           
                              y
                           
                         denotes response vector, 
                           
                              a
                           
                         parameter vector, 
                           
                              ε
                           
                         random error vector, while 
                           
                              x
                           
                         is vector containing independent variables.

Solution of the model in (3) is then given by the well-known normal equation [40]:
                           
                              (4)
                              
                                 
                                    a
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                Tx
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          Ty
                                       
                                    
                                 
                              
                           
                        Eq. (3) is an example of multidimensional polynomial regression model that is easy to use for a multidimensional problem like color characterization of a color device. This approach can successfully take into account channel interdependence by using cross components factors in the model [4,21,34]. This is done by including in vector 
                           
                              x
                           
                         products of driving signals for two or more primaries of a device. Excellent introduction to polynomial regression used for color characterization is given by Kang [41]. In our investigation, two different degrees of regression models were used: Polynomial regression of 2nd degree and polynomial regression of 3rd degree. Polynomial regression of 2nd degree has vector 
                           
                              x
                           
                         with nine interdependent variables (5).
                           
                              (5)
                              
                                 
                                    x
                                    =
                                    [
                                    1
                                    
                                    r
                                    
                                    g
                                    
                                    b
                                    
                                    rg
                                    
                                    rb
                                    
                                    gb
                                    
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     

This model takes into account channel interdependence for any two primaries (i.e. 
                           
                              r
                              ,
                              g
                              ,
                              b
                           
                        ). However, it is not able to model channel interaction for all three primaries. On the other hand, polynomial regression of 3rd degree has 19 variables capable of modeling channel interdependence for all three primaries (6).
                           
                              (6)
                              
                                 
                                    x
                                    =
                                    [
                                    1
                                    
                                    r
                                    
                                    g
                                    
                                    b
                                    
                                    rg
                                    
                                    rb
                                    
                                    gb
                                    
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                    g
                                    
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                    b
                                    
                                    ⋯
                                    
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    r
                                    
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    b
                                    
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    r
                                    
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    g
                                    
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                    
                                    
                                       
                                          g
                                       
                                       
                                          3
                                       
                                    
                                    
                                    
                                       
                                          b
                                       
                                       
                                          3
                                       
                                    
                                    
                                    rgb
                                    ]
                                 
                              
                           
                        
                     

The Artificial Neural Network (ANN) is model that simulates biological nervous system where each neuron of the ANN is analog to nerve cell, and connections between neurons are analog to synapses. An artificial neuron is composed of three parts, inputs with weights, a transfer function and an activation function (Fig. 1
                        ). The transfer function usually adds together values from the weighted inputs, while activation function defines the output of the neuron. There are many types of activation functions used (e.g. identity, step, ramp, logistic) and the type of an activation function influence the behavior of the entire ANN.

The most important property of ANN is its ability to adaptively change the weights in artificial neurons to approximate the intrinsic properties of complex training data and to generalize these learnt properties for similar data not used in the training process. ANN is often used to process complex data in applications such as classification [42] or approximation [43]. Main advantage of ANNs is the ability to adjust to data, without any information regarding the process to be modeled. In addition, ANNs are nonlinear in nature and, therefore, capable to model very complex processes. Finally, they are capable to approximate any function with arbitrary accuracy [44]. However, it should be noted that the accuracy of ANN is still limited with the size of the network and the availability of the data used in training [42]. Furthermore, ANNs are highly nonlinear in parameters which implies the use of nonlinear optimization techniques [45]. Other common problem with ANNs is over-fitting, where the network fits training data well but fails to generalize, i.e., fit data not used for training.

For an ANN architecture we used a simple network with input and output layers and one hidden layer. In the hidden layer as activation function we used logistic function while for the output layer linear function was used. For learning, the ANN model used Levenberg–Marquardt algorithm (LMA). Even though LMA is both time and memory consuming especially if the network has significant number of adaptive weights, it is very popular and often used for training of neural networks [46].

The architecture of the ANN model used in the experiment is shown in Fig. 2
                        . The number of neurons in input and output layers was fixed to three neurons. While the number of neurons in hidden layer was changed in order to find an optimal number of neurons.

We propose a new model based on Radial Basis Function (RBF) methods. It extends the work of Sharma and Shaw [27] and Colantoni et al. [28]. Authors in [27] proposed the use of thin-plate splines function 
                        
                           θ
                           (
                           r
                           )
                           =
                           
                              
                                 r
                              
                              
                                 2
                              
                           
                           ln
                           (
                           r
                           )
                        
                      for color characterization of a printer and thoroughly investigated the influence of size of the training data on the performance of the model. They concluded that this approach is fairly accurate when enough of data points is used for the training of the model. Authors in [28] extended existing research by utilizing additional basis functions, namely biharmonic 
                        
                           θ
                           (
                           r
                           )
                           =
                           r
                        
                     , and triharmonic 
                        
                           θ
                           (
                           r
                           )
                           =
                           
                              
                                 r
                              
                              
                                 3
                              
                           
                        
                      and applied their model on CRT and LCD displays.

In our paper we further the investigation of RBFs by utilizing polyharmonic splines (8) with different k, Gaussian (9) and multiquadric (10) kernels. We investigate how this model performs in color characterization of a number of mobile devices, and optimize it by choosing the RBF kernel 
                        
                           θ
                           (
                           ·
                           )
                        
                      and modifying the scaling factor 
                        
                           ε
                        
                      
                     (7). After the optimization of the model we compare its performance against the performance of already mentioned models (i.e. PLVC, ANN, and polynomial regression).

One other important difference from previous research is that our model doesn’t use smoothing factor used to overcome the problems of the display temporal stability. Reasons why we have discarded this approach is that smoothing factor complicates the model, and our empirical data showed that repeatability between consecutive measurements of mobile device due to temporal variability was very small (
                        
                           Δ
                           
                              
                                 E
                              
                              
                                 ab
                              
                              
                                 ∗
                              
                           
                           <
                           0.01
                        
                     ).

RBF methods are global interpolation methods proposed in [47] and revisited in [48]. The basic idea of RBF interpolation is to choose appropriate function 
                        
                           θ
                           (
                           ·
                           )
                        
                      (also known as kernel), and determine weights 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        
                      depending on given data points (7).
                        
                           (7)
                           
                              
                                 f
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 
                                 θ
                                 ‖
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 ‖
                              
                           
                        
                     where 
                        
                           f
                           (
                           x
                           )
                        
                      is interpolated value at the point 
                        
                           x
                           ,
                           
                              
                                 r
                              
                              
                                 i
                              
                           
                        
                      denotes distance between given data point 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                      to x (i.e. 
                        
                           
                              
                                 r
                              
                              
                                 i
                              
                           
                           =
                           x
                           -
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                     ). 
                        
                           ‖
                           ·
                           ‖
                        
                      is the Euclidean norm.

The choice of function 
                        
                           θ
                           (
                           ·
                           )
                        
                      should be made depending on the class of interpolation problem [31,49]. Some of the kernels used are harmonic, multiquadric, Gaussian and polyharmonic splines.

The main advantage of RBF method is that it works well even if the data points on which fitting is based are scarce or unevenly distributed [49]. This is indeed the case for many applications especially when one wants to optimize a characterization procedure of a color device using as few data points as possible. We implemented RBF network using different kernels 
                        
                           θ
                           (
                           ·
                           )
                        
                     , namely, polyharmonic splines of different order (8), gaussian (9) and multiquadric (10).
                        
                           (8)
                           
                              
                                 θ
                                 (
                                 r
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   for
                                                   
                                                   k
                                                   =
                                                   1
                                                   ,
                                                   3
                                                   ,
                                                   5
                                                   …
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   log
                                                   (
                                                   r
                                                   )
                                                
                                                
                                                   for
                                                   
                                                   k
                                                   =
                                                   2
                                                   ,
                                                   4
                                                   ,
                                                   6
                                                   …
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 θ
                                 (
                                 r
                                 )
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             (
                                             ε
                                             r
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (10)
                           
                              
                                 θ
                                 (
                                 r
                                 )
                                 =
                                 
                                    
                                       1
                                       +
                                       
                                          
                                             (
                                             ε
                                             r
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Note that scaling constant 
                        
                           ε
                        
                      has impact on the overall performance of the model, especially for Gaussian. We have empirically found that optimal value for 
                        
                           ε
                        
                      is from 2 to 5. In experiments we used 
                        
                           ε
                           =
                           3
                        
                     .

After RBF function is chosen, weights 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        
                      needed for the model are determined by using already mentioned normal equation [40]:
                        
                           (11)
                           
                              
                                 w
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             T
                                          
                                       
                                       θ
                                       )
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       T
                                    
                                 
                                 x
                              
                           
                        
                     where 
                        
                           w
                           ,
                           
                           θ
                        
                      and 
                        
                           x
                        
                      denote matrices of weights 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        
                     , coefficients 
                        
                           θ
                           (
                           
                              
                                 r
                              
                              
                                 i
                              
                           
                           )
                        
                     , and given data points 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                      respectively.

Experimental setup is shown in Fig. 3
                     . Device dependent values in RGB space were sent to a mobile device using web based script. Response of the mobile device is then measured with luminance and color meter connected to a computer. Finally, measurements and device dependent values were used for training of models.

For data acquisition we used 20 different mobile devices from various manufacturers and with different display technologies.
                           1
                           Measurements can be downloaded from: http://repro.grf.unizg.hr/media/Measurements_displays.zip.
                        
                        
                           1
                         For each device 729 uniformly spaced color samples (i.e. different RGB combinations) were measured from black (RGB=0,0,0) to white (RGB=255,255,255). To avoid possible changes in brightness level during measurement, all devices were set to have fixed maximum brightness.

All measurements were done in CIEXYZ color space. Measuring distance from the device was 350mm±1mm, and angle from the normal was 0°±0.5°. Measurements were taken in completely dark room (illuminance 
                           
                              E
                              <
                              
                                 
                                    10
                                 
                                 
                                    -
                                    4
                                 
                              
                           
                        
                        lx). For measurement we used Konica Minolta CS-200 luminance and color meter with following parameters: Measurement time 2s, Viewing angle 2°. To avoid possible errors due to instability of the device’s display, each color sample was measured two times and mean was calculated. Distance from the display and viewing angle give measuring area 
                           
                              
                                 
                                    A
                                 
                                 
                                    m
                                 
                              
                              =
                              117.25
                           
                        
                        mm2. With fixed measuring area the number of pixels measured depended only on spatial resolution of device (e.g. for the resolution of 10px/mm the number of pixels measured is 11,725). This large number of pixels, and the focus of measuring device set to infinity, minimizes the possibility of the influence of pixel variations on measurements.

After acquisition, measured data was uniformly divided in two subsets: a training subset used for training of the models, and the evaluation subset used for performance evaluation. Therefore, for training of models 365 equally spaced samples were used, while for evaluation 364 samples were used. Note that for PLVC model only 27 samples were used (nine for each primary).

As already mentioned, to avoid the influence of the different brightness between devices all displays have been set to their maximum brightness settings. This, however, still results in very different lightness values for different devices. These large differences are due to different technologies displays are using. We can neutralize this difference in measured lightness across devices by normalization of all measured values according to its maximum value for a given device (12):
                           
                              (12)
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                max
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                         denotes normalized Y value in CIEXYZ color space; 
                           
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                           
                         is measured Y value, and 
                           
                              
                                 
                                    Y
                                 
                                 
                                    max
                                 
                              
                           
                         maximum Y value of all measurements of a given device.

To evaluate the accuracy of a model, obtained results and measured evaluation samples were converted from CIEXYZ color space to more convenient CIELAB color space. As a white point needed for the conversion from CIEXYZ to CIELAB color space, standard illuminant CIE D65 was used. We choose this illuminant as a white point since most LCD displays white point is near this illuminant [6], and it is recommended by CIE to be used for all colorimetric calculations requiring representative daylight illuminant [50]. However, note that the choice of the illuminant, if used consistently, will not influence the colorimetric comparison. For quantification of the color rendering accuracy of models, CIELAB color difference system was used. Color difference 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                           
                         is defined in (13). It is the Euclidean distance of two respective colors in CIELAB color space.
                           
                              (13)
                              
                                 
                                    Δ
                                    
                                       
                                          E
                                       
                                       
                                          ab
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                (
                                                Δ
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                Δ
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                Δ
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              Δ
                              
                                 
                                    L
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                              Δ
                              
                                 
                                    a
                                 
                                 
                                    ∗
                                 
                              
                           
                         and 
                           
                              Δ
                              
                                 
                                    b
                                 
                                 
                                    ∗
                                 
                              
                           
                         denote difference between respective colors in CIELAB color space for lightness axis (
                           
                              
                                 
                                    L
                                 
                                 
                                    ∗
                                 
                              
                           
                        ) and two chromatic axis 
                           
                              (
                              
                                 
                                    a
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                        .

@&#RESULTS@&#

The results were obtained by calculating 
                        
                           Δ
                           
                              
                                 E
                              
                              
                                 ab
                              
                              
                                 ∗
                              
                           
                        
                      between measured values of evaluation colors and values estimated by a model. Calculation was done for all evaluation color samples and for each device. Results were then averaged according to (14). 
                        
                           (14)
                           
                              
                                 Δ
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             ab
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       j
                                    
                                 
                              
                           
                        
                     where i denotes i-th device; j denotes j-th test color sample; 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 j
                              
                           
                        
                      is color difference for given color sample and device; and N is total number of measured devices.

Before comparison of accuracy of all models, ANN and RBF models were first tested using different settings to find an optimum regarding accuracy and computational costs. For the ANN model, we optimized the number of neurons in the hidden layer, while for RBF model we used different basis functions 
                        
                           Θ
                           (
                           ·
                           )
                        
                     .

In ANN model the number of neurons in the network directly influences capability of modeling and complexity of implementation. This is confirmed by our experiment. As one can see in Fig. 4
                         the number of neurons in hidden layer of an ANN has strong impact on 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                           
                        . If the number of neurons is insufficiently small (i.e. less than six), the ANN model is not able to accurately characterize a display. An increase of the number of neurons improves the accuracy of the model. However, when the number of neurons reaches 17 there is no more improvement and accuracy remains the same.

To optimize RBF model for a function 
                           
                              Θ
                              (
                              ·
                              )
                           
                        , we first used polyharmonic spline (8) with different k. We have shown that depending on the order k of polyharmonic spline, RBF model will have different performance. We calculated the accuracy for various k and found that the optimal value for k is 4. When this value is used RBF model has mean 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              0.46
                           
                         and median 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              0.39
                           
                        . This order shows slightly better results than 
                           
                              k
                              =
                              3
                           
                         which can also be used. Other orders have lower accuracy (Fig. 5
                        ). Note that authors in [28] report worse results of triharmonic kernel (
                           
                              k
                              =
                              3
                           
                        ) for two LCD devices they tested (mean 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              0.783
                           
                         and 0.956).

When we found optimal order for polyharmonic spline, we further our analysis by comparison of the accuracy of the RBF models that are using different basis functions 
                           
                              Θ
                              (
                              ·
                              )
                           
                        . Fig. 6
                         shows that for the task of display characterization, polyharmonic spline (with 
                           
                              k
                              =
                              4
                           
                        ) and multiquadric have almost the same accuracy, while accuracy of RBF with Gaussian is slightly worse. Median 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                           
                         values for polyharmonic (
                           
                              k
                              =
                              4
                           
                        ), Gaussian and multiquadric functions were 0.39, 0.49 and 0.41 respectfully.

Performance of a model and its usability for modeling depends on a number of training samples needed for accurate modeling. PLVC has in this respect an advantage over other models since it requires only a few measurements. Other models need larger set of training samples. To determine an optimal size of training set, we changed number of training samples and calculated the accuracy of models. Results of this investigation are shown in Figs. 7 and 8
                        
                         Optimal number of training set for ANN and RBF model is around 150, while for polynomial regression of 3rd degree is around 100. Note that an increase of training set size above mentioned optimal values has very little impact on median 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                           
                        . Nevertheless, caution should be taken when choosing the size of training set since with reduction of training samples, all models showed a strong increase in error for 95th percentile 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                           
                         (Fig. 8). This fact implies that larger number of training samples can ensure better accuracy for extreme colors that are at the boundary of device’s gamut (e.g. pure primaries and combinations of pure primaries). We also conducted this comparison for RBF models using different functions and found that RBF with Multiquadric function have better accuracy for low number of samples (<50) then with other functions. However, with 95th Percentile 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              >
                              20
                           
                        , this fact have little practical importance.

Finally, with optimized models, we proceed with the comparison of accuracy for all models. The results are given in Table 1
                         and illustrated in informative boxplot on Fig. 9
                        . RBF model with Polyharmonic spline of order 
                           
                              k
                              =
                              4
                           
                         showed superior performance when compared to other models. With median 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              0.39
                           
                         it is clearly much more accurate than any other model. Further, 95th percentile 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              0.87
                           
                         and maximum 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              2.28
                           
                         shows that this model is not only capable to accurately estimate overall response of the device, but also estimate response even for colors that are at the boundary of device gamut. This is comparable with the best reported results in [28] of 95th percentile 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              0.376
                           
                         and maximum 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              1.132
                           
                         for triharmonic kernel (it should be noted here that their results for maximum and 95th percentile ware reported only for one CRT device).

Second best model for characterization of mobile displays is ANN model with median 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              1.25
                           
                         This value is still considered to be acceptable for characterization. However, this model has much worse accuracy when it comes to colors at the boundary of gamut with maximum 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              10.25
                           
                         and 95th percentile 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              4.46
                           
                        .

Polynomial regression of second degree is the worst of all tested methods. Even though second degree polynomial in theory can model channel interdependence between any two primaries, in practice this is not enough (median 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              5.31
                           
                        ) since it fails to estimate interdependence of all three primaries, especially on gamut boundary. Polynomial regression of 3rd degree is in that respect better and, with acceptable median color difference of 2.47, is among better models. However, with maximum 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              19.64
                           
                         it fails when it comes to estimation of colors on gamut boundary. Note that higher degrees of polynomial cannot address this problem. On the contrary, due to Runge’s phenomenon, higher order polynomials show even worse results.

Even though PLVC model has somewhat high median color difference (median 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              4.01
                           
                        ), it is actually much better when it comes to overall accuracy, including colors on the gamut boundary (maximum 
                           
                              Δ
                              
                                 
                                    E
                                 
                                 
                                    ab
                                 
                                 
                                    ∗
                                 
                              
                              =
                              10.63
                           
                        ). With only 27 data points used for characterization it outperforms polynomial regression models. Reason for this is the fact that all 27 data points used belong to pure primaries and combination of pure primaries.

@&#CONCLUSION@&#

In this paper we have implemented and analyzed different models for color characterization of mobile device’s display. We have also improved accuracy RBF model by choosing optimal parameters. We conclude that for simple ANN model, the number of neurons in hidden layer is crucial for accuracy of the model. An increase of neurons in the layer improves accuracy. However, after the number of neurons in the hidden layer reaches 17 there is no further improvement.

For proposed RBF model, the accuracy of color characterization can be also optimized by choosing an adequate basis function. The best results were obtained for polyharmonic spline kernel of 4th order.

Our investigation of the importance of the size of a training set leads to conclusion that optimum size for ANN and RBF is around 150 samples, while for Polynomial regression models is around 100 samples. Smaller training sets can still lead to models with good average accuracy, but these models will have unacceptable maximum color difference.

Global comparison of all tested models showed that RBF based models have superior performance over other methods. These is especially true for pure primary and secondary colors. These colors are very hard to estimate since they are positioned at the border of device’s gamut. Even though RBF using Gaussian or multiquadric functions are worse than RBF with polyharmonic spline, they are still more accurate than any other tested model, especially for boundary colors. In addition, we can conclude that RBF model with multiquadric function is better option if only a small training set is available.

Future investigation could be focused on distribution of color samples in training set. More extended experiments are needed, but we presume that by carefully choosing color samples used for training, further optimization of a model is possible. Other possible research directions are modification of PLVC model in order to include channel interdependence, or modification of architecture of ANN model to improve its overall accuracy.

@&#REFERENCES@&#

