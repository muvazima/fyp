@&#MAIN-TITLE@&#Interactive design and simulation of tubular supporting structure

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A system integrating design and simulation of freeform tube structures is presented


                        
                        
                           
                           We provide an intuitive shape design mechanism to manipulate the geometry of tubes


                        
                        
                           
                           We propose a two-level subspace simulation to enable fast analysis of tube structures


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Thin shell

Swept surface

FEM

Model reduction

Domain decomposition

@&#ABSTRACT@&#


               
               
                  This paper presents a system for design and simulation of supporting tube structure. We model each freeform tube component as a swept surface, and employ boundary control and skeletal control to manipulate its cross-sections and its embedding respectively. With the parametrization of the swept surface, a quadrilateral mesh consisting of nine-node general shell elements is automatically generated and the stress distribution of the structure is simulated using the finite element method. In order to accelerate the complex finite element simulation, we adopt a two-level subspace simulation strategy, which constructs a secondary complementary subspace to improve the subspace simulation accuracy. Together with the domain decomposition method, our system is able to provide interactive feedback for parametric freeform tube editing. Experiments show that our system is able to predict the structural character of the tube structure efficiently and accurately.
               
            

@&#INTRODUCTION@&#

Tubes serve as a type of important supporting structure and are commonly used in people’s everyday life (Fig. 1). Traditionally, such supporting structures are often hollow to conserve the manufacture cost and self-weight. They mostly consist of regular cylinders, which are more budget-friendly for mass production with traditional manufacturing techniques. On the other hand, the rapid development of prototype technology (e.g. 3D printing) makes personalized and customized tube fabrication using generalized cylinders conveniently possible, which greatly expands the designing space of supporting tubes.

Although most existing computer-aided design (CAD) softwares (e.g. AutoCAD) well support the geometric design of such tubular structures. Users still need to manipulate many geometric degrees of freedom (DOFs) to model freeform tubes. Interpolatory and tangential controls at the boundary cross-sections are two widely-adopted mechanisms to control the shape of the tube. However, profile control [1] or solving higher-order differential equations [2] is still necessary to prevent shape distortion, which is often tedious or time-consuming. On the other hand, existing CAD packages merely focus on the aspect of shape editing while the structural properties of the 3D model remain unknown to novice users. Following the trend of design-simulation integration, current commercial produces start to enable user to analyze their design using finite element method. Unfortunately, an accurate simulation of the structural characteristic of a customized tubular structure is expensive because generalized shell element with high-order shape functions is usually required to avoid shear-locking artifact [3] and a simulator often possesses a large number DOFs that is prohibitive to regular desktop computers, not to mention performing interactive structural analysis of the 3D model being edited.
                  

As a response to the aforementioned challenges, we present a system for interactive design and simulation of supporting tubular structures. Tube components can be intuitively edited using boundary and skeletal controls and a complex tube system can be handily created by assembling tube components at their open interfaces. The underlying simulation is carried out using general quadratic nine-node quadrilateral element. A constraint subspace is constructed at each component, which serves as the primary subspace for the follow-up structural analysis. On the top of the constraint subspace, we build a load-dependent secondary subspace named residual subspace, which is able to precisely capture the detailed intra-component deflection due to the regional external loads without resorting to expensive full-space simulation. As a result, our system is able to provide interactive yet accurate structural analysis along with the editing operation of the tube.


                     Contribution In general, the contribution of our work can be briefly summarized as follows:

                        
                           •
                           This paper presents a system integrating parametric shape editing and finite element method based structural analysis into a unified environment for the design and simulation of freeform tubular supporting structures.

We provide user an intuitive shape design mechanism with lower geometric DOFs by using the boundary and skeletal controls to manipulate the geometry of each tube component.

A new simulation strategy is proposed based on the fact that the supporting tube is often of light self-weight comparing to its external loads. We use a two-level subspace simulation that is able to accurately capture the deflection induced by external loads while still keep the simulator compact.

@&#RELATED WORK@&#


                     Swept surface is often used to model general cylinders [4] by transforming cross-section curves along a smooth rotation field on a swept trajectory. Topics such as how to design smooth rotation field on a given trajectory [5,6], how to interpolate cross-section curves [7,8] and how to support profile editing [9,10] are all well studied in the literature. However, it is tedious to manipulate lots of control vertices of swept surfaces represented by standard tensor product spline surfaces. Recently, You et al. [1] suggest modeling swept surfaces by solving ordinary differential equations (ODE). They showed that interpolatory and tangential boundary controls are available by using fourth-order ODE, which leads to lower DOFs in controlling the shape of swept surfaces. They also derived analytical solutions to six-order partial differential equations and gave extra curvature control to swept surfaces [11]. The similar idea is also exploited in shape modeling using meshed surfaces. In [2,12], the authors showed that generalized cylinders can be obtained by solving harmonic and higher-order harmonic equations. In our system, the geometric design of freeform supporting tubes is motivated by these existing studies.


                     Thin shell element is a natural choice for the tubular structure, which has a high width-thickness ratio. Such degeneracy motivates researchers, especially in graphics community, to seek for alternative energy models to capture the deformation of thin shell in a more efficient and intuitive manner such as spline/NURBS [13–15], hinge-based bending [16–19], or meshless method [20–22], rather than resorting to classic strain theory [23]. Zhang et al. [24] proposed to use 1D orientated rod element with incremental strain theory to model the thin shell structure, which could be considered as an extended version of mass-spring system. While compelling results have been reported, these methods only produce physically plausible animations while we are looking for an accurate simulation that directly serves for potential follow-up fabrication (e.g. via 3D printing).


                     Design-simulation integration has received increased attention recently and fabrication-purposed design system becomes an active research topic. Simulation based optimization has been widely applied to make sure the fabricated object possesses the desired structural robustness [25–27], kinematic constraints [28,29], and deformable behavior [30–32]. There are also many contributions trying to unify the simulation and the design processing. Umetani et al. [33] present a garment designing system that allows an interactive editing between 2D patterns and 3D simulated draped forms. Cirak et al. [34] propose to use subdivision surface for the design-simulation integration for thin-shell objects.


                     Simulation acceleration stands out a grand technical challenge for the integration of design simulation because an accurate finite element method (FEM) [3] simulation is often expensive while timely-coupled design-simulation environment is always favored. To accelerate the FEM simulation of thin shell, Seth et al. [35] employ a multi-resolution framework. In regular FEM simulation of 3D solid volume, subspace modal reduction is a widely used technique [36–38] and it can also be applied to accelerate thin-shell simulation [39].


                     Our method well complements exiting contributions by developing a design-simulation framework based on domain decomposition [40] and finite element tearing and interconnect (FETI) method [41], as we notice that tubular structures are often component-wise and the geometric symmetry commonly exists. The geometry of each tube component is dealt with using boundary and skeletal controls. The structural behavior is simulated using quadratic nine-node quadrilateral mesh automatically generated via the surface parametrization, which will assign five DOFs for each free node. To accelerate the simulation, we construct the component-level subspace based on an engineering technique named component mode synthesis (CMS) [42,43]. Improved simulation accuracy is achieved by computing the residual deflection within a load-dependent secondary subspace. As a result, our system is able to provide accurate stress analysis while keeping the simulator compact and efficient.


                     Fig. 2
                      sketches an overview of the proposed design-simulation system. The entire structure is composed of multiple tubular components which are inter-connected at their interfaces. The shape of each component is modeled as a swept surface that can be freely edited with an intuitive interface that allows users to manipulate key cross-section curves and their trajectory (Section 4). Based on the parameterization, a quadrilateral finite element mesh is automatically generated. Each of its element is a nine-node quadratic shell element (Section 5), where the mid-edge nodes are determined using cubic Hermite interpolation. We adopt a two-level subspace simulation strategy to accelerate the simulation so that an interactive structural analysis is made possible (Section 6) and the stress distribution can be timely visualized by the designer to ensure the tubular model is robust and stable under the prescribed external loads.

Our goal of the geometric design is to provide users intuitive and flexible controls of freeform tubular components, which are modeled using swept surfaces in our system. Similar
                      to previous works [1], we use boundary constraints to manipulate geometric variation of the cross-section of the tube along the neutral axis instead of using control vertices for the tensor product spline surfaces, since it is intuitive and requires fewer control parameters. Instead of profile editing introduced in [1], we employ the sweep trajectory to control the design in our system, or namely skeletal control. Comparing to multiple profile curves, one freeform tube only have one sweep trajectory, which significantly eases the overall shape editing operation. Specifically, as shown in Fig. 3, our system allows users to control (1) the sweep trajectory 
                        
                           S
                           (
                           v
                           )
                           ,
                        
                      (2) a few key cross-section curves 
                        
                           
                              C
                              i
                           
                           
                              (
                              u
                              )
                           
                           =
                           C
                           
                              (
                              u
                              ,
                              
                                 v
                                 i
                              
                              )
                           
                        
                      at 
                        
                           S
                           (
                           
                              v
                              i
                           
                           )
                           ,
                        
                      and (3) each key cross-section curve’s variation at both extensions 
                        
                           
                              D
                              −
                           
                           
                              (
                              u
                              ,
                              
                                 v
                                 i
                              
                              )
                           
                        
                      and 
                        
                           
                              D
                              +
                           
                           
                              (
                              u
                              ,
                              
                                 v
                                 i
                              
                              )
                           
                           ,
                        
                      such that 
                        
                           
                              D
                              −
                           
                           
                              (
                              u
                              ,
                              
                                 v
                                 i
                              
                              )
                           
                        
                      and 
                        
                           
                              D
                              +
                           
                           
                              (
                              u
                              ,
                              
                                 v
                                 i
                              
                              )
                           
                        
                      are the tangent directions. The output swept surface 
                        
                           C
                           (
                           u
                           ,
                           v
                           )
                        
                      at 
                        
                           [
                           
                              v
                              i
                           
                           ,
                           
                              v
                              
                                 i
                                 +
                                 1
                              
                           
                           ]
                        
                      must satisfy the following conditions:

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          C
                                          
                                             (
                                             u
                                             ,
                                             
                                                v
                                                i
                                             
                                             )
                                          
                                          =
                                          
                                             C
                                             i
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          ,
                                          
                                          
                                             
                                                ∂
                                                C
                                                (
                                                u
                                                ,
                                                
                                                   v
                                                   i
                                                
                                                )
                                             
                                             
                                                ∂
                                                v
                                             
                                          
                                          =
                                          
                                             D
                                             +
                                          
                                          
                                             (
                                             u
                                             ,
                                             
                                                v
                                                i
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          C
                                          
                                             (
                                             u
                                             ,
                                             
                                                v
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             C
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          ,
                                          
                                          
                                             
                                                ∂
                                                C
                                                (
                                                u
                                                ,
                                                
                                                   v
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                ∂
                                                v
                                             
                                          
                                          =
                                          
                                             D
                                             −
                                          
                                          
                                             (
                                             u
                                             ,
                                             
                                                v
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

You et al. [1] presented a formulation to construct the swept surface with the above constraints by solving a fourth-order ODEs. Unfortunately, we found that this approach yields unpleasant shape distortion if the boundary tangents are not in parallel, as shown in Fig. 4(a) . To prevent such distortion, extra control information must be provided from the user such as profile control [1] or curvature control [2,11], which inevitably induces more editing freedoms and could potentially make novice users confusing.

Alternatively, we combine the rotation minimizing frames (RMF) [6] together with the existing ODE-based techniques. The geometry of the swept surface is decoupled into two parts: the shape defined by cross-sections and their 3D embedding defined by sweep trajectories. In our system, we constrain each cross-section curve 
                        
                           C
                           (
                           u
                           ,
                           
                              v
                              i
                           
                           )
                        
                      to be planar and the editing operations associated with cross-section curves are performed with an intuitive 2D user interface. Suppose a rigid transformation T(v) maps a planar curve 
                        
                           
                              C
                              ˜
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        
                      to 
                        
                           C
                           (
                           u
                           ,
                           v
                           )
                           ,
                        
                      we call 
                        
                           
                              C
                              ˜
                           
                           
                              (
                              u
                              ,
                              
                                 v
                                 t
                              
                              )
                           
                        
                      the shape of cross-section at 
                        
                           v
                           =
                           
                              v
                              t
                           
                        
                     . Given a sparse set of key cross-section shapes 
                        
                           
                              
                                 C
                                 ˜
                              
                              i
                           
                           
                              (
                              u
                              )
                           
                           =
                           
                              C
                              ˜
                           
                           
                              (
                              u
                              ,
                              
                                 v
                                 i
                              
                              )
                           
                        
                      for 
                        
                           i
                           =
                           1
                           ,
                           ⋯
                           ,
                           n
                        
                      and a sweep trajectory 
                        
                           S
                           (
                           v
                           )
                           ,
                        
                      we are computing for interpolated cross-section shapes 
                        
                           
                              C
                              ˜
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        
                      and transformations T(v) for all vi
                      ∈ [v
                     1, vn
                     ]. The transformation T(v) is composed of a translation t(v) and a rotation R(v). We define the translation 
                        
                           
                              t
                           
                           (
                           v
                           )
                           =
                           S
                           (
                           v
                           )
                           ,
                        
                      to make the cross-section curves sweep coincide with the specified trajectory 
                        
                           S
                           (
                           v
                           )
                        
                     . The rotation R(v) is computed by using the RMF on 
                        
                           S
                           (
                           v
                           )
                        
                     . Besides interpolatory constraints, we also allow users to control the tangent in the shape space of cross-sections. Specifically, we embed all planar cross-section shapes in 3D by defining v as the height (z direction) of 
                        
                           
                              C
                              ˜
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           ,
                        
                      as shown in Fig. 3. The tangential controls 
                        
                           
                              
                                 D
                                 ˜
                              
                              +
                           
                           
                              (
                              u
                              ,
                              
                                 v
                                 i
                              
                              )
                           
                        
                      and 
                        
                           
                              
                                 D
                                 ˜
                              
                              −
                           
                           
                              (
                              u
                              ,
                              
                                 v
                                 i
                              
                              )
                           
                        
                      in the shape space of cross-sections are also defined in this embedding. 
                        
                           
                              C
                              ˜
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        
                      is solved with the following tangential constraints:

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             C
                                             ˜
                                          
                                          
                                             (
                                             u
                                             ,
                                             
                                                v
                                                i
                                             
                                             )
                                          
                                          =
                                          
                                             C
                                             i
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          ,
                                          
                                          
                                             
                                                ∂
                                                
                                                   C
                                                   ˜
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   
                                                      v
                                                      i
                                                   
                                                   )
                                                
                                             
                                             
                                                ∂
                                                v
                                             
                                          
                                          =
                                          
                                             
                                                D
                                                ˜
                                             
                                             +
                                          
                                          
                                             (
                                             u
                                             ,
                                             
                                                v
                                                i
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             C
                                             ˜
                                          
                                          
                                             (
                                             u
                                             ,
                                             
                                                v
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             C
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          ,
                                          
                                          
                                             
                                                ∂
                                                
                                                   C
                                                   ˜
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   
                                                      v
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                ∂
                                                v
                                             
                                          
                                          =
                                          
                                             
                                                D
                                                ˜
                                             
                                             −
                                          
                                          
                                             (
                                             u
                                             ,
                                             
                                                v
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     We take the shape on the plane 
                        
                           z
                           =
                           
                              v
                              j
                           
                        
                      as the interpolated cross-section at 
                        
                           v
                           =
                           
                              v
                              j
                           
                        
                     . Note that in our system, 
                        
                           
                              
                                 D
                                 ˜
                              
                              −
                           
                           
                              (
                              u
                              ,
                              
                                 v
                                 i
                              
                              )
                           
                        
                      and 
                        
                           
                              
                                 D
                                 ˜
                              
                              +
                           
                           
                              (
                              u
                              ,
                              
                                 v
                                 i
                              
                              )
                           
                        
                      provide only tangential control in the shape space of cross-sections. They are not the tangents on the swept surface if the sweep trajectory is not straight. In our implementation, we set 
                        
                           
                              
                                 D
                                 ˜
                              
                              ±
                           
                           
                              (
                              u
                              ,
                              
                                 v
                                 i
                              
                              )
                           
                           =
                           
                              
                                 R
                              
                              ⊤
                           
                           
                              (
                              v
                              )
                           
                           
                              D
                              ±
                           
                           
                              (
                              u
                              ,
                              
                                 v
                                 i
                              
                              )
                           
                           ,
                        
                      where R(v) is the rotation of the RMF at v.

As shown in Fig. 4(b), with the same boundary conditions, swept surfaces using our method are free of distortion. In this example, the sweep trajectory is defined by a cubic Bezier curve whose end points and tangents are the same with the input boundary conditions. If profile control is still required, users can simply insert extra key cross-section curves to control the profile. Note that although existing commercial products support cross-section sketching followed by sweep path design, tangential control is mostly applied on the sweep trajectory but not on the surface. An alternative way is to directly manipulate on the control points, which leads to heavier data and interactions.

Since the cross-sections are interpolated analytically and the RMFs are computed explicitly, the computation associated with editing operations is negligible. Please note that our current system does not explicitly handle the self-intersection, which could be possible for highly curved tubes. An alert will be sent as soon as the user’s editing leads to any self-collisions or intersections.

Shell element is a degenerated structural element. Unlike regular 3D solid volumetric elements such as brick or tetrahedra, the dimension along its thickness is much smaller (e.g. over 50 times) than the other two dimensions. Such degeneracy leads serious numerical stability issue. As a result, necessary geometric/kinematic constraints and simplifications must be assumed. This section will briefly explain the finite element formulation of the nine-node quadrilateral shell element. We refer readers to the related literature [3,44], for a more detailed derivation.

The parametrization of the swept surface handily generates a quadrilateral mesh. Each four-node quadrilateral will be converted into a nine-node quadratic shell element. The extra mid-edge nodes are determined by using cubic Hermite interpolation so that the resulting nine-node element has smoothly-curved edges. For the ease of derivation, we adopt the isoparametric formulation, which begins with a standard shell element (Fig. 5
                     ) defined in a virtual rst coordinate frame or natural coordinate frame. This element spans from 
                        
                           −
                           1
                        
                      to 1 in both r and s directions. For elements with arbitrary location and geometry, we take use of the Jacobian matrix to map it back to the real coordinate system.

For an arbitrary mass point within the element, all of its kinematic terms are interpolated using nodal shape functions. Shape functions always have ones at their host nodes and vanished values at the other nodes. High-order shape function can be considered as the superposition of the scaled low-order ones. Based on this property, the shape function of this standard element can be easily written as:

                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          
                                             h
                                             1
                                          
                                          =
                                          
                                             1
                                             4
                                          
                                          
                                             (
                                             1
                                             +
                                             r
                                             )
                                          
                                          
                                             (
                                             1
                                             +
                                             s
                                             )
                                          
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             h
                                             5
                                          
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             h
                                             8
                                          
                                          −
                                          
                                             1
                                             4
                                          
                                          
                                             h
                                             9
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                             2
                                          
                                          =
                                          
                                             1
                                             4
                                          
                                          
                                             (
                                             1
                                             +
                                             r
                                             )
                                          
                                          
                                             (
                                             1
                                             +
                                             s
                                             )
                                          
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             h
                                             5
                                          
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             h
                                             6
                                          
                                          −
                                          
                                             1
                                             4
                                          
                                          
                                             h
                                             9
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                             3
                                          
                                          =
                                          
                                             1
                                             4
                                          
                                          
                                             (
                                             1
                                             +
                                             r
                                             )
                                          
                                          
                                             (
                                             1
                                             +
                                             s
                                             )
                                          
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             h
                                             6
                                          
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             h
                                             7
                                          
                                          −
                                          
                                             1
                                             4
                                          
                                          
                                             h
                                             9
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                             4
                                          
                                          =
                                          
                                             1
                                             4
                                          
                                          
                                             (
                                             1
                                             +
                                             r
                                             )
                                          
                                          
                                             (
                                             1
                                             +
                                             s
                                             )
                                          
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             h
                                             7
                                          
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             h
                                             8
                                          
                                          −
                                          
                                             1
                                             4
                                          
                                          
                                             h
                                             9
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                             5
                                          
                                          =
                                          
                                             1
                                             2
                                          
                                          
                                             (
                                             1
                                             +
                                             r
                                             )
                                          
                                          
                                             (
                                             1
                                             +
                                             s
                                             )
                                          
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             h
                                             9
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                             6
                                          
                                          =
                                          
                                             1
                                             2
                                          
                                          
                                             (
                                             1
                                             +
                                             r
                                             )
                                          
                                          
                                             (
                                             1
                                             +
                                             s
                                             )
                                          
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             h
                                             9
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                             7
                                          
                                          =
                                          
                                             1
                                             2
                                          
                                          
                                             (
                                             1
                                             +
                                             r
                                             )
                                          
                                          
                                             (
                                             1
                                             +
                                             s
                                             )
                                          
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             h
                                             9
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                             8
                                          
                                          =
                                          
                                             1
                                             2
                                          
                                          
                                             (
                                             1
                                             +
                                             r
                                             )
                                          
                                          
                                             (
                                             1
                                             +
                                             s
                                             )
                                          
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             h
                                             9
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                             9
                                          
                                          =
                                          
                                             (
                                             1
                                             −
                                             
                                                r
                                                2
                                             
                                             )
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                s
                                                2
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     Fig. 5 shows a nine-node shell element in the rest (left) and deflected (right) configurations respectively, indicated with the superscript l. When 
                        
                           l
                           =
                           0
                           ,
                        
                      the corresponding variable is at the rest configuration; when 
                        
                           l
                           =
                           1
                           ,
                        
                      the corresponding variable is at the deflected configuration. A unit vector 
                        
                           
                              
                              l
                           
                           
                              
                                 v
                              
                              n
                              k
                           
                           =
                           
                              
                                 [
                                 
                                    
                                    l
                                 
                                 
                                    v
                                    
                                       n
                                       x
                                    
                                    k
                                 
                                 ,
                                 
                                    
                                    l
                                 
                                 
                                    v
                                    
                                       n
                                       y
                                    
                                    k
                                 
                                 ,
                                 
                                    
                                    l
                                 
                                 
                                    v
                                    
                                       n
                                       z
                                    
                                    k
                                 
                                 ]
                              
                              ⊤
                           
                        
                      is defined in the regular xyz coordinate frame at node k, which corresponds to the tangent direction of t axis in rst frame. 
                        
                           
                              
                              l
                           
                           
                              
                                 v
                              
                              1
                              k
                           
                        
                      and 
                        
                           
                              
                              l
                           
                           
                              
                                 v
                              
                              2
                              k
                           
                        
                      are two mutually perpendicular unit vectors sitting the plane normal to 
                        
                           
                              
                              l
                           
                           
                              
                                 v
                              
                              n
                              k
                           
                        
                     . The infinitesimal rotations around 
                        
                           
                              
                              l
                           
                           
                              
                                 v
                              
                              1
                              k
                           
                        
                      and 
                        
                           
                              
                              l
                           
                           
                              
                                 v
                              
                              2
                              k
                           
                        
                      are denoted as α and β, which serve as extra two DOFs of node k
                     
                        1
                     
                     
                        1
                        
                           α and β are small because the thickness (t dimension) of the shell is much smaller than its r and s dimensions.
                     . Therefore, each node possesses five DOFs i.e. xk, yk, zk, αk
                      and βk
                     . Let p(r, s, t) be an arbitrary mass point within the element. Its rest/deflected position can be interpolated as

                        
                           (2)
                           
                              
                                 
                                    
                                    l
                                 
                                 ϕ
                                 
                                    (
                                    r
                                    ,
                                    s
                                    ,
                                    t
                                    )
                                 
                                 =
                                 
                                    ∑
                                    k
                                 
                                 
                                    h
                                    k
                                 
                                 
                                    
                                    l
                                 
                                 
                                    ϕ
                                    k
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    ∑
                                    k
                                 
                                 
                                    a
                                    k
                                 
                                 
                                    h
                                    k
                                 
                                 
                                    
                                    l
                                 
                                 
                                    v
                                    
                                       n
                                       ϕ
                                    
                                    k
                                 
                                 ,
                                 
                                 ϕ
                                 =
                                 x
                                 ,
                                 y
                                 
                                 or
                                 
                                 z
                                 ,
                              
                           
                        
                     where ak
                      is the thickness of the shell at node k. The first term in Eq. (2) corresponds to the regular shape function interpolation and the second term (i.e. 
                        
                           
                              1
                              2
                           
                           ∑
                           
                              a
                              k
                           
                           
                              h
                              k
                           
                           
                              
                              l
                           
                           
                              v
                              
                                 n
                                 ϕ
                              
                              k
                           
                        
                     ) assumes that r and s displacements at p(r, s, t) are linearly proportional to its t coordinate when r and s are fixed. The displacement vector 
                        
                           
                              u
                           
                           
                              (
                              r
                              ,
                              s
                              ,
                              t
                              )
                           
                           =
                           
                              
                                 [
                                 u
                                 ,
                                 v
                                 ,
                                 w
                                 ]
                              
                              ⊤
                           
                        
                      at p can be interpolated in a similar fashion

                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          u
                                          
                                             (
                                             r
                                             ,
                                             s
                                             ,
                                             t
                                             )
                                          
                                          =
                                          
                                             ∑
                                             k
                                          
                                          
                                             h
                                             k
                                          
                                          
                                          
                                             u
                                             k
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             ∑
                                             k
                                          
                                          
                                             a
                                             k
                                          
                                          
                                             h
                                             k
                                          
                                          
                                          
                                             v
                                             
                                                n
                                                x
                                             
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          v
                                          
                                             (
                                             r
                                             ,
                                             s
                                             ,
                                             t
                                             )
                                          
                                          =
                                          
                                             ∑
                                             k
                                          
                                          
                                             h
                                             k
                                          
                                          
                                          
                                             v
                                             k
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             ∑
                                             k
                                          
                                          
                                             a
                                             k
                                          
                                          
                                             h
                                             k
                                          
                                          
                                          
                                             v
                                             
                                                n
                                                y
                                             
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          w
                                          
                                             (
                                             r
                                             ,
                                             s
                                             ,
                                             t
                                             )
                                          
                                          =
                                          
                                             ∑
                                             k
                                          
                                          
                                             h
                                             k
                                          
                                          
                                          
                                             w
                                             k
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             ∑
                                             k
                                          
                                          
                                             a
                                             k
                                          
                                          
                                             h
                                             k
                                          
                                          
                                          
                                             v
                                             
                                                n
                                                z
                                             
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              v
                              
                                 n
                                 x
                              
                              k
                           
                           ,
                        
                     
                     
                        
                           v
                           
                              n
                              y
                           
                           k
                        
                      and 
                        
                           v
                           
                              n
                              z
                           
                           k
                        
                      are the three components of the displacement vector 
                        
                           
                              v
                           
                           n
                           k
                        
                      from 
                        
                           
                              
                              0
                           
                           
                              
                                 v
                              
                              n
                              k
                           
                        
                      to 
                        
                           
                              
                              1
                           
                           
                              
                                 v
                              
                              n
                              k
                           
                        
                      (i.e. 
                        
                           
                              
                                 v
                              
                              n
                              k
                           
                           ≜
                           
                              
                                 
                                 1
                              
                              
                                 
                                    v
                                 
                                 n
                                 k
                              
                           
                           −
                           
                              
                                 
                                 0
                              
                              
                                 
                                    v
                                 
                                 n
                                 k
                              
                           
                        
                     ). It can be expressed using nodal DOFs αk
                      and βk
                      such that

                        
                           (4)
                           
                              
                                 
                                    
                                       v
                                    
                                    n
                                    k
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          
                                          0
                                       
                                       
                                          v
                                       
                                    
                                    2
                                    k
                                 
                                 
                                    α
                                    k
                                 
                                 +
                                 
                                    
                                       
                                       0
                                    
                                    
                                       
                                          v
                                       
                                       1
                                       k
                                    
                                 
                                 
                                    β
                                    k
                                 
                                 .
                              
                           
                        
                     Substituting Eqs. (3) and (4) into Eq. (2) leads to the final interpolation of the shell element

                        
                           (5)
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          
                                             v
                                          
                                       
                                       
                                          
                                             w
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    ∑
                                    k
                                 
                                 
                                    
                                       H
                                    
                                    k
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                u
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                v
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                w
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                α
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                β
                                                k
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                        
                     where

                        
                           (6)
                           
                              
                                 
                                    
                                       H
                                    
                                    k
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                h
                                                k
                                             
                                          
                                          
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      h
                                                      k
                                                   
                                                   
                                                      t
                                                      2
                                                   
                                                   
                                                      a
                                                      k
                                                   
                                                   
                                                      
                                                         
                                                         0
                                                      
                                                      
                                                         v
                                                         
                                                            2
                                                            x
                                                         
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                      k
                                                   
                                                   
                                                      t
                                                      2
                                                   
                                                   
                                                      a
                                                      k
                                                   
                                                   
                                                      
                                                         
                                                         0
                                                      
                                                      
                                                         v
                                                         
                                                            1
                                                            x
                                                         
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                h
                                                k
                                             
                                          
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      h
                                                      k
                                                   
                                                   
                                                      t
                                                      2
                                                   
                                                   
                                                      a
                                                      k
                                                   
                                                   
                                                      
                                                         
                                                         0
                                                      
                                                      
                                                         v
                                                         
                                                            2
                                                            y
                                                         
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                      k
                                                   
                                                   
                                                      t
                                                      2
                                                   
                                                   
                                                      a
                                                      k
                                                   
                                                   
                                                      
                                                         
                                                         0
                                                      
                                                      
                                                         v
                                                         
                                                            1
                                                            y
                                                         
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                h
                                                k
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      h
                                                      k
                                                   
                                                   
                                                      t
                                                      2
                                                   
                                                   
                                                      a
                                                      k
                                                   
                                                   
                                                      
                                                         
                                                         0
                                                      
                                                      
                                                         v
                                                         
                                                            2
                                                            z
                                                         
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                      k
                                                   
                                                   
                                                      t
                                                      2
                                                   
                                                   
                                                      a
                                                      k
                                                   
                                                   
                                                      
                                                         
                                                         0
                                                      
                                                      
                                                         v
                                                         
                                                            1
                                                            z
                                                         
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     The element stiffness matrix is in the format of

                        
                           (7)
                           
                              
                                 
                                    
                                       K
                                    
                                    e
                                 
                                 =
                                 
                                    ∫
                                    
                                       V
                                       e
                                    
                                 
                                 
                                    
                                       
                                          B
                                       
                                       ⊤
                                    
                                    
                                       C
                                       B
                                    
                                 
                                 
                                    d
                                 
                                 v
                                 ,
                              
                           
                        
                     where B is the strain–displacement matrix obtained by applying the partial derivative to nodal displacements using Eq. (5). C is the stress–strain matrix determined by the material property. In this paper, linear elasticity is assumed and C is constant.

Due to the degeneracy of the shell element along its t direction, the stress components normal to the midsurface must always be zero. As a result, we need transforms the C matrix to make it aligned with the orientation of the shell element. As shown in Fig. 6
                     , let r, s, t be the unit vectors corresponding to three axes in the natural coordinate frame. They may be distorted and no longer orthogonal to each other when being viewed from the regular xyz coordinate frame. Let r′, s′, t′ be the unit vectors at the tangent directions of the corresponding axis (note that 
                        
                           
                              
                                 t
                              
                              ′
                           
                           =
                           
                              t
                           
                        
                     ). We can extract a new set of basis vectors 
                        
                           
                              
                                 r
                              
                              ¯
                           
                           ,
                        
                     
                     
                        
                           
                              s
                           
                           ¯
                        
                      and 
                        
                           
                              t
                           
                           ¯
                        
                      such that: 
                        
                           
                              
                                 r
                              
                              ¯
                           
                           =
                           
                              
                                 
                                    
                                       s
                                    
                                    ′
                                 
                                 ×
                                 
                                    
                                       t
                                    
                                    ′
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    
                                       
                                          s
                                       
                                       ′
                                    
                                    ×
                                    
                                       
                                          t
                                       
                                       ′
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    2
                                 
                              
                           
                           ,
                        
                     
                     
                        
                           
                              
                                 s
                              
                              ¯
                           
                           =
                           
                              
                                 
                                    
                                       t
                                    
                                    ′
                                 
                                 ×
                                 
                                    
                                       r
                                    
                                    ¯
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    
                                       
                                          t
                                       
                                       ′
                                    
                                    ×
                                    
                                       
                                          r
                                       
                                       ¯
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    2
                                 
                              
                           
                           ,
                        
                      and 
                        
                           
                              
                                 t
                              
                              ¯
                           
                           =
                           
                              
                                 
                                    t
                                 
                                 ′
                              
                              
                                 
                                    ∥
                                 
                                 
                                    
                                       t
                                    
                                    ′
                                 
                                 
                                    
                                       ∥
                                    
                                    2
                                 
                              
                           
                        
                     . Afterwards, a transformation matrix 
                        
                           
                              
                                 Q
                              
                              
                                 s
                                 h
                              
                           
                           ∈
                           
                              R
                              
                                 6
                                 ×
                                 6
                              
                           
                        
                      can be constructed from the direction cosines of the 
                        
                           
                              
                                 r
                              
                              ¯
                           
                           ,
                        
                     
                     
                        
                           
                              s
                           
                           ¯
                        
                      and 
                        
                           
                              t
                           
                           ¯
                        
                      measured in xyz coordinate frame, such that:

                        
                           (8)
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                       h
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                l
                                                1
                                                2
                                             
                                          
                                          
                                             
                                                m
                                                1
                                                2
                                             
                                          
                                          
                                             
                                                n
                                                1
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   l
                                                   1
                                                
                                                
                                                   m
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   m
                                                   1
                                                
                                                
                                                   n
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                   1
                                                
                                                
                                                   l
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                                2
                                                2
                                             
                                          
                                          
                                             
                                                m
                                                2
                                                2
                                             
                                          
                                          
                                             
                                                n
                                                2
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   l
                                                   2
                                                
                                                
                                                   m
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   m
                                                   2
                                                
                                                
                                                   n
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                   2
                                                
                                                
                                                   l
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                                3
                                                2
                                             
                                          
                                          
                                             
                                                m
                                                3
                                                2
                                             
                                          
                                          
                                             
                                                n
                                                3
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   l
                                                   3
                                                
                                                
                                                   m
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   m
                                                   3
                                                
                                                
                                                   n
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                   3
                                                
                                                
                                                   l
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                                
                                                   l
                                                   
                                                      1
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                m
                                                
                                                   m
                                                   
                                                      1
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                n
                                                
                                                   n
                                                   
                                                      1
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                l
                                                
                                                   m
                                                   
                                                      1
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                m
                                                
                                                   n
                                                   
                                                      1
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                n
                                                
                                                   l
                                                   
                                                      1
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                                
                                                   l
                                                   
                                                      2
                                                      ,
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                m
                                                
                                                   m
                                                   
                                                      2
                                                      ,
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                n
                                                
                                                   n
                                                   
                                                      2
                                                      ,
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                l
                                                
                                                   m
                                                   
                                                      2
                                                      ,
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                m
                                                
                                                   n
                                                   
                                                      2
                                                      ,
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                n
                                                
                                                   l
                                                   
                                                      2
                                                      ,
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                                
                                                   l
                                                   
                                                      3
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                m
                                                
                                                   m
                                                   
                                                      3
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                n
                                                
                                                   n
                                                   
                                                      3
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                l
                                                
                                                   m
                                                   
                                                      3
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                m
                                                
                                                   n
                                                   
                                                      3
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                n
                                                
                                                   l
                                                   
                                                      3
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                        
                     where

                        
                           (9)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             l
                                             1
                                          
                                          =
                                          c
                                          o
                                          s
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             
                                                
                                                   r
                                                
                                                ¯
                                             
                                             )
                                          
                                          ;
                                          
                                          
                                             m
                                             1
                                          
                                          =
                                          c
                                          o
                                          s
                                          
                                             (
                                             
                                                y
                                             
                                             ,
                                             
                                                
                                                   r
                                                
                                                ¯
                                             
                                             )
                                          
                                          ;
                                          
                                          
                                             n
                                             1
                                          
                                          =
                                          c
                                          o
                                          s
                                          
                                             (
                                             
                                                z
                                             
                                             ,
                                             
                                                
                                                   r
                                                
                                                ¯
                                             
                                             )
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             l
                                             2
                                          
                                          =
                                          c
                                          o
                                          s
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                ¯
                                             
                                             )
                                          
                                          ;
                                          
                                          
                                             m
                                             2
                                          
                                          =
                                          c
                                          o
                                          s
                                          
                                             (
                                             
                                                y
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                ¯
                                             
                                             )
                                          
                                          ;
                                          
                                          
                                             n
                                             2
                                          
                                          =
                                          c
                                          o
                                          s
                                          
                                             (
                                             
                                                z
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                ¯
                                             
                                             )
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             l
                                             3
                                          
                                          =
                                          c
                                          o
                                          s
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                ¯
                                             
                                             )
                                          
                                          ;
                                          
                                          
                                             m
                                             3
                                          
                                          =
                                          c
                                          o
                                          s
                                          
                                             (
                                             
                                                y
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                ¯
                                             
                                             )
                                          
                                          ;
                                          
                                          
                                             n
                                             3
                                          
                                          =
                                          c
                                          o
                                          s
                                          
                                             (
                                             
                                                z
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                ¯
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

The notation ab
                     
                        i, j
                      denotes 
                        
                           
                              a
                              i
                           
                           
                              b
                              j
                           
                           +
                           
                              a
                              j
                           
                           
                              b
                              i
                           
                           ,
                        
                      for instance 
                        
                           l
                           
                              m
                              
                                 1
                                 ,
                                 2
                              
                           
                           =
                           
                              l
                              1
                           
                           
                              m
                              2
                           
                           +
                           
                              l
                              2
                           
                           
                              m
                              1
                           
                        
                     . The transformed C matrix is computed as

                        
                           (10)
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       s
                                       h
                                    
                                 
                                 =
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                       h
                                    
                                    ⊤
                                 
                                 
                                    C
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                       h
                                    
                                 
                                 .
                              
                           
                        
                     The volumetric integral in Eq. (7) is evaluated numerically at 18 sampling points pi
                     (ri, si, ti
                     ) according to Gauss–Legendre integration strategy

                        
                           (11)
                           
                              
                                 
                                    
                                       K
                                    
                                    e
                                 
                                 ≈
                                 
                                    ∑
                                    i
                                 
                                 d
                                 e
                                 t
                                 
                                    (
                                    
                                       
                                          J
                                       
                                       i
                                    
                                    )
                                 
                                 
                                    w
                                    i
                                 
                                 
                                    
                                       
                                          B
                                       
                                       ⊤
                                    
                                    
                                       
                                          C
                                       
                                       
                                          s
                                          h
                                       
                                    
                                    
                                       B
                                    
                                 
                                 ,
                              
                           
                        
                     where J
                     
                        i
                      is the Jacobian matrix encoding how rst frame is transformed to xyz frame at pi. wi
                      is the constant sampling weight of pi
                     . The r, s and t coordinates of pi
                      are selected from the combinations of 
                        
                           r
                           =
                           ±
                           0.77460
                           ,
                           0
                           ,
                        
                     
                     
                        
                           s
                           =
                           ±
                           0.77460
                           ,
                           0
                        
                      and 
                        
                           t
                           =
                           ±
                           0.57735
                        
                     .

We project the FEM simulator into a pre-constructed subspace to accelerate the associated computation in order to provide an interactive design-simulation interplay. It is well-known that the cost of subspace simulation acceleration is the accuracy compromise as the system response beyond the pre-defined subspace cannot be captured. This problem is dealt with by using a secondary residual subspace, in our system, to accurately obtain the necessary intra-component deflection due to the external load.


                     The Choice of Subspace Our subspace construction strategy is devised based on the following three important observations/assumptions:

✦ The entire tube system is composed of multiple small-size components, many of which are of the same geometry because of the geometric symmetry.
                  

Accordingly, we compute the subspace basis vectors or modes at each of the tubular components individually so that the expensive computation associated with global finite element mesh is avoided. For tubular components of the same geometry but different locations/orientations, the modes can be directly synthesized by applying the corresponding rotation and translation.

✦ Only a static equilibrium structural analysis is required in our case while vibrational response under highly accelerated velocity field (e.g. a launching rocket) is not our concern.
                  

Correspondingly, we safely ignore the dynamical structural analysis and only focus on the static equilibrium analysis with the format of 
                        
                           
                              K
                              u
                           
                           =
                           
                              f
                           
                        
                     .

✦ The supporting tubular structure often undertakes a much larger external regional loads comparing with its self-weight.
                  

Consequently, we build a complementary subspace at run-time to capture the residual deformation that is not included in the primary subspace. It can be mathematically proven that such two-level subspace simulation strategy is able to produce the same result as using the full-space
                        2
                     
                     
                        2
                        In fact, even if the the structure’s self-weight is not neglectable, we can further incorporate the inertia-relief mode set (extra six modes per component) to make the local primary subspace a statically complete mode set, which is able to accurately capture the static system response due to the rigid body acceleration as proven in [42].
                     .

Our primary subspace construction method is inspired by the boundary mode 
                        [45], which is essentially an extension of the classic CMS technique [43]. The basis vectors are computed per component by solving a static equilibrium system. For a given tubular component, we classify all of its DOFs into two categories namely, the internal DOF set and boundary DOF set, which are denoted using subscripts i and b respectively in the following formulation. We impose one unit displacement to each boundary DOF while restrain the rest boundary DOFs anchored, which leads to

                           
                              (12)
                              
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      i
                                                      i
                                                   
                                                   L
                                                
                                             
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      i
                                                      b
                                                   
                                                   L
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            i
                                                            b
                                                         
                                                         L
                                                      
                                                   
                                                   ⊤
                                                
                                             
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      b
                                                      b
                                                   
                                                   L
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   Φ
                                                   i
                                                   L
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   b
                                                   L
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   i
                                                   L
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   b
                                                   L
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        where superscript L denotes the variables are local. 
                           
                              Φ
                              b
                              L
                           
                         is an identity matrix corresponding to the unit boundary excitement imposed. 
                           
                              
                                 
                                    F
                                 
                                 i
                                 L
                              
                              =
                              
                                 0
                              
                           
                         as no external loads are applied at internal DOFs. The unknown internal response 
                           
                              
                                 Φ
                              
                              i
                              L
                           
                         can be easily computed by expanding the first line of Eq. (12):

                           
                              (13)
                              
                                 
                                    
                                       
                                          Φ
                                       
                                       i
                                       L
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                i
                                                i
                                             
                                             L
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          i
                                          b
                                       
                                       L
                                    
                                    ,
                                 
                              
                           
                        and mode vectors at the component are assembled by concatenating the 
                           
                              
                                 Φ
                              
                              i
                              L
                           
                         and 
                           
                              
                                 Φ
                              
                              b
                              L
                           
                         such that 
                           
                              
                                 
                                    Φ
                                 
                                 L
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                Φ
                                             
                                             i
                                             L
                                          
                                       
                                       ⊤
                                    
                                    |
                                    
                                       
                                          
                                             
                                                Φ
                                             
                                             b
                                             L
                                          
                                       
                                       ⊤
                                    
                                    ]
                                 
                                 ⊤
                              
                           
                        . We notice that the formulation of ΦL
                         is consistent with the constraint mode in CMS [42]. Therefore, we refer the subspace spanned by ΦL
                         as the constraint subspace. Fig. 7
                         shows the shapes of five constraint modes associated with a boundary node while other boundary nodes (red nodes in the figure) are fixed.

With constraint modes, the system’s displacement can be expressed using the reduced coordinates at each component such that

                           
                              (14)
                              
                                 
                                    
                                       u
                                    
                                    =
                                    
                                       Φ
                                       ¯
                                    
                                    
                                       
                                          q
                                       
                                       ¯
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 Φ
                                 ¯
                              
                              =
                              diag
                              
                                 (
                                 
                                    
                                       Φ
                                    
                                    1
                                 
                                 ,
                                 
                                    
                                       Φ
                                    
                                    2
                                 
                                 ,
                                 .
                                 .
                                 .
                                 
                                    
                                       Φ
                                    
                                    k
                                 
                                 )
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                                 ¯
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             q
                                          
                                          1
                                       
                                    
                                    ⊤
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             q
                                          
                                          2
                                       
                                    
                                    ⊤
                                 
                                 ,
                                 .
                                 .
                                 .
                                 
                                    
                                       
                                          
                                             q
                                          
                                          k
                                       
                                    
                                    ⊤
                                 
                                 ,
                                 ]
                              
                           
                         are the global subspace matrix and generalized displacement vector of the system with k tubular components.

All the tubular components are mutually connected at their interfaces. Such coupling can be formulated as the interface constraint (IC) between a pair of adjacency components. As shown in Fig. 8
                        , IC requires that duplicated boundary DOFs from components η and ζ must always have identical values e.g. 
                           
                              
                                 
                                    u
                                 
                                 b
                                 η
                              
                              =
                              
                                 
                                    u
                                 
                                 b
                                 ζ
                              
                           
                        . It can be re-written using the reduced coordinate in constraint subspace

                           
                              (15)
                              
                                 
                                    
                                       
                                          E
                                       
                                       b
                                       η
                                    
                                    
                                       
                                          Φ
                                       
                                       η
                                    
                                    
                                       
                                          q
                                       
                                       η
                                    
                                    =
                                    
                                       
                                          E
                                       
                                       b
                                       ζ
                                    
                                    
                                       
                                          Φ
                                       
                                       ζ
                                    
                                    
                                       
                                          q
                                       
                                       ζ
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 E
                              
                              b
                              η
                           
                         and 
                           
                              
                                 E
                              
                              b
                              ζ
                           
                         are two elementary matrices extracting boundary DOFs from each component. A commonly-adopted approach to enforce Eq. (15) is to use the Lagrange multiplier method, which explicitly formulates the interface forces as the unknown multipliers [41]. While our simulator can also be handled this way, there are two obvious drawbacks associated with multiplier-based solution: (1) the dimension of the resulting linear system is greatly increased due to the existence of the multipliers and the redundancy of the boundary DOFs and (2) the system matrix is no longer a symmetric positive definite (SPD) matrix as we have vanished diagonal elements at locations corresponding to the IC. Consequently, the effectiveness of subspace acceleration is compromised.

Alternatively, we enforce the interface constraint without replying on the Lagrange multiplier method to maintain a more compact and better-conditioned subspace solver. Note that ICs are a set of linear constraints, which can be re-written as

                           
                              (16)
                              
                                 
                                    
                                       C
                                    
                                    
                                       
                                          q
                                       
                                       ¯
                                    
                                    =
                                    
                                       0
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 
                                    q
                                 
                                 ¯
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                q
                                             
                                             η
                                          
                                       
                                       ⊤
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                q
                                             
                                             ζ
                                          
                                       
                                       ⊤
                                    
                                    ]
                                 
                                 ⊤
                              
                           
                         and 
                           
                              
                                 C
                              
                              =
                              [
                              
                                 
                                    E
                                 
                                 b
                                 η
                              
                              
                                 
                                    Φ
                                 
                                 η
                              
                              |
                              −
                              
                                 
                                    E
                                 
                                 b
                                 ζ
                              
                              
                                 
                                    Φ
                                 
                                 ζ
                              
                              ]
                           
                         as in the case shown in Fig. 8. 
                           
                              
                                 C
                              
                              ∈
                              
                                 R
                                 
                                    c
                                    ×
                                    d
                                 
                              
                           
                         is a rectangular matrix, where c is the number of ICs of the system and d is the total number of the reduced coordinates at components η and ζ including the duplicated interface DOFs. Obviously, d > c, therefore C can be further split into two parts

                           
                              (17)
                              
                                 
                                    
                                       C
                                    
                                    =
                                    [
                                    
                                       
                                          C
                                       
                                       1
                                    
                                    |
                                    
                                       
                                          C
                                       
                                       2
                                    
                                    ]
                                    ,
                                 
                              
                           
                        such that 
                           
                              
                                 
                                    C
                                 
                                 1
                              
                              ∈
                              
                                 R
                                 
                                    c
                                    ×
                                    c
                                 
                              
                           
                         is a full-rank square matrix. Eq. (16) can be re-written as

                           
                              (18)
                              
                                 
                                    
                                       
                                          C
                                       
                                       1
                                    
                                    
                                       
                                          q
                                       
                                       d
                                    
                                    +
                                    
                                       
                                          C
                                       
                                       2
                                    
                                    
                                       
                                          q
                                       
                                       f
                                    
                                    =
                                    
                                       0
                                    
                                    ,
                                 
                              
                           
                        where q
                        
                           f
                         represents a subset of 
                           
                              
                                 q
                              
                              ¯
                           
                         consisting of only independent or free DOFs and q
                        
                           d
                         represents a subset of dependent DOFs. In the example shown in Fig. 8, if the DOFs on the red interface are free DOFs, the DOFs on the green interface are dependent ones and vice versa.

Since C
                        1 is full-rank, we can use q
                        
                           f
                         to represent the other “redundant” DOFs q
                        
                           d
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          q
                                       
                                       d
                                    
                                    =
                                    −
                                    
                                       
                                          C
                                       
                                       1
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          C
                                       
                                       2
                                    
                                    
                                       
                                          q
                                       
                                       f
                                    
                                    ,
                                 
                              
                           
                        as well as the complete 
                           
                              
                                 q
                              
                              ¯
                           
                         vector

                           
                              (20)
                              
                                 
                                    
                                       
                                          q
                                       
                                       ¯
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   f
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   d
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   I
                                                
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         C
                                                      
                                                      1
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         C
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          q
                                       
                                       f
                                    
                                    .
                                 
                              
                           
                        Substituting Eq. (20) into Eq. (14) yields

                           
                              (21)
                              
                                 
                                    
                                       u
                                    
                                    =
                                    
                                       Φ
                                       ¯
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   I
                                                
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         C
                                                      
                                                      1
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         C
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          q
                                       
                                       f
                                    
                                    =
                                    Φ
                                    
                                       q
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              Φ
                              ≜
                              
                                 Φ
                                 ¯
                              
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                −
                                                
                                                   
                                                      C
                                                   
                                                   1
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      C
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                         and q≜q
                        
                           f
                        . The full-space equilibrium 
                           
                              
                                 K
                                 u
                              
                              =
                              
                                 f
                              
                           
                        
                        
                           3
                        
                        
                           3
                           Note that here K is a diagonal block sparse matrix, each diagonal block is the component’s local stiffness matrix.
                         can be directly projected onto the new subspace spanned by Φ where IC is implicitly encoded

                           
                              (22)
                              
                                 
                                    
                                       
                                          K
                                       
                                       q
                                    
                                    
                                       q
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       q
                                    
                                    .
                                 
                              
                           
                        Here, 
                           
                              
                                 
                                    K
                                 
                                 q
                              
                              =
                              
                                 
                                    Φ
                                 
                                 ⊤
                              
                              
                                 K
                              
                              Φ
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 q
                              
                              =
                              
                                 
                                    Φ
                                 
                                 ⊤
                              
                              
                                 f
                              
                           
                        . This derivation can be easily extended for multiple components.

Using constraint modes is able to significantly improve the performance, yet it also sacrifices the accuracy of the simulation. Tubular supporting structure is often exerted concentrated regional loads of large magnitude. While the deflections at load-free components are accurately captured (when the gravity effect can be ignored) because all the inter-component stress propagations are losslessly passed via the interface whose DOFs are fully preserved within constraint subspace, deflection at the loading components where the forces are applied is not able to be well represented with constraint modes. To resolve this issue, a local secondary subspace is built to capture the residual deflection and improve the simulation accuracy at loading components, which is detailed in this subsection. As all the formulation is for a certain loading component, the superscript L is omitted.

We denote all the internal DOFs undertaking the external loads as the exciting DOFs while all the other internal DOFs as passive DOFs. They are symbolized using subscripts e and p respectively. Similar to constraint mode, a unit displacement is imposed to the each of the exciting DOF while keep other exciting DOFs and boundary DOFs fixed. We restrain the boundary DOFs so that the complementary deflection computed will not affect the status of other load-free components. A equilibrium system can be listed accordingly:

                           
                              (23)
                              
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      e
                                                      e
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      e
                                                      p
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      e
                                                      b
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            e
                                                            p
                                                         
                                                      
                                                   
                                                   ⊤
                                                
                                             
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      p
                                                      p
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      p
                                                      b
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            e
                                                            b
                                                         
                                                      
                                                   
                                                   ⊤
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            p
                                                            b
                                                         
                                                      
                                                   
                                                   ⊤
                                                
                                             
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      b
                                                      b
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   Ψ
                                                   e
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Ψ
                                                   p
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Ψ
                                                   b
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   e
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   p
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   b
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 Ψ
                                 e
                              
                              =
                              
                                 I
                              
                           
                         and 
                           
                              
                                 Ψ
                                 b
                              
                              =
                              
                                 0
                              
                           
                         correspond to the imposed unit displacement at exciting DOFs and anchored boundary DOFs. 
                           
                              
                                 
                                    F
                                 
                                 p
                              
                              =
                              
                                 0
                              
                           
                         as no forces are applied at the passive DOFs. Again, the superscript L indicating the local variables is omitted here. The unknown system response at passive DOFs can be computed by expanding the second line of Eq. (23)
                        
                           
                              (24)
                              
                                 
                                    
                                       Ψ
                                       p
                                    
                                    =
                                    −
                                    
                                       
                                          K
                                       
                                       
                                          p
                                          p
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          e
                                          p
                                       
                                       ⊤
                                    
                                    .
                                 
                              
                           
                        We use span(Ψ) to represent the subspace spanned by Ψ, and name it as the residual subspace whose basis vectors are residual modes. Fig. 9 shows the shapes of five residual modes associated with an internal exciting node.

The residual modes are employed based on the fact that the response of a linear system of a composite input is equivalent to the superposition of the system’s responses with respect to each individual input. In fact, it can be proven that the superset of Φ and Ψ is able to completely capture the deflection at loading components. We refer readers to Appendix A for mathematical proof details.

In other words, it means that an accurate result will be obtained if the system is solved within span(Φ) ∪ span(Ψ)

                           
                              
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   Φ
                                                   ⊤
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Ψ
                                                   
                                                   ⊤
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       K
                                    
                                    
                                       [
                                       Φ
                                       |
                                       Ψ
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   q
                                                
                                             
                                          
                                          
                                             
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      Φ
                                                      ⊤
                                                   
                                                   
                                                      f
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         Ψ
                                                      
                                                      ⊤
                                                   
                                                   
                                                      f
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        or

                           
                              (25)
                              
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      Φ
                                                      Φ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      Φ
                                                      Ψ
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      Ψ
                                                      Φ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      Ψ
                                                      Ψ
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   q
                                                
                                             
                                          
                                          
                                             
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   Φ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   Ψ
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        where

                           
                              (26)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      Φ
                                                      Φ
                                                   
                                                
                                                =
                                                
                                                   
                                                      Φ
                                                   
                                                   ⊤
                                                
                                                
                                                   K
                                                
                                                Φ
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      Φ
                                                      Ψ
                                                   
                                                
                                                =
                                                
                                                   
                                                      Φ
                                                   
                                                   ⊤
                                                
                                                
                                                   K
                                                
                                                Ψ
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      Ψ
                                                      Φ
                                                   
                                                
                                                =
                                                
                                                   
                                                      Ψ
                                                   
                                                   ⊤
                                                
                                                
                                                   K
                                                
                                                Φ
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      Ψ
                                                      Ψ
                                                   
                                                
                                                =
                                                
                                                   
                                                      Ψ
                                                   
                                                   ⊤
                                                
                                                
                                                   K
                                                
                                                Ψ
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        Here, q and p are the reduced coordinates of constraint modes and residual modes. While Φ can be pre-computed for each component, Ψ is a load-dependent matrix as different external loads would specify different exciting DOF sets and therefore, yield different mode matrices. It implies that as soon as the external loads are changed, the entire system must be re-computed, which significantly downgrades the useability of the system.

We notice that if the off-diagonal blocks (e.g. K
                        
                           ΦΨ
                         and 
                           
                              
                                 K
                              
                              
                                 Φ
                                 Ψ
                              
                              ⊤
                           
                        ) in Eq. (25) are zero, the constraint subspace and residual subspace will be decoupled and the computation of q and p are isolated. Therefore, we apply the modified Gram–Schmidt process (MGS) [46] towards Ψ with respect to K
                        Φ, which yields a new set of residual modes 
                           
                              Ψ
                              ˜
                           
                         such that 
                           
                              
                                 Ψ
                                 ˜
                              
                              ⊥
                              
                                 K
                              
                              Φ
                           
                         or 
                           
                              
                                 
                                    (
                                    
                                       K
                                    
                                    Φ
                                    )
                                 
                                 ⊤
                              
                              
                                 Ψ
                                 ˜
                              
                              =
                              
                                 0
                              
                           
                        . Boundary DOFs are always fixed during the computation of Ψ. On the contrary, there always exists one non-zero boundary DOF in the constraint mode. Such properties of constraint modes and residual modes guarantee that 
                           
                              s
                              p
                              a
                              n
                              (
                              Φ
                              )
                              ∩
                              s
                              p
                              a
                              n
                              (
                              Ψ
                              )
                              =
                              ⌀
                           
                        . Therefore, 
                           
                              s
                              p
                              a
                              n
                              
                                 (
                                 Ψ
                                 )
                              
                              =
                              s
                              p
                              a
                              n
                              
                                 (
                                 
                                    Ψ
                                    ˜
                                 
                                 )
                              
                           
                         and 
                           
                              s
                              p
                              a
                              n
                              
                                 (
                                 Φ
                                 )
                              
                              ∪
                              s
                              p
                              a
                              n
                              
                                 (
                                 Ψ
                                 )
                              
                              =
                              s
                              p
                              a
                              n
                              
                                 (
                                 Φ
                                 )
                              
                              ∪
                              s
                              p
                              a
                              n
                              
                                 (
                                 
                                    Ψ
                                    ˜
                                 
                                 )
                              
                           
                        . Substituting Ψ with 
                           
                              
                                 Ψ
                                 ˜
                              
                              ,
                           
                         
                        Eq. (25) is simplified to

                           
                              (27)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      Φ
                                                      Φ
                                                   
                                                
                                                
                                                   q
                                                
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   Φ
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      
                                                         Ψ
                                                         ˜
                                                      
                                                      
                                                         Ψ
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      Ψ
                                                      ˜
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The final component deflection is computed using

                           
                              (28)
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                [
                                                Φ
                                                |
                                                
                                                   Ψ
                                                   ˜
                                                
                                                ]
                                             
                                             
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      ⊤
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      ⊤
                                                   
                                                   ]
                                                
                                                ⊤
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             Φ
                                             
                                                q
                                             
                                             +
                                             Ψ
                                             
                                                p
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          ≜
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                Φ
                                             
                                             +
                                             
                                                
                                                   u
                                                
                                                
                                                   Ψ
                                                   ˜
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Note that 
                           
                              
                                 u
                              
                              Φ
                           
                         is the constraint subspace displacement. Therefore, we only need to calculate an incremental displacement 
                           
                              
                                 u
                              
                              
                                 Ψ
                                 ˜
                              
                           
                         in order to obtain the exact full-space result at loading components. Fig. 10
                         summarizes the major computational procedures in our system.

@&#EXPERIMENTAL RESULTS@&#

We report and discuss experiments we have conducted in this section. Please refer to the accompanying video for more results including the test use of the fabricated tubular models.

Our experiments are carried out on a Dell Optiplex 9010 workstation computer equipped with an Intel i7-3770, 3.40 GHz CPU and 16G memory. The proposed system is implemented on 64-bit Microsoft Windows 7 using Visual Studio 2010. We use Eigen numerical library [47] for most linear system related calculations. Note that we only use the single-core implementation however, many computations (e.g. per-component subspace construction) can be trivially parallelized using multi-threading.

Existing FEM literatures [3,44] have mentioned that linear four-node element is not a good choice for general shell simulation. It is partially because the governing stress equilibrium is characterized using a second-order partial differential equation. The adoption of weak form (well-known as virtual work principle in the context of continuum mechanics) allows the usage of linear interpolation functions (e.g. linear element) however, the accuracy of the simulation is compromised. The adoption of the linear element also leads to the shear locking artifact, which is shown in Fig. 11
                        . The regular cylinder-shaped tube is simulated using the same number of four-node shell elements (left) and nine-node shell elements (right), respectively. The external forces are applied at the highlighted nodes in the positive y direction. The bending deformation can be well observed with nine-node element which is however, “locked” with four-node element.


                        Fig. 12
                         shows a screen capture of the user interface of the proposed design-simulation system. Right to the main 3D view, our system provides an intuitive interface for the user to specify the boundary (top) and skeletal (bottom) controls of tube components. Our system maintains a tube library shown blew the main 3D view. The geometry of each tube component can be freely edited. Immediately after the geometric edit of a component is committed, the updated component will be inserted into the library as a new component. All the related pre-computation is also carried out at this stage. On average, a tube component holds about 4000–7000 DOFs. The related computations like assembling the stiffness matrix K, computing the constraint modes Φ as well as calculating the matrix-vector product of K
                        Φ, which is for the potential MGS to be applied if this component is a loading component, can be done in real-time. During the model assemblage, each component can be freely copied and pasted. User is also able to specify the geometric symmetry during the editing so that the shape edits applied at a component will be automatically mapped to its geometrically symmetric counterparts like the stool legs shown in Fig. 2.

As soon as the entire structure is assembled, we need to build the global Φ matrix (Eq. 21) as the primary subspace basis vectors. Therefore matrices C
                        1 and C
                        2 (Eq. 17) must be identified. They can be efficiently found as each column in the original C matrix corresponds to a system DOF while all the row vectors in C are guaranteed to be linearly independent (as long as the IC are not redundantly defined in C). Therefore, we only need to construct another elementary matrix encoding the necessary column permutation to move all the columns corresponding to independent DOFs to the left-end of the matrix. As long as the topology of the tubular structure is not altered, this elementary matrix remains the same.

After the displacement is computed. The strain vector 
                           
                              ϵ
                              ∈
                              
                                 R
                                 
                                    6
                                    ×
                                    1
                                 
                              
                           
                         can be easily evaluated using the strain-displacement matrix B, which is further converted to the stress vector 
                           σ
                         according to the assumed linear elasticity: 
                           
                              σ
                              =
                              
                                 C
                              
                              ϵ
                           
                        . Finally, we visualize the von Mises stress using the GLSL shader. The von Mises stress is a scalar and can be computed as

                           
                              (29)
                              
                                 
                                    
                                       σ
                                       
                                          v
                                          o
                                          n
                                       
                                       2
                                    
                                    =
                                    
                                       
                                          
                                             σ
                                             
                                                1
                                                ,
                                                2
                                             
                                             2
                                          
                                          +
                                          
                                             σ
                                             
                                                2
                                                ,
                                                3
                                             
                                             2
                                          
                                          +
                                          
                                             σ
                                             
                                                3
                                                ,
                                                1
                                             
                                             2
                                          
                                          +
                                          6
                                          
                                             (
                                             
                                                σ
                                                12
                                                2
                                             
                                             +
                                             
                                                σ
                                                23
                                                2
                                             
                                             +
                                             
                                                σ
                                                31
                                                2
                                             
                                             )
                                          
                                       
                                       2
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 σ
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              
                                 σ
                                 
                                    i
                                    i
                                 
                              
                              −
                              
                                 σ
                                 
                                    j
                                    j
                                 
                              
                           
                         and σij
                         is the i, j component in the tensor representation of σ. We simulate the tubular structure of stereolithography (SLA) material with Young Modulus of 2.5e9 and Poisson Ration of 0.41. Regions with high von Mises stress are likely to fail under the prescribed external loads as shown in Fig. 14
                        .


                        Fig. 13 shows the snapshots of using our system for designing and simulating various tubular structures. Since authors are not professional designers, we just follow some design ideas searched from internet shown in the leftmost column of the figure. When high-stress regions is observed, we apply some further geometric edits to the model including altering the shapes of the cross-sections at critical region (row 1, the lamp stand model), reducing the curvature connecting neighbor components (row 2, the laptop holder model), adding extra supporting components (row 3, the bookshelf model) and reducing the force moment (row 4, the camera rack model). The edited regions are highlighted in the rightmost column in the figure.


                        Table 1
                         reports the detailed statistic of the 3D models we have tested. We compare the time performance of the proposed two-level subspace simulation method with the full-space simulation as well as the subspace simulator using the Lagrange multiplier method. While the full-space system can be solved using the sparse Cholesky solver (the built-in SimplicialLLT routine in Eigen library), the simulation is not interactive along with the design operations with lags of seconds. On the other hand, the multiplier based subspace solver often has doubled or tripled size comparing with our method, due to the dulcification of the boundary DOFs as well as the explicit formulation of unknown multipliers. In addition, the resulting system matrix is no longer SPD either and cannot be handled with LLT decomposition. Therefore, the performance data listed in Table 1 is the one using the LU decomposition (the built-in PartialPivLU solver in Eigen library), which is slower than LLT decomposition in most cases. As a result, even with much fewer DOFs, Lagrange multiplier based subspace solver could be even slower than the full-space solver.

The proposed multiplier-free coupling mechanism will have a dense SPD matrix of much smaller size. Therefore, it is much more efficient than the above-mentioned two solvers. For 3D models with over 100k full-space DOFs, our method is still able to perform the accurate structural analysis at an interactive rate. We would like to remind the reader that unlike most existing subspace model reduction methods, our method does not compromise simulation accuracy while making the simulation an order of magnitude faster. Extra computations are required for applying the MGS, constructing the residual subspace and solving the secondary deflection. However, such computations are light-weight as they are conducted at the component level. In most cases, they can be finished within milliseconds.

In this paper, we present a system for design and simulation of tubular supporting structure. Besides an intuitive shape control mechanism, our system is able to interactively perform the structural analysis using a two-level subspace FEM simulation. We show the interactive and accurate design and simulation of large 3D model of over 100k DOFs. However, there still exist several limitations in the current version of the system. First of all, our design system is only able to handle simple tubular components with two open interfaces. More complex tubes of T-shape or Y-shape are not able to be intuitively edited. A possible solution is to deform a template with boundary control by solving higher-order harmonic equations. As a future work, we will study how to use fundamental solutions to accelerate the geometric design of multi-interface tube components. During the shape editing, self-intersection could occur at highly curved regions. However, our current system cannot automatically fix such problem and it only sends out an alert to the user. Feature modeling is not supported in our system. Different domain decomposition strategies are required to accelerate the simulation if features are added to tubular structures, which gives another direction of our future work. In the simulation part, we ignore the deflection induced by component’s self-weight, which could also induce simulation inaccuracy when the tubular component is fabricated using material of high density. We plan to incorporate the inertia-relief modes 
                     [42] to fully accommodate the gravity effect to the system in the future. Another interest future direction is to make simulation active meaning the simulator will provide the user potential solutions to fix a “faulty” geometric edit as in many recent design-simulation systems [26].

@&#ACKNOWLEDGMENT@&#

The authors would like to thank anonymous reviewers for their constructive comments. Lifeng Zhu is partially supported by the Open Fund of Jiangsu Province Key laboratory of Remote Measuring and Control. Ran Luo and Yin Yang were partially supported by National Science Foundation (NSF) under Award no. IIS-1464306. Yin Yang was also partially supported by UNM RAC award and OVPR award. Weiwei Xu is partially supported by National Science Foundation of China (NSFC) under Grants nos. 61272392 and 61322204.


                     
                        Proof
                        We show that the subspace component deflection computed using Eq. (25) is identical to the solution of the full-space equilibrium (e.g. 
                              
                                 
                                    K
                                    u
                                 
                                 =
                                 
                                    f
                                 
                              
                           ). Noticing that for a loading component, external forces are only applied to the exciting DOFs and the corresponding component equilibrium becomes

                              
                                 (A.1)
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         e
                                                         e
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         e
                                                         p
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         e
                                                         b
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               e
                                                               p
                                                            
                                                         
                                                      
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         p
                                                         p
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         p
                                                         b
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               e
                                                               b
                                                            
                                                         
                                                      
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               p
                                                               b
                                                            
                                                         
                                                      
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         b
                                                         b
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      e
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      p
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      b
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      e
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      p
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      b
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           Expanding the second line of Eq. A.1 yields

                              
                                 (A.2)
                                 
                                    
                                       
                                          
                                             u
                                          
                                          p
                                       
                                       =
                                       −
                                       
                                          
                                             K
                                          
                                          
                                             p
                                             p
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             K
                                          
                                          
                                             e
                                             p
                                          
                                          ⊤
                                       
                                       
                                          
                                             u
                                          
                                          e
                                       
                                       −
                                       
                                          
                                             K
                                          
                                          
                                             p
                                             p
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             K
                                          
                                          
                                             p
                                             b
                                          
                                       
                                       
                                          
                                             u
                                          
                                          b
                                       
                                       .
                                    
                                 
                              
                           Similarly, we also expand the equilibrium of the passive DOFs through the definition of constraint mode and residual mode (e.g. Eqs. (12) and (23)), which gives

                              
                                 (A.3)
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             e
                                             p
                                          
                                          ⊤
                                       
                                       
                                          Φ
                                          e
                                       
                                       +
                                       
                                          
                                             K
                                          
                                          
                                             p
                                             p
                                          
                                       
                                       
                                          Φ
                                          p
                                       
                                       +
                                       
                                          
                                             K
                                          
                                          
                                             p
                                             b
                                          
                                       
                                       
                                          
                                             I
                                          
                                          b
                                       
                                       =
                                       
                                          0
                                       
                                       ,
                                    
                                 
                              
                           and

                              
                                 (A.4)
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             p
                                             p
                                          
                                       
                                       
                                          Ψ
                                          p
                                       
                                       +
                                       
                                          
                                             K
                                          
                                          
                                             e
                                             p
                                          
                                          ⊤
                                       
                                       =
                                       
                                          0
                                       
                                       .
                                    
                                 
                              
                           By substituting Eqs. A.3 and A.4 into Eq. A.2, we obtain

                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          p
                                       
                                       =
                                       
                                          Ψ
                                          p
                                       
                                       
                                          
                                             u
                                          
                                          e
                                       
                                       +
                                       
                                          (
                                          
                                             Φ
                                             p
                                          
                                          −
                                          
                                             Ψ
                                             p
                                          
                                          
                                             Φ
                                             e
                                          
                                          )
                                       
                                       
                                          
                                             u
                                          
                                          b
                                       
                                       ,
                                    
                                 
                              
                           which leads to

                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      e
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      p
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      b
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      Φ
                                                      e
                                                   
                                                
                                                
                                                   
                                                      Ψ
                                                      e
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Φ
                                                      p
                                                   
                                                
                                                
                                                   
                                                      Ψ
                                                      p
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      b
                                                   
                                                
                                                
                                                   
                                                      Ψ
                                                      b
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      b
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         e
                                                      
                                                      −
                                                      
                                                         Φ
                                                         e
                                                      
                                                      
                                                         
                                                            u
                                                         
                                                         b
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       =
                                       
                                          [
                                          Φ
                                          |
                                          Ψ
                                          ]
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           
                           □

Supplementary material associated with this article can be found, in the online version, at 10.1016/j.gmod.2015.05.002.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

