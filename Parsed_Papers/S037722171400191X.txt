@&#MAIN-TITLE@&#Operational transportation planning of freight forwarding companies in horizontal coalitions

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Collaborative transportation planning of freight forwarders is studied.


                        
                        
                           
                           Routing of own vehicles is extended by subcontracting and request exchanging.


                        
                        
                           
                           Considering all request fulfillment options may result in considerable cost savings.


                        
                        
                           
                           A new planning framework is proposed for forwarders in horizontal coalitions.


                        
                        
                           
                           Computational results show very high efficiency of the proposed planning framework.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Logistics

Distributed decision making

Transportation planning

Subcontracting

Collaborative planning

Request exchange

@&#ABSTRACT@&#


               
               
                  In order to improve profitability, freight forwarding companies try to organize their operational transportation planning systematically, considering not only their own fleet but also external resources. Such external resources include vehicles from closely related subcontractors in vertical cooperations, autonomous common carriers on the transportation market, and cooperating partners in horizontal coalitions. In this paper, the transportation planning process of forwarders is studied and the benefit of including external resources is analyzed. By introducing subcontracting, the conventional routing of own vehicles is extended to an integrated operational transportation planning, which simultaneously constructs fulfillment plans with overall lowest costs using the own fleet and subcontractors’ vehicles. This is then combined with planning strategies, which intend to increase the profitability by exchanging requests among members in horizontal coalitions. Computational results show considerable cost reductions using the proposed planning approach.
               
            

@&#INTRODUCTION@&#

The increasing pressure on modern freight forwarding companies to improve profitability has strongly influenced their fleet management and transportation planning strategies. In order to utilize resources more efficiently, it is no longer sufficient for forwarders to optimize the usage of their internal resources, but they also have to improve the management of external relations with other carriers. Forwarders can fulfill their acquired customer requests by applying the following options: (1) keeping the execution in-house using their own fleet (self-fulfillment), (2) forwarding requests to other carriers (subcontracting), and (3) exchanging requests with partners in horizontal cooperations (collaborative planning). Using all three options may result in considerable cost-savings. However, due to the high heterogeneity of these different options, forwarders have to apply new planning schemes to realize the embedded potential. In this paper, we study the operational transportation planning under consideration of all three fulfillment options.

Besides self-fulfillment, forwarders can subcontract some requests to subcontractors in vertical cooperations and to common carriers to reduce their fleet size. Due to the high fixed costs of vehicles, many forwarders strongly downsize their own fleet. This enables them to do “cherry-picking”, i.e., assigning the most profitable tours to their own vehicles and filling the gap between the own fleet capacity and customer demand by using capacities of other carriers. As a consequence, the process of forwarding requests to subcontractors has to be integrated into the traditional vehicle routing and scheduling. Krajewska and Kopfer (2009) refer to this extension as the integrated operational transportation planning (IOTP).

In addition to subcontracting, the operational efficiency can be improved further by building up horizontal coalitions enabling collaborative planning. According to Stadtler (2009), collaborative planning can be understood as a joint decision making process for aligning plans of individual coalition members with the aim of achieving coordination in light of information asymmetry. Wang and Kopfer (2014) refer to the joint decision making process for fulfilling transportation requests in a horizontal coalition as collaborative transportation planning (CTP). CTP aims to reach a reallocation of requests among the coalition members through request exchange, with total costs less than the sum the partners’ individual costs would be without cooperation.

The main differences between the cooperations in IOTP and CTP is that CTP is performed on the basis of an equal partnership, while in IOTP the players are in a hierarchical relation with the forwarder being the client of carriers acting as subcontractors. In IOTP, forwarders plan independently for their internal and external capacities without explicitly coordinating with their subcontractors. In CTP, all partners plan for themselves (i.e., for their own fleet and, if applicable, for their subcontractors either) and try to harmonize their plans with those of other coalition members.

Although both approaches, IOTP and CTP, have been investigated in literature, a systematical integration of both approaches into vehicle routing strategies has not been discussed yet. In this paper, we study how the operational planning of the forwarders should be performed taking subcontracting and collaborative request exchange into account. The purpose is to develop an appropriate mechanism to realize the cost-saving potential at the highest level, which is embedded in the integration of IOTP and CTP.

The remainder of this paper is organized as follows. Related literature is reviewed in Section 2. Different planning strategies are formally described in Section 3. The solution approaches for the IOTP problem are presented in Section 4 and integrated into a collaborative planning framework in Section 5. Section 6 shows the computational results. Section 7 concludes this paper.

@&#LITERATURE REVIEW@&#

The idea of using external resources for the fulfillment of transportation requests is not new in transportation planning. Due to the high fixed costs related to trucks and the low profit margin, forwarders have to keep a very high utilization rate of their own fleet to generate acceptable profits. Introducing subcontracting enables forwarders to do “cherry-picking” for their reduced fleet and thus, to ensure a high utilization rate of own vehicles, even in case of strongly fluctuating demands for transportation volume.

“Cherry-picking” is often performed by forwarders in practice, in spite of the fact that it implements a sequential planning approach, which may lead to inferior solutions regarding the total fulfillment costs. Thus, simultaneous planning approaches have been proposed in transportation planning literature. The resulting planning problems, i.e., variations of the IOTP, have attracted interest of researchers for some decades.


                        Ball, Golden, Assad, and Bodin (1983) investigate the problem of simultaneously generating routes for own vehicles and subcontracting single requests to common carriers. The underlying routing problem can be seen as a multi-depot full-truckload (FTL) pickup and delivery problem (PDP). Klincewicz, Luss, and Pilcher (1990) study a variation of the IOTP which is based on the vehicle routing problem (VRP) with stochastic customer demands. The whole area to be served is divided into several sectors assigned either to an own vehicle route or to common carriers. A static version of this problem on the operational level is proposed and solved many years later by Chu (2005), who discusses the problem where only a fixed number of heterogeneous trucks with limited capacity are available in the own fleet and the demands of customers are known. After that, this problem and its variation with a homogeneous fleet are investigated in Bolduc, Renaud, and Boctor (2007), Bolduc, Renaud, Boctor, and Laporte (2008), and Côté and Potvin (2009). Based on the analysis of a German mid-sized freight forwarder, Krajewska and Kopfer (2009) introduce a variation of the IOTP while considering several different tariff structures for freight charges, and propose a tabu search heuristic to solve this problem.

Small and mid-sized forwarders face greater difficulties in taking advantage of both economy of scope and economies of scale, due to their relatively limited business size. The commonly estimated achievable cost reduction through CTP amounts to 5–15% (Cruijssen & Salomon, 2004; Krajewska, Kopfer, Laporte, Ropke, & Zaccour, 2008). The attained cost-savings represent the joint benefits of the coalition that cannot be achieved individually. They can then be shared among the coalition members.

In order to exploit the cost-saving potential embedded in CTP, appropriate request exchange mechanisms, which are simple and implementable, yet effective in terms of generating high joint benefits have to be developed. Such mechanisms must be able to deal with distributed information and decision-making competences Wang and Kopfer (2014). Some approaches have been proposed in literature to tackle this challenging task. These approaches differ not only in the solution methodologies but also in the scenarios (e.g. underlying routing problems) to which CTP is applied.


                        Krajewska and Kopfer (2006) propose a request exchange mechanism using a combinatorial auction (CA), which is based on the idealized assumption that the fulfillment costs for any bundle of requests can be exactly evaluated. Schwind, Gujo, and Vykoukal (2009) propose two auction mechanisms for a scenario with several warehouses supplying single commodity goods to customers, which can be modeled as the VRP with time windows (VRPTW) (Cordeau, Desaulniers, Desrosiers, Solomon, & Soumis, 2002). Due to the characteristics of the VRP, only requests located between neighboring profit centers are exchanged. For the PDP however, it is impossible to simply choose candidate requests for exchange on the basis of their geographical locations. Berger and Bierwirth (2010) deal with the CTP of a coalition, where each member has to solve a PDP without capacity restriction. Schönberger (2005) proposes a CA-based approach for a similar problem, in which also time windows of requests have been considered. Özener, Ergun, and Savelsbergh (2011) solve the CTP problem by using bilateral exchanges for forwarders doing FTL business. Wang and Kopfer (2014) propose a route-based request exchange mechanism for the exchange of less-than-truckload (LTL) requests. The basic routing problem is the pickup and delivery problem with time windows (PDPTW) with a fixed homogeneous fleet.

The approaches proposed by Berger and Bierwirth (2010) and Özener et al. (2011) depend on the calculation of the marginal costs for single requests. The basic idea is to choose those requests with the highest marginal costs and offer them for exchange. If an exchange resulting in a better solution for all parties is found, it will be accepted and the exchange process continues. Otherwise the process ends. This idea suffers from the fact that the underlying process resembles a hill-climbing strategy, which does not accept any declined solution and thus cannot escape from local optima. The mechanisms in Berger and Bierwirth (2010) realize an average cost-saving potential of 18.2–64.8% for different test sets, and the approach in Özener et al. (2011) of 30% in the test setting relevant for CTP as discussed in this paper.


                        Schönberger (2005) and Wang and Kopfer (2014) solve the CTP problem by following the decomposition principle proposed by Dantzig and Wolfe (1960). This decomposition scheme is suitable for decentralized decision making (with distributed information) since each member decides for his part without regard to whether it is feasible for any other part (Dantzig & Wolfe, 1960), and without having to expose private information. In both approaches, the CTP problems are decomposed into several subproblems reflecting the routing decisions of single participants and a coordinating problem. Schönberger (2005) assumes an extremely high price level for forwarding requests to common carriers and tries to increase the degree of self-fulfillment. Wang and Kopfer (2014) use an iterative route generation process and realize almost the complete cost-saving potential which is determined by solving the centralized problem using effective heuristics for vehicle routing.

In this section, the operative transportation planning problems are formally described. We begin with the PDPTW as the initial situation and extend it gradually to the combined collaborative integrated planning.

Suppose a horizontal coalition of m independent freight forwarders. Each member i comes along with a request portfolio 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                           
                         containing 
                           
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              m
                           
                        , LTL requests. Each request 
                           
                              r
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                           
                         with load 
                           
                              
                                 
                                    l
                                 
                                 
                                    r
                                 
                              
                              ⩾
                              0
                           
                         must be transported from its pickup location to a delivery location. Let 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              =
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         be the set of pickup nodes and 
                           
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              =
                              {
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              ,
                              …
                              ,
                              2
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         the set of delivery nodes. The origin–destination pair of request 
                           
                              r
                              =
                              u
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         is 
                           
                              (
                              u
                              ,
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              +
                              u
                              )
                           
                        . Let 
                           
                              
                                 
                                    l
                                 
                                 
                                    u
                                 
                              
                              =
                              
                                 
                                    l
                                 
                                 
                                    r
                                 
                              
                           
                         and 
                           
                              
                                 
                                    l
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    u
                                 
                              
                              =
                              -
                              
                                 
                                    l
                                 
                                 
                                    r
                                 
                              
                           
                        . Each forwarder i has an own fleet 
                           
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                         available on the first mode, i.e., self-fulfillment (SF). Each vehicle 
                           
                              k
                              ∈
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                         has the capacity 
                           
                              
                                 
                                    Q
                                 
                                 
                                    k
                                 
                              
                           
                        , a fixed cost 
                           
                              
                                 
                                    α
                                 
                                 
                                    k
                                 
                              
                           
                        , and a variable cost rate 
                           
                              
                                 
                                    β
                                 
                                 
                                    k
                                 
                              
                           
                         for each distance unit. All vehicles are stationed at the depot 
                           
                              
                                 
                                    o
                                 
                                 
                                    i
                                 
                              
                           
                        . Let 
                           
                              
                                 
                                    o
                                 
                                 
                                    i
                                 
                              
                           
                         denote the start depot and 
                           
                              
                                 
                                    o
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         the end depot which is a duplicate of 
                           
                              
                                 
                                    o
                                 
                                 
                                    i
                                 
                              
                           
                        . Member i’s PDPTW can be defined on a graph 
                           
                              
                                 
                                    G
                                 
                                 
                                    i
                                 
                              
                              =
                              (
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , where 
                           
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              ∪
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              ∪
                              {
                              
                                 
                                    o
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    o
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              }
                           
                         is the node set and 
                           
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                              ×
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                           
                         is the edge set. For each edge 
                           
                              (
                              u
                              ,
                              v
                              )
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                           
                        , a distance 
                           
                              
                                 
                                    d
                                 
                                 
                                    uv
                                 
                              
                           
                         and a travel time 
                           
                              
                                 
                                    d
                                 
                                 
                                    uv
                                 
                                 
                                    ′
                                 
                              
                           
                         are given. The service at node 
                           
                              u
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                           
                         must be started within a time window 
                           
                              [
                              
                                 
                                    b
                                 
                                 
                                    u
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    u
                                 
                              
                              ]
                           
                        , and the duration of the service is given by 
                           
                              
                                 
                                    s
                                 
                                 
                                    u
                                 
                              
                           
                        . The binary variable 
                           
                              
                                 
                                    x
                                 
                                 
                                    uvk
                                 
                              
                              ,
                              
                              (
                              u
                              ,
                              v
                              )
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              k
                              ∈
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                        , is one if vehicle k travels over edge 
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        . If vehicle k serves node 
                           
                              u
                              ,
                              
                              
                                 
                                    T
                                 
                                 
                                    uk
                                 
                              
                           
                         defines the time when the service starts and 
                           
                              
                                 
                                    L
                                 
                                 
                                    uk
                                 
                              
                           
                         the load after the service is completed. The PDPTW can be modeled based on Desrosiers, Desaulniers, Erdmann, Solomon, and Soumis (2002) and Ropke and Pisinger (2006) as follows.
                           
                              (1)
                              
                                 
                                    min
                                 
                                 
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       uv
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 subject to
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                                 =
                                 1
                                 
                                 ∀
                                 u
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       v
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       u
                                       ,
                                       k
                                    
                                 
                                 =
                                 0
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 u
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          ∪
                                          {
                                          
                                             
                                                o
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          }
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             o
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       v
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          ∈
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                          ∪
                                          {
                                          
                                             
                                                o
                                             
                                             
                                                i
                                             
                                          
                                          }
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       u
                                       ,
                                       
                                          
                                             o
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       ,
                                       k
                                    
                                 
                                 =
                                 1
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       vuk
                                    
                                 
                                 =
                                 0
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 v
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                uk
                                             
                                          
                                          +
                                          
                                             
                                                s
                                             
                                             
                                                u
                                             
                                          
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                uv
                                             
                                             
                                                ′
                                             
                                          
                                          -
                                          
                                             
                                                T
                                             
                                             
                                                vk
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 0
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       b
                                    
                                    
                                       u
                                    
                                 
                                 ⩽
                                 
                                    
                                       T
                                    
                                    
                                       uk
                                    
                                 
                                 ⩽
                                 
                                    
                                       e
                                    
                                    
                                       u
                                    
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 u
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       T
                                    
                                    
                                       uk
                                    
                                 
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       u
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       u
                                       ,
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 ⩽
                                 
                                    
                                       T
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       u
                                       ,
                                       k
                                    
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 u
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       uk
                                    
                                 
                                 +
                                 
                                    
                                       l
                                    
                                    
                                       v
                                    
                                 
                                 -
                                 
                                    
                                       L
                                    
                                    
                                       vk
                                    
                                 
                                 )
                                 =
                                 0
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       l
                                    
                                    
                                       u
                                    
                                 
                                 ⩽
                                 
                                    
                                       L
                                    
                                    
                                       uk
                                    
                                 
                                 ⩽
                                 
                                    
                                       Q
                                    
                                    
                                       k
                                    
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 u
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 0
                                 ⩽
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       u
                                       ,
                                       k
                                    
                                 
                                 ⩽
                                 
                                    
                                       Q
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       l
                                    
                                    
                                       u
                                    
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 u
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             o
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       k
                                    
                                 
                                 =
                                 0
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     

Suppose that the forwarder i downsizes its own fleet and subcontracts a subset of the acquired requests to external carriers. Krajewska and Kopfer (2009) identify three modes of subcontracting. The first two modes are applied to subcontractors who are frequently engaged by the forwarder and are nearly exclusively employed by him. Complete vehicle routes starting from and ending at the forwarder’s depot are outsourced to these subcontractors. A subcontractor’s vehicle will be paid either on a tour basis (TB) or on a daily basis (DB) for executing a route. The payment for mode TB is calculated by multiplying the route length with an agreed cost rate per distance unit, which is higher than the corresponding cost rate of an own vehicle to compensate subcontractors’ fixed costs. For mode DB, a predefined flat-rate is paid to a subcontractor for a complete day, without violating the agreed limits for travel distance of the route. For these two modes TB and DB, it is necessary that forwarders plan these routes in advance which they pay for because the freight to be paid depends on the characteristics of the planned routes. The third mode is applied when requests are shifted to common carriers. In this case, an individually agreed charge will be paid to a subcontractor for fulfilling a request or a bundle of requests.

Let 
                           
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    3
                                 
                              
                           
                         denote the sets of vehicles hired on modes TB and DB, respectively. The set of vehicles available for forwarder i is 
                           
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    ∪
                                 
                                 
                                    g
                                    =
                                    1
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    g
                                 
                              
                           
                        . Let 
                           
                              
                                 
                                    pay
                                 
                                 
                                    r
                                 
                              
                           
                         denote the customer payment for request r. The binary variable 
                           
                              
                                 
                                    z
                                 
                                 
                                    r
                                 
                                 
                                    s
                                 
                              
                              =
                              1
                              ,
                              
                              r
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                           
                        , indicates that request r should be selected for self-fulfillment.“Cherry-picking” can be modeled as a two-phase optimization problem. First, requests that may result in highest payoffs are selected for the own fleet. The remaining requests are then assigned to subcontractors. In the first phase, the objective function of the model (1)–(13) is replaced by
                           
                              (14)
                              
                                 
                                    max
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       pay
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       r
                                    
                                    
                                       s
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       uv
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                              
                           
                        As 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                        , we can use index u instead of r. The selection of requests for self-fulfillment causes that (2) is replaced by
                           
                              (15)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       u
                                    
                                    
                                       s
                                    
                                 
                                 
                                 ∀
                                 u
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     

Assume that the set of not assigned requests in the first phase is 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    sub
                                 
                              
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                           
                        . Define the graph 
                           
                              
                                 
                                    G
                                 
                                 
                                    i
                                 
                                 
                                    sub
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             i
                                          
                                          
                                             sub
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                          
                                             sub
                                          
                                       
                                    
                                 
                              
                           
                         in analogy to 
                           
                              
                                 
                                    G
                                 
                                 
                                    i
                                 
                              
                           
                         according to 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    sub
                                 
                              
                           
                        . Suppose that the charge of outsourcing a request 
                           
                              r
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    sub
                                 
                              
                           
                         to a common carrier is 
                           
                              
                                 
                                    γ
                                 
                                 
                                    r
                                 
                              
                           
                        . The binary variable 
                           
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                                 
                                    d
                                 
                              
                              ,
                              
                              k
                              ∈
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    3
                                 
                              
                           
                        , indicates if a vehicle of mode DB is used. The binary variable 
                           
                              
                                 
                                    z
                                 
                                 
                                    r
                                 
                                 
                                    c
                                 
                              
                              ,
                              
                              r
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    sub
                                 
                              
                           
                        , indicates if request r should be given to a common carrier. The customers’ payments will be held by the forwarder and the objective in this phase is to minimize the total subcontracting costs.
                           
                              (16)
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                             
                                                sub
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       uv
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                             
                                                sub
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       r
                                    
                                    
                                       c
                                    
                                 
                              
                           
                        Constraint (2) has to be reformulated as
                           
                              (17)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          ∪
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                             
                                                sub
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       u
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 1
                                 
                                 ∀
                                 u
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       sub
                                    
                                 
                              
                           
                        and the following two constraints must be added into the model (3)–(13).
                           
                              (18)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                             
                                                sub
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             o
                                          
                                          
                                             i
                                          
                                       
                                       vk
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                             
                                                sub
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                                 ⩽
                                 
                                    
                                       RL
                                    
                                    
                                       k
                                    
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                              
                           
                        Eq. (18) ensures that a vehicle 
                           
                              k
                              ∈
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    3
                                 
                              
                           
                         will be paid if it is used. Constraint (19) restricts the maximal route length for 
                           
                              k
                              ∈
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    3
                                 
                              
                           
                         to 
                           
                              
                                 
                                    RL
                                 
                                 
                                    k
                                 
                              
                           
                        .

Although “cherry-picking” can help achieving a very high profitability of the own vehicles, it may result in expensive routes for subcontracting and thus lead to inferior solutions compared to the IOTP which simultaneously minimizes the total fulfillment costs of all four modes. The IOTP problem consists of two strongly interdependent subproblems. The first one is the mode-selection problem, which assigns requests to different modes. The second one is the routing problem, which has to be solved for modes SF, TB, and DB. As the customer payments are constant, the problem of IOTP aims at minimizing the total fulfillment costs and can be modeled as
                           
                              (20)
                              
                                 
                                    min
                                 
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          ∪
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       uv
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       r
                                    
                                    
                                       c
                                    
                                 
                              
                           
                        subject to constraints (3)–(13) and (17)–(19) by replacing 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                                 
                                    sub
                                 
                              
                           
                         and 
                           
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                                 
                                    sub
                                 
                              
                           
                         with 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                           
                        , respectively.

Suppose now that the m independent members of the coalition want to reduce their total costs by exchanging requests. It is assumed that all requests 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              m
                           
                        , can be offered for exchange in the coalition and fulfilled by any available vehicle of any partner in the coalition.

The request portfolio 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                           
                         of each forwarder i can be divided into two parts. The first part is the set of requests 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                              ⊆
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                           
                         that have been offered but not transferred to other partners. The transferred requests constitute the set 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    -
                                 
                              
                              =
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              ⧹
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                           
                        . The new request portfolio after the exchange is 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                              ∪
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                           
                        , while 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                           
                         is the set of requests acquired from other partners. The execution costs for the new request portfolio 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                         according to a plan 
                           
                              
                                 
                                    Π
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                         are denoted as 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                        . The CTP can be modeled as the following optimization problem
                           
                              (21)
                              
                                 
                                    min
                                 
                                 
                                 
                                    
                                       TC
                                    
                                    
                                       CTP
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 subject to
                                 
                                 
                                    
                                       R
                                    
                                    
                                       h
                                    
                                    
                                       ′
                                    
                                 
                                 ∩
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 ∅
                                 
                                 ∀
                                 h
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 ,
                                 
                                 h
                                 
                                 ≠
                                 
                                 i
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       ∪
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                    
                                       -
                                    
                                 
                                 =
                                 
                                    
                                       ∪
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                    
                                       +
                                    
                                 
                              
                           
                        
                     

In order to evaluate the efficiency of a CTP approach, two reference scenarios, isolated planning and centralized planning, are defined.

In the scenario of isolated planning, each member i has to fulfill his customer requests either by using his own vehicles or by subcontracting. An execution plan 
                           
                              
                                 
                                    Π
                                 
                                 
                                    i
                                 
                              
                           
                         with total costs 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                         as defined in (20) can be obtained by solving the IOTP problem. The total costs of all coalition members are then given by the sum of costs of all partners’ individual plans 
                           
                              
                                 
                                    TC
                                 
                                 
                                    IP
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                        .

In the scenario of centralized planning, a notional planning authority would plan for the entire coalition. This planning authority would have to be able to access all private information and to be provided with all decision-making competences. Let 
                           
                              R
                              =
                              
                                 
                                    ∪
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                           
                         be the set of all customer requests and 
                           
                              K
                              =
                              
                                 
                                    ∪
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                           
                         the set of all available vehicles of the coalition. Specifically, 
                           
                              
                                 
                                    K
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    ∪
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    K
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    ∪
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    K
                                 
                                 
                                    3
                                 
                              
                              =
                              
                                 
                                    ∪
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    3
                                 
                              
                           
                        . The IOTP for the centralized planning can be defined on a new graph 
                           
                              G
                              =
                              (
                              V
                              ,
                              A
                              )
                           
                         with 
                           
                              V
                              =
                              
                                 
                                    ∪
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              A
                              =
                              (
                              V
                              ×
                              V
                              )
                           
                        . The objective function minimizes the total fulfillment costs 
                           
                              
                                 
                                    TC
                                 
                                 
                                    CP
                                 
                              
                           
                         for the entire coalition. Similar to (20), it can be defined as
                           
                              (24)
                              
                                 
                                    min
                                 
                                 
                                    
                                       TC
                                    
                                    
                                       CP
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                1
                                             
                                          
                                          ∪
                                          
                                             
                                                K
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          ∈
                                          A
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       uv
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          ∈
                                          R
                                       
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       r
                                    
                                    
                                       c
                                    
                                 
                              
                           
                        
                     

In order to solve the IOTP for both isolated and centralized planning, two heuristics have been developed. The first one is an adaptive large neighborhood search (ALNS) heuristic, which is based on the ALNS proposed in (Ropke & Pisinger, 2006) for the PDPTW. The second approach improves the solution quality further. The IOTP problem is modeled as a set partitioning problem (SPP) or a set covering problem (SCP). Then, promising partial solutions are iteratively looked for using ALNS, and are finally recombined into better solutions.

The ALNS proposed by Ropke and Pisinger (2006) is embedded in a simulated annealing (SA) metaheuristic, while in each iteration a removal and an insertion operator are chosen and used. The removal or insertion operators are selected based on a probability vector which is altered and adapted to the current situation during the search process.

In the ALNS proposed in Ropke and Pisinger (2006), two kinds of insertion operators and three removal operators are used. The first insertion operator is called basic greedy heuristic. For all requests not scheduled in any route, this operator evaluates the insertion cost, 
                           
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    rk
                                 
                              
                           
                        , defined as the increment of route cost after request r is inserted into route k at the best possible position. The request with the minimum 
                           
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    r
                                 
                              
                              =
                              
                                 
                                    min
                                 
                                 
                                    k
                                    ∈
                                    K
                                 
                              
                              {
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    rk
                                 
                              
                              }
                           
                         is then inserted at its best position overall. The process is repeated until no more insertions are possible. The other insertion operators called regret heuristics additionally estimate the consequential cost of not inserting a request in the current iteration. The request with the highest consequential cost is then inserted. The three removal operators are worst removal, Shaw removal, and random removal. Worst removal iteratively removes the request with the highest marginal cost, that is the cost difference with and without this request. Shaw removal iteratively removes some similar requests at a time. Random removal randomly chooses requests and removes them from vehicle routes.

In order to make the heuristic suitable for IOTP, we modified the heuristic. Instead of calculating the insertion cost 
                           
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    rk
                                 
                              
                           
                        , the cost-savings 
                           
                              
                                 
                                    γ
                                 
                                 
                                    r
                                 
                              
                              -
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    rk
                                 
                              
                           
                         that is achievable by inserting request r into route k is calculated. Here, cost-savings refer to the amount of cost that can be reduced if a request is inserted into a route instead of being forwarded to a common carrier. Requests with positive cost-savings are automatically considered as candidates for insertion. But also requests with negative cost-savings can be inserted into routes if 
                           
                              Δ
                              
                                 
                                    c
                                 
                                 
                                    rk
                                 
                              
                              -
                              
                                 
                                    γ
                                 
                                 
                                    r
                                 
                              
                              ⩽
                              ζ
                              
                                 
                                    T
                                 
                                 
                                    it
                                 
                              
                           
                         is applicable, where 
                           
                              ζ
                           
                         is a threshold parameter and 
                           
                              
                                 
                                    T
                                 
                                 
                                    it
                                 
                              
                           
                         is the SA temperature in iteration it. At the beginning of the search process, while 
                           
                              
                                 
                                    T
                                 
                                 
                                    it
                                 
                              
                           
                         is still large, the heuristic tries to insert all requests into vehicle routes. In later phases, 
                           
                              
                                 
                                    T
                                 
                                 
                                    it
                                 
                              
                           
                         becomes much smaller and the heuristic becomes more and more selective. Requests will only be (re-)inserted into vehicle routes if the insertion will reduce the overall objective value (at least at the moment when the insertion is done).

For the vehicles paid on mode DB, the cost function for the search process has to be changed, because otherwise the insertion cost for any request in an empty route would be the flat-rate, and after that, the insertion cost would be zero for further requests. We thus calculate a fictive variable cost for this mode by dividing the flat-rate by a route length that is slightly shorter than the maximum agreed route length and use it for calculating insertion costs.

In this section, a sophisticated approach, given by HII, is proposed. It uses the ALNS heuristic iteratively to find efficient vehicle routes and recombines them to generate IOTP solutions. In general, HII is similar to the column generation technique used for solving vehicle routing problems.

The IOTP problem can be modeled as an SPP. Let 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                                 
                                    3
                                 
                              
                           
                         represent the sets of feasible routes for modes SE, TB, and DB, respectively. 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    ∪
                                 
                                 
                                    g
                                    =
                                    1
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                                 
                                    g
                                 
                              
                           
                         represents all feasible routes in all fulfillment modes. Denote the fulfillment costs of a route 
                           
                              j
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                              
                           
                         as 
                           
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                           
                        . For own vehicles, only the variable costs are considered. If a route can be executed in more than one mode, it will be represented as different routes in 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                              
                           
                        , because the route costs may vary in different modes. 
                           
                              
                                 
                                    f
                                 
                                 
                                    j
                                 
                                 
                                    g
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              ,
                              
                              g
                              =
                              1
                              ,
                              2
                              ,
                              3
                           
                        , specifies the mode of route j. 
                           
                              
                                 
                                    a
                                 
                                 
                                    rj
                                 
                              
                              =
                              1
                           
                         indicates that a request r is served in route j and 
                           
                              
                                 
                                    a
                                 
                                 
                                    rj
                                 
                              
                              =
                              0
                           
                         otherwise. The binary variable 
                           
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                              j
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                              
                           
                        , indicates if a route is chosen for request fulfillment. Furthermore, we also use 
                           
                              
                                 
                                    γ
                                 
                                 
                                    r
                                 
                              
                           
                         to denote the charge for outsourcing request 
                           
                              r
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                           
                         to a common carrier and 
                           
                              
                                 
                                    z
                                 
                                 
                                    r
                                 
                                 
                                    c
                                 
                              
                              =
                              1
                           
                         to indicate this. The IOTP problem can be defined as to choose some requests for outsourcing and to choose a set of vehicle routes for the execution of the rest of requests in such a way, that the total fulfillment costs are minimized. This decision problem, which is the so-called master problem, can be modeled as follows
                           
                              (25)
                              
                                 
                                    min
                                 
                                 
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                Ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       r
                                    
                                    
                                       c
                                    
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 subject to
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                Ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       rj
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       r
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 1
                                 
                                 ∀
                                 r
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                Ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 ⩽
                                 |
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                    
                                       g
                                    
                                 
                                 |
                                 
                                 ∀
                                 g
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                              
                           
                        
                        
                           
                              (28)
                              
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 j
                                 ∈
                                 
                                    
                                       Ω
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     

The objective function (25) minimizes the total costs including the fixed costs of the own fleet, the total costs of routes, and the charges for outsourcing requests to common carriers. Constraint (26) ensures that every request must be executed by exactly one route or alternatively be outsourced to a common carrier. Constraint (27) is the fleet size restriction. This model is valid for a single forwarder. The model for the coalition’s centralized planning can be derived by considering all requests, routes and vehicles of all members.

The problem of finding feasible routes is defined as the subproblem. As it is impossible and not necessary to enumerate all feasible routes, only a subset of 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              ⊂
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                              
                           
                         will actually be generated. To improve the solutions obtained by using 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                        , an iterative process is applied, in which only promising routes that can improve the objective value are searched and added into 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                        . In particular, HII starts with solving the IOTP problem heuristically using the ALNS heuristic. The routes in the best solutions found by ALNS are recorded to generate a meaningful 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                        .

In each iteration of the iterative process, the master problem is relaxed to a linear programming (LP) problem by relaxing 
                           
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                         to a continuous variable and the relaxed problem is solved. The objective function value of this relaxed problem can be improved by adding new columns, i.e., vehicle routes, with negative reduced costs into 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                        . The reduced cost of a column j is defined as 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    ¯
                                 
                              
                              =
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    ∑
                                 
                                 
                                    r
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    rj
                                 
                              
                              -
                              
                                 
                                    ∑
                                 
                                 
                                    g
                                    =
                                    1
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    j
                                 
                                 
                                    g
                                 
                              
                           
                        , where 
                           
                              π
                           
                         and 
                           
                              σ
                           
                         are the dual multipliers related to constraints (26) and (27), respectively. We replace j with k to get the reduced cost of a route for vehicle k as 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    ¯
                                 
                              
                              =
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              -
                              
                                 
                                    ∑
                                 
                                 
                                    r
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    rk
                                 
                              
                              -
                              
                                 
                                    ∑
                                 
                                 
                                    g
                                    =
                                    1
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    k
                                 
                                 
                                    g
                                 
                              
                           
                        . A common way to find new routes is to solve the problem of minimizing 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    ¯
                                 
                              
                           
                        . However, HII uses two options to find a set of complimentary routes at a time, even if some of them may have non-negative reduced costs.

Option one is to solve the IOTP problem using the ALNS heuristic with the objective of minimizing the total reduced costs of all its routes.
                           
                              (29)
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       rk
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          g
                                          =
                                          1
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                    
                                       g
                                    
                                 
                              
                           
                        
                     

The first term on the right-hand-side calculates the total route costs of the solution. The second term sums up the 
                           
                              
                                 
                                    π
                                 
                                 
                                    r
                                 
                              
                           
                         values for those requests chosen for the vehicles and can be rewritten as 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    r
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    r
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    z
                                 
                                 
                                    r
                                 
                                 
                                    c
                                 
                              
                              )
                           
                        , while 
                           
                              
                                 
                                    z
                                 
                                 
                                    r
                                 
                                 
                                    c
                                 
                              
                              =
                              1
                              ,
                              
                              r
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                           
                         indicates that request r is outsourced to a common carrier and 
                           
                              
                                 
                                    z
                                 
                                 
                                    r
                                 
                                 
                                    c
                                 
                              
                              =
                              0
                           
                         that it is planned in some vehicle route. As the last term is a constant, (29) is equivalent to
                           
                              (30)
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       r
                                    
                                    
                                       c
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       r
                                    
                                    
                                       c
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       r
                                    
                                 
                              
                           
                        We can omit the constant term 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    r
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    r
                                 
                              
                           
                         again, and reformulate this objective function by substituting the total route costs in a more concrete form
                           
                              (31)
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          ∪
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       uv
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       uvk
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       r
                                    
                                    
                                       c
                                    
                                 
                              
                           
                        This is the same objective function as (20), except that the constant term of fixed costs 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    ∈
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    k
                                 
                              
                           
                         is omitted and the charge for common carriers is replaced by the dual variable 
                           
                              π
                           
                        . That is why we can directly use the ALNS heuristic to generate new routes. Since the IOTP problem with heterogeneous fleet is solved here, we denote the heuristic using this option as HII-HET.

Instead of solving the IOTP problem for the entire fleet 
                           
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                           
                        , the second option is to solve several subproblems for every vehicle mode, i.e., for the vehicle sets 
                           
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                                 
                                    g
                                 
                              
                              ,
                              
                              g
                              =
                              1
                              ,
                              2
                              ,
                              3
                           
                        , respectively. Thus, each IOTP instance solved here has a homogeneous fleet. We denote this variation as HII-HOM.

As both options solve the corresponding subproblems in a heuristic manner, a set of different sub-optimal solutions can be obtained. The routes in these solutions are then added into 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                        . The iterative process of generating new routes ends when some stopping criterion is satisfied.

After the route generation process, the master problem is solved again while the constraint (26) is replaced by
                           
                              (32)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                Ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       rj
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       r
                                    
                                    
                                       c
                                    
                                 
                                 ⩾
                                 1
                                 
                                 ∀
                                 r
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     


                        (25), (32), (27), and (28) constitute the SCP-based model of the master problem. A feasible solution to this model may be infeasible to the original problem since some requests may be assigned more than once. More precisely, some requests may be assigned to more than one vehicle. In this case, the solution to the SCP-based model will be repaired. The solution repair routine first removes all requests that have been assigned to several vehicles from the related routes. Then it tries to reinsert them into vehicle routes at the best position while keeping the remaining part of the result unchanged.

The entire heuristic consists of 5 steps:
                           
                              
                                 Step 1: Solve the original IOTP problem using ALNS and record the best 
                                    
                                       θ
                                    
                                  solutions found. Add all routes derived from the recorded solutions into 
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 .


                                 Step 2: Solve the LP relaxation of the master problem. Check whether the objective value has been improved more than 
                                    
                                       ∊
                                       %
                                    
                                 . If so, go to Step 3, otherwise go to Step 5.


                                 Step 3: Substitute 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             r
                                          
                                       
                                    
                                  with 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             r
                                          
                                       
                                    
                                  for all 
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                    
                                 . Add the fixed terms into the IOTP model. Solve the IOTP problem with updated values using ALNS and record the best 
                                    
                                       θ
                                    
                                  solutions found. Add all routes derived from the recorded solutions into 
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 .


                                 Step 4: Check if the given number of maximal iterations has been reached. If so, go to Step 5, otherwise go back to Step 2.


                                 Step 5: Solve the SCP-based model of the master problem. Repair the solution using ALNS if necessary.

Each time when the ALNS is used, up to 
                           
                              θ
                           
                         best solutions found during the search process are recorded. Subsequently, each route in these solutions is reviewed for feasibility in other fulfillment modes. A route may be added into 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                         more than once with different route costs calculated for different modes. This operation can be understood as an special form of the swap operator, which changes two vehicle routes of different types. Our tests show that it can lead to considerable improvements, especially for HII-HET.

Further mentionable is that in Step 2, the SCP-based model of the master problem can also be used by replacing (26) with (32). Computational results show no difference in performance between the two formulations.

In this section, the iterative heuristic approach HII is adjusted to a heuristic for CTP. This approach represents an extension of the route-based request exchange mechanism proposed for CTP in Wang and Kopfer (2014) by considering a heterogeneous fleet and subcontracting. The collaborative problem can be considered as m IOTP problems that have to be solved by individual members of the coalition and a coordinating problem in form of an SPP or an SCP that has to be solved by an “agent” who technically could just be a computer.

The whole process begins with a preprocessing phase, in which participating forwarders propose their customer requests for exchange in a request pool. After that, all partners solve their individual IOTP problems and the resulting costs are denoted as internal price 
                        
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                        
                     . The generated routes are reported to the agent in form of request bundles. For each bundle, the route cost is revealed to the agent as the cost of this bundle but the concrete order of customer nodes in the corresponding route needs not to be reported. The agent solves the coordinating problem for the entire coalition by choosing the most promising bundles, i.e., by solving the SPP or SCP, to minimize the total costs of the coalition. In order to improve the solution quality, the agent solves the LP-relaxed SPP and sends the dual values associated with the requests and vehicles back to the members so that they can generate new routes, and thus, bundles using the feedback information. When a fairly well improved solution (compared to the isolated scenario) is found, the chosen bundles are declared as winning bundles and their costs will be paid by the agent. Finally, the difference between the total internal prices paid to the agent and the total costs of winning bundles paid by the agent will be determined as joint benefits of the coalition. The major difference between this approach and the HII presented in Section 4.2 is that the IOTP problems in the collaborative scenario are solved simultaneously by all partners, who only generate routes for their own disposable vehicles.

In this step, all members initially offer their request portfolios 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              m
                           
                        , for exchange. As a result, 
                           
                              R
                              =
                              
                                 
                                    ∪
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                           
                         is the entire set of requests in the request pool. For each request 
                           
                              r
                              ∈
                              R
                           
                        , the information about the pickup and delivery locations, the time windows, and the load to be transported is also transferred to the agent and are generally accessible. However, the customer payments remain concealed.

After that, collaborating partners have to specify the internal prices for their own request sets 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                           
                         by solving their individual IOTP problems. The sum of internal prices of the request portfolios of all partners corresponds to the total fulfillment costs of the isolated planning 
                           
                              
                                 
                                    TC
                                 
                                 
                                    IP
                                 
                              
                           
                        . The internal prices are only necessary for the decision of the coalition on the acceptance of CTP solutions if 
                           
                              
                                 
                                    TC
                                 
                                 
                                    CTP
                                 
                              
                              ⩽
                              
                                 
                                    TC
                                 
                                 
                                    IP
                                 
                              
                           
                        , and for the determination of the collaborative profit 
                           
                              
                                 
                                    TC
                                 
                                 
                                    IP
                                 
                              
                              -
                              
                                 
                                    TC
                                 
                                 
                                    CTP
                                 
                              
                           
                        . Apart from that they remain concealed.

The first step of applying the decomposition scheme proposed by Dantzig and Wolfe (1960) is to generate a meaningful set of columns, i.e., vehicle routes in our case. This step is called initial route generation and it is similar to Step 1 of HII in Section 4.2. After that, the iterative process of route generation starts and it is similar to Steps 2 and 3 of HII in Section 4.2.

Purpose of this step is to generate a meaningful set of vehicle routes to start the iterative process of route generation. One strategy to achieve this is to encourage each partner to do “cherry-picking” for his own vehicles and all his available subcontractors, while leaving the remaining requests to common carriers. Thus the objective function for initial route generation can be defined as maximizing the reduction of external freight charges for subcontracting requests to common carriers by “cherry-picking”.
                              
                                 (33)
                                 
                                    
                                       max
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    1
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          r
                                       
                                       
                                          c
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      ∈
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      ∈
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ∪
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      (
                                                      u
                                                      ,
                                                      v
                                                      )
                                                      ∈
                                                      A
                                                   
                                                
                                             
                                             
                                                
                                                   β
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   uv
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   uvk
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      ∈
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   k
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The first term calculates the amount of freight charges for the requests chosen for the fleet in case they are outsourced to common carriers. The rest part calculates the route costs for fulfilling these requests with available vehicles. Their difference is then the reduction of external freight charges through “cherry-picking”. This is equivalent to
                              
                                 (34)
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ∪
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             u
                                             ,
                                             v
                                             )
                                             ∈
                                             A
                                          
                                       
                                    
                                    
                                       
                                          β
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          uv
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          uvk
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                       
                                          d
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          r
                                       
                                       
                                          c
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          r
                                       
                                    
                                 
                              
                           
                        

This objective function (34) is actually the same as (20) because the last term in (34) 
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       R
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       r
                                    
                                 
                              
                            is a constant term and can be ignored. The only difference is that the request set 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                            is substituted by the entire request set R of the whole coalition. We can use the ALNS heuristic presented in Section 4.1 to solve this problem. Again, we record the best solutions found during the search process for the route generation.

As we want to guarantee that the winning bundles chosen by the agent do not exceed the fleet capacities available to the forwarders, each partner has to report the maximum number of winning bundles he is able to fulfill in each single mode (SF, TB, DB). Additionally, we split the modes into vehicle types because the fleet of a single mode could be heterogeneous as well. All vehicles of a single type are identical with respect to capacity and cost parameters. If a route is feasible for one vehicle of a specific type, then it is feasible for all vehicles of that type at the same cost.

After all members have submitted their bundles, the agent temporarily solves the current winner determination problem (WDP). The idea is almost the same as solving the master problem (25)–(28).

Suppose a set 
                              
                                 R
                                 =
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 }
                              
                            with n requests is offered for exchange. Each member i has submitted 
                              
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                              
                            bundles. For each single request 
                              
                                 r
                                 ∈
                                 R
                              
                           , a single-request bundle with its outsourcing price 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       r
                                    
                                 
                              
                            as its bundle cost is also added into the bundle set. The cost of a bundle 
                              
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                              
                            is identical to the route cost if it is derived from a vehicle route or to the outsourcing price if it is a single-request bundle. The total number of bundles is 
                              
                                 ω
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 n
                              
                           . Let 
                              
                                 
                                    
                                       a
                                    
                                    
                                       rj
                                    
                                 
                                 =
                                 1
                              
                            indicate that request 
                              
                                 r
                                 ∈
                                 R
                              
                            is contained in bundle j and 
                              
                                 
                                    
                                       a
                                    
                                    
                                       rj
                                    
                                 
                                 =
                                 0
                              
                            otherwise. Denote the number of all vehicle types reported by all carriers as 
                              
                                 τ
                              
                           . Let 
                              
                                 
                                    
                                       f
                                    
                                    
                                       gj
                                    
                                 
                                 =
                                 1
                              
                            represent that bundle j is proposed for type 
                              
                                 g
                                 ,
                                 
                                 g
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 τ
                              
                            and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       gj
                                    
                                 
                                 =
                                 0
                              
                            otherwise. The reported maximum acceptable number of winning bundles for type g is 
                              
                                 
                                    
                                       κ
                                    
                                    
                                       g
                                    
                                 
                              
                           . The WDP can be modeled as an SPP while the binary variable 
                              
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 ω
                              
                           , takes value 1 if bundle j is chosen as a winning bundle.
                              
                                 (35)
                                 
                                    
                                       min
                                    
                                    
                                    
                                       
                                          TC
                                       
                                       
                                          CTP
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             ω
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                           
                              
                                 (36)
                                 
                                    subject to
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             ω
                                          
                                       
                                    
                                    
                                       
                                          a
                                       
                                       
                                          rj
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    1
                                    
                                    ∀
                                    r
                                    ∈
                                    R
                                 
                              
                           
                           
                              
                                 (37)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             ω
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          gj
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    ⩽
                                    
                                       
                                          κ
                                       
                                       
                                          g
                                       
                                    
                                    
                                    ∀
                                    g
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    τ
                                 
                              
                           
                           
                              
                                 (38)
                                 
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    
                                    ∀
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    ω
                                 
                              
                           
                        

Denote this SPP-based WDP model as WDP-SP. An LP relaxation of WDP-SP is given by relaxing 
                              
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                              
                            to be a continuous variable. Denote the relaxed problem as WDP-LP. Then, the dual values of constraints (36) and (37) can be used for generating new routes. The route generation problem is to build new routes with negative reduced costs 
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       ¯
                                    
                                 
                              
                           , which can be calculated for a variable 
                              
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                              
                            as 
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 -
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       R
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       rj
                                    
                                 
                                 -
                                 
                                    
                                       ∑
                                    
                                    
                                       g
                                       =
                                       1
                                    
                                    
                                       τ
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       gj
                                    
                                 
                              
                           , where 
                              
                                 π
                              
                            and 
                              
                                 σ
                              
                            are the dual variables corresponding to the constraints (36) and (37), respectively. To improve the objective function value of WDP-LP, new routes with 
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       ¯
                                    
                                 
                                 <
                                 0
                              
                            have to be found. Values of 
                              
                                 π
                              
                            and 
                              
                                 σ
                              
                            are read by the agent and sent back to forwarders while 
                              
                                 
                                    
                                       π
                                    
                                    
                                       r
                                    
                                 
                              
                            is given in a revised form of 
                              
                                 
                                    
                                       π
                                    
                                    
                                       r
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 max
                                 {
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       r
                                    
                                 
                                 }
                                 ,
                                 
                                 r
                                 ∈
                                 R
                              
                           .

Given the values of 
                              
                                 
                                    
                                       π
                                    
                                    
                                       ′
                                    
                                 
                              
                            and 
                              
                                 σ
                              
                           , forwarders can generate new routes. In order to reduce the number of iterations needed for route generation, i.e., rounds of communications between the agent and forwarders, a bunch of routes are generated at a time instead of searching for a route with the minimal reduced cost 
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                              
                           . Analogues to the options presented in Section 4.2, this can be done by solving IOTP instances. Again, two options can be chosen. Each member can either solve an IOTP instance for his entire heterogeneous fleet 
                              
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                 
                              
                            (including vehicles of his subcontractors) or solve a set of IOTP instances each only for a homogeneous vehicle set of a specific vehicle type. We use CTP-HET and CTP-HOM to differentiate these two options, respectively.

Applying the CTP-HET option means to search for a set of vehicle routes, which can be fulfilled using the entire fleet 
                              
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                 
                              
                            of a single partner i. We can formulate the objective function of this optimization problem by using index k instead of j in 
                              
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                              
                            for emphasizing the vehicles
                              
                                 (39)
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          ¯
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          r
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          a
                                       
                                       
                                          rk
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             g
                                             =
                                             1
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          g
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          gk
                                       
                                    
                                 
                              
                           
                        

Analogues to (29), this objective function is equivalent to
                              
                                 (40)
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ∪
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             u
                                             ,
                                             v
                                             )
                                             ∈
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          β
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          uv
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          uvk
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                       
                                          d
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          r
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          r
                                       
                                       
                                          c
                                       
                                    
                                 
                              
                           
                        

Thus, the iterative route generation problem has exactly the same structure as the original IOTP problem and we can use the same heuristic to solve it. During the search process, a number of solutions will be recorded for generating new bundles. For the option CTP-HOM, the objective functions for each vehicle type can be formulated directly in the same way as (40).

This strategy helps find not only “good” routes that will improve the WDP-LP objective values, but also routes that are complementary to those good ones. Computational results show that the gap between the WDP-LP and the final integer WDP-SP solutions is quite small (for almost all instances, the gap is smaller than 2%), so that it is unnecessary to call a branch-and-bound (B&B) routine after the column generation phase. This effect is especially favorable for CTP, as such B&B routine would cause a lot of communications between the agent and forwarders, and thus, a lot of transactional costs.

The new routes are added to the existing bundle set. The Steps temporary winner determination and iterative route generation are repeated until some stopping criterion is met. The route generation phase is then concluded.

In this phase, the agent solves another relaxation of the WDP-SP. Now, the constraint (36) is replaced by
                           
                              (41)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          ω
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       rj
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 ⩾
                                 1
                                 
                                 ∀
                                 r
                                 ∈
                                 R
                              
                           
                        This model, defined by (35), (41), (37), and (38), is the SCP-based model of the WDP. We denote it as WDP-SC.

If the WDP-SC solution is also feasible to WDP-SP, the requests each winning bundle pursued, will be assigned to the forwarder who won this bundle. If a bundle representing the choice of outsourcing only one request to a common carrier wins, it will be returned to the member who proposed it for exchange.

If the WDP-SC solution is infeasible to WDP-SP because some requests are assigned to several winning bundles, the agent can repair this solution simply by assigning such a multi-assigned request r to that partner who has won more multi-assigned requests than all other partners competing for r and removing it from all other bundles. Finally, the agent inquires the total costs for the new request portfolio 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                         for all partners 
                           
                              i
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              m
                           
                        , and gets the collaborative result.

The total costs of the CTP solution, including both the winning bundles’ costs and the possible costs for subcontracting, will be compared with the results of the isolated planning. The CTP solution will only be accepted if positive joint benefits are realized.

If a collaborative solution has been accepted, the flow of payments among the coalition members can be determined. First, all forwarders have to pay the amount of the internal costs 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                         to the agent. These are the costs that would result from the situation without collaboration. As an outcome of WDP, requests will be assigned to forwarders according to the winning bundles, and their costs will be paid to the members by the agent. Any request that has been assigned to a single-request winning bundle representing the option of common carriers will be returned to the partner who offered it for exchange. The freight charge for outsourcing a request r to common carriers is given by 
                           
                              
                                 
                                    γ
                                 
                                 
                                    r
                                 
                              
                           
                         and also paid by the agent to the corresponding forwarder. The difference of the incoming payments acquired by the agent, and the total payments paid out by him is then determined as joint benefits of the collaboration. They have to be shared among all participating members.

The difference between the model WDP-SP and the master problem of the IOTP presented in Section 4.2 is that the fixed costs of own vehicles are no more a component of the objective function (35). Instead, they are considered indirectly in the route costs. As a result, if a forwarder cannot win any bundles for some of his own vehicles, he must pay the fixed costs for these vehicle on his own. For the winning bundles, the costs will be compensated by the corresponding payments from the agent. This effect gives forwarders more incentive to generate efficient routes, especially for their own vehicles.

In order to analyze the cost-saving potentials by performing both IOTP and CTP and to evaluate the efficiency of the proposed CTP mechanism, new theoretical instances are generated. In total, 29 IOTP instances are derived from the PDPTW instances generated by Li and Lim (2001) and 24 CTP instances are generated using the new IOTP instances (see Appendix A). As it is obvious that the IOTP is superior to “cherry-picking” regarding the overall fulfillment costs, we exclude the experiment of “cherry-picking”.

The heuristics presented in Section 4 are used for solving the IOTP problem for both the isolated and centralized planning scenarios. For the ALNS, we use the same parameter setting for the operators as suggested in Ropke and Pisinger (2006). The temperature 
                           
                              
                                 
                                    T
                                 
                                 
                                    it
                                 
                              
                           
                         of the SA process in iteration it is determined as 
                           
                              
                                 
                                    T
                                 
                                 
                                    it
                                 
                              
                              =
                              
                                 
                                    T
                                 
                                 
                                    it
                                    -
                                    1
                                 
                              
                              ·
                              cr
                           
                         where cr is the cooling rate. The start temperature for each instance is set individually such that a solution which is 10% worse than the current solution is accepted with a probability of 0.5. The cooling rate cr is determined such, that after the maximal number of SA iterations the temperature is reduced to 5% of the start niveau. The heuristic stops after 25,000 iterations or 25,000/3 iterations without any improvement of the best solution found so far.

For HII, the ALNS heuristic is used iteratively for route generation. For both HII-HET and HII-HOM, the ALNS runs up to 10,000 iterations in the first step and only 2500 iterations in the following steps. The whole process is stopped after the iterative route generation process has been repeated five times or after three consecutive abortive attempts to improve the objective function value of the LP-relaxed master problem by at least 5%. Each time, up to 1000 best solutions found during the search process are recorded. The routes contained are added to the route set 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    ′
                                 
                              
                           
                        . If a route can be executed by vehicles of different modes, it will be added into 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    ′
                                 
                              
                           
                         as different routes with different costs. We use IBM ILOG CPLEX to solve the LP-relaxed master problems and the SCP-based model of the master problem. All instances are solved using both heuristics 10 times on an Intel i7 PC with 8cores à 3.4GHz. The aggregated results for the IOTP instances and the CTP instances of centralized planning are shown in Tables 1 and 2
                        
                        , respectively. Detailed results can be found in Appendix B. The cost values are given as the average cost of the best solutions found for the instances. The time values are given as the average time in seconds (seconds) used to solve an instance in this set.


                        HII-HET and HII-HOM obviously outperform the simple ALNS. For small IOTP instances (100 customer nodes), the iterative approaches can achieve on average an improvement of 1.33% with regard to solution quality compared to ALNS. HII-HOM performs slightly better than HII-HET. The improvements of HII for larger CTP instances (up to 500 customer nodes) amount to 10.05% (HII-HET) and 10.02% (HII-HOM), respectively. Considering the computational time, the approach HII-HET appears to be favorable in comparison to the other two heuristics. For the three CTP instances R105, R107 and R108, it took quite a long time for CPLEX to optimally solve the WDP-SC. However, if the the relative MIP gap tolerance (MIP-Gap) is reduced to 0.01, this time can be reduced by up to 71.2% with an average decline of the solution quality of 0.2%. The computational time of HII-HOM increases dramatically with the number of customer nodes.

During CTP, all forwarders call in parallel the ALNS heuristic to solve their IOTP problems and generate routes. In the Step initial route generation, the heuristic is allowed to run up to 10,000 iterations and the computational time is restricted to 2minutes (minutes). Each forwarder records up to 1000 best solutions found during the search process and derives bundles from the routes in these solutions. After that, the Step iterative route generation is repeated five times. The time limit to run ALNS is reduced for CTP-HET to 30seconds each time. For CTP-HOM, the IOTP problem of each vehicle type is solved within 20seconds by running the ALNS up to 2500 iterations, while up to 350 solutions are recorded for route generation, i.e., 1minute and up to 1050 solutions for three vehicle types in total. We do not set a time limit for CPLEX to solve the WDP-LP, since this can be done in less than 1s for all instances. For the WDP-SC however, the MIP-Gap is set to 0.01. A time limit of 2minutes is also set for CPLEX. As a result, the total time for CTP is limited to 6.5minutes for CTP-HET and 9minutes for CTP-HOM. The time given for running ALNS is generally sufficient and the time limits are primarily used for synchronizing the parallel computing of several forwarders.

We simulated the collaborative planning of the coalition for each CTP instance once and got 24 samples to evaluate the performance of the proposed request exchange mechanism. The results can be found in Table 3
                        . The total costs for the isolated planning 
                           
                              
                                 
                                    TC
                                 
                                 
                                    IP
                                 
                              
                           
                         are calculated by summing up the costs of all IOTP solutions. 
                           
                              Δ
                              
                                 
                                    TC
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    TC
                                 
                                 
                                    IP
                                 
                              
                              -
                              
                                 
                                    TC
                                 
                                 
                                    CP
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              =
                              100
                              ·
                              Δ
                              
                                 
                                    TC
                                 
                                 
                                    1
                                 
                              
                              /
                              
                                 
                                    TC
                                 
                                 
                                    IP
                                 
                              
                           
                         (%) are the absolute and relative cost-saving potential through centralized planning. Similarly, 
                           
                              Δ
                              
                                 
                                    TC
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    TC
                                 
                                 
                                    IP
                                 
                              
                              -
                              
                                 
                                    TC
                                 
                                 
                                    CTP
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    2
                                 
                              
                              =
                              100
                              ·
                              Δ
                              
                                 
                                    TC
                                 
                                 
                                    2
                                 
                              
                              /
                              
                                 
                                    TC
                                 
                                 
                                    IP
                                 
                              
                           
                         (%) show the absolute and relative cost reduction through CTP. Parameter 
                           
                              η
                              =
                              100
                              ·
                              Δ
                              
                                 
                                    TC
                                 
                                 
                                    2
                                 
                              
                              /
                              Δ
                              
                                 
                                    TC
                                 
                                 
                                    1
                                 
                              
                           
                         (%) shows the realized percentage of cost-saving potential and thus how efficient the reqeust exchange mechanism is. Both variations of collaborative planning can realize the cost-saving potential to a great extend within the same predefined time limit.

@&#CONCLUSION@&#

The highly volatile conditions in the transportation market have strongly influenced the resource management and the operational planning of modern freight forwarders. To improve the operational efficiency, forwarders have to reorganize their internal processes for a better management of external relations to partners in both vertical and horizontal cooperation. In this paper, the operational transportation planning of forwarders in road haulage is discussed taking own resources and those of partners into account. The two related topics for transportation fulfillment, i.e., subcontracting in vertical and request exchange in horizontal cooperations, are integrated into conventional routing problems for the first time in literature. New solution approaches for operational transportation planning that can help forwarders realizing the cost-saving potential embedded in a systematical consideration of subcontracting and request exchange are proposed. Compared with just combining routing and subcontracting, computational results based on theoretical instances show that the costs can be further reduced more than 10% on average by introducing request exchange. The proposed decentralized planning approach can averagely realize over 90% of these potentials, while privacy and autonomy of members in horizontal coalitions remain protected.

@&#ACKNOWLEDGEMENT@&#

This research was supported by the German Research Foundation (DFG) as part of the project “Kooperative Rundreiseplanung bei rollierender Planung”.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.ejor.2014.02.056.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

