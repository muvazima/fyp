@&#MAIN-TITLE@&#A new mathematical programming formulation for the Single-Picker Routing Problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We define and consider the Single-Picker Routing Problem in a block layout.


                        
                        
                           
                           We suggest a new mathematical programming formulation for this problem which takes into account the characteristics of optimal routes in a warehouse.


                        
                        
                           
                           The size of the resulting formulation is independent of the number of pick locations.


                        
                        
                           
                           We compare the proposed formulation to Steiner and standard TSP formulations in terms of number of variables and constraints.


                        
                        
                           
                           We conduct numerical experiments in order to compare the computing times required for solving the model formulations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Traveling Salesman

Order picking

Picker Routing

@&#ABSTRACT@&#


               
               
                  The Single-Picker Routing Problem deals with the determination of the sequence according to which article locations have to be visited in a distribution warehouse and the identification of the corresponding paths which have to be traveled by human operators (order pickers) in order to collect a set of items requested by internal or external customers. The Single-Picker Routing Problem (SPRP) represents a special case of the classic Traveling Salesman Problem (TSP) and, therefore, can also be modeled as a TSP. Standard TSP formulations applied to the SPRP, however, neglect that in distribution warehouses article locations are arranged in a specifically structured way. When arranged according to a block layout, articles are located in parallel picking aisles, and order pickers can only change over to another picking aisle at certain positions by means of so-called cross aisles. In this paper, for the first time a mathematical programming formulation is proposed which takes into account this specific property. By means of extensive numerical experiments it is shown that the proposed formulation is superior to standard TSP formulations.
               
            

@&#INTRODUCTION@&#

The Traveling Salesman Problem (TSP) is one of the most extensively studied problems in combinatorial optimization (Rego, Gamboa, Glover, & Osterman, 2011). It can be described as the problem of finding a least-weight Hamiltonian cycle (in short: a tour) in a complete edge-weighted graph (Glover & Punnen, 1997). The TSP arises in many different practical contexts. It is of prime importance for practical applications in engineering, management, health care and many other areas. For detailed reviews of applications of the TSP in practice we refer to Lenstra and Rinnooy Kan (1975), Matai, Singh, and Mittal (2010) and Filip and Otakar (2011).

In this paper, we will deal with an application of the TSP that arises in distribution warehouse management. As for its core function, order picking, items have to be retrieved from the warehouse in order to satisfy a given demand from customers (Petersen & Schmenner, 1999; Wäscher, 2004). In picker-to-part systems, human operators (order pickers) travel through the warehouse, collecting the requested items at their storage locations. This gives rise to the so-called Single-Picker Routing Problem (SPRP) which includes the determination of the sequence in which the locations have to be visited. It can be interpreted as a special case of the (classic) TSP or the Steiner TSP (Burkard, Deneko, van der Veen, & Woeginger, 1998).

For the (classic) TSP several mathematical programming formulations have been proposed in the literature (Padberg & Sung, 1991). These formulations and also formulations for the Steiner TSP, however, seem not to be appropriate for the SPRP since they ignore the special structure of the latter. In this paper, the first mathematical formulation for the SPRP will be introduced that takes into account specific properties of optimal solutions of this problem. In comparison to the more general modeling approaches mentioned above, the proposed formulation results in a substantial reduction of the number of variables and constraints. In particular, it will be shown that the size of the formulation is independent of the number of locations where items have to be picked from. By means of extensive numerical experiments it will be demonstrated that the proposed formulation for the SPRP is superior to standard TSP and Steiner TSP formulations.

The remainder of this paper is organized as follows: In the following section we introduce the SPRP and review the related literature. In Section 3, we present three well-known general mathematical programming formulations for the TSP as well as a formulation for the Steiner TSP provided by Letchford, Nasiri, and Theis (2013). Since the size of the models will be an important criterion for the analysis and evaluation of the different formulations, we concentrate on compact formulations for the TSP here, i.e. formulations which only require a polynomial number of variables and constraints. In Section 4, the central part of this paper, we develop the newly proposed formulation for the SPRP. First, we describe a graph and its construction on which the formulation is based. Then we represent the graph in a mathematical programming model and exemplify its core elements. In order to analyze and evaluate the different formulations, extensive numerical experiments have been carried out in which a wide range of problem instances have been solved by a state-of-the-art commercial IP solver. The design of the experiments and the results obtained from them are presented in Section 5.

For the sake of simplicity of exposition, we restrain the presentation of the newly-proposed model in Section 4 and the numerical experiments in Section 5 to the so-called single-block layout which represents a standard arrangement of storage locations in distribution warehouses. In Section 6, we extend our view and demonstrate how the graph and the resulting model formulation can be modified in order to represent more complex layouts and other aspects of order picking encountered in practice. In Section 7, the paper concludes with a summary and an outlook on future research areas. An Appendix includes a complete and detailed model formulation for the SPRP.

In picker-to-part order picking systems, the arrangement of storage locations typically follows a block layout (Roodbergen, 2001) in which picking aisles run in parallel to each other. Articles are stored in and picked from racks on both sides of these picking aisles. Cross aisles can be used to proceed from one picking aisle to another. They do not contain any storage locations. A section between two adjacent cross aisles establishes a so-called block. In the following, we will focus on a single-block layout, i.e. only two cross aisles exist, one at the front and one at the rear of the warehouse (see Fig. 1
                        ).

The black rectangles in Fig. 1 give an example of locations from which items have to be collected (pick locations) in order to satisfy a certain demand from (external or internal) customers. This is done by a so-called order picker, a human operator who completes a tour through the warehouse, i.e. he or she starts from a depot, proceeds to the pick locations, retrieves the requested items, and finally returns to the depot where the picked items are deposited.

Due to the high proportion of time-consuming manual tasks, order picking is looked upon as the most labor cost-intensive warehouse function (Tompkins, White, Bozer, & Tanchoco, 2010). Consequently, the minimization of picking times is of vital importance for the efficient control of picking operations. The total order picking time, i.e. the time spent by an order picker to collect all items of a picking order, can be divided into (Tompkins et al., 2010) the setup time (the time for preparing the tour through the warehouse), the travel time (the time needed to travel to, from, and between the pick locations), the search time (the time needed at the article locations for the identification of the items that have to be retrieved), and the pick time (the time actually needed for retrieving the items from the respective article locations). Among these components, the travel time consumes the major proportion of the total order picking time. It also represents the only variable part while the remaining components (setup time, search time, pick times) can be considered to be constants (Bozer & Kile, 2008; Henn, Koch, Dörner, Strauss, & Wäscher, 2010). The travel time is determined by the total length of the picker tour (Jarvis & McDowell, 1991) which, again, is dependent on the sequence according to which the items have to be picked. Assuming that the order picker moves at a constant velocity, the minimization of the total length of the picker tour becomes equivalent to the minimization of the travel time. Therefore, the SPRP can be defined as follows: Given a set of items to be picked from known storage locations, in which sequence should the locations be visited such that the total length of the corresponding picker tour is minimized?

The SPRP can easily be interpreted as a TSP in which the vertices of the corresponding graph are defined by the location of the depot and the locations of the items to be picked. Therefore, general TSP formulations may also be used to model the SPRP. The first mathematical programming formulation for the TSP can be attributed to Dantzig, Fulkerson, and Johnson (1954). It includes one binary variable per edge indicating whether an edge is contained in the tour or not. However, this formulation requires, like several other formulations (Gouveia & Pires, 2001), an exponential number of constraints.

For an explicit representation of large TSPs, compact formulations appear to be more appropriate which only require a polynomial number of variables and constraints. A variety of such formulations have been proposed in the literature (Öncan, Altinel, & Laporte, 2009), of which the formulation of Miller, Tucker, and Zemlin (1960), the single-commodity flow formulation of Gavish and Graves (1978) and the multi-commodity flow formulation of Claus (1984) probably are the most prominent ones. They will be explained in greater detail in Section 3, since we will compare our modeling approach to these formulations.


                        Burkard et al. (1998) pointed out that the SPRP can also be formulated as a Steiner TSP, which can be defined as follows: Let 
                           
                              G
                              =
                              (
                              V
                              ,
                              E
                              )
                           
                         be a graph with a set of vertices V and a set of edges E. Furthermore, let a sequence 
                           
                              
                                 v
                                 1
                              
                              ,
                              
                                 e
                                 1
                              
                              ,
                              
                                 v
                                 2
                              
                              ,
                              …
                              ,
                              
                                 v
                                 k
                              
                              ,
                              
                                 e
                                 k
                              
                              ,
                              
                                 v
                                 
                                    k
                                    +
                                    1
                                 
                              
                           
                         (vi
                         ∈ V, 
                           
                              
                                 e
                                 i
                              
                              =
                              
                                 (
                                 
                                    v
                                    i
                                 
                                 ,
                                 
                                    v
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                              
                              ,
                           
                        
                        
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              k
                              ,
                           
                         
                        k ≥ 0) with ei
                         ≠ ej
                         for i ≠ j and 
                           
                              
                                 v
                                 1
                              
                              =
                              
                                 v
                                 
                                    k
                                    +
                                    1
                                 
                              
                           
                         be called a closed walk. Let P be a subset of V. The elements of V∖P are called Steiner points. A Steiner tour is then defined as a closed walk in which each vertex of P is visited at least once. The Steiner points do not have to be visited. Then the Steiner TSP consists of finding a Steiner tour of minimal length within G (Burkard et al., 1998).

As for the SPRP (see Fig. 2
                        ), the set P is composed of the pick locations and the depot (black vertices), and the Steiner points are the intersections between the picking aisles and the cross aisles (white vertices). The distance between any pair of vertices is the length of the shortest path between the two vertices. By definition, a Steiner tour then has to include the depot and the storage locations of all items to be picked. Visiting these locations more than once is permitted. Multiple visits may occur, e.g., when a picking aisle is entered and left via the same cross aisle. On the other hand, visits of some of the white vertices may be skipped because two points exist for each picking aisle where an aisle can be entered or left, and it is possible to use one vertex twice and skip the other one.


                        Letchford et al. (2013) developed three compact formulations for the Steiner TSP. These formulations are advantageous in comparison to general TSP formulations if the number of Steiner points is large compared to the total number of vertices (Letchford et al., 2013). For problem instances in which less than 100 vertices (including both Steiner points and locations to be visited) have to be considered, the authors proposed the application of a Steiner TSP formulation which is derived from the multi-commodity flow model of Claus (1984). Since instances of the SPRP from practice will usually result in a Steiner TSP with less than 100 vertices, we will focus on this formulation. It will be explained in greater detail in Section 3.

The SPRP in a single-block or a two-block layout can be solved efficiently by problem-specific solution methods. Ratliff and Rosenthal (1983) introduced an optimal algorithm for the single-block case which is based on dynamic programming and solves the problem in 
                           
                              O
                              (
                              m
                              +
                              n
                              )
                           
                         time, where m is the number of picking aisles and n is the number of pick locations. Roodbergen and de Koster (2001a) modified the algorithm for the two-block case. However, it is very difficult to further extend this algorithm to layouts with three or more blocks and up to now no efficient algorithm exists which can deal with an arbitrary number of blocks (Roodbergen, 2001). Our approach is much more flexible with respect to the extension to different layouts which we consider as a main advantage of our approach. In particular, it allows for modeling a block layout with an arbitrary number of blocks and considering the case of decentralized depositing in which items can be deposited at the end of each picking aisle. Furthermore, our proposed model formulation can easily be modified to find simple tours through the warehouse which will be demonstrated in Section 6.

In practice, in order to solve the SPRP, usually simple heuristics, so-called routing strategies, are applied (Roodbergen, 2001). Solutions from such routing strategies can be memorized and executed easily, and they reduce the risk of missing an item that should be picked. The simplest routing strategies are the S-shape, the return and the largest gap strategies (Gu, Goetschalckx, & McGinnis, 2007; de Koster, Le-Duc, & Roodbergen, 2007). The S-shape strategy provides solutions in which the order picker enters a picking aisle and traverses it completely if at least one required item is located in that aisle. Then he proceeds to the next aisle from which items have to be picked. An exception would only be a situation in which the order picker is positioned in the front cross aisle, facing the last picking aisle from which items have to be picked. He would then return to the front cross aisle after having picked the most-distantly located item in that aisle. Solutions from the return strategy provide tours in which each picking aisle containing at least one requested item is entered from the front cross aisle. The picker proceeds to the farthest pick location and returns to the front cross aisle with the picked items. The largest-gap strategy gives solutions in which the order picker completely traverses the first and the last aisle containing a requested item. All other aisles containing at least one required item are entered from the front and from the rear cross aisle in such a way that the non-traversed distance between two adjacent pick locations or a pick location and the adjacent cross aisle is maximal. The combined strategy (Roodbergen & de Koster, 2001b) integrates elements of the S-shape and return strategy. Aisles may be traversed entirely or may be entered and left via the same cross aisle. Solutions are generated by means of dynamic programming.

The performance of the routing strategies is dependent on the problem characteristics (number of picking aisles, number of locations per aisle, position of the depot, number of requested items). Moreover, also the policy according to which items are assigned to different locations has a significant impact on the tour lengths provided by the heuristics. Elements of these routing strategies will be contained in the new model formulation for the SPRP presented in this paper.

For a model formulation of the TSP usually a complete graph 
                        
                           
                              G
                              
                                 T
                                 S
                                 P
                              
                           
                           =
                           
                              (
                              V
                              ,
                              A
                              )
                           
                        
                      is assumed. In case of the SPRP, the set of vertices 
                        
                           V
                           =
                           
                              {
                              0
                              ,
                              …
                              ,
                              n
                              }
                           
                        
                      contains the depot (vertex 0) and all storage locations where items have to be picked. The set of arcs is defined as 
                        
                           A
                           =
                           
                              {
                              (
                              p
                              ,
                              q
                              )
                              ∣
                              p
                              ,
                              q
                              ∈
                              V
                              ,
                              p
                              ≠
                              q
                              }
                           
                        
                      and for each arc a distance cpq
                      can be calculated according to the respective layout.

Based on this graph, we will focus on three model formulations which require a polynomial number of both variables and constraints. These formulations, which have also been chosen by Letchford et al. (2013) as a basis for their analysis of Steiner TSP formulations, differ with respect to two characteristics, namely the number of variables and constraints on the one hand and the quality of the lower bound which can be obtained by solving the LP relaxation on the other hand.

We complete this section of model formulations by presenting the Steiner TSP formulation that was proposed by Letchford et al. (2013) and derived from the multi-commodity flow model of Claus (1984).

The formulation proposed by Miller et al. (1960) uses the following variables:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            arc
                                                            
                                                            (
                                                            p
                                                            ,
                                                            q
                                                            )
                                                            
                                                            is
                                                            
                                                            contained
                                                            
                                                            in
                                                            
                                                            the
                                                            
                                                            tour
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            otherwise
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             (
                                             p
                                             ,
                                             q
                                             )
                                             ∈
                                             A
                                             ;
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                h
                                                p
                                             
                                             :
                                             position
                                             
                                             of
                                             
                                             vertex
                                             
                                             p
                                             
                                             in
                                             
                                             the
                                             
                                             tour
                                             ,
                                             p
                                             ∈
                                             V
                                             ∖
                                             
                                                {
                                                0
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Then, the TSP can be represented as follows:

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                                ∑
                                                
                                                   (
                                                   p
                                                   ,
                                                   q
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                             
                                                c
                                                
                                                   p
                                                   q
                                                
                                             
                                             ·
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   p
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             q
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   q
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             p
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                h
                                                p
                                             
                                             −
                                             
                                                h
                                                q
                                             
                                             +
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             ≤
                                             n
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             (
                                             p
                                             ,
                                             q
                                             )
                                             ∈
                                             A
                                             :
                                             
                                             p
                                             ,
                                             q
                                             ≠
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             (
                                             p
                                             ,
                                             q
                                             )
                                             ∈
                                             A
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                h
                                                p
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             p
                                             ∈
                                             V
                                             ∖
                                             
                                                {
                                                0
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The objective function minimizes the total cost of the tour, i.e. as for the SPRP the total length of the picker tour. Constraints (2) and (3) guarantee that each vertex is visited exactly once. Conditions (4) exclude subtours by ensuring that the position assigned to vertex p in a tour is smaller than the position assigned to vertex q if arc (p, q) is used. This formulation requires only O(n
                        2) variables and constraints. However, the solution of its LP relaxation provides an extremely weak lower bound (Padberg & Sung, 1991).

A formulation based on the flow of a single commodity type has been introduced by Gavish and Graves (1978). At the start of the tour, n units of the commodity are available. While the tour is being executed, these units have to be delivered to the vertices when they are visited. Each vertex requires the shipment of exactly one unit.

For this model, additional non-negative variables are introduced describing the flow on arc (p, q) ∈ A:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                g
                                                
                                                   p
                                                   q
                                                
                                             
                                             :
                                             number
                                             
                                             of
                                             
                                             units
                                             
                                             of
                                             
                                             the
                                             
                                             commodity
                                             
                                             passed
                                             
                                             on
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             directly
                                             
                                             from
                                             
                                             vertex
                                             
                                             p
                                             
                                             to
                                             
                                             q
                                             ,
                                             
                                             (
                                             p
                                             ,
                                             q
                                             )
                                             ∈
                                             A
                                             :
                                             q
                                             ≠
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Based on this definition and on the above-described considerations, the following model formulation can be introduced:

                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                                ∑
                                                
                                                   (
                                                   p
                                                   ,
                                                   q
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                             
                                                c
                                                
                                                   p
                                                   q
                                                
                                             
                                             ·
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   p
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             q
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   q
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             p
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   q
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                g
                                                
                                                   q
                                                   p
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   q
                                                   ∈
                                                   V
                                                   ∖
                                                   
                                                      {
                                                      0
                                                      }
                                                   
                                                
                                             
                                             
                                                g
                                                
                                                   p
                                                   q
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             p
                                             ∈
                                             V
                                             ∖
                                             
                                                {
                                                0
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                
                                                   p
                                                   q
                                                
                                             
                                             ≤
                                             n
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             (
                                             p
                                             ,
                                             q
                                             )
                                             ∈
                                             A
                                             :
                                             
                                             q
                                             ≠
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             (
                                             p
                                             ,
                                             q
                                             )
                                             ∈
                                             A
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                
                                                   p
                                                   q
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             (
                                             p
                                             ,
                                             q
                                             )
                                             ∈
                                             A
                                             :
                                             
                                             q
                                             ≠
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Constraints (10) ensure that exactly one unit of the commodity is delivered to each vertex 
                           
                              p
                              ∈
                              V
                              ∖
                              
                                 {
                                 0
                                 }
                              
                           
                         while constraints (11) guarantee the flow to be zero along arcs not included in the tour. This formulation includes O(n
                        2) variables and constraints. Padberg and Sung (1991) have shown that its LP relaxation leads to a stronger lower bound than the formulation of Miller et al. (1960).

Another formulation that was proposed by Claus (1984) uses multi-commodity flows in order to prohibit subtours. Here, n different commodities have to be delivered. At the beginning of the tour, one unit of each commodity is available. Each vertex is meant to receive exactly one of these commodities.

For the presentation of this model formulation, the following additional variables are introduced:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                w
                                                
                                                   p
                                                   q
                                                
                                                k
                                             
                                             :
                                             number
                                             
                                             of
                                             
                                             units
                                             
                                             of
                                             
                                             commodity
                                             
                                             k
                                             
                                             passed
                                             
                                             on
                                             
                                             directly
                                             
                                             from
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             vertex
                                             
                                             p
                                             
                                             to
                                             
                                             q
                                             ,
                                             
                                             
                                                (
                                                p
                                                ,
                                                q
                                                )
                                             
                                             ∈
                                             A
                                             ,
                                             k
                                             ∈
                                             V
                                             ∖
                                             
                                                {
                                                0
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The TSP can then be represented as follows:

                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                                ∑
                                                
                                                   (
                                                   p
                                                   ,
                                                   q
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                             
                                                c
                                                
                                                   p
                                                   q
                                                
                                             
                                             ·
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   p
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             q
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   q
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             p
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   q
                                                   ∈
                                                   V
                                                   ∖
                                                   
                                                      {
                                                      0
                                                      }
                                                   
                                                
                                             
                                             
                                                w
                                                
                                                   1
                                                   q
                                                
                                                k
                                             
                                             −
                                             
                                                ∑
                                                
                                                   q
                                                   ∈
                                                   V
                                                   ∖
                                                   
                                                      {
                                                      0
                                                      }
                                                   
                                                
                                             
                                             
                                                w
                                                
                                                   q
                                                   1
                                                
                                                k
                                             
                                             =
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             k
                                             ∈
                                             V
                                             ∖
                                             
                                                {
                                                0
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   q
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                w
                                                
                                                   p
                                                   q
                                                
                                                p
                                             
                                             −
                                             
                                                ∑
                                                
                                                   q
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                w
                                                
                                                   q
                                                   p
                                                
                                                p
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             p
                                             ∈
                                             V
                                             ∖
                                             
                                                {
                                                0
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   q
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                w
                                                
                                                   p
                                                   q
                                                
                                                k
                                             
                                             −
                                             
                                                ∑
                                                
                                                   q
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                w
                                                
                                                   q
                                                   p
                                                
                                                k
                                             
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             p
                                             ,
                                             k
                                             ∈
                                             V
                                             ∖
                                             
                                                {
                                                0
                                                }
                                             
                                             :
                                             
                                             p
                                             ≠
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                                
                                                   p
                                                   q
                                                
                                                k
                                             
                                             ≤
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             
                                                (
                                                p
                                                ,
                                                q
                                                )
                                             
                                             ∈
                                             A
                                             ,
                                             
                                             k
                                             ∈
                                             V
                                             ∖
                                             
                                                {
                                                0
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             (
                                             p
                                             ,
                                             q
                                             )
                                             ∈
                                             A
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                                
                                                   p
                                                   q
                                                
                                                k
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             
                                                (
                                                p
                                                ,
                                                q
                                                )
                                             
                                             ∈
                                             A
                                             ,
                                             
                                             k
                                             ∈
                                             V
                                             ∖
                                             
                                                {
                                                0
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Constraints (17) guarantee that each commodity leaves the depot and is delivered to a vertex. Constraints (18) ensure that each vertex receives exactly one commodity. Constraints (19) ensure that a commodity leaves a vertex that is not its final destination. This model formulation requires O(n
                        3) variables and constraints. The solution of its LP relaxation leads to the strongest lower bound of the three formulations considered here (Padberg & Sung, 1991).

In a block layout, the order picker cannot proceed directly from one location of a requested item to another one if these items are located in different picking aisles. Instead, a cross aisle has to be used for switching over from one picking aisle to the other. This aspect is neglected in general TSP formulations since a complete graph is assumed. It can be taken into account explicitly, though, in Steiner TSP formulations. The following formulation for the Steiner TSP was provided by Letchford et al. (2013) and has been derived from the general multi-commodity flow TSP formulation of Claus (1984).

Since the set of arcs in this formulation differs from the arc set of the general TSP formulation, we use 
                           
                              A
                              ˜
                           
                         to denote the set of arcs of a Steiner TSP. As in Section 2, the set of Steiner points is denoted by P. The formulation for the Steiner TSP then is as follows:

                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                                ∑
                                                
                                                   
                                                      (
                                                      p
                                                      ,
                                                      q
                                                      )
                                                   
                                                   ∈
                                                   
                                                      A
                                                      ˜
                                                   
                                                
                                             
                                             
                                                c
                                                
                                                   p
                                                   q
                                                
                                             
                                             ·
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            q
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               p
                                                               ,
                                                               q
                                                               )
                                                            
                                                            ∈
                                                            
                                                               A
                                                               ˜
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             ≥
                                             1
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             p
                                             ∈
                                             V
                                             ∖
                                             P
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            q
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               p
                                                               ,
                                                               q
                                                               )
                                                            
                                                            ∈
                                                            
                                                               A
                                                               ˜
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            q
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               q
                                                               ,
                                                               p
                                                               )
                                                            
                                                            ∈
                                                            
                                                               A
                                                               ˜
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   q
                                                   p
                                                
                                             
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             p
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            q
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               q
                                                               ,
                                                               1
                                                               )
                                                            
                                                            ∈
                                                            
                                                               A
                                                               ˜
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                w
                                                
                                                   q
                                                   1
                                                
                                                k
                                             
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            q
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               1
                                                               ,
                                                               q
                                                               )
                                                            
                                                            ∈
                                                            
                                                               A
                                                               ˜
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                w
                                                
                                                   1
                                                   q
                                                
                                                k
                                             
                                             =
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             k
                                             ∈
                                             V
                                             ∖
                                             (
                                             P
                                             ∪
                                             
                                                {
                                                0
                                                }
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            q
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               q
                                                               ,
                                                               k
                                                               )
                                                            
                                                            ∈
                                                            
                                                               A
                                                               ˜
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                w
                                                
                                                   q
                                                   k
                                                
                                                k
                                             
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            q
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               k
                                                               ,
                                                               q
                                                               )
                                                            
                                                            ∈
                                                            
                                                               A
                                                               ˜
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                w
                                                
                                                   k
                                                   q
                                                
                                                k
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             k
                                             ∈
                                             V
                                             ∖
                                             (
                                             P
                                             ∪
                                             
                                                {
                                                0
                                                }
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                        
                           
                              (28)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            q
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               p
                                                               ,
                                                               q
                                                               )
                                                            
                                                            ∈
                                                            
                                                               A
                                                               ˜
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                w
                                                
                                                   p
                                                   q
                                                
                                                k
                                             
                                             −
                                             
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            q
                                                            ∈
                                                            V
                                                            :
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               q
                                                               ,
                                                               p
                                                               )
                                                            
                                                            ∈
                                                            
                                                               A
                                                               ˜
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                w
                                                
                                                   q
                                                   p
                                                
                                                k
                                             
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             ∀
                                             
                                             p
                                             ∈
                                             V
                                             ∖
                                             
                                                {
                                                0
                                                }
                                             
                                             ,
                                             
                                             k
                                             ∈
                                             V
                                             ∖
                                             
                                                (
                                                P
                                                ∪
                                                
                                                   {
                                                   0
                                                   ,
                                                   p
                                                   }
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                                
                                                   p
                                                   q
                                                
                                                k
                                             
                                             ≤
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             
                                                (
                                                p
                                                ,
                                                q
                                                )
                                             
                                             ∈
                                             
                                                A
                                                ˜
                                             
                                             ,
                                             
                                             k
                                             ∈
                                             V
                                             ∖
                                             
                                                (
                                                P
                                                ∪
                                                
                                                   {
                                                   0
                                                   }
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   p
                                                   q
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             
                                                (
                                                p
                                                ,
                                                q
                                                )
                                             
                                             ∈
                                             
                                                A
                                                ˜
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                                
                                                   p
                                                   q
                                                
                                                k
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             
                                                (
                                                p
                                                ,
                                                q
                                                )
                                             
                                             ∈
                                             
                                                A
                                                ˜
                                             
                                             ,
                                             
                                             k
                                             ∈
                                             V
                                             ∖
                                             
                                                (
                                                P
                                                ∪
                                                
                                                   {
                                                   0
                                                   }
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                     

Constraints (24) ensure that each vertex not corresponding to a Steiner point is visited at least once, while (25) guarantee that the indegree of each vertex is equal to its outdegree. Constraints (26)–(29) correspond to the multi commodity flow constraints ((17)–(20)) in the formulation of Claus (1984).

In general, the formulation of Letchford et al. (2013) for the Steiner TSP requires O(|P||E|) variables and constraints. When it is being used for representing a SPRP, the location of the depot and the pick locations have to be taken as points which have to be visited (
                           
                              
                                 |
                                 P
                                 |
                              
                              =
                              n
                              +
                              1
                           
                        ) while the points where a picking aisle can be entered or left represent Steiner points. Assuming the picking area following a block layout, 
                           
                              
                                 |
                                 E
                                 |
                              
                              =
                              O
                              
                                 (
                                 n
                                 ·
                                 m
                                 )
                              
                           
                         arcs are needed to represent the SPRP as a Steiner TSP. This results in a model formulation which requires O(n
                        2 · m) variables and constraints, i.e. its size is dependent on both the number of requested items and the number of picking aisles. However, especially for a large number of storage locations to be visited, it requires significantly fewer variables and constraints than the formulation of Claus (1984) on which it is based.

Each of these four formulations can be used to model and solve the SPRP. However, the number of variables and constraints and, therefore, the computing times needed to solve the problems may grow quite large when the number of pick locations is increased. In order to find a model formulation of smaller size, it is necessary to change over from general TSP or Steiner TSP formulations to a more problem-specific formulation for the SPRP.

Tours taken by order pickers in warehouses in which the storage locations are arranged according to a block layout exhibit a specific structure. It results from the fact that cross aisles have to be used for switching over from one picking aisle to another. Also movements within picking aisles are rather restricted. Both properties are not explicitly considered by general TSP formulations.

In this section, we introduce a new graph for the SPRP that takes into account these properties and we show that the respective number of vertices and arcs is not dependent on the number of pick locations. Then, a TSP formulation is applied to this graph in order to provide a model for the problem.

A representation of the SPRP in a single-block layout must not necessarily be based on a complete graph with arcs between each pair of vertices. Ratliff and Rosenthal (1983) have shown that for the generation of an optimal tour only six different paths need to be considered which allow for visiting all pick locations of a picking aisles (see Fig. 3).

                           
                              (1)
                              The order picker enters the picking aisle from the front cross aisle, visits all pick locations sequentially, and exits the aisle at the rear cross aisle.

The order picker enters the picking aisle from the rear cross aisle, visits all pick locations sequentially, and exits the aisle at the front cross aisle.

The order picker enters and exits the picking aisle twice, one time from and back to the front cross aisle and another time from and back to the rear cross aisle. In both cases he returns to the cross aisle from where the picking aisle was entered. The return point is defined by the largest gap between two adjacent pick locations or between a pick location and the adjacent cross aisle.

The order picker enters and leaves the aisle at the front cross aisle. The return point is defined by the pick location which corresponds to the largest distance from the front cross aisle.

Likewise, the order picker enters and leaves the aisle at the rear cross aisle. The return point is defined by the pick location which corresponds to the largest distance from the rear cross aisle.

The picking aisle is not entered at all since no requested item is located in that aisle.

As a consequence, instead of considering all pick locations, it is sufficient that each picking aisle i is only be represented by six points, namely the points which are defined by

                           
                              (a)
                              the intersection between the picking aisle i and the front cross aisle and the intersection between the picking aisle i and the rear cross aisle (vertices [i, f] and [i, b]),

the two pick locations defining the largest gap (vertices [i, 2] and [i, 3]) and

the first and the last storage location where an item has to be picked (vertices [i, 1] and [i, 4]).

If less than four pick locations have to be visited in an aisle, points need to be duplicated in order to obtain the required number. In case that items have to be picked from one location only, that location will be represented by [i, 1], [i, 2], [i, 3] and [i, 4]. In case items have to be picked from two different locations then [i, 1] and [i, 2] ([i, 3] and [i, 4]) are identical. In case of three different pick locations that have to be visited, the pair of locations defining the largest gap has to be determined. If the gap exists between the two pick locations nearest to the front cross aisle, then [i, 1] and [i, 2] are identical; otherwise [i, 3] and [i, 4] are identical.

Based on these considerations, a graph representing the SPRP in a single-block layout can be constructed by introducing the six vertices for each picking aisle and choosing the edges that result from the options according to which pick locations can be visited (see Fig. 3). In order to represent moves of the order picker in the cross aisles, each pair of vertices 
                           
                              (
                              [
                              i
                              ,
                              f
                              ]
                              ,
                              [
                              i
                              +
                              1
                              ,
                              f
                              ]
                              )
                           
                         and 
                           
                              (
                              [
                              i
                              ,
                              b
                              ]
                              ,
                              [
                              i
                              +
                              1
                              ,
                              b
                              ]
                              )
                           
                         (
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              m
                              −
                              1
                              ,
                           
                         where m denotes the number of picking aisles) is connected by two arcs. The depot is positioned in front of the leftmost picking aisle and identical to vertex [1, f] in the graph. An example of a graph related to a (single-) block layout with five picking aisles is depicted in Fig. 4.

The weight ca
                         for an arc a in a picking aisle i can be determined as follows: The arc weight c
                        ([i, 2], [i, 3]) is always equal to the largest gap between two adjacent pick locations in picking aisle i or a pick location and the adjacent cross aisle. Let 
                           
                              j
                              i
                              *
                           
                         be the location represented by vertex [i, 2]. Then, three different cases have to be distinguished for the determination of c
                        ([i, f], [i, 1]) and c
                        ([i, 1], [i, 2]):

                           
                              (1)
                              If 
                                    
                                       j
                                       i
                                       *
                                    
                                  does not correspond to the location of a requested item but to the point where picking aisle i can be entered via the front cross aisle, then 
                                    
                                       
                                          c
                                          
                                             (
                                             [
                                             i
                                             ,
                                             f
                                             ]
                                             ,
                                             [
                                             i
                                             ,
                                             1
                                             ]
                                             )
                                          
                                       
                                       =
                                       
                                          c
                                          
                                             (
                                             [
                                             i
                                             ,
                                             1
                                             ]
                                             ,
                                             [
                                             i
                                             ,
                                             2
                                             ]
                                             )
                                          
                                       
                                       =
                                       0
                                    
                                 .

If 
                                    
                                       j
                                       i
                                       *
                                    
                                  corresponds to the pick location nearest to the front cross aisle, then c
                                 ([i, f], [i, 1]) is equal to the distance between the front cross aisle and 
                                    
                                       
                                          j
                                          i
                                          *
                                       
                                       ,
                                    
                                  and 
                                    
                                       
                                          c
                                          
                                             (
                                             [
                                             i
                                             ,
                                             1
                                             ]
                                             ,
                                             [
                                             i
                                             ,
                                             2
                                             ]
                                             )
                                          
                                       
                                       =
                                       0
                                    
                                  holds.

Otherwise, c
                                 ([i, f], [i, 1]) is determined as in the second case, and c
                                 ([i, 1], [i, 2]) is the distance between the pick location nearest to the front cross aisle and 
                                    
                                       j
                                       i
                                       *
                                    
                                 .

The determination of c
                        ([i, 3], [i, 4]) and c
                        ([i, 4], [i, 5]) is performed analogously. If picking aisle i does not contain any requested item, then c
                        ([i, 2], [i, 3]) is equal to the distance between the front and the rear cross aisle; the remaining arc weights are set to zero.

A feasible solution for the SPRP would be given by a tour which starts and ends at vertex [1, f] and includes the vertices [i, 1], [i, 2], [i, 3] and [i, 4] for each picking aisle i that contains at least one requested item. When applying a model formulation for the TSP to this graph, we therefore need degree constraints for these vertices in order to ensure that they are contained in the tour. However, this approach would result in two problems. First, even in an optimal solution for the SPRP, it is possible that vertices are visited more than once, which is not permitted in standard definitions of the TSP. Second, simply guaranteeing that all vertices in a picking aisle are visited does not necessarily ensure that a feasible solution for the SPRP is provided.

In Fig. 5
                        , an infeasible combination of arcs in a picking aisle is depicted. All vertices in this picking aisle are visited, however, it cannot be guaranteed that all pick locations are included in the tour. This is due to the fact that the number of vertices, by which each picking aisle is defined, is not dependent on the number of requested items. Because of this reason, it is possible that some requested items are situated between the locations that are represented by the vertices. Vertices [i, 2] and [i, 3] represent the two locations defining the largest gap and, therefore, no pick location can be situated between those locations. This is not true for vertices [i, 1] and [i, 2] as well as for [i, 3] and [i, 4]. Since vertices [i, 1] and [i, 4] represent the location nearest and farthest from the front cross aisle, several storage locations containing requested items may be situated between these locations and the locations defining the largest gap. Thus, tours may be generated in which some of the pick locations are skipped.

In order to ensure feasibility of solutions for the SPRP which are obtained from a TSP formulation based on this graph, additional predecessor and successor constraints for arcs are needed. For example, we will have to ensure that arc ([i, 3], [i, 4]) is used if arc ([i, 2], [i, 3]) was chosen.

Another issue refers to the elimination of subtours. The general concept of the subtour elimination constraints in the TSP formulations presented above consists of the enumeration of the vertices according to the sequence in which they appear in the tour. This approach cannot be successful when using this graph, because on the one hand, vertices are allowed to be visited more than once and, on the other hand, some cycles are allowed within the tour (e.g. if a largest gap strategy is used in an aisle).

In order to avoid vertices to be visited more than once, vertices are split up into several vertices in such a way that each generated vertex can only be visited one time. According to Ratliff and Rosenthal (1983) vertices corresponding to cross aisles can be visited up to three times, while the other vertices may be visited at most twice. Therefore, we replace each vertex [i, f] and [i, b] 
                           
                              (
                              i
                              =
                              1
                              ,
                              …
                              ,
                              m
                              )
                           
                         by three vertices, where one vertex has to be used to enter a picking aisle and the other two vertices correspond to movements to the left and to the right in the cross aisles. The vertices [i, 1], [i, 2], [i, 3] and [i, 4] represent movements within a picking aisle i and are replaced by two vertices, where these vertices correspond to movements towards the rear cross aisle (up) and the front cross aisle (down), respectively. Furthermore, a vertex symbolizing the location of the depot is added. An example for the resulting graph is depicted in Fig. 6
                        .

In general, the vertices of this graph can be described as follows. Vertex 0 symbolizes the location of the depot. The other vertices are characterized by a triple, where the first component represents the direction in which the tour can be continued. r and l indicate movements to the right and to the left, respectively. Movements towards the rear cross aisle and towards the front cross aisle are symbolized by u (“up”) and d (“down”). The second component characterizes the number of picking aisle i, where picking aisle 1 is the leftmost and aisle m the rightmost picking aisle. The last component of the triple represents the location of the vertex, where f and b mean that the vertex corresponds to the front and the rear cross aisle, respectively. The four locations in a particular picking aisle are enumerated from 1 to 4. Based on this denotation, the vertices [l, 1, b], [r, m, b] and [r, m, f] do not exist, because at these points either moves to the left or to the right are possible. After having introduced the vertices of the graph, arcs are added based on the feasible options according to which requested items can be picked in a picking aisle (see Fig. 3).

These modifications result in a graph in which an optimal order picking tour can be constructed without visiting a vertex more than once. This graph includes more than twice the number of vertices as the previously presented graph does. However, the size of the improved model formulation for the SPRP will only be dependent on the number of arcs and not on the number of vertices. Furthermore, the size of the graph is completely independent of the number of pick locations. Applying a TSP formulation to this modified graph, in which the number of subtour elimination constraints increases linearly to the number of arcs, will lead to a mathematical model whose size increases linearly to the number of picking aisles.

In this section, a TSP formulation is applied to the graph constructed in Section 4.1. The complete mathematical model for the SPRP is presented in the Appendix. It includes the following classes of constraints:

                           
                              •
                              Degree constraints [(37)–(59)]: Each vertex has to be left after it has been visited.

Subtour elimination constraints [(60)–(90)]: The resulting tour has to be connected.

Depot inclusion constraint [(91)]: The depot has to be included in the tour.

Pick location inclusion constraints [(92)–(93)]: Each pick location has to be included in the tour.

The degree and subtour elimination constraints [(37)–(90)] are very similar to the corresponding constraints [(2)–(4), (8)–(11) and (15)–(20)] used in the general TSP formulations and will only be described briefly here. As decision variables we introduce binary variables for each arc, indicating if the arc is contained in the tour (variable is equal to 1) or not (0). For a picking aisle i, the notation of the variables for the different arc types is depicted in Fig. 7
                        . For the sake of clarity, each arc type is only included for a single direction in this figure. Arcs corresponding to movements in the opposite direction are excluded. (For example, arc ([u, i, 3], [u, i, 4]) is depicted and ([d, i, 1], [d, i, 2]) is excluded.)

The degree constraints in general TSP formulations ensure that each vertex is visited exactly once, which means that the indegree and the outdegree of each vertex are equal to one, respectively. When dealing with a SPRP represented by the modified graph, each vertex is visited at most once. However, some vertices may exist which are not included in an optimal tour. Therefore, it has to be ensured that the indegree and the outdegree are equal to 1 if a vertex is visited and equal to 0 otherwise. This can be done by requiring that, for each vertex, the indegree is equal to the outdegree. In the degree constraints (37)–(59), the outdegree is calculated on the left hand side of the equation while the right hand side represents the indegree.

The mathematical models for the general TSP presented in Section 3 only differ in the way how subtours are excluded. Based on pretests, we decided to apply the subtour elimination constraints by Gavish and Graves (1978) in which the arcs are enumerated according to the sequence in which they are used in the tour. Constraints (10) ensure for each vertex 
                           
                              i
                              ∈
                              V
                              ∖
                              
                                 {
                                 0
                                 }
                              
                           
                         that the sum of variables corresponding to arcs, which can be used to reach vertex i, has to be by one greater than the sum of variables for arcs leaving this vertex. Constraints (11) result in a solution where both sums contain exactly one variable greater than zero, respectively. The general principle of constraints (10) is also used in the model formulation based on the modified graph. The application of these constraints leads to constraints (60)–(80). The structure of the left hand side of these equations is equal to those of constraints (10). However, the right hand side of constraints (60)–(80) cannot be equal to one for each vertex, because this would lead to tours in which all vertices have to be visited although it is allowed to skip some vertices when using the modified graph. Therefore, the right hand side of constraints (60)–(80) has to be equal to zero if the corresponding vertex is not included in the tour; otherwise, it has to be equal to 1. This can be obtained by calculating the degree (here: outdegree) for each vertex. The second part of the subtour elimination constraints [(81)–(90)] is equivalent to (11).

Constraint (91) ensures that the depot is included in the tour.

Since not all vertices must necessarily be visited, we will have to introduce vertex-related criteria which have to be satisfied if it is permitted to skip a vertex. Each vertex representing an intersection between a picking and a cross aisle is allowed to be skipped. Furthermore, in some cases it is also possible to skip vertices corresponding to a pick location. The pick locations of a picking aisle i are represented by four pairs of vertices. In order to guarantee that all requested items are contained in the tour, it is sufficient to visit the vertices nearest to the cross aisles. In this case, the degree constraints ensure that all pick locations will be visited. Let us consider the two vertices nearest to the front cross aisle which are denoted by [u, i, 1] and [d, i, 4]. Both vertices represent the same pick location and, therefore, only one of them has to be included in the tour. If vertex [u, i, 1] is visited, the next vertex to be visited is [u, i, 2], which means that the variable w
                        
                           i1f
                         has to be equal to one. If [d, i, 4] is included in the tour, the vertex [d, i, 3] has to be visited before, which implies 
                           
                              
                                 w
                                 
                                    i
                                    3
                                    b
                                 
                              
                              =
                              1
                           
                        . Since picking aisles which do not contain any requested items can also be skipped, the constraint 
                           
                              
                                 w
                                 
                                    i
                                    1
                                    f
                                 
                              
                              +
                              
                                 w
                                 
                                    i
                                    3
                                    b
                                 
                              
                              ≥
                              1
                           
                         must hold for all picking aisles i containing at least one requested item. This is expressed by the constant bi
                         which is equal to 1 if picking aisle i has to be visited and 0 otherwise. Analogously, the constraints resulting from the pair of vertices nearest to the rear cross aisle can be constructed. This results in the following two constraints for a picking aisle i:

                           
                              (32)
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                                
                                                   i
                                                   1
                                                   f
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   i
                                                   3
                                                   b
                                                
                                             
                                          
                                       
                                       
                                          
                                             ≥
                                             
                                                b
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (33)
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                                
                                                   i
                                                   1
                                                   b
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   i
                                                   3
                                                   f
                                                
                                             
                                          
                                       
                                       
                                          
                                             ≥
                                             
                                                b
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

However, another special case exists in which one of these two pairs of vertices is allowed not to be contained in the tour. This case occurs if the largest gap is not defined by two pick locations but by a pick location and the adjacent cross aisle. If the corresponding cross aisle is the rear cross aisle, then the pair of vertices nearest to the rear cross aisle does not have to be visited. In this case, the vertices [d, i, b], [u, i, 4] and [u, i, 3] represent the same location and, therefore, the distance between [d, i, b] and [u, i, 3], denoted by 
                           
                              
                                 c
                                 
                                    i
                                    3
                                    b
                                 
                                 e
                              
                              ,
                           
                         is equal to zero. This implies that constraint (33) must hold if and only if 
                           
                              
                                 c
                                 
                                    i
                                    3
                                    b
                                 
                                 e
                              
                              >
                              0
                           
                         which can be obtained by multiplying both sides of the constraint by 
                           
                              c
                              
                                 i
                                 3
                                 b
                              
                              e
                           
                         resulting in (93). The same line of argumentation holds if the front cross aisle is considered. In this case, multiplying constraint (32) by 
                           
                              c
                              
                                 i
                                 3
                                 f
                              
                              e
                           
                         leads to (92).

In total, we have O(m) variables and constraints, i.e. the number of variables and constraints increases only linearly to the number of picking aisles m and is not dependent on the number of pick locations.

In order to evaluate the above-presented formulations, we have performed numerical experiments for various classes of problem instances. The formulations will be compared w.r.t. the actual model sizes and the computing times needed by a commercial IP-solver for providing optimal solutions to these instances. For the numerical experiments, the characteristics of the warehouse have been chosen according to the experiments of Henn and Wäscher (2012). Each picking aisle consists of 90 storage locations, 45 on each side. Demands are uniformly distributed, i.e. each pick location has the same probability of being included in a picking order. The length of each storage location amounts to one length unit (LU). Whenever leaving an aisle, the order picker has to move one LU in the vertical direction from either the first or the last storage location in order to reach the cross aisle. The distance between two adjacent picking aisles is equal to 5 LU. The depot is assumed to be located in front of the leftmost picking aisle.

In their experiments, Henn and Wäscher (2012) fixed the number of picking aisles m to 10. Since both the size of the Steiner TSP formulation and the newly-proposed formulation are dependent on the number of picking aisles, we consider different values of m here. Therefore, m has been set to 5, 10, 15, 20, 25 and 30. For the size of the picking order (number of pick locations n), the values 30, 45, 60, 75 and 90 have been chosen. Combination of these parameters gives rise to 30 problem classes. For each class, 30 instances have been generated, resulting in 900 instances in total.

All formulations have been implemented and solved by CPLEX 12.6. The experiments have been carried out on a desktop PC with a 3.4 gigahertz Pentium processor with 8 gigabytes RAM. The computing time for each instance and formulation has been limited to 30 minutes.

@&#RESULTS@&#

Before the model formulations are evaluated with respect to the corresponding computing times and the number of optimal solutions obtained within the time limit, they are compared regarding their sizes in dependency on the number of pick locations n and picking aisles m. For each problem class, the size of each formulation is depicted in Table 1
                        .

Concerning the formulations of Miller et al. (1960) [MTZ], Gavish and Graves (1978) [GG] and Claus (1984) [C], the number of variables (#var) and constraints (#cons) depends on the number of pick locations n, whereas the size of the Steiner TSP formulation provided by Letchford et al. (2013) [LNT] is dependent on both the number of pick locations n and the number of picking aisles m. In comparison to this, the size of the newly-proposed formulation [SHSW] is determined by the number of picking aisles m only. In fact, the size of the new model formulation increases only linearly to the number of picking aisles. Therefore, it can be assumed that the new formulation for the SPRP outperforms the other formulations (w.r.t. the size of the models) if the ratio n/m gets large. This is actually confirmed by the data presented in Table 1. Only for a large number of picking aisles (
                           
                              m
                              =
                              30
                           
                        ) and a small number of pick locations (
                           
                              n
                              =
                              30
                           
                        ) – resulting in a very small ratio n/m – the number of variables and constraints in the SHSW formulation may turn out to be larger than in the MTZ and GG formulations, even though the difference does not appear to be really significant. The C and the LNT formulations are clearly outperformed by the SHSW formulation.

It can be expected that the performance of a formulation is strongly correlated with its size. In this case, a good performance means that by applying the model formulation an optimal solution can be found within a small amount of computing time. For each formulation, Table 2
                         depicts the number of optimal solutions obtained within 30 minutes.

The application of the general TSP formulations MTZ, GG and C leads to rather unsatisfactory results. As expected, the number of optimal solutions obtained within the predefined time limit significantly decreases with an increasing number of pick locations n. Furthermore, it should be noted that the performance of these three formulations is also slightly dependent on the number of picking aisles m. The impact of m is not as strong as it is the case for n, but with an increasing number of picking aisles the number of instances in which an optimal solution can be found within 30 minutes of computing time also decreases. When comparing the results from the three general TSP formulations, it can be seen that the MTZ formulation shows the worst performance. Although requiring the least number of variables and constraints, no problem class exists in which all instances can be solved to optimality. This performance can be explained by the fact that solving its LP relaxation leads to a very weak lower bound. By application of the C formulation all problem instances with a small number of pick locations (
                           
                              n
                              =
                              30
                           
                        ) can be solved to optimality within 30 minutes. However, when increasing n, the performance gets much worse. For instances with 60 or more pick locations only a single problem instance can be solved. Therefore, this formulation can only be used for very small instances which could be expected since this formulation requires the largest number of variables and constraints with a size increasing cubically to the number of pick locations. The GG formulation is the best TSP formulation in our numerical experiments. Using this formulation, we can obtain optimal solutions for all instances with up to 45 pick locations and even for 
                           
                              n
                              =
                              60
                              ,
                           
                         optimal solutions can be found within the given time limit for most instances. However, since the number of variables and constraints increases with an increasing number of pick locations (as it is also the case for the other TSP formulations), only a small fraction of the problem instances can be solved to optimality when n gets quite large (
                           
                              n
                              =
                              90
                           
                        ).

More convincing results are obtained when the LNT and the SHSW formulations are applied. For all instances with up to 10 picking aisles or 60 pick locations, an optimal solution can be found within 30 minutes of computing time. The size of both formulations is dependent on the number of picking aisles and this can also be seen in the results since the number of optimal solutions obtained within the time interval decreases with an increasing number of picking aisles. By using the LNT formulation all instances with up to 10 picking aisles can be solved whereas the SHSW formulation provides optimal solution for all instances with up to 20 picking aisles. An increasing number of pick locations also shows a negative impact on the performance of both formulations. While the number of optimal solutions obtained by applying the SHSW formulation only slightly decreases with an increasing number of pick locations, the performance of the LNT formulation drastically deteriorates. For m ≤ 15, the LNT formulation leads to quite convincing results. When considering a larger number of picking aisles m, it can be seen that the LNT formulation still provides optimal solutions for all instances with up to 60 pick locations. However, for instances with m ≥ 20 only a few optimal solutions can be found by using this formulation when the number of pick locations is very large (
                           
                              n
                              =
                              90
                           
                        ). Especially, when looking at the results from the largest problem class (
                           
                              m
                              =
                              30
                              ,
                              n
                              =
                              90
                           
                        ), we can see the limitation of the Steiner TSP formulation. While the SHSW formulation still provides optimal solutions for 21 out of 30 (70%) of those problem instances, no optimal solution can be found by using the LNT formulation. The superiority of the SHSW formulation for this case can be attributed to the size of the two formulations. Since the number of variables and constraints required by the LNT formulation is not only dependent on the number of picking aisles m but also on the number of pick locations n, an increase of both m and n has a strong impact on the performance of the LNT formulation.

In Table 3
                         the average computing times for the five formulations are presented. Computing times have only been recorded if the instance has been solved to optimality and, therefore, no information about computing times is given for some problem classes when the MTZ, the C or the LNT formulation has been applied.

The results depicted in Table 3 are in accordance to the expectations raised by comparing the sizes of the formulations and the number of optimal solutions obtained within the predefined time interval. Again, the general TSP formulations lead to the worst results. When applying one of these formulations, the computing times grow very fast if the number of pick locations is increased. The strongest increase of computing time can be observed for the C formulation since its size increases cubically to the number of picking aisles (instead of quadratically as it is the case for the MTZ and GG formulation). For the MTZ formulation, the computing times are already quite large for a small number of pick locations (
                           
                              n
                              =
                              30
                           
                        ), while computing times for other problem classes cannot be interpreted since only a few instances can be optimally solved and, therefore, computing times have not been recorded for most instances. As expected, the GG formulation requires the lowest computing times. For the solution of instances with 30 pick locations, on average less than 5 seconds are required and even for instances with 
                           
                              n
                              =
                              45
                              ,
                           
                         the application of the GG formulation results in an optimal solution within approximately one minute or less. However, with a further increase of n, we can observe a very strong increase of the computing times, which leads us to the conclusion that this formulation should not be applied to instances with 60 or more pick locations. Furthermore, not only an increasing number of pick locations n but also an increase in the number of picking aisles m seem to have a negative impact on the computing times required by general TSP formulations, even though the size of these formulations is not dependent on m.

Apart from very small instances with only 30 pick locations, the LNT and SHSW formulations require the smallest amount of computing time. For both formulations, the computing times increase with both an increasing number of pick locations and picking aisles. For the LNT formulation, this could be expected since the size of the mathematical model is also dependent on both numbers and, therefore, it is not surprising that an increasing number of pick locations has a much larger impact on the LNT than on the SHSW formulation. However, the results show that computing times required for the solution of the SHSW formulation also increase with an increasing number of pick locations, even though the number of arcs and vertices of the modified graph is independent of this number. This is due to two reasons: First, constraints (92) and (93) are redundant for a picking aisle i if 
                           
                              
                                 b
                                 i
                              
                              =
                              0
                              ,
                           
                         i.e. if picking aisle i does not contain any pick locations. The less pick locations have to be considered, the smaller the probability gets that a large number of picking aisles has to be visited. Second, a large number of pick locations results in many solutions almost as good as an optimal solution and, therefore, proving optimality gets quite time consuming.

As could be expected with respect to the number of constraints and variables, the application of the SHSW formulation outperforms the other approaches by far when the number of picking aisles is not too large (m ≤ 15). If the number of aisles is small (
                           
                              m
                              =
                              5
                           
                        ), by using the SHSW formulation the computing times can be reduced by a factor between 30 (
                           
                              n
                              =
                              30
                           
                        ) and 1500 (
                           
                              n
                              =
                              90
                           
                        ) compared to the best of the other four formulations. As mentioned before, in term of the size, the advantage of the SHSW formulation over general and Steiner TSP formulations diminishes if the ratio n/m gets small. This observation coincides with the computing times depicted in Table 3. For instances with a larger number of picking aisles (m ≥ 20) and a small number of pick locations (
                           
                              n
                              =
                              30
                           
                        ), the GG formulation requires substantial less computing time than the SHSW formulation. If the number of picking aisles is very large (m ≥ 25) and only up to 60 locations have to be visited, the LNT formulation clearly outperforms the SHSW formulation. However, since the size of the general TSP and the LNT formulations is dependent on the number of pick locations n, the performance of these approaches deteriorates when n gets large, whereas the SHSW formulation provides optimal solutions within a decent amount of computing time even for large instances.

In the previous sections, we focused on warehouses with a single-block layout and developed a graph representing the SPRP in such warehouses and a corresponding mathematical programming formulation. In the following, we will present several modifications which can be used for representing variants of the SPRP which are highly relevant to practice.

Single-block layouts result in long picking aisles if the number of picking aisles is small and the number of storage locations is large. Consequently, the order pickers will have to travel long distances to change over from one picking aisle to another. This becomes particularly inefficient if only a few items have to be removed from each picking aisle. Therefore, picking aisles are usually arranged in several blocks which are separated by additional cross aisles. In Fig. 8
                        , a warehouse with two blocks and one additional (middle) cross aisle is depicted. The middle cross aisle divides each picking aisle into two subaisles.


                        Roodbergen and de Koster (2001a) have extended the algorithm of Ratliff and Rosenthal (1983) for the SPRP in warehouses with two blocks. However, with an increasing number of cross aisles, the SPRP becomes harder to solve since the number of options for changing over from one picking aisle to another increases. Instead of 7 different equivalence classes (in the case for the original algorithm of Ratliff & Rosenthal, 1983) now 25 equivalence classes have to be dealt with in each phase of a dynamic programming procedure. An extension to warehouses with three or more blocks has not been proposed in the literature so far but can be considered even more complex.

The graph and the corresponding mathematical programming formulation presented in this paper can be extended easily to warehouse layouts with an arbitrary number of blocks. For this purpose, a slightly modified copy of the graph has to be added for each additional block. The modification refers to the vertices corresponding to points in the middle cross aisles. In a single-block layout, at each point in a cross aisle, the picker can choose between moving to the left, moving to the right or entering the respective picking aisle. Three different vertices are needed to represent these movement options. In a two-block or a multi-block layout, when positioned in a middle cross aisle, now the order picker has an additional option, namely to choose between entering the picking aisle in the upper block and entering the picking aisles in the lower block. Therefore, each point of a middle cross aisle has to be represented by four vertices.

In the standard SPRP, a central depot is assumed, i.e. the picker starts and terminates the tour at the depot. In practice, items can often be deposited at the end (head) of each picking aisle (de Koster & van der Poort, 1998). In other words, the starting point of a route is known in advance, which can now be the depot or any picking-aisle head. The point where the picker terminates the tour has to be determined. The algorithm of Ratliff and Rosenthal (1983) has been modified by de Koster and van der Poort (1998) for this case of decentralized depositing. However, this modification is only applicable to picking areas following a single-block layout.

Again, by simple modifications to the graph and the mathematical model presented above, this case and also its extension to a multi-block layout can be dealt with in the approach proposed in this paper: The (given) starting point will be represented by vertex 0. Since the tour may terminate at the head of any picking aisle, a vertex D is added for each picking aisle representing a location where items can be deposited. Furthermore, for each picking aisle i, an arc is added, connecting vertex D and vertex [d, i, 4], the latter corresponding to the pick location in this picking aisle closest to the front cross aisle. An example of a graph for decentralized depositing with five picking aisles is depicted in Fig. 9
                        . In the resulting model formulation, we only have to ensure that the outdegree of vertex 0 and the sum of the indegrees of the vertices D and vertex 0 are equal to 1.

Order pickers in practice seem to prefer simple tours through the warehouse which can be memorized easily. More complex tours, e.g. those resulting from the application of exact algorithms, may contain elements which are looked upon as unnatural, resulting in an additional orientation effort, which reduces the travel velocity of the pickers, increases the risk of making a false step and lengthening the tour, and also increases the number of picking errors (Petersen & Schmenner, 1999). In the worst case, the proposed tours may not be accepted at all, and the pickers will compile paths of their own through the warehouse which they may consider good but may in fact be far from optimal.

In order to generate more acceptable, simple tours, one can try to eliminate elements from the tours which may be considered as unnatural. One such element refers to the fact that a picking aisle is entered more than once (Roodbergen & de Koster, 2001b). Prohibiting a picking aisle to be entered more than once is not straightforward in the TSP formulations for the SPRP, but it can easily be integrated in the graph and the corresponding model proposed here. A solution in which each subaisle is entered at most once corresponds to the application of either the return or the traversal strategy, while the largest-gap strategy must be excluded. This can be achieved by deleting the edges e
                        
                           i3f
                         and e
                        
                           i3b
                         from the graph for each subaisle i. Solving the resulting model formulation will result in a simple tour not longer than the tour provided by the combined heuristic of Roodbergen and de Koster (2001b).

The simplicity of a picking tour is also seen related to the number of direction changes the order picker has to perform within the cross aisles. First, tours with frequent changes of the moving direction happen to be quite confusing for the order picker since the picking aisles are not visited in a natural sequence (Petersen & Schmenner, 1999). Second, movements within cross aisles only serve the purpose of changing from one picking aisle to another. No items are collected while moving in a cross aisle. If a tour includes frequent direction changes within the cross aisles, the order picker may conclude that the travel distance can be reduced by deviating from the tour plan, resulting in an even longer tour. Therefore, it can be useful to limit the number of direction changes or even prohibit them.

The proposed model formulation for the SPRP can easily be modified to include this feature. Let the order picker be in an arbitrary cross aisle. For a given pair of adjacent picking aisles 
                           
                              (
                              i
                              ,
                              i
                              +
                              1
                              )
                              ,
                           
                         it is possible to change over from picking aisle i to 
                           
                              i
                              +
                              1
                           
                         (movement to the right) and from aisle 
                           
                              i
                              +
                              1
                           
                         to i (movement to the left). In the mathematical model, these movements can be represented by two variables each. In order to prohibit a direction change in the corresponding cross aisle, the sum of these variables has to be smaller than or equal to 1 for each pair of adjacent picking aisles. For example, in order to prohibit a direction change in the front cross aisle, the following constraints have to be added:

                           
                              (34)
                              
                                 
                                    
                                       
                                          
                                             
                                                l
                                                
                                                   i
                                                   f
                                                
                                                w
                                             
                                             +
                                             
                                                l
                                                
                                                   i
                                                   f
                                                
                                                l
                                             
                                             +
                                             
                                                r
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   f
                                                
                                                w
                                             
                                             +
                                             
                                                r
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   f
                                                
                                                r
                                             
                                             ≤
                                             1
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             i
                                             =
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                             −
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (35)
                              
                                 
                                    
                                       
                                          
                                             
                                                l
                                                
                                                   m
                                                   f
                                                
                                                w
                                             
                                             +
                                             
                                                l
                                                
                                                   m
                                                   f
                                                
                                                l
                                             
                                             +
                                             
                                                r
                                                
                                                   m
                                                   −
                                                   1
                                                   ,
                                                   f
                                                
                                                w
                                             
                                             ≤
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                     

By introducing such constraints for a certain number of cross aisles, it is possible to limit the number of direction changes within cross aisles, resulting in tours which may appear to be more straightforward for the order picker and can be memorized more easily.

In this article, we considered the Single-Picker Routing Problem in a single-block layout which represents a special case of the Traveling Salesman Problem. We proposed the first mathematical programming formulation that adopts the specific properties of this problem. It could be shown that the size of the proposed formulation (expressed in the number of variables and constraints) depends on the number of picking aisles only and not on the number of storage locations to be visited.

By means of numerical experiments, the proposed formulation has been evaluated and compared to more general TSP and Steiner TSP formulations. It could be demonstrated that the proposed formulation is advantageous with respect to the size of the formulation. The proposed formulation also outperforms the general formulations with respect to computing times. Moreover, within a given time limit, we were able to find optimal solutions for instances which could not be solved by means of the general formulations. The numerical results clearly indicate that for specific, efficiently-solvable cases of the Traveling Salesman Problem, the development of customized formulations is necessary in order to obtain optimal solutions within short computing times.

This work focused on the SPRP in single-block layouts, but it has also been shown how several practically relevant situations (multi-block layout, decentral depositing, generation of simple tours) can be integrated into the proposed formulation. Interesting topics of future research could be dealing with other features encountered with order picking systems in practice. This may refer to the determination of picker tours in warehouses with high racks where movements within the picking aisles are much more complex.

Furthermore, for the proposed formulation wide-aisles have been assumed which enable order pickers to pass and overtake each other. As a consequence, their tours through the warehouse can be determined independently from each other. In narrow-aisle warehouses, a picking aisle may be blocked when a picker cannot enter the aisle before it is left by another picker moving in the opposite direction. Even traffic jams may occur when two pickers have to collect items from the same storage location at the same time. Picker tours can no longer be determined independently but will have to be planned simultaneously with the batching of customer orders into picking orders. An optimization model for order batching has been suggested by Hong, Johnson, and Peters (2012) which takes blocking considerations into account. However, this model is restricted to warehouses in which only one-way travel within picking aisles is allowed. Therefore, combining picker blocking aspects with more general routing schemes and their integration into the proposed model formulation could be another promising area of future research.

Sets:

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          I
                                          =
                                          
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             m
                                             }
                                          
                                          :
                                          
                                          set
                                          
                                          of
                                          
                                          picking
                                          
                                          aisles;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          F
                                          =
                                          
                                             {
                                             f
                                             ,
                                             b
                                             }
                                          
                                          :
                                          
                                          set
                                          
                                          of
                                          
                                          cross
                                          
                                          aisles.
                                       
                                    
                                 
                              
                           
                        
                     Constants:

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             b
                                             i
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         picking
                                                         
                                                         aisle
                                                         
                                                         i
                                                         ∈
                                                         I
                                                         
                                                         contains
                                                         
                                                         at
                                                         
                                                         least
                                                         
                                                         one
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         requested
                                                         
                                                         item
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      otherwise;
                                                   
                                                
                                             
                                          
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             c
                                             a
                                          
                                          :
                                          
                                          
                                          distance
                                          
                                          between
                                          
                                          two
                                          
                                          adjacent
                                          
                                          aisles;
                                          
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             c
                                             0
                                          
                                          :
                                          
                                          
                                          distance
                                          
                                          between
                                          
                                          the
                                          
                                          depot
                                          
                                          and
                                          
                                          the
                                          
                                          location
                                          
                                          on
                                          
                                          the
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          front
                                          
                                          cross
                                          
                                          aisle
                                          
                                          where
                                          
                                          the
                                          
                                          first
                                          
                                          picking
                                          
                                          aisle
                                          
                                          can
                                          
                                          be
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          entered
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             c
                                             
                                                i
                                                s
                                                α
                                             
                                             e
                                          
                                          :
                                          distance
                                          
                                          between
                                          
                                          front
                                          
                                          cross
                                          
                                          aisle
                                          
                                          
                                             (
                                             α
                                             =
                                             f
                                             )
                                          
                                          
                                          and
                                          
                                          vertex
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             [
                                             d
                                             ,
                                             i
                                             ,
                                             s
                                             ]
                                          
                                          
                                          
                                             (
                                             s
                                             ∈
                                             
                                                {
                                                1
                                                ,
                                                3
                                                }
                                             
                                             )
                                          
                                          
                                          or
                                          
                                          rear
                                          
                                          cross
                                          
                                          aisle
                                          
                                          
                                             (
                                             α
                                             =
                                             b
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          and
                                          
                                          vertex
                                          
                                          
                                             [
                                             u
                                             ,
                                             i
                                             ,
                                             s
                                             ]
                                          
                                          
                                          in
                                          
                                          picking
                                          
                                          aisle
                                          
                                          i
                                          ∈
                                          I
                                          ;
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     
                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             c
                                             
                                                i
                                                α
                                             
                                             t
                                          
                                          :
                                          distance
                                          
                                          between
                                          
                                          front
                                          
                                          cross
                                          
                                          aisle
                                          
                                          
                                             (
                                             α
                                             =
                                             f
                                             )
                                          
                                          
                                          and
                                          
                                          vertex
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             [
                                             u
                                             ,
                                             i
                                             ,
                                             1
                                             ]
                                          
                                          
                                          or
                                          
                                          back
                                          
                                          cross
                                          
                                          aisle
                                          
                                          
                                             (
                                             α
                                             =
                                             b
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          and
                                          
                                          vertex
                                          
                                          
                                             [
                                             d
                                             ,
                                             i
                                             ,
                                             1
                                             ]
                                          
                                          
                                          in
                                          
                                          picking
                                          
                                          aisle
                                          
                                          i
                                          ∈
                                          I
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             c
                                             
                                                i
                                                s
                                             
                                             w
                                          
                                          :
                                          distance
                                          
                                          between
                                          
                                          location
                                          
                                          s
                                          ∈
                                          
                                             {
                                             1
                                             ,
                                             2
                                             ,
                                             3
                                             }
                                          
                                          
                                          and
                                          
                                          location
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          s
                                          +
                                          1
                                          
                                          in
                                          
                                          picking
                                          
                                          aisle
                                          
                                          i
                                          ∈
                                          I
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          M
                                          :
                                          large
                                          
                                          number
                                          
                                          (e.g.
                                          
                                          number
                                          
                                          of
                                          
                                          vertices)
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Binary variables indicating the edges included in the tour:

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             r
                                             
                                                i
                                                α
                                             
                                             r
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               r
                                                               ,
                                                               i
                                                               ,
                                                               α
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               r
                                                               ,
                                                               i
                                                               +
                                                               1
                                                               ,
                                                               α
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                m
                                                −
                                                1
                                                ,
                                                m
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             r
                                             
                                                i
                                                b
                                             
                                             w
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               r
                                                               ,
                                                               i
                                                               ,
                                                               b
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               d
                                                               ,
                                                               i
                                                               +
                                                               1
                                                               ,
                                                               b
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          i
                                          ∈
                                          I
                                          ∖
                                          
                                             {
                                             m
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             r
                                             
                                                i
                                                f
                                             
                                             w
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               r
                                                               ,
                                                               i
                                                               ,
                                                               f
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               u
                                                               ,
                                                               i
                                                               +
                                                               1
                                                               ,
                                                               f
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          i
                                          ∈
                                          I
                                          ∖
                                          
                                             {
                                             m
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             ℓ
                                             
                                                i
                                                α
                                             
                                             ℓ
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               ℓ
                                                               ,
                                                               i
                                                               ,
                                                               α
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               ℓ
                                                               ,
                                                               i
                                                               −
                                                               1
                                                               ,
                                                               α
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             
                                                (
                                                I
                                                ∖
                                                
                                                   {
                                                   1
                                                   ,
                                                   2
                                                   }
                                                
                                                )
                                             
                                             ×
                                             F
                                             )
                                          
                                          ∪
                                          
                                             {
                                             
                                                (
                                                2
                                                ,
                                                f
                                                )
                                             
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             ℓ
                                             
                                                i
                                                b
                                             
                                             w
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               ℓ
                                                               ,
                                                               i
                                                               ,
                                                               b
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               d
                                                               ,
                                                               i
                                                               −
                                                               1
                                                               ,
                                                               b
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          i
                                          ∈
                                          I
                                          ∖
                                          
                                             {
                                             1
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             ℓ
                                             
                                                i
                                                f
                                             
                                             w
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               ℓ
                                                               ,
                                                               i
                                                               ,
                                                               f
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               u
                                                               ,
                                                               i
                                                               −
                                                               1
                                                               ,
                                                               f
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          i
                                          ∈
                                          I
                                          ∖
                                          
                                             {
                                             1
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             e
                                             
                                                i
                                                s
                                                b
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               d
                                                               ,
                                                               i
                                                               ,
                                                               b
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               u
                                                               ,
                                                               i
                                                               ,
                                                               s
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             (
                                             i
                                             ,
                                             s
                                             )
                                          
                                          ∈
                                          I
                                          ×
                                          
                                             {
                                             1
                                             ,
                                             3
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             e
                                             
                                                i
                                                s
                                                f
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               u
                                                               ,
                                                               i
                                                               ,
                                                               f
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               d
                                                               ,
                                                               i
                                                               ,
                                                               s
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             (
                                             i
                                             ,
                                             s
                                             )
                                          
                                          ∈
                                          I
                                          ×
                                          
                                             {
                                             1
                                             ,
                                             3
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             t
                                             
                                                i
                                                b
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               d
                                                               ,
                                                               i
                                                               ,
                                                               b
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               d
                                                               ,
                                                               i
                                                               ,
                                                               1
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          i
                                          ∈
                                          I
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             t
                                             
                                                i
                                                f
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               u
                                                               ,
                                                               i
                                                               ,
                                                               f
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               u
                                                               ,
                                                               i
                                                               ,
                                                               1
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          i
                                          ∈
                                          I
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             w
                                             
                                                i
                                                s
                                                b
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               d
                                                               ,
                                                               i
                                                               ,
                                                               s
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               d
                                                               ,
                                                               i
                                                               ,
                                                               s
                                                               +
                                                               1
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             (
                                             i
                                             ,
                                             s
                                             )
                                          
                                          ∈
                                          I
                                          ×
                                          
                                             {
                                             1
                                             ,
                                             2
                                             ,
                                             3
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             w
                                             
                                                i
                                                s
                                                f
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               u
                                                               ,
                                                               i
                                                               ,
                                                               s
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               u
                                                               ,
                                                               i
                                                               ,
                                                               s
                                                               +
                                                               1
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             (
                                             i
                                             ,
                                             s
                                             )
                                          
                                          ∈
                                          I
                                          ×
                                          
                                             {
                                             1
                                             ,
                                             2
                                             ,
                                             3
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             v
                                             
                                                i
                                                b
                                             
                                             r
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               u
                                                               ,
                                                               i
                                                               ,
                                                               4
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               r
                                                               ,
                                                               i
                                                               ,
                                                               b
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          i
                                          ∈
                                          I
                                          ∖
                                          
                                             {
                                             m
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             v
                                             
                                                i
                                                f
                                             
                                             r
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               d
                                                               ,
                                                               i
                                                               ,
                                                               4
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               r
                                                               ,
                                                               i
                                                               ,
                                                               f
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          i
                                          ∈
                                          I
                                          ∖
                                          
                                             {
                                             m
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             v
                                             
                                                i
                                                b
                                             
                                             ℓ
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               u
                                                               ,
                                                               i
                                                               ,
                                                               4
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               ℓ
                                                               ,
                                                               i
                                                               ,
                                                               b
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          i
                                          ∈
                                          I
                                          ∖
                                          
                                             {
                                             1
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             v
                                             
                                                i
                                                f
                                             
                                             ℓ
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               d
                                                               ,
                                                               i
                                                               ,
                                                               4
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               ℓ
                                                               ,
                                                               i
                                                               ,
                                                               f
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          i
                                          ∈
                                          I
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             y
                                             α
                                             0
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               0
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               α
                                                               ,
                                                               1
                                                               ,
                                                               f
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          α
                                          ∈
                                          
                                             {
                                             l
                                             ,
                                             r
                                             ,
                                             u
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             y
                                             0
                                             ℓ
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         edge
                                                         
                                                         
                                                            (
                                                            
                                                               [
                                                               ℓ
                                                               ,
                                                               1
                                                               ,
                                                               f
                                                               ]
                                                            
                                                            ,
                                                            
                                                               [
                                                               0
                                                               ]
                                                            
                                                            )
                                                         
                                                         
                                                         is
                                                         
                                                         contained
                                                         
                                                         in
                                                         
                                                         the
                                                         
                                                         tour
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Real-valued variables to exclude subcycles:

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                r
                                                ˜
                                             
                                             
                                                i
                                                α
                                             
                                             r
                                          
                                          ,
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                m
                                                −
                                                1
                                                ,
                                                m
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                r
                                                ˜
                                             
                                             
                                                i
                                                α
                                             
                                             w
                                          
                                          ,
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                m
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                ℓ
                                                ˜
                                             
                                             
                                                i
                                                α
                                             
                                             ℓ
                                          
                                          ,
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             
                                                (
                                                I
                                                ∖
                                                
                                                   {
                                                   1
                                                   ,
                                                   2
                                                   }
                                                
                                                )
                                             
                                             ×
                                             F
                                             )
                                          
                                          ∪
                                          
                                             {
                                             
                                                (
                                                2
                                                ,
                                                f
                                                )
                                             
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                ℓ
                                                ˜
                                             
                                             
                                                i
                                                α
                                             
                                             w
                                          
                                          ,
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                1
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                e
                                                ˜
                                             
                                             
                                                i
                                                s
                                                α
                                             
                                          
                                          ,
                                          
                                             (
                                             i
                                             ,
                                             s
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          I
                                          ×
                                          
                                             {
                                             1
                                             ,
                                             3
                                             }
                                          
                                          ×
                                          F
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                t
                                                ˜
                                             
                                             
                                                i
                                                α
                                             
                                          
                                          ,
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          I
                                          ×
                                          F
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                w
                                                ˜
                                             
                                             
                                                i
                                                s
                                                α
                                             
                                          
                                          ,
                                          
                                             (
                                             i
                                             ,
                                             s
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          I
                                          ×
                                          
                                             {
                                             1
                                             ,
                                             2
                                             ,
                                             3
                                             }
                                          
                                          ×
                                          F
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                v
                                                ˜
                                             
                                             
                                                i
                                                α
                                             
                                             r
                                          
                                          ,
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                m
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                v
                                                ˜
                                             
                                             
                                                i
                                                α
                                             
                                             ℓ
                                          
                                          ,
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             
                                                (
                                                I
                                                ∖
                                                
                                                   {
                                                   1
                                                   }
                                                
                                                )
                                             
                                             ×
                                             F
                                             )
                                          
                                          ∪
                                          
                                             {
                                             
                                                (
                                                1
                                                ,
                                                f
                                                )
                                             
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                y
                                                ˜
                                             
                                             α
                                             0
                                          
                                          ,
                                          α
                                          ∈
                                          
                                             {
                                             l
                                             ,
                                             r
                                             ,
                                             u
                                             }
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Objective function:

                        
                           (36)
                           
                              
                                 
                                    
                                       
                                          min
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                m
                                                −
                                                2
                                             
                                          
                                          
                                             ∑
                                             
                                                α
                                                ∈
                                                F
                                             
                                          
                                          
                                             c
                                             a
                                          
                                          ·
                                          
                                             (
                                             
                                                r
                                                
                                                   i
                                                   α
                                                
                                                r
                                             
                                             +
                                             
                                                r
                                                
                                                   i
                                                   α
                                                
                                                w
                                             
                                             )
                                          
                                          +
                                          
                                             c
                                             a
                                          
                                          ·
                                          
                                             ∑
                                             
                                                α
                                                ∈
                                                F
                                             
                                          
                                          
                                             r
                                             
                                                m
                                                −
                                                1
                                                ,
                                                α
                                             
                                             w
                                          
                                       
                                    
                                 
                                 
                                    
                                       +
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                3
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                α
                                                ∈
                                                F
                                             
                                          
                                          
                                             c
                                             a
                                          
                                          ·
                                          
                                             (
                                             
                                                ℓ
                                                
                                                   i
                                                   α
                                                
                                                ℓ
                                             
                                             +
                                             
                                                ℓ
                                                
                                                   i
                                                   α
                                                
                                                w
                                             
                                             )
                                          
                                          +
                                          
                                             c
                                             a
                                          
                                          ·
                                          
                                             ℓ
                                             
                                                2
                                                f
                                             
                                             ℓ
                                          
                                          +
                                          
                                             c
                                             a
                                          
                                          ·
                                          
                                             ∑
                                             
                                                α
                                                ∈
                                                F
                                             
                                          
                                          
                                             ℓ
                                             
                                                2
                                                α
                                             
                                             w
                                          
                                       
                                    
                                 
                                 
                                    
                                       +
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                
                                                   {
                                                   1
                                                   ,
                                                   3
                                                   }
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                α
                                                ∈
                                                F
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                s
                                                α
                                             
                                             e
                                          
                                          ·
                                          
                                             e
                                             
                                                i
                                                s
                                                α
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                α
                                                ∈
                                                F
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                α
                                             
                                             t
                                          
                                          ·
                                          
                                             t
                                             
                                                i
                                                α
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       +
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                s
                                                =
                                                1
                                             
                                             3
                                          
                                          
                                             ∑
                                             
                                                α
                                                ∈
                                                F
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                s
                                                α
                                             
                                             w
                                          
                                          ·
                                          
                                             w
                                             
                                                i
                                                s
                                                α
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                m
                                                −
                                                1
                                             
                                          
                                          
                                             ∑
                                             
                                                α
                                                ∈
                                                F
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                α
                                             
                                             t
                                          
                                          ·
                                          
                                             v
                                             
                                                i
                                                α
                                             
                                             r
                                          
                                       
                                    
                                 
                                 
                                    
                                       +
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                2
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                α
                                                ∈
                                                F
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                α
                                             
                                             t
                                          
                                          ·
                                          
                                             v
                                             
                                                i
                                                α
                                             
                                             ℓ
                                          
                                          +
                                          
                                             c
                                             
                                                1
                                                f
                                             
                                             t
                                          
                                          ·
                                          
                                             v
                                             
                                                1
                                                f
                                             
                                             ℓ
                                          
                                       
                                    
                                 
                                 
                                    
                                       +
                                    
                                    
                                       
                                          
                                             c
                                             0
                                          
                                          ·
                                          
                                             (
                                             
                                                y
                                                l
                                                0
                                             
                                             +
                                             
                                                y
                                                r
                                                0
                                             
                                             +
                                             
                                                y
                                                u
                                                0
                                             
                                             +
                                             
                                                y
                                                0
                                                l
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Degree constraints:

                        
                           •
                           Constraints corresponding to the depot

                                 
                                    (37)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                      l
                                                      0
                                                   
                                                   +
                                                   
                                                      y
                                                      r
                                                      0
                                                   
                                                   +
                                                   
                                                      y
                                                      u
                                                      0
                                                   
                                                   =
                                                   
                                                      y
                                                      0
                                                      l
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Constraints corresponding to vertices [r, i, α]

                                 
                                    (38)
                                    
                                       
                                          
                                             r
                                             
                                                i
                                                α
                                             
                                             r
                                          
                                          +
                                          
                                             r
                                             
                                                i
                                                α
                                             
                                             w
                                          
                                          =
                                          
                                             v
                                             
                                                i
                                                α
                                             
                                             r
                                          
                                          +
                                          
                                             r
                                             
                                                i
                                                −
                                                1
                                                ,
                                                α
                                             
                                             r
                                          
                                          
                                          ∀
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                1
                                                ,
                                                m
                                                −
                                                1
                                                ,
                                                m
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                       
                                    
                                 
                              
                              
                                 
                                    (39)
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                   
                                                      m
                                                      −
                                                      1
                                                      ,
                                                      α
                                                   
                                                   w
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      v
                                                      
                                                         m
                                                         −
                                                         1
                                                         ,
                                                         α
                                                      
                                                      r
                                                   
                                                   +
                                                   
                                                      r
                                                      
                                                         m
                                                         −
                                                         2
                                                         ,
                                                         α
                                                      
                                                      r
                                                   
                                                   
                                                   ∀
                                                   
                                                   α
                                                   ∈
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (40)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                      
                                                         1
                                                         f
                                                      
                                                      r
                                                   
                                                   +
                                                   
                                                      r
                                                      
                                                         1
                                                         f
                                                      
                                                      w
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      v
                                                      
                                                         1
                                                         f
                                                      
                                                      r
                                                   
                                                   +
                                                   
                                                      y
                                                      r
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (41)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                      
                                                         1
                                                         b
                                                      
                                                      r
                                                   
                                                   +
                                                   
                                                      r
                                                      
                                                         1
                                                         b
                                                      
                                                      w
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      v
                                                      
                                                         1
                                                         b
                                                      
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Constraints corresponding to vertices [ℓ, i, α]

                                 
                                    (42)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ℓ
                                                      
                                                         i
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   +
                                                   
                                                      ℓ
                                                      
                                                         i
                                                         α
                                                      
                                                      w
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      v
                                                      
                                                         i
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   +
                                                   
                                                      ℓ
                                                      
                                                         i
                                                         +
                                                         1
                                                         ,
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   
                                                   ∀
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   
                                                      (
                                                      I
                                                      ∖
                                                      
                                                         {
                                                         1
                                                         ,
                                                         2
                                                         ,
                                                         m
                                                         }
                                                      
                                                      )
                                                   
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (43)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ℓ
                                                      
                                                         m
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   +
                                                   
                                                      ℓ
                                                      
                                                         m
                                                         α
                                                      
                                                      w
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      v
                                                      
                                                         m
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   
                                                   ∀
                                                   
                                                   α
                                                   ∈
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (44)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ℓ
                                                      
                                                         2
                                                         f
                                                      
                                                      ℓ
                                                   
                                                   +
                                                   
                                                      ℓ
                                                      
                                                         2
                                                         f
                                                      
                                                      w
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      v
                                                      
                                                         2
                                                         f
                                                      
                                                      ℓ
                                                   
                                                   +
                                                   
                                                      ℓ
                                                      
                                                         3
                                                         f
                                                      
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (45)
                                    
                                       
                                          
                                             
                                                
                                                   ℓ
                                                   
                                                      2
                                                      b
                                                   
                                                   w
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      v
                                                      
                                                         2
                                                         f
                                                      
                                                      ℓ
                                                   
                                                   +
                                                   
                                                      ℓ
                                                      
                                                         3
                                                         f
                                                      
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (46)
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   0
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      y
                                                      ℓ
                                                      0
                                                   
                                                   +
                                                   
                                                      v
                                                      
                                                         1
                                                         f
                                                      
                                                      ℓ
                                                   
                                                   +
                                                   
                                                      ℓ
                                                      
                                                         2
                                                         f
                                                      
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Constraints corresponding to vertices [u, i, f] and [d, i, b]

                                 
                                    (47)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                      
                                                         i
                                                         α
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         i
                                                         1
                                                         α
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         i
                                                         3
                                                         α
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      r
                                                      
                                                         i
                                                         −
                                                         1
                                                         ,
                                                         α
                                                      
                                                      w
                                                   
                                                   +
                                                   
                                                      ℓ
                                                      
                                                         i
                                                         +
                                                         1
                                                         ,
                                                         α
                                                      
                                                      w
                                                   
                                                   
                                                   ∀
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   
                                                      (
                                                      I
                                                      ∖
                                                      
                                                         {
                                                         2
                                                         ,
                                                         m
                                                         }
                                                      
                                                      )
                                                   
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (48)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                      
                                                         m
                                                         α
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         m
                                                         1
                                                         α
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         m
                                                         3
                                                         α
                                                      
                                                   
                                                   =
                                                   
                                                      r
                                                      
                                                         m
                                                         −
                                                         1
                                                         ,
                                                         α
                                                      
                                                      w
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   ∀
                                                   
                                                   α
                                                   ∈
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (49)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                      
                                                         1
                                                         f
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         11
                                                         f
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         13
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      y
                                                      u
                                                      0
                                                   
                                                   +
                                                   
                                                      ℓ
                                                      
                                                         2
                                                         f
                                                      
                                                      w
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (50)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                      
                                                         1
                                                         b
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         11
                                                         b
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         13
                                                         b
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      ℓ
                                                      
                                                         2
                                                         b
                                                      
                                                      w
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Constraints corresponding to vertices [u, i, 4] and [d, i, 4]

                                 
                                    (51)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                      
                                                         i
                                                         α
                                                      
                                                      r
                                                   
                                                   +
                                                   
                                                      v
                                                      
                                                         i
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   =
                                                   
                                                      w
                                                      
                                                         i
                                                         3
                                                         α
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   
                                                      (
                                                      I
                                                      ∖
                                                      
                                                         {
                                                         2
                                                         ,
                                                         m
                                                         }
                                                      
                                                      )
                                                   
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (52)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                      
                                                         m
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   =
                                                   
                                                      w
                                                      
                                                         m
                                                         3
                                                         α
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   α
                                                   ∈
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              
                                 
                                    (53)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                      
                                                         1
                                                         f
                                                      
                                                      r
                                                   
                                                   +
                                                   
                                                      v
                                                      
                                                         1
                                                         f
                                                      
                                                      ℓ
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      w
                                                      
                                                         13
                                                         f
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (54)
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                   
                                                      1
                                                      b
                                                   
                                                   r
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      w
                                                      
                                                         13
                                                         b
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Constraints corresponding to vertices [u, i, s] and [d, i, s]

                                 
                                    (55)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                      
                                                         i
                                                         1
                                                         f
                                                      
                                                   
                                                   =
                                                   
                                                      t
                                                      
                                                         i
                                                         f
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         i
                                                         1
                                                         b
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (56)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                      
                                                         i
                                                         1
                                                         b
                                                      
                                                   
                                                   =
                                                   
                                                      t
                                                      
                                                         i
                                                         b
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         i
                                                         1
                                                         f
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (57)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                      
                                                         i
                                                         2
                                                         α
                                                      
                                                   
                                                   =
                                                   
                                                      w
                                                      
                                                         i
                                                         1
                                                         α
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   I
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (58)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                      
                                                         i
                                                         3
                                                         f
                                                      
                                                   
                                                   =
                                                   
                                                      w
                                                      
                                                         i
                                                         2
                                                         f
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         i
                                                         3
                                                         b
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (59)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                      
                                                         i
                                                         3
                                                         b
                                                      
                                                   
                                                   =
                                                   
                                                      w
                                                      
                                                         i
                                                         2
                                                         b
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         i
                                                         3
                                                         f
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Subtour elimination constraints:

                        
                           •
                           Constraints corresponding to vertices [r, i, α]

                                 
                                    (60)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                      ˜
                                                   
                                                   
                                                      i
                                                      α
                                                   
                                                   r
                                                
                                             
                                             
                                                
                                                   +
                                                   
                                                      
                                                         r
                                                         ˜
                                                      
                                                      
                                                         i
                                                         −
                                                         1
                                                         ,
                                                         α
                                                      
                                                      r
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            r
                                                            ˜
                                                         
                                                         
                                                            i
                                                            α
                                                         
                                                         r
                                                      
                                                      +
                                                      
                                                         
                                                            r
                                                            ˜
                                                         
                                                         
                                                            i
                                                            α
                                                         
                                                         w
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      r
                                                      
                                                         i
                                                         α
                                                      
                                                      r
                                                   
                                                   +
                                                   
                                                      r
                                                      
                                                         i
                                                         α
                                                      
                                                      w
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   ∀
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   
                                                      (
                                                      I
                                                      ∖
                                                      
                                                         {
                                                         1
                                                         ,
                                                         m
                                                         −
                                                         1
                                                         ,
                                                         m
                                                         }
                                                      
                                                      )
                                                   
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (61)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                         ˜
                                                      
                                                      
                                                         m
                                                         −
                                                         1
                                                         ,
                                                         α
                                                      
                                                      r
                                                   
                                                   +
                                                   
                                                      
                                                         r
                                                         ˜
                                                      
                                                      
                                                         m
                                                         −
                                                         2
                                                         ,
                                                         α
                                                      
                                                      r
                                                   
                                                   −
                                                   
                                                      
                                                         r
                                                         ˜
                                                      
                                                      
                                                         m
                                                         −
                                                         1
                                                         ,
                                                         α
                                                      
                                                      w
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      r
                                                      
                                                         m
                                                         −
                                                         1
                                                         ,
                                                         α
                                                      
                                                      w
                                                   
                                                   
                                                   ∀
                                                   
                                                   α
                                                   ∈
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (62)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                         ˜
                                                      
                                                      
                                                         1
                                                         f
                                                      
                                                      r
                                                   
                                                   +
                                                   
                                                      
                                                         y
                                                         ˜
                                                      
                                                      r
                                                      0
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            r
                                                            ˜
                                                         
                                                         
                                                            1
                                                            f
                                                         
                                                         r
                                                      
                                                      +
                                                      
                                                         
                                                            r
                                                            ˜
                                                         
                                                         
                                                            1
                                                            f
                                                         
                                                         w
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      r
                                                      
                                                         1
                                                         f
                                                      
                                                      r
                                                   
                                                   +
                                                   
                                                      r
                                                      
                                                         1
                                                         f
                                                      
                                                      w
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (63)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                         ˜
                                                      
                                                      
                                                         1
                                                         b
                                                      
                                                      r
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            r
                                                            ˜
                                                         
                                                         
                                                            1
                                                            b
                                                         
                                                         r
                                                      
                                                      +
                                                      
                                                         
                                                            r
                                                            ˜
                                                         
                                                         
                                                            1
                                                            b
                                                         
                                                         w
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      r
                                                      
                                                         1
                                                         b
                                                      
                                                      r
                                                   
                                                   +
                                                   
                                                      r
                                                      
                                                         1
                                                         b
                                                      
                                                      w
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Constraints corresponding to vertices [ℓ, i, α]

                                 
                                    (64)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                      ˜
                                                   
                                                   
                                                      i
                                                      α
                                                   
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   +
                                                   
                                                      
                                                         ℓ
                                                         ˜
                                                      
                                                      
                                                         i
                                                         +
                                                         1
                                                         ,
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            ℓ
                                                            ˜
                                                         
                                                         
                                                            i
                                                            α
                                                         
                                                         ℓ
                                                      
                                                      +
                                                      
                                                         
                                                            ℓ
                                                            ˜
                                                         
                                                         
                                                            i
                                                            α
                                                         
                                                         w
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      ℓ
                                                      
                                                         i
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   +
                                                   
                                                      ℓ
                                                      
                                                         i
                                                         α
                                                      
                                                      w
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   ∀
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   
                                                      (
                                                      I
                                                      ∖
                                                      
                                                         {
                                                         1
                                                         ,
                                                         2
                                                         ,
                                                         m
                                                         }
                                                      
                                                      )
                                                   
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (65)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                         ˜
                                                      
                                                      
                                                         m
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            ℓ
                                                            ˜
                                                         
                                                         
                                                            m
                                                            α
                                                         
                                                         ℓ
                                                      
                                                      +
                                                      
                                                         
                                                            ℓ
                                                            ˜
                                                         
                                                         
                                                            m
                                                            α
                                                         
                                                         w
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      ℓ
                                                      
                                                         m
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   +
                                                   
                                                      ℓ
                                                      
                                                         m
                                                         α
                                                      
                                                      w
                                                   
                                                   
                                                   ∀
                                                   
                                                   α
                                                   ∈
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (66)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                         ˜
                                                      
                                                      
                                                         2
                                                         f
                                                      
                                                      ℓ
                                                   
                                                   +
                                                   
                                                      
                                                         ℓ
                                                         ˜
                                                      
                                                      
                                                         3
                                                         f
                                                      
                                                      ℓ
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            ℓ
                                                            ˜
                                                         
                                                         
                                                            2
                                                            f
                                                         
                                                         ℓ
                                                      
                                                      +
                                                      
                                                         
                                                            ℓ
                                                            ˜
                                                         
                                                         
                                                            2
                                                            f
                                                         
                                                         w
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      ℓ
                                                      
                                                         2
                                                         f
                                                      
                                                      ℓ
                                                   
                                                   +
                                                   
                                                      ℓ
                                                      
                                                         2
                                                         f
                                                      
                                                      w
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (67)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                         ˜
                                                      
                                                      
                                                         2
                                                         f
                                                      
                                                      ℓ
                                                   
                                                   +
                                                   
                                                      
                                                         ℓ
                                                         ˜
                                                      
                                                      
                                                         3
                                                         f
                                                      
                                                      ℓ
                                                   
                                                   −
                                                   
                                                      
                                                         ℓ
                                                         ˜
                                                      
                                                      
                                                         2
                                                         b
                                                      
                                                      w
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      ℓ
                                                      
                                                         2
                                                         b
                                                      
                                                      w
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Constraints corresponding to vertices [u, i, f] and [d, i, b]

                                 
                                    (68)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                      ˜
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                      ,
                                                      α
                                                   
                                                   w
                                                
                                             
                                             
                                                
                                                   +
                                                   
                                                      
                                                         ℓ
                                                         ˜
                                                      
                                                      
                                                         i
                                                         +
                                                         1
                                                         ,
                                                         α
                                                      
                                                      w
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            t
                                                            ˜
                                                         
                                                         
                                                            i
                                                            α
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            e
                                                            ˜
                                                         
                                                         
                                                            i
                                                            1
                                                            α
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            e
                                                            ˜
                                                         
                                                         
                                                            i
                                                            3
                                                            α
                                                         
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      t
                                                      
                                                         i
                                                         α
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         i
                                                         1
                                                         α
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         i
                                                         3
                                                         α
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   ∀
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   
                                                      (
                                                      I
                                                      ∖
                                                      
                                                         {
                                                         2
                                                         ,
                                                         m
                                                         }
                                                      
                                                      )
                                                   
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (69)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                         ˜
                                                      
                                                      
                                                         m
                                                         −
                                                         1
                                                         ,
                                                         α
                                                      
                                                      w
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            t
                                                            ˜
                                                         
                                                         
                                                            m
                                                            α
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            e
                                                            ˜
                                                         
                                                         
                                                            m
                                                            1
                                                            α
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            e
                                                            ˜
                                                         
                                                         
                                                            m
                                                            3
                                                            α
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      t
                                                      
                                                         m
                                                         α
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         m
                                                         1
                                                         α
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         m
                                                         3
                                                         α
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   α
                                                   ∈
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (70)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                         ˜
                                                      
                                                      u
                                                      0
                                                   
                                                   +
                                                   
                                                      
                                                         ℓ
                                                         ˜
                                                      
                                                      
                                                         2
                                                         f
                                                      
                                                      w
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            t
                                                            ˜
                                                         
                                                         
                                                            1
                                                            f
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            e
                                                            ˜
                                                         
                                                         
                                                            11
                                                            f
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            e
                                                            ˜
                                                         
                                                         
                                                            13
                                                            f
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      t
                                                      
                                                         1
                                                         f
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         11
                                                         f
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         13
                                                         f
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (71)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ℓ
                                                         ˜
                                                      
                                                      
                                                         2
                                                         b
                                                      
                                                      w
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            t
                                                            ˜
                                                         
                                                         
                                                            1
                                                            b
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            e
                                                            ˜
                                                         
                                                         
                                                            11
                                                            b
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            e
                                                            ˜
                                                         
                                                         
                                                            13
                                                            b
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      t
                                                      
                                                         1
                                                         b
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         11
                                                         b
                                                      
                                                   
                                                   +
                                                   
                                                      e
                                                      
                                                         13
                                                         b
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Constraints corresponding to vertices [u, i, 4] and [d, i, 4]

                                 
                                    (72)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                         ˜
                                                      
                                                      
                                                         i
                                                         3
                                                         α
                                                      
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            v
                                                            ˜
                                                         
                                                         
                                                            i
                                                            α
                                                         
                                                         r
                                                      
                                                      +
                                                      
                                                         
                                                            v
                                                            ˜
                                                         
                                                         
                                                            i
                                                            α
                                                         
                                                         ℓ
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      v
                                                      
                                                         i
                                                         α
                                                      
                                                      r
                                                   
                                                   +
                                                   
                                                      v
                                                      
                                                         i
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   
                                                   ∀
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   
                                                      (
                                                      I
                                                      ∖
                                                      
                                                         {
                                                         2
                                                         ,
                                                         m
                                                         }
                                                      
                                                      )
                                                   
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (73)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                         ˜
                                                      
                                                      
                                                         m
                                                         3
                                                         α
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         v
                                                         ˜
                                                      
                                                      
                                                         m
                                                         α
                                                      
                                                      ℓ
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      v
                                                      
                                                         m
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   
                                                   ∀
                                                   
                                                   α
                                                   ∈
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (74)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                         ˜
                                                      
                                                      
                                                         13
                                                         f
                                                      
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            v
                                                            ˜
                                                         
                                                         
                                                            1
                                                            f
                                                         
                                                         r
                                                      
                                                      +
                                                      
                                                         
                                                            v
                                                            ˜
                                                         
                                                         
                                                            1
                                                            f
                                                         
                                                         ℓ
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      v
                                                      
                                                         1
                                                         f
                                                      
                                                      r
                                                   
                                                   +
                                                   
                                                      v
                                                      
                                                         1
                                                         f
                                                      
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (75)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                         ˜
                                                      
                                                      
                                                         13
                                                         b
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         v
                                                         ˜
                                                      
                                                      
                                                         1
                                                         b
                                                      
                                                      r
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      v
                                                      
                                                         1
                                                         b
                                                      
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Constraints corresponding to vertices [u, i, s] and [d, i, s]

                                 
                                    (76)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                         ˜
                                                      
                                                      
                                                         i
                                                         f
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         e
                                                         ˜
                                                      
                                                      
                                                         i
                                                         1
                                                         b
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         w
                                                         ˜
                                                      
                                                      
                                                         i
                                                         1
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      w
                                                      
                                                         i
                                                         1
                                                         f
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (77)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                         ˜
                                                      
                                                      
                                                         i
                                                         b
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         e
                                                         ˜
                                                      
                                                      
                                                         i
                                                         1
                                                         f
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         w
                                                         ˜
                                                      
                                                      
                                                         i
                                                         1
                                                         b
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      w
                                                      
                                                         i
                                                         1
                                                         b
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (78)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                         ˜
                                                      
                                                      
                                                         i
                                                         1
                                                         α
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         w
                                                         ˜
                                                      
                                                      
                                                         i
                                                         2
                                                         α
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      w
                                                      
                                                         i
                                                         2
                                                         α
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   I
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              
                                 
                                    (79)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                         ˜
                                                      
                                                      
                                                         i
                                                         2
                                                         f
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         e
                                                         ˜
                                                      
                                                      
                                                         i
                                                         3
                                                         b
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         w
                                                         ˜
                                                      
                                                      
                                                         i
                                                         3
                                                         f
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      w
                                                      
                                                         i
                                                         3
                                                         f
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (80)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                         ˜
                                                      
                                                      
                                                         i
                                                         2
                                                         b
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         e
                                                         ˜
                                                      
                                                      
                                                         i
                                                         3
                                                         f
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         w
                                                         ˜
                                                      
                                                      
                                                         i
                                                         3
                                                         b
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      w
                                                      
                                                         i
                                                         3
                                                         b
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Constraints to link variables

                                 
                                    (81)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                      ˜
                                                   
                                                   
                                                      i
                                                      α
                                                   
                                                   r
                                                
                                             
                                             
                                                
                                                   ≤
                                                   M
                                                   ·
                                                   
                                                      r
                                                      
                                                         i
                                                         α
                                                      
                                                      r
                                                   
                                                   
                                                   ∀
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   
                                                      (
                                                      I
                                                      ∖
                                                      
                                                         {
                                                         m
                                                         −
                                                         1
                                                         ,
                                                         m
                                                         }
                                                      
                                                      )
                                                   
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (82)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                      ˜
                                                   
                                                   
                                                      i
                                                      α
                                                   
                                                   w
                                                
                                             
                                             
                                                
                                                   ≤
                                                   M
                                                   ·
                                                   
                                                      r
                                                      
                                                         i
                                                         α
                                                      
                                                      w
                                                   
                                                   
                                                   ∀
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   
                                                      (
                                                      I
                                                      ∖
                                                      
                                                         {
                                                         m
                                                         }
                                                      
                                                      )
                                                   
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (83)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ℓ
                                                      ˜
                                                   
                                                   
                                                      i
                                                      α
                                                   
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   ≤
                                                   M
                                                   ·
                                                   
                                                      ℓ
                                                      
                                                         i
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   
                                                   
                                                   ∀
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   
                                                      (
                                                      
                                                         (
                                                         I
                                                         ∖
                                                         
                                                            {
                                                            1
                                                            ,
                                                            2
                                                            }
                                                         
                                                         )
                                                      
                                                      ×
                                                      F
                                                      )
                                                   
                                                   ∪
                                                   
                                                      {
                                                      
                                                         (
                                                         2
                                                         ,
                                                         f
                                                         )
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (84)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ℓ
                                                      ˜
                                                   
                                                   
                                                      i
                                                      α
                                                   
                                                   w
                                                
                                             
                                             
                                                
                                                   ≤
                                                   M
                                                   ·
                                                   
                                                      ℓ
                                                      
                                                         i
                                                         α
                                                      
                                                      w
                                                   
                                                   
                                                   ∀
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   
                                                      (
                                                      I
                                                      ∖
                                                      
                                                         {
                                                         1
                                                         }
                                                      
                                                      )
                                                   
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (85)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                      ˜
                                                   
                                                   
                                                      i
                                                      s
                                                      α
                                                   
                                                
                                             
                                             
                                                
                                                   ≤
                                                   M
                                                   ·
                                                   
                                                      e
                                                      
                                                         i
                                                         s
                                                         α
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      s
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   I
                                                   ×
                                                   
                                                      {
                                                      1
                                                      ,
                                                      3
                                                      }
                                                   
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (86)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                      ˜
                                                   
                                                   
                                                      i
                                                      α
                                                   
                                                
                                             
                                             
                                                
                                                   ≤
                                                   M
                                                   ·
                                                   
                                                      t
                                                      
                                                         i
                                                         α
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   I
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (87)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                      ˜
                                                   
                                                   
                                                      i
                                                      s
                                                      α
                                                   
                                                
                                             
                                             
                                                
                                                   ≤
                                                   M
                                                   ·
                                                   
                                                      w
                                                      
                                                         i
                                                         s
                                                         α
                                                      
                                                   
                                                   
                                                   ∀
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      s
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   I
                                                   ×
                                                   
                                                      {
                                                      1
                                                      ,
                                                      2
                                                      ,
                                                      3
                                                      }
                                                   
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (88)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                      ˜
                                                   
                                                   
                                                      i
                                                      α
                                                   
                                                   r
                                                
                                             
                                             
                                                
                                                   ≤
                                                   M
                                                   ·
                                                   
                                                      v
                                                      
                                                         i
                                                         α
                                                      
                                                      r
                                                   
                                                   
                                                   ∀
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   
                                                      (
                                                      I
                                                      ∖
                                                      
                                                         {
                                                         m
                                                         }
                                                      
                                                      )
                                                   
                                                   ×
                                                   F
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (89)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                      ˜
                                                   
                                                   
                                                      i
                                                      α
                                                   
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   ≤
                                                   M
                                                   ·
                                                   
                                                      v
                                                      
                                                         i
                                                         α
                                                      
                                                      ℓ
                                                   
                                                   
                                                   ∀
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      α
                                                      )
                                                   
                                                   ∈
                                                   
                                                      (
                                                      
                                                         (
                                                         I
                                                         ∖
                                                         
                                                            {
                                                            1
                                                            }
                                                         
                                                         )
                                                      
                                                      ×
                                                      F
                                                      )
                                                   
                                                   ∪
                                                   
                                                      {
                                                      
                                                         (
                                                         1
                                                         ,
                                                         f
                                                         )
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (90)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                      ˜
                                                   
                                                   α
                                                   0
                                                
                                             
                                             
                                                
                                                   ≤
                                                   M
                                                   ·
                                                   
                                                      y
                                                      α
                                                      0
                                                   
                                                   
                                                   ∀
                                                   
                                                   α
                                                   ∈
                                                   
                                                      {
                                                      l
                                                      ,
                                                      r
                                                      ,
                                                      u
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Depot inclusion constraint:

                        
                           (91)
                           
                              
                                 
                                    
                                       
                                          
                                             y
                                             l
                                             0
                                          
                                          +
                                          
                                             y
                                             r
                                             0
                                          
                                          +
                                          
                                             y
                                             u
                                             0
                                          
                                       
                                    
                                    
                                       
                                          ≥
                                          1
                                       
                                    
                                 
                              
                           
                        
                     
                  

Item inclusion constraints:

                        
                           (92)
                           
                              
                                 
                                    
                                       
                                          
                                             c
                                             
                                                i
                                                3
                                                f
                                             
                                             e
                                          
                                          ·
                                          
                                             (
                                             
                                                w
                                                
                                                   i
                                                   1
                                                   f
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   i
                                                   3
                                                   b
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ≥
                                          
                                             b
                                             i
                                          
                                          ·
                                          
                                             c
                                             
                                                i
                                                3
                                                f
                                             
                                             e
                                          
                                          
                                          ∀
                                          
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (93)
                           
                              
                                 
                                    
                                       
                                          
                                             c
                                             
                                                i
                                                3
                                                b
                                             
                                             e
                                          
                                          ·
                                          
                                             (
                                             
                                                w
                                                
                                                   i
                                                   1
                                                   b
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   i
                                                   3
                                                   f
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ≥
                                          
                                             b
                                             i
                                          
                                          ·
                                          
                                             c
                                             
                                                i
                                                3
                                                b
                                             
                                             e
                                          
                                          
                                          ∀
                                          
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                              
                           
                        
                     
                  

Constraints for the domains of the variables:

                        
                           (94)
                           
                              
                                 
                                    
                                       
                                          r
                                          
                                             i
                                             α
                                          
                                          r
                                       
                                    
                                    
                                       
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                m
                                                −
                                                1
                                                ,
                                                m
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (95)
                           
                              
                                 
                                    
                                       
                                          r
                                          
                                             i
                                             α
                                          
                                          w
                                       
                                    
                                    
                                       
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                m
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (96)
                           
                              
                                 
                                    
                                       
                                          ℓ
                                          
                                             i
                                             α
                                          
                                          ℓ
                                       
                                    
                                    
                                       
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             
                                                (
                                                I
                                                ∖
                                                
                                                   {
                                                   1
                                                   ,
                                                   2
                                                   }
                                                
                                                )
                                             
                                             ×
                                             F
                                             )
                                          
                                          ∪
                                          
                                             {
                                             
                                                (
                                                2
                                                ,
                                                f
                                                )
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (97)
                           
                              
                                 
                                    
                                       
                                          ℓ
                                          
                                             i
                                             α
                                          
                                          w
                                       
                                    
                                    
                                       
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                1
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (98)
                           
                              
                                 
                                    
                                       
                                          e
                                          
                                             i
                                             s
                                             α
                                          
                                       
                                    
                                    
                                       
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             s
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          I
                                          ×
                                          
                                             {
                                             1
                                             ,
                                             3
                                             }
                                          
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (99)
                           
                              
                                 
                                    
                                       
                                          t
                                          
                                             i
                                             α
                                          
                                       
                                    
                                    
                                       
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          I
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (100)
                           
                              
                                 
                                    
                                       
                                          w
                                          
                                             i
                                             s
                                             α
                                          
                                       
                                    
                                    
                                       
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             s
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          I
                                          ×
                                          
                                             {
                                             1
                                             ,
                                             2
                                             ,
                                             3
                                             }
                                          
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (101)
                           
                              
                                 
                                    
                                       
                                          v
                                          
                                             i
                                             α
                                          
                                          r
                                       
                                    
                                    
                                       
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                m
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (102)
                           
                              
                                 
                                    
                                       
                                          v
                                          
                                             i
                                             α
                                          
                                          ℓ
                                       
                                    
                                    
                                       
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             
                                                (
                                                I
                                                ∖
                                                
                                                   {
                                                   1
                                                   }
                                                
                                                )
                                             
                                             ×
                                             F
                                             )
                                          
                                          ∪
                                          
                                             {
                                             
                                                (
                                                1
                                                ,
                                                f
                                                )
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (103)
                           
                              
                                 
                                    
                                       
                                          y
                                          α
                                          0
                                       
                                    
                                    
                                       
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          
                                          α
                                          ∈
                                          
                                             {
                                             l
                                             ,
                                             r
                                             ,
                                             u
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (104)
                           
                              
                                 
                                    
                                       
                                          y
                                          0
                                          ℓ
                                       
                                    
                                    
                                       
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (105)
                           
                              
                                 
                                    
                                       
                                          
                                             r
                                             ˜
                                          
                                          
                                             i
                                             α
                                          
                                          r
                                       
                                    
                                    
                                       
                                          ≥
                                          0
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                m
                                                −
                                                1
                                                ,
                                                m
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (106)
                           
                              
                                 
                                    
                                       
                                          
                                             r
                                             ˜
                                          
                                          
                                             i
                                             α
                                          
                                          w
                                       
                                    
                                    
                                       
                                          ≥
                                          0
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                m
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (107)
                           
                              
                                 
                                    
                                       
                                          
                                             ℓ
                                             ˜
                                          
                                          
                                             i
                                             α
                                          
                                          ℓ
                                       
                                    
                                    
                                       
                                          ≥
                                          0
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             
                                                (
                                                I
                                                ∖
                                                
                                                   {
                                                   1
                                                   ,
                                                   2
                                                   }
                                                
                                                )
                                             
                                             ×
                                             F
                                             )
                                          
                                          ∪
                                          
                                             {
                                             
                                                (
                                                2
                                                ,
                                                f
                                                )
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (108)
                           
                              
                                 
                                    
                                       
                                          
                                             ℓ
                                             ˜
                                          
                                          
                                             i
                                             α
                                          
                                          w
                                       
                                    
                                    
                                       
                                          ≥
                                          0
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                1
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (109)
                           
                              
                                 
                                    
                                       
                                          
                                             e
                                             ˜
                                          
                                          
                                             i
                                             s
                                             α
                                          
                                       
                                    
                                    
                                       
                                          ≥
                                          0
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             s
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          I
                                          ×
                                          
                                             {
                                             1
                                             ,
                                             3
                                             }
                                          
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (110)
                           
                              
                                 
                                    
                                       
                                          
                                             t
                                             ˜
                                          
                                          
                                             i
                                             α
                                          
                                       
                                    
                                    
                                       
                                          ≥
                                          0
                                          
                                          ∀
                                          
                                          (
                                          i
                                          ,
                                          α
                                          )
                                          ∈
                                          I
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (111)
                           
                              
                                 
                                    
                                       
                                          
                                             w
                                             ˜
                                          
                                          
                                             i
                                             s
                                             α
                                          
                                       
                                    
                                    
                                       
                                          ≥
                                          0
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             s
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          I
                                          ×
                                          
                                             {
                                             1
                                             ,
                                             2
                                             ,
                                             3
                                             }
                                          
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (112)
                           
                              
                                 
                                    
                                       
                                          
                                             v
                                             ˜
                                          
                                          
                                             i
                                             α
                                          
                                          r
                                       
                                    
                                    
                                       
                                          ≥
                                          0
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             I
                                             ∖
                                             
                                                {
                                                m
                                                }
                                             
                                             )
                                          
                                          ×
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (113)
                           
                              
                                 
                                    
                                       
                                          
                                             v
                                             ˜
                                          
                                          
                                             i
                                             α
                                          
                                          ℓ
                                       
                                    
                                    
                                       
                                          ≥
                                          0
                                          
                                          ∀
                                          
                                          
                                             (
                                             i
                                             ,
                                             α
                                             )
                                          
                                          ∈
                                          
                                             (
                                             
                                                (
                                                I
                                                ∖
                                                
                                                   {
                                                   1
                                                   }
                                                
                                                )
                                             
                                             ×
                                             F
                                             )
                                          
                                          ∪
                                          
                                             {
                                             
                                                (
                                                1
                                                ,
                                                f
                                                )
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (114)
                           
                              
                                 
                                    
                                       
                                          
                                             y
                                             ˜
                                          
                                          α
                                          0
                                       
                                    
                                    
                                       
                                          ≥
                                          0
                                          
                                          ∀
                                          
                                          α
                                          ∈
                                          
                                             {
                                             l
                                             ,
                                             r
                                             ,
                                             u
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

