@&#MAIN-TITLE@&#Computer-aided detection of cerebral microbleeds in susceptibility-weighted imaging

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A computer-aided technique for detecting cerebral microbleeds on SWI is proposed.


                        
                        
                           
                           All regions with microbleeds are identified by a multi-scale Laplacian of Gaussian.


                        
                        
                           
                           A cascade of random forest classifiers is designed to handle class imbalance problem.


                        
                        
                           
                           Proposed approach has higher performance compared to state of the art approaches.


                        
                        
                           
                           It may assist manual screening by minimizing assessment time and rater variability.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Cerebral microbleed

Susceptibility-weighted imaging

Radon transform

Multi-scale Laplacian of Gaussian

Random forests

@&#ABSTRACT@&#


               
               
                  Susceptibility-weighted imaging (SWI) is recognized as the preferred MRI technique for visualizing cerebral vasculature and related pathologies such as cerebral microbleeds (CMBs). Manual identification of CMBs is time-consuming, has limited reliability and reproducibility, and is prone to misinterpretation. In this paper, a novel computer-aided microbleed detection technique based on machine learning is presented: First, spherical-like objects (potential CMB candidates) with their corresponding bounding boxes were detected using a novel multi-scale Laplacian of Gaussian technique. A set of robust 3-dimensional Radon- and Hessian-based shape descriptors within each bounding box were then extracted to train a cascade of binary random forests (RF). The cascade consists of consecutive independent RF classifiers with low to high posterior probability constraints to handle imbalanced training sets (CMBs and non-CMBs), and to progressively improve detection rates. The proposed method was validated on 66 subjects whose CMBs were manually stratified into “possible” and “definite” by two medical experts. The proposed technique achieved a sensitivity of 87% and an average false detection rate of 27.1 CMBs per subject on the “possible and definite” set. A sensitivity of 93% and false detection rate of 10 CMBs per subject was also achieved on the “definite” set. The proposed automated approach outperforms state of the art methods, and promises to enhance manual expert screening. Benefits include improved reliability, minimization of intra-rater variability and a reduction in assessment time.
               
            

@&#INTRODUCTION@&#

Cerebral microbleeds (CMBs) represent small foci hemosiderin deposition in normal brain tissue, corresponding to prior microscopic hemorrhages [1]. CMBs are relatively small in size (few millimeters), appear spherical and hypointense on magnetic resonance images (MRI), and are becoming recognized as important imaging findings in cognitive impairment and dementia [2], stroke and intracerebral haemorrhages [3] and cerebral amyloid angiopathy [4].

Manual localization and counting is the gold standard technique to assess the incidence of CMBs. This is a challenging task, as it is extremely time-consuming, subjective, and has high inter-expert variability [5]. Moreover, visual screening is prone to errors as small CMBs can be easily missed, or mistaken for vessel cross-sections, especially in MR susceptibility-weighted imaging (SWI). SWI is a 3D flow-compensated T2* gradient echo which maximizes the sensitivity of susceptibility effects by combining filtered phase information with magnitude information [6]. SWI has several advantages over T2* gradient-recall echo for detecting CMBs, such as 2 to 6-folds increased sensitivity in CMB detection [7,8], and enhanced the resolution of smaller lesions (i.e. less than 1mm in diameter) [7]. Furthermore, to improve inter-rater agreement, established rating scales have separated CMBs into two categories: definite and possible
                     
                     [9]. Definite CMBs, which are defined spherical with enough hypointensity, have been widely considered in clinical studies and assessments [10], since they increase detection confidence [9]. For instance, it has been suggested to exclude individuals with 2 or more definite CMBs (using SWI) from amyloid-modifying therapeutic trials due to the potential of adverse drug events [10].

To aid manual CMB assessments and eventually supplant them with automatic approaches, advanced computer vision and image analysis approaches have been investigated [11–14,5]. These studies implemented a two-step method consisting of an automated pre-screening to identify all CMB-like regions, followed by a high-level detection model to refine falsely detected regions. However, these methods suffered from a high false detection rate and low sensitivity as summarized in Table 1
                     . The pre-screening is designed to achieve a high sensitivity at the cost of specificity due to the diverse appearance of both CMBs and surrounding structures seen on MRI. In the second step, machine learning techniques have not been well explored compared to the rule-based or statistical approaches. However, such a technique may face an imbalanced classification problem since the low-level pre-screening identifies large number of non-CMB regions (majority class) compared to true CMBs (minority class). In such cases, conventional classifiers tend to perform poorly [15], though, it has been demonstrated that random sampling with bagging or boosting strategies have the highest performance in large and imbalanced datasets [16].

This paper presents a novel computer-aided technique for detecting cerebral microbleeds in SWI, particularly aimed at achieving a high sensitivity with a low false detection rate. The proposed technique is comprised of three main steps. First, a low-level automated pre-screening scheme based on a multi-scale Laplacian of Gaussian (LoG) is performed to detect potential CMBs (candidates), with the ultimate goal of achieving a high sensitivity leaving almost no true CMBs behind, but at the cost of increased candidates. Second, a 3D bounding box proportional to the size of the central hypointensity is defined for each candidate, and subsequently robust Radon and Hessian shape feature descriptors which are invariant to scale, rotation, translation and intensity shift are computed. To tackle the class imbalance problem for classification, the third step employs a cascade of consecutive binary random forest (RF) classifiers to progressively reduce the training sample size (false detections) throughout the cascade and reach a high detection accuracy. The overview of the proposed method is shown in Fig. 1
                     .

The novelties of the proposed approach are in the following areas: (i) identifying spherical shapes and their extent through a novel multi-scale Laplacian of Gaussian (LoG) technique, and (ii) addressing the class imbalance issue by incorporating a series of binary RF classifiers with low to high posterior probability constraints. Unlike [17,18], the proposed multi-scale LoG approach is adapted for MR images especially with anisotropic resolutions which cause some CMBs to appear relatively semi-spherical or ovoid in shape. Furthermore, the modified Laplacian operator response is capable of detecting of CMBs adjacent to vessels and sulcus folding. The multi-layer classifier approach in contrast to [19,20] not only handles class imbalance problem in an efficient way using several RF classifiers, but it also provides a flexible framework to obtain a desirable sensitivity/specificity by extending the number of layers, and updating a single parameter (posterior probability) at each layer.

Data used in the preparation of this paper were obtained from the Australian Imaging, Biomarkers and Lifestyle (AIBL) study [21]. The 66 participants included 11 subjects classified as Alzheimer's Disease (AD), 14 as mild cognitive impairment (MCI) and 41 healthy controls (HC). The subjects included 27 females (age 77.9±7.7, mean±std) and 39 males (age 71.9±6.6).

All subjects underwent an anatomical T1-weighted (T1w) and a SWI acquisitions on a 3T Siemens TRIO scanner, where SWIs were automatically reconstructed online using the scanner system (software VB17). The 3D SWIs were acquired with 0.93mm×0.93mm in-plane resolution and 1.75mm slice thickness, repetition time/echo time of 27/20ms, and flip angle 20°. T1w images were acquired using a standard 3D magnetization-prepared rapid gradient echo sequence with in-plane resolution 1.0mm×1.0mm, slice thickness 1.2mm, repetition-time/echo-time/T1=2.300/2.98/900, flip angle 9°, field of view 240×256, and 160 slices.

SWIs were manually inspected for CMBs by two clinical experts using the MARS rating method [9], labeling CMBs as definite and possible. CMBs are considered as spherical hypointense lesions smaller than or equal to 10mm [22]. Suspected lesions are usually tracked through multiple slices to exclude them from blood vessels. After independent reading by the 2 readers, a consensus was reached for presence and number of lesions on each scan. The agreement between readers 1 and 2 was 83% (κ
                        =0.65); reader 1 vs. consensus 91% (κ
                        =0.8); and reader 2 vs. consensus 91% (κ
                        =0.83).

The low frequency intensity non-uniformity present in the SWI was corrected using the N4 bias field correction technique [23]. For each subject, the T1w image was also classified into gray/white matter and CSF using an implementation of the expectation maximization segmentation algorithm [24]. The resulting gray/white matter and CSF segmentations were combined to generate a skull-stripping mask. The T1w was then rigidly aligned to the SWI, and the resulting transformation was applied to propagate the skull-stripped mask in order to exclude non-brain tissues from the analysis. From here on SWI refers to the skull-stripped bias field corrected SWI.

SWIs suffer from signal saturation near the air-tissue interface, such as sinus regions. To enhance the contrast, and also normalize the intensity across subjects, the dynamic intensity range of SWIs was normalized to [0,1] after trimming the top 1% of intensity values. The image intensity was then inverted so that CMBs and vessels appear hyperintense which simplifies the multi-scale Gaussian analysis. In addition, to locally enhance the contrast and reduce noise, adaptive histogram equalization (window size of 1.5 voxel, α
                        =1.5 and β
                        =0.75) and gradient based anisotropic diffusion (20 iterations with step size of 0.04) were also applied on the SWIs.

A low-level automatic scheme is proposed to identify potential spherical-like CMBs (candidates) and their extents with the objective of achieving a high detection sensitivity leaving no true CMB behind. The scheme considers: (1) CMBs that appear semi-spherical due to anisotropic spatial resolutions and strong partial volume effects (PVE) of SWIs, and (2) CMBs touching/adjacent to other structures.

In the current work, a similar approach as in [25] was used, where we proposed a new multi-scale spherical-like object detection for 3D brain images with a high sensitivity to small objects and a low number of false-positives (FPs). For methodological detail of the multi-scale sphere detection method refer to Supplementary Material.

In the current work, a similar approach as in [25] was used, where we proposed a new multi-scale spherical-like object detection for 3D brain images with a high sensitivity to small objects and a low number of false-positives (FPs). For methodological detail of the multi-scale sphere detection method refer to Supplementary Material.

The pre-screening step extracts the centroid of potential CMBs. Subsequently, various descriptive shape features invariant to scale, rotation, translation and intensity are computed by defining a precise 3D bounding box per candidate.

Prior to feature extraction, a 3D bounding box (or ROI) has to be defined per candidate proportional to its size. This is particularly crucial for shape features as they achieve a high response once the object of interest is placed at the center of the ROI with sufficient background margin.

An initial patch size of 24×24×20 voxels was defined around each centroid (R
                           
                              fix
                           ) and then was up-sampled by a factor of 2 in every direction through linear interpolation (R
                           
                              up
                           ). The multi-scale sphere detection that was proposed for pre-screening was performed again on the R
                           
                              up
                            to estimate the size of the central structure. The estimated size corresponds to the variance of the maximum response 
                              
                                 
                                    
                                       σ
                                       opt
                                    
                                 
                                 →
                              
                            (Supplementary Material Sec. 1.1).

An initial patch size of 24×24×20 voxels was defined around each centroid (R
                           
                              fix
                           ) and then was up-sampled by a factor of 2 in every direction through linear interpolation (R
                           
                              up
                           ). The multi-scale sphere detection that was proposed for pre-screening was performed again on the R
                           
                              up
                            to estimate the size of the central structure. The estimated size corresponds to the variance of the maximum response 
                              
                                 
                                    
                                       σ
                                       opt
                                    
                                 
                                 →
                              
                            (Supplementary Material Sec. 1.1).

The Radon transform is capable of representing shape characteristics through an object's directional property. The 3D Radon transform, based on a parallel plane-integral approach, can effectively transform an image volume by accumulating voxel intensities on several planes where each is oriented along a given set of angles.

The Radon transform can be written mathematically as mapping an image f(x,y,z) to a function R(ρ, θ, ϕ). Let 
                              
                                 n
                                 →
                              
                           
                           =(sinθcosϕ, sinθsinϕ, cosϕ), 
                              
                                 p
                                 →
                              
                           
                           =(x, y, z)
                              t
                            a point on a 3D volume with its center as origin, and 
                              
                                 p
                                 →
                              
                              ·
                              
                                 n
                                 →
                              
                            the equation of a plane for a given angle α
                           =(θ,ϕ). As such, the 3D Radon transform of an image volume f is defined as:
                              
                                 (1)
                                 
                                    R
                                    (
                                    ρ
                                    ,
                                    α
                                    )
                                    =
                                    
                                       ∑
                                       
                                          −
                                          x
                                       
                                       
                                          +
                                          x
                                       
                                    
                                    
                                       ∑
                                       
                                          −
                                          y
                                       
                                       
                                          +
                                          y
                                       
                                    
                                    
                                       ∑
                                       
                                          −
                                          z
                                       
                                       
                                          +
                                          z
                                       
                                    
                                    
                                       f
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                       δ
                                       (
                                       
                                          
                                             p
                                             →
                                          
                                          ·
                                          
                                             n
                                             →
                                          
                                       
                                       −
                                       ρ
                                       )
                                    
                                 
                              
                           where δ is the Dirac function and ρ is the distance between the volume center and perpendicular projection planes along the α (Fig. 2
                           c). This projection is able to highlight properties of geometrical shapes by two parameters (ρ,α), where α
                           =(θ,ϕ) is the polar projection angle. The 3D Radon implementation maps every image coordinate (x, y, z) to the physical space by defining the center of the image as origin and including the image spacing. Retaining the generality of the Radon projection outputs, the results are organized in 2-dimensional fashion with axes of ρ and α. Fig. 2a and b shows the 3D Radon transform of a simulated vessel and CMB.

In [26,27], a set of Radon-based features was proposed to detect Gaussian-like structures in a sliding window in the presence of noise or other structures. These features are the mean and standard deviation profiles computed across the Radon angle-dimension:
                              
                                 (2)
                                 
                                    
                                       F
                                       mean
                                    
                                    (
                                    
                                       x
                                       ′
                                    
                                    )
                                    =
                                    
                                       1
                                       
                                          q
                                          +
                                          r
                                       
                                    
                                    
                                       ∑
                                       
                                          α
                                          =
                                          1
                                       
                                       
                                          q
                                          +
                                          r
                                       
                                    
                                    R
                                    (
                                    
                                       x
                                       ′
                                    
                                    ,
                                    α
                                    )
                                    ,
                                    
                                    1
                                    ⩽
                                    
                                       
                                          x
                                          ′
                                       
                                    
                                    ⩽
                                    
                                       |
                                       ρ
                                       |
                                    
                                 
                              
                           
                           
                              
                                 (3)
                                 
                                    
                                       F
                                       std
                                    
                                    (
                                    
                                       x
                                       ′
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             1
                                             
                                                q
                                                +
                                                r
                                                −
                                                1
                                             
                                          
                                          
                                             ∑
                                             
                                                α
                                                =
                                                1
                                             
                                             
                                                q
                                                +
                                                r
                                             
                                          
                                          
                                             
                                                [
                                                R
                                                (
                                                
                                                   x
                                                   ′
                                                
                                                ,
                                                α
                                                )
                                                −
                                                
                                                   F
                                                   mean
                                                
                                                (
                                                
                                                   x
                                                   ′
                                                
                                                )
                                                ]
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           where |ρ| is the number of projection distances and considering image dimension is 
                              
                                 
                                    
                                       x
                                       dim
                                       2
                                    
                                    +
                                    
                                       y
                                       dim
                                       2
                                    
                                    +
                                    
                                       z
                                       dim
                                       2
                                    
                                 
                              
                           , and q and r are the number of projection angles of θ and ϕ, respectively, with (θ, ϕ)∈[0:15:165]. In the current work, standard deviation along the Radon angle-dimension and the global mean are also computed:
                              
                                 (4)
                                 
                                    
                                       f
                                       mean
                                    
                                    =
                                    
                                       1
                                       
                                          q
                                          +
                                          r
                                          +
                                          |
                                          ρ
                                          |
                                       
                                    
                                    
                                       ∑
                                       
                                          α
                                          =
                                          1
                                       
                                       
                                          q
                                          +
                                          r
                                       
                                    
                                    
                                       ∑
                                       
                                          ρ
                                          =
                                          1
                                       
                                       
                                          |
                                          ρ
                                          |
                                       
                                    
                                    R
                                    (
                                    ρ
                                    ,
                                    α
                                    )
                                 
                              
                           
                           
                              
                                 (5)
                                 
                                    
                                       f
                                       std
                                    
                                    =
                                    
                                       
                                          
                                             1
                                             
                                                q
                                                +
                                                r
                                                −
                                                1
                                             
                                          
                                          
                                             ∑
                                             
                                                α
                                                =
                                                1
                                             
                                             
                                                q
                                                +
                                                r
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                         
                                                            |
                                                            ρ
                                                            |
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            ρ
                                                            =
                                                            1
                                                         
                                                         
                                                            |
                                                            ρ
                                                            |
                                                         
                                                      
                                                      R
                                                      (
                                                      ρ
                                                      ,
                                                      α
                                                      )
                                                      −
                                                      
                                                         f
                                                         mean
                                                      
                                                   
                                                
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           The proposed Radon descriptors are invariant to rotation by nature, and scale invariance is obtained by resizing the descriptor profiles of F
                           
                              mean
                            and F
                           
                              std
                            to a fixed length. Translation invariance is enforced when the candidate microbleeds are placed at the center of the ROI prior to the Radon transform.

The Hessian matrix H is a 3×3 matrix which encompasses the second order derivatives. H encodes local high-level shape information and the eigenvalues provide quantitative measures of the shape. To extract scale invariant features from H, the γ-normalized Hessian matrix 
                              
                                 
                                    H
                                    ¯
                                 
                                 γ
                              
                            of the center of the ROI is considered:
                              
                                 (6)
                                 
                                    
                                       
                                          H
                                          ¯
                                       
                                       γ
                                    
                                    =
                                    
                                       
                                          
                                             σ
                                             opt
                                          
                                       
                                       γ
                                    
                                    ·
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                         xx
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                         xy
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                         xz
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                         xy
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                         yy
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                         yz
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                         xz
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                         yz
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                         zz
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where I
                           
                              xx
                           , I
                           
                              yy
                           , I
                           
                              zz
                           , I
                           
                              xy
                           , I
                           
                              xz
                           , and I
                           
                              yz
                            are the second order derivatives of image intensity convolved with Gaussian kernel of size σ
                           
                              opt
                            (Section 2.4.1). Here, γ is set to 2.5 for the 3D LoG.

The eigenvalues of the 
                              
                                 
                                    H
                                    ¯
                                 
                                 γ
                              
                            were used individually as features, and three dissimilarity measures were also calculated considering |λ
                           1|≤|λ
                           2|≤|λ
                           3|: sphericalness (f
                           
                              Sphere
                           ), largest cross-section (f
                           
                              LC
                           ) and fractional anisotropy (f
                           
                              FA
                           ). These features are rotation, scale and shift invariant. Sphericalness, which is volume to largest cross-section area, attains a maximum of 1 for a perfect sphere-like structure and a minimum of 0 for other types of structures:
                              
                                 (7)
                                 
                                    
                                       f
                                       Sphere
                                    
                                    =
                                    
                                       
                                          |
                                          
                                             λ
                                             1
                                          
                                          |
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   λ
                                                   2
                                                
                                                
                                                   λ
                                                   3
                                                
                                                |
                                             
                                          
                                       
                                    
                                 
                              
                           The second feature accounts for the aspect ratio of the two largest eigenvalues. This ratio helps to further distinguish between CMBs and vessels where it attains a maximum of 1 for CMBs:
                              
                                 (8)
                                 
                                    
                                       f
                                       LC
                                    
                                    =
                                    
                                       
                                          |
                                          
                                             λ
                                             2
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             λ
                                             3
                                          
                                          |
                                       
                                    
                                 
                              
                           And finally FA is a measure of how non-spherical an object is and for CMBs the value is relatively low:
                              
                                 (9)
                                 
                                    
                                       f
                                       FA
                                    
                                    =
                                    
                                       
                                          
                                             1
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         λ
                                                         1
                                                      
                                                      −
                                                      
                                                         λ
                                                         2
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                
                                                   
                                                      (
                                                      
                                                         λ
                                                         2
                                                      
                                                      −
                                                      
                                                         λ
                                                         3
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                
                                                   
                                                      (
                                                      
                                                         λ
                                                         1
                                                      
                                                      −
                                                      
                                                         λ
                                                         3
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                   1
                                                   2
                                                
                                                +
                                                
                                                   λ
                                                   2
                                                   2
                                                
                                                +
                                                
                                                   λ
                                                   3
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Because of partial voluming and voxel anisotropy of SWI, CMBs can appear elongated along the z direction. Therefore, a structure orientation property (f
                           
                              O
                           ), defined as the angle between the eigenvector associated with the largest eigenvalue and the xy-plane normal, was also computed as a descriptor to differentiate these elongated structures from vessels.

The ability of the proposed Radon- and Hessian-based features for CMB detection was tested using a binary multi-layer classifier. A binary classification scheme was considered by dividing the pre-screened candidates into non-CMB (negative) and CMB (positive) classes based on the available manual ratings. As a consequence of the pre-screening step which is characterized by a low specificity (Section 2.3), the negative class sample size is several times larger than the positive one (imbalanced training set), containing many irrelevant candidates without distinct geometric information. To overcome the machine learning bias toward the majority class, a binary random forest classifier (RF), which combines bagging and random sub-sampling techniques, was used [28]. However, the high presence of non-informative candidates in any random subset will adversely influence the RF performance. Therefore, we proposed a cascade of sequential RF classifiers that progressively rules out obvious candidates by imposing low to high posterior probability thresholds throughout the cascade (Fig. 3
                        ). In short, FP lesions are removed through each layer.

In the first layer, the classifier RF
                        1 was trained using all the pre-screened candidates (TS
                        1), and evaluated with a low probability threshold TH
                        1. Any negative outcome leads to an immediate rejection while positively detected samples will compose a new training set TS
                        2. This set will be subsequently split into CMB and non-CMB classes knowing the true CMBs provided by the manual ratings. As such, a similar procedure was repeated to build RF
                        2 with TH
                        2
                        ⩾
                        TH
                        1 for evaluation. More layers can be added until either the detection sensitivity or false-positive rate (FPR) become constant compared to the previous layer:
                           
                              (10)
                              
                                 Sensitivity
                                 =
                                 
                                    TP
                                    
                                       TP
                                       +
                                       FN
                                    
                                 
                                 ,
                                 
                                 FPR
                                 =
                                 
                                    FP
                                    
                                       FP
                                       +
                                       TN
                                    
                                 
                              
                           
                        
                     

Consequently, the final layer is trained on a relatively balanced dataset leading to a high sensitivity and specificity (low FPs).

Definite microbleeds have been found to have increased inter-rater agreement as they have a more distinct appearance compared to possible ones [29,9]. Therefore, for the current validation, two subsets comprised of Definite (D) and Possible and Definite (PD) CMBs were considered. It is acceptable to have a greater number of pre-screened candidates and a lower detection sensitivity when PD CMBs are examined due to the fact that possible ones are less hypointense and are not strictly spherical. As such, two different set of parameter values were considered based on D and PD datasets for the automatic pre-screening and supervised detection steps.
                           Definite set
                           
                              In the pre-screening, the thresholds on minimum CMB intensity I(c) and its sphericalness S(c) were both empirically set to 0.55. The multi-scale LoG smoothing kernels were assigned to [0.8:5.0] with step size of 0.1, assuming a maximum definite CMB diameter size of 10mm. For the multi-layer classification, a three-layer cascade with low to high posterior probability thresholds of Th
                                 1
                                 =0.1, Th
                                 2
                                 =0.3, and Th
                                 3
                                 =0.4 was considered. For this experiment, all the possible CMBs were excluded from the pre-screened candidate.

The thresholds I(c) and S(c) were both empirically set at 0.35 and 0.5 to ensure CMBs with low contrast and elongated shape were captured. In the manual pre-screening, CMBs as small as one voxel were also considered possible. Therefore, the smoothing kernels were assigned to [0.4:5.0] with step size of 0.1. For the classification, a three-layer cascade with probability thresholds of Th
                                 1
                                 =0.05, Th
                                 2
                                 =0.2, and Th
                                 3
                                 =0.4 was considered.

@&#RESULTS@&#

Using the established MARS rating scale [9] a total of 234 CMBs were identified by two clinical experts inspecting 66 subjects. Among them, 3 CMBs were excluded due to their irregular shapes (as shown in Fig. 4
                     ), 123 CMBs were labeled as “possible” with prevalence of 1.86 per subject, and 108 as “definite” with prevalence of 2.57 per subject.

The overall detection performance of the proposed method along with its pre-screening and classification results evaluated on both D and PD sets are listed in Table 2
                     . The initial detection achieved a high sensitivity of 97% leaving just a few true CMBs behind. This stage, however, was less specific to true CMBs, and produced 669 and 1373 average candidates per subject of D and PD sets, respectively, leading to an imbalance class ratio ([average FP]/[average TP]) of 1 positive to 260 negative samples for D set, and a ratio of 1:406 for PD set. The full process evaluated on D set had a sensitivity of 92.6%, average FP of 10.28 CMBs per subject, and produced 4.3 FPs per true definite CMB (average FP/[average TP]). A corresponding evaluation on the PD set showed an overall sensitivity of 87%, average FP rate of 27.1 CMBs, and producing 8.9 FPs per true CMB. Despite the high specificity, it is not a suitable validation measure due to the high true-negative (TN) samples which correspond to the majority of the image volume (in pre-screening) and imbalanced CMB set (in classification).

The performance associated with each layer of the cascaded-classifier shows that each layer progressively obtained a lower FP rate for a given sensitivity as shown in Fig. 5
                     , where sensitivity is expressed as a function of average FPs per subject.

The anatomical occurrences of FPs (yellow), TPs (blue) and FNs (red) CMBs detected by the proposed method on the definite set is illustrated in Fig. 6
                     (a), and an example output with few TP and FP CMBs is shown in Fig. 6(b).

The average incidence of definite CMBs across AD, MCI and HC subjects shows that the detection rate of the proposed method is proportional to the number of manually identified CMBs. These results are shown in Table 3
                     .

The efficiency and study characteristics of our technique compared to the previously published methods are summarized in Table 1, which indicate that the current method achieved a higher sensitivity and a lower false detection rate on a relatively larger cohort size.

@&#DISCUSSION@&#

This paper presents a new computer-aided technique for CMB detection on SWI with the overall objective of achieving a high detection rate without increasing FPs to facilitate and speed up manual screening. The high sensitivity is also vital for clinical pre-screenings, where the aim is not to identify all CMBs, but to find enough of them to assess disease developments [30], to diagnose (CAA with ⩾2 CMBs) [31], and to utilize as exclusion criteria (anti-amyloid therapies) [30].

In the present work, a pre-screening based on a Laplacian of Gaussian operator along with a multi-scale analysis shows a promising performance to mark potential CMB candidates and true CMBs. This low-level approach is not only computationally efficient, but it also reduces the overall computation time by limiting the high-level analysis to the selected candidates rather than all image voxels. The proposed pre-screening identified 97% of all CMBs in the PD set, and 98.5% of CMBs in the D set with just two parameters to control the lesion sphericalness and contrast. Such a high sensitivity was achieved by combining three multi-scale 1D line detection for detecting spherical lesions. In addition, the response normalization term has the advantage of detecting small CMBs adjacent to other structures, and allows a precise estimation of candidates extent which is essential for feature extraction.

On average, the pre-screening took less than 3min, which can be further reduced by increasing the step size of the 1D Gaussian kernels (i.e. from 0.1 to 0.3).

Upon visual inspection of the pre-screening results, the undetected definite CMBs (3 out of 108 of D set) have a low contrast with varying intensity and all belong to the same subject (Fig. 7
                     (a)–(c)). The missing true CMBs of the PD set include two low contrast definite CMBs, few possible CMBs with a size of one voxel with low contrast, and the rest are directly connected to neighboring structures from top or bottom.

On the other hand, the high sensitivity of the pre-screening is associated with a large number of FP CMBs, which leads to a class imbalance ratio of almost four-hundreds. The majority of pre-screened FPs associated with the discontinuous foldings of the sulcus and gyrus across the brain, and sharp local intensity changes in the sinus. Unlike other studies [19,32], a well-established RF classifier was chosen as an independent weak classifier to handle imbalanced datasets. This is mainly because the RF algorithm incorporates iterative learning [20], and bagging or boosting ensembles of classifiers [16] which have been shown to be effective in skewed classification problems. The proposed classification cascade focuses on gradual elimination of non-CMB like candidates to refine the training set, so that each classifier becomes progressively more accurate and has a lower FP rate. For instance, the first layer of D set which was assigned a threshold of 0.1 was able to remove more than 65% of candidates while missing only one true CMBs.

The computation time for training a three-layer cascade on 66 subjects was 3h and the validation time was 2min per subject on a single core machine with 8GB of memory. This computation speed could be reduced by employing 10-fold leave-one-out cross validation.

Upon visual inspection of the classification outputs, a majority of the false-negative CMBs are connected to neighboring vessels, and two cases have irregular oval shapes as shown in Fig. 7(d)–(h). The resulting FPs, appeared with a fairly uniform distribution throughout the brain except for the cerebellum and sinus regions (Fig. 6(a)). This can be explained by horizontal sulcus foldings of the cerebellum which appear as continuous profile on SWIs. Air channels and sinuses also cause susceptibility artifacts that could lead to higher false detection rate.

A similar trend in terms of prevalence between the manual (true) and automated (FPs) CMBs is found within AD, MCI and HC groups, where a higher true CMB count is associated with a higher automated detection (3 vs. 16.7 in AD, 2.6 vs. 13.6 in HC and 2.2 vs. 9.9 in MCI). This correlation shows the reliability of the proposed technique and that there is no performance bias in the presence of pathology. Further assessments are necessary to determine whether these detected lesions are true CMBs which were missed in the manual inspection.

The current method, achieved a higher sensitivity, a lower false detection rate and was validated on a larger number of subjects than other published methods (Table 1). Unlike [12] which excluded small CMBs<5mm, here CMBs as small as one voxel (0.93mm) were included and classified as possible. This was achieved by imposing a parameter to control the minimum contrast in the pre-screening and extracting scale-invariant features.

The large cohort size used in this study offers CMBs with diversity in shape, size, anatomical location and, demonstrating the robustness of the algorithm. The current FP to TP rate on D set (10.28 on average) is much lower than PD (27.1 on average). This is important, as most clinical studies have focused on definite CMBs [10], as they have been shown to improve inter-rater reproducibility [9,29]. Moreover, this low FP rate provides an acceptable trade-off for the high sensitivity (92.6%) of the proposed method for studies in which exclusion (anti-amyloid therapies) or diagnosis (diagnose CAA with ⩾2 CMBs) based on CMB incidence are of interest. From a practical standpoint, the proposed method is designed as an aid to manual labeling of CMBs, and visual inspection to remove approximately 11 FP CMBs would lead to a more efficient screening (reliable and reproducible) of SWI images, and reduce manual review time compared to the inspection of the entire image.

The current research has some limitations. The first is the lack of human expert assessment of the automatically identified CMBs. This assessment is necessary to determine whether the falsely detected lesions are true CMBs which have been missed in the manual inspection. These extra true CMBs then could be added to the training set in order to improve the reliability of the automated detection. Second, the detection is based on a machine learning model trained on ground truth CMBs provided by local experts. The high inter-rater variability due to experience and training may cause a certain level of uncertainty in the final output. Third, the current method has been validated on a SWI sequence with specific TR, TE and software version. Therefore, a different SWI sequence or MRI modality such as T2* GRE would require a re-training of the algorithm.

In conclusion, this paper has presented a novel computer-aided approach to detect cerebral microbleeds in elderly subjects and patients with dementia using SWI. The proposed approach outperforms related published methods with a higher sensitivity and a lower false detection rate. It can assist manual screening by improving reliability, minimizing intra-rater variability and reducing assessment time. Future work will examine the stability of the method on longitudinal data as well as its robustness on other MRI sequences.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.compmedimag.2015.10.001.

The following are the supplementary data to this article:


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

