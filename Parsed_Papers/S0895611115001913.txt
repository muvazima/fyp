@&#MAIN-TITLE@&#A coronary artery segmentation method based on multiscale analysis and region growing

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A multiscale region growing method for coronary artery segmentation is proposed.


                        
                        
                           
                           The growing rule incorporates both vesselness and local orientation information.


                        
                        
                           
                           Two datasets with different levels of difficulty and two ground truths are used.


                        
                        
                           
                           The evaluation shows good results and robustness to different difficulties.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Coronary artery

Hessian

Segmentation

Region growing

Multiscale

Vesselness

Direction

@&#ABSTRACT@&#


               
               
                  Accurate coronary artery segmentation is a fundamental step in various medical imaging applications such as stenosis detection, 3D reconstruction and cardiac dynamics assessing. In this paper, a multiscale region growing (MSRG) method for coronary artery segmentation in 2D X-ray angiograms is proposed. First, a region growing rule incorporating both vesselness and direction information in a unique way is introduced. Then an iterative multiscale search based on this criterion is performed. Selected points in each step are considered as seeds for the following step. By combining vesselness and direction information in the growing rule, this method is able to avoid blockage caused by low vesselness values in vascular regions, which in turn, yields continuous vessel tree. Performing the process in a multiscale fashion helps to extract thin and peripheral vessels often missed by other segmentation methods. Quantitative evaluation performed on real angiography images shows that the proposed segmentation method identifies about 80% of the total coronary artery tree in relatively easy images and 70% in challenging cases with a mean precision of 82% and outperforms others segmentation methods in terms of sensitivity. The MSRG segmentation method was also implemented with different enhancement filters and it has been shown that the Frangi filter gives better results. The proposed segmentation method has proven to be tailored for coronary artery segmentation. It keeps an acceptable performance when dealing with challenging situations such as noise, stenosis and poor contrast.
               
            

@&#INTRODUCTION@&#

X-ray coronary angiography (XCA) is the gold standard for the assessment of clinically significant coronary artery diseases (CAD) [1]. The angiograms obtained by the XCA enable to reveal the initial CAD symptoms by the morphological features of the coronary arteries such as diameter, length, branching angle, and tortuosity. However, complex vessel structure, image noise, poor contrast and non-uniform illumination make vessel tracking a tedious task. Accurate coronary vessel detection is a fundamental step in various medical imaging applications such as stenosis detection [2], 3D reconstruction [3] and cardiac dynamics assessing [4]. Vessel detection is generally related to two important tasks which are vascular features enhancement and blood vessel segmentation.

The enhancement step aims to improve the vessels delineation while reducing background artifacts. So far, a variety of vessel enhancement methods have been proposed [5–13]. Truc et al. [14] distinguish three method classes: linear filtering [15], non-linear anisotropic filtering [16,17] and Hessian-based multiscale filtering [5–10].

Linear enhancement methods generally use Gaussian kernels or Gabor filters in order to denoise images. They are inappropriate to complex vascular structures since they blur vessel borders as well as thin vessels.

Unlike the linear smoothing filters, non-linear anisotropic diffusion filtering adjusts the filter for local variations by acting mainly along the preferred structure direction [16]. Hence, important features are better preserved during the smoothing process. Those filters are widely applied in many image processing tasks such as fingerprint image filtering [18], optical coherence tomography image denoising [19] and cell membrane enhancement [20]. The main drawback of diffusion based methods is that they usually act at a fixed scale and are therefore unable to detect vessels within a wide range of size.

Most of the research on vessel enhancement falls into Hessian-based methods. These methods utilize the second order derivatives matrix (Hessian matrix) of the image intensity in order to detect tubular-like structures. For that, the Hessian matrix at each pixel is computed by convolving the initial image with second-order Gaussian derivatives. Then, the Hessian eigenvalues and/or eigenvectors are often used to propose a vesselness measure which can be interpreted as the probability of belonging to a blood vessel of a pixel. The vesselness generates maximum response at the scale which matches the diameter of the vessel to be detected. The main advantage of methods in this category is that they can perform in a multiscale fashion, thus detecting different sized objects.

In [21], the authors compared four different Hessian-based multiscale filters, namely those proposed by Koller [5], Sato [6], Frangi [7] and the vessel enhancing diffusion (VED) filter [17]. VED is a diffusion filter built upon the Frangi filter. It can be seen as a generalization of anisotropic diffusion to iteratively smooth the image, while preserving the vessel structure [17]. This filter was initially proposed by [22] and extended by Manniesing et al. [17] who added a smoothness constraint and an enhanced diffusion scheme. Results of this study showed that the two latter outperform the others with a better background suppression performance and vascular structure enhancement.

The second important step in vascular analysis is vessel segmentation. Existing segmentation methods can be divided into two general categories [23]: skeleton based, and non-skeleton based. The principle of skeleton-based techniques is the segmentation of vessels by first detecting the centerlines, then estimating the vessel width. A typical problem with this class is that it can fail to approximate the vessel segments which present stenosis and bifurcations. Non-skeleton-based segmentation techniques, on the other hand, are those that extract the vessels directly. Methods in this category vary from thresholding [24–26,3], fuzzy clustering [27], mathematical morphology [28,29,13], deformable models such as active contour and level set [30–33], graph cuts [34–36] to region growing [37–43]. A more general review on vessel segmentation can be found in [44,45].

Region-growing has been widely used for image segmentation [46], and in particular medical image applications such as vessel extraction. The rationale for this popularity is that these methods are based on a connectivity assumption, which is naturally suited to the case of the vascular trees [47,48]. Methods in this class incrementally segment an object by recruiting neighboring pixel starting from seed points or regions located inside a vessel based on some inclusion rule. Defining a robust region growing rule for X-ray vessel segmentation may encounter several difficulties such as image artifacts, lesions, noise and very low contrast between the vessels and the background particularly in thin vessels location. Therefore, classical region growing methods based on grey level values and/or spatial proximity are often sensitive to noise, and inhomogeneous contrast, which often leads to false negative (hole), false positive (leakage) and unwanted stop of region-growing [45].

In coronary artery angiograms, several factors such as image artifacts, stenosis and noise may introduce discontinuities, hence region growing may result in holes and over-segmentation. To avoid such problems, the growing process was performed in many frames of the same sequence in [37]. Although discontinuities may be avoided by temporal tracking, other difficulties such as centerline matching and user interaction in each step are necessary in this approach. Instead of using the intensity feature in the growing process, authors in [49] incorporate the Frangi vesselness filter [7] in order to introduce more seed points when the growing process stops. In [41], the authors proposed a novel vesselness function and performed vessels segmentation in two steps. First, large vessels are extracted from the maximum vesselness response by region growing. However, this final vesselness response given by the maximum response among the scale space may present low values for thin vessels, junctions and stenosis location. Thus, discontinuities may occur if the growing process is applied directly on this final vesselness image. That is why a detail repairing process is launched in order to extract thin vessels using a direction information given by the first directional derivatives i.e. image intensity gradient.

Combining the vesselness function with a directional information for vessel tracking is certainly a good idea but the image gradient is not, in our opinion, the appropriate direction information descriptor. A more precise direction descriptor would be given by the Hessian matrix eigenvectors. This idea was investigated in [50] where the authors combined the Sato vesselness function [6] with the line direction information given by the first Hessian eigenvector to guide the segmentation of 3D blood vessels. As discussed in [21], the Sato filter is more sensitive to noise than the Frangi filter when applied to 2D X-ray angiograms. Fig. 1
                      shows that background noise is better removed by the Frangi filter than the Sato one.

In this paper, a multiscale vessel segmentation method for X-ray coronary angiography images is presented. This method takes advantages from multiscale Hessian analysis strength and aims to overcome the two major problems encountered in region growing techniques which are the difficulty of detection of poorly enhanced vessel segments and the occurrence of false positives [50]. The major contributions of this paper are three-fold: (1) From methodological point of view, we combine both Hessian geometrical features which are eigenvalues and eigenvectors to define a robust new region growing criterion tailored to the coronary artery segmentation problem. This criterion is integrated into a mulitscale region growing algorithm ensuring the detection of different sized vessels. (2) We propose an evaluation database containing two datasets with different challenging degrees, which allow the quantitative evaluation of the method in terms of region overlap, sensitivity and precision. To the best of our knowledge, there is no standard database available for this task. The only database available in the literature was proposed by [36] and was designed to evaluate centerline extraction methods rather than segmentation evaluation. (3) We evaluate our method from two aspects, which are the enhancement filter and the segmentation methods. The remainder of this paper is organized as follows. In Section 2, background concepts related to our approach are reviewed. Section 3 illustrates the proposed method in detail. Experiments are described in Section 4. Some illustrative results are given in Section 5. Section 6 presents discussion and concluding remarks.

The idea of multiscale image analysis is to add a new dimension to the analysis which is the image scale. The image is transformed into a set of blurred images, each representing the original image, but at a different scale [51]. These blurred images are obtained by convolving the initial image I
                     0(p)=
                     I
                     0(x, y) with a Gaussian kernel to represent the information at a certain scale.
                        
                           (1)
                           
                              
                                 I
                                 σ
                              
                              (
                              p
                              )
                              =
                              
                                 I
                                 σ
                              
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 I
                                 0
                              
                              (
                              x
                              ,
                              y
                              )
                              ⊗
                              
                                 G
                                 σ
                              
                              (
                              x
                              ,
                              y
                              )
                           
                        
                     where I
                     
                        σ
                      is an image of the scale space, p
                     =(x, y) is a pixel location, ⊗ represents the convolution operation and G
                     
                        σ
                     (x, y) is the 2D Gaussian kernel with standard deviation σ defined as:
                        
                           (2)
                           
                              
                                 G
                                 σ
                              
                              (
                              p
                              )
                              =
                              
                                 G
                                 σ
                              
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 1
                                 
                                    
                                       
                                          2
                                          π
                                          
                                             σ
                                             2
                                          
                                       
                                    
                                 
                              
                              exp
                              −
                              
                                 
                                    (
                                    
                                       x
                                       2
                                    
                                    +
                                    
                                       y
                                       2
                                    
                                    )
                                 
                                 
                                    2
                                    
                                       σ
                                       2
                                    
                                 
                              
                           
                        
                     where σ
                     ∈Σ={σ
                     
                        min
                     , …, σ
                     
                        max
                     }, σ
                     
                        min
                      and σ
                     
                        max
                      are set according to the approximate width of the smallest and largest vessel to be detected [51].

In the scale space framework, differentiation is defined as a convolution with derivatives of Gaussian:
                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      n
                                                      1
                                                      +
                                                      n
                                                      2
                                                   
                                                
                                                I
                                             
                                             
                                                ∂
                                                
                                                   x
                                                   
                                                      n
                                                      1
                                                   
                                                
                                                ∂
                                                
                                                   y
                                                   
                                                      n
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 σ
                              
                              =
                              I
                              ⊗
                              
                                 
                                    
                                       ∂
                                       
                                          n
                                          1
                                          +
                                          n
                                          2
                                       
                                    
                                    
                                       G
                                       σ
                                    
                                 
                                 
                                    ∂
                                    
                                       x
                                       
                                          n
                                          1
                                       
                                    
                                    ∂
                                    
                                       y
                                       
                                          n
                                          2
                                       
                                    
                                 
                              
                           
                        
                     Thus, the Hessian matrix which is the second order derivative of an intensity image in the scale space can be obtained at each point by Eq. (4):
                        
                           (4)
                           
                              
                                 H
                                 σ
                              
                              (
                              p
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      
                                                         I
                                                         σ
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            ∂
                                                            x
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      
                                                         I
                                                         σ
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   
                                                      ∂
                                                      y
                                                      ∂
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      
                                                         I
                                                         σ
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   
                                                      ∂
                                                      x
                                                      ∂
                                                      y
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      
                                                         I
                                                         σ
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            ∂
                                                            y
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     The Hessian matrix is symmetric, therefore has two real eigenvalues λ
                     1 and λ
                     2 and two associated eigenvectors e
                     1 and e
                     2. The signs as well as the relative and absolute magnitudes of eigenvalues characterize the local shape of the intensity in the image. If we assume that we seek to characterize black vessels on a white background, which is the case of the angiographic images, a pixel belonging to a vessel region will be given by small (ideally 0) λ
                     1 and a high positive value of λ
                     2 (with λ
                     1
                     <
                     λ
                     2).

Frangi et al. [7] note that the Hessian eigenvalues ordered by magnitude (i.e. |λ
                        1|<|λ
                        2|) are geometrically interpreted as principal vessel curvatures and provide a vesselness measure on the basis of this observation. They introduce two measures to describe structures in images: 
                           
                              R
                              b
                           
                           =
                           
                              
                                 
                                    λ
                                    1
                                 
                              
                              
                                 
                                    λ
                                    2
                                 
                              
                           
                         is the blob-like structure measure and 
                           S
                           =
                           ∥
                           H
                           
                              ∥
                              F
                           
                           =
                           
                              
                                 
                                    λ
                                    1
                                    2
                                 
                                 +
                                 
                                    λ
                                    2
                                    2
                                 
                              
                           
                        , the Frobenius norm of the Hessian matrix, is the second-order structureness measure. These measures were combined in a vesselness function as given by Eq. (5).
                           
                              (5)
                              
                                 
                                    V
                                    σ
                                 
                                 (
                                 p
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   if
                                                      
                                                   
                                                      λ
                                                      2
                                                   
                                                   <
                                                   0
                                                
                                             
                                             
                                                
                                                   exp
                                                   
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  
                                                                     R
                                                                     b
                                                                     2
                                                                  
                                                               
                                                               
                                                                  2
                                                                  
                                                                     β
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            −
                                                            exp
                                                            
                                                               
                                                                  
                                                                     −
                                                                     
                                                                        
                                                                           
                                                                              S
                                                                              2
                                                                           
                                                                        
                                                                        
                                                                           2
                                                                           
                                                                              c
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   otherwise
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where parameters β and c are thresholds which control the filter's sensitivity to R
                        
                           b
                         and S respectively. The two vesselness terms 
                           exp
                           (
                           −
                           
                              
                                 
                                    R
                                    b
                                    2
                                 
                              
                              
                                 2
                                 
                                    β
                                    2
                                 
                              
                           
                           )
                         and 
                           (
                           1
                           −
                           exp
                           (
                           −
                           
                              
                                 
                                    S
                                    2
                                 
                              
                              
                                 2
                                 
                                    c
                                    2
                                 
                              
                           
                           )
                           )
                         are combined using their product to ensure that the response of the filter is maximal only if both criteria are fulfilled.

According to scale space theory, V
                        
                           σ
                        (p) will be the maximum only when the width of the vessel in pixel p matches a suitable scale factor σ. Thus, In the multi-scale vessel enhancement algorithm, V
                        
                           σ
                         is computed for different scales then the largest one is taken as the final filter output.
                           
                              (6)
                              
                                 
                                    V
                                    max
                                 
                                 (
                                 p
                                 )
                                 =
                                 
                                    max
                                    
                                       σ
                                       ∈
                                       Σ
                                    
                                 
                                 
                                    σ
                                    γ
                                 
                                 *
                                 
                                    V
                                    σ
                                 
                                 (
                                 p
                                 )
                              
                           
                        
                     

The normalization factor σ
                        
                           γ
                         
                        [51] is introduced to normalize the intensity values across the scale space. The parameter γ can be adjusted to show preference for particular scales. It is equal to one if no scale is preferred. Taking γ
                        <1 favors small scales while γ
                        >1 favors large ones.

The eigenvectors e
                        1 and e
                        2 of the Hessian matrix of Eq. (4) characterize the local shape of the intensity. e
                        1 gives the direction of lower second derivative, i.e. the direction of a potential linear structure, while e
                        2 gives the direction of the stronger second derivative, i.e. the normal direction to a potential linear structure. Thus the proposed direction information D
                        
                           σ
                         can be simply given by the following expression:
                           
                              (7)
                              
                                 
                                    D
                                    σ
                                 
                                 (
                                 p
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   if
                                                   
                                                   
                                                      λ
                                                      2
                                                   
                                                   <
                                                   0
                                                
                                             
                                             
                                                
                                                   e
                                                   1
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Fig. 2
                         shows a motivating example of incorporating the direction information. The green circle in Fig. 2(a) shows a stenosis in a coronary artery. When the maximum Frangi vesselness is computed, the filter response significantly decreases in this location. However the first eigenvector ensure the continuity of concerned pixels and their neighbors (see Fig. 2(d)). One can note that neighboring pixels in this location exhibit close direction.

Leveraging from the above-mentioned multiscale geometrical information, we design a robust multiscale region growing process able to extract both wide and thin vessels while avoiding undesirable structure overemphasis and early segmentation stop.

A general overview of the proposed method is depicted in Fig. 3
                     . First, seed points are selected by seeking for points with the highest Frangi vesselness response (Section 3.1). Most of the automatically generated seed points are located in large vessels, thus the growing is made in a coarse-to-fine scheme in order to ensure a fluid and fast process. Therefore, starting from the highest scale σ
                     
                        max
                     , the vesselness (V
                     
                        σ
                     ) and direction (D
                     
                        σ
                     ) features are computed for each scale. Then a region growing process based upon a specific criterion combining those two features is performed. This criterion will be described in Section 3.2. If all the scales are explored, i.e. σ
                     
                        min
                      is reached, the segmented image is obtained else the segmentation process restarts with the next scale σ
                     −
                     σ
                     
                        step
                     . The details of the process evolution over the different scales are described in Section 3.3.

Candidate seed points are automatically generated by the Frangi vesselness map analysis. Pixels exhibiting the maximum of vesselness are considered as a good starting point. Since the vesselness is always maximum along the vessels’ centerlines and close to zero outside tube-like regions, the initial seed points are generally located in the center of vascular regions. To avoid points in the peripheral positions with high response, the search is done inside a sub-area excluding the image borders.

The red points in Fig. 4(a)–(c) show some automatically generated seeds on three different images. These points are often located in the center of wide vessels. One can see that some regions especially thin vessels with very low illumination may be unreachable. Thus, if the user is interested in thin vessel extraction, he may add some more additional seeds. The added seeds are depicted in green in Fig. 4.

The idea behind our approach is to incorporate the vessel direction information with the vesselness response in order to improve the vessel segmentation result. This information has to be included in a way that favors neighbors exhibiting directions close to the direction of a seed point even if their vesselness responses are lower than a given threshold. This will help to ensure the continuity of the segmentation along the artery direction, and reduce the number of broken branches as well. Based on this idea, we propose a region growing algorithm based on the following convergence condition:
                           
                              (8)
                              
                                 
                                    for
                                       
                                    all
                                       
                                    pixel
                                 
                                    
                                 p
                                 ,
                                 
                                 
                                    if
                                       
                                    there
                                       
                                    exists
                                 
                                    
                                 q
                                 ∈
                                 
                                    N
                                    4
                                 
                                 (
                                 p
                                 )
                                    
                                 
                                    such
                                       
                                    that
                                 
                                    
                                 B
                                 (
                                 q
                                 )
                                 =
                                 1
                                    
                                 and
                                    
                                 
                                    V
                                    σ
                                 
                                 (
                                 p
                                 )
                                 >
                                 η
                                 (
                                 1
                                 −
                                 
                                    Ω
                                    σ
                                 
                                 (
                                 p
                                 ,
                                 q
                                 )
                                 )
                                 ,
                                    
                                 then
                                    
                                 B
                                 (
                                 p
                                 )
                                 ←
                                 1
                                 .
                              
                           
                        Here B is the binary image corresponding to the segmentation, 
                           
                              N
                              4
                           
                           (
                           p
                           )
                         is the 4-neighborhood of pixel p, and Ω
                           σ
                         is a correlation index between vessel orientations at pixels p and q, defined as follows:
                           
                              (9)
                              
                                 
                                    Ω
                                    σ
                                 
                                 (
                                 p
                                 ,
                                 q
                                 )
                                 =
                                 
                                    
                                       
                                          D
                                          σ
                                       
                                       (
                                       p
                                       )
                                       .
                                       
                                          D
                                          σ
                                       
                                       (
                                       q
                                       )
                                    
                                    
                                       ‖
                                       
                                          D
                                          σ
                                       
                                       (
                                       p
                                       )
                                       ‖
                                       ‖
                                       
                                          D
                                          σ
                                       
                                       (
                                       q
                                       )
                                       ‖
                                    
                                 
                              
                           
                        Ω
                           σ
                        (p, q) becomes one when the two local direction vectors are parallel and becomes zero if they are orthogonal. As a result, the growing process may aggregate pixels with close directions even if their vesselness values are low. The η parameter is a basic threshold of the vesselness value needed to growing the vessel region. If we assume that the vesselness is rescaled in the interval [0,1], η will be between 0 and 1. The smaller value of the parameter η can result in the overgrowth of the vessel region, while the bigger one will limit the extension of the seed point set.

A pseudo-code for the MSRG algorithm is given in Algorithm 1. The initial seeds (binary image S) are used to initialize an iterative region growing segmentation process, whose output is the binary image B. Then, at each scale starting from the largest scale σ
                        
                           max
                        , the vesselness (V
                        
                           σ
                        ) and direction (D
                        
                           σ
                        ) features are computed from the original image I. At each scale, the region growing process is implemented using a processing queue Q, which is initialized with the current segmentation image B. Then, the first pixel of the queue (q
                        ←
                        Q
                        .first) is picked, its 4-neighbors meeting the growing condition of Eq. (8) are added to the queue and to the segmented image, then q is pulled out of the queue, the new first pixel of the queue is picked, and so on until the queue is empty. If all the scales have been explored, i.e. σ
                        
                           min
                         is reached, then the segmented process is done, else it restarts with the next scale σ
                        −
                        σ
                        
                           step
                        .


                        
                           Algorithm 1
                           Multiscale region growing (I, S).


                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                Require:  
                                                S
                                                ≠0
                                          
                                          
                                             1:  B
                                                ←
                                                S
                                             
                                          
                                          
                                             2:  σ
                                                ←
                                                σ
                                                
                                                   max
                                                
                                             
                                          
                                          
                                             3:  while 
                                                σ
                                                ≥
                                                σ
                                                
                                                   min
                                                 
                                                do
                                             
                                          
                                          
                                             4:    Q
                                                ←{q
                                                ;
                                                B(q)=1}
                                          
                                          
                                             5:    while 
                                                Q≠∅ do
                                             
                                          
                                          
                                             6:      q
                                                ←
                                                Q
                                                .first
                                          
                                          
                                             7:      for all 
                                                
                                                   p
                                                   ∈
                                                   
                                                      N
                                                      4
                                                   
                                                   (
                                                   q
                                                   )
                                                 
                                                do
                                             
                                          
                                          
                                             8:        if 
                                                B(p)=0 and 
                                                V
                                                
                                                   σ
                                                (p)>
                                                η(1−Ω
                                                   σ
                                                (p, q)) then
                                             
                                          
                                          
                                             9:          B(p)←1
                                          
                                          
                                             10:          Q
                                                ←
                                                Q
                                                ∪{p}
                                          
                                          
                                             11:        end if
                                             
                                          
                                          
                                             12:      end for
                                             
                                          
                                          
                                             13:      Q
                                                ←
                                                Q\{q}
                                          
                                          
                                             14:    end while
                                             
                                          
                                          
                                             15:    σ
                                                ←
                                                σ
                                                −
                                                σ
                                                
                                                   Step
                                                
                                             
                                          
                                          
                                             16:  end while
                                             
                                          
                                          
                                             17:  return 
                                                B
                                             
                                          
                                       
                                    
                                 
                              
                           

@&#EXPERIMENTS@&#

This section presents experiments carried out to assess the behavior of the proposed segmentation method. The materials used in our experiments are described in Section 4.1. Section 4.2 introduces the performance measures used to evaluate the algorithms. The different parameters used in the experiments are described in Section 4.3. Finally Section 4.4 introduces the state of the art methods used in the evaluation.

Real clinical X-ray angiograms were acquired during routine cardiac catheter examinations using a single plane Siemens Artis Zee angiography system available at the Cardiology Department of The University Hospital Fattouma Bourguiba, Monastir, Tunisia.

For each intervention, Dicom sequences of different projections were obtained by varying the left or the right anterior oblique (LAO or RAO) angle and the caudal or cranial (CAUD or CRAN) angle in order to visualize both left and right coronary arteries. The acquired series were then extracted and interesting angiograms from both healthy and diseased patients with different stenosis severity degrees were selected.

A total of 50 images obtained from 25 patients were selected by the clinicians. Each image has a size of 512×512 pixels and 256 gray levels with a resolution of 0.3×0.3mm. This database was equally split into 2 datasets. The first one (DS1) contains relatively easy cases in terms of vessel illumination and stenosis degrees, whereas the second dataset (DS2) presents difficult situations that may occur in X-ray coronary angiograms, such as low signal to noise ratio, severe stenosis and the overlapping of many vessels. From each dataset, 7 images were used for parameters tuning, and the tests were performed on the remaining images from different patients.

In order to evaluate the different segmentation methods on these images, manually gold standard were outlined by two trained operators and verified by clinicians resulting in two sets 1 and 2. The manually segmented images in set 1 and set 2 noted GT1 and GT2 respectively are used as ground truth. The disagreement between the two observers occurs especially on vessels borders and endpoints. Fig. 5
                         depicts two different ground truth of an image belonging to the first dataset. The common part is plotted in white color in Fig. 5(b) while the red color illustrates pixels detected only by the first human observer. The blue color shows pixels detected only by the second human observer.

Three evaluation metrics, namely Dice coefficient [52], sensitivity and precision were used. The Dice similarity index is a measure of region overlap defined by:
                           
                              (10)
                              
                                 
                                    Dice
                                    i
                                 
                                 =
                                 
                                    
                                       2
                                       *
                                       |
                                       
                                          
                                             GT
                                             i
                                          
                                          ∩
                                          Seg
                                          |
                                       
                                    
                                    
                                       |
                                       
                                          GT
                                          i
                                       
                                       |
                                       +
                                       |
                                       Seg
                                       |
                                    
                                 
                                 
                                 for
                                    
                                 i
                                 ∈
                                 {
                                 1
                                 ,
                                 2
                                 }
                              
                           
                        where GT
                        
                           i
                         is the ground truth region depicted by the observer i and Seg is the automatically segmented region. Dice is always between 0 and 1, with higher values indicating better match between automatic and manual segmentations.

Precision is the rate of true-positives to the total number of positives. It is expressed by the following formula:
                           
                              (11)
                              
                                 
                                    Precision
                                    i
                                 
                                 =
                                 
                                    TP
                                    
                                       TP
                                       +
                                       FP
                                    
                                 
                                 
                                 for
                                    
                                 i
                                 ∈
                                 {
                                 1
                                 ,
                                 2
                                 }
                              
                           
                        TP is the number of true positive, i.e. correctly classified vessel whereas FP is the number of false positive, i.e. ground truth non-vessel pixels overlapping detected pixels.

Sensitivity measures the proportion of ground truth positives which are correctly identified as such. It is given by:
                           
                              (12)
                              
                                 
                                    Sensitivity
                                    i
                                 
                                 =
                                 
                                    TP
                                    
                                       TP
                                       +
                                       FN
                                    
                                 
                                 
                                 for
                                    
                                 i
                                 ∈
                                 {
                                 1
                                 ,
                                 2
                                 }
                              
                           
                        where FN is the number of false negatives, i.e. incorrectly rejected pixels.

For each quantitative metric, statistical analysis was performed in order to decide whether the means are actually different or the difference between empiric means may be due to chance. We used one-way ANOVA (ANalysis Of VAriance between groups) test with post hoc Tukey HSD (Honestly Significant Difference) for pairwise comparisons. For the ANOVA tests, we report the results as (F(df
                        1, df
                        2)=…, p
                        =⋯), where df
                        1 (resp. df
                        2) is the between-groups (resp. within-groups) degree of freedom, F is the F-ratio defined as the between-groups variance divided by the within-groups variance and p is the p-value corresponding to the probability to observe such difference between the empiric means if the means of the different groups is actually the same. The p-value is also provided for Tukey tests. Usually the results are considered statistically significant when the p-value is less than 0.05. All statistics were conducted with The IBM SPSS version 20.0.

All the results presented in this work use β
                        =0.5 and half the value of the maximum Hessian norm for c (
                           c
                           =
                           
                              1
                              2
                           
                           max
                           ∥
                           H
                           
                              ∥
                              F
                           
                        ) as proposed in [7].

Scales should be set according to the approximate width of the smallest and largest vessel to be detected. Scales should better match the radii of coronary arteries. In our database vessel radii vary from less than 1 pixel to more than 10 pixels wide in some images. The performance of our method, as any other multiscale method, highly relies on how accurate the scales estimation is, especially on the σ
                        
                           max
                         parameter. In fact, a lower σ
                        
                           max
                         will suffer from noise disturbance and bar-like profiles. In contrast, an over-large σ
                        
                           max
                         might blur the adjacent structures and over-estimate the vessel caliber. In our work, for each image, the largest vessel diameter d
                        
                           max
                         was calculated by averaging the maxima of the distance transform computed on the two ground truth vessel trees and σ
                        
                           max
                         was set to 0.5*
                        d
                        
                           max
                        . σ
                        
                           min
                         was set to 1 since vessels with smaller radii are not of interest. Four logarithmically spaced scales between σ
                        
                           min
                         and σ
                        
                           max
                         were then generated for each image.

The η parameter is calculated as a fixed quantile of the accumulated histogram of the vesselness image V
                        
                           σ
                        . We experimentally optimize this parameter and find that 95% is an acceptable threshold for our dataset.

@&#METHODS@&#

The evaluation of our method robustness and efficiency is done in two stages. First, we seek to see the effect of the enhancement filter chosen in this work. Then, we compare the proposed segmentation with other state of the art methods.

In order to justify the choice of the Frangi filter for vessel detection within our approach, we build our segmentation algorithm upon different enhancement filters which are Sato filter, VED filter and Frangi filter.

The vesselness proposed by Frangi et al. in [7] is often considered as the current gold-standard for vessel enhancement [53]. The Sato filter [6] is also a well-cited method in this field and is integrated in many medical tools such as Mevislab
                              1
                           
                           
                              1
                              
                                 http://www.mevislab.de/.
                            and Vmtk.
                              2
                           
                           
                              2
                              
                                 www.vmtk.org/.
                            The VED filter was presented as a diffusion based version of the Frangi filter and is gaining in popularity especially for vessel enhancement in 3D images. The results obtained by the VED filter, similarly to other diffusion-based methods cannot be directly compared to Hessian-based methods since the VED output is a smoothed image and not a vesselness image. Readers may note this difference in Fig. 6
                            where Fig. 6(c) is the smoothed image obtained by applying the VED filter to the original image in Fig. 6(a), whereas Fig. 6(b) is the output of the Frangi filter. Thus, we apply the Frangi filter to the VED result (Fig. 6(c)). The final output image is given by Fig. 6(d). All these methods were tested using the same scale range already discussed. The parameters α and β were set to 1 for the Sato filter whereas the VED filter was applied using the default parameters recommended by the authors in [17] (
                              w
                              =
                              25
                           , s
                           =5 and ξ
                           =10−2).

The MSRG algorithm was compared against four state-of-art segmentation approaches, which are hysteresis thresholding (HT), fuzzy clustering (FC), multi-seed region growing (RG) and accurate quantitative coronary artery segmentation (AQCA).

Classic segmentation methods such as hysteresis thresholding (HT), fuzzy clustering (FC) and multi-seed region growing (RG) are often applied to the final Frangi filter obtained by the maximum Frangi vesselness response. They are used generally in cases in which no dense abnormalities are present or when the vessel segmentation is auxiliary to the main task such as centerline extraction and 3D reconstruction of the coronary tree from different projections [3,26]. Their output was thought to be sufficient to launch other applications. The hysteresis thresholding is applied on the maximum Frangi vesselness response. This method retains connected components with all points that have a vesselness value greater than a low threshold and having at least one pixel with a vesselness value greater than a high given threshold. We used the thresholds suggested in [3] which are around 90% and 95% of the accumulated histogram of the vesselness image.

The second method segments the maximum vesselness image into two partitions using standard Fuzzy C-Means algorithm (FCM).The FCM algorithm classifies the image by grouping similar pixels in the image into clusters. This clustering is achieved by iteratively minimizing an objective function with respect to fuzzy membership.

The third method is based on simple region growing (RG) on the maximum vesselness image with multiple seeds. The initial seed points for RG are the same used for the MSRG algorithm. No manual seed was added to any method.

An interesting relatively recent work (AQCA) tailored to coronary artery extraction has been proposed by Hernández-Vela et al. in [54] and extended in [36]. This method is also based on the maximum Frangi vesselness map but it uses a graph cut algorithm which incorporates an automatic point seeding method and a multiscale edgeness term to detect vessel borders. We used the implementation available in the author website
                              3
                           
                           
                              3
                              
                                 http://www.cvc.uab.es/cgatta/CoronaryCenterlineExtraction.html.
                            and the recommended parameters.

@&#RESULTS@&#

We divide the results in enhancement (Section 5.1) and segmentation (Section 5.2) evaluation.

Dice, sensitivity and precision of the three MSRG versions are presented in Fig. 7
                         for the first dataset and Fig. 8
                         for the second dataset. The first row compares the second observer and the three methods to the first observer while the second row presents an evaluation against the second observer.

Regarding the two datasets, the ANOVA test showed that there was a significant difference of means between the methods for each metric (ANOVA, 10≤
                        F(3, 68)≤55, p
                        <0.001). The Sato filter has the lowest performance in terms of Dice similarity, sensitivity and precision. The difference between Sato and Frangi filters is statically significant especially in terms of Dice and precision (Tukey, p
                        <0.05). This confirms the sensitivity of this filter to noise. The Frangi and VED filters have very similar performance measures with a slight superiority for the Frangi filter. The difference between them is not statistically significant for all metrics (Tukey, p
                        >0.05). This little difference is due to the impact of the blurring effect of VED filter especially on small vessels. One can see in the red rectangles in Fig. 6(c) and (d) that some discontinuities occur in thin vessels. Thus, distal parts of those vessels are missed in the segmentation step.


                        Fig. 9
                         shows Dice, sensitivity and precision for the four different methods (HT, FC, RG, AQCA and MSRG) as well as each observer against the other for the first dataset. It is worth to note that the plots in the first and second row have roughly similar appearance. In the two datasets, a significant difference between the segmentation methods was reported for the three metrics (ANOVA, 11≤
                        F(5, 102)≤88, p
                        <0.001).

A small inter-observer variability occurs in the sensitivity plot and shows that the first observer detects more vessels pixels than the second one. Regarding the Dice metric, the FC method has the lowest Dice. HT achieves better than FC but significantly lower than the three other methods (Tukey, p
                        <0.01). RG and AQCA have slightly equal Dice values and the MSRG achieves the best overlap values (Tukey, p
                        <0.01).

The method HT has significantly higher sensitivity than FC, RG and AQCA (Tukey, p
                        <0.01) but it has the disadvantage to produce many false positives as confirmed by the low statistically significant (Tukey, p
                        <0.01) precision values. Our method which can be seen as an enhanced region growing method achieves better sensitivity while keeping the same precision level as the region growing. The difference between RG and MSRG is significant only in terms of sensitivity (Tukey, p
                        <0.01) for both GT. It is also worth to note that the AQCA has the highest precision but it remains lower than the inter-observer variability.

Regarding the second dataset (Fig. 10
                        ), the methods keep the same order in term of segmentation overlap (Dice). The inter-observer variability has increased in terms of sensitivity and precision. The precision of the HT, FC and RG methods have a large standard deviation which means that they may introduce a lot of false positives. Our method still achieves better statistically significant (Tukey, p
                        <0.01) sensitivity than RG and AQCA and an acceptable rate of precision (80%). AQCA has the best precision but the results are statistically significant only with HT, FC and RG (Tukey, p
                        <0.01). The difference in terms of precision between MSRG and AQCA is not significant (Tukey, p
                        >0.5). The outliers (red marks) seen in the different plots are related to bad automatic seed or threshold initialization.

Moreover, Fig. 11
                         shows some resulting outputs of the five different segmentation methods. From top to bottom, we find three different real angiograms; ground truth; hysteresis thresholding; fuzzy clustering; region growing; AQCA and our method outputs. The first and second images belong to the first dataset whereas the third images is characterized by a difficult background and many thin vessels overlap and belongs to second dataset. All the shown results are obtained without any added seeds.

The strength of our method is that most of the relevant vessels are segmented, even small ones. From the third line, it is obvious that the HT method has difficulties to segment the small vessels. The red circle in the first row shows a missed small vessel by the HT segmentation method. The same branch is also omitted by the FC and RG. This branch is detected by the AQCA but not in totality.

The green circles in images of the second row demonstrate that FC, AQCA and our approach are robust when dealing with a moderated stenosis. The three other methods fail to reach distal parts located after the stenosis. However, the FC method suffers from some discontinuities and is sensitive to noise which is also a limitation of the HT segmentation method as we can see in the figures of the last column where the yellow circles show non-vascular structures erroneously segmented by both HT and FC. Contrarily, the RG, MSRG and AQCA are able to avoid noise far enough from vessels since they start from correct seeds. However, the RG method produces many false positives around the thin vessels. The AQCA achieves a good segmentation of the principal arteries but gives more false negatives than the MSRG.

@&#DISCUSSION AND CONCLUSION@&#

In this paper, we have presented a novel method for coronary artery segmentation based on Hessian features analysis in a multiscale fashion. We have introduced a growing rule combining both vesselness and direction information at different scales. First, the Frangi vesselness filter was adopted for vessel enhancement since it nicely captures tubular structure and significantly reduces background artifacts. Then, instead of extracting vascular structure only on the basis of their vesselness response, we have also incorporated the direction information. This information was included in a way that favors neighbors exhibiting directions close to the direction of a seed point even if their vesselness responses are lower than a given threshold. Thereby, the growth runs fluidly along the artery direction, and the number of broken branches is reduced as well. The multiscale region growing is robust, especially when dealing with discontinuity factors such as noise, stenosis and low contrast. Quantitative evaluation has been performed on real angiography images at two stages. First, the choice of the Frangi filter for vessel-like structures detection was justified by comparing the segmentation results obtained from three different filters. The proposed segmentation method has been also compared to other segmentation methods and it has been shown that it generates a better performance than fuzzy clustering, hysteresis thresholding and region growing in terms of vessel overlap, sensitivity and precision. The AQCA method, however, by using a multiscale edgeness term that is able to accurately detect vessel border, reaches a precision greater than our method. But its sensitivity is smaller.

The results obtained by our algorithm (an average of Dice coefficient of 80±5% for DS1 and 70±5% for DS2) seem to represent a significant misalignment. Fig. 12
                      gives details of misalignment between the MSRG algorithm and the first ground truth. Almost the false negatives occur in vessels boundaries. For the large vessels a difference of 1–2 pixels between each ground truth and the segmentation is noted. Contrarily, false positives frequently appear on thin vessels which are generally overemphasized. Our observations throughout the two datasets showed that the discordance is due to two main causes which are: (1) detection of non-vascular structures like background structures which are adjacent to vessels; and (2) false positives on vessel borders.

The first type of error is normally related with the vessel enhancement method used. In fact, the Frangi filter enhances not only the coronary tree but also any tubular structure including diaphragm, spinal disks, catheters and other background artifacts. Such non-vascular structures are erroneously segmented by our method only if they intersect or are very close to a vascular branch, otherwise they are enhanced by the Frangi filter but omitted by our segmentation method since the growth process starts from correctly classified seeds. Such error occurs in just few images of our dataset and it can be resolved if these structures are beforehand detected and eliminated from the images using an a priori knowledge for the shape of the diaphragm border [55] or a learning-based method to detect the catheter [36].

The second error consists in inaccurate border detection especially for thin arteries. In fact, these vessels may be overemphasized when they are processed at a scale larger then their sizes. This issue could be addressed if a break constraint is added to our algorithm in order to stop the growing when the vessel boundaries are reached. Obviously, this needs a robust vessel border detector such as the multiscale Canny edge detector used in the AQCA method [36].

In the future work, we would like to overcome these limitations by automatic detection of non vascular structures and better vessel border delineation. Future investigation of our segmentation method can be used as a computer-assisted quantitative analysis of blood vessels from angiograms or as an input for other processing tasks such as centerline extraction [36], and 3D coronary tree reconstruction [3].

@&#REFERENCES@&#

