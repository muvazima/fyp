@&#MAIN-TITLE@&#A virtual reality based simulator for learning nasogastric tube placement

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A virtual training simulator is proposed for nasogastric tube (NGT) placement.


                        
                        
                           
                           Hybrid force model simulates the interactions between NGT and nasogastric passage.


                        
                        
                           
                           Insertion forces are computed analytically or by interpolating pre-computed FEM data.


                        
                        
                           
                           Quantitative performance metrics are available for objective assessment.


                        
                        
                           
                           The haptic feeling is similar to nurses’ experience in real NGT placement.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Virtual reality

Haptic rendering

Nursing skills training

Clinical simulation

Nasogastric tube

Intubation

@&#ABSTRACT@&#


               
               
                  Nasogastric tube (NGT) placement is a common clinical procedure where a plastic tube is inserted into the stomach through the nostril for feeding or drainage. However, the placement is a blind process in which the tube may be mistakenly inserted into other locations, leading to unexpected complications or fatal incidents. The placement techniques are conventionally acquired by practising on unrealistic rubber mannequins or on humans. In this paper, a virtual reality based training simulation system is proposed to facilitate the training of NGT placement. It focuses on the simulation of tube insertion and the rendering of the feedback forces with a haptic device. A hybrid force model is developed to compute the forces analytically or numerically under different conditions, including the situations when the patient is swallowing or when the tube is buckled at the nostril. To ensure real-time interactive simulations, an offline simulation approach is adopted to obtain the relationship between the insertion depth and insertion force using a non-linear finite element method. The offline dataset is then used to generate real-time feedback forces by interpolation. The virtual training process is logged quantitatively with metrics that can be used for assessing objective performance and tracking progress. The system has been evaluated by nursing professionals. They found that the haptic feeling produced by the simulated forces is similar to their experience during real NGT insertion. The proposed system provides a new educational tool to enhance conventional training in NGT placement.
               
            

@&#INTRODUCTION@&#

Nasogastric tube (NGT) placement is an essential clinical procedure that can be used to provide feeding or drainage. The procedure involves the insertion of a plastic tube into the stomach by passing it through the nostril and the throat. However, NGT insertion is a non-trivial clinical skill. Applying excessive force during insertion may cause damage to the turbinates or nasopharynx [1]. More seriously, NGT insertion is a blind process in that the tube may reach other parts of the body instead of the stomach without the knowledge of the inserter. Such misplacement has unfortunately resulted in unexpected complications and fatal accidents. For instance, lung perforations leading to hydrothorax and pneumothroax have been reported due to the mistaken placement of the NGT into a pleural cavity [2–4]. The inadvertent insertion of an NGT into the oesophagus and nasopharynx has occurred and caused mediastinal complications [5] and pneumonia [6], or even massive bleeding due to the puncturing of the oesophagus and intra-thoracic large vessels [7]. Meningitis, neurological damage, and death caused by the accidental insertion of NGT into the cranium, e.g., for patients with head trauma, has also been reported [8].

Conventionally, the teaching of nursing procedures begins by conveying the principles and theories in classrooms, followed by small-group clinical teaching with instructors demonstrating the manual skills. Patient simulators have been developed to facilitate the apprenticeship model of clinical training. Low-fidelity simulations are conducted using passive rubber mannequins to present the human anatomy. High-fidelity simulators, developed based on pre-programmed data on human physiology, are also made available to respond to the actions of trainees. They are an attractive tool used to complement conventional teaching, despite the high setup and running costs due to the need for a specially designed laboratory and trained personnel. Nevertheless, mannequin-based training remains an instructor-directed approach where teachers are required to supervise and assess each individual student. It also does not allow students the freedom to practise whenever they need to do so [9]. In the case of NGT placement, the hands-on learning of skills is usually conducted by practising on humans (patients or the students themselves) or on low-fidelity rubber mannequins. In the former, trainees can experience the feeling of being intubated, but the process is uncomfortable or could even be harmful. In the latter, the mannequins neither render the actual human anatomy, nor make possible the kind of touch-and-feel experience that comes from real practice. While cognitive and procedural training in NGT insertion procedures can be achieved with such rubber mannequins, the training is ultimately not realistic.

Virtual reality (VR) based training is an efficient and effective methodology for learning manual skills. Its application in medicine has received considerable attention in the past decades [10], during which many virtual medical training simulators have been developed. For example, residents and novice surgeons can learn surgical skills in realistic computer-simulated virtual environments [11] to alleviate the demand for practising on patients and the need for wet labs for training on animals or cadavers. VR-based simulations can be achieved simply with a personal computer (PC) equipped with a generic user interface (i.e., non-immersive VR) or with 3D user interface devices (i.e., immersive VR). The affordability and availability of VR systems ease the constraints of space and time in clinical training. The programmability and flexibility of these systems also make trainee-specific learning possible.

However, VR training systems for clinical nursing education are relatively scarce [12]. A few simulators have been developed for learning the skill of inserting medical devices. For example, a haptic user interface was employed in a virtual nasotracheal suctioning system [13] to mimic the insertion of a catheter in the trachea via the nasal passage. An interactive visual aid was provided to allow the user to visualize the location of the catheter inside the body during the process. A computerized male catheter insertion simulator known as Urecath 
                     [14] was developed using real medical devices as the user interface. The amount of anaesthesia administered and the extent of the balloon injection can be visualized on a computer screen in real time. Intravascular cauterization simulators like CathSim 
                     [15] and Virtual IV Simulator 
                     [16] were designed for the training of both cognitive and manual skills. A custom-designed hardware user interface was developed to mimic the insertion of a needle and catheter into patients under different conditions. There are very few training simulators for NGT insertion training, with the exception of a non-immersive PC-based system with a keyboard and mouse as the user interface, which was developed simply for checking whether the trainees were aware of the required steps [9].

On the other hand, in medicine, studies have been conducted on simulating virtual intubation with physicians as the target users, e.g., endotracheal intubation (ETI) procedures for emergency medicine education [17–19]. A non-immersive education software was developed to allow users to visualize the correct head/neck position and the tracheal opening [18]. To simulate the force of insertion, a commercial haptic device [17] and a specifically engineered force feedback device [20] were employed to render realistic tactile feeling. In addition, a chest tube insertion simulator was built with a pair of haptic devices to simulate bimanual operations during the process of incision and intubation [21,22].

In this paper, an interactive low-cost training system is proposed for learning NGT insertion in computer-simulated virtual environments. The anatomical parts along the nasogastric passage are modelled geometrically based on human anatomy. Both static and dynamic friction between the NGT and the nasogastric passage are considered in modelling the forces that occur during the insertion process. To simulate the forces realistically and in real time, a hybrid force model combining a data-driven approach and an analytical force model is proposed. In this model, the force data due to interactions between the tube and that part of the nasogastric passage with a more complex geometry are first computed offline. The pre-computed data are then retrieved to estimate the feedback forces in real time. On the other hand, the forces between the tube and that part of the nasogastric passage with a simple geometry are calculated analytically in real time. This hybrid approach ensures real-time rendering of the haptic feedback, which usually requires a high update rate of 1kHz and prohibits the use of computation-intensive algorithms. Furthermore, to enhance the realism of the simulation, the proposed training system also takes into account (i) the simulation of the forces perceived by healthcare workers during swallowing—an essential step that patients are asked to perform (e.g., by taking sips of water) to facilitate tube advancement, and (ii) the effect of tube buckling at the entrance of the nostril, which may occur when the tube is not properly aligned along the nostril.

The rest of the paper is organized as follows. Section 2 gives the background of the NGT placement procedure. Section 3 focuses on the modelling and simulation of NGT insertion, including the geometrical modelling of the tube and the nasogastric passage, algorithms employed to detect tube-passage collisions, and the hybrid force model proposed to achieve real-time interactive simulation. Section 4 presents the VR training system that was built based on the presented simulation approaches. The findings obtained from the research are discussed in Section 5, and conclusions are given in Section 6.

This section gives an overview of the process of NGT placement [1], including the preparatory work, the steps involved in inserting the NGT—the focus of the present study, and the post-insertion procedures. First, it is necessary to determine whether NGT insertion is needed, e.g., for feeding patients who cannot eat or for removing gastric contents. Contraindications that would lead to adverse effects should also be identified, e.g., the likelihood of obstructions of the nasogastric passage, or trauma to anatomical structures along the passage. When NGT insertion is determined to be appropriate, the patient is given an explanation of the steps that will be taken, the proper posture and cooperation required, and the feeling and potential response during the process, e.g., gagging. The materials to be used for NGT placement should be made available, including personal protective devices, lubricants, a cup of water and a straw, pH paper, and a stethoscope. It is also necessary to prepare an NGT of a suitable size and type.

The insertion process begins with the proper positioning of the patient’s head and body. The nostrils of the patient are examined and the more passable one is chosen for the placement of the tube. The length of the NGT to be inserted is estimated by measuring with the NGT the distance from the tip of the nose to the ear lobe, and then to the xiphoid. With the patient’s neck flexed forward (moving the chin towards the chest), the lubricated end of the tube is inserted into the nostril. The tube is then advanced slowly and gently. The patient is asked to take sips of water and to swallow to facilitate the entering of the tube into the oesophagus. The advancement continues until the estimated insertion length is reached. When resistance is experienced during the placement process, the tube is slightly withdrawn and re-inserted. If the situation persists, the tube is removed and inserted into the other nostril. On the other hand, if the patient gags the process of inserting the tube should be temporarily suspended while the patient is asked to take some deep breaths or sips of water. Insertion will continue when the patient stops gagging and becomes relaxed again.

After insertion, it is necessary to determine whether the tube has reached the stomach. This can be achieved by (i) placing a stethoscope over the abdomen and listening for the sound created by the injection of air through the NGT, (ii) testing the pH value of the contents removed through the NGT, or (iii) using radiography to identify the position of the tube. Once the tube is confirmed to have reached the stomach, it is fixed on the patient’s face using adhesive tape.

In the insertion process, it is important to ensure that the tube is moved through the posterior pharynx and entered into the oesophagus, instead of the larynx. It should be noted that taking sips of water and swallowing would cause the epiglottis to cover the opening of the larynx, thus preventing the tube from inadvertently entering the larynx (see 
                     Fig. 1). Compared to the oesophagus, the structure and geometry of the nasopharyngeal cavity is more complex, and resistance to tube advancement is more likely to occur.

While physics-based models are usually preferred for achieving realistic simulations, the models are necessarily computation-intensive and somewhat complicated to implement. The key requirements for the proposed simulator are real-time interactive performance and the realistic rendering of feedback forces. Fast computation is essential to meet these requirements, particularly the high update rate of haptic data. Here, data-driven models offer a promising alternative [23], as they are computationally efficient in real time even for simulating complex scenarios. In such models, the behaviour of simulated objects is parameterized using data measured on real objects, or pre-computed offline, with accurate (yet time-consuming) computational algorithms. The responses of the objects can then be simulated dynamically and interactively in real time. In this study, a data-driven model is adopted where the relationships between the insertion depth of the NGT and the corresponding feedback force are first determined offline for that part of the nasogastric passage with more complicated geometry. When the virtual NGT is being inserted via the haptic device, the force data are then computed efficiently on the fly to make it possible for the feedback forces to be perceived by the users. On the other hand, for that part of the passage that has a simple anatomical structure and geometry, analytical force models are used to compute the feedback forces in real time. Details of this simulation approach are presented in the following sub-sections, namely, those on the modelling of the NGT and the nasogastric passage, the algorithm employed to detect tube-passage collisions, and the hybrid force model developed to compute the interaction forces concerned, i.e., the static and dynamic friction forces, swallow force, and NGT buckling force.

Multiple models are used to represent the NGT and the nasogastric passage respectively, in order to optimize the simulation of the interactions between these two entities, thus achieving a balance between speed and accuracy.

First, the NGT is modelled geometrically with 91 nodes and 210 hexahedra (see 
                           Fig. 2(a)). To expedite collision detection, the collision model of the NGT is composed of bounding spheres aligned along the centre line of the NGT, as shown schematically in Fig. 2(b). As the interactions are more complicated when the tube is entering the beginning part of the nasogastric passage (from the nasal passage to the larynx), instead of distributing the bounding spheres uniformly along the tube, the front end is represented with more bounding spheres so as to more accurately detect the collisions that occurred at the initial stage of insertion. Tube bending due to interactions with the nasogastric passage during insertion is modelled physically using the non-linear finite element method (FEM) [24], where the FEM nodes are attached to the collision models. When a collision occurs, the collision model provides contact information to the physical model (e.g., on the points of the collision and the associated normal vectors). The corresponding forces are then calculated based on the hybrid force model that will be discussed in Section 3.3. The forces are applied to the physical model to determine the deflection of the tube.

The nasogastric passage is modelled geometrically with a 3D surface mesh containing 4455 nodes and 4326 triangles (see 
                           Fig. 3). Since the interactions with the epiglottis are critical to the insertion process, the epiglottis is modelled separately with a mesh of higher resolution (60 nodes, 58 triangles) to increase collision detection accuracy. The mesh is created based on human anatomy using a computer-aided design tool. The geometric model is also used as the collision model. The nasogastric passage is modelled physically as a rigid body on the assumption that the deflection of the nasogastric passage is relatively small compared to that of the NGT. This approach is also favourable for reducing the complexity of computations.

During the insertion of an NGT, a number of primitives can come into contact. The pair-wise collision detection of all of the primitives for collisions can be computationally too intensive for real-time interactive simulation. A two-phase collision detection approach is thus adopted to facilitate the identification of colliding primitives, namely, the broad phase and the narrow phase. In the broad phase, axis-aligned bounding boxes are used to partition the meshes of the interacting objects. When collisions occur, the algorithm returns the pairs of colliding boxes concerned. The narrow phase is then invoked to identify the pairs of primitives that are in contact, followed by the application of ray-traced collision detection approaches [25,26] to obtain the coordinates of the contact points and compute all of the intersection contours between the two meshes. An efficient and robust geometry prediction algorithm [27] is employed to trace the contours, so that the creation of degenerated contours can be avoided to facilitate the determination of the penalties and constraints resulting from the collisions. Repulsion between the interacting objects are calculated using Lagrange multipliers based on these penalties and constraints to prevent inter-penetration [28].

In the study, the NGT is modelled as linear elastic material while geometric non-linearity is taken into account to simulate the large bending deformations experienced by the tube during its advancement into the nasal cavity and the laryngopharynx. Stiffness-warped non-linear FEM is used to correct distortions due to the large bending, where warping transformation is applied to the hexahedral finite elements of the tube [24]. Based on the unilateral interaction laws 
                              Ψ
                            (contact, friction, etc.), the equation below is solved with regard to the position and velocity of the nodes at each time step during the simulated tube insertion process [29],
                              
                                 (1)
                                 
                                    M
                                    
                                       v
                                       ̇
                                    
                                    =
                                    f
                                    
                                       (
                                       
                                          q
                                          ,
                                          
                                          v
                                          ,
                                          
                                          t
                                       
                                       )
                                    
                                    ,
                                 
                              
                           where 
                              M
                            is the mass matrix, 
                              f
                            is the interaction forces that are a function of the generalized position 
                              q
                            and generalized velocity 
                              v
                            at time t, and 
                              Ψ
                              (
                              q
                              )
                              v
                              
                              ≥
                              0
                           . Ordinary differential equations governing the dynamics of the interacting objects are solved implicitly using the semi-implicit second-order Newmark integrator [30]. Based on the principle of virtual work, the insertion force F(d
                           
                              k
                           , v
                           
                              k
                           ) is given by
                              
                                 (2)
                                 
                                    F
                                    
                                       (
                                       
                                          
                                             
                                                d
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                t
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            ∫
                                                            Ω
                                                         
                                                         
                                                            δ
                                                            ε
                                                         
                                                      
                                                      T
                                                   
                                                   σ
                                                   d
                                                   Ω
                                                   −
                                                   
                                                      
                                                         
                                                            ∫
                                                            Ω
                                                         
                                                         
                                                            δ
                                                            u
                                                         
                                                      
                                                      T
                                                   
                                                   b
                                                   d
                                                   Ω
                                                
                                                )
                                             
                                             
                                          
                                       
                                       
                                          Δ
                                          L
                                       
                                    
                                    ,
                                 
                              
                           where d
                           
                              t
                            and v
                           
                              t
                            are the depth and velocity at time t, δε is the virtual internal strain, σ is the internal stress, 
                              b
                            is the external body force, δu
                            is the virtual displacement, Ω is the volume of the tube, ∆L is the NGT displacement within time step ∆t, and T denotes the transpose of a matrix.

Efficient collision detection between the NGT and the nasogastric passage is achieved using the bounding volume approach, where a collision model is built by the concatenation of bounding spheres along the centre line of the tube. When collisions with bounding spheres are detected, the ray-traced approach is invoked to determine the coordinates of the contact points. A ray is shot from each surface vertex of the polygons concerned, in the direction of the inward normal [25,26]. Contact points are identified if the ray hits the inward surface of the polygons. The collision model is linked to the physical model (i.e., the FEM computation) with a mapping mechanism, such that the collision information (e.g., contact points and normal vectors) is mapped to the vertices of the non-linear finite elements in the physical model, whereas updated positions computed based on the physical model are mapped back to the primitives of the collision model [31]. In this study, collision detection, FEM computation, and the mapping mechanism were performed using the software package Artisynth (http://www.magic.ubc.ca/artisynth). Further details on the FEM computation and the algorithms can be found in Refs. [24,29,31–33]. 
                           Fig. 4 shows snapshots of the offline simulation of the insertion of the NGT. The physical parameters of the NGT used in the simulation are given in 
                           Table 1.

Given the complex anatomy of the nasogastric passage and the different contact conditions at various locations along the passage, the modelling of the NGT insertion force requires careful and comprehensive consideration. A balance between simulation speed and accuracy is also necessary to guarantee real-time interactive performance while rendering reasonably realistic feedback forces. To achieve this goal, the tube-passage frictional conditions are first handled differently, such that dynamic friction is simulated when the insertion force is large enough, and static friction is simulated when the insertion speed drops below a threshold. Second, a two-stage approach is developed to separately handle the forces resulting from interactions with different anatomical parts along the passage: (i) Stage 1—when the tube reaches the region between the nasal cavity and the laryngopharynx (which has a more complex geometry); and (ii) Stage 2—when the tube is further advanced into the region between the oesophagus and the end of the nasogastric passage (which has a relatively simple geometry). The proposed system also simulates the effect of swallowing, as well as the buckling of that part of the NGT that is at the nostril, due to suboptimal tube-nostril alignment. A hybrid force model is thus developed to simulate these complex interactions during the insertion of the NGT.

To place the NGT into the nasogastric passage, insertion force is applied to the tube to counteract the tube-passage friction and to move the tube downwards into the stomach. A number of insertion strokes are required where the tube is inserted bit by bit into the passage for a short distance at each stroke. In the proposed system, the insertion at each stroke is simulated such that the tube experiences a static frictional force when the insertion force is smaller than a threshold—the maximum static friction F
                           
                              m
                           . When the insertion force is increased and exceeds this threshold, the tube experiences a dynamic frictional force until the speed of insertion is reduced below another threshold value. The tube experiences static and dynamic friction alternately in this manner. The static force is caused by the adhesion between the tube and the nasogastric passage, which can be reduced by lubricating the tube. The static friction F
                           
                              static
                            can be modelled with a Voigt element as follows [34],
                              
                                 (3)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          s
                                          t
                                          a
                                          t
                                          i
                                          c
                                       
                                    
                                    =
                                    k
                                    X
                                    −
                                    β
                                    V
                                    ,
                                 
                              
                           where k is a coefficient dependent on the tube-passage contact conditions; X is the displacement of the tube in the passage, β is a damping factor, and V is the speed of insertion.

When the tube is pushed further, the force caused by adhesion becomes larger. Once the force exceeds a threshold value F
                           
                              m
                           , the tube begins to experience dynamic friction (see 
                           Fig. 5(a)). At this moment, the stick-slip phenomenon occurs and the frictional force drops slightly to F
                           
                              d
                           . In conventional Coulomb’s force models, F
                           
                              d
                            remains relatively constant. However, this is not the case for NGT insertion since the contact conditions vary along the nasogastric passage. In the proposed system, the dynamic friction is given by the resistive force pre-computed numerically using non-linear FEM (see Fig. 5(b)).

The NGT insertion force is modelled with a two-stage approach by considering the characteristics of the tube-passage interactions at two distinct parts of the nasogastric passage. In Stage 1, the NGT is located at the region between the nasal cavity and laryngopharynx, where the anatomical structure that constrains the tube’s movement is more complicated. It is assumed that the deformation of the passage in this part is negligible when compared with the NGT’s large deflection. In this stage, the insertion force is simulated offline using a non-linear finite element. An analytical friction model is not applicable here due to the unavailability of accurate friction parameters for modelling the complex interactions and the large deflection of the NGT in this part of the passage. In Stage 2, the NGT enters the oesophagus and advances to the end of the nasogastric passage. As the geometry of the oesophagus is relatively simple, the deflection of the NGT in this stage is smaller than that in Stage 1. The forces experienced by the tube can therefore be calculated efficiently using an analytical friction force model in real time.

Hence, the insertion force F consists of two components F
                           1 and F
                           2, i.e.,
                              
                                 (4)
                                 
                                    F
                                    =
                                    −
                                    
                                       (
                                       
                                          
                                             
                                                F
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          α
                                          
                                             
                                                F
                                             
                                             
                                                2
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           where F
                           1 is the force exerted on the NGT before it enters into the oesophagus, i.e., the force in Stage 1 (computed using offline FEM data); F
                           2 is the force exerted on that part of the tube that has entered the oesophagus, i.e., the force in Stage 2 (computed in real time); α takes the value of 0 and 1 respectively in Stage 1 and Stage 2. In Stage 2, the force F
                           2 is proportional to the summation of the normal force N
                           
                              k
                            exerted on the kth segment with the friction force model below,
                              
                                 (5)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          2
                                          
                                       
                                    
                                    =
                                    μ
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                    
                                    ≈
                                    2
                                    π
                                    λ
                                    R
                                    
                                       
                                          L
                                       
                                       
                                          e
                                       
                                    
                                    ,
                                 
                              
                           where F
                           2 is proportional to the length L
                           e of that part of the NGT that is inside the oesophagus and the tube radius R; μ is a friction coefficient; n is the total number of segments of the tube; and λ is a constant related to the friction (or lubricating condition) of the passage. In summary, in Stage 1 of the NGT placement, the tube is inside the region between the nasal cavity and the laryngopharynx, where the complex anatomical geometry is unfavourable for FEM computation. The force F
                           1 is instead computed by interpolation in real time using the results of the offline FEM computation. In Stage 2, the tube enters the oesophagus. The force F
                           2 within this region can be computed efficiently using an analytical model in real time, due to the simple geometry. Notice that when the NGT placement is in Stage 2, while the front section of the tube reaches the oesophagus, the rear section is making contact with the nasal cavity and laryngopharynx. The forces due to the interactions in these two sections are F
                           1 and F
                           2, respectively. Hence, in Stage 2, it is necessary to combine the two forces by setting α to 1 in Eq. (4).

In the offline FEM simulation, it is found that due to the material properties of the NGT (i.e., stiffness), the tube essentially follows the same path when being inserted through the nasal cavity and laryngopharynx (more spacious than the oesophagus) before being further constrained to move into the oesophagus, as shown in Fig. 4. Hence, the modelling is reduced to a one-dimensional problem, such that the insertion force F
                           1 in Stage 1, i.e., when the front end of the tube is located within the nasal cavity and the laryngopharynx, can be simply regarded as a function of the insertion depth and the velocity along the tube. In the study, the stress distribution is obtained by performing FEM simulation offline. The data are acquired by setting the insertion velocity v at a fixed magnitude to obtain the insertion force F along the path at different depths d. The simulation is repeated by fixing the velocity at different values to obtain the corresponding force–depth relationships, yielding an offline FEM dataset in the form of the order triple (F, d, v). Based on these offline data, the insertion forces are computed on the fly by linear interpolation to drive the haptic device. Refer to 
                           Fig. 6. The linear interpolation is expressed mathematically as follows,
                              
                                 (6)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          d
                                          ,
                                          v
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          w
                                       
                                       
                                          1
                                       
                                    
                                    F
                                    
                                       (
                                       
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          2
                                       
                                    
                                    F
                                    
                                       (
                                       
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          3
                                       
                                    
                                    F
                                    
                                       (
                                       
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          4
                                       
                                    
                                    F
                                    
                                       (
                                       
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           where F
                           1 is the insertion force in Stage 1, and d and v are the instantaneous depth and velocity obtained from the haptic device. Identified from the offline dataset, d
                           1 and d
                           2 are the sampled depths in close proximity to d (i.e., d
                           1≤d≤d
                           2); and v
                           1 and v
                           2 are the sampled velocities of magnitudes close to |v| (i.e., |v
                           1|≤|v|≤|v
                           2|); w
                           
                              i
                            (i=1,…,4) is the barycentric coordinates as shown in Fig. 6, and F(d
                           
                              i
                           , v
                           
                              i
                           ) is the force computed from the FEM simulation.

Experiments have been conducted to simulate the insertion force in Stage 1, before the NGT enters the oesophagus. As shown in 
                           Fig. 7, when the tube is inserted at a constant speed of 10mm/s, the insertion force increases gradually at the beginning, reaching maximum, and then decreases slightly when the tube enters the oropharynx. The results are similar to the findings reported in [35], which modelled the insertion of a flexible shaft into a circularly bended tube using the Coulombic friction theory with experimentally measured data. Upon reaching the oropharynx, the highly bended tube is relaxed. The work done by the external force is then more effectively expended on advancing the tube further into the pharynx and larynx. Thus, less insertion force is needed to push the tube forward.

The relationship between the insertion force and the insertion speed is also investigated. Comparing the experimental results with the tube inserted at 10mm/s and at 14mm/s (i.e., the typical range of the NGT insertion speed [36]), it can be seen from 
                           Fig. 8 that the insertion force is about the same, while insertion at 14mm/s appears to require a slightly larger force to advance the tube further downwards into the passage.

In addition, the relationship between the insertion force and the tube diameter, as well as that between the insertion force and the Young’s modulus of the NGT are also studied. The results presented with 
                           
                           Figs. 9 and 10 show that the insertion force increases with the diameter and the Young’s modulus of the tube.

When the NGT is reaching the epiglottis, patients are asked to swallow in order to facilitate the advancement of the tube through the oropharynx. The action helps to reduce the insertion force and prevents the tube from being inadvertently inserted into the trachea [37]. The effect of swallowing is simulated in the proposed system by the creation of a transient force called swallow force F
                           
                              s
                            to reduce the required insertion force. Consider a segment of the NGT that is located in the nasogastric passage, namely the kth segment, as shown in 
                           Fig. 11. The tube segment is subject to a resistive force F
                           1(k, t) and a swallow force F
                           
                              s
                           (k, t) at time t. The resistive force counteracts tube insertion, whereas the swallow force facilitates its advancement down to the passage. Here, F
                           
                              s
                           (k, t) is modelled as a force due to the compression pressure P(k, t) created between the kth tube segment and the surrounding tissues in the nasogastric passage during swallowing. The insertion force F(k, t) applied to the kth tube segment at time t is then given by
                              
                                 (7)
                                 
                                    F
                                    
                                       (
                                       
                                          k
                                          ,
                                          t
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          F
                                       
                                       
                                          s
                                       
                                    
                                    
                                       (
                                       
                                          k
                                          ,
                                          t
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          k
                                          ,
                                          t
                                       
                                       )
                                    
                                    =
                                    μ
                                    ×
                                    2
                                    π
                                    R
                                    l
                                    ×
                                    P
                                    
                                       (
                                       
                                          k
                                          ,
                                          t
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          k
                                          ,
                                          t
                                       
                                       )
                                    
                                    ,
                                 
                              
                           where µ is the friction coefficient, R is the tube radius, and l is the length of the tube segment. Thus, the total insertion force F(t) at time t is obtained by summing the contribution of the swallow force exerted on each tube segment as follows,
                              
                                 (8)
                                 
                                    F
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    [
                                    μ
                                    ×
                                    2
                                    π
                                    R
                                    l
                                    ×
                                    P
                                    
                                       (
                                       
                                          k
                                          ,
                                          t
                                       
                                       )
                                    
                                    −
                                    
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          k
                                          ,
                                          t
                                       
                                       )
                                    
                                    ]
                                    =
                                    μ
                                    ×
                                    2
                                    π
                                    R
                                    L
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          P
                                          
                                             (
                                             
                                                k
                                                ,
                                                t
                                             
                                             )
                                          
                                       
                                       n
                                    
                                    −
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          k
                                          ,
                                          t
                                       
                                       )
                                    
                                    ,
                                    =
                                    u
                                    ×
                                    2
                                    π
                                    R
                                    L
                                    ×
                                    
                                       P
                                       ¯
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    −
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                 
                              
                           where L is the length of the part of the NGT being inserted into the nasogatric pasage; n is the number of tube segments; 
                              
                                 P
                                 ¯
                              
                              
                                 (
                                 t
                                 )
                              
                            is the average compression pressure on the tube at time t, approximated by making reference to the results from the simulation of swallowing jelly [38]; and F
                           1(t) is the resistive force at time t, pre-computed offline based on the non-linear FEM.

An NGT is a flexible hollow tube made of soft polyvinyl chloride material. It may be buckled upon insertion through the nostril, depending on the force applied and the direction of the insertion force. The buckling effect on the part of the NGT right outside the nostril is simulated in the proposed system. Refer to 
                           Fig. 12. Suppose the tube is inserted from right to left into the nostril. A sliding element is used to model the tube-nostril interactions where the tube is constrained to advance through the nostril. The insertion force 
                              F
                            exerted on the NGT is decomposed into the axial force 
                              F
                           
                           
                              a
                            and the radial force 
                              F
                           
                           
                              
                                 r
                              
                           . The moment 
                              M
                            created by the radial force may bend the tube. If the axial force 
                              F
                           
                           
                              a
                            is larger than the critical buckling load 
                              F
                           
                           
                              c
                            
                           [39], the NGT will be buckled. The critical buckling load 
                              F
                           
                           
                              c
                            is given by
                              
                                 (9)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                π
                                             
                                             2
                                          
                                          E
                                          I
                                       
                                       
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   0
                                                
                                             
                                             2
                                          
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                M
                                             
                                             2
                                          
                                       
                                       
                                          4
                                          E
                                          I
                                       
                                    
                                    ,
                                 
                              
                           where E is the Young’s modulus of the tube that is set to 1.5MPa in the proposed system; l
                           0 is the length of that part of the tube from the entrance of nostril to the position where the insertion force is applied; M is the bending moment (i.e., 
                              
                                 
                                    F
                                 
                                 
                                    r
                                 
                              
                              ×
                              
                                 
                                    l
                                 
                                 
                                    0
                                 
                              
                              )
                           . I is the area moment of inertia, which is given by
                              
                                 (10)
                                 
                                    I
                                    =
                                    
                                       
                                          π
                                          
                                             (
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      o
                                                   
                                                   
                                                      4
                                                   
                                                
                                                −
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       2
                                    
                                    ,
                                 
                              
                           where D
                           
                              i
                            and D
                           
                              o
                            are the inner and outer diameter of the NGT, set to 2.1mm and 2.9mm respectively in the proposed system. The insertion force during tube buckling is given by the buckling F
                           
                              b
                           , which is computed in real time using a simple spring-damper model as follows,
                              
                                 (11)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    a
                                    D
                                    −
                                    b
                                    V
                                    ,
                                 
                              
                           where a and b are constants, and D and V are the displacement and velocity of the NGT at buckling.

In summary, the proposed system simulates NGT insertion forces by a hybridized approach that models the forces dynamically depending on the temporal location of the tube inside the nasogastric passage (i.e., depending on which anatomical parts that the tube has reached), the user’s action (i.e., the position, orientation and speed of the haptic interface manipulating the virtual NGT), and the virtual patient’s action (i.e., swallowing). The insertion force F simulated by the hybrid model under different scenarios is summarized in 
                           Table 2. Accordingly, appropriate feedback forces are generated on the fly based on the temporal insertion conditions, which can be presented using the flowchart shown in 
                           Fig. 13. As shown in the figure, a state machine is used to model the transitions between the states where static and dynamic friction come into effect respectively, namely the static state and the dynamic state, depending on the insertion conditions. The transition to a static state occurs when V<δ, whereas the transition to the dynamic state takes place when F>F
                           
                              m
                           .

The proposed approach discussed in the previous section has been implemented to develop a virtual NGT placement training simulator. The overall system framework is shown in 
                     Fig. 14. It is implemented on a personal computer with an Intel Core i7-2600 3.4GHz CPU and 4GB RAM, and running Microsoft Windows 7. The graphics and haptic rendering are programmed using C++, the offline simulation is implemented with the simulation package Artisynth, and the graphical user interface (GUI) is built with C#. The communication between the graphics and the haptic simulation is achieved with the TCP/IP socket protocol.

The training simulator is equipped with the Phantom Desktop haptic device (Sensable Technologies Inc.) to provide 6 degrees-of-freedom (dof) input and 3 dof output. The 6 dof input refers to the position of the stylus of the haptic device with respect to the 3 coordinate axes and the rotation around the three axes. The 3 dof output is the force vector generated by the haptic device.

The simulator comes with GUI to provide visual feedback in response to the user’s input via the haptic device or the standard input/output devices (i.e., a keyboard or mouse). As shown in Fig. 16, the GUI contains two main panels. The right panel shows the side view of the virtual patient graphically, together with a virtual hand holding the NGT. They are animated interactively depending on the user’s input and the manipulation of the stylus. The front view of the virtual patient is also shown in the inset of the right panel. The position of the virtual hand is controlled by the haptic stylus, which directs the hand to hold the tube in the virtual environment as if the user were holding a real tube (
                        
                        Fig. 15). In addition, there is a button on the stylus, which is used to emulate the grabbing of the tube. The button is pressed to signify to the simulator that the virtual tube is being grabbed and that the user is ready to insert the tube through the nostril. Depending on the conditions of insertion, the system calculates the corresponding insertion force and drives the haptic stylus accordingly to transfer the force to the user’s hand. After the tube is advanced for a certain length at the end of an insertion stroke, the button is released to signify to the simulator that the insertion has been completed and that it is ready for the user to perform the next stroke. That is to say, during the NGT insertion process, the user would repeatedly press and release the button to mimic the grabbing and release of the NGT to simulate tube advancement through the making of multiple insertion strokes.

The left panel of the GUI consists of three vertically arranged sub-panels. The top sub-panel lists the general procedures of NGT placement, serving as a pre-training review for the user. A button is also provided to invoke the virtual patient to swallow. The middle sub-panel is a 2D schematic diagram showing an anatomical map on which the NGT being inserted into the virtual patient’s body is displayed interactively in real time. This enables the user to visualize the location that the tube has reached. The bottom sub-panel plots the insertion force applied over time.

Two modes of practice are available from the VR simulator, namely, the training mode and the evaluation mode. In the training mode, both panels are displayed with the left panel provided to assist the user. In the evaluation mode, the left panel is turned off and only the right panel is shown. In both cases, performance data during the virtual NGT placement process are recorded and saved into the database.

Quantitative metrics are available from the proposed training simulator to assess user performance during the virtual NGT placement process. These metrics include the completion time, the mean and maximum insertion forces applied, the number of insertion strokes made, and the number of times that the tube has buckled. In addition to these numerical data, since the simulator records the insertion force and speed in real time, their variations over time can be presented graphically to enable a detailed analysis of the placement performance. Examples of the graphs are shown in 
                        Fig. 17. Furthermore, the variation in force and speed can be plotted against the insertion depth, as shown in 
                        Fig. 18. The plots can be used to identify at which parts of the nasogastric passage the user had applied a large force, or at which locations the insertion had encountered a relatively stronger obstruction. The insertion force applied and the speed of insertion can also be analysed by visualizing their distributions during the entire virtual NGT placement process (see 
                        Fig. 19). These quantitative data can be used for an objective performance evaluation of the NGT placement.

@&#DISCUSSION@&#

The proposed NGT training simulator is an endeavour to modernize clinical nursing education by applying VR technology. Similar applications in nursing are relatively limited when compared to the proliferation of VR-based innovations in medicine. The technology is promising for use in clinical education, in that it is able to provide a safe, flexible, controlled and motivating environment for teaching and learning. Quantitative metrics are also available to enable evaluations of objective performance and to complement conventional clinical assessments that are usually based on the judgement of instructors.

While the geometrical models of the nasogastric passage in this study are created with reference to human anatomy using computer-aided design tools, the realism of the models can be further enhanced by employing medical scanning data produced from real human anatomy, e.g., visible human datasets. The surface geometry of the anatomical parts can be generated semi-automatically using iso-surface extraction algorithms like marching cubes. With sub-millimetre resolution of each voxel, high-quality 3D models for individual parts can be obtained based on the segmented datasets.

Like other VR applications, meeting the requirements of simulation realism and speed are two conflicting factors challenging the development of the NGT training simulator. In the study, real-time interactive performance is achieved by pre-computation through offline simulation. The computation complexity is further reduced by assuming that the nasogastric passage is relatively rigid when compared with the flexibility of the NGT. The validity of this assumption could be investigated by benchmarking against the sophisticated simulation that takes into account the deformation of the nasogastric passage during NGT insertion. However, this, in turn, becomes another challenge in that, since the passage is composed of heterogeneous materials of different mechanical properties, the setting of the physical parameters of these materials and the definition of the boundary conditions remain an issue.

In the proposed system, physics-based approaches were used to simulate the insertion force. To assess the level of haptic realism achieved by the simulator verification, it would be best to verify this level by making a comparison with the actual insertion force applied during a real NGT placement. However, in practical terms the in-situ measurement of insertion forces is difficult. In this study, verification was performed by capitalizing the expert knowledge of advanced practice nurses and academics in nursing therapeutics. They were invited to take part in trials on the simulator that was developed, in order to compare the computer-generated forces with the forces that they are used to perceiving in real NGT placements. The nurses reckoned that the synthesized forces were similar to the real forces. In fact, the model parameters of the simulators were tuned iteratively and interactively according to the comments of the nursing professionals. The parameters include k and β for the static friction force model in Eq. (3), and λ for the friction force model in Eq. (5).

In practice, when the insertion of NGT is obstructed, nurses may rotate the tube in an attempt to further advance the tube. Since the haptic device employed in this study can only provide a 3 dof force output, it not possible to simulate the torque generated during the rotation of the tube. Other types of haptic devices will be explored to model tube rotation and simulate the effect of torque on NGT insertions.

Currently, the VR training system only simulates normal NGT insertion conditions and successful placements. To facilitate clinical teaching and its implementation in problem-based learning, it is beneficial for the system to simulate unsuccessful or difficult cases, e.g., tube placements for children or unconscious people who cannot respond to instructions such as swallowing or flexing the neck, which may increase the risk of the tube being inserted into the trachea. With this feature, trainees can then polish the skills involved in NGT insertion and practise clinical decision making under different situations. In addition, the realism of the VR training system can be further improved by simulating a patient’s response to NGT placement, such as gagging, or over-reactions due to intubation-induced discomfort, such as pushing back. This can be achieved by animating the virtual patient’s body movements and by simultaneously playing sound clips associated with the reactions.

In the present system, the haptic device and the computer screen were placed side-by-side on a desktop, which is unlike the setting in a real NGT placement. Here, an immersive workbench can be adopted so that the haptic device can be put directly under a semi-transparent mirror on top of which the graphics are projected. With this configuration, the haptic device and thus the user’s hand can be aligned with the graphics depicting the virtual environment on top of the haptic device. Moreover, 3D stereovision with goggles can be realized in such a configuration to enhance the realism of the simulation.

The virtual NGT simulator is a tool that is used in an attempt to facilitate the learning of NGT placement. It is hypothesized that practising in a virtual environment will equip trainees with manual skills that are transferrable to real NGT placements. To confirm this hypothesis, more work will be conducted in the future to evaluate the effectiveness of the transfer of skills acquired from virtuality to reality. A two-group pre-post test design will be adopted to investigate the competency of NGT insertion techniques between nursing students who have received conventional clinical training with those who have had further training using the proposed VR-based simulator. The standard Objective Structured Clinical Assessment (OSCA) [40], used in conventional clinical education, will be employed to measure and compare the performance of the students before and after the placement training to evaluate the effectiveness of the virtual training.

@&#CONCLUSION@&#

The paper presents a VR-based training simulation system that was developed to enhance the learning of NGT placement skills. In the system, a hybrid force model is proposed to generate the forces perceived during an NGT placement. In addition to the modelling of static and dynamic friction, forces due to swallowing and tube buckling are also simulated. Pre-computation via offline simulation is adopted to enable real-time computations. The tube’s position inside the body is visualized to facilitate cognitive and procedural training in the blind process. Furthermore, the virtual training is logged with quantitative data and metrics for performance evaluations.

The proposed VR simulator is a first attempt to leverage VR technology for experiential clinical training in a risk-free, low-cost, and flexible virtual environment. It has been positively evaluated by nursing professionals, who have stated that the computer-generated forces are similar to those perceived in real NGT placements. The functionalities and features of the system will be further enhanced based on the findings obtained in this study. Nursing experts will be involved in evaluating the usability of the virtual NGT insertion simulation system [41]. Surveys concerning the accuracy and latency of the simulations, the perceived ease of use and usefulness of the system [42], user satisfaction, and the level of virtual realism achieved will be conducted using psychometric questionnaires and structured interviews. The feedback that is collected will be referenced to further improve the system. The training effectiveness of the proposed simulator will be evaluated by comparing the competence of NGT insertions conducted by nursing students who have received conventional training with that of students who have in addition received training in the proposed system. The results will be help to support the adoption of the proposed system in medical and nursing curricula.

Future work will also be conducted to develop a simplified modelling approach by constructing an empirical model using fuzzy logic to leverage the kinaesthetic experience of expert nurses in real NGT placements to produce the intubation forces under different conditions.

None declared.

@&#ACKNOWLEDGEMENTS@&#

This work was supported in part by the Research Grants Council of the Hong Kong SAR (PolyU5134/12E), the Hong Kong Polytechnic University (G-UC93), the National Natural Science Foundation of China (under Grant no. 61170122), and the Ministry of Education program for New Century Excellent Talents (NCET-120882).

@&#REFERENCES@&#

