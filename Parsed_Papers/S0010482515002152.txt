@&#MAIN-TITLE@&#Modeling left and right atrial contributions to the ECG: A dipole-current source approach

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We used a model of the atria and torso to compute ECG from dipole-current sources.


                        
                        
                           
                           We simulated the separate contributions of the left and right atria to the ECG.


                        
                        
                           
                           The approach helped relate the P wave morphology to atrial anatomy.


                        
                        
                           
                           Atrial fibrillation simulations emphasized the role of each atrium on ECG waveforms.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Computer modeling

Cardiac electrophysiology

Left and right atria

Electrocardiogram

P wave

Dipole source

Atrial fibrillation

@&#ABSTRACT@&#


               
               
                  This paper presents the mathematical formulation, the numerical validation and several illustrations of a forward-modeling approach based on dipole-current sources to compute the contribution of a part of the heart to the electrocardiogram (ECG). Clinically relevant applications include identifying in the ECG the contributions from the right and the left atrium. In a Courtemanche-based monodomain computer model of the atria and torso, 1000 dipoles distributed throughout the atrial mid-myocardium are found to be sufficient to reproduce body surface potential maps with a relative error 
                        <
                        1
                        %
                      during both sinus rhythm and atrial fibrillation. When the boundary element method is applied to solve the forward problem, this approach enables fast offline computation of the ECG contribution of any anatomical part of the atria by applying the principle of superposition to the dipole sources. In the presence of a right–left activation delay (sinus rhythm), pulmonary vein isolation (sinus rhythm) or left–right differences in refractory period (atrial fibrillation), the decomposition of the ECG is shown to help interpret ECG morphology in relation to the atrial substrate. These tools provide a theoretical basis for a deeper understanding of the genesis of the P wave or fibrillatory waves in normal and pathological cases.
               
            

@&#INTRODUCTION@&#

Electrocardiograms (ECG) remain the most common diagnostic technique in cardiology. These bioelectric signals receive contributions from all parts of the heart due to the spatial filtering effect of the torso volume conductor. In the ECG, the P wave (depolarization of the atria) is well separated from the QRS complex (depolarization of the ventricles) thanks to the delay caused by the atrioventricular node. In contrast, within the P wave, the contributions of different anatomical parts of the atria (e.g. left and right atria) overlap because cells in different parts of the atria depolarize simultaneously. The ability to separate these contributions would be desirable in the presence of left–right atrial gradient, when structural remodeling or a therapy (e.g. catheter ablation) affects a specific region, or when the dynamical regime is not uniform (e.g. stable rotor at some location and fibrillatory conduction in the rest of the tissue).

In experiments, it is possible to isolate or cut a piece of tissue to measure the activity generated by the rest of the tissue. However, cutting a piece of tissue generally affects the propagation pattern in the rest of the tissue. The situation is even worse during an arrhythmia since this lesion may be pro- or antiarrhythmic. In computer models, the decomposition of the ECG into a sum of signals generated by the sources located in different anatomical regions (e.g. left and right atria) is straightforward when the bioelectric sources are expressed as current dipoles, as demonstrated below. While P waves are routinely simulated in computer models [1–6], only the signal representing the global atrial activity is generally computed since it can be compared to its clinical counterpart.

In this paper, we formulate and validate the current-dipole approach in the context of a biophysical model of the atria during sinus rhythm and atrial fibrillation. We surmise that this tool will help better understand and interpret the genesis of the P wave and fibrillatory waves in relation to atrial anatomy.

@&#METHODS@&#

In an unbounded uniform isotropic volume conduction medium with conductivity σ
                        
                           e
                         in which an impressed current density 
                           
                              
                                 j
                              
                              
                                 src
                              
                           
                         is created by the biological sources located in the domain Ω
                        
                           src
                        , the extracellular potential 
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                              
                                 ∞
                              
                           
                         at an observation point 
                           
                              
                                 x
                              
                              
                                 obs
                              
                           
                         is given by a volume integral over the sources [7]:
                           
                              (1)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       e
                                    
                                    
                                       ∞
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       obs
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       4
                                       π
                                       
                                          
                                             σ
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             src
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             src
                                          
                                       
                                    
                                    
                                       ∥
                                       
                                          
                                             x
                                          
                                          
                                             obs
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             src
                                          
                                       
                                       ∥
                                    
                                 
                                 
                                 d
                                 V
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       src
                                    
                                 
                                 )
                                 ,
                              
                           
                        where the impressed volume current density is defined as 
                           
                              
                                 I
                              
                              
                                 src
                              
                           
                           =
                           −
                           ∇
                           ·
                           
                              
                                 j
                              
                              
                                 src
                              
                           
                        . This formula expresses the potential as a superposition of monopolar fields.

After application of the divergence theorem, the potential can be equivalently expressed as a superposition of dipolar fields
                           
                              (2)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       e
                                    
                                    
                                       ∞
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       obs
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       4
                                       π
                                       
                                          
                                             σ
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             src
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             j
                                          
                                          
                                             src
                                          
                                       
                                       ·
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             obs
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             src
                                          
                                       
                                       )
                                    
                                    
                                       ∥
                                       
                                          
                                             x
                                          
                                          
                                             obs
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             src
                                          
                                       
                                       
                                          
                                             ∥
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                 d
                                 V
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       src
                                    
                                 
                                 )
                                 .
                              
                           
                        Note that the derivation uses the fact that the normal component of the impressed current density is zero on the boundary of Ω
                        
                           src
                        , i.e. 
                           
                              
                                 j
                              
                              
                                 src
                              
                           
                           ·
                           n
                           =
                           0
                        .

When the sources are computed using a monodomain model of electrical propagation, the impressed current density is obtained by [7]
                        
                           
                              (3)
                              
                                 
                                    
                                       j
                                    
                                    
                                       src
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       σ
                                    
                                    
                                       m
                                    
                                 
                                 ∇
                                 
                                    
                                       V
                                    
                                    
                                       m
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 σ
                              
                              
                                 m
                              
                           
                         is the effective tissue conductivity tensor and V
                        
                           m
                         is the transmembrane potential. Similarly,
                           
                              (4)
                              
                                 
                                    
                                       I
                                    
                                    
                                       src
                                    
                                 
                                 =
                                 ∇
                                 ·
                                 
                                    
                                       σ
                                    
                                    
                                       m
                                    
                                 
                                 ∇
                                 
                                    
                                       V
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 β
                                 
                                    
                                       I
                                    
                                    
                                       m
                                    
                                 
                                 ,
                              
                           
                        where I
                        
                           m
                         is the membrane current per unit membrane area and β is the cellular surface-to-volume ratio.

The contribution of a sub-domain Ω⊂Ω
                        src to the extracellular potential 
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                              
                                 ∞
                              
                           
                        , denoted by 
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                              
                                 ∞
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 obs
                              
                           
                           ;
                           Ω
                           )
                        , is defined as the potential generated by all the sources located within Ω, including the current flowing out of the boundary 
                           ∂
                           Ω
                        . Indeed, if the sub-domain Ω was cut from the rest of the tissue, a current 
                           
                              
                                 j
                              
                              
                                 src
                              
                           
                           ·
                           n
                         would have to leave the tissue and flow into the extracellular domain in order to maintain the same electrical activity in Ω. At the tissue boundary this current vanishes (since 
                           
                              
                                 σ
                              
                              
                                 m
                              
                           
                           ∇
                           
                              
                                 V
                              
                              
                                 m
                              
                           
                           ·
                           n
                           =
                           0
                         in the monodomain framework), but at the interface between Ω and the rest of the cardiac tissue, non-zero current may flow. As a result, the potential field 
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                              
                                 ∞
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 obs
                              
                           
                           ;
                           Ω
                           )
                        , or 
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                              
                                 ∞
                              
                           
                           (
                           Ω
                           )
                         in abbreviated notation, is computed as
                           
                              (5)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       e
                                    
                                    
                                       ∞
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       obs
                                    
                                 
                                 ;
                                 Ω
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       4
                                       π
                                       
                                          
                                             σ
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             src
                                          
                                       
                                    
                                    
                                       ∥
                                       
                                          
                                             x
                                          
                                          
                                             obs
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             src
                                          
                                       
                                       ∥
                                    
                                 
                                 
                                 d
                                 V
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       src
                                    
                                 
                                 )
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       4
                                       π
                                       
                                          
                                             σ
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       ∂
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          
                                             j
                                          
                                          
                                             src
                                          
                                       
                                       ·
                                       n
                                    
                                    
                                       ∥
                                       
                                          
                                             x
                                          
                                          
                                             obs
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             src
                                          
                                       
                                       ∥
                                    
                                 
                                 
                                 d
                                 S
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       src
                                    
                                 
                                 )
                              
                           
                        After application of the divergence theorem to the first term, the surface integrals cancel each other, leading to the dipolar formulation:
                           
                              (6)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       e
                                    
                                    
                                       ∞
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       obs
                                    
                                 
                                 ;
                                 Ω
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       4
                                       π
                                       
                                          
                                             σ
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          
                                             j
                                          
                                          
                                             src
                                          
                                       
                                       ·
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             obs
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             src
                                          
                                       
                                       )
                                    
                                    
                                       ‖
                                       
                                          
                                             x
                                          
                                          
                                             obs
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             src
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                 d
                                 V
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       src
                                    
                                 
                                 )
                                 .
                              
                           
                        Although I
                        
                           src
                         is sufficient to compute 
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                              
                                 ∞
                              
                           
                        , the current 
                           
                              
                                 j
                              
                              
                                 src
                              
                           
                         is also needed to compute 
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                              
                                 ∞
                              
                           
                           (
                           Ω
                           )
                        .

The dipolar nature of the field 
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                              
                                 ∞
                              
                           
                           (
                           Ω
                           )
                         is a consequence of current conservation within a cell. The intracellular potential ϕ
                        
                           i
                         satisfies 
                           ∇
                           ·
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                           ∇
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           =
                           0
                         within a cell (σ
                        
                           i
                        =intracellular conductivity), with the boundary condition 
                           −
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                           ∇
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           ·
                           n
                           =
                           
                              
                                 I
                              
                              
                                 m
                              
                           
                         on the cell membrane [8]. Thus, the sum of all membrane currents 
                           
                              
                                 ∫
                              
                              
                                 S
                              
                           
                           
                              
                                 I
                              
                              
                                 m
                              
                           
                           d
                           S
                           =
                           −
                           
                              
                                 ∫
                              
                              
                                 S
                              
                           
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                           ∇
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           ·
                           d
                           S
                           =
                           −
                           
                              
                                 ∫
                              
                              
                                 V
                              
                           
                           ∇
                           ·
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                           ∇
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           d
                           V
                           =
                           0
                        , so the monopolar component is zero.

The extracellular potential ϕ
                        
                           e
                         generated by the sources in an inhomogeneous bounded medium (such as a torso model taking into account the conductivity of lungs and blood cavities) can be expressed as a function of the extracellular potential field 
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                              
                                 ∞
                              
                           
                         in a bounded homogeneous medium, i.e. 
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                           
                           =
                           L
                           
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                              
                                 ∞
                              
                           
                        , where the linear operator 
                           L
                         depends only on geometry and volume conduction properties [7,1,2]. The same operator can be used to compute 
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                           
                           (
                           Ω
                           )
                         as 
                           L
                           
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                              
                                 ∞
                              
                           
                           (
                           Ω
                           )
                        .

For numerical computations, the domain Ω
                        
                           src
                         is partitioned into n sub-domains Ω
                        
                           k
                        , 
                           k
                           =
                           1
                           ,
                           …
                           ,
                           n
                        , and the formula (2) can be discretized as
                           
                              (7)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       e
                                    
                                    
                                       ∞
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       obs
                                    
                                 
                                 )
                                 ≈
                                 
                                    
                                       1
                                    
                                    
                                       4
                                       π
                                       
                                          
                                             σ
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             obs
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             G
                                          
                                       
                                       (
                                       
                                          
                                             Ω
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       ‖
                                       
                                          
                                             x
                                          
                                          
                                             obs
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             G
                                          
                                       
                                       (
                                       
                                          
                                             Ω
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       
                                          
                                             ‖
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       j
                                    
                                    
                                       src
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 x
                              
                              
                                 G
                              
                           
                           (
                           
                              
                                 Ω
                              
                              
                                 k
                              
                           
                           )
                         is the center of gravity (or a representative point) of the domain Ω
                        
                           k
                         and
                           
                              (8)
                              
                                 
                                    
                                       j
                                    
                                    
                                       src
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       j
                                    
                                    
                                       src
                                    
                                 
                                 
                                 d
                                 V
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       src
                                    
                                 
                                 )
                              
                           
                        Note that as long as the sources (e.g. monodomain model) are computed on a fine grid is summed up using (8), the sub-domains Ω
                        
                           k
                         used for extracellular potential may be larger than the space step [9].

The contribution of a sub-domain Ω to the potential is reconstructed by the superposition principle:
                           
                              (9)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       e
                                    
                                    
                                       ∞
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       obs
                                    
                                 
                                 ;
                                 Ω
                                 )
                                 ≈
                                 
                                    
                                       1
                                    
                                    
                                       4
                                       π
                                       
                                          
                                             σ
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          
                                          :
                                          
                                          
                                             
                                                x
                                             
                                             
                                                G
                                             
                                          
                                          (
                                          
                                             
                                                Ω
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             obs
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             G
                                          
                                       
                                       (
                                       
                                          
                                             Ω
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       ‖
                                       
                                          
                                             x
                                          
                                          
                                             obs
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             G
                                          
                                       
                                       (
                                       
                                          
                                             Ω
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       
                                          
                                             ‖
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       j
                                    
                                    
                                       src
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

Finally, to compute the potential in a bounded inhomogeneous medium, the operator 
                           L
                         is discretized using the boundary element method applied to a torso model where the body surface, the lungs and the atrial and ventricular blood cavities are represented as triangulated surfaces [1,2].

If the mesh of the torso has n
                        
                           L
                         nodes (L for leads) and potentials are computed at n
                        
                           t
                         time instants, the extracellular potential ϕ
                        
                           e
                         is represented by an n
                        
                           t
                        -by-n
                        
                           L
                         matrix and 
                           
                              
                                 j
                              
                              
                                 src
                              
                           
                         by an n
                        
                           t
                        -by-
                           3
                           n
                         matrix (3 components for each of the n nodes). These two matrices are related through a 
                           3
                           n
                        -by-n
                        
                           L
                         transfer matrix that can be precomputed from (9) and the discretized version of 
                           L
                        .

In order to illustrate the applications of computing the contribution of a sub-domain to the ECG, a model of the heart and torso was used (Fig. 1
                        A). The geometry was derived from an imaging dataset of a patient with AF [10] and included the atria, atrial and ventricular blood cavities, the lungs and the torso. The atrial model (Fig. 1B) incorporated rule-based fiber orientation [11] and a simplified fast conducting system (Bachmann׳s bundle, crista terminalis, and pectinate muscles) [12]. A cubic mesh of the atria was constructed at a resolution of 330 μm. Propagation of the electrical impulse was computed using the monodomain equation [7] with a capacitance of C
                        
                           m
                        =1 μF/cm2 and a surface-to-volume ratio of 
                           β
                           =
                           2000
                           
                           
                              
                                 cm
                              
                              
                                 −
                                 1
                              
                           
                         . Membrane kinetics was described by the Courtemanche model [13] with the conductance of the L-type calcium current g
                        
                           CaL
                         reduced by 50%. This modification associated with electrical remodeling led to triangular-shaped action potentials [14] with an effective refractory period of about 225ms and a relatively flat restitution. As a result, the atrial T wave had a smaller, more realistic amplitude than the original Courtemanche model, which enabled us to focus on the P wave.

The reaction-diffusion system was solved using an operator-splitting scheme based on finite differences with a time step of 12.5μs [15]. The baseline tissue conductivity was set to 9mS/cm2 (longitudinal) and 3mS/cm2 (transverse) in the working myocardium. The longitudinal conductivity was increased to 12mS/cm2 in the fast conducting system. Normal propagation was initiated by injecting intracellular current in the region of the sino-atrial node. The resulting propagation velocity was 
                           80
                           ±
                           17
                           
                           cm
                           /
                           s
                         during sinus rhythm. In addition to the control case, three conditions were simulated: (1) delayed left atrial activation; (2) pulmonary vein isolation; and (3) atrial fibrillation.

Left–right connections were altered by removing the Bachmann׳s bundle (conductivity set to zero; Fig. 1C) and reducing the conductivity to 1mS/cm2 in the septal region, including a band of about 5mm wide on both side of the septum.

Pulmonary vein isolation was simulated by creating transmural lines around each pulmonary vein (Fig. 1D). Conductivity was set to zero in these lines.

For the simulation of atrial fibrillation episodes, g
                        
                           CaL
                         was further reduced to 20% of its original value in the left atrium, thus creating a left–right gradient in refractoriness. This condition was meant to provide an example of atrial fibrillation dynamics characterized by different atrial rates in the left and the right atria, as observed in clinical studies [16]. The value of g
                        
                           CaL
                         was chosen to generate atrial frequencies similar to clinical measurements (see Results section). The effective refractory period in the left atrium was about 160ms. Longitudinal/transverse conductivities were set to 4mS/cm2 (longitudinal) and 1mS/cm2 to simulate slower conduction caused by structural remodeling and shorten the wavelength to sustain the reentries. In this substrate, conduction velocity was 
                           46
                           ±
                           12
                           
                           cm
                           /
                           s
                         during normal propagation. Fibrillatory activity was induced by creating a customized initial condition with two functional reentries, one in the pulmonary vein region and one in the right atrium free wall so that they would rotate at different frequencies [17,18].

A set of n=5622 points 
                           {
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           }
                         were uniformly distributed over the atrial surface at the midpoint of atrial wall thickness. A triangular mesh was constructed from these points. The sub-domain Ω
                        
                           k
                        , 
                           k
                           =
                           1
                           ,
                           …
                           n
                        , was defined as the set of nodes from the cubic atrial mesh that were closest to the point 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                        .

In each of the simulations, the current source 
                           
                              
                                 j
                              
                              
                                 src
                              
                           
                           =
                           −
                           
                              
                                 σ
                              
                              
                                 m
                              
                           
                           ∇
                           
                              
                                 V
                              
                              
                                 m
                              
                           
                         was computed each 1ms at all the nodes, summed up in each region Ω
                        
                           k
                         according to (8), and saved in a file. ECG was computed by multiplying the stored 
                           
                              
                                 j
                              
                              
                                 src
                              
                           
                         matrix by the transfer matrix. The contribution of a sub-domain Ω to the ECG was computed by setting to zero the columns of 
                           
                              
                                 j
                              
                              
                                 src
                              
                           
                         that do not correspond to points 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                         within Ω, and then by multiplying that modified source matrix by the transfer matrix.

@&#RESULTS@&#

The activation map during sinus rhythm in the control case is shown in Fig. 1B. Activation time was 132ms. The activation pattern has been previously compared to clinical data and other computer models [10,2]. After left–right conduction delay was introduced (Fig. 1C), the activation time was increased to 168ms. Pulmonary vein isolation (Fig. 1D) did not significantly increase the activation time (136ms). However, the activation sequence was slightly modified in the left atrium and the isolated region did not activate at all.

Simulated atrial fibrillation was observed in this substrate as a stable rotor in the pulmonary vein region and fibrillatory conduction in the right atrium driven by the rotor (Fig. 1E). Left–right repolarization gradient resulted in left–right differences in atrial rate. The cycle length was shorter and more regular in the left atrium (
                           169.4
                           ±
                           7.5
                           
                           ms
                           
                           vs
                           
                           243.8
                           ±
                           18.1
                           
                           ms
                        ). The corresponding dominant frequencies (5.9Hz in the left atrium vs 4.1Hz in the right) were within the reported clinical range (
                           6.26
                           ±
                           0.8
                           
                           Hz
                           
                           vs
                           
                           4.56
                           ±
                           0.7
                           
                           Hz
                         in Swartz et al. [19]).

The current-dipole source approach for computing ECGs has been validated and extensively used in the past [20,21]. Our objective here is to determine how many dipoles are needed to accurately describe atrial activity during sinus rhythm and atrial fibrillation. The mesh with 5622 dipoles was used as a reference. The body surface potential maps formed an n
                        
                           t
                        -by-n
                        
                           L
                         matrix denoted by ϕ
                        
                           e
                        
                        
                           ref
                        . Then, the number of dipoles was iteratively reduced by collapsing the shortest edge of the triangular mesh to form a new node (a process known as mesh decimation [22]), thus typically reducing mesh size by one node, one edge and two triangles. The dipole at the new node was defined as the sum of the dipoles at the extremities of the collapsed edge. The resulting mesh is shown in Fig. 2
                         at three different stages in the process.

At each iteration, i.e. for decreasing numbers of dipoles, ECGs were computed and expressed as an n
                        
                           t
                        -by-n
                        
                           L
                         matrix ϕ
                        
                           e
                        
                        
                           n
                        , where n is the number of dipoles. Since the mesh eventually collapsed to a single point, dipole locations ended up within blood cavities. Homogeneous torso conductivity was used (for Fig. 2 only) to avoid numerical problems since the boundary element method assumes that the sources are outside blood cavities. The error was computed as the residual difference
                           
                              (10)
                              
                                 rd
                                 (
                                 n
                                 )
                                 =
                                 
                                    
                                       ‖
                                       
                                          
                                             ϕ
                                          
                                          
                                             e
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       
                                          
                                             ϕ
                                          
                                          
                                             e
                                          
                                          
                                             ref
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             F
                                          
                                       
                                    
                                    
                                       ‖
                                       
                                          
                                             ϕ
                                          
                                          
                                             e
                                          
                                          
                                             ref
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             F
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           ‖
                           ·
                           
                              
                                 ‖
                              
                              
                                 F
                              
                           
                         is the Frobenius norm.


                        Fig. 2 displays the residual difference as a function of the number of dipoles. The residual difference lay within the range 0.2–0.5 for less than 10 dipoles and became 
                           <
                           0.01
                         above 1000 dipoles. The error was larger during atrial fibrillation as compared to sinus rhythm, indicating that a larger number of dipoles are needed to represent the higher spatial complexity of atrial fibrillation.

The atrial geometry was partitioned into the left and right atria, the septal region being considered as a part of the right atrium. The contribution of the left and right atria to the P wave during sinus rhythm was computed separately using (9) and the boundary element method.


                        Fig. 3
                        A shows the P waves on precordial leads as well as their decomposition into a left and a right atrial contribution. The amplitude of the right contribution decreased from V1 to V6, while the left contribution was delayed, changed polarity and became increasingly positive from V1 to V6. This reflects the activation pattern, roughly in the posterior–frontal direction in the right atrium, and in the right–left direction in the left atrium (Fig. 1B).

In the presence of a right–left propagation delay (Fig. 1C), the right atrial contribution to the P wave was identical to the control case (Fig. 3B), while the left atrial contribution was time-shifted. This resulted in a prolongation of the P wave and a significant change in P wave morphology, particularly visible on V1.

To correctly interpret P wave morphology after pulmonary vein (PV) isolation, it is desirable to know what was the contribution of the tissue delimited by the ablation lines (hereafter, the PV region), i.e., the tissue that has been isolated (Fig. 1D). The peak-to-peak amplitude of the contribution of the PV region during sinus rhythm before ablation is shown in Fig. 4
                        A. The amplitude is maximal in the back, close to the PVs.

The P waves before and after ablation are displayed in Fig. 4B for that lead of maximal amplitude. The P wave was first decomposed into a left and a right contribution. The left contribution was then further decomposed into the contribution of the PV region and that of the rest of the left atrium. In this simulation, the changes in P wave morphology after ablation was mostly due to the lack of excitation in the PV region, and only slightly due to an altered propagation around the ablation lines. The outcome might be different with another type of ablation pattern or different conduction properties in the PV region and in the PV sleeves.


                        Fig. 5
                         shows ECGs during an atrial fibrillation episode with left/right differences in repolarization properties, with their power spectra displayed on the right panels. The disorganization of right atrial activity masked the regularity of the rotor in the left atrium. The spectra were characterized by three peaks at 3, 4.4 and 6Hz. The decomposition into left and right components established the regularity of left atrial activity and confirmed the interpretation of the two other peaks as the intrinsic frequency of the right atrium (functional reentries at 4.4Hz, for example the one depicted in Fig. 1E) and the sub-harmonic of left atrial frequency (3Hz) corresponding to a 2:1 block when fronts created by the rotor propagated to the right atrium.

The amplitude of the left atrial component was lower than that of the right atrial component. To further investigate that question, the power of the left atrial component divided by the sum of the power of the two components was computed for all leads on the torso (Fig. 6
                        B). The right component dominated, except near V3–V6 and in the back, where the two contributions were about equal. During sinus rhythm (Fig. 6A), however, the left component was more strongly present in the ECG. This suggests that the type of dynamics may influence which atrium provides the strongest contribution to a given lead.

Another representation that can be extracted from the left/right ECG decomposition is the map of correlation between left atrial and right atrial contributions (Fig. 6C). In this episode of atrial fibrillation, the correlations were weak (around 0.1), as indicated by the small overlap between the spectra (Fig. 5).

@&#DISCUSSION AND CONCLUSION@&#

The electrical activity of the atria in the torso volume conductor can be represented as a superposition of dipoles. To determine the appropriate number of dipoles, we developed a technique based on triangular mesh decimation to assess the residual difference in body surface potentials as a function of the number of dipoles. Our simulations of body surface potentials during atrial fibrillation showed that an accuracy of 1% is reached when about 1000 dipoles are used for ECG computation. If only 5% accuracy is needed and only sinus rhythm is simulated, 100 dipoles may be sufficient, which is closer to 88 dipoles used for adequately representing ventricular activity [20,21,23]. Due to the higher spatial complexity of atrial fibrillation, the residual error for a given number for dipoles was 
                           1.86
                           ±
                           0.16
                         times larger than during sinus rhythm. Equivalently, for a given accuracy, the number of dipoles needed to represent fibrillatory activity was 
                           2.44
                           ±
                           0.55
                         times higher than for sinus rhythm.

The number of dipoles chosen in this study (5622) ensures excellent accuracy while requiring reasonable storage space and computational power. Once the local dipolar moments are stored in the hard disk (3 components 
                           ×
                           
                           5622
                         dipoles per millisecond simulated), the field generated by any sub-domain of the atria can be computed offline. Since the average distance between dipoles is 2.24mm, the sub-domain can be defined at that resolution, which is sufficient for most applications.

If monopolar sources were used instead of dipoles, a much larger number of sources would be needed to achieve similar accuracy. Indeed, if the region in which the local sources are added is wider than the depolarization front, inward and outward membrane currents might cancel each other. In contrast, dipolar moments change direction later in the action potential time-course than the membrane current (typically during repolarization).

The approach tested in this paper would apply to more detailed models of the heart and torso. A higher level of structural and anatomical details or conduction heterogeneities could be incorporated [6,5,24,4,25,26], including microstructure. As long as local current sources (3) are computed at high resolution, the only approximation is on the location of dipoles, not on their dipolar moment, which has a small impact on body surface potential maps, as demonstrated in Fig. 2. A similar method of grouping monopolar current sources by blocks was successfully applied to compute fractionated electrograms in a high resolution fibrotic ventricular model [9].

In bidomain propagation models, disjoint regions (e.g. the right and the left atria) may interact through the extracellular medium. Generalization would be still straightforward since membrane potentials and current sources are available. The extracellular potentials would need to be recomputed using dipoles instead of monopolar sources (as usually done to solve the Poisson problem). But these additional computations are not required to be performed at every time step.

Only piece-wise uniform boundary-element volume conduction models were considered here. The extension to more general finite-differences or finite-elements volume conduction models [24,4] necessitates the ability to compute the field generated on the body surface by dipoles oriented in the x, y and z direction at every source location. These detailed models can better take into account extracellular anisotropy. The current-dipole approach would require solving ~17,000 Poisson problems, which is computationally expensive, but feasible, and only has to be done once when computing the transfer matrix. If only a limited number of leads are needed, the reciprocity theorem might be used to reduce the number of linear systems to be solved [7].

To accurately compute near-field potentials, e.g. electrograms, a higher density of dipole sources may be needed. A resolution of 1mm seems adequate [9]. Since these potentials are local, the relevance of determining the (presumably small) contribution of a distal region may be questionable. An exception would be identifying which microstructural heterogeneity produces a given deflection in fractionated electrograms.

This paper focuses on the forward problem. This approach is critical for designing virtual experiment in electrophysiology and testing in computer models hypotheses about the genesis of the ECG in situations involving local changes. Potential applications include investigating the changes in ECG morphology related to interatrial conduction pathways [27], interatrial blocks [28] or catheter ablation [29]. These conditions can be studied in a previously validated forward model by identifying the changes in the ECG resulting from these structural modifications. On the other hand, the inverse problem has important applications for the clinical practice. It has been however recognized that the multiple dipole approach is not ideal for solving the inverse problem [30]. Consequently, how to separate the sources from the left and the right atria remains an open question, although it could theoretically be derived from a solution to the complete inverse problem (the determination of activation maps from ECG). In any case, our model may be used to validate such source separation technique.

To illustrate the approach for computing the contribution of a sub-domain to the ECG, we decomposed P waves and fibrillatory waves into left and right atrial components (Fig. 3). These two components indeed always overlap and their relative weight depends on electrode location (Fig. 6).

In sinus rhythm, the effect of delayed conduction from the right to the left atrium on P wave morphology can be clearly demonstrated (Fig. 3B). If structural changes occurred in the right atrium, the resulting P wave would be affected both directly (different activation pattern in the right atrium) and indirectly (delayed activation of the left atrium, possibly through a different pathway). Our approach makes it possible to delineate between the two mechanisms.

The interpretation, the characterization and the classification of ECG during atrial fibrillation is a difficult problem. Signal processing tools have been developed to extract information about atrial activity, e.g. dominant frequency or degree of organization [31]. The validation of these tools is facilitated by computer modeling, since models can provide a gold standard (e.g. comparing dominant frequency on the ECG to local atrial rates) [2].

The capability to decompose the ECG into components associated with different anatomical parts of the atria further extends the applications and the relevance of computer modeling to ECG interpretation and provides a basis for a deeper understanding of the genesis of the P wave in normal and pathological cases.

None declared.

@&#ACKNOWLEDGMENTS@&#

This work was supported by the Natural Sciences and Engineering Research Council of Canada (NSERC grants (386647-2010) and RGPIN-2015-05658).

@&#REFERENCES@&#

