@&#MAIN-TITLE@&#Identification and “reverse engineering” of Pythagorean-hodograph curves

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Methods to identify whether or not given control points define a Pythagorean-hodograph (PH) curve are formulated.


                        
                        
                           
                           The methods are based on the satisfaction of control-point constraints or saturation of quadrature arc-length estimates, and apply equally to planar and spatial PH curves.


                        
                        
                           
                           For identified PH curves, algorithms to reconstruct the complex or quaternion pre-image polynomials are developed.


                        
                        
                           
                           The proposed methods allow existing CAD systems to fully exploit the advantageous properties of PH curves within the context of prevailing CAD geometry representations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Bézier control points

Pythagorean-hodograph curves

Arc length

Parametric speed

Numerical quadrature

Reverse engineering

@&#ABSTRACT@&#


               
               
                  Methods are developed to identify whether or not a given polynomial curve, specified by Bézier control points, is a Pythagorean-hodograph (PH) curve — and, if so, to reconstruct the internal algebraic structure that allows one to exploit the advantageous properties of PH curves. Two approaches to identification of PH curves are proposed. The first is based on the satisfaction of a system of algebraic constraints by the control-polygon legs, and the second uses the fact that numerical quadrature rules that are exact for polynomials of a certain maximum degree generate arc length estimates for PH curves exhibiting a sharp saturation as the number of sample points is increased. These methods are equally applicable to planar and spatial PH curves, and are fully elaborated for cubic and quintic PH curves. The reverse engineering problem involves computing the complex or quaternion coefficients of the pre-image polynomials generating planar or spatial Pythagorean hodographs, respectively, from prescribed Bézier control points. In the planar case, a simple closed-form solution is possible, but for spatial PH curves the reverse engineering problem is much more involved.
               
            

@&#INTRODUCTION@&#

The phrase “reverse engineering” typically refers to the recovery of lost design specifications for an artifact, from its physical realization. Since this endeavor inevitably incurs some loss of fidelity to the original design intent, it is always preferable to invoke original plans or CAD models when possible. There are, nevertheless, circumstances in which this is impractical, and one must appeal to a reverse engineering process to reconstruct — as faithfully as possible — the original underlying design intent of a given physical artifact.

Most modern CAD systems rely on the Bézier/B-spline representation to specify “free-form” curves and surfaces. Although this provides considerable design flexibility, and compatibility with commonly-used “simple” shapes, it necessitates the use of approximations for many basic geometrical functions, such as computation of arc lengths, offset curves, and certain rational frames on space curves. The Pythagorean-hodograph (PH) curves circumvent these problems by incorporating a special algebraic structure (Farouki, 2008), while remaining fully compatible with the standard Bézier/B-spline representation. However, to exploit the advantageous features of PH curves, their “internal structure” variables (which are not directly available from their Bézier/B-spline forms) must be known. Specifically, planar and spatial Pythagorean hodographs are constructed by quadratic mappings of complex and quaternion polynomials, respectively, and the coefficients of these pre-image polynomials are required for the exact determination of various PH curve properties.

Many methods for the construction of planar and spatial PH curves are available (Farouki et al., 2008, 2001; Farouki and Neff, 1995; Habib and Sakai, 2007; Huard et al., 2014; Jaklic et al., 2012; Jüttler and Mäurer, 1999; Jüttler, 2001; Klar and Valasek, 2011; Monterde and Ongay, 2012; Walton and Meek, 1998, 2002). The goal of this study is to facilitate their importation into commercial CAD systems through existing CAD data formats, by developing algorithms that (i) identify whether or not specified Bézier/B-spline data define a PH curve; and (ii) if so, reconstruct its “internal structure” variables. Since the polynomial PH curves are a proper subset of all polynomial curves, a randomly-chosen polynomial curve has a negligible probability of being a PH curve: the proposed methods make sense only if one has a priori reason to suspect that given data define a PH curve. Moreover, for use in “real” applications, the identification and reconstruction of PH curves must be formulated in floating-point arithmetic, and can thus be solved only within a given tolerance (which in practice can be very small). For purely academic investigations, one may consider only curves defined by rational coefficients, and invoke symbolic computation methods.

The algorithms described herein may be categorized as identification and reconstruction schemes, the latter being invoked only when the former yields an affirmative outcome. The focus will be on the polynomial PH curves, since rational PH curves lack some features of polynomial PH curves required in these methods. Also, for brevity, the input for the algorithms is assumed to be Bézier control points for a single segment, which may be readily extracted (Farouki et al., 2014) from the B-spline representation of a multi-segment spline.

The remainder of this paper is organized as follows. After a brief review of some basic properties of PH curves in Section 2, two different schemes for determining whether or not a given set of Bézier control points specify a PH curve are described in Section 3 — the method appropriate to a particular application context may be selected on the basis of computational efficiency and any desired additional information concerning an identified PH curve. The identification algorithms do not distinguish between planar and spatial PH curves, but the “reverse engineering” algorithms described in Section 4 require individual treatment of these two cases. Specifically, the hodographs for planar and spatial PH curves are generated from complex-number and quaternion “pre-image” polynomials, respectively, whose coefficients must be determined. Finally, Section 5 summarizes the key results obtained herein, and concludes with some comments on their practical use.

A degree-n polynomial curve 
                        r
                        (
                        t
                        )
                     , 
                        t
                        ∈
                        [
                        
                        0
                        ,
                        1
                        
                        ]
                      specified in terms of its Bézier control points 
                        
                           
                              p
                           
                           
                              0
                           
                        
                        ,
                        …
                        ,
                        
                           
                              p
                           
                           
                              n
                           
                        
                      as
                        
                           (1)
                           
                              r
                              (
                              t
                              )
                              
                              =
                              
                              
                                 ∑
                                 
                                    k
                                    =
                                    0
                                 
                                 n
                              
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    k
                                 
                                 
                                    n
                                 
                              
                              (
                              t
                              )
                              
                              ,
                              
                              
                                 
                                    b
                                 
                                 
                                    k
                                 
                                 
                                    n
                                 
                              
                              (
                              t
                              )
                              
                              =
                              
                              
                                 (
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       
                                          k
                                       
                                    
                                 
                                 )
                              
                              
                                 
                                    (
                                    1
                                    −
                                    t
                                    )
                                 
                                 
                                    n
                                    −
                                    k
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              
                              ,
                           
                        
                      is a Pythagorean-hodograph (PH) curve if and only if its derivative satisfies
                        
                           (2)
                           
                              
                                 
                                    |
                                    
                                       
                                          r
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    t
                                    )
                                    |
                                 
                                 
                                    2
                                 
                              
                              
                              =
                              
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              (
                              t
                              )
                           
                        
                      for some polynomial 
                        σ
                        (
                        t
                        )
                      of degree 
                        n
                        −
                        1
                     . We consider here only PH curves of odd degree, since even degree curves may exhibit singular points, satisfying 
                        σ
                        (
                        t
                        )
                        =
                        0
                      for real values of t. The non-negative function
                        
                           (3)
                           
                              σ
                              (
                              t
                              )
                              
                              =
                              
                              |
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              |
                              
                              =
                              
                              
                                 
                                    d
                                    s
                                 
                                 
                                    d
                                    t
                                 
                              
                              
                              ,
                           
                        
                      defining the rate of change of arc length s with respect to the parameter t, is called the parametric speed of the curve 
                        r
                        (
                        t
                        )
                     . Thus, the distinctive property of a PH curve is that its parametric speed is a polynomial in t.

For planar PH curves, the satisfaction of (2) is typically achieved through a complex-variable model (Farouki, 1994), in which plane coordinates 
                        (
                        x
                        ,
                        y
                        )
                      are regarded as the real and imaginary parts of a complex variable 
                        z
                        =
                        x
                        +
                        i
                        
                        y
                     . Then a sufficient-and-necessary condition for satisfaction of (2) is that the derivative should be of the form
                        
                           (4)
                           
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              
                              =
                              
                              
                                 
                                    w
                                 
                                 
                                    2
                                 
                              
                              (
                              t
                              )
                           
                        
                      for some complex polynomial 
                        w
                        (
                        t
                        )
                        =
                        u
                        (
                        t
                        )
                        +
                        i
                        
                        v
                        (
                        t
                        )
                     , and the parametric speed is 
                        σ
                        (
                        t
                        )
                        =
                        
                           
                              |
                              w
                              (
                              t
                              )
                              |
                           
                           
                              2
                           
                        
                     . For spatial PH curves, on the other hand, a quaternion model is employed (Choi et al., 2002; Farouki et al., 2002) with the derivative expressed in the form
                        
                           (5)
                           
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              
                              =
                              
                              A
                              (
                              t
                              )
                              
                              i
                              
                              
                                 
                                    A
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              t
                              )
                              
                              ,
                           
                        
                      in terms of a quaternion polynomial
                        1
                     
                     
                        1
                        Calligraphic characters such as 
                              A
                            denote quaternions, which are regarded as consisting of a scalar part a and vector part a, so that 
                              A
                              =
                              (
                              a
                              ,
                              a
                              )
                            and 
                              a
                              =
                              scal
                              (
                              A
                              )
                           , 
                              a
                              =
                              vect
                              (
                              A
                              )
                           .
                      
                     
                        A
                        (
                        t
                        )
                        =
                        u
                        (
                        t
                        )
                        +
                        v
                        (
                        t
                        )
                        
                        i
                        +
                        p
                        (
                        t
                        )
                        
                        j
                        +
                        q
                        (
                        t
                        )
                        
                        k
                      and its conjugate 
                        
                           
                              A
                           
                           
                              ⁎
                           
                        
                        (
                        t
                        )
                        =
                        u
                        (
                        t
                        )
                        −
                        v
                        (
                        t
                        )
                        
                        i
                        −
                        p
                        (
                        t
                        )
                        
                        j
                        −
                        q
                        (
                        t
                        )
                        
                        k
                     . The parametric speed of the PH curve defined by (5) is 
                        σ
                        (
                        t
                        )
                        =
                        
                           
                              |
                              A
                              (
                              t
                              )
                              |
                           
                           
                              2
                           
                        
                        =
                        
                           
                              u
                           
                           
                              2
                           
                        
                        (
                        t
                        )
                        +
                        
                           
                              v
                           
                           
                              2
                           
                        
                        (
                        t
                        )
                        +
                        
                           
                              p
                           
                           
                              2
                           
                        
                        (
                        t
                        )
                        +
                        
                           
                              q
                           
                           
                              2
                           
                        
                        (
                        t
                        )
                     . If 
                        w
                        (
                        t
                        )
                      and 
                        A
                        (
                        t
                        )
                      in expressions (4) and (5) are of degree m, their integration yields planar and spatial PH curves of degree 
                        n
                        =
                        2
                        m
                        +
                        1
                     . Complete details on these formulations, and the properties of PH curves, may be found in Farouki (2008).

In the present context, we assume that a Bézier curve of the form (1) is given (i.e., its control points 
                        
                           
                              p
                           
                           
                              0
                           
                        
                        ,
                        …
                        ,
                        
                           
                              p
                           
                           
                              n
                           
                        
                      are specified) and we wish to ascertain whether this curve results from an integration of (4) or (5) — and, if so, to reconstruct the complex polynomial 
                        w
                        (
                        t
                        )
                      or quaternion polynomial 
                        A
                        (
                        t
                        )
                      that generates 
                        
                           
                              r
                           
                           
                              ′
                           
                        
                        (
                        t
                        )
                     . Since the derivative of 
                        r
                        (
                        t
                        )
                      can be expressed (Farin, 1997) as
                        
                           (6)
                           
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              
                              =
                              
                              
                                 ∑
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    k
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                              
                              ,
                              
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                              
                              
                              =
                              
                              n
                              (
                              
                                 
                                    p
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                              )
                              
                              ,
                           
                        
                      we have
                        
                           (7)
                           
                              
                                 
                                    |
                                    
                                       
                                          r
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    t
                                    )
                                    |
                                 
                                 
                                    2
                                 
                              
                              
                              =
                              
                              
                                 ∑
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    2
                                    (
                                    n
                                    −
                                    1
                                    )
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    k
                                 
                                 
                                    2
                                    (
                                    n
                                    −
                                    1
                                    )
                                 
                              
                              (
                              t
                              )
                              
                              ,
                           
                        
                      where, using the arithmetic procedures for Bernstein-form polynomials (Farouki and Rajan, 1988), we define
                        
                           (8)
                           
                              
                                 
                                    a
                                 
                                 
                                    k
                                 
                              
                              
                              =
                              
                                 ∑
                                 
                                    j
                                    =
                                    max
                                    ⁡
                                    (
                                    0
                                    ,
                                    k
                                    −
                                    n
                                    +
                                    1
                                    )
                                 
                                 
                                    min
                                    ⁡
                                    (
                                    n
                                    −
                                    1
                                    ,
                                    k
                                    )
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                j
                                             
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                k
                                                −
                                                j
                                             
                                          
                                       
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             2
                                             n
                                             −
                                             2
                                          
                                       
                                       
                                          
                                             k
                                          
                                       
                                    
                                    )
                                 
                              
                              
                              
                                 
                                    d
                                 
                                 
                                    j
                                 
                              
                              ⋅
                              
                                 
                                    d
                                 
                                 
                                    k
                                    −
                                    j
                                 
                              
                              
                              .
                           
                        
                     
                  

In the context of exact symbolic computation, given a polynomial curve 
                        r
                        (
                        t
                        )
                      with rational coefficients, the factorization of 
                        
                           
                              |
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              |
                           
                           
                              2
                           
                        
                      into a perfect square can be used to determine whether it has a Pythagorean hodograph. For regular curves with 
                        |
                        
                           
                              r
                           
                           
                              ′
                           
                        
                        (
                        t
                        )
                        |
                        ≠
                        0
                      for all real t, such a factorization is equivalent to the property that the roots of the polynomial 
                        
                           
                              |
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              |
                           
                           
                              2
                           
                        
                      occur as complex-conjugate root pairs of even multiplicity. However, methods to compute multiple roots are typically slow to converge and sensitive to rounding errors. Experiments with numerical root-finding algorithms indicate that attempting to compute the root structure of 
                        
                           
                              |
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              |
                           
                           
                              2
                           
                        
                      is not a viable identification scheme, compared to the methods proposed below, in terms of efficiency and robustness.

The emphasis here is on practical methods, amenable to fast and reliable identification of PH curves in floating-point arithmetic, based on the Bézier control points 
                        
                           
                              p
                           
                           
                              0
                           
                        
                        ,
                        …
                        ,
                        
                           
                              p
                           
                           
                              n
                           
                        
                      in (1) as input. Two methods are described below, that require only arithmetic operations on the control points and have been found to yield reliable identifications of PH quintics with a relative precision of 
                        
                           
                              10
                           
                           
                              −
                              15
                           
                        
                      to 
                        
                           
                              10
                           
                           
                              −
                              14
                           
                        
                      in standard double-precision arithmetic. The first is based on evaluating certain expressions in the control polygon legs, and the second exploits the fact that numerical quadrature arc-length estimates of increasing order exhibit a sharp saturation when expression (1) defines a PH curve.

If the control points in (1) specify a PH curve, the expression defined by (7) and (8) must coincide with the perfect square of some polynomial
                           
                              (9)
                              
                                 σ
                                 (
                                 t
                                 )
                                 
                                 =
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       k
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                              
                           
                         of degree 
                           n
                           −
                           1
                        . Then 
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                           (
                           t
                           )
                         is a polynomial of degree 
                           2
                           (
                           n
                           −
                           1
                           )
                        , whose Bernstein coefficients are given by expression (8), but with 
                           
                              
                                 d
                              
                              
                                 j
                              
                           
                           ⋅
                           
                              
                                 d
                              
                              
                                 k
                                 −
                                 j
                              
                           
                         replaced by 
                           
                              
                                 σ
                              
                              
                                 j
                              
                           
                           
                              
                                 σ
                              
                              
                                 k
                                 −
                                 j
                              
                           
                        . Hence, satisfaction of the PH condition (2) is equivalent to the existence of real values 
                           
                              
                                 σ
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 σ
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         such that 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 d
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         satisfy the system of equations defined for 
                           k
                           =
                           0
                           ,
                           …
                           ,
                           2
                           n
                           −
                           2
                         by
                           
                              (10)
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       max
                                       ⁡
                                       (
                                       0
                                       ,
                                       k
                                       −
                                       n
                                       +
                                       1
                                       )
                                    
                                    
                                       min
                                       ⁡
                                       (
                                       n
                                       −
                                       1
                                       ,
                                       k
                                       )
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   j
                                                
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   k
                                                   −
                                                   j
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                2
                                                n
                                                −
                                                2
                                             
                                          
                                          
                                             
                                                k
                                             
                                          
                                       
                                       )
                                    
                                 
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       j
                                    
                                 
                                 ⋅
                                 
                                    
                                       d
                                    
                                    
                                       k
                                       −
                                       j
                                    
                                 
                                 −
                                 
                                    
                                       σ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       k
                                       −
                                       j
                                    
                                 
                                 )
                                 
                                 =
                                 
                                 0
                                 
                                 .
                              
                           
                         We assume 
                           r
                           (
                           t
                           )
                         has a proper parameterization, i.e., 
                           σ
                           (
                           t
                           )
                           >
                           0
                         for 
                           t
                           ∈
                           [
                           
                           0
                           ,
                           1
                           
                           ]
                         — this means, in particular, that 
                           σ
                           (
                           0
                           )
                           =
                           
                              
                                 σ
                              
                              
                                 0
                              
                           
                           >
                           0
                         and 
                           σ
                           (
                           1
                           )
                           =
                           
                              
                                 σ
                              
                              
                                 n
                                 −
                                 1
                              
                           
                           >
                           0
                        .

The coefficients 
                           
                              
                                 d
                              
                              
                                 k
                              
                           
                         of the derivative 
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                           (
                           t
                           )
                         differ from the control-polygon legs 
                           Δ
                           
                              
                                 p
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 p
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 p
                              
                              
                                 k
                              
                           
                         only by the factor n, so for brevity we often simply refer to 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 d
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         as the control-polygon legs. The conditions on 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 d
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         identifying PH curves derived below are homogeneous, and remain valid if we substitute 
                           Δ
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           Δ
                           
                              
                                 p
                              
                              
                                 n
                                 −
                                 1
                              
                           
                        . By eliminating the n indeterminate quantities 
                           
                              
                                 σ
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 σ
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         from the system (10) of 
                           2
                           n
                           −
                           1
                         equations, one obtains a system of 
                           n
                           −
                           1
                         constraints on the control-polygon legs 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 d
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         of a degree-n Bézier curve 
                           r
                           (
                           t
                           )
                        , whose satisfaction identifies it as a PH curve. Note that, whereas planar and spatial PH curve constructions employ distinct algebraic models, this identification scheme for PH curves is independent of the dimension of 
                           r
                           (
                           t
                           )
                        . We now consider the reduction of the system (10) in the context of PH cubics and quintics, setting 
                           
                              
                                 d
                              
                              
                                 k
                              
                           
                           =
                           |
                           
                              
                                 d
                              
                              
                                 k
                              
                           
                           |
                         for brevity.


                        
                           Proposition 1
                           
                              A planar or spatial cubic Bézier curve with control polygon legs 
                              
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                               
                              has a Pythagorean hodograph if and only if it satisfies
                              
                                 
                                    (11)
                                    
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       
                                       =
                                       
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (12)
                                    
                                       2
                                       
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       
                                       =
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       2
                                       
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           For a cubic curve, the conditions (10) become
                                 
                                    (13)
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                          
                                          =
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                          
                                          ,
                                          
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          
                                          =
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                1
                                             
                                          
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          2
                                          
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                          =
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          2
                                          
                                             
                                                σ
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          
                                          =
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          
                                          ,
                                          
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          
                                          =
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          
                                          .
                                       
                                    
                                 
                               By eliminating 
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                               from these five equations, the condition for a cubic to be a PH curve is reducible to two scalar constraints on the control-polygon legs 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                              . Since 
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 >
                                 0
                               for a regular curve, we must have 
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 ≠
                                 0
                               and 
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 ≠
                                 0
                               from the first and last of Eqs. (13). We also assume that 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 ≠
                                 0
                              , since setting 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                               in (13) gives 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 ⋅
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                              , so 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                               are linearly dependent and the curve degenerates to a straight line. With 
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                              , the second and fourth equations give 
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 ⋅
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 /
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 ⋅
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 /
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                              , and these expressions are consistent if and only if (11) holds. Substituting for 
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                               into the third equation then gives condition (12).  □

The conditions of Proposition 1 are consistent with the characterizations for planar and spatial PH cubics, in terms of their Bézier control polygons, derived in Farouki and Sakkalis (1990, 1994). For the planar case, it was shown in Farouki and Sakkalis (1990) that a cubic is a PH curve if and only if the lengths 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                         of the control-polygon legs and the angles 
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                         at the interior vertices (see Fig. 1
                        ) satisfy
                           
                              (14)
                              
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 
                                 .
                              
                           
                        
                     

Now by the definition of the angles 
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                         we have 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ⋅
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           =
                           −
                           
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           cos
                           ⁡
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ⋅
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           =
                           −
                           
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           cos
                           ⁡
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                        . Substituting into (11) then implies that 
                           cos
                           ⁡
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           =
                           cos
                           ⁡
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                         and hence 
                           sin
                           ⁡
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           =
                           ±
                           sin
                           ⁡
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                        , so we have either 
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                         or 
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           =
                           2
                           π
                           −
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                        . Since (the extensions of) 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                         make an interior angle (see Fig. 1) of 
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           −
                           π
                        , we obtain
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 ⋅
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 −
                                 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 cos
                                 ⁡
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 π
                                 )
                                 
                                 =
                                 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 cos
                                 ⁡
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 cos
                                 ⁡
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 cos
                                 ⁡
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 sin
                                 ⁡
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 sin
                                 ⁡
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 
                                 .
                              
                           
                         Substituting for 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ⋅
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ⋅
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ⋅
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                         into (12) and simplifying then gives
                           
                              
                                 2
                                 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 cos
                                 ⁡
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 cos
                                 ⁡
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 1
                                 )
                                 
                                 =
                                 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 cos
                                 ⁡
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 cos
                                 ⁡
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 sin
                                 ⁡
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 sin
                                 ⁡
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 1
                                 )
                                 
                                 .
                              
                           
                         Now if 
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                        , this reduces to 
                           
                              
                                 d
                              
                              
                                 1
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                        , so the conditions (14) are satisfied. On the other hand, when 
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           =
                           2
                           π
                           −
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                         it reduces to 
                           2
                           
                           
                              
                                 d
                              
                              
                                 1
                              
                              
                                 2
                              
                           
                           
                              
                                 sin
                              
                              
                                 2
                              
                           
                           ⁡
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           =
                           0
                        , implying that (i) 
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           =
                           0
                        , or (ii) 
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                         are integer multiples of π. As noted above, case (i) identifies degeneration to a straight line, and this is clearly also true for case (ii). Hence, for a proper PH cubic, the conditions (13) are satisfied.

For the spatial case, it was shown in Farouki and Sakkalis (1994) that a twisted cubic is a PH curve if and only if 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                         lie on a right-circular cone of some half-angle ϑ about 
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                         as axis, with azimuthal separation φ on this cone given by
                           
                              (15)
                              
                                 cos
                                 ⁡
                                 φ
                                 
                                 =
                                 
                                 1
                                 −
                                 
                                    
                                       2
                                       
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                 .
                              
                           
                         In other words, in a coordinate system in which 
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                         is parallel to the positive z direction and 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                         is parallel to the 
                           (
                           z
                           ,
                           x
                           )
                         plane, we must have
                           
                              (16)
                              
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 sin
                                 ⁡
                                 ϑ
                                 ,
                                 0
                                 ,
                                 cos
                                 ⁡
                                 ϑ
                                 )
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 0
                                 ,
                                 0
                                 ,
                                 1
                                 )
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 sin
                                 ⁡
                                 ϑ
                                 cos
                                 ⁡
                                 φ
                                 ,
                                 sin
                                 ⁡
                                 ϑ
                                 sin
                                 ⁡
                                 φ
                                 ,
                                 cos
                                 ⁡
                                 ϑ
                                 )
                                 
                                 .
                              
                           
                         Now writing 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ⋅
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           cos
                           ⁡
                           
                              
                                 θ
                              
                              
                                 01
                              
                           
                         and 
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ⋅
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           cos
                           ⁡
                           
                              
                                 θ
                              
                              
                                 12
                              
                           
                        , the condition (11) implies that 
                           cos
                           ⁡
                           
                              
                                 θ
                              
                              
                                 01
                              
                           
                           =
                           cos
                           ⁡
                           
                              
                                 θ
                              
                              
                                 12
                              
                           
                         (
                           =
                           cos
                           ⁡
                           ϑ
                        , say) for non-zero 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                        . This means that 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                         lie on a cone of half-angle ϑ with 
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                         as axis. If φ is their azimuthal separation on this cone, substituting from (16) into (12) gives
                           
                              
                                 2
                                 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       cos
                                    
                                    
                                       2
                                    
                                 
                                 ⁡
                                 ϑ
                                 
                                 =
                                 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 
                                 [
                                 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       sin
                                    
                                    
                                       2
                                    
                                 
                                 ⁡
                                 ϑ
                                 cos
                                 ⁡
                                 φ
                                 +
                                 
                                    
                                       cos
                                    
                                    
                                       2
                                    
                                 
                                 ⁡
                                 ϑ
                                 )
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                 ]
                                 
                                 ,
                              
                           
                         and upon simplification this becomes
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       sin
                                    
                                    
                                       2
                                    
                                 
                                 ⁡
                                 ϑ
                                 cos
                                 ⁡
                                 φ
                                 
                                 =
                                 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       sin
                                    
                                    
                                       2
                                    
                                 
                                 ⁡
                                 ϑ
                                 −
                                 2
                                 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       sin
                                    
                                    
                                       2
                                    
                                 
                                 ⁡
                                 ϑ
                                 
                                 .
                              
                           
                         Noting that 
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                         are non-zero, and assuming that 
                           sin
                           ⁡
                           ϑ
                           ≠
                           0
                         (since this identifies the degenerate case in which the control-polygon legs are collinear), this implies that the condition (15) is satisfied.


                        
                           Proposition 2
                           
                              A planar or spatial quintic Bézier curve with control polygon legs 
                              
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                 
                               
                              has a Pythagorean hodograph if and only if it satisfies
                              
                                 
                                    (17)
                                    
                                       3
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       
                                       =
                                       
                                       4
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                          
                                             3
                                          
                                       
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   d
                                                
                                                
                                                   3
                                                
                                             
                                             ×
                                             
                                                
                                                   d
                                                
                                                
                                                   4
                                                
                                             
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       4
                                       
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                          
                                             3
                                          
                                       
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   d
                                                
                                                
                                                   0
                                                
                                             
                                             ×
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (18)
                                    
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                          
                                             4
                                          
                                       
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             3
                                          
                                       
                                       
                                       +
                                       
                                       6
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       ×
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       ⋅
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       ×
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       
                                       =
                                       
                                       8
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   d
                                                
                                                
                                                   0
                                                
                                             
                                             ×
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (19)
                                    
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                          
                                             4
                                          
                                       
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       
                                       +
                                       
                                       6
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       ×
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       ⋅
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             3
                                          
                                       
                                       ×
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       
                                       =
                                       
                                       8
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       
                                       
                                          
                                             d
                                          
                                          
                                             3
                                          
                                       
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   d
                                                
                                                
                                                   3
                                                
                                             
                                             ×
                                             
                                                
                                                   d
                                                
                                                
                                                   4
                                                
                                             
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (20)
                                    
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       18
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       +
                                       16
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                          
                                             2
                                          
                                       
                                       
                                       [
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             3
                                          
                                       
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       
                                       ]
                                       =
                                       
                                       2
                                       
                                       [
                                       
                                       3
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                          
                                             2
                                          
                                       
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       4
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   d
                                                
                                                
                                                   0
                                                
                                             
                                             ×
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       
                                       ]
                                       [
                                       
                                       3
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                          
                                             2
                                          
                                       
                                       
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       ⋅
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       4
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   d
                                                
                                                
                                                   3
                                                
                                             
                                             ×
                                             
                                                
                                                   d
                                                
                                                
                                                   4
                                                
                                             
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       
                                       ]
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           For a quintic curve, the conditions (10) become
                                 
                                    (21)
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                          
                                          =
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                          
                                          ,
                                          
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          
                                          =
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                1
                                             
                                          
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          3
                                          
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          4
                                          
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                          =
                                          
                                          3
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          4
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          6
                                          
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          
                                          =
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          6
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          16
                                          
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          18
                                          
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          
                                          =
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          16
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          18
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          6
                                          
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                3
                                             
                                          
                                          
                                          =
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          6
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                3
                                             
                                          
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          3
                                          
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          4
                                          
                                          
                                             
                                                d
                                             
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                          
                                          =
                                          
                                          3
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          4
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                3
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                4
                                             
                                          
                                          
                                          =
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                4
                                             
                                          
                                          
                                          ,
                                          
                                          
                                             
                                                d
                                             
                                             
                                                4
                                             
                                             
                                                2
                                             
                                          
                                          
                                          =
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                4
                                             
                                             
                                                2
                                             
                                          
                                          
                                          .
                                       
                                    
                                 
                               Since 
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       4
                                    
                                 
                                 >
                                 0
                               for a regular curve, we have 
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 ≠
                                 0
                               and 
                                 
                                    
                                       σ
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                 
                                 ≠
                                 0
                               from the first and ninth equations, and from the second and eighth we obtain 
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 ⋅
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 /
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       σ
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                 
                                 ⋅
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                 
                                 /
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                 
                              . Using 
                                 
                                    
                                       |
                                       a
                                       ×
                                       b
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       a
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       |
                                       b
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       (
                                       a
                                       ⋅
                                       b
                                       )
                                    
                                    
                                       2
                                    
                                 
                              , the third and seventh equations then give
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       
                                       =
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   0
                                                
                                             
                                             ⋅
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                          
                                       
                                       +
                                       
                                          4
                                          3
                                       
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ×
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                       =
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             ⋅
                                             
                                                
                                                   d
                                                
                                                
                                                   4
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                4
                                             
                                          
                                       
                                       +
                                       
                                          4
                                          3
                                       
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                   
                                                
                                                ×
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      4
                                                   
                                                
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                4
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                       .
                                    
                                 
                               Consistency of these expressions is equivalent to condition (17). Substituting for 
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       4
                                    
                                 
                               into the fourth and sixth equations, and using the relation 
                                 (
                                 a
                                 ×
                                 b
                                 )
                                 ⋅
                                 (
                                 c
                                 ×
                                 d
                                 )
                                 =
                                 (
                                 a
                                 ⋅
                                 c
                                 )
                                 (
                                 b
                                 ⋅
                                 d
                                 )
                                 −
                                 (
                                 a
                                 ⋅
                                 d
                                 )
                                 (
                                 b
                                 ⋅
                                 c
                                 )
                              , we obtain (18) and (19), while the fifth equation gives (20).  □

We emphasize again that the conditions (17)–(20) apply to both planar and spatial PH quintics. No simple and intuitive constraints on the geometry of the control polygon, analogous to those mentioned above for cubics, are available to guide the construction of PH quintics. Some partial results were given in Farouki (1994), but their geometrical meaning is rather opaque — as is the case with the constraints in Eqs. (17)–(20). Instead, PH quintics are usually specified as interpolants to first-order Hermite data.


                        
                           Remark 1
                           In testing the conditions (11)–(12) and (17)–(20), it is advisable to first normalize the vectors 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                               by dividing each with their mean magnitude. This gives scale-free conditions in which both sides of (11)–(12) and (17)–(20) are of order unity, allowing direct comparison with the machine unit for the floating-point number system in use: for double-precision binary arithmetic with 53-bit mantissa and rounding, this is 
                                 η
                                 =
                                 
                                    
                                       2
                                    
                                    
                                       −
                                       53
                                    
                                 
                                 ≈
                                 1.11
                                 ×
                                 
                                    
                                       10
                                    
                                    
                                       −
                                       16
                                    
                                 
                              .


                        
                           Example 1
                           Consider the planar PH quintic constructed as the interpolant (Farouki and Neff, 1995) to first-order Hermite data specified by the initial and final control point pairs 
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 (
                                 1.0
                                 ,
                                 1.0
                                 )
                              , 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 (
                                 2.5
                                 ,
                                 −
                                 0.5
                                 )
                               and 
                                 
                                    
                                       p
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 (
                                 2.5
                                 ,
                                 4.5
                                 )
                              , 
                                 
                                    
                                       p
                                    
                                    
                                       5
                                    
                                 
                                 =
                                 (
                                 4.0
                                 ,
                                 3.0
                                 )
                              . To full precision, the interior two control points (computed by the interpolation algorithm) are found to be
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       (
                                       3.6408217899592117
                                       ,
                                       2.2476669682249213
                                       )
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       (
                                       1.3591782100407905
                                       ,
                                       1.7523330317750787
                                       )
                                       
                                       .
                                    
                                 
                               This curve is shown in Fig. 2
                              , together with the variation of its parametric speed 
                                 σ
                                 (
                                 t
                                 )
                              . The differences between the right- and left-hand sides of Eqs. (17)–(20), computed in double precision arithmetic, are as follows
                                 2
                              
                              
                                 2
                                 Note that the normalization proposed in Remark 1 is always used.
                              
                              
                                 
                                    
                                       5
                                       ×
                                       
                                          
                                             10
                                          
                                          
                                             −
                                             16
                                          
                                       
                                       
                                       ,
                                       
                                       4
                                       ×
                                       
                                          
                                             10
                                          
                                          
                                             −
                                             16
                                          
                                       
                                       
                                       ,
                                       
                                       4
                                       ×
                                       
                                          
                                             10
                                          
                                          
                                             −
                                             16
                                          
                                       
                                       
                                       ,
                                       
                                       18
                                       ×
                                       
                                          
                                             10
                                          
                                          
                                             −
                                             16
                                          
                                       
                                       
                                       .
                                    
                                 
                               These are within two orders of magnitude of the machine unit η. Thus, a robust PH curve identification is obtained by choosing a relative tolerance ϵ for the satisfaction of (17)–(20) that is 102–103 larger than η. To illustrate the ability of the method to reject “ordinary” quintic curves, an instance of the latter is defined by leaving 
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       p
                                    
                                    
                                       4
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       5
                                    
                                 
                               unchanged, and perturbing the inner control points to 
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 (
                                 3.6
                                 ,
                                 2.2
                                 )
                              , 
                                 
                                    
                                       p
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 (
                                 1.4
                                 ,
                                 1.8
                                 )
                              . The perturbed curve is barely distinguishable from Fig. 2, but it is no longer a PH curve. In this case, the residuals obtained from Eqs. (17)–(20) are
                                 
                                    
                                       2.4
                                       ×
                                       
                                          
                                             10
                                          
                                          
                                             −
                                             15
                                          
                                       
                                       
                                       ,
                                       
                                       −
                                       
                                       9.1
                                       ×
                                       
                                          
                                             10
                                          
                                          
                                             −
                                             2
                                          
                                       
                                       
                                       ,
                                       
                                       −
                                       
                                       9.1
                                       ×
                                       
                                          
                                             10
                                          
                                          
                                             −
                                             2
                                          
                                       
                                       
                                       ,
                                       
                                       −
                                       
                                       9.2
                                       ×
                                       
                                          
                                             10
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                       .
                                    
                                 
                               We observe that Eq. (17) continues to yield a small residual. This is a consequence of the symmetry
                                 3
                              
                              
                                 3
                                 This symmetry also explains the equality of the residuals for Eqs. (18) and (19).
                               of the curve. Specifically, 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                 
                              , 
                                 |
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                 
                                 ×
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                 
                                 |
                                 =
                                 |
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 ×
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 |
                              , and 
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 0
                              , and hence both sides of (17) vanish. However, Eqs. (18)–(20) have residuals much larger than η (commensurate with the perturbations of 
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       3
                                    
                                 
                              ) so the data are inconsistent with a PH curve.


                        
                           Example 2
                           To verify the reliability of the method in extreme cases, it was tested on the curve shown in Fig. 3
                              , a PH quintic with a severe curvature variation. This curve is specified by the initial and final control point pairs 
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 (
                                 4.0
                                 ,
                                 4.0
                                 )
                              , 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 (
                                 10.0
                                 ,
                                 9.0
                                 )
                               and 
                                 
                                    
                                       p
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 (
                                 6.0
                                 ,
                                 11.0
                                 )
                              , 
                                 
                                    
                                       p
                                    
                                    
                                       5
                                    
                                 
                                 =
                                 (
                                 11.0
                                 ,
                                 5.0
                                 )
                               with the middle pair determined by the Hermite interpolation algorithm as
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       (
                                       5.2662184461825108
                                       ,
                                       9.1034234921021326
                                       )
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       (
                                       9.2741575847607258
                                       ,
                                       7.5795795100404524
                                       )
                                       
                                       .
                                    
                                 
                               To emphasize the severity of the parametric speed variation, it is shown in Fig. 3 as a function of fractional arc length along the curve, rather than the parameter t. In this case, the differences between the right- and left-hand sides of Eqs. (17)–(20) are
                                 
                                    
                                       27
                                       ×
                                       
                                          
                                             10
                                          
                                          
                                             −
                                             16
                                          
                                       
                                       
                                       ,
                                       
                                       18
                                       ×
                                       
                                          
                                             10
                                          
                                          
                                             −
                                             16
                                          
                                       
                                       
                                       ,
                                       
                                       5
                                       ×
                                       
                                          
                                             10
                                          
                                          
                                             −
                                             16
                                          
                                       
                                       
                                       ,
                                       
                                       0
                                       ×
                                       
                                          
                                             10
                                          
                                          
                                             −
                                             16
                                          
                                       
                                       
                                       .
                                    
                                 
                               Again, a robust PH curve identification is indicated by the fact that all these values are within two orders of magnitude of the machine unit.

In principle, the methods described above for PH cubics and quintics can be extended to higher-order PH curves — although the system of constraints, specified by eliminating the 
                           
                              
                                 σ
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 σ
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         variables from (10), obviously grows correspondingly in number and degree. Since quintic PH curves are generally recognized to have sufficient shape flexibility for most applications, we do not pursue the extension to higher-order PH curves here.

A quadrature rule estimates the integral of a function 
                           f
                           (
                           t
                           )
                         over an interval 
                           t
                           ∈
                           [
                           
                           a
                           ,
                           b
                           
                           ]
                         as a weighted sum 
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           f
                           (
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           )
                           +
                           ⋯
                           +
                           
                              
                                 w
                              
                              
                                 m
                              
                           
                           f
                           (
                           
                              
                                 t
                              
                              
                                 m
                              
                           
                           )
                         of m function values, sampled at nodes 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 m
                              
                           
                           ∈
                           [
                           
                           a
                           ,
                           b
                           
                           ]
                        . When the nodes and weights are suitably chosen, the estimate is exact (modulo round-off error) if 
                           f
                           (
                           t
                           )
                         is a polynomial of a certain maximum degree, dependent on m. A quadrature rule has precision n if it yields exact integrals for polynomials of degree ≤n, but not >n.

The cumulative arc length 
                           s
                           (
                           t
                           )
                         of a parametric curve is the integral of the parametric speed (3). For a general polynomial curve of degree 
                           n
                           ≥
                           3
                         this integral has no closed-form reduction, but for a degree-n PH curve with the polynomial parametric speed (9) it is also a polynomial of degree n, namely
                           
                              
                                 s
                                 (
                                 t
                                 )
                                 
                                 =
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                 ,
                                 
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 
                                 =
                                 
                                 
                                    1
                                    n
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       j
                                    
                                 
                                 
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 
                                 .
                              
                           
                         In particular, the total arc length for the parameter interval 
                           [
                           
                           0
                           ,
                           1
                           
                           ]
                         is
                           
                              (22)
                              
                                 S
                                 
                                 =
                                 
                                 s
                                 (
                                 1
                                 )
                                 
                                 =
                                 
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                    n
                                 
                                 
                                 .
                              
                           
                         The exactitude of a quadrature rule for sufficiently high m, when 
                           f
                           (
                           t
                           )
                         is a polynomial, may be exploited to identify PH curves — if 
                           r
                           (
                           t
                           )
                         is a degree-n PH curve, 
                           σ
                           (
                           t
                           )
                         is a polynomial of degree 
                           n
                           −
                           1
                        , and there will be no change (modulo round-off error) in the quadrature estimates of S with increasing m once it exceeds a certain threshold value. However, if 
                           r
                           (
                           t
                           )
                         is not a PH curve, the quadrature values will exhibit steady convergence with increasing m, but no “saturation” as with a PH curve. This approach is illustrated using two well-known quadratures, the Gauss–Legendre and Newton–Cotes rules (Kythe and Schäferkotter, 2005).

The exactitude of a quadrature rule for sufficiently high m, when 
                           f
                           (
                           t
                           )
                         is a polynomial, may be exploited to identify PH curves — if 
                           r
                           (
                           t
                           )
                         is a degree-n PH curve, 
                           σ
                           (
                           t
                           )
                         is a polynomial of degree 
                           n
                           −
                           1
                        , and there will be no change (modulo round-off error) in the quadrature estimates of S with increasing m once it exceeds a certain threshold value. On the other hand, if 
                           r
                           (
                           t
                           )
                         is not a PH curve, the computed S values will exhibit steady but slow convergence with increasing m — there is no “saturation” of these values, as with a PH curve. This approach is illustrated below in the context of two well-known quadratures, the Gauss–Legendre and Newton–Cotes rules (Kythe and Schäferkotter, 2005).

An important consideration is the numerical stability of the quadrature rule. The parametric speed 
                           σ
                           (
                           t
                           )
                         is always a non-negative function. In Gauss–Legendre quadrature, the weights are all positive, so S is estimated as a sum of non-negative terms, and no amplification of floating-point error through the cancellation of leading digits can occur. For Newton–Cotes quadrature, on the other hand, negative weights arise for 
                           m
                           ≥
                           9
                         in the closed case, and 
                           m
                           ≥
                           3
                         in the open case. To preclude numerical instability, the closed rule is used only for curves of degree ≤7, and the open rule is avoided altogether.

The nodes and weights for Gauss–Legendre quadrature are usually specified (Kythe and Schäferkotter, 2005) for the interval 
                              t
                              ∈
                              [
                              
                              −
                              1
                              ,
                              +
                              1
                              
                              ]
                           . The nodes 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    m
                                 
                              
                            are the roots of the degree-m Legendre polynomial, defined by the Rodrigues formula
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                    =
                                    
                                    
                                       1
                                       
                                          
                                             
                                                2
                                             
                                             
                                                m
                                             
                                          
                                          m
                                          !
                                       
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             m
                                          
                                       
                                       
                                          d
                                          
                                             
                                                t
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          1
                                          )
                                       
                                       
                                          m
                                       
                                    
                                    
                                    ,
                                 
                              
                            and the corresponding weights 
                              
                                 
                                    w
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    w
                                 
                                 
                                    m
                                 
                              
                            are given by
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          k
                                       
                                    
                                    
                                    =
                                    
                                    
                                       2
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          
                                          
                                             
                                                [
                                                
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      m
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                
                                                ]
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                    ,
                                    
                                    k
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    m
                                    
                                    .
                                 
                              
                            The nodes and weights for 
                              m
                              ≤
                              5
                            admit closed-form expressions, as listed
                              4
                           
                           
                              4
                              Note that, in the case 
                                    m
                                    =
                                    5
                                 , the weight corresponding to the node 
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    0
                                  is incorrectly quoted as 64/225 in Kythe and Schäferkotter (2005).
                            in Table 1
                           . For larger m, they must be determined numerically — values for 
                              m
                              =
                              6
                              ,
                              …
                              ,
                              10
                           , 12, and 16 are tabulated to 15 decimal places in Kythe and Schäferkotter (2005). The quadrature error may be formulated (Kythe and Schäferkotter, 2005) as
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          m
                                       
                                    
                                    
                                    =
                                    
                                    
                                       
                                          
                                             
                                                2
                                             
                                             
                                                2
                                                m
                                                +
                                                1
                                             
                                          
                                          
                                             
                                                (
                                                m
                                                !
                                                )
                                             
                                             
                                                4
                                             
                                          
                                       
                                       
                                          (
                                          2
                                          m
                                          +
                                          1
                                          )
                                          
                                          
                                             
                                                [
                                                
                                                (
                                                2
                                                m
                                                )
                                                !
                                                
                                                ]
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          f
                                       
                                       
                                          (
                                          2
                                          m
                                          )
                                       
                                    
                                    (
                                    ξ
                                    )
                                    
                                    ,
                                    
                                    −
                                    1
                                    <
                                    ξ
                                    <
                                    +
                                    1
                                    
                                    .
                                 
                              
                            Since 
                              
                                 
                                    f
                                 
                                 
                                    (
                                    2
                                    m
                                    )
                                 
                              
                              (
                              t
                              )
                              ≡
                              0
                            for any polynomial of degree 
                              d
                              ≤
                              2
                              m
                              −
                              1
                           , the quadrature is exact for a polynomial integrand 
                              f
                              (
                              t
                              )
                            of degree n whenever 
                              m
                              ≥
                              ⌈
                              
                                 1
                                 2
                              
                              (
                              n
                              +
                              1
                              )
                              ⌉
                           . In the present context, we adapt the Gauss–Legendre quadrature rule to the domain 
                              [
                              
                              0
                              ,
                              1
                              
                              ]
                            by the change of variables 
                              t
                              →
                              
                                 1
                                 2
                              
                              (
                              t
                              +
                              1
                              )
                           , to obtain
                              
                                 (23)
                                 
                                    S
                                    
                                    =
                                    
                                    
                                       ∫
                                       0
                                       1
                                    
                                    σ
                                    (
                                    t
                                    )
                                    
                                    d
                                    t
                                    
                                    ≈
                                    
                                    
                                       1
                                       2
                                    
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       m
                                    
                                    
                                       
                                          w
                                       
                                       
                                          k
                                       
                                    
                                    
                                    σ
                                    (
                                    
                                       1
                                       2
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    1
                                    )
                                    )
                                    
                                    ,
                                 
                              
                            with parametric speed values sampled at the points 
                              
                                 1
                                 2
                              
                              (
                              1
                              +
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                            for 
                              k
                              =
                              1
                              ,
                              …
                              ,
                              m
                            using successive m values, saturation of S being observed when 
                              m
                              ≥
                              ⌈
                              
                                 1
                                 2
                              
                              n
                              ⌉
                           . With a quintic curve, for example, the quadrature arc length values S should remain essentially unchanged for 
                              m
                              ≥
                              3
                           , if it is a PH curve. Note that this method is again independent of whether 
                              r
                              (
                              t
                              )
                            is a planar or spatial curve.


                           
                              Example 3
                              Consider the quintic PH curve constructed in Example 1, shown together with the variation of its parametric speed in Fig. 2. To compare the performance of Gauss–Legendre quadrature in computing the arc length of this curve with that for an “ordinary” quintic, we again define the latter by moving the inner control points to 
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    (
                                    3.6
                                    ,
                                    2.2
                                    )
                                 , 
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    (
                                    1.4
                                    ,
                                    1.8
                                    )
                                 . For both curves, the parametric speed values required in the numerical quadrature are computed from 
                                    σ
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ′
                                                
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                          +
                                          
                                             
                                                y
                                             
                                             
                                                ′
                                                
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                 . Table 2
                                  compares arc lengths for the two curves, computed in double-precision arithmetic by Gauss–Legendre quadrature with 
                                    m
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    5
                                 . For the PH quintic, the quadrature values agree with the exact arc length
                                    5
                                 
                                 
                                    5
                                    For the PH curve, the exact value is given by (22), but no exact value is possible for the “ordinary” Bézier curve.
                                  to a relative accuracy of 
                                    ∼
                                    
                                       
                                          10
                                       
                                       
                                          −
                                          15
                                       
                                    
                                  for 
                                    m
                                    ≥
                                    3
                                 . For the “ordinary” quintic, however, the quadrature values have an accuracy of only 
                                    ∼
                                    
                                       
                                          10
                                       
                                       
                                          −
                                          3
                                       
                                    
                                  at 
                                    m
                                    =
                                    5
                                 , although it is “very close” to the PH quintic.

Let 
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                            be arc lengths of a polynomial curve, computed in floating-point arithmetic by Gauss–Legendre quadrature with 
                              m
                              =
                              1
                              ,
                              2
                              ,
                              …
                            To identify a PH curve by agreement of these values for all 
                              m
                              ≥
                              l
                           , it is necessary to choose a suitable convergence tolerance ϵ, such that
                              
                                 
                                    
                                       
                                          |
                                          
                                             
                                                S
                                             
                                             
                                                m
                                             
                                          
                                          −
                                          
                                             
                                                S
                                             
                                             
                                                l
                                             
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             
                                                S
                                             
                                             
                                                l
                                             
                                          
                                          |
                                       
                                    
                                    
                                    ≤
                                    
                                    ϵ
                                    
                                    for
                                    
                                    
                                    m
                                    >
                                    l
                                    
                                    .
                                 
                              
                            Clearly, ϵ should be larger than the machine unit η for double-precision arithmetic. Since the nodes and weights (see Table 1) are irrational numbers, and evaluating the sum (23) incurs some floating-point error, it is advisable to choose ϵ a few orders of magnitude larger than η, but at a level of accuracy that numerical quadrature cannot achieve for integration of non-polynomial functions. In practice, the value
                              6
                           
                           
                              6
                              More precise estimates of the (worst case) relative errors incurred in computing S by numerical quadrature can be obtained by the method of running error analysis (Peters and Wilkinson, 1971).
                            
                           
                              ϵ
                              =
                              
                                 
                                    10
                                 
                                 
                                    −
                                    14
                                 
                              
                            appears to work well.

If the numerical quadrature is restricted to instances with 
                              m
                              ≤
                              5
                           , so as to use only the nodes and weights with closed-form expressions (see Table 1), the maximum degree of PH curves that can be identified using this approach is 
                              n
                              =
                              7
                           , since two consecutive arc lengths that agree in value are required. The nodes and weights listed numerically to 15 decimal places in Kythe and Schäferkotter (2005), up to 
                              m
                              =
                              10
                           , can be employed if higher-order PH curves are of interest.


                           
                              Example 4
                              As seen in Fig. 3, the curve of Example 2 exhibits a severe parametric speed variation, providing a stringent test of the method. Table 3
                                  lists arc lengths computed in double-precision arithmetic by Gauss–Legendre quadrature. Convergence to an accuracy of 
                                    ∼
                                    
                                       
                                          10
                                       
                                       
                                          −
                                          15
                                       
                                    
                                  is again seen for 
                                    m
                                    ≥
                                    3
                                 .


                           
                              Example 5
                              A useful side-benefit of the quadrature identification procedure is that it signals, when a PH curve is detected, whether its true degree is less than the nominal degree indicated by its Bézier control-point representation. As is well known (Farin, 1997), a Bézier curve of true degree n always has a non-trivial representation in the Bernstein basis of any degree >n. Consider the quintic Bézier curve specified by the control points
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                0
                                             
                                          
                                          
                                          =
                                          
                                          (
                                          0
                                          ,
                                          0
                                          )
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          
                                          =
                                          
                                          (
                                          0
                                          ,
                                          
                                             2
                                             5
                                          
                                          )
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          
                                          =
                                          
                                          (
                                          
                                             1
                                             10
                                          
                                          ,
                                          
                                             7
                                             10
                                          
                                          )
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                3
                                             
                                          
                                          
                                          =
                                          
                                          (
                                          
                                             4
                                             15
                                          
                                          ,
                                          
                                             9
                                             10
                                          
                                          )
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                4
                                             
                                          
                                          
                                          =
                                          
                                          (
                                          
                                             7
                                             15
                                          
                                          ,
                                          1
                                          )
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                5
                                             
                                          
                                          
                                          =
                                          
                                          (
                                          
                                             2
                                             3
                                          
                                          ,
                                          1
                                          )
                                          
                                          .
                                       
                                    
                                  Applying the Gauss–Legendre quadrature yields the arc-length values shown in Table 3. For a PH quintic, these values should agree for 
                                    m
                                    ≥
                                    3
                                 , but in the present case they actually agree for 
                                    m
                                    ≥
                                    2
                                 . This indicates that the curve is actually a degree-elevated PH cubic, rather than a true PH quintic. Fig. 4
                                  illustrates this curve, together with its Bézier control polygons of degree 5 and 3, the latter being defined by the control points
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                0
                                             
                                          
                                          
                                          =
                                          
                                          (
                                          0
                                          ,
                                          0
                                          )
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          
                                          =
                                          
                                          (
                                          0
                                          ,
                                          
                                             2
                                             3
                                          
                                          )
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          
                                          =
                                          
                                          (
                                          
                                             1
                                             3
                                          
                                          ,
                                          1
                                          )
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                3
                                             
                                          
                                          
                                          =
                                          
                                          (
                                          
                                             2
                                             3
                                          
                                          ,
                                          1
                                          )
                                          
                                          .
                                       
                                    
                                  The parametric speed has the quadratic Bernstein coefficients 
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    (
                                    2
                                    ,
                                    1
                                    ,
                                    1
                                    )
                                  and hence the exact arc length is 
                                    S
                                    =
                                    (
                                    2
                                    +
                                    1
                                    +
                                    1
                                    )
                                    /
                                    3
                                    =
                                    4
                                    /
                                    3
                                 .

The (closed) Newton–Cotes quadrature rule is based on Lagrange polynomials (Kythe and Schäferkotter, 2005) with the uniform nodes 
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              =
                              (
                              k
                              −
                              1
                              )
                              /
                              (
                              m
                              −
                              1
                              )
                           , 
                              k
                              =
                              1
                              ,
                              …
                              ,
                              m
                            on 
                              t
                              ∈
                              [
                              
                              0
                              ,
                              1
                              
                              ]
                           , and involves only positive weights when 
                              m
                              ≤
                              8
                            — see Table 4
                           . The remainder term (Kythe and Schäferkotter, 2005) is proportional to 
                              
                                 
                                    f
                                 
                                 
                                    (
                                    p
                                    )
                                 
                              
                              (
                              ξ
                              )
                            for some 
                              ξ
                              ∈
                              [
                              
                              0
                              ,
                              1
                              
                              ]
                           , where 
                              p
                              =
                              2
                              
                              ⌊
                              
                                 1
                                 2
                              
                              (
                              m
                              +
                              1
                              )
                              ⌋
                           . Hence, to obtain the exact arc length of a degree-n PH curve, m must satisfy 
                              2
                              
                              ⌊
                              
                                 1
                                 2
                              
                              (
                              m
                              +
                              1
                              )
                              ⌋
                              ≥
                              n
                            since 
                              σ
                              (
                              t
                              )
                            is of degree 
                              n
                              −
                              1
                           . Thus, for a PH quintic, the arc length values saturate for 
                              m
                              ≥
                              5
                            nodes with Newton–Cotes quadrature (as compared to 
                              m
                              ≥
                              3
                            for Gauss–Legendre quadrature) — this is borne out by the values obtained for the curves in Examples 1 and 2, listed in Table 5
                           .

Comparing the Newton–Cotes and Gauss–Legendre rules, the former has the advantage of rational nodes and weights for all m, while the latter incurs irrational nodes and weights with closed-form expressions only if 
                              m
                              ≤
                              5
                           . On the other hand, Gauss–Legendre quadrature permits PH curve identification with fewer nodes. Since consecutive identical arc length values are required, the minimum number of nodes to identify a PH quintic is 
                              m
                              =
                              4
                            with Gauss–Legendre quadrature, but 
                              m
                              =
                              6
                            with Newton–Cotes quadrature.


                           
                              Remark 2
                              Although much simpler than the control-polygon constraints, the arc length quadrature method should be regarded as providing a tentative PH curve identification. Since it employs discrete sampling of the parametric speed, it may be possible for non-PH curves to exhibit successive coincident quadrature arc length values (although in practice this is highly improbable). To validate the identification, one should ensure the existence of consistent solutions to the over-determined systems of equations that characterize the reverse-engineering problem, as described below.

Once the curve (1) specified by its Bézier control points has been identified as a PH curve, through the procedures described above, it will be necessary to “reverse engineer” it, in order to fully exploit its advantageous computational properties. This amounts to a determination of the coefficients of the complex polynomial 
                        w
                        (
                        t
                        )
                      in (4) for a planar PH curve, or the quaternion polynomial 
                        A
                        (
                        t
                        )
                      in (5) for a spatial PH curve. Since the identification schemes do not distinguish these two cases, the first step is to ascertain which applies. This is accomplished by forming the components of 
                        
                           
                              d
                           
                           
                              0
                           
                        
                        ,
                        …
                        ,
                        
                           
                              d
                           
                           
                              n
                              −
                              1
                           
                        
                      into a 
                        3
                        ×
                        n
                      array: the curve is planar or spatial if it is of rank 2 or 3, respectively. In the former case, the control points are transformed so as to lie in the 
                        (
                        x
                        ,
                        y
                        )
                      plane.

For an identified planar PH curve, the reverse engineering problem consists of determining the complex pre-image polynomial that generates its hodograph through (4). If 
                           w
                           (
                           t
                           )
                         is of degree m, and specified in Bernstein form as
                           
                              
                                 w
                                 (
                                 t
                                 )
                                 
                                 =
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       0
                                    
                                    m
                                 
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       k
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                 ,
                              
                           
                         the complex coefficients 
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 w
                              
                              
                                 m
                              
                           
                         are to be determined from 
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 p
                              
                              
                                 n
                              
                           
                        . To achieve this, the control points are regarded as complex values 
                           
                              
                                 p
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           +
                           i
                           
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                        , the quantities in (6) being 
                           
                              
                                 d
                              
                              
                                 k
                              
                           
                           =
                           n
                           
                           [
                           
                           (
                           
                              
                                 x
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           )
                           +
                           i
                           
                           (
                           
                              
                                 y
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                           )
                           
                           ]
                        .

Equating (4) with (6) then gives a system of 
                           2
                           m
                           +
                           1
                         equations for the 
                           m
                           +
                           1
                         complex unknowns 
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 w
                              
                              
                                 m
                              
                           
                        . Specifically, for PH cubics, we obtain
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                    
                                       2
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                 ,
                                 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 
                                 ,
                                 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 
                                 ,
                              
                           
                         while for PH quintics the equations are
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                    
                                       2
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 
                                 ,
                                 
                                 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 
                                 ,
                                 
                                 
                                 2
                                 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 
                                 =
                                 
                                 3
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 
                                 ,
                                 
                                 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                 
                                 
                                 ,
                                 
                                 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                 
                                 
                                 .
                              
                           
                         Although there are more equations than unknowns, the fact that 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 d
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         are known to define a PH curve ensures that the equations are consistent, and it suffices to consider only the first (or last) 
                           m
                           +
                           1
                         equations to determine 
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 w
                              
                              
                                 m
                              
                           
                        . From the first two equations in the case of PH cubics, we obtain
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                 ,
                                 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                 ,
                              
                           
                         while the first three equations for PH quintics yield
                           
                              (24)
                              
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                 ,
                                 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                 ,
                                 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 
                                 =
                                 
                                 
                                    1
                                    
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    [
                                    
                                    3
                                    
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          2
                                          
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                    ]
                                 
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ≠
                           0
                         for a regular curve. In general, 
                           
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                           
                         admits two complex values, and the same value must be used in these expressions — the value chosen is immaterial, since they differ only in sign, and the complex polynomial 
                           w
                           (
                           t
                           )
                         is squared in (4). Alternatively, one may use
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                 ,
                                 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                 ,
                              
                           
                         for PH cubics (where 
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           ≠
                           0
                         for a regular curve), and
                           
                              (25)
                              
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          4
                                       
                                    
                                 
                                 
                                 ,
                                 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 
                                 =
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                                 
                                 ,
                                 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 
                                 =
                                 
                                 
                                    1
                                    
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                                 
                                    [
                                    
                                    3
                                    
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          2
                                          
                                          
                                             
                                                d
                                             
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                    ]
                                 
                              
                           
                         for PH quintics (where 
                           
                              
                                 d
                              
                              
                                 4
                              
                           
                           ≠
                           0
                         for a regular curve). The equivalence of these alternative forms arises from the fact that 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 d
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         are not independent for a PH curve. For PH cubics, their dependence can be compactly expressed (Farouki, 1994) by the complex constraint
                           7
                        
                        
                           7
                           This can be viewed as an alternative to conditions (11)–(12) — in the case of planar PH cubics — facilitated by use of the complex representation.
                         
                        
                           
                              
                                 d
                              
                              
                                 1
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                        . For PH quintics, the situation is more complicated (Farouki, 1994), since a number of special cases must be accommodated.


                        
                           Example 6
                           Consider the planar PH quintic of Example 1 shown in Fig. 2. For this curve, we obtain (to full precision) the coefficients
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       3.0088703625944260
                                       −
                                       1.2463149116090630
                                       
                                       i
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0.0038308962625464
                                       +
                                       4.5675312287005045
                                       
                                       i
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       3.0088703625944269
                                       −
                                       1.2463149116090637
                                       
                                       i
                                       
                                       ,
                                    
                                 
                               from the expressions (24) based on 
                                 
                                    
                                       d
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                               and
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       3.0088703625944211
                                       −
                                       1.2463149116090662
                                       
                                       i
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0.0038308962625461
                                       +
                                       4.5675312287005028
                                       
                                       i
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       3.0088703625944255
                                       −
                                       1.2463149116090635
                                       
                                       i
                                       
                                       ,
                                    
                                 
                               from the expressions (25) based on 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                 
                              . These two sets of values agree to at least 14 decimal places, consistent with the tolerance arising from the determination of its Bézier control points as a PH quintic interpolant to first-order Hermite data (the fact that 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                               are essentially identical reflects the symmetry of the curve). Analogous results were observed for the asymmetric PH quintic of Example 2, illustrated in Fig. 3.

The methods described above, for planar PH cubics and quintics, can be extended in a relatively straightforward manner to higher-order PH curves.

The reverse engineering of a spatial PH curve entails a determination of the quaternion polynomial 
                           A
                           (
                           t
                           )
                         in (5), given the curve control points. Namely, if 
                           A
                           (
                           t
                           )
                         is specified in Bernstein form as
                           
                              (26)
                              
                                 A
                                 (
                                 t
                                 )
                                 
                                 =
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       0
                                    
                                    m
                                 
                                 
                                    
                                       A
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       k
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                 ,
                              
                           
                         the coefficients 
                           
                              
                                 A
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 A
                              
                              
                                 m
                              
                           
                         must be computed. Equating (5) and (6) gives a system of 
                           2
                           m
                           +
                           1
                         vector equations for the 
                           m
                           +
                           1
                         quaternions 
                           
                              
                                 A
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 A
                              
                              
                                 m
                              
                           
                        . As in the planar case, there are more equations than unknowns, but the fact that 
                           
                              
                                 d
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 d
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         are known to define a PH curve ensures the consistency of these equations. Moreover, for spatial PH curves, the quaternion polynomial (26) that generates a particular hodograph 
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                           (
                           t
                           )
                         through expression (5) is not unique (Farouki et al., 2002). Namely, if 
                           A
                           (
                           t
                           )
                         generates 
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                           (
                           t
                           )
                        , then for any ϕ the polynomials
                           
                              (27)
                              
                                 
                                    
                                       A
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                 =
                                 
                                 A
                                 (
                                 t
                                 )
                                 
                                 exp
                                 ⁡
                                 (
                                 ϕ
                                 
                                 i
                                 )
                                 
                                 ,
                              
                           
                         where 
                           exp
                           ⁡
                           (
                           ϕ
                           
                           i
                           )
                           =
                           (
                           cos
                           ⁡
                           ϕ
                           ,
                           sin
                           ⁡
                           ϕ
                           
                           i
                           )
                        , also generates 
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                           (
                           t
                           )
                        . This indeterminacy is required for rotation invariance of the form (5), i.e., 
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                           (
                           t
                           )
                         must be expressible in the form (5), for a suitable 
                           A
                           (
                           t
                           )
                        , in a coordinate system of any orientation (Farouki et al., 2002). We focus below on reverse engineering of spatial PH cubics and quintics.

Equating (5) with (6) in the case of spatial PH cubics (
                              m
                              =
                              1
                           ) yields the system of three vector equations
                              
                                 (28)
                                 
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                    
                                    i
                                    
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                       
                                          ⁎
                                       
                                    
                                    
                                    =
                                    
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    
                                    ,
                                    
                                    vect
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                    
                                    i
                                    
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                       
                                          ⁎
                                       
                                    
                                    )
                                    
                                    =
                                    
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    
                                    ,
                                    
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    
                                    i
                                    
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                       
                                          ⁎
                                       
                                    
                                    
                                    =
                                    
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    
                                    ,
                                 
                              
                            for the two quaternion coefficients 
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                           . Setting 
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              =
                              |
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              |
                           , 
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              =
                              |
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              |
                            (where 
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              ≠
                              0
                            for a regular curve) and 
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              /
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                           , 
                              
                                 
                                    δ
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              /
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                            the first and third equations in (28) can be used (Farouki et al., 2008) to express 
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                            and 
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                            in the form
                              
                                 (29)
                                 
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                    
                                    =
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    exp
                                    ⁡
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                       
                                    
                                    i
                                    )
                                    
                                    and
                                    
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    
                                    =
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    exp
                                    ⁡
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          1
                                       
                                    
                                    i
                                    )
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                            are free parameters, and
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    
                                    =
                                    
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          i
                                       
                                       
                                          |
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          i
                                          
                                          |
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    
                                    =
                                    
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          i
                                       
                                       
                                          |
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          i
                                          
                                          |
                                       
                                    
                                 
                              
                            are the unit bisectors of 
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    2
                                 
                              
                            with i (for brevity, we discount the degenerate cases where 
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              =
                              −
                              
                              i
                            or 
                              
                                 
                                    δ
                                 
                                 
                                    2
                                 
                              
                              =
                              −
                              
                              i
                           , which require separate treatment).

Substituting from (29) into the second of Eqs. (28) and setting 
                              Δ
                              ϕ
                              =
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                            then gives the vector condition
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                    (
                                    u
                                    cos
                                    ⁡
                                    Δ
                                    ϕ
                                    +
                                    v
                                    sin
                                    ⁡
                                    Δ
                                    ϕ
                                    )
                                    
                                    =
                                    
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    
                                    ,
                                 
                              
                            where
                              
                                 (30)
                                 
                                    u
                                    
                                    =
                                    
                                    (
                                    i
                                    ⋅
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    (
                                    i
                                    ⋅
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    ⋅
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    
                                    i
                                    
                                    ,
                                    
                                    v
                                    
                                    =
                                    
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    ×
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    
                                    .
                                 
                              
                            The value of Δϕ must be chosen so as to ensure satisfaction of this condition. For generic data with 
                              i
                              ⋅
                              (
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              ×
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              )
                              ≠
                              0
                           , which is equivalent to 
                              i
                              ⋅
                              (
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              ×
                              
                                 
                                    δ
                                 
                                 
                                    2
                                 
                              
                              )
                              ≠
                              0
                           , the dot product of this equation with 
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ,
                              i
                            gives the scalar conditions
                              
                                 (31)
                                 
                                    (
                                    i
                                    ⋅
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    cos
                                    ⁡
                                    Δ
                                    ϕ
                                    
                                    =
                                    
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                0
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                    ,
                                    
                                    (
                                    i
                                    ⋅
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    cos
                                    ⁡
                                    Δ
                                    ϕ
                                    
                                    =
                                    
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (32)
                                 
                                    [
                                    
                                    2
                                    
                                    (
                                    i
                                    ⋅
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    (
                                    i
                                    ⋅
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    ⋅
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    
                                    ]
                                    cos
                                    ⁡
                                    Δ
                                    ϕ
                                    
                                    −
                                    
                                    i
                                    ⋅
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    ×
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    sin
                                    ⁡
                                    Δ
                                    ϕ
                                    
                                    =
                                    
                                    
                                       
                                          i
                                          ⋅
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                    .
                                 
                              
                            If 
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              ≠
                              −
                              
                              i
                            and 
                              
                                 
                                    δ
                                 
                                 
                                    2
                                 
                              
                              ≠
                              −
                              
                              i
                           , we have 
                              i
                              ⋅
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              ≠
                              0
                            and 
                              i
                              ⋅
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ≠
                              0
                           , so either of the two equations (31) can be used to determine 
                              cos
                              ⁡
                              Δ
                              ϕ
                            (the equivalence of these equations can be seen from the “canonical form” (16) of a spatial PH cubic). In general, 
                              cos
                              ⁡
                              Δ
                              ϕ
                            determines two values 
                              Δ
                              ϕ
                              ∈
                              [
                              
                              0
                              ,
                              2
                              π
                              )
                            and the appropriate value must be determined by checking the satisfaction of (32). Once Δϕ has been computed, 
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                            can be freely specified, and then with 
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                              +
                              Δ
                              ϕ
                            the desired quaternion coefficients are determined from (29).


                           
                              Example 7
                              Consider the spatial PH cubic defined (Farouki and Sakkalis, 1994) by the control points
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                0
                                             
                                          
                                          =
                                          (
                                          0
                                          ,
                                          0
                                          ,
                                          0
                                          )
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          (
                                          2
                                          
                                             3
                                          
                                          ,
                                          0
                                          ,
                                          2
                                          )
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          (
                                          2
                                          
                                             3
                                          
                                          ,
                                          0
                                          ,
                                          8
                                          )
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                3
                                             
                                          
                                          =
                                          (
                                          −
                                          
                                             3
                                          
                                          ,
                                          9
                                          ,
                                          14
                                          )
                                          
                                          .
                                       
                                    
                                  One can verify that this curve has the polynomial parametric speed 
                                    σ
                                    (
                                    t
                                    )
                                    =
                                    10
                                    
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    2
                                    
                                    t
                                    +
                                    4
                                 . To full precision, the quaternion coefficients computed by the above method (choosing 
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    0
                                 ) are
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                0
                                             
                                          
                                          =
                                          0.0000000000000000
                                          +
                                          3.3460652149512313
                                          
                                          i
                                          +
                                          0.0000000000000000
                                          
                                          j
                                          +
                                          0.8965754721680534
                                          
                                          k
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          2.8977774788672042
                                          +
                                          1.3448632082520799
                                          
                                          i
                                          −
                                          0.7764571353075622
                                          
                                          j
                                          +
                                          5.0190978224268470
                                          
                                          k
                                          
                                          .
                                       
                                    
                                  When the control points 
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                  are recomputed from these coefficients, through the expressions
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                          
                                             
                                                A
                                             
                                             
                                                0
                                             
                                          
                                          
                                          i
                                          
                                          
                                             
                                                A
                                             
                                             
                                                0
                                             
                                          
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                          vect
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                0
                                             
                                          
                                          
                                          i
                                          
                                          
                                             
                                                A
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                3
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             1
                                             3
                                          
                                          
                                          
                                             
                                                A
                                             
                                             
                                                1
                                             
                                          
                                          
                                          i
                                          
                                          
                                             
                                                A
                                             
                                             
                                                1
                                             
                                          
                                          
                                          ,
                                       
                                    
                                  their errors relative to the originally-specified points are found to be
                                    
                                       
                                          6
                                          ×
                                          
                                             
                                                10
                                             
                                             
                                                −
                                                16
                                             
                                          
                                          
                                          ,
                                          
                                          35
                                          ×
                                          
                                             
                                                10
                                             
                                             
                                                −
                                                16
                                             
                                          
                                          
                                          ,
                                          
                                          46
                                          ×
                                          
                                             
                                                10
                                             
                                             
                                                −
                                                16
                                             
                                          
                                          
                                          .
                                       
                                    
                                  Furthermore, it is verified from the implementation that the relative accuracy of 
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                  is insensitive to the choice of 
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                       
                                    
                                 .

Given the Bézier control points 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    p
                                 
                                 
                                    5
                                 
                              
                            of a spatial PH quintic, the reverse engineering problem consists of determining the three quaternion coefficients 
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                            from the five vector equations
                              
                                 (33)
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                          
                                             ⁎
                                          
                                       
                                       
                                       =
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       
                                       ,
                                       
                                       vect
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       )
                                       
                                       =
                                       
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       2
                                       
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       +
                                       vect
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                          
                                             ⁎
                                          
                                       
                                       )
                                       
                                       =
                                       
                                       3
                                       
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       vect
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                          
                                             ⁎
                                          
                                       
                                       )
                                       
                                       =
                                       
                                       
                                          
                                             d
                                          
                                          
                                             3
                                          
                                       
                                       
                                       ,
                                       
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                          
                                             ⁎
                                          
                                       
                                       
                                       =
                                       
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                       
                                       ,
                                    
                                 
                              
                            with 
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              =
                              5
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              )
                            for 
                              i
                              =
                              0
                              ,
                              …
                              ,
                              4
                           . Setting 
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              =
                              |
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              |
                            (where 
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    4
                                 
                              
                              ≠
                              0
                            for a regular curve) and 
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              /
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                           , 
                              
                                 
                                    δ
                                 
                                 
                                    4
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    4
                                 
                              
                              /
                              
                                 
                                    d
                                 
                                 
                                    4
                                 
                              
                           , we consider again only the generic case 
                              i
                              ⋅
                              (
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              ×
                              
                                 
                                    δ
                                 
                                 
                                    4
                                 
                              
                              )
                              ≠
                              0
                           . Then the first and fifth equations in (33) yield
                              
                                 (34)
                                 
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                    
                                    =
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    exp
                                    ⁡
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                       
                                    
                                    i
                                    )
                                    
                                    and
                                    
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    
                                    =
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    exp
                                    ⁡
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          2
                                       
                                    
                                    i
                                    )
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    2
                                 
                              
                            are free parameters, and
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    
                                    =
                                    
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          i
                                       
                                       
                                          |
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          i
                                          
                                          |
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    
                                    =
                                    
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          i
                                       
                                       
                                          |
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          i
                                          
                                          |
                                       
                                    
                                 
                              
                            are the unit bisectors of 
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    4
                                 
                              
                            with i. Substituting from (34) into the second of Eqs. (33), one can deduce the expression
                              8
                           
                           
                              8
                              An analogous expression can also be obtained from the fourth of Eqs. (33).
                           
                           
                              
                                 (35)
                                 
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    
                                    =
                                    
                                    −
                                    
                                    
                                       
                                          (
                                          ζ
                                          ,
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          
                                          
                                             
                                                n
                                             
                                             
                                                0
                                             
                                          
                                          exp
                                          ⁡
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                0
                                             
                                          
                                          i
                                          )
                                          
                                          i
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                    ,
                                 
                              
                            where ζ is a free real parameter. Forming the product 
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              
                              i
                              
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                                 
                                    ⁎
                                 
                              
                            from (35), and noting that 
                              2
                              
                              (
                              i
                              ⋅
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              )
                              
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              −
                              i
                              =
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                           , after some simplification we obtain
                              
                                 (36)
                                 
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    
                                    i
                                    
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                       
                                          ⁎
                                       
                                    
                                    
                                    =
                                    
                                    
                                       
                                          
                                             
                                                ζ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          2
                                          
                                          ζ
                                          
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                0
                                             
                                          
                                          ×
                                          
                                             
                                                δ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          2
                                          
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                δ
                                             
                                             
                                                0
                                             
                                          
                                          ⋅
                                          
                                             
                                                δ
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                    .
                                 
                              
                            Also, using the expressions (34) gives
                              
                                 (37)
                                 
                                    vect
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                    
                                    i
                                    
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                       
                                          ⁎
                                       
                                    
                                    )
                                    
                                    =
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                    
                                    (
                                    u
                                    cos
                                    ⁡
                                    Δ
                                    ϕ
                                    +
                                    v
                                    sin
                                    ⁡
                                    Δ
                                    ϕ
                                    )
                                    
                                    ,
                                 
                              
                            where 
                              Δ
                              ϕ
                              =
                              
                                 
                                    ϕ
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                           , and 
                              u
                              ,
                              v
                            are as defined in (30).

Substituting (36) and (37) into the third of Eqs. (33) then yields the vector condition
                              
                                 (38)
                                 
                                    2
                                    
                                    
                                       
                                          ζ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    4
                                    
                                    ζ
                                    
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          0
                                       
                                    
                                    ×
                                    
                                       
                                          δ
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    u
                                    cos
                                    ⁡
                                    Δ
                                    ϕ
                                    +
                                    v
                                    sin
                                    ⁡
                                    Δ
                                    ϕ
                                    )
                                    =
                                    3
                                    
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    2
                                    
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    4
                                    
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                    (
                                    
                                       
                                          δ
                                       
                                       
                                          0
                                       
                                    
                                    ⋅
                                    
                                       
                                          δ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          δ
                                       
                                       
                                          1
                                       
                                    
                                    
                                    .
                                 
                              
                            This defines an over-determined system of three scalar conditions on the two parameters ζ and Δϕ, but the system is consistent if the given data define a spatial PH quintic. Now the cross product of the vectors (30) simplifies to
                              
                                 
                                    u
                                    ×
                                    v
                                    
                                    =
                                    
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          4
                                       
                                    
                                    (
                                    
                                       
                                          δ
                                       
                                       
                                          4
                                       
                                    
                                    −
                                    
                                       
                                          δ
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    
                                    ,
                                 
                              
                            and is non-zero under the stated assumption 
                              i
                              ⋅
                              (
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              ×
                              
                                 
                                    δ
                                 
                                 
                                    4
                                 
                              
                              )
                              ≠
                              0
                           . The variable Δϕ can thus be eliminated from (38) by taking its dot product with 
                              u
                              ×
                              v
                            to obtain a quadratic equation
                              
                                 (39)
                                 
                                    a
                                    
                                    
                                       
                                          ζ
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    b
                                    
                                    ζ
                                    +
                                    c
                                    
                                    =
                                    
                                    0
                                    
                                    ,
                                 
                              
                            in ζ with the coefficients 
                              a
                              =
                              2
                              (
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              ⋅
                              
                                 
                                    δ
                                 
                                 
                                    4
                                 
                              
                              −
                              1
                              )
                           , 
                              b
                              =
                              −
                              
                              4
                              
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              ×
                              
                                 
                                    δ
                                 
                                 
                                    1
                                 
                              
                              )
                              ⋅
                              
                                 
                                    δ
                                 
                                 
                                    4
                                 
                              
                           , and 
                              c
                              =
                              (
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              −
                              
                                 
                                    δ
                                 
                                 
                                    4
                                 
                              
                              )
                              ⋅
                              (
                              3
                              
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              +
                              2
                              
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              −
                              4
                              
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                              (
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              ⋅
                              
                                 
                                    δ
                                 
                                 
                                    1
                                 
                              
                              )
                              
                                 
                                    δ
                                 
                                 
                                    1
                                 
                              
                              )
                           . The discriminant of (39) must satisfy 
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              −
                              4
                              a
                              c
                              ≥
                              0
                            — this is a (non-obvious) consequence of the fact that 
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    d
                                 
                                 
                                    4
                                 
                              
                            define a PH quintic. For each root ζ of (39), corresponding values for Δϕ must be computed. This is achieved by taking the dot product of Eq. (38) with i, thereby reducing it to
                              
                                 (40)
                                 
                                    cos
                                    ⁡
                                    (
                                    Δ
                                    ϕ
                                    −
                                    ψ
                                    )
                                    
                                    =
                                    
                                    
                                       
                                          r
                                          (
                                          ζ
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                    ,
                                 
                              
                            where we set 
                              p
                              =
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              
                              i
                              ⋅
                              u
                           , 
                              q
                              =
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              
                              i
                              ⋅
                              v
                           ,
                              
                                 
                                    r
                                    (
                                    ζ
                                    )
                                    
                                    =
                                    
                                    i
                                    ⋅
                                    [
                                    
                                    3
                                    
                                    
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    2
                                    
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    4
                                    
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                    (
                                    
                                       
                                          δ
                                       
                                       
                                          0
                                       
                                    
                                    ⋅
                                    
                                       
                                          δ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          δ
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    2
                                    
                                    
                                       
                                          ζ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    4
                                    
                                    ζ
                                    
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          0
                                       
                                    
                                    ×
                                    
                                       
                                          δ
                                       
                                       
                                          1
                                       
                                    
                                    
                                    ]
                                    
                                    ,
                                 
                              
                            and ψ is uniquely determined by
                              
                                 (41)
                                 
                                    cos
                                    ⁡
                                    ψ
                                    
                                    =
                                    
                                    
                                       p
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                    ,
                                    
                                    sin
                                    ⁡
                                    ψ
                                    
                                    =
                                    
                                    
                                       q
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                    .
                                 
                              
                            If a root ζ is such that the condition
                              
                                 (42)
                                 
                                    |
                                    r
                                    (
                                    ζ
                                    )
                                    |
                                    
                                    ≤
                                    
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                q
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            is not satisfied, it must be rejected. If ζ is such that (42) is satisfied, Eq. (40) identifies, in general, two corresponding values 
                              Δ
                              ϕ
                              ∈
                              [
                              
                              0
                              ,
                              2
                              π
                              
                              ]
                           .

Up to four distinct solutions 
                              (
                              ζ
                              ,
                              Δ
                              ϕ
                              )
                            are determined in this manner. For each solution, with (say) 
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                            freely chosen and 
                              
                                 
                                    ϕ
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                              +
                              Δ
                              ϕ
                           , corresponding quaternions coefficients 
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                            may be computed by means of (34)–(35). In general, only one set of coefficients generates (within a given tolerance) the prescribed vectors 
                              
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    d
                                 
                                 
                                    4
                                 
                              
                            using (33), and the others must be discarded. The coefficients are unique only modulo a common factor 
                              exp
                              ⁡
                              (
                              ϕ
                              
                              i
                              )
                            for any ϕ, reflecting the free choice of 
                              
                                 
                                    ϕ
                                 
                                 
                                    0
                                 
                              
                            (or 
                              
                                 
                                    ϕ
                                 
                                 
                                    2
                                 
                              
                           ) — as noted in expression (27). Once 
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                            have been determined, the control points can be computed from them (and a given initial point 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                           ) through the expressions
                              
                                 (43)
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                       
                                       +
                                       
                                       
                                          1
                                          5
                                       
                                       
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                          
                                             ⁎
                                          
                                       
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             1
                                          
                                       
                                       
                                       +
                                       
                                       
                                          1
                                          10
                                       
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       +
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                          
                                             ⁎
                                          
                                       
                                       )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                       
                                       +
                                       
                                       
                                          1
                                          30
                                       
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                          
                                             ⁎
                                          
                                       
                                       +
                                       4
                                       
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       +
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                          
                                             ⁎
                                          
                                       
                                       )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             4
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                       
                                       +
                                       
                                       
                                          1
                                          10
                                       
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                          
                                             ⁎
                                          
                                       
                                       +
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             5
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             4
                                          
                                       
                                       
                                       +
                                       
                                       
                                          1
                                          5
                                       
                                       
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       
                                       i
                                       
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                          
                                             ⁎
                                          
                                       
                                       
                                       .
                                    
                                 
                              
                           
                        


                           
                              Example 8
                              Consider the quintic space curve (see Fig. 5
                                 ) specified by the Bézier control points
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                0
                                             
                                          
                                          =
                                          (
                                          0
                                          ,
                                          0
                                          ,
                                          0
                                          )
                                          ,
                                          
                                          
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          (
                                          0
                                          ,
                                          −
                                          
                                             2
                                             5
                                          
                                          ,
                                          0
                                          )
                                          ,
                                          
                                          
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          (
                                          
                                             3
                                             5
                                          
                                          ,
                                          −
                                          
                                             1
                                             5
                                          
                                          ,
                                          
                                             2
                                             5
                                          
                                          )
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                3
                                             
                                          
                                          =
                                          (
                                          
                                             4
                                             15
                                          
                                          ,
                                          
                                             8
                                             15
                                          
                                          ,
                                          
                                             1
                                             15
                                          
                                          )
                                          ,
                                          
                                          
                                          
                                             
                                                p
                                             
                                             
                                                4
                                             
                                          
                                          =
                                          (
                                          
                                             2
                                             3
                                          
                                          ,
                                          
                                             11
                                             15
                                          
                                          ,
                                          
                                             1
                                             15
                                          
                                          )
                                          ,
                                          
                                          
                                          
                                             
                                                p
                                             
                                             
                                                5
                                             
                                          
                                          =
                                          (
                                          
                                             2
                                             3
                                          
                                          ,
                                          
                                             11
                                             15
                                          
                                          ,
                                          −
                                          
                                             1
                                             3
                                          
                                          )
                                          .
                                       
                                    
                                  By the methods of Section 3 it is identified as a PH curve, with parametric speed is 
                                    σ
                                    (
                                    t
                                    )
                                    =
                                    2
                                    
                                    (
                                    19
                                    
                                    
                                       
                                          t
                                       
                                       
                                          4
                                       
                                    
                                    −
                                    40
                                    
                                    
                                       
                                          t
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    27
                                    
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    6
                                    
                                    t
                                    +
                                    1
                                    )
                                 . Equation (39) has the roots 
                                    ζ
                                    =
                                    0
                                  and 6, and since 
                                    p
                                    =
                                    2
                                  and 
                                    q
                                    =
                                    −
                                    
                                    2
                                  in (41), we have 
                                    ψ
                                    =
                                    −
                                    
                                       1
                                       4
                                    
                                    
                                    π
                                 . For 
                                    ζ
                                    =
                                    6
                                  condition (42) is violated, so this root must be discarded, but with 
                                    ζ
                                    =
                                    0
                                  we have 
                                    r
                                    (
                                    ζ
                                    )
                                    /
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                q
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    1
                                    /
                                    
                                       2
                                    
                                 , and 
                                    Δ
                                    ϕ
                                    −
                                    ψ
                                    =
                                    
                                       1
                                       4
                                    
                                    
                                    π
                                  or 
                                    
                                       7
                                       4
                                    
                                    
                                    π
                                 . Hence, 
                                    Δ
                                    ϕ
                                    =
                                    0
                                  or 
                                    
                                       3
                                       2
                                    
                                    
                                    π
                                 . Choosing 
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    0
                                  and 
                                    
                                       
                                          ϕ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    Δ
                                    ϕ
                                 , and computing 
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                  from (34) and (35), the former choice yields agreement with the vectors 
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    5
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    )
                                  computed from (33), but the latter does not. Hence, 
                                    ζ
                                    =
                                    0
                                  and 
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          ϕ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    0
                                  identify the correct solution (any 
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                       
                                    
                                  value can be chosen, provided that 
                                    
                                       
                                          ϕ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                       
                                    
                                 ). When 
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                  are computed from (34) and (35) in this manner, using double precision arithmetic, they are found to agree with the coefficients 
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    i
                                    −
                                    j
                                 , 
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    1
                                    +
                                    i
                                    +
                                    2
                                    
                                    j
                                    +
                                    k
                                 , 
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    i
                                    −
                                    k
                                 , from which the curve control points were initially generated using (43), to an accuracy of 
                                    ∼
                                    
                                       
                                          10
                                       
                                       
                                          −
                                          15
                                       
                                    
                                 . The relative errors in 
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          5
                                       
                                    
                                  (computed using the reverse-engineered coefficients) are found to be
                                    
                                       
                                          0
                                          ×
                                          
                                             
                                                10
                                             
                                             
                                                −
                                                16
                                             
                                          
                                          
                                          ,
                                          
                                          2
                                          ×
                                          
                                             
                                                10
                                             
                                             
                                                −
                                                16
                                             
                                          
                                          
                                          ,
                                          
                                          13
                                          ×
                                          
                                             
                                                10
                                             
                                             
                                                −
                                                16
                                             
                                          
                                          
                                          ,
                                          
                                          33
                                          ×
                                          
                                             
                                                10
                                             
                                             
                                                −
                                                16
                                             
                                          
                                          
                                          ,
                                          
                                          31
                                          ×
                                          
                                             
                                                10
                                             
                                             
                                                −
                                                16
                                             
                                          
                                          
                                          .
                                       
                                    
                                 
                              


                           
                              Example 9
                              The preceding example was constructed so as to have a simple known pre-image polynomial. As a more general example, we consider the spatial PH quintic interpolant (see Fig. 5) to the first-order Hermite data
                                    
                                       
                                          r
                                          (
                                          0
                                          )
                                          =
                                          (
                                          0
                                          ,
                                          0
                                          ,
                                          0
                                          )
                                          ,
                                          
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          0
                                          )
                                          =
                                          (
                                          2
                                          ,
                                          −
                                          1
                                          ,
                                          −
                                          1
                                          )
                                          
                                          and
                                          
                                          r
                                          (
                                          1
                                          )
                                          =
                                          (
                                          1
                                          ,
                                          1
                                          ,
                                          1
                                          )
                                          ,
                                          
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          1
                                          )
                                          =
                                          (
                                          0
                                          ,
                                          2
                                          ,
                                          3
                                          )
                                       
                                    
                                  using 
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          ϕ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    0
                                  in the interpolation algorithm (Farouki et al., 2008). For this curve, 
                                    
                                       
                                          p
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    r
                                    (
                                    0
                                    )
                                 , 
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    r
                                    (
                                    0
                                    )
                                    +
                                    
                                       1
                                       5
                                    
                                    
                                    
                                       
                                          r
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    0
                                    )
                                  and 
                                    
                                       
                                          p
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    r
                                    (
                                    1
                                    )
                                    −
                                    
                                       1
                                       5
                                    
                                    
                                    
                                       
                                          r
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    1
                                    )
                                 , 
                                    
                                       
                                          p
                                       
                                       
                                          5
                                       
                                    
                                    =
                                    r
                                    (
                                    1
                                    )
                                 , while to full precision the two interior control points obtained from the algorithm are
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          
                                          =
                                          
                                          (
                                          0.7746664443097209
                                          ,
                                          −
                                          0.0209484017535140
                                          ,
                                          −
                                          0.1326892881613731
                                          )
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                3
                                             
                                          
                                          
                                          =
                                          
                                          (
                                          0.9601287216055423
                                          ,
                                          0.2353431635591809
                                          ,
                                          0.0635268956967925
                                          )
                                          
                                          .
                                       
                                    
                                  When 
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          5
                                       
                                    
                                  are recomputed from the reverse-engineered coefficients 
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                  using expressions (43), their errors relative to the original control points are found to be
                                    
                                       
                                          2
                                          ×
                                          
                                             
                                                10
                                             
                                             
                                                −
                                                16
                                             
                                          
                                          
                                          ,
                                          
                                          1
                                          ×
                                          
                                             
                                                10
                                             
                                             
                                                −
                                                16
                                             
                                          
                                          
                                          ,
                                          
                                          25
                                          ×
                                          
                                             
                                                10
                                             
                                             
                                                −
                                                16
                                             
                                          
                                          
                                          ,
                                          
                                          33
                                          ×
                                          
                                             
                                                10
                                             
                                             
                                                −
                                                16
                                             
                                          
                                          
                                          ,
                                          
                                          23
                                          ×
                                          
                                             
                                                10
                                             
                                             
                                                −
                                                16
                                             
                                          
                                          
                                          ,
                                       
                                    
                                  so the reverse-engineering is also very accurate in this more general context.


                           
                              Remark 3
                              In various contexts, the roots of the parametric speed 
                                    σ
                                    (
                                    t
                                    )
                                  are required, e.g., in computing the absolute rotation index (Farouki and Neff, 1995), elastic bending energy (Farouki, 1996), and rotation-minimizing frames (Farouki, 2002), which require partial-fraction decompositions of rational integrands with 
                                    σ
                                    (
                                    t
                                    )
                                  as denominator. The roots can be computed after completing the reverse-engineering process, by setting 
                                    σ
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          |
                                          w
                                          (
                                          t
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                  or 
                                    
                                       
                                          |
                                          A
                                          (
                                          t
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                  for planar or spatial PH curves, respectively.

Two simple methods have been presented to identify whether or not a given polynomial curve, specified by its Bézier control points, has a Pythagorean hodograph. The first method checks a system of constraints on the control-polygon legs, enumerated explicitly for the case of cubics and quintics. The second method computes arc length estimates through numerical quadrature rules with polynomial precision on successively augmented node sets.

Both methods apply equally to planar and spatial PH curves. Computed examples indicate that they can both distinguish PH curves from “ordinary” polynomial curves to an accuracy of 
                        ∼
                        
                           
                              10
                           
                           
                              −
                              14
                           
                        
                      or better using double precision arithmetic. The first method employs only the curve control points, but the second method also requires storage of the quadrature nodes and weights. However, the quadrature method is perhaps preferable in terms of efficiency and straightforward extensibility to PH curves of degree 7 or higher.

The proposed methods provide a practical means of importing PH curves into existing CAD systems without modification of prevailing representation schemes. Once the control points have been identified as defining a PH curve, the reverse engineering procedures allow very accurate reconstruction of the complex or quaternion pre-image polynomials (for planar and spatial curves, respectively) in double-precision arithmetic, so the advantageous properties of PH curves can be fully exploited. These include closed-form solutions for arc lengths, offset curves, and elastic bending energy (Farouki, 1996; Farouki and Sakkalis, 1990); real-time CNC interpolators for constant or variable feedrates along curved paths (Farouki et al., 1998; Farouki and Shah, 1996); a diverse family of sweep operations yielding rational surfaces (Farouki and Nittler, 2015); and rational rotation-minimizing frames along space curves (Farouki, 2010; Farouki et al., 2012).

@&#ACKNOWLEDGEMENTS@&#

This work was supported by the Gruppo Nazionale per il Calcolo Scientifico (GNCS) of the Istituto Nazionale di Alta Matematica Francesco Severi (INdAM) and by the project DREAMS (MIUR “Futuro in Ricerca” RBFR13FBI3).

@&#REFERENCES@&#

