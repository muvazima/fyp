@&#MAIN-TITLE@&#Penalty functions based upon a general class of restricted dissimilarity functions

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           General results about the class of restricted dissimilarity functions.


                        
                        
                           
                           A subclass of restricted dissimilarity functions based on automorphisms.


                        
                        
                           
                           A model of generation of penalty functions by means of automorphisms.


                        
                        
                           
                           A characterization theorem of the generators of penalty functions of any dimension.


                        
                        
                           
                           The existence of not convex generators is shown.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Restricted dissimilarity function

Penalty function

Quasi-convexity

@&#ABSTRACT@&#


               
               
                  In this paper the notion of restricted dissimilarity function is discussed and some general results are shown. The relation between the concepts of restricted dissimilarity function and penalty function is presented. A specific model of construction of penalty functions by means of a wide class of restricted dissimilarity functions based upon automorphisms of the unit interval is studied. A characterization theorem of the automorphisms which give rise to two-dimensional penalty functions is proposed. A generalization of the previous theorem to any dimension n > 2 is also provided. Finally, a not convex example of generator of penalty functions of arbitrary dimension is illustrated.
               
            

@&#INTRODUCTION@&#

The notion of penalty based aggregation function has become increasingly popular in the literature over the last few years (see, for instance, Calvo and Beliakov, 2010 and the references therein). In Bustince, Jurio, Pradera, Mesiar, and Beliakov (2013), the authors suggest the use of penalty functions for selecting alternatives in decision making problems. In particular, they build penalty functions by means of a particular class of restricted dissimilarity functions (see Bustince, Barrenechea, and Pagola, 2008), called faithful restricted dissimilarity functions, in order to generalize one of the most widely used methods in decision making, that is the weighted voting method (see, for example, Hüllermeier and Brinker, 2008; Hüllermeier and Vanderlooy, 2010). From a mere theoretical point of view, a faithful restricted dissimilarity function is strictly related to a convex automorphism of the real unit interval up to a bijection. As the authors somehow admit, there is no real reason for imposing convexity restriction other than to assure that the corresponding penalty function is convex, so fulfilling, a fortiori, the crucial property of quasi-convexity demanded to all penalty functions.

This consideration has led us to the main goal of this paper: to characterize a class of restricted dissimilarity functions, wider than the faithful restricted dissimilarity functions, able to assure that the generated one-variable mappings, constructed in the same way as in Bustince et al. (2013), turn out to be penalty functions.

We have organized this paper as follows: In the next section we introduce the basic notions needed for subsequent developments. In Section 3 we analyze the limited cases in which a restricted dissimilarity function is also a distance and mostly we study a model of construction of penalty functions by means of a general subclass of restricted dissimilarity functions strictly connected to automorphisms of the real unit interval, also called generators. In Section 4, we characterize the class of generators of two-dimensional penalty functions, while in Section 5 we extend the two-dimensional result to any dimension n > 2. Finally, we present a conclusion and some references.

In this article, we will make use of the following notations and assumptions.

Our domain of interest is the real unit interval, denoted by 
                        
                           I
                           ,
                        
                      being clear that it might be replaced without loss of generality by any closed, non-empty subinterval of the real line. We adopt the classical notation x = (x
                     1, …, xn
                     ) for any n-tuple x in 
                        
                           
                              
                                 I
                              
                              n
                           
                           ,
                        
                      while x
                     ↗ = (x
                     (1), …, x
                     (n)) represents the result of the permutation of the components of x in increasing order, i.e. x
                     (1) ≤ x
                     (2) ≤ … ≤ x
                     (n). We denote by Wn
                      the set of weighting vectors of dimension n, i.e. 
                        
                           
                              W
                              n
                           
                           =
                           
                              {
                              w
                              ∈
                              ]
                           
                           0
                           ,
                           1
                           
                              [
                              
                                 
                                 n
                              
                              :
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 n
                              
                              
                                 w
                                 i
                              
                              =
                              1
                              }
                           
                        
                     . We will exclusively reserve the symbol w for any weighting vector: further, 
                        
                           
                              w
                           
                           n
                           *
                        
                      stands for the weighting vector given by (1/n, …, 1/n).

                        Definition 2.1
                        Let 
                              
                                 
                                    x
                                    0
                                 
                                 ∈
                                 I
                                 ,
                              
                            
                           μ > 0 and 
                              
                                 E
                                 ⊂
                                 I
                              
                           . Then, we set

                              
                                 (2.1)
                                 
                                    
                                       μ
                                       E
                                       =
                                       {
                                       μ
                                       ·
                                       x
                                       :
                                       x
                                       ∈
                                       E
                                       }
                                    
                                 
                              
                           and

                              
                                 (2.2)
                                 
                                    
                                       E
                                       ±
                                       
                                          {
                                          
                                             x
                                             0
                                          
                                          }
                                       
                                       =
                                       
                                          {
                                          t
                                          ±
                                          
                                             x
                                             0
                                          
                                          :
                                          t
                                          ∈
                                          E
                                          }
                                       
                                       .
                                    
                                 
                              
                           
                        

We warn the reader that throughout the paper the notion of monotonicity is intended in weak sense: otherwise, we speak of strict monotonicity. Moreover, when we say that a property holds almost everywhere (for short, a.e.), it is intended that it is true outside a set of Lebesgue measure, denoted by λ, equal to zero.

Consider now the following definition.

                        Definition 2.2
                        
                           Bustince et al., 2011; Calvo and Beliakov, 2010
                        


                        Let 
                              
                                 P
                                 :
                                 
                                    
                                       I
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 →
                                 
                                    [
                                    0
                                    ,
                                    ∞
                                    ]
                                 
                              
                           . We say that P is a penalty function of dimension n if, and only if, satisfies:

                              
                                 (i)
                                 
                                    
                                       
                                          P
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          =
                                          0
                                       
                                     if xi
                                     = y for all i ∈ {1, …, n};

for every fixed 
                                       
                                          x
                                          ∈
                                          
                                             
                                                I
                                             
                                             n
                                          
                                          ,
                                       
                                     the set of minimizers of the mapping 
                                       
                                          y
                                          ↦
                                          P
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                     is a subinterval of 
                                       
                                          I
                                          ,
                                       
                                     possibly reducible to a singleton.

The penalty based function 
                              
                                 f
                                 :
                                 
                                    
                                       I
                                    
                                    n
                                 
                                 →
                                 I
                              
                            is given by

                              
                                 
                                    
                                       f
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       arg
                                       
                                          min
                                          y
                                       
                                       P
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                    
                                 
                              
                           if y is the unique minimizer or y = (a + b)/2 if the set of minimizers is a subinterval of 
                              I
                            with bounds a and b.

A penalty function is a tool for measuring the disagreement between the input x and the value y. The penalty based function f associates with any input x the corresponding output value y which just minimizes the chosen disagreement.

The first, prototypical model of penalty function appeared in the literature was of the form

                        
                           (2.3)
                           
                              
                                 P
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    d
                                    p
                                 
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    ,
                                    y
                                    )
                                 
                                 ,
                              
                           
                        
                     where 
                        
                           
                              d
                              p
                           
                           :
                           
                              
                                 I
                              
                              2
                           
                           →
                           I
                        
                      is given by dp
                     (x, y) = |x − y|
                        p
                     , for p ≥ 1. In particular, the cases p = 1 and p = 2 were already studied by Fermat, Laplace and Cauchy (see Hudry, Leclerc, Monjardet, and Barthélemy, 2010; Torra and Narukawa, 2007 and the references therein). When p = 1, the penalty function is obtained as sum of the (Euclidean) distances of the components of the input x to the value y. The model is then generalized replacing d
                     1 with dp
                     , with the crucial difference that only d
                     1 is a distance in mathematical sense. We will return to this point later.

The notion of penalty function is closely related to the dissimilarity function, as proposed and discussed in Mesiar (2007), even if this concept in its turn is inspired to a first formulation of penalty function given by Calvo, Mesiar, and Yager (2004) which is quite different from the above one. Our version fundamentally coincides with the most general one as it appears in Calvo and Beliakov (2010), except for the redundant requirement P(x, y) ≥ 0 for all x, y, here dropped.

In some papers, condition (ii) is replaced by the requirement that the mapping y↦P(x, y) is quasi-convex for any fixed 
                        
                           x
                           ∈
                           
                              
                                 I
                              
                              n
                           
                        
                     . Recall that a real function g over a convex subset X of 
                        
                           R
                           n
                        
                      is quasi-convex if its level sets Lc
                      = {x ∈ X: g(x) ≤ c} are convex (see Greenberg and Pierskalla, 1971 for a thorough exposition of the notion of quasi-convexity). It is well-known that if g is a function of a single variable, then g is quasi-convex if, and only if, either it is monotone or there exists a x* ∈ X such that g is decreasing on {x ∈ X: x ≤ x*} and increasing on {x ∈ X: x ≥ x*}. Therefore, it is clear that quasi-convexity is a stronger condition than (ii).

The restricted dissimilarity functions were introduced by Bustince et al. (2008) and are inspired, among others, to the notions of proximity and dissimilarity measures, as they appear in Fan and Xie (1999) and Liu (1992), respectively. In the applications, they turn out to be very useful, for instance, in image processing, in order to measure the dissimilarity of two objects, while, from a theoretical point of view, they are more flexible than existing dissimilarity functions.

                        Definition 2.3
                        A mapping 
                              
                                 
                                    d
                                    R
                                 
                                 :
                                 
                                    
                                       I
                                    
                                    2
                                 
                                 →
                                 I
                              
                            is called a restricted dissimilarity function if :

                              
                                 (D1)
                                 
                                    dR
                                    (x, y) = dR
                                    ( y, x) for every 
                                       
                                          x
                                          ,
                                          y
                                          ∈
                                          I
                                       
                                    ;


                                    dR
                                    (x, y) = 1 if, and only if, {x, y} = {0, 1};


                                    dR
                                    (x, y) = 0 if, and only if, x = y;


                                    dR
                                    (y, z) ≤ dR
                                    (x, t) for all 
                                       
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          ,
                                          t
                                          ∈
                                          I
                                       
                                     such that x ≤ y ≤ z ≤ t.

In the sequel, we will exclusively deal with continuous restricted dissimilarity functions. This is not a too strong assumption, since we know that, fixed any 
                        
                           x
                           ∈
                           I
                           ,
                        
                      the mapping t↦dR
                     (x, t) is quasi-convex (see Bustince et al., 2011), hence it is also continuous on 
                        I
                      up to a subset Ex
                      of 
                        I
                      such that λ(Ex
                     ) = 0 (see Greenberg and Pierskalla, 1971). The next result just shows that if Ex
                      = ∅ for all 
                        
                           x
                           ∈
                           I
                           ,
                        
                      then dR
                      is continuous as two-place function.

                        Proposition 2.4
                        Let dR
                            be a restricted dissimilarity function. Then dR
                            is continuous if, and only if, the mapping t↦dR
                           (x, t) is continuous on 
                              I
                            for every fixed 
                              
                                 x
                                 ∈
                                 I
                              
                           .

First of all, notice that, by (D1), the assumption may be equivalently formulated as continuity of the mapping t↦dR
                           (t, x) for every fixed 
                              
                                 x
                                 ∈
                                 I
                              
                           . Given an arbitrary point (x
                           0, y
                           0) of 
                              
                                 
                                    
                                       I
                                    
                                    2
                                 
                                 ,
                              
                            we have to show that for any real ɛ > 0 there exists a neighborhood U of (x
                           0, y
                           0) such that

                              
                                 
                                    
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             0
                                          
                                          ,
                                          
                                             y
                                             0
                                          
                                          )
                                       
                                       −
                                       ɛ
                                       ≤
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       ≤
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             0
                                          
                                          ,
                                          
                                             y
                                             0
                                          
                                          )
                                       
                                       +
                                       ɛ
                                    
                                 
                              
                           for all (x, y) ∈ U. Let us divide the proof into four cases, according to the position of (x
                           0, y
                           0).

Case (1): 0 < x
                           0 < y
                           0 < 1. By continuity of t↦dR
                           (x
                           0, t) at t = y
                           0, we can always find a δ ∈ ]0, min {x
                           0, 1 − y
                           0, (y
                           0 − x
                           0)/2}[ such that

                              
                                 (2.4)
                                 
                                    
                                       
                                          |
                                       
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             0
                                          
                                          ,
                                          t
                                          )
                                       
                                       −
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             0
                                          
                                          ,
                                          
                                             y
                                             0
                                          
                                          )
                                       
                                       
                                          |
                                          ≤
                                          ɛ
                                          /
                                          2
                                       
                                    
                                 
                              
                           for all t ∈ [y
                           0 − δ, y
                           0 + δ]. Moreover, by continuity of t↦dR
                           (t, y
                           0 + δ) at t = x
                           0, we can always find a δ
                           1 ∈ ]0, δ[ such that

                              
                                 
                                    
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             0
                                          
                                          −
                                          
                                             δ
                                             1
                                          
                                          ,
                                          
                                             y
                                             0
                                          
                                          +
                                          δ
                                          )
                                       
                                       ≤
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             0
                                          
                                          ,
                                          
                                             y
                                             0
                                          
                                          +
                                          δ
                                          )
                                       
                                       +
                                       ɛ
                                       /
                                       2
                                       .
                                    
                                 
                              
                           Employing Eq. (2.4), last inequality leads to

                              
                                 (2.5)
                                 
                                    
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             0
                                          
                                          −
                                          
                                             δ
                                             1
                                          
                                          ,
                                          
                                             y
                                             0
                                          
                                          +
                                          δ
                                          )
                                       
                                       ≤
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             0
                                          
                                          ,
                                          
                                             y
                                             0
                                          
                                          )
                                       
                                       +
                                       ɛ
                                       .
                                    
                                 
                              
                           In the same way, starting with the continuity of the mapping t↦dR
                           (t, y
                           0 − δ) at t = x
                           0, there exists a δ
                           2 ∈ ]0, δ[ such that

                              
                                 (2.6)
                                 
                                    
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             0
                                          
                                          +
                                          
                                             δ
                                             2
                                          
                                          ,
                                          
                                             y
                                             0
                                          
                                          −
                                          δ
                                          )
                                       
                                       ≥
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             0
                                          
                                          ,
                                          
                                             y
                                             0
                                          
                                          )
                                       
                                       −
                                       ɛ
                                       .
                                    
                                 
                              
                           Set δ* ≔ min {δ
                           1, δ
                           2}: by the properties of δ, it is quite easy to see that

                              
                                 
                                    
                                       
                                          x
                                          0
                                       
                                       −
                                       
                                          δ
                                          1
                                       
                                       ≤
                                       
                                          x
                                          0
                                       
                                       −
                                       
                                          δ
                                          *
                                       
                                       <
                                       
                                          x
                                          0
                                       
                                       +
                                       
                                          δ
                                          *
                                       
                                       ≤
                                       
                                          x
                                          0
                                       
                                       +
                                       
                                          δ
                                          2
                                       
                                       <
                                       
                                          y
                                          0
                                       
                                       −
                                       δ
                                       ,
                                    
                                 
                              
                           hence, by (D4), one immediately finds

                              
                                 
                                    
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             0
                                          
                                          +
                                          
                                             δ
                                             *
                                          
                                          ,
                                          
                                             y
                                             0
                                          
                                          −
                                          δ
                                          )
                                       
                                       ≤
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       ≤
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             0
                                          
                                          −
                                          
                                             δ
                                             *
                                          
                                          ,
                                          
                                             y
                                             0
                                          
                                          +
                                          δ
                                          )
                                       
                                    
                                 
                              
                           for all (x, y) ∈ [x
                           0 − δ*, x
                           0 + δ*] × [y
                           0 − δ, y
                           0 + δ], and the claim directly follows from Eqs. (2.5) and (2.6).

Case (2): 0 < y
                           0 < x
                           0 < 1. It directly follows from the previous case, taking into account (D1).

Case (3): 0 < x
                           0 = y
                           0 < 1. The proof is the same (even simpler) as that of the first case.

Case (4): (x
                           0, y
                           0) belongs to the boundary of 
                              
                                 
                                    I
                                 
                                 2
                              
                           . This is again a sub-case of the first one, so concluding the proof.□

In what follows, AC
                        
                           (
                           I
                           )
                        
                      denotes the family of absolutely continuous real functions over 
                        I
                     . We say that any 
                        
                           φ
                           :
                           I
                           →
                           I
                        
                      belongs to 
                        
                           A
                           (
                           I
                           )
                        
                      if, and only if,

                        
                           (A1)
                           φ ∈ AC
                                 
                                    (
                                    I
                                    )
                                 
                              ;

φ is an increasing bijection.

Obviously, any 
                        
                           φ
                           ∈
                           A
                           (
                           I
                           )
                        
                      is an automorphism of the real unit interval (see, for instance, Fodor and Roubens, 1994). Recall that, as a consequence of (A1), the derivative of any 
                        
                           φ
                           ∈
                           A
                           (
                           I
                           )
                        
                      exists and is defined on 
                        I
                      up to a subset of measure zero (see, for instance, Yeh, 2006).

Let us introduce now a special class of restricted dissimilarity functions by means of a construction illustrated in the next lemma, whose elementary proof is omitted. Later on, any continuous bijection 
                        
                           h
                           :
                           I
                           →
                           I
                        
                      is simply called a scaling function.

                        Lemma 2.5
                        Let 
                              
                                 φ
                                 ∈
                                 A
                                 (
                                 I
                                 )
                              
                           . Let h be a scaling function. Then, the mapping 
                              
                                 
                                    d
                                    R
                                 
                                 :
                                 
                                    
                                       I
                                    
                                    2
                                 
                                 →
                                 I
                              
                            given by

                              
                                 (2.7)
                                 
                                    
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       =
                                       
                                          φ
                                          (
                                          |
                                          h
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                       −
                                       
                                          h
                                          
                                             (
                                             y
                                             )
                                          
                                          |
                                          )
                                       
                                    
                                 
                              
                           is a restricted dissimilarity function.

Note that the class of restricted dissimilarity functions as in Eq. (2.7) properly contains the family of faithful restricted dissimilarity functions, as defined in Bustince et al. (2013). Indeed, the construction is exactly the same: the only difference is that condition (A1) is replaced with the stronger requirement that φ is convex. In fact, any convex and continuous 
                        
                           φ
                           :
                           I
                           →
                           I
                        
                      is also absolutely continuous (see, for instance, Yeh 2006, Theorem 14.13).

Observe that the mappings dp
                      previously introduced are exactly restricted dissimilarity functions of the form given in Eq. (2.7), with φ(t) = tp
                      and h ≡ id, where id is the identity function.

In this section, we address the problem of building penalty functions following the approach of Eq. (2.3), but with the crucial novelty that we replace the class of mappings dp
                      with a larger family of (continuous) restricted dissimilarity functions.

Starting with an arbitrary continuous restricted dissimilarity function dR
                      and fixing the dimension 
                        
                           n
                           ∈
                           N
                           ,
                        
                      our candidate for being an n-dimensional penalty function is the mapping 
                        
                           P
                           :
                           
                              
                                 I
                              
                              n
                           
                           ×
                           
                              W
                              n
                           
                           ×
                           I
                           →
                           I
                        
                      given by

                        
                           (3.1)
                           
                              
                                 P
                                 
                                    (
                                    x
                                    ,
                                    w
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    w
                                    i
                                 
                                 
                                    d
                                    R
                                 
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    ,
                                    y
                                    )
                                 
                                 .
                              
                           
                        
                     When a mapping P as in Eq. (3.1) is actually a penalty function, dR
                      will be referred to as a generator of P.

                        Remark 3.1
                        Let P be as in Eq. (3.1): then, conditions (i) and (ii) have to be slightly modified as follows:

                              
                                 (i’)
                                 for every fixed w ∈ Wn, P(x, w, y) = 0 if xi
                                     = y for all i ∈ {1, …, n};

for every fixed 
                                       
                                          x
                                          ∈
                                          
                                             
                                                I
                                             
                                             n
                                          
                                       
                                     and w ∈ Wn
                                    , the set of minimizers of the mapping y↦P(x, w, y) is a subinterval of 
                                       
                                          I
                                          ,
                                       
                                     possibly reducible to a singleton.

Observe that condition (i’) is trivially satisfied due to (D3), so the real difficulty is the verification of (ii’).

Fixing any 
                        
                           x
                           ∈
                           
                              
                                 I
                              
                              n
                           
                        
                      and w ∈ Wn
                     , the mapping y↦P(x, w, y) is clearly continuous over a compact domain, so its set of minimizers, denoted by S
                     
                        x, w
                     (P), is always nonempty.

From now on, we will suppose first that x = x
                     ↗. Note that there is no loss of generality: otherwise it would suffice to relabel the indices of the components of the involved vectors. Secondly, assume that xi
                      ≠ x
                     
                        i + 1 for all i ∈ {1, …, n − 1} (otherwise, the dimension n would be reduced). Under these assumptions, owing to (D4) it is easy to see that the mapping  y↦P(x, w, y) is decreasing on [0, x
                     1] and increasing on [xn
                     , 1], whence condition (ii’) is equivalent to showing that S
                     
                        x, w
                     (P) is a subinterval of [x
                     1, xn
                     ].

Now, we pose the following problem: may we make use of a distance as particular restricted dissimilarity function in order to generate n-dimensional penalty functions via Eq. (3.1)? The answer is decidedly negative even for n = 2 with only one exception, as we show in the following.

                        Proposition 3.2
                        Let dR
                            be a continuous restricted dissimilarity function. Assume that dR
                            is a generator of a two-dimensional penalty function P via Eq. (3.1). Then, dR
                            is a metric if, and only if, is of the form given in Eq. (2.7) with φ ≡ id.

Let dR
                            satisfy the assumptions. According to (D1) and (D3), it is easy to see that dR
                            is a metric if, and only if, verifies the triangle inequality

                              
                                 
                                    
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             1
                                          
                                          ,
                                          
                                             x
                                             2
                                          
                                          )
                                       
                                       ≤
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             1
                                          
                                          ,
                                          z
                                          )
                                       
                                       +
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             2
                                          
                                          ,
                                          z
                                          )
                                       
                                    
                                 
                              
                           for all 
                              
                                 
                                    x
                                    1
                                 
                                 ,
                                 
                                    x
                                    2
                                 
                                 ,
                                 z
                                 ∈
                                 I
                              
                           . The only non-trivial case is when x
                           1 < x
                           2 and z ∈ ]x
                           1, x
                           2[. We have two mutually exclusive possibilities only: in the first one, assume that

                              
                                 
                                    
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             1
                                          
                                          ,
                                          
                                             x
                                             2
                                          
                                          )
                                       
                                       =
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             1
                                          
                                          ,
                                          z
                                          )
                                       
                                       +
                                       
                                          d
                                          R
                                       
                                       
                                          (
                                          
                                             x
                                             2
                                          
                                          ,
                                          z
                                          )
                                       
                                    
                                 
                              
                           for all 
                              
                                 
                                    x
                                    1
                                 
                                 ,
                                 
                                    x
                                    2
                                 
                                 ∈
                                 I
                              
                            such that x
                           1 < x
                           2 and for any z ∈ [x
                           1, x
                           2]. Then, define h(t) ≔ dR
                           (0, t): by (D4), we have that h is a (continuous) increasing mapping, while (D2) and (D3) trivially force h(t) = t when t ∈ {0, 1}. Now, consider any 
                              
                                 x
                                 ,
                                 y
                                 ∈
                                 I
                              
                            such that 0 ≤ x ≤ y: if we apply the above equality with x
                           1 = 0, x
                           2 = y and z = x, we immediately get dR
                           (x, y) = h(y) − h(x). By (D3), this clearly implies the strict monotonicity of h, so closing the first case. The only other possibility is that dR
                            fulfills the triangle inequality and, at the same time, there exists at least a pair of points 
                              
                                 
                                    x
                                    1
                                 
                                 ,
                                 
                                    x
                                    2
                                 
                                 ∈
                                 I
                                 ,
                              
                            with x
                           1 < x
                           2, such that dR
                           (x
                           1, x
                           2) < dR
                           (x
                           1, z
                           0) + dR
                           (x
                           2, z
                           0) for some z
                           0 ∈ ]x
                           1, x
                           2[. Let us show that this case is incompatible with the fact that dR
                            acts as a generator of a two-dimensional penalty function P via Eq. (3.1). In fact, if this were true, we would immediately find that the generated penalty function 
                              
                                 P
                                 (
                                 x
                                 ,
                                 
                                    
                                       w
                                    
                                    2
                                    *
                                 
                                 ,
                                 y
                                 )
                              
                            satisfies the inequality

                              
                                 
                                    
                                       P
                                       
                                          (
                                          x
                                          ,
                                          
                                             
                                                w
                                             
                                             2
                                             *
                                          
                                          ,
                                          y
                                          )
                                       
                                       ≥
                                       P
                                       
                                          (
                                          x
                                          ,
                                          
                                             
                                                w
                                             
                                             2
                                             *
                                          
                                          ,
                                          
                                             x
                                             1
                                          
                                          )
                                       
                                       =
                                       P
                                       
                                          (
                                          x
                                          ,
                                          
                                             
                                                w
                                             
                                             2
                                             *
                                          
                                          ,
                                          
                                             x
                                             2
                                          
                                          )
                                       
                                    
                                 
                              
                           for all y ∈ [x
                           1, x
                           2] and at the same time

                              
                                 
                                    
                                       P
                                       
                                          (
                                          x
                                          ,
                                          
                                             
                                                w
                                             
                                             2
                                             *
                                          
                                          ,
                                          
                                             z
                                             0
                                          
                                          )
                                       
                                       >
                                       P
                                       
                                          (
                                          x
                                          ,
                                          
                                             
                                                w
                                             
                                             2
                                             *
                                          
                                          ,
                                          
                                             x
                                             1
                                          
                                          )
                                       
                                       =
                                       P
                                       
                                          (
                                          x
                                          ,
                                          
                                             
                                                w
                                             
                                             2
                                             *
                                          
                                          ,
                                          
                                             x
                                             2
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           As a straightforward consequence, it would follow that 
                              
                                 
                                    S
                                    
                                       x
                                       ,
                                       
                                          
                                             w
                                          
                                          2
                                          *
                                       
                                    
                                 
                                 
                                    (
                                    P
                                    )
                                 
                              
                            certainly contains x
                           1, x
                           2, but not z
                           0, hence it could not be convex, so contradicting (ii’).□

Since the whole class of continuous restricted dissimilarity functions is too wide, we focus on its relevant subclass introduced in Lemma 2.5.

Given any 
                        
                           φ
                           ∈
                           A
                           (
                           I
                           )
                           ,
                        
                      let 
                        
                           
                              P
                              
                                 h
                                 ,
                                 φ
                              
                           
                           :
                           
                              
                                 I
                              
                              n
                           
                           ×
                           
                              W
                              n
                           
                           ×
                           I
                           →
                           I
                        
                      be described as

                        
                           
                              
                                 
                                    P
                                    
                                       h
                                       ,
                                       φ
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    w
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    w
                                    i
                                 
                                 
                                    φ
                                    (
                                    |
                                    h
                                 
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 −
                                 h
                                 
                                    (
                                    y
                                    )
                                 
                                 
                                    |
                                    )
                                 
                                 ,
                              
                           
                        
                     for any fixed scaling function h.

With a little abuse of terminology, when P
                     
                        h, φ is a penalty function, the mapping φ will be referred to as generator of P
                     
                        h, φ.

Our aim is to find the minimal requirements on φ and h in order for P
                     
                        h, φ to be an n-dimensional penalty function. The first, simple result shows the total irrelevance of the scaling functions. To avoid cumbersome symbols, in what follows we write P
                     φ as the shorthand for P
                     
                        h, φ when h ≡ id. More explicitly, 
                        
                           
                              P
                              φ
                           
                           :
                           
                              
                                 I
                              
                              n
                           
                           ×
                           
                              W
                              n
                           
                           ×
                           I
                           →
                           I
                        
                      is given by

                        
                           (3.2)
                           
                              
                                 
                                    P
                                    φ
                                 
                                 
                                    (
                                    x
                                    ,
                                    w
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    w
                                    i
                                 
                                 
                                    φ
                                    (
                                    |
                                 
                                 
                                    x
                                    i
                                 
                                 −
                                 y
                                 
                                    |
                                    )
                                 
                                 .
                              
                           
                        
                     
                     
                        Lemma 3.3
                        Assume that P
                           φ is an n-dimensional penalty function for some generator 
                              
                                 φ
                                 ∈
                                 A
                                 (
                                 I
                                 )
                              
                           . Then P
                           
                              h, φ is also an n-dimensional penalty function for any scaling function h.

Without loss of generality, suppose that h is strictly increasing. Then, it suffices to show that, given any 
                              
                                 x
                                 ∈
                                 
                                    
                                       I
                                    
                                    n
                                 
                              
                            and any w ∈ Wn
                           , the set S
                           
                              x, w
                           (P
                           
                              h, φ) is convex. By assumption, we know that S
                           
                              u, w
                           (P
                           φ) is a sub-interval of 
                              
                                 I
                                 ,
                              
                            where u = h(x) ≔ (h(x
                           1), …, h(xn
                           )). Then, it is quite easy to see that S
                           
                              x, w
                           (P
                           
                              h, φ) = h
                           −1(S
                           
                              u, w
                           (P
                           φ)), hence the claim is assured by the properties of h.□

Due to the previous result, from now on, we will exclusively deal with the class of functions 
                        
                           
                              P
                              φ
                           
                           :
                           
                              
                                 I
                              
                              n
                           
                           ×
                           
                              W
                              n
                           
                           ×
                           I
                           →
                           I
                        
                      of the form given by Eq. (3.2). However, because of the high complexity of our task, we try to achieve our goal through the pursuit of an intermediate target, that is the search for a subclass 
                        S
                      of 
                        
                           A
                           (
                           I
                           )
                        
                      such that, whatever is the choice of 
                        
                           φ
                           ∈
                           S
                           ,
                        
                      the mapping y↦P
                     φ(x, w, y) is quasi-convex for every fixed 
                        
                           x
                           ∈
                           
                              
                                 I
                              
                              n
                           
                        
                      and w ∈ Wn
                      and for any dimension n ≥ 2. Note that this is a well-posed problem, in the sense that 
                        S
                      is not empty. In fact, if we denote by 
                        CA
                      the set of all convex automorphisms of 
                        
                           I
                           ,
                        
                      it is clear that 
                        
                           CA
                           ⊂
                           S
                        
                     . To this end, note that the convexity of φ easily implies convexity, and a fortiori quasi-convexity, of P
                     φ (see, for instance, Bustince et al. 2013, Propositions 7 and 8). Actually, our problem is twofold: first, the characterization of 
                        S
                      through a differential condition on φ; second, relying on such characterization, to find out whether 
                        
                           CA
                           =
                           S
                        
                     . We emphasize the fact that, as remarked in the previous section, any restricted dissimilarity function is quasi-convex in one variable, so our new task is strictly related to the more general problem of determining a non-trivial family of quasi-convex functions, containing nonconvex functions, which is closed under the operation of addition. As stated by the authors in Greenberg and Pierskalla (1971), although many years have passed since then, to the best of our knowledge such problem is still open.

In this section, we solve the problem of characterizing the mappings 
                        
                           φ
                           ∈
                           A
                           (
                           I
                           )
                        
                      such that every function 
                        
                           
                              P
                              φ
                           
                           :
                           
                              
                                 I
                              
                              2
                           
                           ×
                           
                              W
                              2
                           
                           ×
                           I
                           →
                           I
                        
                      is a two-dimensional penalty function.

First, we need to introduce some suitable notation and useful lemmata.

We begin to restrict the initial class of the candidates for being generators of two-dimensional penalty functions: let 
                        
                           
                              S
                              0
                           
                           
                              =
                              {
                              φ
                              ∈
                              A
                              
                                 (
                                 I
                                 )
                              
                           
                        
                     : φ′ is strictly positive and continuous a.e. on 
                        I
                     }. Observe that 
                        
                           CA
                           ⊂
                           
                              S
                              0
                           
                        
                     : in fact, given any convex 
                        
                           φ
                           :
                           I
                           →
                           I
                           ,
                        
                      φ′ is continuous on 
                        I
                      up to a countable subset (see Roberts and Varberg, 1973). Moreover, the strict increasing monotonicity and convexity easily imply that φ′(t) > 0 for all t ∈ ]0, 1] where the derivative exists.

                        Remark 4.1
                        In the sequel, we will exclusively reserve the symbol 
                              
                                 D
                                 
                                    φ
                                    ′
                                 
                              
                            for the domain of the derivative of any 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                           . Note that 
                              
                                 D
                                 
                                    φ
                                    ′
                                 
                              
                            is defined up to a zero measure subset of 
                              
                                 I
                                 :
                              
                            this precisely means that any subset S of 
                              I
                            is a proper domain of φ′ if 
                              
                                 λ
                                 (
                                 I
                                 ∖
                                 S
                                 )
                                 =
                                 0
                              
                            and φ′: S → ]0, ∞[ is continuous.

Recall a well-known property, useful for the sequel, which characterizes monotonicity of absolutely continuous functions.

                        Lemma 4.2
                        Let 
                              
                                 f
                                 :
                                 [
                                 a
                                 ,
                                 b
                                 ]
                                 →
                                 R
                              
                            be an absolutely continuous function. Then, f is decreasing if, and only if, f′(x) ≤ 0 almost everywhere on [a, b].

Let us introduce a class of functions which turns out to be crucial for our purposes. Note that, throughout this section, we will reserve the symbol X for denoting an arbitrary subset of ]0, 1] dense in 
                        I
                     . Given any 
                        
                           φ
                           ∈
                           
                              S
                              0
                           
                           ,
                        
                      let 
                        
                           
                              F
                              2
                           
                           
                              (
                              X
                              ,
                              φ
                              )
                           
                           =
                           
                              {
                              
                                 ψ
                                 
                                    c
                                    ,
                                    w
                                 
                              
                              :
                              c
                              ∈
                              X
                              ,
                              w
                              ∈
                              
                                 W
                                 2
                              
                              }
                           
                        
                      be the class of mappings 
                        
                           
                              ψ
                              
                                 c
                                 ,
                                 w
                              
                           
                           :
                           
                              [
                              0
                              ,
                              c
                              ]
                           
                           →
                           R
                        
                      defined by

                        
                           
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    w
                                    1
                                 
                                 φ
                                 
                                    (
                                    t
                                    )
                                 
                                 +
                                 
                                    w
                                    2
                                 
                                 φ
                                 
                                    (
                                    c
                                    −
                                    t
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

In the sequel, for sake of brevity, we will adopt the shorthand notation 
                        
                           
                              F
                              2
                           
                           
                              (
                              X
                              )
                           
                           ,
                        
                      unless some confusion arises. Moreover, we will also adopt the shorthand notation ψc
                      for 
                        
                           ψ
                           
                              c
                              ,
                              
                                 
                                    w
                                 
                                 2
                                 *
                              
                           
                        
                     .

Recall that absolute continuity is closed under the operation of addition, therefore every function of 
                        
                           
                              F
                              2
                           
                           
                              (
                              X
                              )
                           
                        
                      is absolutely continuous, hence it is also a.e. differentiable.

Let us turn our attention to the notable subclass {ψc
                     : c ∈ X} of 
                        
                           
                              F
                              2
                           
                           
                              (
                              X
                              )
                           
                        
                     . It is immediate to see that the graph of any member ψc
                      of this subclass is symmetrical with respect to the vertical line at t = c/2 and consequently ψc
                      is quasi-convex if, and only if, is decreasing on [0, c/2]. According to Lemma 4.2, this is equivalent to saying that ψc
                      is quasi-convex if, and only if,

                        
                           (4.1)
                           
                              
                                 
                                    ψ
                                    c
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 0
                                 
                                 for
                                 
                                 almost
                                 
                                 all
                                 
                                 t
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    c
                                    /
                                    2
                                    ]
                                 
                                 .
                              
                           
                        
                     
                     
                        Remark 4.3
                        Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                            and c ∈ X. Based upon the properties of positively homogeneity and invariance under translation of the Lebesgue measure (see, for instance, Yeh 2006, Theorems 3.18 and 3.16) and taking into account Remark 4.1, it is not difficult to check that the complement with respect to 
                              I
                            of the set 
                              
                                 
                                    D
                                    
                                       
                                          φ
                                          ′
                                       
                                       ,
                                       c
                                    
                                 
                                 
                                    :
                                    =
                                    {
                                    t
                                    ∈
                                    I
                                    :
                                 
                                 
                                    φ
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                    φ
                                    ′
                                 
                                 
                                    (
                                    c
                                    −
                                    t
                                    )
                                 
                              
                            exist} has measure zero. This allows us to assume without loss of generality that the domain of the derivative of every member of the subclass of 
                              
                                 
                                    F
                                    2
                                 
                                 
                                    (
                                    X
                                    )
                                 
                              
                            given by 
                              
                                 {
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    2
                                 
                                 
                                    (
                                    X
                                    )
                                 
                                 :
                                 w
                                 ∈
                                 
                                    W
                                    2
                                 
                                 }
                              
                            is exactly 
                              
                                 D
                                 
                                    
                                       φ
                                       ′
                                    
                                    ,
                                    c
                                 
                              
                           . Further, given any 
                              
                                 
                                    ψ
                                    c
                                 
                                 ∈
                                 
                                    F
                                    2
                                 
                                 
                                    (
                                    X
                                    )
                                 
                                 ,
                              
                            an elementary computation shows that the inequality 
                              
                                 
                                    ψ
                                    c
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 0
                              
                            amounts to φ′(t) ≤ φ′(c − t) for every 
                              
                                 t
                                 ∈
                                 
                                    D
                                    
                                       
                                          φ
                                          ′
                                       
                                       ,
                                       c
                                    
                                 
                              
                           .

The next result will be presented without including a proof: indeed, it is a straightforward consequence of both the uniform continuity of any 
                        
                           φ
                           ∈
                           
                              S
                              0
                           
                        
                      over 
                        I
                      and the density of X in 
                        I
                     .

                        Lemma 4.4
                        Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                           . Assume that every function of 
                              
                                 
                                    F
                                    2
                                 
                                 
                                    (
                                    X
                                    )
                                 
                              
                            is quasi-convex for some dense subset X⊂]0, 1]. Then, every member of 
                              
                                 
                                    F
                                    2
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    )
                                 
                              
                            is quasi-convex.

Now, we shall proceed in two steps: in the first one, we consider the particular case 
                        
                           w
                           =
                           
                              
                                 w
                              
                              2
                              *
                           
                        
                     .

                        Proposition 4.5
                        Let 
                              
                                 x
                                 ∈
                                 
                                    
                                       I
                                    
                                    2
                                 
                              
                            and 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                           . Then, the mapping φ(y − x
                           1) + φ(x
                           2 − y) is quasi-convex in the variable y if, and only if,

                              
                                 (4.2)
                                 
                                    
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ≤
                                       inf
                                       
                                          {
                                          
                                             φ
                                             ′
                                          
                                          
                                             (
                                             z
                                             )
                                          
                                          :
                                          z
                                          ∈
                                          ]
                                       
                                       t
                                       ,
                                       1
                                       −
                                       t
                                       
                                          [
                                          ∩
                                          
                                             D
                                             
                                                φ
                                                ′
                                             
                                          
                                          }
                                       
                                       
                                       f
                                       o
                                       r
                                       a
                                       l
                                       l
                                       t
                                       ∈
                                       
                                          D
                                          
                                             φ
                                             ′
                                          
                                       
                                       ∩
                                       
                                          [
                                          0
                                          ,
                                          1
                                          /
                                          2
                                          [
                                       
                                       .
                                    
                                 
                              
                           
                        

Set t ≔ y − x
                           1: consequently x
                           2 − y = c − t, where c ≔ x
                           2 − x
                           1 ∈ ]0, 1]. Using this change of variable and employing Lemma 4.4, we can equivalently consider the problem of characterizing quasi-convexity of every member of the subclass {ψc
                           : c ∈ X} for some subset X of ]0, 1] dense in 
                              I
                           . Choose 
                              
                                 X
                                 =
                                 Q
                                 ∩
                                 ]
                                 0
                                 ,
                                 1
                                 ]
                              
                           : note that X is countable and dense in 
                              I
                           . Owing to Remark 4.3, it is quite easy to see that 
                              
                                 I
                                 ∖
                                 
                                    ⋂
                                    
                                       c
                                       ∈
                                       X
                                    
                                 
                                 
                                    D
                                    
                                       
                                          φ
                                          ′
                                       
                                       ,
                                       c
                                    
                                 
                              
                            has measure zero, hence, according to Remark 4.1, we may assume that 
                              
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                                 =
                                 
                                    ⋂
                                    
                                       c
                                       ∈
                                       X
                                    
                                 
                                 
                                    D
                                    
                                       
                                          φ
                                          ′
                                       
                                       ,
                                       c
                                    
                                 
                              
                           . This implies that, fixing any 
                              
                                 t
                                 ∈
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                              
                            and any c ∈ X, both φ′(t) and φ′(c − t) exist. As above stated, an arbitrary element of {ψc
                           : c ∈ X} is quasi-convex if, and only if, Eq. (4.1) is verified. Now, we assert that Eq. (4.1) holds for any c ∈ X if, and only if, Eq. (4.2) is satisfied. Let us start with the necessity and suppose ab absurdo that Eq. (4.2) is violated for some 
                              
                                 
                                    t
                                    0
                                 
                                 ∈
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                                 ∩
                                 
                                    ]
                                    0
                                    ,
                                    1
                                    /
                                    2
                                    [
                                 
                              
                           . This means that there exists a 
                              
                                 
                                    z
                                    0
                                 
                                 ∈
                                 
                                    ]
                                    
                                       t
                                       0
                                    
                                    ,
                                    1
                                    −
                                    
                                       t
                                       0
                                    
                                    [
                                 
                                 ∩
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                              
                            such that φ′(t
                           0) > φ′(z
                           0). Set ε ≔ φ′(t
                           0) − φ′(z
                           0). Being φ′ continuous at z
                           0, there exists a sufficiently small δ > 0 such that

                              
                                 (4.3)
                                 
                                    
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          z
                                          )
                                       
                                       <
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          
                                             z
                                             0
                                          
                                          )
                                       
                                       +
                                       ϵ
                                       /
                                       2
                                    
                                 
                              
                           for all 
                              
                                 z
                                 ∈
                                 
                                    [
                                    
                                       z
                                       0
                                    
                                    ,
                                    
                                       z
                                       0
                                    
                                    +
                                    δ
                                    ]
                                 
                                 ∩
                                 
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                              
                           . By the density of X in 
                              I
                            we can always find a 
                              
                                 
                                    c
                                    0
                                 
                                 ∈
                                 
                                    ]
                                    
                                       t
                                       0
                                    
                                    +
                                    
                                       z
                                       0
                                    
                                    ,
                                    
                                       t
                                       0
                                    
                                    +
                                    
                                       z
                                       0
                                    
                                    +
                                    
                                       
                                          δ
                                          2
                                       
                                    
                                    [
                                 
                                 ∩
                                 X
                              
                           . Being φ′ continuous at t
                           0, there exists a sufficiently small δ
                           1 > 0, with 
                              
                                 
                                    δ
                                    1
                                 
                                 <
                                 
                                    
                                       δ
                                       2
                                    
                                 
                                 ,
                              
                            such that

                              
                                 (4.4)
                                 
                                    
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       >
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          
                                             t
                                             0
                                          
                                          )
                                       
                                       −
                                       ϵ
                                       /
                                       2
                                    
                                 
                              
                           for all 
                              
                                 t
                                 ∈
                                 
                                    [
                                    
                                       t
                                       0
                                    
                                    −
                                    
                                       δ
                                       1
                                    
                                    ,
                                    
                                       t
                                       0
                                    
                                    ]
                                 
                                 ∩
                                 
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                              
                           . Now, pick any 
                              
                                 t
                                 ∈
                                 
                                    [
                                    
                                       t
                                       0
                                    
                                    −
                                    
                                       δ
                                       1
                                    
                                    ,
                                    
                                       t
                                       0
                                    
                                    ]
                                 
                                 ∩
                                 
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                              
                           : being clearly t < c
                           0/2, Eq. (4.1) applies, so that, by Remark 4.3, we obtain

                              
                                 (4.5)
                                 
                                    
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ≤
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          
                                             c
                                             0
                                          
                                          −
                                          t
                                          )
                                       
                                       .
                                    
                                 
                              
                           Moreover, since it is not difficult to check that c
                           0 − t ∈ ]z
                           0, z
                           0 + δ[, recalling that φ′(c
                           0 − t) exists as consequence of 
                              
                                 t
                                 ∈
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                                 ,
                              
                            we can also apply Eq. (4.3) with z = c
                           0 − t. Finally, combining Eqs. (4.5) and (4.3) with Eq. (4.4), we get the following chain of inequalities:

                              
                                 
                                    
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          
                                             t
                                             0
                                          
                                          )
                                       
                                       −
                                       ϵ
                                       /
                                       2
                                       <
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ≤
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          
                                             c
                                             0
                                          
                                          −
                                          t
                                          )
                                       
                                       <
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          
                                             z
                                             0
                                          
                                          )
                                       
                                       +
                                       ϵ
                                       /
                                       2
                                       .
                                    
                                 
                              
                           The evident contradiction with ε = φ′(t
                           0) − φ′(z
                           0) closes the first part of the assertion. Conversely, let Eq. (4.2) hold. Given any c ∈ X, let 
                              
                                 
                                    t
                                    ∈
                                    ]
                                    0
                                    ,
                                    c
                                    /
                                    2
                                    [
                                    ∩
                                    
                                 
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                              
                           : after the assignment z ≔ c − t, we immediately find that 
                              
                                 
                                    z
                                    ∈
                                    ]
                                    t
                                    ,
                                    1
                                    −
                                    t
                                    [
                                    ∩
                                    
                                 
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                                 ,
                              
                            hence by applying Eq. (4.2) easily leads to 
                              
                                 
                                    ψ
                                    c
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 0
                                 ,
                              
                            so showing the assertion and concluding the proof.□

Remark that Eq. (4.2) is equivalent to both convexity of φ on [0, 1/2] and φ′(t) ≤ μ
                     φ(t) a.e. on [0, 1/2[, where 
                        
                           
                              μ
                              φ
                           
                           :
                           
                              [
                              0
                              ,
                              1
                              /
                              2
                              [
                           
                           →
                           R
                        
                      is defined as

                        
                           
                              
                                 
                                    μ
                                    φ
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 inf
                                 
                                    {
                                    
                                       φ
                                       ′
                                    
                                    
                                       (
                                       z
                                       )
                                    
                                    :
                                    z
                                    ∈
                                    ]
                                 
                                 1
                                 /
                                 2
                                 ,
                                 1
                                 −
                                 t
                                 
                                    [
                                    ∩
                                    
                                       D
                                       
                                          φ
                                          ′
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     In fact, let Eq. (4.2) hold: consequently, given any 
                        
                           
                              t
                              1
                           
                           ,
                           
                              t
                              2
                           
                           ∈
                           
                              [
                              0
                              ,
                              1
                              /
                              2
                              [
                           
                           ∩
                           
                              D
                              
                                 φ
                                 ′
                              
                           
                        
                      such that t
                     1 < t
                     2, if we apply Eq. (4.2) with t = t
                     1 we have

                        
                           
                              
                                 
                                    φ
                                    ′
                                 
                                 
                                    (
                                    
                                       t
                                       1
                                    
                                    )
                                 
                                 ≤
                                 inf
                                 
                                    {
                                    
                                       φ
                                       ′
                                    
                                    
                                       (
                                       z
                                       )
                                    
                                    :
                                    z
                                    ∈
                                    ]
                                 
                                 
                                    t
                                    1
                                 
                                 ,
                                 1
                                 −
                                 
                                    t
                                    1
                                 
                                 
                                    [
                                    ∩
                                    
                                       D
                                       
                                          φ
                                          ′
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     Since it is clear that 
                        
                           
                              t
                              2
                           
                           ∈
                           
                              ]
                              
                                 t
                                 1
                              
                              ,
                              1
                              −
                              
                                 t
                                 1
                              
                              [
                           
                           ∩
                           
                              D
                              
                                 φ
                                 ′
                              
                           
                           ,
                        
                      we easily infer that φ′(t
                     1) ≤ φ′(t
                     2). In conclusion, we have proved that 
                        
                           
                              φ
                              ′
                           
                           :
                           
                              D
                              
                                 φ
                                 ′
                              
                           
                           ∩
                           
                              [
                              0
                              ,
                              1
                              /
                              2
                              [
                           
                           →
                           R
                        
                      is an increasing function, thus (see, for instance, Yeh 2006, Theorem 14.14) φ is a convex function on [0, 1/2]. As a straightforward consequence, it follows that for every 
                        
                           
                              t
                              ∈
                              [
                              0
                              ,
                              1
                              /
                              2
                              [
                              ∩
                           
                           
                              D
                              
                                 φ
                                 ′
                              
                           
                        
                      we have φ′(t) = ∈f{φ′(z): z ∈ ]t, 1/2]}. This obviously implies that Eq. (4.2) may be rewritten in the simplified form

                        
                           
                              
                                 
                                    φ
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 inf
                                 
                                    {
                                    
                                       φ
                                       ′
                                    
                                    
                                       (
                                       z
                                       )
                                    
                                    :
                                    z
                                    ∈
                                    ]
                                 
                                 1
                                 /
                                 2
                                 ,
                                 1
                                 −
                                 t
                                 
                                    [
                                    ∩
                                    
                                       D
                                       
                                          φ
                                          ′
                                       
                                    
                                    }
                                 
                                 
                                 for
                                 
                                 all
                                 
                                 t
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    /
                                    2
                                    [
                                 
                                 ∩
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                                 .
                              
                           
                        
                     The converse is trivial. We have shown the following.

                        Proposition 4.6
                        Let 
                              
                                 x
                                 ∈
                                 
                                    
                                       I
                                    
                                    2
                                 
                              
                            and 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                           . Then, the mapping φ(y − x
                           1) + φ(x
                           2 − y) is quasi-convex in the variable y if, and only if, φ fulfills the following properties:

                              
                                 (P1)
                                 φ is convex on [0, 1/2];

φ′(t) ≤ μ
                                    φ(t) almost everywhere on [0, 1/2[.

The preceding result states that the subclass of 
                        
                           S
                           0
                        
                      characterizing quasi-convexity of every member of {ψc
                     : c ∈ ]0, 1]} is exactly given by 
                        
                           
                              S
                              1
                           
                           
                              =
                              {
                              φ
                              ∈
                           
                           
                              S
                              0
                           
                           :
                           φ
                        
                      verifies (P1) and (P2)}.

                        Example 4.7
                        Consider the function 
                              
                                 φ
                                 :
                                 I
                                 →
                                 I
                              
                            defined by

                              
                                 
                                    
                                       φ
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                      t
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                      t
                                                      ≤
                                                      
                                                         3
                                                         4
                                                      
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         3
                                                         8
                                                      
                                                      +
                                                      
                                                         5
                                                         4
                                                      
                                                      
                                                         
                                                            t
                                                            −
                                                            
                                                               3
                                                               4
                                                            
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           It is easy to check that 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                            and that (P1) holds. Hence, it is really an elementary task to show that 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    1
                                 
                                 ,
                              
                            being clearly φ′(t) = μ
                           φ(t) = 1/2 for all t ∈ ]0, 1/2[.

Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                           . Suppose that φ is convex on [0, 1/2] and is concave on [1/2, 1]. Then, it is not difficult to show that 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    1
                                 
                              
                            if, and only if, φ′(t) ≤ φ′(1 − t) for almost all t ∈ [0, 1/2].

In the second step, the weights come into play: in this case, as it was probably natural to expect, the subclass of 
                        
                           S
                           0
                        
                      exclusively formed of generators of two-dimensional penalty functions as in Eq. (3.2) is a proper subset of 
                        
                           
                              S
                              1
                           
                           ,
                        
                      as we show in the following example.

                        Example 4.9
                        Let φ be as in Example 4.7, 
                              
                                 x
                                 =
                                 (
                                 0
                                 ,
                                 1
                                 )
                              
                            and 
                              
                                 w
                                 =
                                 (
                                 5
                                 /
                                 6
                                 ,
                                 1
                                 /
                                 6
                                 )
                              
                           . If we consider the corresponding 
                              
                                 
                                    P
                                    φ
                                 
                                 
                                    (
                                    x
                                    ,
                                    w
                                    ,
                                    y
                                    )
                                 
                                 ,
                              
                            it is only a matter of computation to see that S
                           
                              x, w
                           (P
                           φ) = {0, 1/4}, hence P
                           φ is not a penalty function although 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    1
                                 
                              
                           .

Given any 
                        
                           φ
                           ∈
                           
                              S
                              0
                           
                           ,
                        
                      let 
                        
                           
                              Z
                              2
                           
                           
                              (
                              X
                              ,
                              φ
                              )
                           
                           =
                           
                              {
                              
                                 ζ
                                 c
                              
                              :
                              c
                              ∈
                              X
                              }
                           
                        
                      be the class of strictly positive functions defined a.e. on [0, c] and described as

                        
                           
                              
                                 
                                    ζ
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          c
                                          −
                                          t
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     We highlight that 
                        
                           
                              Z
                              2
                           
                           
                              (
                              X
                              ,
                              φ
                              )
                           
                        
                      is made of continuous mappings, due to the continuity of φ′ on 
                        
                           D
                           
                              φ
                              ′
                           
                        
                     . Similarly as above, we will adopt the shorthand notation 
                        
                           
                              Z
                              2
                           
                           
                              (
                              X
                              )
                           
                        
                      for 
                        
                           
                              Z
                              2
                           
                           
                              (
                              X
                              ,
                              φ
                              )
                           
                           ,
                        
                      unless some confusion arises.

                        Remark 4.10
                        Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                            and c ∈ X. Remark that there is a natural, biunivocal correspondence between the subclass 
                              
                                 {
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    2
                                 
                                 
                                    (
                                    X
                                    ,
                                    φ
                                    )
                                 
                                 :
                                 w
                                 ∈
                                 
                                    W
                                    2
                                 
                                 }
                              
                            of 
                              
                                 
                                    F
                                    2
                                 
                                 
                                    (
                                    X
                                    ,
                                    φ
                                    )
                                 
                              
                            and the mapping 
                              
                                 
                                    ζ
                                    c
                                 
                                 ∈
                                 
                                    Z
                                    2
                                 
                                 
                                    (
                                    X
                                    ,
                                    φ
                                    )
                                 
                              
                           . In particular, according to Remark 4.3, we may assume that the domain of ζc
                            coincides with 
                              
                                 D
                                 
                                    
                                       φ
                                       ′
                                    
                                    ,
                                    c
                                 
                              
                           . Moreover, an elementary computation shows that the inequality 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 >
                                 0
                              
                            amounts to 
                              
                                 
                                    ζ
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 >
                                 
                                    
                                       
                                          w
                                          2
                                       
                                       
                                          w
                                          1
                                       
                                    
                                 
                              
                            for every 
                              
                                 t
                                 ∈
                                 
                                    D
                                    
                                       
                                          φ
                                          ′
                                       
                                       ,
                                       c
                                    
                                 
                              
                           .

We emphasize the fact that the increasing monotonicity of all mappings of 
                        
                           
                              Z
                              2
                           
                           
                              (
                              ]
                           
                           0
                           ,
                           1
                           
                              ]
                              )
                           
                        
                      will play a crucial role in characterizing the family of generators of two-dimensional penalty functions of the form given by Eq. (3.2). In the next result, we show that such property is assured even if it occurs for a particular dense subset X⊂]0, 1] only.

                        Lemma 4.11
                        Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                           . Assume that there exists a dense subset X⊂]0, 1] such that every mapping of 
                              
                                 
                                    Z
                                    2
                                 
                                 
                                    (
                                    X
                                    )
                                 
                              
                            is increasing. Then, every member of 
                              
                                 
                                    Z
                                    2
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    )
                                 
                              
                            is increasing.

Reasoning by contradiction, suppose that 
                              
                                 
                                    ζ
                                    
                                       c
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       t
                                       1
                                    
                                    )
                                 
                                 >
                                 
                                    ζ
                                    
                                       c
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       t
                                       2
                                    
                                    )
                                 
                              
                            for some t
                           1, t
                           2 ∈ ]0, c
                           0[, with t
                           1 < t
                           2, and for some c
                           0 ∈ ]0, 1]∖X. It is only a matter of computation to see that 
                              
                                 
                                    ζ
                                    
                                       c
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       t
                                       1
                                    
                                    )
                                 
                                 >
                                 
                                    ζ
                                    
                                       c
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       t
                                       2
                                    
                                    )
                                 
                              
                            amounts to

                              
                                 
                                    
                                       
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   t
                                                   1
                                                
                                                )
                                             
                                          
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                       >
                                       
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   c
                                                   0
                                                
                                                −
                                                
                                                   t
                                                   1
                                                
                                                )
                                             
                                          
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   c
                                                   0
                                                
                                                −
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           The above inequality implies that

                              
                                 (4.6)
                                 
                                    
                                       
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   t
                                                   1
                                                
                                                )
                                             
                                             −
                                             ϵ
                                          
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                             +
                                             ϵ
                                          
                                       
                                       >
                                       
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   c
                                                   0
                                                
                                                −
                                                
                                                   t
                                                   1
                                                
                                                )
                                             
                                             +
                                             ϵ
                                          
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   c
                                                   0
                                                
                                                −
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                             −
                                             ϵ
                                          
                                       
                                    
                                 
                              
                           for a sufficiently small ε > 0. Being φ′ continuous, there exists a sufficiently small δ > 0 such that

                              
                                 (4.7)
                                 
                                    
                                       
                                          |
                                       
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       −
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          
                                             t
                                             i
                                          
                                          )
                                       
                                       
                                          |
                                          <
                                          ϵ
                                          ,
                                          
                                          
                                          
                                          i
                                          =
                                          1
                                          ,
                                          2
                                       
                                    
                                 
                              
                           and

                              
                                 (4.8)
                                 
                                    
                                       
                                          |
                                       
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       −
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          
                                             c
                                             0
                                          
                                          −
                                          
                                             t
                                             i
                                          
                                          )
                                       
                                       
                                          |
                                          <
                                          ϵ
                                          ,
                                          
                                          
                                          
                                          i
                                          =
                                          1
                                          ,
                                          2
                                       
                                    
                                 
                              
                           for almost all t such that |t − ti
                           | < δ and |t − (c
                           0 − ti
                           )| < δ respectively and for i ∈ {1, 2}. Now, pick any c ∈ X such that |c − c
                           0| < δ/2: since 
                              
                                 I
                                 ∖
                                 
                                    D
                                    
                                       
                                          φ
                                          ′
                                       
                                       ,
                                       c
                                    
                                 
                              
                            has measure zero, we can always find 
                              
                                 
                                    u
                                    1
                                 
                                 ,
                                 
                                    u
                                    2
                                 
                                 ∈
                                 
                                    D
                                    
                                       
                                          φ
                                          ′
                                       
                                       ,
                                       c
                                    
                                 
                                 ,
                              
                            with u
                           1 < u
                           2, such that |ui
                            − ti
                           | < δ/2 for i ∈ {1, 2}. In this case, we have all the conditions to employ Eqs. (4.7) and(4.8), so getting

                              
                                 
                                    
                                       
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   u
                                                   1
                                                
                                                )
                                             
                                          
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   u
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                       >
                                       
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   t
                                                   1
                                                
                                                )
                                             
                                             −
                                             ϵ
                                          
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                             +
                                             ϵ
                                          
                                       
                                    
                                 
                              
                           and

                              
                                 
                                    
                                       
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                c
                                                −
                                                
                                                   u
                                                   1
                                                
                                                )
                                             
                                          
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                c
                                                −
                                                
                                                   u
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                       <
                                       
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   c
                                                   0
                                                
                                                −
                                                
                                                   t
                                                   1
                                                
                                                )
                                             
                                             +
                                             ϵ
                                          
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   c
                                                   0
                                                
                                                −
                                                
                                                   t
                                                   2
                                                
                                                )
                                             
                                             −
                                             ϵ
                                          
                                       
                                       .
                                    
                                 
                              
                           The last two inequalities, combined with Eq. (4.6), lead to

                              
                                 
                                    
                                       
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   u
                                                   1
                                                
                                                )
                                             
                                          
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   u
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                       >
                                       
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                c
                                                −
                                                
                                                   u
                                                   1
                                                
                                                )
                                             
                                          
                                          
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                c
                                                −
                                                
                                                   u
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           or, equivalently, ζc
                           (u
                           1) > ζc
                           (u
                           2), so contradicting the assumption and concluding the proof.□

Let us introduce the notable subclass of 
                        
                           S
                           0
                        
                      given by 
                        
                           
                              S
                              2
                           
                           
                              =
                              {
                              φ
                              ∈
                           
                           
                              S
                              0
                           
                           :
                        
                      every member of 
                        
                           
                              Z
                              2
                           
                           
                              (
                              ]
                           
                           0
                           ,
                           1
                           
                              ]
                              )
                           
                        
                      is increasing}. The next two results just concern this subclass: in the first one, we show that the verification task of the increasing monotonicity of every member of 
                        
                           
                              Z
                              2
                           
                           
                              (
                              ]
                           
                           0
                           ,
                           1
                           
                              ]
                              )
                           
                        
                      may be slightly simplified. In the second one, we will prove that 
                        
                           S
                           1
                        
                      (strictly) includes 
                        
                           S
                           2
                        
                     . In order to reduce the complexity of the proof of both the results, an appropriate choice of the dense subset X⊂]0, 1] is required, as suggested in the next remark.

                        Remark 4.12
                        Observe that we can associate with any 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                            a particular dense subset X⊂]0, 1], denoted with X
                           2(φ′), characterized by the property that any x ∈ ]0, 1] belongs to X
                           2(φ′) if, and only if, φ′(x/2) exists. Indeed, consider the set 
                              
                                 2
                                 (
                                 
                                    (
                                    I
                                    ∖
                                    
                                       D
                                       
                                          φ
                                          ′
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    [
                                    0
                                    ,
                                    1
                                    /
                                    2
                                    ]
                                 
                                 )
                              
                            (see Eq. (2.1)). Since the Lebesgue measure is positively homogeneous, we get

                              
                                 
                                    
                                       λ
                                       
                                          (
                                          2
                                          
                                             (
                                             
                                                (
                                                I
                                                ∖
                                                
                                                   D
                                                   
                                                      φ
                                                      ′
                                                   
                                                
                                                )
                                             
                                             ∩
                                             
                                                [
                                                0
                                                ,
                                                1
                                                /
                                                2
                                                ]
                                             
                                             )
                                          
                                          )
                                       
                                       =
                                       2
                                       λ
                                       
                                          (
                                          
                                             (
                                             I
                                             ∖
                                             
                                                D
                                                
                                                   φ
                                                   ′
                                                
                                             
                                             )
                                          
                                          ∩
                                          
                                             [
                                             0
                                             ,
                                             1
                                             /
                                             2
                                             ]
                                          
                                          )
                                       
                                       =
                                       0
                                       .
                                    
                                 
                              
                           Now, the characterizing property of X
                           2(φ′) easily follows if we choose as X
                           2(φ′) the complement of 
                              
                                 2
                                 (
                                 
                                    (
                                    I
                                    ∖
                                    
                                       D
                                       
                                          φ
                                          ′
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    [
                                    0
                                    ,
                                    1
                                    /
                                    2
                                    ]
                                 
                                 )
                              
                            with respect to ]0, 1] (for the density of X
                           2(φ′) see, for instance, Nagata, 2004, Proposition 2.4).

Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                           . Assume that every mapping of 
                              
                                 
                                    Z
                                    2
                                 
                                 
                                    (
                                    
                                       X
                                       2
                                    
                                    
                                       (
                                       
                                          φ
                                          ′
                                       
                                       )
                                    
                                    )
                                 
                              
                            is increasing on [0, c/2]. Then, every member of 
                              
                                 
                                    Z
                                    2
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    )
                                 
                              
                            is increasing.

Let 
                              
                                 
                                    ζ
                                    c
                                 
                                 ∈
                                 
                                    Z
                                    2
                                 
                                 
                                    (
                                    
                                       X
                                       2
                                    
                                    
                                       (
                                       
                                          φ
                                          ′
                                       
                                       )
                                    
                                    )
                                 
                              
                           : by assumption, we know that ζc
                            is increasing on [0, c/2]. Accordingly, from the elementary property ζc
                           (c/2 − t) · ζc
                           (c/2 + t) = 1 for almost all t ∈ ]0, c/2[, we infer that ζc
                            is increasing also on [c/2, c]. Finally, according to Remark 4.12, we have that 
                              
                                 c
                                 /
                                 2
                                 ∈
                                 
                                    D
                                    
                                       
                                          φ
                                          ′
                                       
                                       ,
                                       c
                                    
                                 
                                 ,
                              
                            hence we obtain

                              
                                 
                                    
                                       
                                          lim
                                          
                                             t
                                             ↑
                                             c
                                             /
                                             2
                                          
                                       
                                       
                                          ζ
                                          c
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          lim
                                          
                                             t
                                             ↓
                                             c
                                             /
                                             2
                                          
                                       
                                       
                                          ζ
                                          c
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          ζ
                                          c
                                       
                                       
                                          (
                                          c
                                          /
                                          2
                                          )
                                       
                                       =
                                       1
                                       ,
                                    
                                 
                              
                           so obtaining that every mapping of 
                              
                                 
                                    Z
                                    2
                                 
                                 
                                    (
                                    
                                       X
                                       2
                                    
                                    
                                       (
                                       
                                          φ
                                          ′
                                       
                                       )
                                    
                                    )
                                 
                              
                            is increasing. Finally, the proof is concluded by applying Lemma 4.11.□

Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    2
                                 
                              
                           . Then, 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    1
                                 
                              
                           .

By Propositions 4.5 and 4.6, the claim is equivalent to showing that Eq. (4.2) holds. Reasoning by contradiction, assume there exist 
                              
                                 
                                    t
                                    0
                                 
                                 ,
                                 
                                    z
                                    0
                                 
                                 ∈
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                                 ,
                              
                            with t
                           0 ∈ ]0, 1/2[ and z
                           0 ∈ ]t
                           0, 1 − t
                           0[, such that φ′(t
                           0) > φ′(z
                           0). Set ε ≔ φ′(t
                           0) − φ′(z
                           0). Being φ′ continuous at t
                           0, there exists a sufficiently small δ > 0 such that 
                              
                                 
                                    φ
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 >
                                 
                                    φ
                                    ′
                                 
                                 
                                    (
                                    
                                       t
                                       0
                                    
                                    )
                                 
                                 −
                                 
                                    
                                       ϵ
                                       2
                                    
                                 
                              
                            for all 
                              
                                 t
                                 ∈
                                 
                                    [
                                    
                                       t
                                       0
                                    
                                    −
                                    δ
                                    ,
                                    
                                       t
                                       0
                                    
                                    ]
                                 
                                 ∩
                                 
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                              
                           . This immediately leads to

                              
                                 (4.9)
                                 
                                    
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       >
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          
                                             z
                                             0
                                          
                                          )
                                       
                                       +
                                       ϵ
                                       /
                                       2
                                       >
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          
                                             z
                                             0
                                          
                                          )
                                       
                                    
                                 
                              
                           for all 
                              
                                 t
                                 ∈
                                 
                                    [
                                    
                                       t
                                       0
                                    
                                    −
                                    δ
                                    ,
                                    
                                       t
                                       0
                                    
                                    ]
                                 
                                 ∩
                                 
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                              
                           . Now, assign

                              
                                 
                                    
                                       F
                                       :
                                       =
                                       
                                          [
                                          
                                             t
                                             0
                                          
                                          +
                                          
                                             z
                                             0
                                          
                                          −
                                          δ
                                          ,
                                          
                                             t
                                             0
                                          
                                          +
                                          
                                             z
                                             0
                                          
                                          ]
                                       
                                       ∩
                                       2
                                       
                                          (
                                          
                                             (
                                             I
                                             ∖
                                             
                                                D
                                                
                                                   φ
                                                   ′
                                                
                                             
                                             )
                                          
                                          ∩
                                          
                                             [
                                             0
                                             ,
                                             1
                                             /
                                             2
                                             ]
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           Notice that λ(F) = 0, hence F − {z
                           0} (see Eq. (2.2)) is a zero measure subset of [t
                           0 − δ, t
                           0] due to the invariance under translation of the Lebesgue measure. Accordingly, fixing any 
                              
                                 t
                                 ∈
                                 
                                    (
                                    
                                       [
                                       
                                          t
                                          0
                                       
                                       −
                                       δ
                                       ,
                                       
                                          t
                                          0
                                       
                                       ]
                                    
                                    ∖
                                    
                                       (
                                       F
                                       −
                                       
                                          {
                                          
                                             z
                                             0
                                          
                                          }
                                       
                                       )
                                    
                                    )
                                 
                                 ∩
                                 
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                                 ,
                              
                            it is not difficult to see that 
                              
                                 
                                    φ
                                    ′
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                             +
                                             
                                                z
                                                0
                                             
                                          
                                          2
                                       
                                    
                                    )
                                 
                              
                            exists or, equivalently, t + z
                           0 ∈ X
                           2(φ′). Now, assign c ≔ t + z
                           0. Since it is clear that c ∈ ]0, 1], 
                              
                                 t
                                 ,
                                 c
                                 /
                                 2
                                 ∈
                                 
                                    D
                                    
                                       
                                          φ
                                          ′
                                       
                                       ,
                                       c
                                    
                                 
                              
                            and t < c/2, by applying Eq. (4.9) yields ζc
                           (t) > 1 = ζc
                           (c/2), obtaining that not every member of 
                              
                                 
                                    Z
                                    2
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    )
                                 
                              
                            is increasing. The contradiction closes the proof.□

As noted above, the statement of the previous lemma cannot be reversed. Indeed, consider φ as in Example 4.7. We know that such 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    1
                                 
                              
                           . Now, pick any 
                              
                                 
                                    c
                                    ∈
                                    ]
                                 
                                 
                                    
                                       3
                                       4
                                    
                                 
                                 
                                    ,
                                    1
                                    [
                                    :
                                 
                              
                            then, by a simple computation, one finds that 
                              
                                 
                                    ζ
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       4
                                       5
                                    
                                 
                                 
                                    
                                       c
                                       −
                                       
                                          
                                             3
                                             4
                                          
                                       
                                       −
                                       t
                                    
                                 
                              
                            as 
                              
                                 
                                    t
                                    ∈
                                    [
                                    0
                                    ,
                                    c
                                    −
                                 
                                 
                                    
                                       3
                                       4
                                    
                                 
                                 
                                    [
                                    ,
                                 
                              
                            hence it is not increasing.

Our purpose is to determine the class of generators of penalty functions as in Eq. (3.2) for n = 2. Summarizing the last results so far illustrated, we have shown that both the desired class and 
                        
                           S
                           2
                        
                      are strictly included in 
                        
                           S
                           1
                        
                     . Further, we have somehow conjectured that these two classes might be coincident. It remains to be seen whether this conjecture is true.

                        Theorem 4.16
                        Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    1
                                 
                              
                           . Then, φ is a generator of a two-dimensional penalty function 
                              
                                 
                                    P
                                    φ
                                 
                                 :
                                 
                                    
                                       I
                                    
                                    2
                                 
                                 ×
                                 
                                    W
                                    2
                                 
                                 ×
                                 I
                                 →
                                 I
                              
                            if, and only if, 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    2
                                 
                              
                           .

Using the change of variable t ≔ y − x
                           1 and setting c ≔ x
                           2 − x
                           1, the claim is equivalent to showing that every member of 
                              
                                 
                                    F
                                    2
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    ,
                                    φ
                                    )
                                 
                              
                            is quasi-convex if, and only if, any 
                              
                                 
                                    ζ
                                    c
                                 
                                 ∈
                                 
                                    Z
                                    2
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    ,
                                    φ
                                    )
                                 
                              
                            is increasing. First, we state that we can associate to any 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    2
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 
                                    
                                       (
                                       ]
                                    
                                    0
                                    ,
                                    1
                                    ]
                                    )
                                    :
                                 
                                 =
                                 
                                    {
                                    
                                       ψ
                                       
                                          c
                                          ,
                                          w
                                       
                                    
                                    ∈
                                    
                                       F
                                       2
                                    
                                    
                                       (
                                       ]
                                    
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 
                                    )
                                    :
                                    
                                       w
                                       1
                                    
                                    ≥
                                    
                                       w
                                       2
                                    
                                    }
                                 
                              
                            a uniquely determined point 
                              
                                 
                                    t
                                    
                                       c
                                       ,
                                       w
                                    
                                    *
                                 
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    c
                                    /
                                    2
                                    ]
                                 
                              
                            such that 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≥
                                 0
                              
                            for almost all 
                              
                                 t
                                 ∈
                                 [
                                 
                                    t
                                    
                                       c
                                       ,
                                       w
                                    
                                    *
                                 
                                 ,
                                 c
                                 ]
                              
                           . Indeed, given any 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    2
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    )
                                 
                                 ,
                              
                            set 
                              
                                 J
                                 
                                    (
                                    
                                       ψ
                                       
                                          c
                                          ,
                                          w
                                       
                                    
                                    )
                                 
                                 :
                                 =
                                 
                                    {
                                    u
                                    ∈
                                    ]
                                 
                                 0
                                 ,
                                 c
                                 
                                    [
                                    :
                                    
                                       ψ
                                       
                                          c
                                          ,
                                          w
                                       
                                       ′
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ≥
                                    0
                                    
                                    almost
                                    
                                    everywhere
                                    
                                    on
                                    
                                    
                                       [
                                       u
                                       ,
                                       c
                                       ]
                                    
                                    }
                                 
                              
                           . It is quite easy to see that J(ψ
                           
                              c, w
                           ) is a (possibly empty) subinterval of ]0, c[. We assert that J(ψ
                           
                              c, w
                           ) is not empty, because [c/2, c[⊆J(ψ
                           
                              c, w
                           ). In fact any 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    2
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    )
                                 
                              
                            is increasing on [c/2, c], because, due to an elementary algebraic manipulation, it may be rewritten as

                              
                                 
                                    
                                       
                                          ψ
                                          
                                             c
                                             ,
                                             w
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          w
                                          2
                                       
                                       
                                          (
                                          φ
                                          
                                             (
                                             t
                                             )
                                          
                                          +
                                          φ
                                          
                                             (
                                             c
                                             −
                                             t
                                             )
                                          
                                          )
                                       
                                       +
                                       
                                          (
                                          
                                             w
                                             1
                                          
                                          −
                                          
                                             w
                                             2
                                          
                                          )
                                       
                                       φ
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                    
                                 
                              
                           that is a linear combination with non-negative coefficients of two increasing functions on [c/2, c] (the increasing monotonicity of the mapping φ(t) + φ(c − t) on that subdomain is assured by Proposition 4.6). If we bear in mind Lemma 4.2, this amounts to 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≥
                                 0
                              
                            for almost all t ∈ [c/2, c], so the assertion trivially holds as well as the statement, after the assignment 
                              
                                 
                                    t
                                    
                                       c
                                       ,
                                       w
                                    
                                    *
                                 
                                 :
                                 =
                                 inf
                                 J
                                 
                                    (
                                    
                                       ψ
                                       
                                          c
                                          ,
                                          w
                                       
                                    
                                    )
                                 
                              
                           . By the same token, given any 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    2
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 
                                    
                                       (
                                       ]
                                    
                                    0
                                    ,
                                    1
                                    ]
                                    )
                                    :
                                 
                                 =
                                 
                                    {
                                    
                                       ψ
                                       
                                          c
                                          ,
                                          w
                                       
                                    
                                    ∈
                                    
                                       F
                                       2
                                    
                                    
                                       (
                                       ]
                                    
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 
                                    )
                                    :
                                    
                                       w
                                       2
                                    
                                    >
                                    
                                       w
                                       1
                                    
                                    }
                                 
                                 ,
                              
                            there exists a uniquely determined point 
                              
                                 
                                    
                                       t
                                       ^
                                    
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    [
                                    c
                                    /
                                    2
                                    ,
                                    c
                                    ]
                                 
                              
                            such that 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 0
                              
                            for almost all 
                              
                                 t
                                 ∈
                                 [
                                 0
                                 ,
                                 
                                    
                                       t
                                       ^
                                    
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ]
                              
                           .

Turning back to the claim, let us start with the sufficiency and suppose ab absurdo there exists a 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    2
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    )
                                 
                              
                            such that ψ
                           
                              c, w
                            is not quasi-convex. We may limit ourselves to the case 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    2
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    )
                                 
                                 ,
                              
                            since the remaining one may be treated analogously. Trivially, an arbitrary 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    2
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    )
                                 
                              
                            is not quasi-convex if, and only if, 
                              
                                 
                                    t
                                    
                                       c
                                       ,
                                       w
                                    
                                    *
                                 
                                 >
                                 0
                              
                            and 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                    ′
                                 
                                 
                                    (
                                    
                                       t
                                       0
                                    
                                    )
                                 
                                 >
                                 0
                              
                            for some 
                              
                                 
                                    t
                                    0
                                 
                                 ∈
                                 
                                    ]
                                    0
                                    ,
                                    
                                       t
                                       
                                          c
                                          ,
                                          w
                                       
                                       *
                                    
                                    [
                                 
                              
                           . By Remark 4.10, this amounts to 
                              
                                 
                                    ζ
                                    c
                                 
                                 
                                    (
                                    
                                       t
                                       0
                                    
                                    )
                                 
                                 >
                                 
                                    
                                       
                                          w
                                          2
                                       
                                       
                                          w
                                          1
                                       
                                    
                                 
                              
                           . By the increasing monotonicity of ζc
                           , we immediately derive that for almost all t ∈ [t
                           0, c] we have 
                              
                                 
                                    ζ
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 >
                                 
                                    
                                       
                                          w
                                          2
                                       
                                       
                                          w
                                          1
                                       
                                    
                                 
                              
                           . Again by Remark 4.10, this means that 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 >
                                 0
                              
                            almost everywhere on [t
                           0, c], so contradicting the specific nature of the point 
                              
                                 t
                                 
                                    c
                                    ,
                                    w
                                 
                                 *
                              
                            and closing this step. Conversely, assume that every member of 
                              
                                 
                                    F
                                    2
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    )
                                 
                              
                            is quasi-convex. Reasoning by contradiction, suppose that there exists a c ∈ ]0, 1] such that ζc
                           (t
                           1) > ζc
                           (t
                           2) for some t
                           1, t
                           2 ∈ ]0, c[ such that t
                           1 < t
                           2. Suppose first that ζc
                           (t
                           2) < 1. Then, we can always choose a w ∈ W
                           2 such that

                              
                                 (4.10)
                                 
                                    
                                       
                                          w
                                          2
                                       
                                       /
                                       
                                          w
                                          1
                                       
                                       ∈
                                       
                                          ]
                                          
                                             ζ
                                             c
                                          
                                          
                                             (
                                             
                                                t
                                                2
                                             
                                             )
                                          
                                          ,
                                          
                                             ζ
                                             c
                                          
                                          
                                             (
                                             
                                                t
                                                1
                                             
                                             )
                                          
                                          [
                                       
                                       ,
                                    
                                 
                              
                           provided that w
                           1 > w
                           2. By Eq. (4.10), bearing in mind that ζc
                            is continuous, we immediately deduce that there exists a sufficiently small δ > 0 such that

                              
                                 (4.11)
                                 
                                    
                                       
                                          ζ
                                          c
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       <
                                       
                                          w
                                          2
                                       
                                       /
                                       
                                          w
                                          1
                                       
                                       
                                       almost
                                       
                                       everywhere
                                       
                                       on
                                       
                                       
                                          [
                                          
                                             t
                                             2
                                          
                                          −
                                          δ
                                          ,
                                          
                                             t
                                             2
                                          
                                          +
                                          δ
                                          ]
                                       
                                       ,
                                    
                                 
                              
                           and at the same time

                              
                                 (4.12)
                                 
                                    
                                       
                                          ζ
                                          c
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       >
                                       
                                          w
                                          2
                                       
                                       /
                                       
                                          w
                                          1
                                       
                                       
                                       almost
                                       
                                       everywhere
                                       
                                       on
                                       
                                       
                                          [
                                          
                                             t
                                             1
                                          
                                          −
                                          δ
                                          ,
                                          
                                             t
                                             1
                                          
                                          +
                                          δ
                                          ]
                                       
                                       .
                                    
                                 
                              
                           Owing to Remark 4.10 and Lemma 4.2, we know that Eqs. (4.11) and(4.12) amount to the decreasing and increasing monotonicity of the corresponding ψ
                           
                              c, w
                            on the intervals [t
                           2 − δ, t
                           2 + δ] and [t
                           1 − δ, t
                           1 + δ] respectively, so showing that ψ
                           
                              c, w
                            is not quasi-convex and contradicting the assumption. The remaining case ζc
                           (t
                           2) ≥ 1 may be treated analogously, choosing a w ∈ W
                           2 such that

                              
                                 
                                    
                                       
                                          w
                                          2
                                       
                                       /
                                       
                                          w
                                          1
                                       
                                       ∈
                                       
                                          ]
                                          
                                             ζ
                                             c
                                          
                                          
                                             (
                                             
                                                t
                                                2
                                             
                                             )
                                          
                                          ,
                                          
                                             ζ
                                             c
                                          
                                          
                                             (
                                             
                                                t
                                                1
                                             
                                             )
                                          
                                          [
                                       
                                       ,
                                    
                                 
                              
                           provided that w
                           2 > w
                           1, so concluding the proof.□

We emphasize that 
                              CA
                            is strictly included in 
                              
                                 S
                                 2
                              
                           . Indeed, let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                                 :
                              
                            if φ is convex, then φ′ is increasing and so is any 
                              
                                 
                                    ζ
                                    c
                                 
                                 ∈
                                 
                                    Z
                                    2
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    )
                                 
                                 ,
                              
                            being a ratio whose numerator and denominator are an increasing and a decreasing positive function, respectively. Now, consider the following 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                                 :
                              
                           
                           
                              
                                 
                                    
                                       φ
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                         2
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                      t
                                                      ≤
                                                      
                                                         3
                                                         4
                                                      
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                      −
                                                      7
                                                      
                                                         
                                                            (
                                                            t
                                                            −
                                                            1
                                                            )
                                                         
                                                         2
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           We claim that such mapping, although evidently not convex, belongs to 
                              
                                 S
                                 2
                              
                           . By Lemma 4.13, being X
                           2(φ′) = ]0, 1], we may check the increasing monotonicity of an arbitrary 
                              
                                 
                                    ζ
                                    c
                                 
                                 ∈
                                 
                                    Z
                                    2
                                 
                                 
                                    (
                                    ]
                                 
                                 0
                                 ,
                                 1
                                 
                                    ]
                                    )
                                 
                              
                            on [0, c/2]. Fixing any 
                              
                                 
                                    c
                                    ∈
                                    ]
                                    0
                                    ,
                                 
                                 
                                    
                                       3
                                       4
                                    
                                 
                                 
                                    ]
                                    ,
                                 
                              
                            
                           ζc
                            is clearly increasing because of the convexity of φ on the subdomain 
                              
                                 [
                                 0
                                 ,
                                 
                                    
                                       3
                                       4
                                    
                                 
                                 ]
                              
                           . When 
                              
                                 
                                    c
                                    ∈
                                    ]
                                 
                                 
                                    
                                       3
                                       4
                                    
                                 
                                 
                                    ,
                                    1
                                    ]
                                    ,
                                 
                              
                            by a direct computation one finds that

                              
                                 
                                    
                                       
                                          ζ
                                          c
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                         
                                                            7
                                                            (
                                                            t
                                                            +
                                                            1
                                                            −
                                                            c
                                                            )
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                      t
                                                      ∈
                                                      [
                                                      0
                                                      ,
                                                      c
                                                      −
                                                      3
                                                      /
                                                      4
                                                      [
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         t
                                                         
                                                            c
                                                            −
                                                            t
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                      t
                                                      ∈
                                                      ]
                                                      c
                                                      −
                                                      3
                                                      /
                                                      4
                                                      ,
                                                      c
                                                      /
                                                      2
                                                      ]
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           hence the claim easily follows.

In this section, we generalize the main results of the previous section in order to determine the generators of n-dimensional penalty functions of the form given by Eq. (3.2). For this reason, throughout this section, we will take for granted that n > 2, unless otherwise specified.

First, we present the n-dimensional versions of notations already introduced in the previous section for n = 2.

Let En
                      = {x ∈ ]0, 1]
                        n − 1: 0 < xj
                      < x
                     
                        j + 1, j = 1, …, n − 2}. For any vector x ∈ En
                     , we will follow the convention x
                     0 ≔ 0. Moreover, throughout this section, we will reserve the symbol X for denoting an arbitrary subset of En
                      dense in the topological closure of En
                     . Given any 
                        
                           φ
                           ∈
                           
                              S
                              0
                           
                           ,
                        
                      let 
                        
                           
                              F
                              n
                           
                           
                              (
                              X
                              ,
                              φ
                              )
                           
                           =
                           
                              {
                              
                                 ψ
                                 
                                    c
                                    ,
                                    w
                                 
                              
                              :
                              c
                              ∈
                              X
                              ,
                              w
                              ∈
                              
                                 W
                                 n
                              
                              }
                           
                        
                      be the class of mappings 
                        
                           
                              ψ
                              
                                 c
                                 ,
                                 w
                              
                           
                           :
                           
                              [
                              0
                              ,
                              
                                 c
                                 
                                    n
                                    −
                                    1
                                 
                              
                              ]
                           
                           →
                           R
                        
                      defined by

                        
                           
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    w
                                    i
                                 
                                 
                                    φ
                                    (
                                    |
                                 
                                 
                                    c
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 −
                                 t
                                 
                                    |
                                    )
                                 
                                 .
                              
                           
                        
                     We will adopt the shorthand notation 
                        
                           
                              F
                              n
                           
                           
                              (
                              X
                              )
                           
                        
                      for 
                        
                           
                              F
                              n
                           
                           
                              (
                              X
                              ,
                              φ
                              )
                           
                        
                      unless otherwise stated. Obviously, 
                        
                           
                              F
                              n
                           
                           
                              (
                              X
                              )
                           
                        
                      coincides with the previously introduced 
                        
                           
                              F
                              2
                           
                           
                              (
                              X
                              )
                           
                        
                      for n = 2. Similar to the n = 2 case above, we can state that every mapping of 
                        
                           
                              F
                              n
                           
                           
                              (
                              X
                              )
                           
                        
                      is absolutely continuous and a.e. differentiable.

                        Remark 5.1
                        Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                            and 
                              
                                 c
                                 ∈
                                 X
                              
                           . Following the same line of reasoning of Remark 4.3, it is easy to see that the complement of the set 
                              
                                 
                                    D
                                    
                                       
                                          φ
                                          ′
                                       
                                       ,
                                       c
                                    
                                 
                                 :
                                 =
                                 
                                    {
                                    t
                                    ∈
                                    I
                                    :
                                    max
                                    
                                       {
                                       
                                          c
                                          j
                                       
                                       −
                                       t
                                       ,
                                       t
                                       −
                                       
                                          c
                                          j
                                       
                                       }
                                    
                                    ∈
                                    
                                       D
                                       
                                          φ
                                          ′
                                       
                                    
                                    ,
                                    j
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    n
                                    −
                                    1
                                    }
                                 
                              
                            has zero measure, hence we may assume that the domain of the derivative of every member of the subclass 
                              
                                 {
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    n
                                 
                                 
                                    (
                                    X
                                    )
                                 
                                 :
                                 w
                                 ∈
                                 
                                    W
                                    n
                                 
                                 }
                              
                            of 
                              
                                 
                                    F
                                    n
                                 
                                 
                                    (
                                    X
                                    )
                                 
                              
                            is just 
                              
                                 D
                                 
                                    
                                       φ
                                       ′
                                    
                                    ,
                                    c
                                 
                              
                           .

The next result is the n-dimensional version of Lemma 4.4 and consequently the proof will be omitted.

                        Lemma 5.2
                        Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                           . Assume that every function of 
                              
                                 
                                    F
                                    n
                                 
                                 
                                    (
                                    X
                                    )
                                 
                              
                            is quasi-convex for some dense subset X⊂En
                           . Then, every mapping of 
                              
                                 
                                    F
                                    n
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    )
                                 
                              
                            is quasi-convex.

Let An
                      = {p ∈ ]0, ∞[
                        n
                     : p
                     1 = pn
                      = 1}. Given any 
                        
                           φ
                           ∈
                           
                              S
                              0
                           
                           ,
                        
                      let 
                        
                           
                              Z
                              n
                           
                           
                              (
                              X
                              ,
                              φ
                              )
                           
                           =
                           
                              {
                              
                                 ζ
                                 
                                    c
                                    ,
                                    p
                                 
                              
                              :
                              c
                              ∈
                              X
                              ,
                              p
                              ∈
                              
                                 A
                                 n
                              
                              }
                           
                        
                      be the class of functions defined a.e. on [0, c
                     
                        n − 1] and described as

                        
                           
                              
                                 
                                    ζ
                                    
                                       c
                                       ,
                                       p
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       
                                          p
                                          i
                                       
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          t
                                          −
                                          
                                             c
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             k
                                             +
                                             2
                                          
                                          n
                                       
                                       
                                          p
                                          i
                                       
                                       
                                          φ
                                          ′
                                       
                                       
                                          (
                                          
                                             c
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          −
                                          t
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 
                                    ]
                                    
                                       c
                                       k
                                    
                                    ,
                                    
                                       c
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    [
                                 
                                 ,
                                 k
                                 ∈
                                 
                                    {
                                    0
                                    ,
                                    …
                                    ,
                                    n
                                    −
                                    2
                                    }
                                 
                                 .
                              
                           
                        
                     We will adopt the shorthand notation 
                        
                           
                              Z
                              n
                           
                           
                              (
                              X
                              )
                           
                        
                      for 
                        
                           
                              Z
                              n
                           
                           
                              (
                              X
                              ,
                              φ
                              )
                           
                        
                      unless otherwise stated. Obviously, 
                        
                           
                              Z
                              n
                           
                           
                              (
                              X
                              )
                           
                        
                      coincides with the previously introduced 
                        
                           
                              Z
                              2
                           
                           
                              (
                              X
                              )
                           
                        
                      for n = 2.

                        Remark 5.3
                        Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                            and 
                              
                                 c
                                 ∈
                                 X
                              
                           . Observe that there is a natural, biunivocal correspondence between the subclass 
                              
                                 {
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    n
                                 
                                 
                                    (
                                    X
                                    ,
                                    φ
                                    )
                                 
                                 :
                                 w
                                 ∈
                                 
                                    W
                                    n
                                 
                                 }
                              
                            of 
                              
                                 
                                    F
                                    n
                                 
                                 
                                    (
                                    X
                                    ,
                                    φ
                                    )
                                 
                              
                            and the subclass 
                              
                                 {
                                 
                                    ζ
                                    
                                       c
                                       ,
                                       p
                                    
                                 
                                 ∈
                                 
                                    Z
                                    n
                                 
                                 
                                    (
                                    X
                                    ,
                                    φ
                                    )
                                 
                                 :
                                 p
                                 ∈
                                 
                                    A
                                    n
                                 
                                 }
                              
                            of 
                              
                                 
                                    Z
                                    n
                                 
                                 
                                    (
                                    X
                                    ,
                                    φ
                                    )
                                 
                              
                           . In particular, according to Remark 5.1, we may assume that the domain of any member of 
                              
                                 {
                                 
                                    ζ
                                    
                                       c
                                       ,
                                       p
                                    
                                 
                                 ∈
                                 
                                    Z
                                    n
                                 
                                 
                                    (
                                    X
                                    ,
                                    φ
                                    )
                                 
                                 :
                                 p
                                 ∈
                                 
                                    A
                                    n
                                 
                                 }
                              
                            coincides with 
                              
                                 D
                                 
                                    
                                       φ
                                       ′
                                    
                                    ,
                                    c
                                 
                              
                           . Moreover, let 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    n
                                 
                                 
                                    (
                                    X
                                    ,
                                    φ
                                    )
                                 
                              
                            and 
                              
                                 
                                    t
                                    ∈
                                    ]
                                 
                                 
                                    c
                                    k
                                 
                                 ,
                                 
                                    c
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 
                                    [
                                    ∩
                                 
                                 
                                    D
                                    
                                       
                                          φ
                                          ′
                                       
                                       ,
                                       c
                                    
                                 
                              
                            for some k ∈ {0, …, n − 2}: an elementary computation shows that the inequality 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 >
                                 0
                              
                            amounts to 
                              
                                 
                                    ζ
                                    
                                       c
                                       ,
                                       
                                          p
                                          w
                                       
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 >
                                 
                                    
                                       
                                          w
                                          n
                                       
                                       
                                          w
                                          1
                                       
                                    
                                 
                                 ,
                              
                            where the vector 
                              
                                 
                                    p
                                    w
                                 
                                 ∈
                                 
                                    A
                                    n
                                 
                              
                            is given by

                              
                                 (5.1)
                                 
                                    
                                       
                                       
                                          
                                             (
                                             
                                                p
                                                w
                                             
                                             )
                                          
                                          j
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                         j
                                                      
                                                      /
                                                      
                                                         w
                                                         1
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                      j
                                                      ∈
                                                      {
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      k
                                                      +
                                                      1
                                                      }
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                         j
                                                      
                                                      /
                                                      
                                                         w
                                                         n
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                      j
                                                      ∈
                                                      {
                                                      k
                                                      +
                                                      2
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      }
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We emphasize the fact that the property of increasing monotonicity of all mappings of 
                        
                           
                              Z
                              n
                           
                           
                              (
                              
                                 E
                                 n
                              
                              )
                           
                        
                      will play a crucial role in characterizing the family of generators of penalty functions of the form given by Eq. (3.2). The next result, which states that it suffices to verify such property at least for a particular dense subset X⊂En
                     , relies upon a similar argument as we have used in the proof of the corresponding Lemma 4.11, hence the proof will be omitted.

                        Lemma 5.4
                        Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                           . Assume that there exists a dense subset X⊂En
                            such that every mapping of 
                              
                                 
                                    Z
                                    n
                                 
                                 
                                    (
                                    X
                                    )
                                 
                              
                            is increasing. Then, every member of 
                              
                                 
                                    Z
                                    n
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    )
                                 
                              
                            is increasing.

Let us introduce the notable subclass of 
                        
                           S
                           0
                        
                      given by 
                        
                           
                              S
                              n
                           
                           
                              =
                              {
                              φ
                              ∈
                           
                           
                              S
                              0
                           
                           :
                        
                      every member of 
                        
                           
                              Z
                              n
                           
                           
                              (
                              
                                 E
                                 n
                              
                              )
                           
                        
                      is increasing}. Note that 
                        
                           S
                           n
                        
                      reduces to the previously introduced 
                        
                           S
                           2
                        
                      when n = 2. Remark that the verification task of the characterizing property of 
                        
                           S
                           n
                        
                      may be slightly simplified if we make use of a suitable dense subset X, illustrated in the next lemma.

                        Lemma 5.5
                        Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    0
                                 
                              
                            and n > 2. Let 
                              
                                 
                                    X
                                    n
                                 
                                 
                                    (
                                    
                                       φ
                                       ′
                                    
                                    )
                                 
                                 
                                    =
                                    {
                                    c
                                    ∈
                                 
                                 
                                    E
                                    n
                                 
                                 :
                                 
                                    c
                                    k
                                 
                                 −
                                 
                                    c
                                    j
                                 
                                 ∈
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                              
                            for all k, j ∈ {0, …, n − 1} such that k < j}. Then, Xn
                           (φ′) is a dense subset of En
                           .

Let x ∈ En
                            and ε > 0. Being 
                              
                                 D
                                 
                                    φ
                                    ′
                                 
                              
                            a dense subset of 
                              I
                            (see Remark 4.1), after selecting δ
                           1 = min {ε, x
                           1}, we know that there exists a c
                           1 ∈ ]x
                           1 − δ
                           1, x
                           1] such that 0 < c
                           1 ≤ x
                           1, with x
                           1 − c
                           1 < ε, and 
                              
                                 
                                    c
                                    1
                                 
                                 ∈
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                              
                           . Now, consider the set 
                              
                                 
                                    (
                                    I
                                    ∖
                                    
                                       D
                                       
                                          φ
                                          ′
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    {
                                    
                                       c
                                       1
                                    
                                    }
                                 
                              
                           : evidently, this set has measure zero, hence its complement with respect to 
                              
                                 D
                                 
                                    φ
                                    ′
                                 
                              
                            is dense in 
                              I
                           . Thus, after selecting δ
                           2 = min {ε, x
                           2 − x
                           1}, there exists a c
                           2 ∈ ]x
                           2 − δ
                           2, x
                           2] such that 
                              
                                 
                                    c
                                    2
                                 
                                 ∈
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                                 ∖
                                 
                                    (
                                    
                                       (
                                       I
                                       ∖
                                       
                                          D
                                          
                                             φ
                                             ′
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       {
                                       
                                          c
                                          1
                                       
                                       }
                                    
                                    )
                                 
                              
                           . While it is obvious that x
                           1 < c
                           2 ≤ x
                           2, with x
                           2 − c
                           2 < ε, and 
                              
                                 
                                    c
                                    2
                                 
                                 ∈
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                                 ,
                              
                            it is not difficult to check that 
                              
                                 
                                    c
                                    2
                                 
                                 −
                                 
                                    c
                                    1
                                 
                                 ∈
                                 
                                    D
                                    
                                       φ
                                       ′
                                    
                                 
                              
                           . Repeating the same argument for a finite number of steps, it is quite easy to see that we can determine a vector c ∈ ]0, 1]
                              n − 1 (following the convention c
                           0 ≔ 0) satisfying the following properties:

                              
                                 (A1)
                                 
                                    x
                                    
                                       k − 1 < ck
                                     ≤ xk
                                    , k = 1, …, n − 1;


                                    
                                       
                                          
                                             c
                                             k
                                          
                                          −
                                          
                                             c
                                             j
                                          
                                          ∈
                                          
                                             D
                                             
                                                φ
                                                ′
                                             
                                          
                                       
                                     for all k, j ∈ {0, …, n − 1} such that k < j;


                                    xk
                                     − ck
                                     < ε, k = 1, …, n − 1.

From (A1) and (A2), it directly follows that c ∈ Xn
                           (φ′). Moreover, by (A3) we derive that ‖c − x‖∞ < ε, where the symbol ‖ · ‖∞ stands for the sup norm, so closing the proof.□

We emphasize that generally Xn
                     (φ′) does not reduce to X
                     2(φ′) introduced in Remark 4.12 when n = 2.

                        Lemma 5.6
                        Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    1
                                 
                              
                           . Assume that every mapping of 
                              
                                 
                                    Z
                                    n
                                 
                                 
                                    (
                                    
                                       X
                                       n
                                    
                                    
                                       (
                                       
                                          φ
                                          ′
                                       
                                       )
                                    
                                    )
                                 
                              
                            is increasing on any subdomain [ck, c
                           
                              k + 1] for all k ∈ {0, …, n − 2}. Then, every member of 
                              
                                 
                                    Z
                                    n
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    )
                                 
                              
                            is increasing.

By Lemma 5.4, given any 
                              
                                 
                                    ζ
                                    
                                       c
                                       ,
                                       p
                                    
                                 
                                 ∈
                                 
                                    Z
                                    n
                                 
                                 
                                    (
                                    
                                       X
                                       n
                                    
                                    
                                       (
                                       
                                          φ
                                          ′
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                              
                            it suffices to show that ζ
                           
                              c, p
                           (ck
                           
                           −) ≤ ζ
                           
                              c, p
                           (ck
                           
                           +) for any k ∈ {1, …, n − 2}, where

                              
                                 
                                    
                                       
                                          ζ
                                          
                                             c
                                             ,
                                             p
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   c
                                                   k
                                                
                                             
                                             −
                                          
                                          )
                                       
                                       :
                                       =
                                       
                                          lim
                                          
                                             
                                                t
                                                ↑
                                             
                                             
                                                c
                                                k
                                             
                                          
                                       
                                       
                                          ζ
                                          
                                             c
                                             ,
                                             p
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                       
                                       
                                       
                                       
                                          ζ
                                          
                                             c
                                             ,
                                             p
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   c
                                                   k
                                                
                                             
                                             +
                                          
                                          )
                                       
                                       :
                                       =
                                       
                                          lim
                                          
                                             
                                                t
                                                ↓
                                             
                                             
                                                c
                                                k
                                             
                                          
                                       
                                       
                                          ζ
                                          
                                             c
                                             ,
                                             p
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       .
                                    
                                 
                              
                           Observe that ζ
                           
                              c, p
                           (ck
                           
                           −) and ζ
                           
                              c, p
                           (ck
                           
                           +) exist due to the monotonicity of ζ
                           
                              c, p
                            on both the intervals [c
                           
                              k − 1, ck
                           ] and [ck, c
                           
                              k + 1]. As a straightforward consequence of the characterizing property of Xn
                           (φ′) and the continuity of φ′, it is quite easy to check that

                              
                                 
                                    
                                       
                                          ζ
                                          
                                             c
                                             ,
                                             p
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   c
                                                   k
                                                
                                             
                                             −
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                k
                                             
                                             
                                                p
                                                i
                                             
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   c
                                                   k
                                                
                                                −
                                                
                                                   c
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   k
                                                   +
                                                   1
                                                
                                                n
                                             
                                             
                                                p
                                                i
                                             
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   c
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                
                                                   c
                                                   k
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           and

                              
                                 
                                    
                                       
                                          ζ
                                          
                                             c
                                             ,
                                             p
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   c
                                                   k
                                                
                                             
                                             +
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             
                                                p
                                                i
                                             
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   c
                                                   k
                                                
                                                −
                                                
                                                   c
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   k
                                                   +
                                                   2
                                                
                                                n
                                             
                                             
                                                p
                                                i
                                             
                                             
                                                φ
                                                ′
                                             
                                             
                                                (
                                                
                                                   c
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                
                                                   c
                                                   k
                                                
                                                )
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           Note that both ζ
                           
                              c, p
                           (ck
                           
                           −) and ζ
                           
                              c, p
                           (ck
                           
                           +) contain the term φ′(0), which certainly exists and is a finite non-negative number by (P1). Finally, the desired inequality easily follows from the fact that the numerator of ζ
                           
                              c, p
                           (ck
                           
                           +) is the sum of the numerator of ζ
                           
                              c, p
                           (ck
                           
                           −) and the non-negative term p
                           
                              k + 1φ′(0) and the same holds for the denominators, with interchanged roles of ζ
                           
                              c, p
                           (ck
                           
                           −) and ζ
                           
                              c, p
                           (ck
                           
                           +).□

Now we are ready to state the corresponding result of Theorem 4.16 for the n-dimensional case. Note that, being interested in the case n > 2, we can assume without loss of generality that any candidate φ belongs to 
                        
                           S
                           2
                        
                     .

                        Theorem 5.7
                        Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    2
                                 
                              
                           . Then, φ is a generator of a n-dimensional penalty function 
                              
                                 
                                    P
                                    φ
                                 
                                 :
                                 
                                    
                                       I
                                    
                                    n
                                 
                                 ×
                                 
                                    W
                                    n
                                 
                                 ×
                                 I
                                 →
                                 I
                              
                            if, and only if, 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    n
                                 
                              
                           .

Using the change of variable t ≔ y − x
                           1 and setting c
                           
                              i − 1 ≔ xi
                            − x
                           1 for i = 1, …, n, the claim is equivalent to showing that every member of 
                              
                                 
                                    F
                                    n
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    ,
                                    φ
                                    )
                                 
                              
                            is quasi-convex if, and only if, any 
                              
                                 
                                    ζ
                                    
                                       c
                                       ,
                                       p
                                    
                                 
                                 ∈
                                 
                                    Z
                                    n
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    ,
                                    φ
                                    )
                                 
                              
                            is increasing. First, we state that we can associate to any 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    n
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    )
                                 
                                 :
                                 =
                                 
                                    {
                                    
                                       ψ
                                       
                                          c
                                          ,
                                          w
                                       
                                    
                                    ∈
                                    
                                       F
                                       n
                                    
                                    
                                       (
                                       
                                          E
                                          n
                                       
                                       )
                                    
                                    :
                                    
                                       w
                                       1
                                    
                                    ≥
                                    
                                       w
                                       n
                                    
                                    }
                                 
                              
                            a uniquely determined point 
                              
                                 
                                    t
                                    
                                       c
                                       ,
                                       w
                                    
                                    *
                                 
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    
                                       c
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    [
                                 
                              
                            such that 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≥
                                 0
                              
                            for almost all 
                              
                                 t
                                 ∈
                                 [
                                 
                                    t
                                    
                                       c
                                       ,
                                       w
                                    
                                    *
                                 
                                 ,
                                 
                                    c
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 ]
                              
                           . Indeed, repeating same argument as we have used in the corresponding part of the proof of Theorem 4.16, let 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    n
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    )
                                 
                              
                            and set 
                              
                                 J
                                 
                                    (
                                    
                                       ψ
                                       
                                          c
                                          ,
                                          w
                                       
                                    
                                    )
                                 
                                 :
                                 =
                                 
                                    {
                                    u
                                    ∈
                                    ]
                                 
                                 0
                                 ,
                                 
                                    c
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    [
                                    :
                                    
                                       ψ
                                       
                                          c
                                          ,
                                          w
                                       
                                       ′
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ≥
                                    0
                                    
                                    almost
                                    
                                    everywhere
                                    
                                    on
                                    
                                    
                                       [
                                       u
                                       ,
                                       
                                          c
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       ]
                                    
                                    }
                                 
                              
                           . Since it is clear that J(ψ
                           
                              c, w
                           ) is a subinterval of ]0, c
                           
                              n − 1[, the statement easily follows from the assignment 
                              
                                 
                                    t
                                    
                                       c
                                       ,
                                       w
                                    
                                    *
                                 
                                 :
                                 =
                                 inf
                                 J
                                 
                                    (
                                    
                                       ψ
                                       
                                          c
                                          ,
                                          w
                                       
                                    
                                    )
                                 
                                 ,
                              
                            provided J(ψ
                           
                              c, w
                           ) is not empty. To this end, by an elementary algebraic manipulation, any 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    n
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    )
                                 
                              
                            may be seen as the sum of two functions, i.e. w
                           1φ(t) + wn
                           φ(c
                           
                              n − 1 − t) and 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       2
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    w
                                    i
                                 
                                 
                                    φ
                                    (
                                    |
                                 
                                 
                                    c
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 −
                                 t
                                 
                                    |
                                    )
                                 
                                 ,
                              
                            called in the sequel first and second summand, respectively. From the trivial identity

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                   1
                                                
                                                φ
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                +
                                                
                                                   w
                                                   n
                                                
                                                φ
                                                
                                                   (
                                                   
                                                      c
                                                      
                                                         n
                                                         −
                                                         1
                                                      
                                                   
                                                   −
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      w
                                                      1
                                                   
                                                   +
                                                   
                                                      w
                                                      n
                                                   
                                                   )
                                                
                                                ·
                                                
                                                   (
                                                   
                                                      
                                                         w
                                                         1
                                                      
                                                      
                                                         
                                                            w
                                                            1
                                                         
                                                         +
                                                         
                                                            w
                                                            n
                                                         
                                                      
                                                   
                                                   φ
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   
                                                      w
                                                      n
                                                   
                                                   
                                                      
                                                         w
                                                         1
                                                      
                                                      +
                                                      
                                                         w
                                                         n
                                                      
                                                   
                                                
                                                φ
                                                
                                                   (
                                                   
                                                      c
                                                      
                                                         n
                                                         −
                                                         1
                                                      
                                                   
                                                   −
                                                   t
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

we easily deduce that, due to Theorem 4.16, the first summand is increasing at least on [c
                           
                              n − 1/2, c
                           
                              n − 1]. At the same time, since the second summand may be rewritten as 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       2
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    w
                                    i
                                 
                                 φ
                                 
                                    (
                                    t
                                    −
                                    
                                       c
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 
                              
                            for t ∈ [c
                           
                              n − 2, c
                           
                              n − 1], it is certainly increasing on the subdomain [c
                           
                              n − 2, c
                           
                              n − 1] due to the monotonicity of φ. Accordingly, we derive that ψ
                           
                              c, w
                            is increasing at least on [max {c
                           
                              n − 1/2, c
                           
                              n − 2}, c
                           
                              n − 1], hence, due to Lemma 4.2, we can draw the desired conclusion. By the same token, given any 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    n
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    )
                                 
                                 :
                                 =
                                 
                                    {
                                    
                                       ψ
                                       
                                          c
                                          ,
                                          w
                                       
                                    
                                    ∈
                                    
                                       F
                                       n
                                    
                                    
                                       (
                                       
                                          E
                                          n
                                       
                                       )
                                    
                                    :
                                    
                                       w
                                       1
                                    
                                    <
                                    
                                       w
                                       n
                                    
                                    }
                                 
                                 ,
                              
                            there exists a uniquely determined point 
                              
                                 
                                    
                                       t
                                       ^
                                    
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    ]
                                    0
                                    ,
                                    
                                       c
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    ]
                                 
                              
                            such that 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 0
                              
                            for almost all 
                              
                                 t
                                 ∈
                                 [
                                 0
                                 ,
                                 
                                    
                                       t
                                       ^
                                    
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ]
                              
                           . Turning back to the claim, let us start with the sufficiency and suppose ab absurdo there exists a 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    n
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    )
                                 
                              
                            such that ψ
                           
                              c, w
                            is not quasi-convex. We may limit ourselves to the case 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    n
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    )
                                 
                                 ,
                              
                            since the remaining one may be dealt with in analogous manner. Trivially, an arbitrary 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                 
                                 ∈
                                 
                                    F
                                    n
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    )
                                 
                              
                            is not quasi-convex if, and only if, 
                              
                                 
                                    t
                                    
                                       c
                                       ,
                                       w
                                    
                                    *
                                 
                                 >
                                 0
                              
                            and 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                    ′
                                 
                                 
                                    (
                                    
                                       t
                                       0
                                    
                                    )
                                 
                                 >
                                 0
                              
                            for some 
                              
                                 
                                    t
                                    0
                                 
                                 ∈
                                 
                                    ]
                                    0
                                    ,
                                    
                                       t
                                       
                                          c
                                          ,
                                          w
                                       
                                       *
                                    
                                    [
                                 
                              
                           . By Remark 5.3, this amounts to 
                              
                                 
                                    ζ
                                    
                                       c
                                       ,
                                       
                                          p
                                          w
                                       
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 >
                                 
                                    
                                       
                                          w
                                          n
                                       
                                       
                                          w
                                          1
                                       
                                    
                                 
                                 ,
                              
                            where the vector p
                           
                              w
                            is as in Eq. (5.1). By the increasing monotonicity of 
                              
                                 
                                    ζ
                                    
                                       c
                                       ,
                                       
                                          p
                                          w
                                       
                                    
                                 
                                 ,
                              
                            we immediately derive that for almost all t ∈ [t
                           0, c
                           
                              n − 1] it holds 
                              
                                 
                                    ζ
                                    
                                       c
                                       ,
                                       
                                          p
                                          w
                                       
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 >
                                 
                                    
                                       
                                          w
                                          n
                                       
                                       
                                          w
                                          1
                                       
                                    
                                 
                              
                           . Again by Remark 5.3, this means that 
                              
                                 
                                    ψ
                                    
                                       c
                                       ,
                                       w
                                    
                                    ′
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 >
                                 0
                              
                            almost everywhere on [t
                           0, c
                           
                              n − 1], so contradicting the specific nature of the point 
                              
                                 t
                                 
                                    c
                                    ,
                                    w
                                 
                                 *
                              
                            and closing this step. Conversely, assume that every member of 
                              
                                 
                                    F
                                    n
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    )
                                 
                              
                            is quasi-convex. Reasoning by contradiction, suppose that there exists at least a member of 
                              
                                 
                                    Z
                                    n
                                 
                                 
                                    (
                                    
                                       E
                                       n
                                    
                                    )
                                 
                              
                            which is not increasing. By Lemma 5.6, this entails that there exists a 
                              
                                 
                                    ζ
                                    
                                       c
                                       ,
                                       p
                                    
                                 
                                 ∈
                                 
                                    Z
                                    n
                                 
                                 
                                    (
                                    
                                       X
                                       n
                                    
                                    
                                       (
                                       
                                          φ
                                          ′
                                       
                                       )
                                    
                                    )
                                 
                              
                            such that ζ
                           
                              c, p
                           (t
                           1) > ζ
                           
                              c, p
                           (t
                           2) for some ck
                            < t
                           1 < t
                           2 < c
                           
                              k + 1 and for some k ∈ {0, …, n − 2}. We only study the case ζ
                           
                              c, p
                           (t
                           2) < 1, since the case ζ
                           
                              c, p
                           (t
                           2) ≥ 1 may be treated analogously. Then, after the assignment 
                              
                                 
                                    p
                                    t
                                 
                                 :
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    p
                                    i
                                 
                                 ,
                              
                            let us consider the family Un
                           (pt
                           ) of vectors w(β) ∈ ]0, 1]
                              n
                            described as

                              
                                 (5.2)
                                 
                                    
                                       
                                       
                                          w
                                          j
                                       
                                       
                                          (
                                          β
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                         j
                                                      
                                                      /
                                                      
                                                         p
                                                         t
                                                      
                                                      +
                                                      β
                                                      
                                                         p
                                                         j
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  k
                                                                  +
                                                                  2
                                                               
                                                               n
                                                            
                                                            
                                                               p
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                            
                                                            
                                                               p
                                                               i
                                                            
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                      j
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      k
                                                      +
                                                      1
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                         j
                                                      
                                                      /
                                                      
                                                         p
                                                         t
                                                      
                                                      −
                                                      β
                                                      
                                                         p
                                                         j
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                      j
                                                      =
                                                      k
                                                      +
                                                      2
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           for β ∈ [0, pt
                           [. By a simple computation, one easily finds that Un
                           (pt
                           ) is a subset of Wn
                           . Now, if we consider the mapping β↦f(β) ≔ wn
                           (β)/w
                           1(β), it is not a difficult task to check that f is strictly decreasing on [0, 1/pt
                           [ with boundary values f(0) = 1 and f(1/pt
                           ) = 0. Hence, we can always choose a β* ∈ ]0, 1/pt
                           [ such that

                              
                                 (5.3)
                                 
                                    
                                       f
                                       
                                          (
                                          
                                             β
                                             *
                                          
                                          )
                                       
                                       ∈
                                       
                                          ]
                                          
                                             ζ
                                             
                                                c
                                                ,
                                                p
                                             
                                          
                                          
                                             (
                                             
                                                t
                                                2
                                             
                                             )
                                          
                                          ,
                                          
                                             ζ
                                             
                                                c
                                                ,
                                                p
                                             
                                          
                                          
                                             (
                                             
                                                t
                                                1
                                             
                                             )
                                          
                                          [
                                       
                                       .
                                    
                                 
                              
                           By Eq. (5.3), bearing in mind that ζ
                           
                              c, p
                            is continuous, we immediately deduce that there exists a sufficiently small δ > 0 such that

                              
                                 (5.4)
                                 
                                    
                                       
                                          ζ
                                          
                                             c
                                             ,
                                             p
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       <
                                       f
                                       
                                          (
                                          
                                             β
                                             *
                                          
                                          )
                                       
                                       
                                       almost
                                       
                                       everywhere
                                       
                                       on
                                       
                                       
                                          [
                                          
                                             t
                                             2
                                          
                                          −
                                          δ
                                          ,
                                          
                                             t
                                             2
                                          
                                          +
                                          δ
                                          ]
                                       
                                       ,
                                    
                                 
                              
                           and at the same time

                              
                                 (5.5)
                                 
                                    
                                       
                                          ζ
                                          
                                             c
                                             ,
                                             p
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       >
                                       f
                                       
                                          (
                                          
                                             β
                                             *
                                          
                                          )
                                       
                                       
                                       almost
                                       
                                       everywhere
                                       
                                       on
                                       
                                       
                                          [
                                          
                                             t
                                             1
                                          
                                          −
                                          δ
                                          ,
                                          
                                             t
                                             1
                                          
                                          +
                                          δ
                                          ]
                                       
                                       .
                                    
                                 
                              
                           According to Eqs. (5.1) and(5.2), an elementary calculation shows that 
                              
                                 p
                                 =
                                 
                                    p
                                    
                                       
                                          w
                                       
                                       *
                                    
                                 
                                 ,
                              
                            where w* ≔ w(β*). Therefore, owing to Remark 5.3 and Lemma 4.2, we know that Eqs. (5.4) and(5.5) amount to the decreasing and increasing monotonicity of the corresponding 
                              
                                 ψ
                                 
                                    c
                                    ,
                                    
                                       
                                          w
                                       
                                       *
                                    
                                 
                              
                            on the intervals [t
                           2 − δ, t
                           2 + δ] and [t
                           1 − δ, t
                           1 + δ], respectively. This shows that 
                              
                                 ψ
                                 
                                    c
                                    ,
                                    
                                       
                                          w
                                       
                                       *
                                    
                                 
                              
                            is not quasi-convex, so contradicting the assumption and definitely concluding the proof.□

Owing to the above result, it is not difficult to show that 
                        
                           
                              S
                              
                                 n
                                 +
                                 1
                              
                           
                           ⊂
                           
                              S
                              n
                           
                        
                      for all n ≥ 2. In fact, by Theorem 5.7, it is enough to show that every member of 
                        
                           
                              F
                              n
                           
                           
                              (
                              
                                 E
                                 n
                              
                              ,
                              φ
                              )
                           
                        
                      is quasi-convex for any fixed 
                        
                           φ
                           ∈
                           
                              S
                              
                                 n
                                 +
                                 1
                              
                           
                        
                     . The claim is trivially proved if, given any 
                        
                           
                              ψ
                              
                                 c
                                 ,
                                 w
                              
                           
                           ∈
                           
                              F
                              n
                           
                           
                              (
                              
                                 E
                                 n
                              
                              ,
                              φ
                              )
                           
                        
                      and any ε > 0, there exists a quasi-convex mapping 
                        
                           
                              g
                              ϵ
                           
                           :
                           
                              [
                              0
                              ,
                              
                                 c
                                 
                                    n
                                    −
                                    1
                                 
                              
                              ]
                           
                           →
                           R
                        
                      such that ‖ψ
                     
                        c, w
                      − g
                     ε‖∞ ≤ ε. Let us choose as g
                     ε the function given by g
                     ε(t) = ψ
                     
                        c, w
                     (t) + ε · φ(|c
                     ε − t|), where c
                     ε is any real number belonging to ]0, c
                     1[. It is immediate to check that ‖ψ
                     
                        c, w
                      − g
                     ε‖∞ ≤ ε, hence it remains to be seen whether g
                     ε or, equivalently, g
                     ε/(1 + ε) is quasi-convex. The last step, left to the reader, is to verify that 
                        
                           
                              g
                              ϵ
                           
                           /
                           
                              (
                              1
                              +
                              ϵ
                              )
                           
                           =
                           
                              ψ
                              
                                 
                                    c
                                    ϵ
                                 
                                 ,
                                 
                                    w
                                    ϵ
                                 
                              
                           
                           ∈
                           
                              F
                              
                                 n
                                 +
                                 1
                              
                           
                           
                              (
                              
                                 E
                                 
                                    n
                                    +
                                    1
                                 
                              
                              ,
                              φ
                              )
                           
                           ,
                        
                      where c
                     ε ∈ E
                     
                        n + 1 and w
                     ε ∈ W
                     
                        n + 1 are respectively given by

                        
                           
                              
                                 
                                    
                                       (
                                       
                                          c
                                          ϵ
                                       
                                       )
                                    
                                    j
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                   ϵ
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                j
                                                =
                                                1
                                                ;
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                j
                                                =
                                                2
                                                ,
                                                …
                                                ,
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     and

                        
                           
                              
                                 
                                    
                                       (
                                       
                                          w
                                          ϵ
                                       
                                       )
                                    
                                    j
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                   1
                                                
                                                /
                                                
                                                   (
                                                   1
                                                   +
                                                   ϵ
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                j
                                                =
                                                1
                                                ;
                                             
                                          
                                       
                                       
                                          
                                             
                                                ϵ
                                                /
                                                (
                                                1
                                                +
                                                ϵ
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                j
                                                =
                                                2
                                                ;
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                /
                                                
                                                   (
                                                   1
                                                   +
                                                   ϵ
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                j
                                                =
                                                3
                                                ,
                                                …
                                                ,
                                                n
                                                +
                                                1
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     We have proved the following.

                        Lemma 5.8
                        Let 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                           . Then, 
                              
                                 φ
                                 ∈
                                 
                                    S
                                    n
                                 
                              
                           .

Notice that 
                        CA
                      is a subclass of 
                        
                           S
                           n
                        
                      for any n ≥ 2: this statement is exactly based upon the same argument as the one used in Remark 4.17.

Let 
                        
                           S
                           :
                           =
                           
                              ⋂
                              
                                 n
                                 =
                                 2
                              
                              ∞
                           
                           
                              S
                              n
                           
                        
                     : as above noted, 
                        
                           CA
                           ⊆
                           S
                        
                     . Now the problem is: does 
                        S
                      exactly coincide with 
                        CA
                      or not? Well, the answer is negative, as we show in the conclusive part of this section.

Consider the function 
                        
                           φ
                           ∈
                           
                              S
                              2
                           
                        
                      introduced in Remark 4.17: we will prove that such mapping, which is not convex, actually belongs to 
                        
                           S
                           n
                        
                      for every fixed n > 2. Let 
                        
                           
                              ζ
                              
                                 c
                                 ,
                                 p
                              
                           
                           ∈
                           
                              Z
                              n
                           
                           
                              (
                              
                                 X
                                 n
                              
                              
                                 (
                                 
                                    φ
                                    ′
                                 
                                 )
                              
                              )
                           
                        
                      and let k ∈ {0, …, n − 2}: by Lemma 5.6, the claim is equivalent to saying that ζ
                     
                        c, p
                      is increasing on [ck, c
                     
                        k + 1]. Consider the two finite sequences ξi
                      ≔ c
                     
                        i − 1 + 3/4 for i = 1, …, k + 1 and ηi
                      ≔ c
                     
                        i − 1 − 3/4 for i = k + 2, …, n. It is immediate to see that

                        
                           (5.6)
                           
                              
                                 
                                    η
                                    
                                       k
                                       +
                                       2
                                    
                                 
                                 <
                                 …
                                 <
                                 
                                    η
                                    n
                                 
                                 <
                                 
                                    ξ
                                    1
                                 
                                 <
                                 …
                                 <
                                 
                                    ξ
                                    
                                       k
                                       +
                                       1
                                    
                                 
                              
                           
                        
                     and that ξi
                      ≠ ck, c
                     
                        k + 1 for all i ∈ {1, …, k + 1} as well as ηi
                      ≠ ck, c
                     
                        k + 1 for all i ∈ {k + 2, …, n}, because of the characterizing property of Xn
                     (φ′). Note that φ′ exists at all 
                        
                           t
                           ∈
                           I
                        
                      except for t = ξ
                     1. Let us divide the analysis of ζ
                     
                        c, p
                      on [ck, c
                     
                        k + 1] into two main cases:

                        
                           (1)
                           
                              ξ
                              1 < ck
                              ;


                              ξ
                              1 > ck
                              .

In case 1, we immediately deduce that k > 0 and 
                        
                           
                              [
                              
                                 c
                                 k
                              
                              ,
                              
                                 c
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ]
                           
                           ⊂
                           
                              D
                              
                                 
                                    φ
                                    ′
                                 
                                 ,
                                 c
                              
                           
                        
                     . This case in its turn may be divided into the two following sub-cases:

                        
                           (1A)
                           there exists a unique r ∈ {1, …, k} such that ξr
                               < ck
                               < c
                              
                                 k + 1 < ξ
                              
                                 r + 1;

there exist two uniquely determined indices r, s ∈ {1, …, k}, with r < s, such that ξr
                               < ck
                               < ξs
                               < c
                              
                                 k + 1 < ξ
                              
                                 s + 1.

In the first sub-case, also taking into account Eq. (5.6), it is only a matter of computation to check that for any t ∈ [ck, c
                     
                        k + 1] we have

                        
                           (5.7)
                           
                              
                                 
                                    ζ
                                    
                                       c
                                       ,
                                       p
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 7
                                 
                                    μ
                                    r
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 +
                                 
                                    ν
                                    r
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                              
                           
                        
                     where

                        
                           
                              
                                 
                                    μ
                                    j
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 :
                                 =
                                 
                                    
                                       −
                                       
                                          (
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             j
                                          
                                          
                                             p
                                             i
                                          
                                          )
                                       
                                       t
                                       +
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          j
                                       
                                       
                                          p
                                          i
                                       
                                       
                                          (
                                          1
                                          +
                                          
                                             c
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       
                                          (
                                          
                                             ∑
                                             
                                                i
                                                =
                                                k
                                                +
                                                2
                                             
                                             n
                                          
                                          
                                             p
                                             i
                                          
                                          )
                                       
                                       t
                                       +
                                       
                                          ∑
                                          
                                             i
                                             =
                                             k
                                             +
                                             2
                                          
                                          n
                                       
                                       
                                          p
                                          i
                                       
                                       
                                          c
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                     and

                        
                           
                              
                                 
                                    ν
                                    j
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 :
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             j
                                             +
                                             1
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       
                                          p
                                          i
                                       
                                       
                                          (
                                          t
                                          −
                                          
                                             c
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             k
                                             +
                                             2
                                          
                                          n
                                       
                                       
                                          p
                                          i
                                       
                                       
                                          (
                                          
                                             c
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          −
                                          t
                                          )
                                       
                                    
                                 
                              
                           
                        
                     for any index j ∈ {1, …, k}. The increasing monotonicity of νr
                     (t) is immediate, while the condition of (strict) increasing monotonicity for μr
                     (t) is easily shown to be given by

                        
                           (5.8)
                           
                              
                                 
                                    (
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       r
                                    
                                    
                                       p
                                       i
                                    
                                    )
                                 
                                 ·
                                 
                                    (
                                    
                                       ∑
                                       
                                          i
                                          =
                                          k
                                          +
                                          2
                                       
                                       n
                                    
                                    
                                       p
                                       i
                                    
                                    
                                       c
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 <
                                 
                                    (
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       r
                                    
                                    
                                       p
                                       i
                                    
                                    
                                       (
                                       1
                                       +
                                       
                                          c
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ·
                                 
                                    (
                                    
                                       ∑
                                       
                                          i
                                          =
                                          k
                                          +
                                          2
                                       
                                       n
                                    
                                    
                                       p
                                       i
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     Observe that Eq. (5.8) directly follows from the trivial inequalities

                        
                           
                              
                                 
                                    (
                                    1
                                    +
                                    
                                       c
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    i
                                 
                                 ≥
                                 
                                    p
                                    i
                                 
                                 ,
                                 
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 r
                                 ;
                                 
                                 
                                    p
                                    i
                                 
                                 ≥
                                 
                                    p
                                    i
                                 
                                 
                                    c
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                 i
                                 =
                                 k
                                 +
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        
                     and the fact that at least one of the above inequalities is necessarily strict. In sub-case 1B, it is not a difficult task to see that ζ
                     
                        c, p
                     , restricted to every subinterval of the type [ck, ξ
                     
                        r + 1], ...,[ξs, c
                     
                        k + 1], is again of the form described in Eq. (5.7), with the only difference that μr
                     (t) and νr
                     (t) must be replaced by μj
                     (t) and νj
                     (t) respectively for any j ∈ {r, …, s}, hence we may omit the proof. In case 2, we only discuss the sub-case in which there exist two uniquely determined indices r ∈ {k + 2, …, n − 1} and s ∈ {1, …, k} such that

                        
                           
                              
                                 
                                    η
                                    r
                                 
                                 <
                                 
                                    c
                                    k
                                 
                                 <
                                 
                                    η
                                    
                                       r
                                       +
                                       1
                                    
                                 
                                 <
                                 
                                    η
                                    n
                                 
                                 <
                                 
                                    ξ
                                    1
                                 
                                 <
                                 
                                    ξ
                                    s
                                 
                                 <
                                 
                                    c
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 <
                                 
                                    ξ
                                    
                                       s
                                       +
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                     because any other sub-case is similar and even simpler. Note that 
                        
                           
                              [
                              
                                 c
                                 k
                              
                              ,
                              
                                 c
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ]
                           
                           ∩
                           
                           
                              D
                              
                                 
                                    φ
                                    ′
                                 
                                 ,
                                 c
                              
                           
                        
                      is the finite union of three types of subintervals, i.e. [aj, η
                     
                        j + 1] for any j ∈ {r, …, n − 1}, where aj
                      ≔ max {ck, ηj
                     }, then [ηn, ξ
                     1[ and finally [ξj, bj
                     ]∖{ξ
                     1} for any j ∈ {1, …, s}, where bj
                      ≔ min {c
                     
                        k + 1, ξ
                     
                        j + 1}. For the first type, after some elementary algebra, one finds that

                        
                           
                              
                                 
                                    1
                                    
                                       
                                          ζ
                                          
                                             c
                                             ,
                                             p
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 =
                                 7
                                 
                                    μ
                                    j
                                    *
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 +
                                 
                                    ν
                                    j
                                    *
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                              
                           
                        
                     where

                        
                           
                              
                                 
                                    μ
                                    j
                                    *
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 :
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             ∑
                                             
                                                i
                                                =
                                                j
                                                +
                                                1
                                             
                                             n
                                          
                                          
                                             p
                                             i
                                          
                                          )
                                       
                                       t
                                       +
                                       
                                          ∑
                                          
                                             i
                                             =
                                             j
                                             +
                                             1
                                          
                                          n
                                       
                                       
                                          p
                                          i
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             c
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          (
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          
                                             p
                                             i
                                          
                                          )
                                       
                                       t
                                       −
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       
                                          p
                                          i
                                       
                                       
                                          c
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                     and

                        
                           
                              
                                 
                                    ν
                                    j
                                    *
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 :
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             k
                                             +
                                             2
                                          
                                          j
                                       
                                       
                                          p
                                          i
                                       
                                       
                                          (
                                          
                                             c
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          −
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       
                                          p
                                          i
                                       
                                       
                                          (
                                          t
                                          −
                                          
                                             c
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     The decreasing monotonicity of 
                        
                           
                              ν
                              j
                              *
                           
                           
                              (
                              t
                              )
                           
                        
                      is immediate as well as the (strict) decreasing monotonicity of 
                        
                           
                              μ
                              j
                              *
                           
                           
                              (
                              t
                              )
                           
                        
                      due to a trivial condition similar to Eq. (5.8), so closing this first step. The increasing monotonicity of ζ
                     
                        c, p
                      on the subinterval [ηn, ξ
                     1[ is a straightforward consequence of the convexity of φ on such subdomain. Finally, relatively to any subinterval of the third type, it is quite easy to see that Eq. (5.7) still holds, with μj
                     (t) and νj
                     (t) in place of μr
                     (t) and νr
                     (t), respectively. In order to conclude that the proposed φ belongs to 
                        
                           S
                           ,
                        
                      it remains to be seen whether ζ
                     
                        c, p
                     (ξ
                     1
                     −) ≤ ζ
                     
                        c, p
                     (ξ
                     1
                     +): this directly follows from the fact that, after some trivial computation, we get

                        
                           
                              
                                 
                                    
                                       
                                          ζ
                                          
                                             c
                                             ,
                                             p
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   ξ
                                                   1
                                                
                                             
                                             −
                                          
                                          )
                                       
                                    
                                    
                                       
                                          ζ
                                          
                                             c
                                             ,
                                             p
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   ξ
                                                   1
                                                
                                             
                                             +
                                          
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       3
                                       /
                                       4
                                       +
                                       
                                          ∑
                                          
                                             i
                                             =
                                             2
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       
                                          p
                                          i
                                       
                                       
                                          (
                                          
                                             ξ
                                             1
                                          
                                          −
                                          
                                             c
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       7
                                       /
                                       4
                                       +
                                       
                                          ∑
                                          
                                             i
                                             =
                                             2
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       
                                          p
                                          i
                                       
                                       
                                          (
                                          
                                             ξ
                                             1
                                          
                                          −
                                          
                                             c
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

@&#CONCLUSION@&#

We have discussed a model of construction of penalty functions by means of a general class of restricted dissimilarity functions, depending on automorphisms of the real unit interval also called generators, which properly includes the faithful restricted dissimilarity functions appeared in Bustince et al. (2013). We have characterized the generators of penalty functions for any dimension n ≥ 2. We have provided an explicit example which shows that convexity is not a necessary property for a generator of penalty functions of arbitrary dimension.

In the future, we plan to study the assumptions to be demanded to an arbitrary restricted dissimilarity function dR
                      in order for a one-variable mapping of the type

                        
                           
                              
                                 y
                                 ↦
                                 P
                                 
                                    (
                                    x
                                    ,
                                    w
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    w
                                    i
                                 
                                 
                                    d
                                    R
                                 
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    ,
                                    y
                                    )
                                 
                              
                           
                        
                     to be a penalty function, so extending the results proposed in this paper.

@&#REFERENCES@&#

