@&#MAIN-TITLE@&#Covariance matrix estimation for left-censored data

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           ML based covariance matrix estimator for left-censored data is introduced.


                        
                        
                           
                           Computation times are decreased considerably with parallelized pairwise estimation.


                        
                        
                           
                           The proposed estimators produce unbiased estimates with reasonable variation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Maximum likelihood estimation

Covariance matrix

Left-censoring

Non-detects

@&#ABSTRACT@&#


               
               
                  Multivariate methods often rely on a sample covariance matrix. The conventional estimators of a covariance matrix require complete data vectors on all subjects—an assumption that can frequently not be met. For example, in many fields of life sciences that are utilizing modern measuring technology, such as mass spectrometry, left-censored values caused by denoising the data are a commonplace phenomena. Left-censored values are low-level concentrations that are considered too imprecise to be reported as a single number but known to exist somewhere between zero and the laboratory’s lower limit of detection. Maximum likelihood-based covariance matrix estimators that allow the presence of the left-censored values without substituting them with a constant or ignoring them completely are considered. The presented estimators efficiently use all the information available and thus, based on simulation studies, produce the least biased estimates compared to often used competing estimators. As the genuine maximum likelihood estimate can be solved fast only in low dimensions, it is suggested to estimate the covariance matrix element-wise and then adjust the resulting covariance matrix to achieve positive semi-definiteness. It is shown that the new approach succeeds in decreasing the computation times substantially and still produces accurate estimates. Finally, as an example, a left-censored data set of toxic chemicals is explored.
               
            

@&#INTRODUCTION@&#

Multivariate methods often rely on the sample covariance matrix. For example, principal component analysis, which is used to describe high dimensional data in lower dimensions, uses the eigenvalue decomposition of the covariance matrix. In canonical correlation analysis, blocks of the covariance matrix are used to find the maximal correlation between linear combinations of variables belonging to two different data sets. The conventional estimators of the covariance matrix require complete data vectors on all subjects, which is an assumption that can frequently not be met. Many fields of life sciences are constrained by the measurement accuracy of modern measurement technology. Often, it is impossible to quantify the exact concentration or the complete absence of a compound, especially at the low end of the detectable concentration range. The lowest concentration that can be reliably detected with the given analytical method is referred to as the lower limit of detection (LLOD) (Browne and Whitcomb, 2010). Measurements falling below the LLOD are referred to as left-censored values or, in some contexts, non-detects.

For data that contain left-censored values, if the analysis is carried out using only the completely observed data, the means of the concentrations would be overestimated and the standard deviations would be underestimated. Consequently, any related test statistic or estimate would be biased. Thus, neglecting these informative censored values can lead to a severe bias and a loss of precision due to the decrease of the effective sample size.

In the presence of left-censored values, a common and simple way to deal with the estimation of the covariance matrix is to delete any subject containing at least one censored value. To avoid completely ignoring these subjects, Little and Rubin (2002) propose to build the estimate of the covariance matrix one element at a time by using all observations for which both values are present. However, the resulting covariance matrix estimate is not necessarily positive semi-definite. According to Mehrotra (1995), the efficient use of all observed data is more important than the possible lack of positive semi-definiteness. If the positive semi-definiteness is lost, he recommends the element-wise estimation of the variances and covariances combined with a possible adjustment.

Another commonly used approach is to substitute the left-censored values with a suitable constant and then to compute the sample covariance from the resulting complete data. The potential substitution value can be the sample mean of the uncensored values for the corresponding variable, zero, 
                        
                           LLOD
                        
                        /
                        2
                     , or the minimum of the observed values. These alternative approaches have been investigated in previous studies (Farnham et al., 2002; El-Shaarawi and Esterby, 1992; Succop et al., 2004). All of them are more or less biased, but they are still used despite the criticism (Helsel, 2005, 2006).

In addition to the mentioned quick fixes, there exists more eloquent methods to overcome the challenges set by censored data. Instead of single and simple substitutions, one approach is to multiply impute the censored values. The key idea is to use the conditional distribution of the observed data to generate a set of plausible imputations for the censored data (Rubin, 2004, 1996; Carpenter and Kenward, 2013). Imputations are repeated several times, creating multiple data sets, which are then analyzed individually as if they were complete. Thus, if the main interest lies in estimating the covariance matrix for the left-censored data, the multiple imputation would be followed by computing the standard sample covariances for each of the imputed data sets. Finally, the results are combined across all multiply imputed data sets by so-called “Rubin’s rules”, which incorporate the imputation-related uncertainty into the analysis (Rubin, 2004). The multiple imputation methods for left-censored data may be appealing due to their relatively simple computational algorithms. The literature includes applications in univariate (Baccarelli et al., 2005; Huybrechts et al., 2002), bivariate (Chen et al., 2011) and multivariate settings (Hopke et al., 2001; Chen et al., 2013).


                     Hewett and Ganser (2007) divide censored data analysis methods into four categories: substitution methods, log-probit regression, maximum likelihood (ML) estimation methods, and non-parametric methods. None of the methods has been recommended for all different scenarios. The recommendation depends on the sample size, the divergence from log-normal distribution or the degree of censoring. However, due to its many desirable statistical properties, ML estimation is often considered the gold standard provided the data is well-described by some parametric probability distribution (Helsel, 1990; Koo et al., 2002; Zhao and Frey, 2006).

Extensive literature exists regarding univariate and bivariate ML-based methods for estimating the measures of centrality and variability in the presence of the left-censored values, such as Lyles et al. (2001), Lynn (2001) and Williams and Ebel (2014). The majority of these works are based on the normality assumption. Song et al. (2004) propose an alternative, more robust approach based on generalized estimating equations to estimate the correlation between two continuous variables with left-censored values. Their method also has an advantage of not requiring time consuming optimization routines.

The extensions of ML-based estimation techniques to the multivariate setting are fewer. If it could be assumed that each variable is identically distributed (normal, gamma, or Weibull), then the results proposed by Gupta (1952) and Harter and Moore (1967) could be applied. In practice, however, this is not often a realistic assumption. Chung (1993) proposes a covariance matrix estimation method that uses marginal ML estimation. Despite its good practical properties, theoretically it is not a ML estimator but rather a good-enough approximation.

Building on the work of Lyles et al. (2001), Perkins et al. (2013) propose a ML estimator for the mean vector and the covariance matrix based on the multivariate normality assumption in the presence of left-censored values. They formulate the likelihood function as a product of the marginal multivariate distribution for the observed variables and the conditional multivariate distribution for the left-censored variables. They also develop an approximation for the Fisher information and covariance matrix for the estimated parameters and give an example based on a three-parameter multivariate normal distribution.

To overcome the complexity of estimating the parameters of multivariate normal and log-normal models by maximizing the logarithm of the likelihood equations, Hoffmann and Johnson (2014) proposes a pseudo-likelihood approach. The pseudo-likelihood estimate maximizes a computationally simpler approximation of the log-likelihood function but is not equal to it.

Against this background, we address the challenge of dealing with the left-censoring in the analysis of multivariate data and introduce an efficient way to use the values that are below the set LLOD. We formulate the likelihood maximization problem similar to Perkins et al. (2013) by assuming a multivariate normal distribution but in addition investigate both theoretical and practical properties of the proposed estimators. In practice, it is difficult to obtain the ML estimates for the covariance matrix from a data set including left-censored values due to the need for complex iterative procedures. As we show in Section  3.3, the numerical optimization of the log-likelihood function involving multivariate distributions is extremely slow, especially in higher dimensions. Thus we propose pairwise maximum likelihood estimation of the covariance matrix with an adjustment to achieve positive semi-definiteness of the resulting estimate.

In Section  2 we describe the likelihood functions for partially observed data. In Section  3 we discuss the computational issues and find solutions to them. In Section  4 we present results of simulations to assess the performance of our proposed estimators. In Section  5 we present an application using toxic chemical data. We conclude with the discussion in Section  6.

Many biological variables follow a log-normal distribution meaning that the log-transformed variables are normally distributed. Thus, in general, we observe the (possibly log-transformed) biological variables 
                        
                           Y
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                           
                           
                              T
                           
                        
                      on 
                        n
                      independent subjects from a 
                        p
                     -variate distribution 
                        f
                      with the expectation 
                        
                           μ
                        
                      and the covariance matrix 
                        
                           Σ
                        
                     . Let 
                        
                           
                              y
                           
                           
                              i
                              j
                           
                        
                      denote the value of the 
                        j
                     th variable, 
                        j
                        =
                        
                           (
                           1
                           ,
                           …
                           ,
                           p
                           )
                        
                     , for subject 
                        i
                        ,
                        
                        i
                        =
                        
                           (
                           1
                           ,
                           …
                           ,
                           n
                           )
                        
                     . Potentially, a substantial number of 
                        
                           
                              y
                           
                           
                              i
                              j
                           
                        
                      are not detected. Let 
                        
                           
                              
                                 y
                              
                           
                           
                              
                                 o
                              
                           
                        
                      and 
                        
                           
                              
                                 y
                              
                           
                           
                              
                                 m
                              
                           
                        
                      denote the observed and the censored elements in the 
                        1
                        ×
                        p
                      vector 
                        
                           y
                        
                     , respectively.

Let LLODs 
                        
                           c
                        
                        =
                        
                           (
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 c
                              
                              
                                 p
                              
                           
                           )
                        
                      be a vector of length 
                        p
                     . Generally, the measuring instrument determines the LLODS, i.e., how small concentrations can be reliably measured. Consequently, the left-censored values arise when the concentrations fall below the LLODs. In practical settings, the LLODs are often variable specific (as presented here), but our method is also applicable in settings where the LLODs are subject- or sample-specific, and for the most general case, where the LLOD for each variable varies from one subject to another. (For generality, we also investigate a setting where the exact LLODs are not known, but they are estimated as the minimum observed concentrations for each variable or for each subject or sample. In this case, the minimum observed concentration value for each subject or sample is the ML estimate for the LLOD, if an assumption on multivariate normal distribution holds, and the LLODs are the same across all subjects.)

Without censored values, the likelihood function contribution of subject 
                        i
                      is 
                        
                           (1)
                           
                              
                                 
                                    L
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    μ
                                 
                                 ,
                                 
                                    Σ
                                 
                                 )
                              
                              =
                              f
                              
                                 (
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ;
                                 
                                    μ
                                 
                                 ,
                                 
                                    Σ
                                 
                                 )
                              
                              .
                           
                        
                      If 
                        k
                      variables are observed and 
                        p
                        −
                        k
                      variables are left-censored, the contribution of one subject to the likelihood can be defined as 
                        
                           (2)
                           
                              
                                 
                                    L
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    μ
                                 
                                 ,
                                 
                                    Σ
                                 
                                 )
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    
                                       o
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       i
                                       ,
                                       
                                          o
                                       
                                    
                                 
                                 )
                              
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          Ω
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    
                                       m
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       i
                                       ,
                                       
                                          m
                                       
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       i
                                       ,
                                       
                                          o
                                       
                                    
                                 
                                 )
                              
                              
                                 
                                    
                                       dy
                                    
                                 
                                 
                                    i
                                    ,
                                    
                                       m
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                      is the part of the observation space that we are unable to observe and that is defined by the LLODs. (When the LLODs are estimated, then 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                      is an approximation, as is the resulting likelihood.) The integral represents the probability of having the 
                        p
                        −
                        k
                      variables below the LLOD given that the 
                        k
                      variables are observed. Finally, the full likelihood is often presented in the mathematically convenient log-scale as a sum of the logarithms of likelihood contributions of each subject, 
                        
                           (3)
                           
                              ℓ
                              
                                 (
                                 
                                    μ
                                 
                                 ,
                                 
                                    Σ
                                 
                                 )
                              
                              =
                              log
                              L
                              
                                 (
                                 
                                    μ
                                 
                                 ,
                                 
                                    Σ
                                 
                                 )
                              
                              =
                              log
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    L
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    μ
                                 
                                 ,
                                 
                                    Σ
                                 
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              log
                              
                                 
                                    L
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    μ
                                 
                                 ,
                                 
                                    Σ
                                 
                                 )
                              
                              .
                           
                        
                     
                  

In the special case of the multivariate normal distribution, the subjects’ contributions to the likelihood are built in parts as follows. First, for each subject, the number of the left-censored values is counted. Next, we partition the expected values and the covariance matrices for observed and censored variables. These are the blocks of the joint mean and the joint covariance of the observed and left-censored variables, 
                        
                           
                              
                                 μ
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             
                                                o
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             
                                                m
                                             
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                              and
                              
                              
                                 Σ
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                
                                                   oo
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                
                                                   om
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                
                                                   mo
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                
                                                   mm
                                                
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                      Depending on the number of the left-censored variables, the log-likelihood for subject 
                        i
                      is combined from one or two of the following parts: 
                        
                           (1)
                           Observed variables in 
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                           

The log-likelihood function for the observed variables, 
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                       ,
                                       
                                          o
                                       
                                    
                                 
                              , is based on the density function of the multivariate normal distribution 
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             μ
                                          
                                       
                                       
                                          
                                             o
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       
                                          
                                             o
                                          
                                       
                                    
                                    )
                                 
                               evaluated at 
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       
                                          o
                                       
                                    
                                 
                              . If there are no observed values, then 
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                       ,
                                       
                                          o
                                       
                                    
                                 
                                 =
                                 0
                              .

Left-censored variables in partially observed 
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                           

If some variables are observed and some left-censored, then the log-likelihood function for the left-censored variables, 
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                       ,
                                       
                                          m
                                       
                                    
                                 
                              , is based on the probability function of the multivariate conditional normal distribution, 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             
                                                (
                                                p
                                                −
                                                k
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   μ
                                                
                                             
                                             
                                                
                                                   m
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                
                                                   mo
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                
                                                   o
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   
                                                      o
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      μ
                                                   
                                                
                                                
                                                   
                                                      o
                                                   
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                
                                                   m
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                
                                                   mo
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                
                                                   o
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                
                                                   mo
                                                
                                             
                                             
                                                T
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                               evaluated at 
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       i
                                    
                                 
                              . If all variables are observed or left-censored, then 
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                       ,
                                       
                                          m
                                       
                                    
                                 
                                 =
                                 0
                              .

Left-censored variables in fully unobserved 
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                           

If all variables are censored, the likelihood function 
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                       ,
                                       
                                          ma
                                       
                                    
                                 
                               is based on the cumulative distribution function of the multivariate normal distribution 
                                 
                                    
                                       N
                                    
                                    
                                       p
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             μ
                                          
                                       
                                       
                                          
                                             m
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       
                                          
                                             m
                                          
                                       
                                    
                                    )
                                 
                               evaluated at LLODs. If there are one or more observed values, then 
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                       ,
                                       
                                          ma
                                       
                                    
                                 
                                 =
                                 0
                              .

For the case of a 
                           p
                        -variate normal distribution to estimate the mean vector and covariance matrix in the presence of left-censored data using ML estimation, we solved the maximization problem by using the limited memory algorithm for bound constrained optimization (Byrd et al., 1995).

The estimate of the covariance matrix has to be positive semi-definite and symmetric. Just by maximizing the log-likelihood function we cannot ensure that this basic property holds. To overcome this problem, the optimization task was re-parametrized via estimating the elements of 
                           
                              L
                           
                         in the Cholesky decomposition 
                           
                              Σ
                           
                           =
                           
                              L
                           
                           
                              
                                 
                                    L
                                 
                              
                              
                                 T
                              
                           
                         instead of estimating 
                           
                              Σ
                           
                        . The initial values of the parameters were computed by substituting all left-censored values with 
                           
                              LLOD
                           
                           /
                           2
                         and then computing the sample covariance matrix and its Cholesky decomposition as well as the component-wise sample means from the resulting complete data set.

In the iterative optimization, the estimate of the covariance matrix (and its sub-matrices such as the covariance matrix of the observed values 
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 
                                    o
                                 
                              
                           
                         of subject 
                           i
                        ) has to be positive semi-definite. If the estimate was not positive semi-definitive (assessed by its reciprocal condition number) at a particular step of the iteration, a small constant of 10−6 was added to its diagonal elements to force the covariance matrix to be invertible (Golub and Loan, 1989).

For complete data with no censored values, the covariance matrix can be constructed element-wise by computing the variances and the pairwise covariances separately. When discussing the robust estimation of the covariance matrix estimation in the presence of any kind of missing data, Mehrotra (1995) proposes the element-wise estimation of the covariance matrix using all the observations for which both variables have valid values. We adopt only the idea of element-wise estimation and use the ML estimator with known LLODs to allow for the presence of the left-censored values.

As the ML estimation problem can be solved fast only in low dimensions, a practical approximation is to use the ML estimates of 2×2 covariance submatrices for the 
                           j
                        th and 
                           k
                        th variables, 
                           ∀
                           j
                           ,
                           k
                           ∈
                           
                              {
                              1
                              ,
                              …
                              ,
                              p
                              }
                           
                         s.t. 
                           j
                           <
                           k
                         and combine these into the full covariance matrix. This results in 
                           p
                           −
                           1
                         estimates for each variance parameter and one estimate for each covariance parameter. One possible solution to combine the 
                           p
                           −
                           1
                         variance estimates into one is to take their mean, and this is what we propose to do. However, the resulting estimated covariance matrix may not be acceptable as it is not guaranteed to be positive semi-definite.

If needed, the nearest positive-definite matrix can be found using a method suggested by Higham (2002). For the pairwise estimated symmetric covariance matrix 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    Pair
                                 
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 p
                                 ×
                                 p
                              
                           
                        , the problem is to find a symmetric positive definite matrix 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    Pair
                                 
                              
                           
                         such that the distance between 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    Pair
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    Pair
                                 
                              
                           
                         is minimized, i.e., 
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          Pair
                                       
                                    
                                 
                                 =
                                 arg
                                 min
                                 
                                    {
                                    
                                       ‖
                                       
                                          
                                             
                                                S
                                             
                                          
                                          
                                             
                                                Pair
                                             
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                Pair
                                             
                                          
                                       
                                       ‖
                                    
                                    :
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             Pair
                                          
                                       
                                    
                                      is a symmetric positive definite matrix
                                    }
                                 
                                 .
                              
                           
                         The norm used is the Frobenius norm, 
                           
                              
                                 
                                    ‖
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          
                                             Pair
                                          
                                       
                                    
                                    ‖
                                 
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                           
                              
                                 Σ
                              
                              
                                 j
                              
                           
                           
                              
                                 s
                              
                              
                                 i
                                 j
                              
                              
                                 2
                              
                           
                        , where 
                           
                              
                                 s
                              
                              
                                 i
                                 j
                              
                           
                         are the elements of 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    Pair
                                 
                              
                           
                        . The method is implemented, for example, in the R-package Matrix (Bates and Maechler, 2014).

Even though solving the optimization problem is fast at 
                           p
                           =
                           2
                        , the number of pairs increases rapidly as the number of variables increases. For example, for 
                           p
                           =
                           100
                        , the number of pairs is 4950. Thus, the computation times for pairwise estimation can be substantial in higher dimensions. In order to decrease the computation time, the pairwise estimation problems can be divided for parallel cores and solved simultaneously. The resulting estimates are then combined into the full estimates of the covariance matrix and the mean vector.

We conducted an experiment to compare the computation times between the genuine ML estimate with known LLODs 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    MLE
                                 
                              
                           
                        , adjusted pairwise estimate 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    Pair
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    Pair
                                 
                              
                           
                         achieved via parallel computation. All computations were performed using R 3.0.2 on a Windows server with two Intel(R) Xeon(R) CPU R5 2440 with 2.40 GHz and 64 GB. We generated observations for 
                           n
                           =
                           100
                         subjects from a 
                           p
                        -dimensional normal distribution 
                           N
                           
                              (
                              
                                 μ
                              
                              ,
                              
                                 Σ
                              
                              )
                           
                         where 
                           
                              μ
                           
                           =
                           
                              (
                              0
                              ,
                              …
                              ,
                              0
                              )
                           
                        . Three different dimensions were selected, 
                           p
                           =
                           3
                        , 10, and 100. For 
                           p
                           =
                           3
                        , the covariance structure was defined as 
                           
                              
                                 
                                    Σ
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                          
                                          
                                             0.5
                                          
                                          
                                             −
                                             0.5
                                          
                                       
                                       
                                          
                                             0.5
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             −
                                             0.5
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         and for 
                           p
                           =
                           10
                         as 
                           
                              
                                 
                                    Σ
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0.5
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0.5
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0.5
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             0.5
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0.5
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             0.5
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                          
                                             0.5
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0.5
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             0.5
                                          
                                          
                                             0.5
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0.5
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                          
                                             0.5
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             0.5
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0.5
                                          
                                          
                                             1
                                          
                                          
                                             0.5
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0.5
                                          
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         For simplicity, the covariance matrix for 
                           p
                           =
                           100
                         was defined as 
                           
                              Σ
                           
                           =
                           0.5
                           ⋅
                           
                              (
                              
                                 I
                              
                              +
                              
                                 1
                              
                              
                                 
                                    
                                       1
                                    
                                 
                                 
                                    T
                                 
                              
                              )
                           
                        , where 
                           
                              I
                           
                         is the identity matrix and 
                           
                              1
                           
                         is a vector of ones.

The percentage of left-censored values was controlled with the choice of LLOD in two different settings. The LLOD was chosen as the 10% or 30% quantile from the standard normal distribution. For simplicity, we set the LLOD to be the same over all subjects and variables. Left-censored values were generated by comparing each concentration value to the LLOD. If the concentration was below the LLOD, it was set as a left-censored value.

For 
                           p
                           =
                           3
                         and 10, the covariance matrices were estimated from 1000 replications, and for 
                           p
                           =
                           100
                        , the covariance matrices were estimated from 20 replications. The computation times were averaged over the replications. The results are presented in Table 1
                        .

For the ML estimate 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    MLE
                                 
                              
                           
                        , the number of estimated parameters for the covariance matrix and the expected values in dimensions: 
                           p
                           =
                           3
                        , 10, and 100 are 9, 65, and 5150, respectively. For the pairwise estimate 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    Pair
                                 
                              
                           
                        , the number of 2×2-covariance matrices to be estimated is: 3 in 
                           p
                           =
                           3
                        , 45 in 
                           p
                           =
                           10
                        , and 4950 in 
                           p
                           =
                           100
                        , and in each small estimation problem, the total number of parameters is 5. As seen in Table 1, the computation times of the ML estimate increase substantially as a function of the dimension and the proportion of censored values. As described in Section  2, likelihoods 
                           
                              
                                 ℓ
                              
                              
                                 i
                              
                           
                         include the cumulative distribution function of the multivariate normal distribution if subject 
                           i
                         has left-censored values. Thus, as the dimension and the proportion of the left-censored values increase, the evaluation of the cumulative distribution function of the multivariate normal distribution becomes slower and slower to evaluate. The proportion of left-censored values does not have a significant effect on the pairwise estimate 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    Pair
                                 
                              
                           
                         as the maximum number of left-censored values in each small estimation problem is always the same.

For parallel 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    Pair
                                 
                              
                           
                        , we divided the pairwise computations across 10 cores using the R-package snowfall (Knaus, 2013). This speeded up the computation considerably and allowed us to estimate both 
                           
                              μ
                           
                         and 
                           
                              Σ
                           
                         for 
                           p
                           =
                           100
                         in approximately 47 min with 10% of censored values and in 57 min with 30% of censored values. The computation times in different dimensions are approximately proportional to the number of pairs (if all 10 cores are used). This is expected, as each of the pairwise estimation has an equal number of parameters to estimate.

In this section we describe the simulation studies performed to compare the ML covariance matrix estimator with selected three competing estimators and also study the performance of the pairwise estimator.

Data were generated from a 
                           p
                        -dimensional normal distribution 
                           N
                           
                              (
                              
                                 μ
                              
                              ,
                              
                                 Σ
                              
                              )
                           
                         (as they would have been originally following multivariate log-normal distribution and then log-transformed) where 
                           
                              μ
                           
                           =
                           
                              (
                              0
                              ,
                              …
                              ,
                              0
                              )
                           
                         and 
                           
                              Σ
                           
                         was comprised of homogeneous variances of 1 and three varying covariance elements: 
                           0
                           ,
                           0.5
                        , and −0.5. The covariance matrices for 
                           p
                           =
                           3
                         and 
                           p
                           =
                           10
                         are shown in Section  3.3.

Two dimensions were used, 
                           p
                           =
                           3
                         and 
                           p
                           =
                           10
                        , resulting in six unknown parameters for 
                           p
                           =
                           3
                         and 55 for 
                           p
                           =
                           10
                        . The number of subjects, 
                           n
                        , was 100. Also, the percentage of left-censored values was controlled with the choice of LLOD as described in Section  3.3.

We have two different versions of the ML covariance estimator. The first one, 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    MLE
                                 
                              
                           
                           
                              (
                              c
                              )
                           
                        , uses the known LLODs, and the second one, 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    MLE
                                 
                              
                           
                           
                              (
                              
                                 
                                    c
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                        , uses the estimated LLOD.

The first competing estimator is 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    C
                                 
                              
                           
                        , the traditional sample covariance matrix computed from the data including only the subjects having no left-censored values. The second estimator, 
                           
                              S
                           
                           
                              (
                              0
                              )
                           
                        , is the sample covariance matrix computed from the data where all censored values are substituted with 
                           log
                           
                              (
                              1
                              
                                 
                                    0
                                 
                                 
                                    −
                                    6
                                 
                              
                              )
                           
                        . How biased the 
                           
                              S
                           
                           
                              (
                              0
                              )
                           
                         is, depends on the distance between zero and LLOD. In our simulations, the LLOD was 0.278 (on log-normal scale) for 10% of left-censored values and 0.595 for 30% of left-censored values. The third competing estimator is 
                           
                              S
                           
                           
                              (
                              c
                              /
                              2
                              )
                           
                        , which is the sample covariance matrix from the data where censored values are substituted with 
                           
                              LLOD
                           
                           /
                           2
                        .

The covariance matrices were estimated from 1000 replications. We compared the differences between the real underlying covariance matrix and each of the covariance matrix estimates from the 1000 replications. The smaller the differences are, the less biased the estimator is. The bias is calculated as an element-wise difference between the real covariance matrix and the estimated covariance matrix, 
                           
                              Σ
                           
                           −
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 ˆ
                              
                           
                        , and the results are presented separately for the variance and covariance elements of the covariance matrices.

@&#RESULTS@&#

Simulation results are presented in Figs. 1 and 2
                        
                        . The presented boxplots give a visual clue on how close the estimates are to the true covariance matrix as well as on the variation of the estimate between the 1000 simulation rounds. Results for 
                           
                              S
                           
                           
                              (
                              0
                              )
                           
                         are not shown in the figures as they are extremely biased. The mean difference between the variance elements of the true covariance matrix and 
                           
                              S
                           
                           
                              (
                              0
                              )
                           
                         is −17.24 and −0.57 between the covariance elements. For variance elements, the differences vary from −34.54 to −3.38 and for covariance elements from −16.41 to 9.16. This demonstrates that the estimate is sensitive to the subjective choices of the simple imputed value.

In this setting, the ML estimator with a known LLOD, 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    MLE
                                 
                              
                           
                           
                              (
                              c
                              )
                           
                        , performs well and produces unbiased estimates with reasonable variation. However, what it wins in being unbiased, it loses in computing time (Section  3). As expected, 
                           
                              S
                           
                           
                              (
                              c
                              /
                              2
                              )
                           
                         performs on average as well as the ML estimator. In the case of 30% of censored values, 
                           
                              S
                           
                           
                              (
                              c
                              /
                              2
                              )
                           
                         has even lower variation than the ML estimate. However, we argue that the variation of the estimator naturally decreases when left-censored values are replaced by a single value and this is emphasized with heavy censoring. Additionally, 
                           
                              S
                           
                           
                              (
                              c
                              /
                              2
                              )
                           
                         tends to overestimate the variance when there are 10% left-censored values and underestimate both variance and covariance with 30% left-censored values. This is natural, as in the first case approximately 10% of the values are substituted with a small concentration value from the far left tail of the distribution and in the latter case, the substituted value is already closer to the expected value of the distribution. The ML estimator with estimated LLODs, 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    MLE
                                 
                              
                           
                           
                              (
                              
                                 
                                    c
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                        , underestimates the covariances. The estimated LLODs are higher than the true LLOD and thus the integration limits used in the likelihood function are overly wide. Similarly, the sample covariances from the completely observed data, 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    C
                                 
                              
                           
                        , tends to underestimate the covariances. This is expected as in the most extreme case, even 30% of the lowest concentration values are censored. In the higher dimension, the biases vary on a wider range with both proportions of the left-censored values, but a similar ranking of the estimators is seen as in 
                           p
                           =
                           3
                        .

For the pairwise estimate of the covariance matrix, the average covariance matrix estimate from 1000 replications is 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          Pair
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             0.993
                                          
                                          
                                             0.500
                                          
                                          
                                             −
                                             0.493
                                          
                                       
                                       
                                          
                                             0.500
                                          
                                          
                                             0.999
                                          
                                          
                                             0.002
                                          
                                       
                                       
                                          
                                             −
                                             0.493
                                          
                                          
                                             0.002
                                          
                                          
                                             0.995
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         The average estimate is very close to the true covariance matrix and the elements of the estimated matrix vary both above and below the true values of the corresponding elements.

As seen in Figs. 1 and 2, the variances and covariances of the pairwise estimator have some outliers (overestimation), but the medians of the differences are approximately zero. The pairwise estimator is thus a good approximation for the genuine ML estimator.

In this section, we present one real data analysis example assessing the agreement between the ML and pairwise covariance matrix estimators and compare them with the two substitution methods.

The example data set from Helsel (2011) contains concentrations of the DDT (dichlorodiphenyltrichloroethane) and related toxic chemical compounds: DDD and DDE, which are found in fish. The data set is provided in a text file in the supplementary materials (see Appendix A). In the United States, the use of DDT as an agricultural insecticide has been banned since the 1970s, but it can still be found in the environment. The data are measurements (micrograms per liter 
                        
                           μ
                        
                        
                           g
                        
                        /
                        
                           L
                        
                     ) of six toxic compounds (
                        
                           p
                        
                        ,
                        
                           
                              
                                 p
                              
                           
                           
                              ′
                           
                        
                     - and 
                        
                           o
                        
                        ,
                        
                           
                              
                                 p
                              
                           
                           
                              ′
                           
                        
                     -isomers of DDD, DDE, and DDT) in fish at 32 different sites. Also, the age of each fish is recorded, having a binary outcome “young/ mature”. As in many areas of life sciences, a substantial number of compound concentrations are left-censored. The LLOD is 
                        5
                        
                        
                           μ
                        
                        
                           g
                        
                        /
                        
                           L
                        
                      for each of the six compounds. Left-censoring is heavy especially in the 
                        
                           o
                        
                        ,
                        
                           
                              
                                 p
                              
                           
                           
                              ′
                           
                        
                     -isomers. A visualization of the left-censoring pattern can be seen in Fig. 3
                     , and the distributions of the log-transformed compound concentrations together with the proportions of the left-censored values in each chemical compound are given in Fig. 4
                      using “boxplots at sunrise” as suggested by Helsel (2011).

Of interest might be the classification of the fish (sites) according to similar patterns of toxic chemical concentrations or exploring covariance structure between different chemicals. Also, one might be interested in the differences between the young and mature fish. In order to conduct an analysis providing insight into which compounds appear similar to and different from each other, the first step is to estimate the covariance structure of the data. The low dimension (
                        p
                        =
                        6
                     ) allows us to use the ML covariance estimator for left-censored data without excessive computational load. The ML estimate of the covariance matrix using the known LLOD of 
                        5
                        
                        
                           μ
                        
                        
                           g
                        
                        /
                        
                           L
                        
                      is: 
                        
                           
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       MLE
                                    
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          0.41
                                       
                                       
                                          0.56
                                       
                                       
                                          0.66
                                       
                                       
                                          0.41
                                       
                                       
                                          −
                                          0.21
                                       
                                       
                                          0.39
                                       
                                    
                                    
                                       
                                          0.56
                                       
                                       
                                          0.87
                                       
                                       
                                          0.94
                                       
                                       
                                          0.66
                                       
                                       
                                          −
                                          0.29
                                       
                                       
                                          0.62
                                       
                                    
                                    
                                       
                                          0.66
                                       
                                       
                                          0.94
                                       
                                       
                                          4.85
                                       
                                       
                                          0.12
                                       
                                       
                                          −
                                          0.70
                                       
                                       
                                          0.21
                                       
                                    
                                    
                                       
                                          0.41
                                       
                                       
                                          0.66
                                       
                                       
                                          0.12
                                       
                                       
                                          0.98
                                       
                                       
                                          0.60
                                       
                                       
                                          0.70
                                       
                                    
                                    
                                       
                                          −
                                          0.21
                                       
                                       
                                          −
                                          0.29
                                       
                                       
                                          −
                                          0.70
                                       
                                       
                                          0.60
                                       
                                       
                                          1.71
                                       
                                       
                                          0.01
                                       
                                    
                                    
                                       
                                          0.39
                                       
                                       
                                          0.62
                                       
                                       
                                          0.21
                                       
                                       
                                          0.70
                                       
                                       
                                          0.01
                                       
                                       
                                          0.97
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

For comparison, we can compute the alternative pairwise covariance matrix estimate 
                        
                           
                              
                                 S
                              
                           
                           
                              
                                 Pair
                              
                           
                        
                     , as well as the estimates based on substitution, i.e., 
                        
                           S
                        
                        
                           (
                           c
                           /
                           2
                           )
                        
                      and 
                        
                           S
                        
                        
                           (
                           0
                           )
                        
                     . We can then explore how well these options perform compared to the optimal ML estimator.

First, the raw pairwise estimate (without adjustment to achieve positive semi-definiteness) is 
                        
                           
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       Pair
                                    
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          0.26
                                       
                                       
                                          0.54
                                       
                                       
                                          0.44
                                       
                                       
                                          0.31
                                       
                                       
                                          −
                                          0.63
                                       
                                       
                                          0.16
                                       
                                    
                                    
                                       
                                          0.54
                                       
                                       
                                          0.90
                                       
                                       
                                          1.43
                                       
                                       
                                          0.69
                                       
                                       
                                          −
                                          0.29
                                       
                                       
                                          0.69
                                       
                                    
                                    
                                       
                                          0.44
                                       
                                       
                                          1.43
                                       
                                       
                                          4.99
                                       
                                       
                                          −
                                          0.12
                                       
                                       
                                          −
                                          2.93
                                       
                                       
                                          0.01
                                       
                                    
                                    
                                       
                                          0.31
                                       
                                       
                                          0.69
                                       
                                       
                                          −
                                          0.12
                                       
                                       
                                          1.04
                                       
                                       
                                          1.07
                                       
                                       
                                          0.72
                                       
                                    
                                    
                                       
                                          −
                                          0.63
                                       
                                       
                                          −
                                          0.29
                                       
                                       
                                          −
                                          2.93
                                       
                                       
                                          1.07
                                       
                                       
                                          2.52
                                       
                                       
                                          −
                                          0.13
                                       
                                    
                                    
                                       
                                          0.16
                                       
                                       
                                          0.69
                                       
                                       
                                          0.01
                                       
                                       
                                          0.72
                                       
                                       
                                          −
                                          0.13
                                       
                                       
                                          0.97
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

Compared to the ML estimate, the largest deviation in the raw pairwise estimate is naturally in the elements relating to the compounds with largest proportions of left-censored values. In order to achieve the positive semi-definiteness, the pairwise estimate is adjusted as described in Section  3.2 giving 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       Pair
                                    
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          0.42
                                       
                                       
                                          0.43
                                       
                                       
                                          0.53
                                       
                                       
                                          0.19
                                       
                                       
                                          −
                                          0.48
                                       
                                       
                                          0.26
                                       
                                    
                                    
                                       
                                          0.43
                                       
                                       
                                          1.00
                                       
                                       
                                          1.37
                                       
                                       
                                          0.75
                                       
                                       
                                          −
                                          0.39
                                       
                                       
                                          0.62
                                       
                                    
                                    
                                       
                                          0.53
                                       
                                       
                                          1.37
                                       
                                       
                                          5.05
                                       
                                       
                                          −
                                          0.19
                                       
                                       
                                          −
                                          2.84
                                       
                                       
                                          0.07
                                       
                                    
                                    
                                       
                                          0.19
                                       
                                       
                                          0.75
                                       
                                       
                                          −
                                          0.19
                                       
                                       
                                          1.17
                                       
                                       
                                          0.94
                                       
                                       
                                          0.64
                                       
                                    
                                    
                                       
                                          −
                                          0.48
                                       
                                       
                                          −
                                          0.39
                                       
                                       
                                          −
                                          2.84
                                       
                                       
                                          0.94
                                       
                                       
                                          2.68
                                       
                                       
                                          −
                                          0.03
                                       
                                    
                                    
                                       
                                          0.26
                                       
                                       
                                          0.62
                                       
                                       
                                          0.07
                                       
                                       
                                          0.64
                                       
                                       
                                          −
                                          0.03
                                       
                                       
                                          1.03
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                      Thus, the difference of the ML estimate and the adjusted pairwise estimate is 
                        
                           
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       MLE
                                    
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       Pair
                                    
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          −
                                          0.01
                                       
                                       
                                          0.13
                                       
                                       
                                          0.12
                                       
                                       
                                          0.22
                                       
                                       
                                          0.27
                                       
                                       
                                          0.13
                                       
                                    
                                    
                                       
                                          0.13
                                       
                                       
                                          −
                                          0.13
                                       
                                       
                                          −
                                          0.43
                                       
                                       
                                          −
                                          0.09
                                       
                                       
                                          0.09
                                       
                                       
                                          0.00
                                       
                                    
                                    
                                       
                                          0.12
                                       
                                       
                                          −
                                          0.43
                                       
                                       
                                          −
                                          0.20
                                       
                                       
                                          0.31
                                       
                                       
                                          2.13
                                       
                                       
                                          0.14
                                       
                                    
                                    
                                       
                                          0.22
                                       
                                       
                                          −
                                          0.09
                                       
                                       
                                          0.31
                                       
                                       
                                          −
                                          0.18
                                       
                                       
                                          −
                                          0.34
                                       
                                       
                                          0.06
                                       
                                    
                                    
                                       
                                          0.27
                                       
                                       
                                          0.09
                                       
                                       
                                          2.13
                                       
                                       
                                          −
                                          0.34
                                       
                                       
                                          −
                                          0.97
                                       
                                       
                                          0.04
                                       
                                    
                                    
                                       
                                          0.13
                                       
                                       
                                          0.00
                                       
                                       
                                          0.14
                                       
                                       
                                          0.06
                                       
                                       
                                          0.04
                                       
                                       
                                          −
                                          0.06
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

For comparison, the difference between the estimate based on the substitution 
                        
                           
                              
                                 S
                              
                              
                                 (
                                 c
                                 /
                                 2
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          0.19
                                       
                                       
                                          0.27
                                       
                                       
                                          0.12
                                       
                                       
                                          0.19
                                       
                                       
                                          −
                                          0.02
                                       
                                       
                                          0.10
                                       
                                    
                                    
                                       
                                          0.27
                                       
                                       
                                          1.02
                                       
                                       
                                          0.25
                                       
                                       
                                          0.75
                                       
                                       
                                          −
                                          0.04
                                       
                                       
                                          0.61
                                       
                                    
                                    
                                       
                                          0.12
                                       
                                       
                                          0.25
                                       
                                       
                                          0.77
                                       
                                       
                                          −
                                          0.02
                                       
                                       
                                          −
                                          0.03
                                       
                                       
                                          0.04
                                       
                                    
                                    
                                       
                                          0.19
                                       
                                       
                                          0.75
                                       
                                       
                                          −
                                          0.02
                                       
                                       
                                          1.13
                                       
                                       
                                          0.07
                                       
                                       
                                          0.66
                                       
                                    
                                    
                                       
                                          −
                                          0.02
                                       
                                       
                                          −
                                          0.04
                                       
                                       
                                          −
                                          0.03
                                       
                                       
                                          0.07
                                       
                                       
                                          0.14
                                       
                                       
                                          −
                                          0.04
                                       
                                    
                                    
                                       
                                          0.10
                                       
                                       
                                          0.61
                                       
                                       
                                          0.04
                                       
                                       
                                          0.66
                                       
                                       
                                          −
                                          0.04
                                       
                                       
                                          0.93
                                       
                                    
                                 
                                 )
                              
                           
                        
                      and the ML estimate is 
                        
                           
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       MLE
                                    
                                 
                              
                              −
                              
                                 S
                              
                              
                                 (
                                 c
                                 /
                                 2
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          0.22
                                       
                                       
                                          0.29
                                       
                                       
                                          0.54
                                       
                                       
                                          0.22
                                       
                                       
                                          −
                                          0.19
                                       
                                       
                                          0.28
                                       
                                    
                                    
                                       
                                          0.29
                                       
                                       
                                          −
                                          0.16
                                       
                                       
                                          0.68
                                       
                                       
                                          −
                                          0.09
                                       
                                       
                                          −
                                          0.25
                                       
                                       
                                          0.01
                                       
                                    
                                    
                                       
                                          0.54
                                       
                                       
                                          0.68
                                       
                                       
                                          4.07
                                       
                                       
                                          0.14
                                       
                                       
                                          −
                                          0.68
                                       
                                       
                                          0.18
                                       
                                    
                                    
                                       
                                          0.22
                                       
                                       
                                          −
                                          0.09
                                       
                                       
                                          0.14
                                       
                                       
                                          −
                                          0.15
                                       
                                       
                                          0.53
                                       
                                       
                                          0.04
                                       
                                    
                                    
                                       
                                          −
                                          0.19
                                       
                                       
                                          −
                                          0.25
                                       
                                       
                                          −
                                          0.68
                                       
                                       
                                          0.53
                                       
                                       
                                          1.58
                                       
                                       
                                          0.06
                                       
                                    
                                    
                                       
                                          0.28
                                       
                                       
                                          0.01
                                       
                                       
                                          0.18
                                       
                                       
                                          0.04
                                       
                                       
                                          0.06
                                       
                                       
                                          0.04
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

Furthermore, the difference between the second estimate based on the substitution 
                        
                           
                              
                                 S
                              
                              
                                 (
                                 0
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          0.79
                                       
                                       
                                          0.63
                                       
                                       
                                          0.38
                                       
                                       
                                          0.42
                                       
                                       
                                          −
                                          0.08
                                       
                                       
                                          0.35
                                       
                                    
                                    
                                       
                                          0.63
                                       
                                       
                                          1.78
                                       
                                       
                                          0.51
                                       
                                       
                                          1.06
                                       
                                       
                                          −
                                          0.02
                                       
                                       
                                          1.22
                                       
                                    
                                    
                                       
                                          0.38
                                       
                                       
                                          0.51
                                       
                                       
                                          1.45
                                       
                                       
                                          −
                                          0.03
                                       
                                       
                                          −
                                          0.08
                                       
                                       
                                          0.07
                                       
                                    
                                    
                                       
                                          0.42
                                       
                                       
                                          1.06
                                       
                                       
                                          −
                                          0.03
                                       
                                       
                                          1.30
                                       
                                       
                                          0.14
                                       
                                       
                                          0.93
                                       
                                    
                                    
                                       
                                          −
                                          0.08
                                       
                                       
                                          −
                                          0.02
                                       
                                       
                                          −
                                          0.08
                                       
                                       
                                          0.14
                                       
                                       
                                          0.36
                                       
                                       
                                          −
                                          0.08
                                       
                                    
                                    
                                       
                                          0.35
                                       
                                       
                                          1.22
                                       
                                       
                                          0.07
                                       
                                       
                                          0.93
                                       
                                       
                                          −
                                          0.08
                                       
                                       
                                          1.93
                                       
                                    
                                 
                                 )
                              
                           
                        
                      and the ML estimate is 
                        
                           
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       MLE
                                    
                                 
                              
                              −
                              
                                 S
                              
                              
                                 (
                                 0
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          −
                                          0.38
                                       
                                       
                                          −
                                          0.07
                                       
                                       
                                          0.28
                                       
                                       
                                          −
                                          0.01
                                       
                                       
                                          −
                                          0.13
                                       
                                       
                                          0.04
                                       
                                    
                                    
                                       
                                          −
                                          0.07
                                       
                                       
                                          −
                                          0.92
                                       
                                       
                                          0.43
                                       
                                       
                                          −
                                          0.40
                                       
                                       
                                          −
                                          0.27
                                       
                                       
                                          −
                                          0.60
                                       
                                    
                                    
                                       
                                          0.28
                                       
                                       
                                          0.43
                                       
                                       
                                          3.40
                                       
                                       
                                          0.14
                                       
                                       
                                          −
                                          0.63
                                       
                                       
                                          0.15
                                       
                                    
                                    
                                       
                                          −
                                          0.01
                                       
                                       
                                          −
                                          0.40
                                       
                                       
                                          0.14
                                       
                                       
                                          −
                                          0.32
                                       
                                       
                                          0.46
                                       
                                       
                                          −
                                          0.23
                                       
                                    
                                    
                                       
                                          −
                                          0.13
                                       
                                       
                                          −
                                          0.27
                                       
                                       
                                          −
                                          0.63
                                       
                                       
                                          0.46
                                       
                                       
                                          1.35
                                       
                                       
                                          0.09
                                       
                                    
                                    
                                       
                                          0.04
                                       
                                       
                                          −
                                          0.60
                                       
                                       
                                          0.15
                                       
                                       
                                          −
                                          0.23
                                       
                                       
                                          0.09
                                       
                                       
                                          −
                                          0.96
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

The mean absolute differences of the variance elements are 0.26 for 
                        
                           
                              
                                 S
                              
                           
                           
                              
                                 MLE
                              
                           
                        
                        −
                        
                           
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              
                                 Pair
                              
                           
                        
                     , 1.04 for 
                        
                           
                              
                                 S
                              
                           
                           
                              
                                 MLE
                              
                           
                        
                        −
                        
                           S
                        
                        
                           (
                           c
                           /
                           2
                           )
                        
                      and 1.22 for 
                        
                           
                              
                                 S
                              
                           
                           
                              
                                 MLE
                              
                           
                        
                        −
                        
                           S
                        
                        
                           (
                           0
                           )
                        
                     . The mean absolute differences of the covariance elements for the three estimates are 0.30, 0.28 and 0.26, respectively.

In this data, half of the compounds include at least 75% of left-censored values, see Fig. 4. Substituting all left-censored values with zeros or 
                        
                           LLOD
                        
                        /
                        2
                      is quick and easy but still a biased solution. Modeling the unobservable part of the compounds distribution with a single point mass by replacing the unobserved observations with a single subjective value will almost surely distort the true distribution.

Next, we investigate the quality of the estimated ML mean vector and covariance matrix graphically. In the scatter plot of the pairs of the compounds, see Fig. 5
                     , we visualize the covariance structure by drawing the 25%, 50% and 75%, tolerance ellipses based on the ML estimate 
                        
                           
                              
                                 S
                              
                           
                           
                              
                                 MLE
                              
                           
                        
                     . For comparison, we draw the tolerance ellipses based on the sample covariance matrix 
                        
                           S
                        
                        
                           (
                           0
                           )
                        
                      computed from a zero substituted data. As seen in Fig. 5, especially in the presence of left-censored values, the mean and covariance estimates from the zero substituted data fail to capture the information included in the left-censored values.

In conclusion, we conducted a principal component analysis (PCA) providing insight into which compounds appear similar to and different from each other. Helsel (2011) examines the patterns of different sites (fishes) and compounds via biplots. With biplots, one can plot the projections of original variables and observations onto the first two principal components, which represent the two largest directions of variation, as defined by PCA. Helsel demonstrates two alternative robust approaches to conduct PCA in the presence of the left-censored data. First, he dichotomizes the data according to presence at 
                        5
                        
                        
                           μ
                        
                        
                           g
                        
                        /
                        
                           L
                        
                      (0 if left-censored, 1 if observed). Then PCA employs the Pearson’s correlation matrix computed on these complete data. The second approach is based on the marginal (compound-wise) ranked data. The left-censored values are known to be the lowest concentrations so they get the average of the lowest ranks indicated to them. In this case, PCA employs the Spearman’s rank correlation matrix. Both approaches are free of any distribution assumptions, but on the downside, they lose the original scale of the compound concentrations. It is also noteworthy that the covariance matrix based on the marginal ranks is not affine equivariant. Improved concepts of multivariate ranks lead to better properties of the estimator (Croux et al., 2002; Locantore et al., 1999; Marden, 1999; Visuri et al., 2000).

We conducted PCA on four different covariance matrices: (1) ML covariance matrix estimate 
                        
                           
                              
                                 S
                              
                           
                           
                              
                                 MLE
                              
                           
                        
                     , (2) adjusted pairwise covariance matrix estimate 
                        
                           
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              
                                 Pair
                              
                           
                        
                     , (3) sample covariance matrix 
                        
                           S
                        
                        
                           (
                           0
                           )
                        
                      computed from the zero substituted data, and in footsteps of Helsel, (4) Spearman’s covariance matrix computed on the ranked data, 
                        
                           
                              
                                 S
                              
                           
                           
                              
                                 RANK
                              
                           
                        
                     . In each setting, the projections of the six chemical compounds onto the first two principal components are plotted, see Fig. 6
                     . The projections (or loadings on the components) are standardized such that the first loading vector relating to compound opDDD points to the top left quadrant.

As expected, the loading vectors are similar for 
                        
                           
                              
                                 S
                              
                           
                           
                              
                                 MLE
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              
                                 Pair
                              
                           
                        
                     . In these cases, the 
                        
                           p
                        
                        ,
                        
                           
                              
                                 p
                              
                           
                           
                              ′
                           
                        
                     -isomers are loaded on the second principal component, while the variability of the 
                        
                           o
                        
                        ,
                        
                           
                              
                                 p
                              
                           
                           
                              ′
                           
                        
                     -isomers are more described by the first component. As shown in Fig. 4, the 
                        
                           o
                        
                        ,
                        
                           
                              
                                 p
                              
                           
                           
                              ′
                           
                        
                     -isomers are dominated by the left-censored values.

In Fig. 6, it can be seen that the rank approach loses the original scale of the compounds as the loading vectors are approximately of equal length. The order of the loading vectors read clockwise for 
                        
                           S
                        
                        
                           (
                           0
                           )
                        
                      and 
                        
                           
                              
                                 S
                              
                           
                           
                              
                                 RANK
                              
                           
                        
                      is the same, but opposite to 
                        
                           
                              
                                 S
                              
                           
                           
                              
                                 MLE
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              
                                 Pair
                              
                           
                        
                     . For 
                        
                           S
                        
                        
                           (
                           0
                           )
                        
                      and 
                        
                           
                              
                                 S
                              
                           
                           
                              
                                 RANK
                              
                           
                        
                     , the first component describes the variability of the 
                        
                           p
                        
                        ,
                        
                           
                              
                                 p
                              
                           
                           
                              ′
                           
                        
                     -isomers and the second component is dominated by the 
                        
                           o
                        
                        ,
                        
                           
                              
                                 p
                              
                           
                           
                              ′
                           
                        
                     -isomers. The results for 
                        
                           S
                        
                        
                           (
                           c
                           /
                           2
                           )
                        
                      (not shown here) are very similar to those of 
                        
                           S
                        
                        
                           (
                           0
                           )
                        
                     .

@&#DISCUSSION@&#

We have presented a ML-based covariance matrix estimator that also allows the presence of the left-censored values without substituting them with some constant or ignoring them completely. The presented estimator efficiently uses all the information available and thus, based on our simulation studies, produces accurate estimates. As the ML estimate can be solved fast only in lower dimensions, we proposed to estimate the covariance matrix element-wise and then adjust the resulting covariance matrix to achieve positive semi-definiteness. This approach succeeded in decreasing the computation times substantially and still produced accurate estimates. An R (R Core Team, 2014) function was written to solve the estimation problem of the ML covariance matrix estimate with known or estimated LLODs. Also, functions for the pairwise ML estimate and parallel pairwise estimate were written. All codes are available on request from the corresponding author.

In this work, we used the multivariate normal distribution to model the data we see above the LLOD and also rely on the assumption that the chosen distribution appropriately characterizes the unobserved censored data. This assumption enables the use of ML estimators whose asymptotic properties are well-known. However, incorrect assumptions can generate inference that is not valid. The simulations were restricted to a few fixed covariance matrices with equal variances. In the future, further simulation studies are needed.

The estimation of an unconstrained covariance matrix requires the estimation of 
                        p
                        
                           (
                           p
                           +
                           1
                           )
                        
                        /
                        2
                      parameters. Constrained covariance structures, such as compound symmetry with homogeneous variances and single parameter covariance, hold the potential to speed up the estimation. However, a suitable structure depends strongly on the context. For example, it is seldom safe to assume that all pairwise covariances would be the same or the variances homogeneous. In some applications, for example in lipidomics, it might be possible to assume similar covariances between lipids belonging to same lipid classes. This would lead into a block structure in the covariance matrix. Nevertheless, in high dimensions, the number of parameters would still be large.

Another statistically efficient and computationally fast alternative could be to regularize the sample covariance matrix or its inverse by making it sparse by setting some of the covariance elements to zero. This shrinkage estimation of the covariance matrix is closely related to lasso and ridge regressions (Tibshirani, 1996; Hoerl and Kennard, 1970). The shrinkage approach is proposed mainly for inferring large-scale covariance matrices in high-dimensions, such as clustering genes using data from a microarray experiment or building association networks (Schäfer and Strimmer, 2005; Huang et al., 2006; Friedman et al., 2008; Witten et al., 2009). Combining shrinkage with ML estimation could provide an efficient estimator of the covariance matrix also in the presence of left-censored data. One could add a penalty term to the likelihood function and force some of the covariance elements to zero or close to zero producing interpretable estimates.

@&#ACKNOWLEDGMENTS@&#

The first author acknowledges funding by the Academy of Finland, Finnish Doctoral Program in Stochastics and Statistics and by University of Turku Graduate School. Aura Professional English Consulting, Ltd. (www.auraenglish.com) performed the linguistic editing of this manuscript.

Supplementary material related to this article can be found online at http://dx.doi.org/10.1016/j.csda.2015.06.005.

The following is the Supplementary material related to this article. 
                        
                           MMC S1
                           
                              Data used in Section  5: DDT and related compounds in fish.
                           
                           
                        
                     
                  

@&#REFERENCES@&#

