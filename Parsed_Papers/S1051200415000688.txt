@&#MAIN-TITLE@&#Monotonic sequences for image enhancement and segmentation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We introduce a monotonic sequence based thresholding in image decomposition.


                        
                        
                           
                           We propose of sequence or weighted thresholding based image enhancement.


                        
                        
                           
                           We propose the Fibonacci thresholding in image enhancement.


                        
                        
                           
                           The presented thresholding-based enhancement out-performs competing algorithms.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Binary signals

Thresholding

Image enhancement

Fibonacci thresholding

Image segmentation

@&#ABSTRACT@&#


               
               
                  Both image enhancement and image segmentation are important pre-processing steps for various image processing fields including autonomous navigation, remote sensing, computer vision, and biomedical image analysis. Both methods have their merits and their short comings. It then becomes obvious to ask the question: is it possible to develop a new better image enhancement method which has the key elements from both segmentation and image enhancement techniques? The choice of the threshold level is a key task in image segmentation. There are other challenges of image segmentation. For example, it is very difficult to perform the image segmentation in poor data such as shadows and noise. Recently, a homothetic curves Fibonacci-based cross sections thresholding has been developed for the de-noising purposes. Is it possible to develop a new image cross sections thresholding method, which can be used for both segmentation and image enhancement purposes? This paper a) describes a unified approach for signal thresholding, b) extends cross sections concept by generating and using a new class of monotonic, piecewise linear, sequences (slowly or faster growing than Fibonacci numbers) of numbers; c) uses the extended sections concept to the image enhancement and segmentation applications. Extensive experimental evaluation demonstrates that the newly proposed monotonic sequences have great potential in image processing applications, including image segmentation and image enhancement applications. Moreover, study has shown that the generalized cross techniques are invariant under morphological transformations such as erosion, dilation, and median, able to be described analytically, can be implemented by using the look up table methods.
               
            

@&#INTRODUCTION@&#

Image enhancement and image segmentation are two fundamental procedures in various image processing and computer vision applications, including autonomous navigation, remote sensing, multimedia analytics, biomedical image analysis, and astronomical images. There are extensive literature on both image enhancement and image segmentation procedures [2–9,11–17,22–41,48–70]. The key goal of image segmentation is to split an image into its constituent components and extract important information, for example statistical, edge, contour and texture information, from an input image [1,2]. Depending on the application, the goal of segmentation can be different. In general, the segmentation is not unique and it is an ill-defined problem which makes the segmentation evaluation of a candidate algorithm difficult. “There is no unique ground-truth segmentation of an image against which the output of an algorithm may be compared” [71]. The common segmentation approaches are based on thresholding techniques because of its simplicity, robustness, and accuracy. We can broadly categorize thresholding techniques as global thresholding, semi-thresholding, multilevel thresholding, variable thresholding, and 
                        (
                        n
                        ,
                        k
                        ,
                        p
                        )
                     -Gray code thresholding, cross sections (threshold sets) thresholding, various histogram thresholding, supervised and unsupervised thresholding [2–9,11–17,59–70].

The cross sections based thresholding are commonly used in many computer vision and imaging processing applications, including nonlinear filtering and mathematical morphology [8,10–20,61]. In addition, the cross sections thresholding allows for transferring the basic operations of set algebra, such as Minkowski's addition and subtraction of sets, and the dilation and erosion of sets, on the function algebra. The cross-sections are typically horizontal lines. Recently, a more general concept of homothetic curves 
                        
                           
                              g
                           
                           
                              a
                           
                        
                     -based cross sections has been developed to generalize the traditional horizontal cross sections and define different set representations of signals and images [21] and [72]. Both these works use so called Fibonacci thresholding (based on Fibonacci numbers) levels for the denoising (median type and morphological filters) proposes. Unfortunately, many thresholding algorithms, in spite of their fame, are not able to automatically determine the required minimum number of thresholds, for a given application. Moreover, it is natural to ask: how to use the cross sections thresholding concept in the two-dimensional case; can we generate a new class of cross sections which are based is new class (slowly or faster growing than Fibonacci numbers) sequence of number; can we tailor them to the segmentation problem, or to the image enhancement application.

Image enhancement techniques focus on improvement of the characteristic or quality of an image, and make the resulting image look “better” than the original, when compared against specific criteria [26]. Many algorithms have been proposed for image enhancement [30–50], and a comprehensive review of image enhancement techniques is presented in [29,40,41]. The following two major classifications of image enhancement techniques can be defined: the spatial domain enhancement and transform domain enhancement [25–45]. Both methods have their merits and short comings given differing interpretations of image data [42]. In addition, the analysis of the transform-based techniques shows that there exist common problems. Selecting parameters for the enhancement techniques is difficult, resulting in the inability of the methods to simultaneously enhance all parts of a proceeded image; introducing artifacts called blocking effects [48–50]. The enhancement task, however, is complicated by the lack of any general unifying theory of image enhancement, and the lack of an effective quantitative standard of image quality to act as a design criterion for an image enhancement system [26,39–42,48–52]. Furthermore, many enhancement algorithms have external parameters which are sometimes difficult to fine-tune [22,42–52]. Most of these techniques are globally dependent on the type of the input images, and treat images instead of adapting to local features within different regions [23,41].

It then becomes obvious to ask the question: Is it possible to develop a new image enhancement method, which has the key elements from both segmentation and image enhancement techniques which produce better image enhancement algorithms? This paper investigates a new general concept of weighted thresholding/representation based image enhancement. The rest of this paper is organized as follows. Section 2 introduces the concept of the monotonic sequence-based thresholding, or weighted thresholding, in signal decomposition and describes properties and different examples of the thresholding on signals and images. Section 3 describes the application of the weighted thresholding in image enhancement, which includes the histogram equalization and enhancement by the powers of the distribution function. The quantitative measure of image enhancement is calculated for the processed images. Section 4 is devoted to the weighted thresholding by piecewise linear sequences including a slowly growing stepped sequence of numbers. The thresholding by the sequence of Fibonacci numbers is also considered. Section 5 describes composition and vector median filtration of signals by Fibonacci-values signals. In Section 6, the segmentation by the morphological operations with weighted thresholding is presented. A comparison and analysis are also provided to show the new algorithm's performance. Section 7 draws a conclusion.

In this section, we present the concept of the weighted thresholding which generalizes the traditional signal decomposition by threshold sets. In such a thresholding, the binary signals of different levels are weighted by a given sequence of numbers. Properties of the weighted thresholding are described, and examples with different sequences and the corresponding signal decompositions are given.

Let 
                        f
                        (
                        x
                        )
                      be a multi-level non-negative function in the real space 
                        
                           
                              R
                           
                           
                              n
                           
                        
                     , 
                        n
                        ≥
                        1
                     , with integer values in the interval 
                        [
                        0
                        ,
                        L
                        ]
                     , 
                        L
                        >
                        1
                     . We consider a sequence of numbers as a function 
                        k
                        (
                        α
                        )
                      which is monotonically non-decreasing (or, non-increasing) in the set of integers 
                        α
                        =
                        1
                        ,
                        2
                        ,
                        3
                        ,
                        …
                      .


                     
                        Definition 1
                        Threshold 
                              k
                              (
                              α
                              )
                           -valued signals of the function 
                              f
                              (
                              x
                              )
                            at amplitude levels 
                              α
                              ∈
                              [
                              0
                              ,
                              L
                              ]
                            are calculated by
                              
                                 (1)
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          α
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                k
                                                (
                                                α
                                                )
                                                ,
                                             
                                             
                                                if 
                                                f
                                                (
                                                x
                                                )
                                                ≥
                                                α
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                otherwise
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                            The representation 
                              f
                              (
                              x
                              )
                              →
                              (
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                              ,
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              (
                              x
                              )
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    L
                                 
                              
                              (
                              x
                              )
                              )
                            is called the sequence based weighted thresholding of 
                              f
                              (
                              x
                              )
                           , or, simply the sequence thresholding.

1. If the sequence 
                           k
                           (
                           α
                           )
                         is monotonically decreasing, then
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 x
                                 )
                                 ≥
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       β
                                    
                                 
                                 (
                                 x
                                 )
                                 ,
                                 
                                  when 
                                 α
                                 <
                                 β
                                 .
                              
                           
                        
                     

2. The function 
                           f
                           (
                           x
                           )
                         can be reconstructed by its family of thresholded 
                           k
                           (
                           α
                           )
                        -valued signals as
                           
                              (3)
                              
                                 f
                                 (
                                 x
                                 )
                                 =
                                 sup
                                 ⁡
                                 {
                                 α
                                 ;
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 x
                                 )
                                 ≠
                                 0
                                 }
                                 =
                                 
                                    ∑
                                    
                                       α
                                       =
                                       1
                                    
                                    L
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             α
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                    
                                       k
                                       (
                                       α
                                       )
                                    
                                 
                                 ,
                                 
                                 x
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                 .
                              
                           
                        
                     

3. The following function can uniquely be assigned to the function 
                           f
                           (
                           x
                           )
                        :
                           
                              (4)
                              
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       α
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 x
                                 )
                                 ,
                                 
                                 x
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                 ,
                              
                           
                         where 
                           m
                           =
                           f
                           (
                           x
                           )
                           ≤
                           L
                        . We call this transformation the distribution operator.
                     

The distribution operator 
                           K
                           :
                           
                           f
                           (
                           x
                           )
                           →
                           
                              
                                 K
                              
                              
                                 f
                              
                           
                           (
                           x
                           )
                        , keeps all straight (smooth) parts in the graph of f, increasing its peaks. 
                           
                              
                                 K
                              
                              
                                 f
                              
                           
                           (
                           x
                           )
                           ≥
                           f
                           (
                           x
                           )
                         (if 
                           k
                           (
                           α
                           )
                           ≥
                           1
                        ), and the equality holds in the case when all values of 
                           k
                           (
                           α
                           )
                         equal 1.

4. When 
                           k
                           (
                           α
                           )
                           ≡
                           1
                        , the 1-valued signal 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 α
                              
                           
                           (
                           x
                           )
                         equals the binary signal 
                           
                              
                                 f
                              
                              
                                 α
                              
                           
                           (
                           x
                           )
                         at level α, which is defined as 
                           
                              
                                 f
                              
                              
                                 α
                              
                           
                           (
                           x
                           )
                           =
                           1
                         if 
                           f
                           (
                           x
                           )
                           ≥
                           α
                        , and 
                           
                              
                                 f
                              
                              
                                 α
                              
                           
                           (
                           x
                           )
                           =
                           0
                         otherwise. It is well known [17] that every u.s.c. function 
                           f
                           (
                           x
                           )
                         can be reconstructed uniquely by its horizontal cross sections, or the family of the binary signals 
                           {
                           
                              
                                 f
                              
                              
                                 α
                              
                           
                           (
                           x
                           )
                           ;
                           
                           α
                           ∈
                           (
                           −
                           ∞
                           ,
                           +
                           ∞
                           )
                           }
                        , due to the following threshold decomposition:
                           
                              (5)
                              
                                 f
                                 (
                                 x
                                 )
                                 =
                                 sup
                                 ⁡
                                 {
                                 α
                                 ;
                                 
                                 
                                    
                                       f
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 1
                                 }
                                 =
                                 
                                    ∑
                                    α
                                 
                                 
                                    
                                       f
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 x
                                 )
                                 .
                              
                           
                        
                     

5.  The mapping 
                           f
                           (
                           x
                           )
                           →
                           
                              
                                 K
                              
                              
                                 f
                              
                           
                           (
                           x
                           )
                         is invertible and the inversion has a simple form, even in the case when the mapping is complex. It means, that in many cases, one can replace complicated nonlinear operations by means of the simple summing (in Boolean logic) of the binary signals. This property follows directly from Eqs. (3) and (4).

6. If the signal 
                           f
                           (
                           x
                           )
                         has the equal binary signals, it can be reduced to the k-weighted thresholding. Such thresholding is called the base or canonical representation 
                        [43].


                        
                           Example 1
                           Let 
                                 f
                                 (
                                 x
                                 )
                               be the signal 
                                 {
                                 0
                                 ,
                                 1
                                 ,
                                 5
                                 ,
                                 3
                                 ,
                                 3
                                 ,
                                 8
                                 ,
                                 0
                                 }
                               with the maximal level 8. This function 
                                 f
                                 (
                                 x
                                 )
                               can be described by two forms, the direct representation and base representation, as follows:
                                 
                                    
                                       
                                          
                                             
                                                
                                                f
                                                (
                                                x
                                                )
                                                =
                                                
                                                   ∑
                                                   
                                                      α
                                                      =
                                                      1
                                                   
                                                   8
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      α
                                                   
                                                
                                                (
                                                x
                                                )
                                             
                                             
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   ∑
                                                   
                                                      α
                                                      =
                                                      1
                                                   
                                                   4
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      α
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                x
                                                )
                                             
                                          
                                          
                                             
                                                α
                                                =
                                                1
                                                ,
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                {
                                                0
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                             
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                {
                                                0
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                α
                                                =
                                                2
                                                ,
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                             
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                α
                                                =
                                                3
                                                ,
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                             
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                α
                                                =
                                                4
                                                ,
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      4
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                             
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      4
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                α
                                                =
                                                5
                                                ,
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      5
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                             
                                             
                                          
                                          
                                             
                                                α
                                                =
                                                6
                                                ,
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      6
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                             
                                             
                                          
                                          
                                             
                                                α
                                                =
                                                7
                                                ,
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      7
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                             
                                             
                                          
                                          
                                             
                                                α
                                                =
                                                8
                                                ,
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      8
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                             
                                             
                                          
                                       
                                    
                                 
                               The representation 
                                 f
                                 (
                                 x
                                 )
                                 →
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 {
                                 0
                                 ,
                                 1
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 ,
                                 4
                                 ,
                                 0
                                 }
                               is the base representation of 
                                 f
                                 (
                                 x
                                 )
                              . The signal 
                                 f
                                 (
                                 x
                                 )
                               is referred to as the four-level signal 
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                              . Fig. 1
                               shows the signal 
                                 f
                                 (
                                 x
                                 )
                               in part a and the base signal 
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                               in part b.

The signal 
                                 f
                                 (
                                 x
                                 )
                               can be reconstructed from its base form by
                                 
                                    
                                       f
                                       (
                                       x
                                       )
                                       =
                                       
                                          
                                             K
                                          
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       x
                                       )
                                       +
                                       2
                                       
                                          
                                             f
                                          
                                          
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       x
                                       )
                                       +
                                       2
                                       
                                          
                                             f
                                          
                                          
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       x
                                       )
                                       +
                                       3
                                       
                                          
                                             f
                                          
                                          
                                             4
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       x
                                       )
                                       .
                                    
                                 
                               In this case 
                                 L
                                 =
                                 4
                              , and 
                                 f
                                 (
                                 x
                                 )
                               equals the weighted thresholding of 
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                               when the sequence 
                                 {
                                 k
                                 (
                                 α
                                 )
                                 ;
                                 
                                 α
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 }
                               is 
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 2
                                 ,
                                 3
                                 }
                              . In the general case, we can define the base representation in the following way.


                        
                           Definition 2
                           If a such sequence of numbers 
                                 k
                                 (
                                 α
                                 )
                              , 
                                 a
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 m
                              , exists that 
                                 f
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 (
                                 x
                                 )
                               and 
                                 
                                    
                                       f
                                    
                                    
                                       ¯
                                    
                                 
                                 ≠
                                 f
                              , then the function
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          ∑
                                          
                                             α
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             α
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                 
                               is called the base representation of 
                                 f
                                 (
                                 x
                                 )
                              .

7.  There is a relationship between signals, polynomials, and thresholding. In other words, the weighted thresholding allows for calculating different polynomials of the signals,
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 f
                                 (
                                 x
                                 )
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    m
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 )
                                 ,
                                 
                                 x
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         are constants, and 
                           m
                           ≥
                           0
                         is the order of the polynomial. The calculation is accomplished by 
                           
                              
                                 P
                              
                              
                                 m
                              
                           
                           (
                           f
                           (
                           x
                           )
                           )
                           =
                           
                              
                                 K
                              
                              
                                 f
                              
                           
                           (
                           x
                           )
                        . Below are examples of such polynomials
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 f
                                 (
                                 x
                                 )
                                 )
                                 =
                                 f
                                 (
                                 x
                                 )
                                 ,
                                 
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 f
                                 (
                                 x
                                 )
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 )
                                 ,
                                 
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 f
                                 (
                                 x
                                 )
                                 )
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 )
                                 +
                                 
                                    
                                       j
                                       −
                                       1
                                    
                                    2
                                 
                                 f
                                 (
                                 x
                                 )
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                 
                                    
                                       P
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 f
                                 (
                                 x
                                 )
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       m
                                    
                                 
                                 (
                                 x
                                 )
                                 ,
                                 
                                 
                                 m
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 …
                                 
                                 ,
                                 
                                 
                                    
                                       P
                                    
                                    
                                       5
                                    
                                 
                                 (
                                 f
                                 (
                                 x
                                 )
                                 )
                                 =
                                 C
                                 
                                    1
                                    
                                       1
                                       −
                                       q
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       q
                                    
                                    
                                       f
                                       (
                                       x
                                       )
                                    
                                 
                                 )
                                 ,
                                 
                                 0
                                 <
                                 q
                                 <
                                 1
                                 ,
                                 
                                 C
                                 >
                                 1
                                 .
                              
                           
                        
                     

8. If 
                           f
                           (
                           x
                           )
                         is a random signal with the density function 
                           p
                           (
                           α
                           )
                         and distribution 
                           F
                           (
                           α
                           )
                        , then 
                           F
                           (
                           α
                           )
                         can be calculated as the weighted thresholding by the sequence 
                           k
                           (
                           α
                           )
                           =
                           p
                           (
                           a
                           )
                        . Here α denotes values of the signal 
                           f
                           (
                           x
                           )
                         which is considered non-negative.

The general method of application of the weighted thresholding for processing the signal (or image) 
                           f
                           (
                           x
                           )
                         through the function 
                           
                              
                                 K
                              
                              
                                 f
                              
                           
                           (
                           x
                           )
                         can be described by the following algorithm.


                        
                           
                              Algorithm 1
                              
                                 Generation of distribution 
                                       K
                                       (
                                       x
                                       )
                                    .
                              
                              
                           
                        
                     

Different monotonic sequences 
                           k
                           (
                           α
                           )
                         can be considered for the weighted thresholding and representation of signals. As examples, we mention the sequence 
                           k
                           (
                           α
                           )
                         being the series of Fibonacci numbers 
                           {
                           1
                           ,
                           1
                           ,
                           2
                           ,
                           3
                           ,
                           5
                           ,
                           8
                           ,
                           13
                           ,
                           21
                           ,
                           …
                           }
                         
                        [58], the arithmetic series of numbers 
                           {
                           1
                           ,
                           2
                           ,
                           3
                           ,
                           4
                           ,
                           5
                           ,
                           …
                           }
                         or 
                           {
                           …
                           ,
                           5
                           ,
                           4
                           ,
                           3
                           ,
                           2
                           ,
                           1
                           ,
                           }
                        , the geometric series of numbers 
                           {
                           1
                           ,
                           2
                           ,
                           4
                           ,
                           8
                        , …}. We now describe examples of weighted thresholding with these and other sequences.


                        
                           Example 2
                           Consider the 5-level function 
                                 f
                                 (
                                 x
                                 )
                                 =
                                 {
                                 0
                                 ,
                                 1
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 5
                                 ,
                                 2
                                 ,
                                 4
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 0
                                 }
                              . Let 
                                 k
                                 (
                                 α
                                 )
                               be the arithmetic series of integers, 
                                 k
                                 (
                                 α
                                 )
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ,
                                 5
                              . The following calculations hold:
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                1
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                
                                                1
                                                ,
                                                
                                                1
                                                ,
                                                
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                2
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                2
                                                ,
                                                2
                                                ,
                                                
                                                2
                                                ,
                                                
                                                2
                                                ,
                                                
                                                2
                                                ,
                                                0
                                                ,
                                                2
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                3
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                3
                                                ,
                                                
                                                3
                                                ,
                                                
                                                0
                                                ,
                                                
                                                3
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      4
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      4
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                4
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                
                                                4
                                                ,
                                                
                                                0
                                                ,
                                                
                                                4
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      5
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      5
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                5
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                
                                                5
                                                ,
                                                
                                                0
                                                ,
                                                
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      f
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                …
                                                +
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      5
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                2
                                                ,
                                                1
                                                ,
                                                3
                                                ,
                                                6
                                                ,
                                                15
                                                ,
                                                3
                                                ,
                                                10
                                                ,
                                                1
                                                ,
                                                3
                                                ,
                                                0
                                                }
                                                .
                                             
                                          
                                       
                                    
                                 
                               
                              Fig. 2
                               shows the signal 
                                 f
                                 (
                                 x
                                 )
                               in part a and the signal thresholding 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                               in part b.

One can see, that the function 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                               is the sum of the arithmetical series, 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 f
                                 (
                                 x
                                 )
                                 (
                                 f
                                 (
                                 x
                                 )
                                 +
                                 1
                                 )
                                 /
                                 2
                              . The function 
                                 f
                                 (
                                 x
                                 )
                               can be defined from 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                               by the nonlinear (quadratic) transform 
                                 f
                                 (
                                 x
                                 )
                                 =
                                 (
                                 −
                                 1
                                 +
                                 
                                    
                                       1
                                       +
                                       8
                                       
                                          
                                             K
                                          
                                          
                                             f
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                 
                                 
                                 )
                                 /
                                 2
                              . The value of 
                                 f
                                 (
                                 x
                                 )
                               is determined by 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                               as one that satisfies the condition 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 1
                                 +
                                 2
                                 +
                                 …
                                 +
                                 f
                                 (
                                 x
                                 )
                              . The square of the function can be calculated by 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 2
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                                 −
                                 f
                                 (
                                 x
                                 )
                              . It also can be calculating using other thresholding. To show this, we consider the following arithmetic series of integers, 
                                 k
                                 (
                                 α
                                 )
                                 =
                                 1
                                 ,
                                 3
                                 ,
                                 5
                                 ,
                                 7
                                 ,
                                 9
                                 ,
                                 …
                                 
                              , i.e., when 
                                 k
                                 (
                                 α
                                 )
                                 =
                                 2
                                 a
                                 −
                                 1
                              , 
                                 a
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 L
                              . We obtain that 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 )
                              , as shown in the following decomposition:
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                1
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                
                                                1
                                                ,
                                                
                                                1
                                                ,
                                                
                                                1
                                                ,
                                                
                                                1
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                3
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                3
                                                ,
                                                3
                                                ,
                                                
                                                3
                                                ,
                                                
                                                3
                                                ,
                                                
                                                3
                                                ,
                                                
                                                0
                                                ,
                                                3
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                5
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                5
                                                ,
                                                
                                                5
                                                ,
                                                
                                                0
                                                ,
                                                
                                                5
                                                ,
                                                
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      4
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      4
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                7
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                
                                                7
                                                ,
                                                
                                                0
                                                ,
                                                
                                                7
                                                ,
                                                
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      5
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      5
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                9
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                
                                                9
                                                ,
                                                
                                                0
                                                ,
                                                
                                                0
                                                ,
                                                
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      f
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                …
                                                +
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      5
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                4
                                                ,
                                                9
                                                ,
                                                25
                                                ,
                                                4
                                                ,
                                                16
                                                ,
                                                1
                                                ,
                                                4
                                                ,
                                                0
                                                }
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           


                        Fig. 3
                         shows the 101-level signal 
                           f
                           (
                           x
                           )
                         of length 256 in part a and the weighted thresholding 
                           
                              
                                 K
                              
                              
                                 f
                              
                           
                           (
                           x
                           )
                         for 
                           k
                           (
                           a
                           )
                           =
                           a
                         when 
                           a
                           =
                           0
                           :
                           101
                        , in part b. Transform of the same signal by another arithmetical thresholding with the function 
                           k
                           (
                           α
                           )
                           =
                           m
                           +
                           1
                           −
                           a
                         is shown in part c. Fig. 4
                         shows the first gray scale transformation (GST) 
                           f
                           (
                           x
                           )
                           →
                           
                              
                                 K
                              
                              
                                 f
                              
                           
                           (
                           x
                           )
                        , which is marked as GST-I. Another transformation marked as GST-II which is defined by the arithmetical thresholding with the function 
                           k
                           (
                           α
                           )
                           =
                           m
                           +
                           1
                           −
                           a
                         is also shown. For the GST-II, the following nonlinear transform of the signal holds:
                           
                              (6)
                              
                                 f
                                 (
                                 x
                                 )
                                 
                                 →
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 f
                                 (
                                 x
                                 )
                                 (
                                 m
                                 −
                                 
                                    
                                       f
                                       (
                                       x
                                       )
                                       −
                                       1
                                    
                                    2
                                 
                                 )
                                 .
                              
                           
                         The inverse operation is calculated as
                           
                              
                                 f
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       m
                                       +
                                       1
                                       ±
                                       
                                          
                                             
                                                
                                                   (
                                                   m
                                                   +
                                                   1
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             16
                                             
                                                
                                                   K
                                                
                                                
                                                   f
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                    2
                                 
                                 .
                              
                           
                         The complex quadratic expression of 
                           f
                           (
                           x
                           )
                         also can be inverted by the weighted thresholding as
                           
                              (7)
                              
                                 f
                                 (
                                 x
                                 )
                                 =
                                 l
                                 ,
                                 
                                 when 
                                 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 m
                                 +
                                 (
                                 m
                                 −
                                 1
                                 )
                                 +
                                 …
                                 +
                                 (
                                 m
                                 −
                                 l
                                 )
                                 ,
                              
                           
                         without any complex operations.

The difference of these two methods of arithmetical thresholding can be noticed visually when applying to images, as shown in Fig. 5
                         with “cameraman” image in a, and two thresholding in b and c. The gray-scale transformations of these two arithmetical series based weighted thresholding are similar to transformations given in Fig. 4, but in the range of 253 gray-levels of the image. Another example is shown in Fig. 6
                        . The original image of size 
                           1024
                           ×
                           1024
                         is in part a and the arithmetical thresholding of the image when 
                           k
                           (
                           α
                           )
                           =
                           α
                         in c and 
                           k
                           (
                           α
                           )
                           =
                           m
                           +
                           1
                           −
                           α
                         in d. The gray-scale transformations of these two arithmetical series based weighted thresholding are shown in b. For both images, in the weighted thresholding 
                           k
                           (
                           α
                           )
                           =
                           α
                         the high values of intensities of the images are compressed and the weighted thresholding 
                           k
                           (
                           α
                           )
                           =
                           m
                           +
                           1
                           −
                           α
                         expands dark pixel values, as in the log and power gray-scale transformations [23].

In this section we consider applications of the concept of the weighted thresholding in the two-dimensional case and describe different examples of the thresholding in image processing.

To measure the quality of images, we consider the described in [39–42] quantitative measure of image enhancement that relates to Weber's law of human visual system. This measure is effectively used for the well-known α-rooting method of image enhancement by the Fourier transform, as well as other unitary transforms [39–60]. A discrete image 
                           {
                           
                              
                                 f
                              
                              
                                 n
                                 ,
                                 m
                              
                           
                           }
                         of size 
                           
                              
                                 N
                              
                              
                                 1
                              
                           
                           ×
                           
                              
                                 N
                              
                              
                                 2
                              
                           
                         is divided by 
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                         blocks of size 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                           ×
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                         each, where 
                           
                              
                                 k
                              
                              
                                 i
                              
                           
                           =
                           
                              ⌊
                              
                                 
                                    N
                                 
                                 
                                    i
                                 
                              
                              /
                              
                                 
                                    L
                                 
                                 
                                    i
                                 
                              
                              ⌋
                           
                        , 
                           i
                           =
                           1
                           ,
                           2
                        , and 
                           ⌊
                           .
                           ⌋
                         denotes the floor function. The quantitative measure of enhancement of the processed image 
                           {
                           
                              
                                 f
                              
                              
                                 n
                                 ,
                                 m
                              
                           
                           }
                           →
                           {
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 n
                                 ,
                                 m
                              
                           
                           }
                         is defined by
                           
                              (8)
                              
                                 
                                    EME
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                                 =
                                 
                                    1
                                    
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                 
                                 20
                                 log
                                 ⁡
                                 
                                    [
                                    
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                ,
                                                l
                                             
                                          
                                          ⁡
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                min
                                             
                                             
                                                k
                                                ,
                                                l
                                             
                                          
                                          ⁡
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                    
                                    ]
                                 
                              
                           
                         where 
                           
                              
                                 max
                              
                              
                                 k
                                 ,
                                 l
                              
                           
                           ⁡
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                         and 
                           
                              
                                 min
                              
                              
                                 k
                                 ,
                                 l
                              
                           
                           ⁡
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                         respectively are the maximum and minimum of the image 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 n
                                 ,
                                 m
                              
                           
                         inside the 
                           (
                           k
                           ,
                           l
                           )
                        th block. To avoid zeros of 
                           
                              
                                 min
                              
                              
                                 k
                                 ,
                                 l
                              
                           
                           ⁡
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                         in the denominator, one can consider 
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                         as 
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           +
                           1
                        . For images with the most pixels of high intensities, it is reasonable to calculate 
                           
                              EME
                           
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           −
                           min
                           ⁡
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                           )
                         instead of 
                           
                              EME
                           
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                        . In calculation of this function, the blocks with zero 
                           
                              
                                 min
                              
                              
                                 k
                                 ,
                                 l
                              
                           
                           ⁡
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                         can be skipped or 1 can be added to the image, to avoid zero values of 
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                         for 
                           
                              
                                 log
                              
                              
                                 10
                              
                           
                           ⁡
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                         function. In the 
                           (
                           k
                           ,
                           l
                           )
                        th block, the ratio in the logarithm
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       k
                                       ,
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 ⁡
                                 
                                    [
                                    
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                ,
                                                l
                                             
                                          
                                          ⁡
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                min
                                             
                                             
                                                k
                                                ,
                                                l
                                             
                                          
                                          ⁡
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 ⁡
                                 
                                    [
                                    
                                       max
                                       
                                          k
                                          ,
                                          l
                                       
                                    
                                    ⁡
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    ]
                                 
                                 −
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 ⁡
                                 
                                    [
                                    
                                       min
                                       
                                          k
                                          ,
                                          l
                                       
                                    
                                    ⁡
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    ]
                                 
                              
                           
                         shows the range of intensities of the image 
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                         in the logarithmic scale. Therefore, 
                           
                              
                                 EME
                              
                              
                                 a
                              
                           
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                         determines the average-block scale of intensities in the image after processing.

Our experimental results show that the better quality of the image 
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                        , the higher value of 
                           
                              EME
                           
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                           >
                           
                              EME
                           
                           (
                           f
                           )
                        . In the example with the pentagon image in Fig. 6, the enhancement measure 
                           
                              EME
                           
                           (
                           f
                           )
                           =
                           6.27
                        , and for the image 
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                         in c this measure is 
                           
                              EME
                           
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                           =
                           12.50
                        , and for the image in d the enhancement measure is 
                           
                              EME
                           
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                           =
                           6.94
                        .


                        Fig. 7
                        (a) shows the image of Einstein. This image is of low contrast and its enhancement measure 
                           
                              EME
                           
                           (
                           f
                           )
                           =
                           2.30
                        . The image 
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                         after processing by the arithmetical weighted thresholding with increasing linear function 
                           k
                           (
                           α
                           )
                         is shown in b. The enhancement measure of this image is 
                           
                              EME
                           
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                           =
                           4.51
                        . The arithmetical thresholding results in the image of higher quality and many details in the image can be seen better in comparison with the original image.


                        Fig. 8
                         shows the results of the arithmetical thresholding with the function 
                           k
                           (
                           α
                           )
                           =
                           α
                         in part b. The original image f of size 
                           256
                           ×
                           512
                         in a is composed by two images, tree and Lena images of size 
                           256
                           ×
                           256
                         each. The image composition f has the enhancement measure 
                           
                              EME
                           
                           (
                           f
                           )
                           =
                           13.28
                        , and for the enhanced image 
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                         in b, 
                           
                              EME
                           
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                           =
                           26.35
                        .

We now describe the case, when the sum of all elements in the thresholding sequence 
                           k
                           (
                           α
                           )
                         equals 1. As an example, we assume that the m-valued function 
                           f
                           (
                           x
                           )
                         describes a random discrete signal and the function 
                           k
                           (
                           α
                           )
                        , where 
                           α
                           =
                           1
                           ,
                           …
                           ,
                           m
                        , is referred to as the density function of the signal. Let 
                           
                              
                                 p
                              
                              
                                 a
                              
                           
                         be nonnegative numbers such that 
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 p
                              
                              
                                 2
                              
                           
                           +
                           …
                           +
                           
                              
                                 p
                              
                              
                                 m
                              
                           
                           =
                           1
                        . We define the coefficients 
                           k
                           (
                           α
                           )
                           =
                           
                              
                                 p
                              
                              
                                 α
                              
                           
                        , 
                           α
                           =
                           1
                           ,
                           …
                           ,
                           m
                        , and the “distribution” function 
                           F
                           (
                           α
                           )
                         calculated as 
                           F
                           (
                           1
                           )
                           =
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                         and 
                           F
                           (
                           α
                           )
                           =
                           F
                           (
                           α
                           −
                           1
                           )
                           +
                           
                              
                                 p
                              
                              
                                 α
                              
                           
                        , when 
                           α
                           >
                           1
                        . The weighted thresholding is the “distribution” function, i.e.,
                           
                              (9)
                              
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       α
                                       =
                                       1
                                    
                                    
                                       f
                                       (
                                       x
                                       )
                                    
                                 
                                 k
                                 (
                                 α
                                 )
                                 =
                                 
                                    ∑
                                    
                                       α
                                       =
                                       1
                                    
                                    
                                       f
                                       (
                                       x
                                       )
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       α
                                    
                                 
                                 =
                                 F
                                 (
                                 f
                                 (
                                 x
                                 )
                                 )
                                 .
                              
                           
                        
                     


                        
                           Example 3
                           Probability-type coefficients 
                                 k
                                 (
                                 α
                                 )
                              
                           


                           We consider the function 
                                 f
                                 (
                                 x
                                 )
                                 =
                                 {
                                 2
                                 ,
                                 1
                              , 
                                 2
                                 ,
                                 1
                                 ,
                                 3
                                 ,
                                 5
                                 ,
                                 4
                                 ,
                                 3
                                 ,
                                 4
                                 ,
                                 2
                                 ,
                                 1
                                 }
                              . This function has five different non-zero values. We assume for example that, probabilities of these values are 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0.4
                              , 
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0.2
                              , 
                                 
                                    
                                       p
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 0.2
                              , 
                                 
                                    
                                       p
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 0.1
                              , and 
                                 
                                    
                                       p
                                    
                                    
                                       5
                                    
                                 
                                 =
                                 0.1
                              . For simplicity of calculations, we multiply these values by 10 and consider 
                                 k
                                 (
                                 1
                                 )
                                 =
                                 4
                              , 
                                 k
                                 (
                                 2
                                 )
                                 =
                                 2
                              , 
                                 k
                                 (
                                 3
                                 )
                                 =
                                 2
                              , 
                                 k
                                 (
                                 4
                                 )
                                 =
                                 1
                              , 
                                 k
                                 (
                                 5
                                 )
                                 =
                                 1
                              . The function 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                               is calculated as follows:
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                4
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                4
                                                ,
                                                4
                                                ,
                                                4
                                                ,
                                                4
                                                ,
                                                4
                                                ,
                                                
                                                4
                                                ,
                                                
                                                4
                                                ,
                                                4
                                                ,
                                                4
                                                ,
                                                4
                                                ,
                                                4
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                2
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                2
                                                ,
                                                0
                                                ,
                                                2
                                                ,
                                                0
                                                ,
                                                2
                                                ,
                                                
                                                2
                                                ,
                                                
                                                2
                                                ,
                                                2
                                                ,
                                                2
                                                ,
                                                2
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                2
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                2
                                                ,
                                                
                                                2
                                                ,
                                                
                                                2
                                                ,
                                                2
                                                ,
                                                2
                                                ,
                                                0
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      4
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      4
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                1
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                
                                                1
                                                ,
                                                
                                                1
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      5
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      5
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                1
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                
                                                1
                                                ,
                                                
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      f
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                …
                                                +
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      5
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                6
                                                ,
                                                4
                                                ,
                                                6
                                                ,
                                                4
                                                ,
                                                6
                                                ,
                                                10
                                                ,
                                                
                                                9
                                                ,
                                                8
                                                ,
                                                9
                                                ,
                                                6
                                                ,
                                                4
                                                }
                                                .
                                             
                                          
                                       
                                    
                                 
                               Thus, 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                                 /
                                 10
                                 =
                                 F
                                 (
                                 f
                                 (
                                 x
                                 )
                                 )
                               and 
                                 F
                                 =
                                 {
                                 0.4
                                 ,
                                 0.6
                                 ,
                                 0.8
                                 ,
                                 0.9
                                 ,
                                 1
                                 }
                              .

In general, to preserve the range of the transform, we can consider the coefficients 
                           k
                           (
                           α
                           )
                           =
                           m
                           
                              
                                 p
                              
                              
                                 α
                              
                           
                        , and therefore 
                           
                              
                                 K
                              
                              
                                 f
                              
                           
                           (
                           x
                           )
                           =
                           m
                           F
                           (
                           f
                           (
                           x
                           )
                           )
                        . The ordering of all values of 
                           
                              
                                 p
                              
                              
                                 α
                              
                           
                         in descending order is not necessary. In the case when 
                           
                              
                                 p
                              
                              
                                 a
                              
                           
                         is the probability of the event 
                           {
                           f
                           (
                           x
                           )
                           =
                           a
                           }
                        , the weighted thresholding represents the well-known operation of histogram equalization (HE) of the random signal 
                           f
                           (
                           x
                           )
                         
                        [23]. As an example, Fig. 9
                         shows the tree-and-Lena image in part a, along with the histogram 
                           
                              
                                 p
                              
                              
                                 α
                              
                           
                         and scaled distribution function 
                           F
                           (
                           α
                           )
                           /
                           100
                         in part b. The weighted thresholding 
                           
                              
                                 K
                              
                              
                                 f
                              
                           
                           (
                           x
                           )
                         of the image is shown in c. To improve the visibility of the scene behind the tree, the high powers of the distribution function 
                           F
                           (
                           α
                           )
                         can be used. As example, the tree image after the weighted thresholding corresponding to the scaled to level 256 function 
                           
                              
                                 F
                              
                              
                                 3
                              
                           
                           (
                           α
                           )
                         is shown in part d. Many details of trees on the slope of the mountain, as well as the homes can be seen better when comparing with the three images in parts a and c. Fig. 10
                         shows the results of the image processing by the 2nd and 4th powers of the distribution function in parts a and b, respectively. For the images 
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                         in a and b, 
                           
                              EME
                           
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                           =
                           26.71
                         and 26.86, respectively.


                        Fig. 11
                         shows the image of size 
                           512
                           ×
                           512
                         in part a, and its histogram, the distribution function with its 2nd power in parts b (which are scaled with the factor of 50). The results of the image processing by the weighed thresholding when using the distribution function and its square are given in parts c and d, respectively. One can note, that the weighed thresholding in d is an enhanced image. The enhancement measure of the original image is 16.85 and the measure for the enhanced image in d is 21.86.

The considered measure of image enhancement, EME, can be parameterized by the power parameter of 
                           
                              
                                 F
                              
                              
                                 k
                              
                           
                           (
                           α
                           )
                        . The EME operation is nonlinear and a such function 
                           
                              EME
                           
                           (
                           k
                           )
                         in general is not monotonic, neither linear or sectionally linear, however this function can be used in many applications to select the “best” parameter for image processing [39–45]. For the considered enhancement by the weighed thresholding with the powers of the distribution function 
                           
                              
                                 F
                              
                              
                                 k
                              
                           
                           (
                           α
                           )
                        , Fig. 12
                         shows the graph of the function 
                           
                              EME
                           
                           (
                           k
                           )
                         when the parameter k run the interval 
                           [
                           0.5
                           ,
                           2
                           ]
                        . In the interval 
                           [
                           0.5
                           ,
                           1.73
                           ]
                        , the function is approximately linear, and at point 
                           k
                           =
                           1.73
                         there is a jump of the function; the function is back to one of its state (
                           k
                           =
                           1.29
                        ) and starts to grow in the same way. This is a special point in the considered interval of k, and after this point the image will be darker and darker, as can be seen from the graphs of 
                           F
                           (
                           α
                           )
                         and 
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                           (
                           α
                           )
                         in Fig. 11(b). The results of the image processing by the 
                           
                              
                                 F
                              
                              
                                 1.73
                              
                           
                           (
                           α
                           )
                         with enhancement 
                           
                              EME
                           
                           (
                           1.73
                           )
                           =
                           25.27
                         is shown in part b.

The processing of the image 
                           f
                           (
                           x
                           )
                         through the function 
                           
                              
                                 K
                              
                              
                                 f
                              
                           
                           (
                           x
                           )
                         calculated by the probability-type sequence (PTS) 
                           
                              
                                 p
                              
                              
                                 k
                              
                           
                         is described by Algorithm 2
                        .

The weighted thresholding can be applied block-wise as well. However, in this case, the subsequent removal of the block-effect may be needed. Such processing allows to see many details of the image in different parts. As an example, Fig. 13
                         shows the image in part a, along with the images processed by the distribution functions calculated in blocks of size 
                           64
                           ×
                           128
                         each in b. The similar result when processing the image by blocks of size 
                           8
                           ×
                           256
                         each is given in c.

In another example, Fig. 14
                         shows the image f in part a, along with the images processed by the distribution functions which are calculated in blocks of size 
                           256
                           ×
                           8
                         each in b, and by blocks of size 
                           8
                           ×
                           256
                         each in c. The enhancement measure 
                           
                              EME
                           
                           (
                           f
                           )
                           =
                           18.64
                        , and after processing the enhancement 
                           
                              EME
                           
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                           =
                           33.51
                         in b and 
                           
                              EME
                           
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                           =
                           35.88
                         in c. For comparison, the histogram equalization (with 
                           
                              EME
                           
                           (
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           )
                           =
                           30.54
                        ) of the image is given in d.

In this section, the weighted thresholding with a piecewise linear function is described and a few examples of such functions are given. We consider a function which preserves much details in the image with low intensities, and decreases the intensities of pixels with high values of intensities. For example, in the foreground of the tree image all details can clearly be seen, and in the back many details and objects are almost invisible. To improve the visibility of these details in the image, we define the exponential function 
                        k
                        (
                        α
                        )
                      scattered over the interval 
                        [
                        0
                        ,
                        255
                        ]
                     ,
                        
                           
                              k
                              (
                              α
                              )
                              =
                              
                                 
                                    α
                                 
                                 
                                    0
                                 
                              
                              ⋅
                              
                                 
                                    2
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                              α
                              =
                              0
                              :
                              255
                              .
                           
                        
                      Here 
                        
                           
                              α
                           
                           
                              0
                           
                        
                        =
                        1
                      and 
                        n
                        =
                        0
                     , if 
                        α
                        ∈
                        [
                        1
                        ,
                        128
                        ]
                     , 
                        n
                        =
                        1
                     , if 
                        α
                        ∈
                        [
                        129
                        ,
                        128
                        +
                        64
                        ]
                     , 
                        n
                        =
                        2
                     , if 
                        α
                        ∈
                        [
                        193
                        ,
                        192
                        +
                        32
                        ]
                     , and so on. Fig. 15
                      shows this stepped function.


                     Fig. 16
                      shows the tree image in part a and the result of the thresholding in b, when the above function 
                        k
                        (
                        α
                        )
                      is used. When comparing this result with the images of Fig. 8, one can see that the foreground of the tree image becomes darker, when the powers of the distribution function are used.

The result of the thresholding by the function 
                        k
                        (
                        α
                        )
                      for the man image is shown in Fig. 17
                     . The enhancement measure of the image in b is 
                        
                           EME
                        
                        =
                        18.70
                      and it is higher than 
                        
                           EME
                        
                        =
                        16.85
                      for the original image in a.

In the above function 
                        k
                        (
                        α
                        )
                     , the step exponentially changes from one interval to the next one. This example shows that to enhance some parts and important details of the image and preserve the high quality of other parts of the image, extremely sensitive gray scale transformations should be used. Therefore, we consider the case when the weighted function goes up very slow.

The piecewise integer stepped sequence of numbers 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                         is defined as the function with steps which satisfy the following condition: in any four consecutive 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                         numbers only two numbers are repeated. For example, such four numbers are 
                           {
                           
                              
                                 G
                              
                              
                                 10
                              
                           
                           ,
                           
                              
                                 G
                              
                              
                                 11
                              
                           
                           ,
                           
                              
                                 G
                              
                              
                                 12
                              
                           
                           ,
                           
                              
                                 G
                              
                              
                                 13
                              
                           
                           }
                           =
                           {
                           
                              
                                 7
                                 ,
                                 7
                              
                              ̲
                           
                           ,
                           8
                           ,
                           9
                           }
                        . We call such a stepped sequence to be the stairs with 2-in-4 steps. It is assumed that the stepped function is monotonic and without high steps. Therefore, we consider the condition that 
                           |
                           
                              
                                 G
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                           |
                           =
                           0
                        , or 1, for all 
                           k
                           >
                           1
                        .


                        Table 1
                         shows a few values of such an integer stepped function. This sequence of numbers is written into rows from left to right and top to bottom. The sequence begins with 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                           =
                           1
                        , ends with number 
                           
                              
                                 G
                              
                              
                                 512
                              
                           
                           =
                           355
                         and runs integers from 1 to 355.

This 2-in-4 sequence can be calculated in the following way. Let Φ be the golden ratio, i.e.,
                           
                              
                                 Φ
                                 =
                                 (
                                 1
                                 +
                                 
                                    5
                                 
                                 )
                                 /
                                 2
                                 =
                                 1.618033988749894
                                 ⋯
                                 .
                              
                           
                         The sequence of numbers 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                         which begins with integer number m is defined as
                           
                              
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 [
                                 k
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 ⁡
                                 (
                                 Φ
                                 )
                                 −
                                 1.1610
                                 ]
                                 +
                                 m
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 …
                                 
                                 ,
                              
                           
                         where the number 1.1610 stands for 
                           
                              5
                           
                           /
                           2
                        . The square brackets 
                           [
                           ⋅
                           ]
                         denote the operation of rounding towards nearest integer. We consider the case when the sequence of numbers begins with 1. The 2-in-4 sequence in the table corresponds to this case, i.e., when 
                           m
                           =
                           1
                        .

It should be noted that the sequence of integer numbers 
                           
                              
                                 A
                              
                              
                                 k
                              
                           
                           =
                           [
                           k
                           
                              
                                 log
                              
                              
                                 2
                              
                           
                           ⁡
                           (
                           Φ
                           )
                           ]
                           +
                           m
                        , 
                           k
                           =
                           1
                           ,
                           2
                           ,
                           3
                           ,
                           …
                         , is not 2-in-4 sequence. To be convinced of this fact, it is enough to consider the first 22 numbers for this sequence for 
                           m
                           =
                           1
                        , which are
                           
                              
                                 1
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 
                                    
                                       3
                                       ,
                                       4
                                       ,
                                       5
                                       ,
                                       6
                                    
                                    ̲
                                 
                                 ,
                                 6
                                 ,
                                 7
                                 ,
                                 8
                                 ,
                                 8
                                 ,
                                 9
                                 ,
                                 10
                                 ,
                                 10
                                 ,
                                 11
                                 ,
                                 12
                                 ,
                                 
                                    
                                       12
                                       ,
                                       13
                                       ,
                                       14
                                       ,
                                       15
                                    
                                    ̲
                                 
                                 ,
                                 15
                                 .
                              
                           
                         Each of underlined fours contains different four numbers.

The 2-in-4 sequence, as well as, the powers of this function can be used in image enhancement as the weighted functions. As example, Fig. 18
                         shows the tree image in part a, along with the graph of the 2-in-4 sequence in b, and image processed by the amplified sequence, 
                           λ
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                         image in c. The constant 
                           λ
                           =
                           
                              
                                 k
                              
                              
                                 0
                              
                           
                           /
                           
                              
                                 G
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         is selected to preserve the range of gray-level of the tree image, i.e., 
                           
                              
                                 k
                              
                              
                                 0
                              
                           
                           =
                           max
                           ⁡
                           (
                           
                              
                                 f
                              
                              
                                 n
                                 ,
                                 m
                              
                           
                           )
                        . The scaled sequence is almost diagonal, and image in c does not differ much from the original tree image.

The different powers of the 2-in-4 sequence of 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                         numbers can be effectively used to rise the visibility of details of the image. The second and third powers, 
                           
                              
                                 G
                              
                              
                                 k
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 k
                              
                              
                                 3
                              
                           
                        , of this sequence are given in d. The image processed by 
                           
                              
                                 G
                              
                              
                                 k
                              
                              
                                 2
                              
                           
                         is shown in e, and the image processed by 
                           
                              
                                 G
                              
                              
                                 k
                              
                              
                                 3
                              
                           
                         in f. Fig. 19
                         shows the boat image in part a and the enhancement by the 2nd power of the 2-in-4 sequence in b. Fig. 20
                         shows the “elaine” image in part a. The images enhanced by the 2nd and 3rd powers of the 2-in-4 sequence are shown in parts b and c, respectively. The tank image and its enhancement by the 2nd power 
                           
                              
                                 G
                              
                              
                                 k
                              
                              
                                 2
                              
                           
                         of the 2-in-4 sequence are shown in parts a and b of Fig. 21
                        , respectively.

The proposed processing of the image 
                           f
                           (
                           x
                           )
                         by the powers of the 2-in-4 sequence of 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                         numbers can be described by the following algorithm.


                        
                           
                              Algorithm 3
                              
                                 Image enhancement by sequence 
                                       
                                          
                                             G
                                          
                                          
                                             n
                                          
                                       
                                    , v
                                    ≥0.
                              
                              
                           
                        
                     

The Fibonacci numbers [58] are widely used in different applications of signal and image processing including the thresholding, signal representation, morphological filtration, and image encryption [11–14,59–63]. The above 2-in-4 sequence of 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                         numbers can be calculated by the Fibonacci sequence. Consider the Fibonacci numbers 
                           
                              
                                 F
                              
                              
                                 k
                              
                           
                         that begin with 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                           =
                           1
                        ,
                           
                              
                                 1
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 5
                                 ,
                                 8
                                 ,
                                 13
                                 ,
                                 21
                                 ,
                                 34
                                 ,
                                 55
                                 ,
                                 89
                                 ,
                                 144
                                 ,
                                 233
                                 ,
                                 …
                                 
                                 .
                              
                           
                         The Fibonacci numbers are calculated recurrently by the following formula:
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       k
                                       −
                                       2
                                    
                                 
                                 ,
                                 
                                 k
                                 =
                                 3
                                 ,
                                 4
                                 ,
                                 5
                                 ,
                                 
                                 …
                                 
                                 .
                              
                           
                         The first 24 numbers from Fibonacci sequence are given in Table 2
                        .

The relation between the 
                           
                              
                                 G
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 k
                              
                           
                         numbers is described by the following formula:
                           
                              
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 [
                                 
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 ⁡
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                 
                                 
                                 ]
                                 +
                                 1
                                 ,
                                 
                                 k
                                 ≥
                                 1
                                 .
                              
                           
                        
                     

The Fibonacci series grows very fast and has large numbers when 
                           k
                           >
                           16
                        . The ratios 
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 F
                              
                              
                                 k
                              
                           
                           /
                           
                              
                                 F
                              
                              
                                 k
                                 −
                                 1
                              
                           
                         of the Fibonacci numbers, when 
                           k
                           =
                           3
                           :
                           10
                        , equal 
                           2
                           ,
                           1.5
                           ,
                           1
                           .
                           (
                           6
                           )
                           ,
                           1.60
                        , 
                           1.6250
                           ,
                           1.6153846154
                           ,
                           1.6190476190
                        , and 1.6176470588, respectively. The ratio 
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                         approaches to the golden number, i.e., 
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           →
                           Φ
                         when 
                           k
                           →
                           ∞
                        . We now consider an example of processing the 1-D signal by the weighted Fibonacci sequence.


                        
                           Example 4
                           Fibonacci numbers 
                                 k
                                 (
                                 α
                                 )
                              
                           


                           Let the function 
                                 k
                                 (
                                 α
                                 )
                               be the first numbers of the Fibonacci series 
                                 k
                                 (
                                 α
                                 )
                                 =
                                 1
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 5
                                 ,
                                 8
                                 ,
                                 13
                                 ,
                                 …
                              , 
                                 (
                                 α
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ,
                                 5
                                 ,
                                 6
                                 ,
                                 7
                                 ,
                                 …
                                 
                                 )
                              . For the signal 
                                 f
                                 (
                                 x
                                 )
                                 =
                                 {
                                 0
                                 ,
                                 3
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 5
                                 ,
                                 2
                                 ,
                                 4
                                 ,
                                 1
                              , 
                                 2
                                 ,
                                 0
                                 }
                              , 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 {
                                 0
                                 ,
                                 4
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 4
                                 ,
                                 12
                                 ,
                                 2
                                 ,
                                 7
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 0
                                 }
                              . Indeed, the following calculations hold:
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                1
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                
                                                1
                                                ,
                                                1
                                                ,
                                                
                                                1
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                1
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                1
                                                ,
                                                
                                                1
                                                ,
                                                1
                                                ,
                                                
                                                1
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                2
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                2
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                2
                                                ,
                                                
                                                2
                                                ,
                                                0
                                                ,
                                                
                                                2
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      4
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      4
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                3
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                
                                                3
                                                ,
                                                0
                                                ,
                                                
                                                3
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      5
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      5
                                                   
                                                
                                                (
                                                x
                                                )
                                                ×
                                                5
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                
                                                5
                                                ,
                                                0
                                                ,
                                                
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                                }
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      f
                                                   
                                                
                                                (
                                                x
                                                )
                                                =
                                                (
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                …
                                                +
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      5
                                                   
                                                
                                                (
                                                (
                                                x
                                                )
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                0
                                                ,
                                                4
                                                ,
                                                1
                                                ,
                                                2
                                                ,
                                                4
                                                ,
                                                12
                                                ,
                                                2
                                                ,
                                                7
                                                ,
                                                1
                                                ,
                                                2
                                                ,
                                                0
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           


                              Fig. 22
                               shows the signal 
                                 f
                                 (
                                 x
                                 )
                               in part a and the signal thresholding 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                               in b. The weighted thresholding preserves the structure of the signal and increases the value of the pike.

The function 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                               as a finite sum of the Fibonacci numbers can also be calculated by
                                 
                                    (10)
                                    
                                       
                                          
                                             K
                                          
                                          
                                             f
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          ∑
                                          
                                             α
                                             =
                                             1
                                          
                                          
                                             f
                                             (
                                             x
                                             )
                                          
                                       
                                       k
                                       (
                                       α
                                       )
                                       =
                                       k
                                       (
                                       f
                                       (
                                       x
                                       )
                                       +
                                       2
                                       )
                                       −
                                       1
                                       .
                                    
                                 
                               For each value 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                              , we can calculate the number α such as 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 x
                                 )
                                 +
                                 1
                                 =
                                 k
                                 (
                                 α
                                 )
                              . Therefore, the value 
                                 α
                                 −
                                 2
                               is the value of the initial function, 
                                 f
                                 (
                                 x
                                 )
                                 =
                                 α
                                 −
                                 2
                              . In other words, in the case of Fibonacci numbers, we have the following inversion of the weighted transform:
                                 
                                    (11)
                                    
                                       f
                                       (
                                       x
                                       )
                                       →
                                       
                                          
                                             K
                                          
                                          
                                             f
                                          
                                       
                                       (
                                       x
                                       )
                                       →
                                       
                                          
                                             K
                                          
                                          
                                             f
                                          
                                       
                                       (
                                       x
                                       )
                                       +
                                       1
                                       =
                                       k
                                       (
                                       α
                                       )
                                       →
                                       α
                                       −
                                       2
                                       =
                                       f
                                       (
                                       x
                                       )
                                       .
                                    
                                 
                               It is the simplest example among all examples considered above. The Fibonacci numbers 
                                 k
                                 (
                                 α
                                 )
                               grow very fast as α becomes large. We assume thus that Fibonacci thresholding can be used for L-values signals for not large values of L. In image processing, the Fibonacci sequence scattered over the interval 
                                 [
                                 0
                                 ,
                                 L
                                 ]
                               can be used similarly to the exponential sequence 
                                 k
                                 (
                                 α
                                 )
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       2
                                    
                                    
                                       n
                                    
                                 
                              , when 
                                 n
                                 =
                                 n
                                 (
                                 α
                                 )
                              .

In this section, we describe a representation of the integer-valued signal by the sum or union of Fibonacci-valued signals and the corresponding canonical representation of the signal by binary signals. The canonical representation reduces the number of binary signals and therefore can be useful for processing the signals through the binary signals and for constructing new filters. We can mention the efficient calculation of the median type filters which are increasingly popular in signal and image processing [18–21]. The basic reason for this is the good noise attenuation and edge preservation performance (sharp edges are very important factors in images and useful for the solution and recognition problems).


                     
                        Statement 1
                        Fibonacci representation


                        Any integer signal with non-negative values can be represented by the sum of signals 
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          g
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                            which are composed only by Fibonacci numbers,
                              
                                 (12)
                                 
                                    f
                                    (
                                    x
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       l
                                    
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          x
                                          )
                                       
                                    
                                    .
                                 
                              
                           
                        

To illustrate this statement, we consider the following 16-valued non-negative signal of length 21:
                        
                           
                              f
                              (
                              x
                              )
                              =
                              {
                              0
                              ,
                              1
                              ,
                              4
                              ,
                              4
                              ,
                              5
                              ,
                              8
                              ,
                              11
                              ,
                              11
                              ,
                              11
                              ,
                              10
                              ,
                              6
                              ,
                              5
                              ,
                              4
                              ,
                              2
                              ,
                              8
                              ,
                              13
                              ,
                              16
                              ,
                              11
                              ,
                              7
                              ,
                              
                              
                              0
                              ,
                              0
                              }
                              .
                           
                        
                      The maximum value of the signal is 16 and therefore we take the first six Fibonacci numbers from the second member 
                        {
                        
                           
                              u
                           
                           
                              k
                           
                        
                        =
                        
                           
                              F
                           
                           
                              k
                              −
                              1
                           
                        
                        ;
                        
                        k
                        =
                        1
                        :
                        6
                        }
                        =
                        {
                        1
                        ,
                        2
                        ,
                        3
                        ,
                        5
                        ,
                        8
                        ,
                        13
                        }
                     . These numbers <16 and will be referred to as Fibonacci levels, since they will be used for signal thresholding. The Fibonacci-valued signal which lies right beneath 
                        f
                        (
                        x
                        )
                      is
                        1
                     
                     
                        1
                        As if, the function f falls on the highest Fibonacci levels 
                              
                                 
                                    u
                                 
                                 
                                    k
                                 
                              
                            to compose 
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                           .
                     
                     
                        
                           
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                              =
                              {
                              0
                              ,
                              1
                              ,
                              3
                              ,
                              3
                              ,
                              5
                              ,
                              8
                              ,
                              8
                              ,
                              8
                              ,
                              8
                              ,
                              8
                              ,
                              5
                              ,
                              5
                              ,
                              3
                              ,
                              2
                              ,
                              8
                              ,
                              13
                              ,
                              13
                              ,
                              8
                              ,
                              5
                              ,
                              0
                              ,
                              0
                              }
                              .
                           
                        
                     
                  

We now assign the set of six binary signals
                        
                           (13)
                           
                              {
                              
                                 
                                    f
                                 
                                 
                                    α
                                 
                              
                              (
                              x
                              )
                              ;
                              
                              α
                              =
                              
                                 
                                    u
                                 
                                 
                                    k
                                 
                              
                              =
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              5
                              ,
                              8
                              ,
                              13
                              }
                           
                        
                      and compose the function 
                        g
                        (
                        x
                        )
                      which corresponds to these binary signals
                        
                           (14)
                           
                              
                                 
                                    g
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          (
                                          x
                                          )
                                          ;
                                       
                                       
                                           if 
                                          k
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          3
                                          ,
                                          4
                                          ,
                                          5
                                          ,
                                          6
                                          ;
                                       
                                    
                                    
                                       
                                          0
                                          ;
                                       
                                       
                                           if 
                                          k
                                          >
                                          6
                                          .
                                       
                                    
                                 
                              
                           
                        
                      The following binary signals are calculated:
                        
                           
                              
                                 
                                    g
                                 
                                 
                                    6
                                 
                                 
                                    ′
                                 
                              
                              (
                              x
                              )
                              =
                              {
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              
                              }
                              ,
                              
                              
                                 
                                    g
                                 
                                 
                                    5
                                 
                                 
                                    ′
                                 
                              
                              (
                              x
                              )
                              =
                              {
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              
                              }
                              ,
                              
                              
                                 
                                    g
                                 
                                 
                                    4
                                 
                                 
                                    ′
                                 
                              
                              (
                              x
                              )
                              =
                              {
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              
                              }
                              ,
                              
                              
                                 
                                    g
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                              (
                              x
                              )
                              =
                              {
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              
                              }
                              ,
                              
                              
                                 
                                    g
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              (
                              x
                              )
                              =
                              {
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              
                              }
                              ,
                              
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              (
                              x
                              )
                              =
                              {
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              
                              }
                              .
                           
                        
                      These binary signals 
                        
                           
                              g
                           
                           
                              k
                           
                           
                              ′
                           
                        
                      form the following 6-level signal
                        
                           
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 6
                              
                              
                                 
                                    g
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              (
                              x
                              )
                              =
                              {
                              0
                              ,
                              1
                              ,
                              3
                              ,
                              3
                              ,
                              4
                              ,
                              5
                              ,
                              5
                              ,
                              5
                              ,
                              5
                              ,
                              5
                              ,
                              4
                              ,
                              4
                              ,
                              3
                              ,
                              2
                              ,
                              5
                              ,
                              6
                              ,
                              6
                              ,
                              5
                              ,
                              4
                              ,
                              0
                              ,
                              0
                              }
                              .
                           
                        
                      This signal is the canonical representation of the signal 
                        
                           
                              f
                           
                           
                              1
                           
                        
                        (
                        x
                        )
                      which can be calculated by
                        
                           
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                              ,
                              
                              x
                              =
                              0
                              :
                              20
                              .
                           
                        
                      The difference of these functions is
                        
                           
                              
                                 
                                    Δ
                                 
                                 
                                    1
                                 
                              
                              f
                              (
                              x
                              )
                              =
                              f
                              (
                              x
                              )
                              −
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                              =
                              {
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              3
                              ,
                              3
                              ,
                              3
                              ,
                              2
                              ,
                              1
                              ,
                              0
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              3
                              ,
                              3
                              ,
                              2
                              ,
                              0
                              ,
                              0
                              }
                              .
                           
                        
                      It is the 3-valued signal (see Fig. 23
                     ), each value of which is a Fibonacci member, i.e.,
                        
                           
                              
                                 
                                    Δ
                                 
                                 
                                    1
                                 
                              
                              f
                              (
                              x
                              )
                              =
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          1
                                       
                                    
                                    f
                                    (
                                    x
                                    )
                                 
                              
                              ,
                              
                              x
                              =
                              0
                              :
                              20
                              .
                           
                        
                      This signals equals its canonical representation, which we denote by 
                        
                           
                              g
                           
                           
                              2
                           
                        
                        (
                        x
                        )
                     , i.e., 
                        
                           
                              g
                           
                           
                              2
                           
                        
                        (
                        x
                        )
                        =
                        
                           
                              Δ
                           
                           
                              1
                           
                        
                        f
                        (
                        x
                        )
                     . Fig. 23 shows the original signal 
                        f
                        (
                        x
                        )
                      in part a, and the signal 
                        
                           
                              f
                           
                           
                              1
                           
                        
                        (
                        x
                        )
                      in b with its canonical representation 
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        x
                        )
                      in d, the difference signal 
                        
                           
                              Δ
                           
                           
                              1
                           
                        
                        f
                        (
                        x
                        )
                      in c, and the signal 
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        x
                        )
                      in d.

The signal 
                        f
                        (
                        x
                        )
                      is the sum of the two signals, one of which is described by means of the 6-level signal 
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        x
                        )
                      and another is the 3-valued signal,
                        
                           (15)
                           
                              f
                              (
                              x
                              )
                              =
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                              +
                              
                                 
                                    Δ
                                 
                                 
                                    1
                                 
                              
                              f
                              (
                              x
                              )
                              =
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          1
                                       
                                    
                                    f
                                    (
                                    x
                                    )
                                 
                              
                              ,
                              
                              x
                              =
                              0
                              :
                              20
                              .
                           
                        
                      Thus, for the 16-valued signal 
                        f
                        (
                        x
                        )
                     , it is enough to calculate its binary signals by the first six Fibonacci levels and three binary signals for the difference 
                        
                           
                              Δ
                           
                           
                              1
                           
                        
                        f
                     . It needs together 9 binary signals instead of 16 ones when you use the traditional representation of 
                        f
                        (
                        x
                        )
                      by means of the binary signals 
                        {
                        
                           
                              f
                           
                           
                              α
                           
                        
                        ;
                        
                        a
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        16
                        }
                     .

It is not difficult to show, that every finite-level signal is the sum of signals, each of which is described by the Fibonacci numbers. In the general case, we can prove the following statement. Any discrete finite integer signal 
                        f
                        (
                        x
                        )
                      can be represented as the sum of two signals
                        
                           (16)
                           
                              f
                              (
                              x
                              )
                              =
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                              +
                              
                                 
                                    Δ
                                 
                                 
                                    1
                                 
                              
                              f
                              (
                              x
                              )
                           
                        
                      where 
                        
                           
                              n
                           
                           
                              0
                           
                        
                        =
                        min
                        ⁡
                        f
                        (
                        x
                        )
                      and the signal 
                        
                           
                              u
                           
                           
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                           
                        
                      is composed by the Fibonacci levels 
                        
                           
                              F
                           
                           
                              k
                           
                        
                        ≤
                        r
                      where the integer r is the minimal superior Fibonacci level of the signal 
                        f
                        (
                        x
                        )
                     , for which 
                        r
                        ≥
                        f
                        (
                        x
                        )
                        −
                        
                           
                              n
                           
                           
                              0
                           
                        
                     . When the signal is non-negative, we can consider 
                        
                           
                              n
                           
                           
                              0
                           
                        
                        =
                        0
                     . The signal 
                        
                           
                              Δ
                           
                           
                              1
                           
                        
                        f
                      is a signal with maximum of 
                        (
                        
                           
                              u
                           
                           
                              r
                           
                        
                        −
                        
                           
                              u
                           
                           
                              r
                              −
                              1
                           
                        
                        )
                        =
                        
                           
                              u
                           
                           
                              r
                              −
                              2
                           
                        
                      levels. Continue recursively this procedure, we obtain the expansion of the function 
                        f
                        (
                        x
                        )
                      in the form of the sum of signals
                        
                           (17)
                           
                              f
                              (
                              x
                              )
                              =
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                              +
                              …
                              +
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          g
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          n
                                       
                                    
                                    f
                                    (
                                    x
                                    )
                                 
                              
                              ,
                              
                              n
                              ≥
                              1
                              ,
                           
                        
                      each of which is a sequence of Fibonacci series.

Since the signal 
                        
                           
                              Δ
                           
                           
                              1
                           
                        
                        f
                      is 
                        (
                        
                           
                              u
                           
                           
                              r
                              −
                              2
                           
                        
                        )
                     -level, the signal 
                        
                           
                              g
                           
                           
                              2
                           
                        
                        (
                        x
                        )
                      is the same level signal, and the second difference 
                        Δ
                        (
                        
                           
                              Δ
                           
                           
                              1
                           
                        
                        f
                        )
                        =
                        f
                        −
                        (
                        
                           
                              n
                           
                           
                              0
                           
                        
                        +
                        
                           
                              u
                           
                           
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                           
                        
                        +
                        
                           
                              u
                           
                           
                              
                                 
                                    g
                                 
                                 
                                    2
                                 
                              
                              (
                              x
                              )
                           
                        
                        )
                      is maximum 
                        (
                        
                           
                              u
                           
                           
                              r
                              −
                              4
                           
                        
                        )
                     -level, etc. Defining the number 
                        n
                        =
                        n
                        (
                        r
                        )
                      as 
                        r
                        =
                        2
                        (
                        n
                        +
                        1
                        )
                        +
                        l
                     , 
                        l
                        ∈
                        {
                        0
                        ,
                        1
                        }
                     , we can state that the signal 
                        f
                        (
                        x
                        )
                      can be represented as n signals 
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        x
                        )
                        ,
                        
                           
                              g
                           
                           
                              2
                           
                        
                        (
                        x
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              n
                           
                        
                        (
                        x
                        )
                     , whose levels compose together the following number:
                        
                           (18)
                           
                              L
                              (
                              
                                 
                                    u
                                 
                                 
                                    r
                                 
                              
                              )
                              ≤
                              r
                              +
                              L
                              (
                              
                                 
                                    u
                                 
                                 
                                    r
                                    −
                                    2
                                 
                              
                              )
                              ≤
                              r
                              +
                              (
                              r
                              −
                              2
                              )
                              +
                              (
                              r
                              −
                              4
                              )
                              +
                              …
                              +
                              (
                              r
                              −
                              2
                              (
                              n
                              −
                              1
                              )
                              )
                              +
                              2
                              =
                              n
                              r
                              −
                              n
                              (
                              n
                              −
                              1
                              )
                              +
                              2
                              .
                           
                        
                      These values, for 12 Fibonacci levels r, are given in Table 3
                     , which could be used when considering signals with up to 1597 levels. We can see that the efficiency of the proposed signal representation by means of the corresponding Fibonacci signals 
                        
                           
                              g
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              g
                           
                           
                              2
                           
                        
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              n
                           
                        
                      grows as the number m of levels becomes large. For instance, for the m-level signals when 
                        m
                        =
                        377
                     , the efficiency is greater than 
                        
                           
                              u
                           
                           
                              13
                           
                        
                        /
                        
                           
                              L
                           
                           
                              13
                           
                        
                        =
                        377
                        /
                        47
                        ≈
                        8
                      times. For integer signals with the range that does not exceed the Fibonacci level number 16, no more than 72 binary signals are required to represent the signals. In image processing with the standard scale of 255 gray levels, 12 Fibonacci levels can be used for image decomposition with less than 47 binary images.

In this section, we describe the concept of the median filter which can be calculated through the decomposition of the signal by the Fibonacci levels. In other words, the median filtration can be calculated by medians of the binary signals in canonical representation of the signal by the Fibonacci levels.

Let W be a finite set (window) with 
                           
                              card
                           
                           
                           W
                           =
                           2
                           m
                           +
                           1
                         points, and let 
                           
                              
                                 W
                              
                              
                                 x
                              
                           
                           =
                           {
                           w
                           +
                           x
                           ;
                           
                           w
                           ∈
                           W
                           }
                         be the translation of the window W at the point x.


                        
                           Definition 3
                           An operator M which maps the function 
                                 f
                                 (
                                 x
                                 )
                               into such whose value at x is the median among the values 
                                 f
                                 (
                                 y
                                 )
                              , 
                                 y
                                 ∈
                                 
                                    
                                       W
                                    
                                    
                                       x
                                    
                                 
                              , i.e., 
                                 M
                                 :
                                 
                                 {
                                 f
                                 (
                                 x
                                 )
                                 }
                                 →
                                 {
                                 
                                    Median
                                 
                                 {
                                 f
                                 (
                                 y
                                 )
                                 ;
                                 
                                 y
                                 ∈
                                 
                                    
                                       W
                                    
                                    
                                       x
                                    
                                 
                                 }
                                 }
                              , is called a median filter by W.

In binary setting, when the signal 
                           f
                           (
                           x
                           )
                         is represented as the sum of binary signals, the additive property of the median filter holds [3,20]
                        
                           
                              (19)
                              
                                 f
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    α
                                 
                                 
                                    
                                       f
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 x
                                 )
                                 
                                 ⟷
                                 
                                 M
                                 (
                                 f
                                 )
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    α
                                 
                                 M
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       α
                                    
                                 
                                 )
                                 (
                                 x
                                 )
                                 .
                              
                           
                         Thus, the median filtration of a finite-level signal can be accomplished through the decomposition of the signal by binary signals with following filtration of them. The similar property holds for many other nonlinear filters and stack filters [53]. More general property of decomposition takes place for the mixed median filters which include the traditional median and order statistics [54].

Now, we consider the calculation of the median by using only a few number of Fibonacci-valued signals (images). By means of the binary signals which are calculating on the Fibonacci levels, the m-valued signal 
                           f
                           (
                           x
                           )
                         can be described as the following n-dimensional vector, which we call the canonical vector representation of 
                           f
                           (
                           x
                           )
                        :
                           
                              (20)
                              
                                 Φ
                                 :
                                 
                                 f
                                 →
                                 
                                    g
                                    ̲
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    
                                       ′
                                    
                                 
                                 .
                              
                           
                         This representation defines the vector signal composed by Fibonacci level signals,
                           
                              (21)
                              
                                 
                                    g
                                    ̲
                                 
                                 →
                                 
                                    f
                                    ̲
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             g
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 k
                                 =
                                 1
                                 :
                                 (
                                 n
                                 −
                                 1
                                 )
                                 ,
                              
                           
                         for which 
                           
                              
                                 f
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 f
                              
                              
                                 2
                              
                           
                           +
                           …
                           +
                           
                              
                                 f
                              
                              
                                 n
                                 −
                                 1
                              
                           
                           +
                           
                              
                                 f
                              
                              
                                 n
                              
                           
                           =
                           f
                        .

We can introduce two different methods for the Fibonacci level-based vector median filtering of 
                           
                              f
                              ̲
                           
                         by processing the binary signals in canonical representation, 
                           
                              g
                              ̲
                           
                        .


                        1st method 
                        (Vector median (VM) filtering):
                           
                              (22)
                              
                                 Φ
                                 :
                                 
                                    g
                                    ̲
                                 
                                 →
                                 
                                    VM
                                 
                                 
                                    g
                                    ̲
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             M
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             M
                                             
                                                
                                                   g
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             …
                                          
                                       
                                       
                                          
                                             M
                                             
                                                
                                                   g
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             M
                                             
                                                
                                                   g
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                 →
                                 
                                    VM
                                 
                                 
                                    f
                                    ̲
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             M
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             M
                                             
                                                
                                                   f
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             …
                                          
                                       
                                       
                                          
                                             M
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             M
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         In this case, 
                           M
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 u
                              
                              
                                 M
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        , 
                           k
                           =
                           1
                           :
                           m
                        .

As an example, we consider the signal 
                           f
                           (
                           x
                           )
                           =
                           {
                           0
                           ,
                           1
                           ,
                           4
                           ,
                           4
                           ,
                           5
                           ,
                           8
                           ,
                           11
                           ,
                           11
                           ,
                           11
                           ,
                           10
                           ,
                           
                              6
                              ̲
                           
                           ,
                           5
                           ,
                           4
                           ,
                           2
                           ,
                           8
                           ,
                           13
                           ,
                           16
                           ,
                           11
                           ,
                           7
                           ,
                           0
                           ,
                           0
                           }
                         considered above. For this signal, the following vector representation holds:
                           
                              
                                 
                                    g
                                    ̲
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             1
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             3
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             3
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             4
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             5
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             5
                                          
                                       
                                       
                                          
                                             3
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             5
                                          
                                       
                                       
                                          
                                             3
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    (
                                    
                                       
                                          
                                             5
                                          
                                       
                                       
                                          
                                             3
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             5
                                          
                                       
                                       
                                          
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       (
                                       
                                          
                                             
                                                4
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    ̲
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             4
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             3
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             2
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             5
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             6
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    (
                                    
                                       
                                          
                                             6
                                          
                                       
                                       
                                          
                                             3
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             5
                                          
                                       
                                       
                                          
                                             3
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             4
                                          
                                       
                                       
                                          
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    f
                                    ̲
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             1
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             3
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             3
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             5
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             8
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             8
                                          
                                       
                                       
                                          
                                             3
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             8
                                          
                                       
                                       
                                          
                                             3
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    (
                                    
                                       
                                          
                                             8
                                          
                                       
                                       
                                          
                                             3
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             8
                                          
                                       
                                       
                                          
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       (
                                       
                                          
                                             
                                                5
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    ̲
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             5
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             3
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             2
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             8
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             13
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    (
                                    
                                       
                                          
                                             13
                                          
                                       
                                       
                                          
                                             3
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             8
                                          
                                       
                                       
                                          
                                             3
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             5
                                          
                                       
                                       
                                          
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         For instance, in the point 
                           x
                           =
                           11
                        , for the vector median filtering with window of size 3, we obtain the following:
                           
                              (23)
                              
                                 (
                                 
                                    VM
                                 
                                 
                                    g
                                    ̲
                                 
                                 )
                                 (
                                 11
                                 )
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             4
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 
                                 →
                                 
                                 (
                                 
                                    VM
                                 
                                 
                                    f
                                    ̲
                                 
                                 )
                                 (
                                 11
                                 )
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             5
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     


                        2nd method 
                        (Vector-to-1D median filtering):
                           
                              (24)
                              
                                 Φ
                                 :
                                 
                                    g
                                    ̲
                                 
                                 
                                 →
                                 
                                 M
                                 
                                    g
                                    ̲
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             M
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             M
                                             
                                                
                                                   g
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             …
                                          
                                       
                                       
                                          
                                             M
                                             
                                                
                                                   g
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             M
                                             
                                                
                                                   g
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                 →
                                 
                                 
                                    
                                       M
                                    
                                    
                                       ˆ
                                    
                                 
                                 f
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       M
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       u
                                    
                                    
                                       M
                                       
                                          
                                             g
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       u
                                    
                                    
                                       M
                                       
                                          
                                             g
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       u
                                    
                                    
                                       M
                                       
                                          
                                             g
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

It is not difficult to see, that such a median filtration by a few the Fibonacci levels may differ from the traditional median filtering 
                           f
                           →
                           M
                           f
                         which is calculated by all binary signals. This difference is not significant and, in general, the results of both filtration are very similar. As an example, we consider the same signal 
                           f
                           (
                           x
                           )
                         considered above. We can see that at the point 
                           x
                           =
                           11
                        , 
                           M
                           g
                           (
                           x
                           )
                           =
                           4
                        , and 
                           M
                           f
                           (
                           x
                           )
                           =
                           5
                        , for the median filtering with window of size 3. Using the vector median filter, VM, with this window, we obtain in (23)
                        
                           
                              
                                 (
                                 
                                    VM
                                 
                                 
                                    g
                                    ̲
                                 
                                 )
                                 (
                                 11
                                 )
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             4
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 (
                                 
                                    VM
                                 
                                 
                                    f
                                    ̲
                                 
                                 )
                                 (
                                 11
                                 )
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             5
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         and 
                           
                              
                                 u
                              
                              
                                 4
                              
                           
                           +
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           =
                           6
                           ≠
                           5
                        . The output data for the vector-to-1D median and median filters are given below together with the signal 
                           f
                           (
                           x
                           )
                        
                        
                           
                              
                                 f
                                 (
                                 x
                                 )
                                 =
                                 {
                                 0
                                 ,
                                 1
                                 ,
                                 4
                                 ,
                                 4
                                 ,
                                 5
                                 ,
                                 8
                                 ,
                                 1
                                 ,
                                 11
                                 ,
                                 11
                                 ,
                                 10
                                 ,
                                 6
                                 ,
                                 5
                                 ,
                                 4
                                 ,
                                 2
                                 ,
                                 8
                                 ,
                                 13
                                 ,
                                 16
                                 ,
                                 
                                 11
                                 ,
                                 7
                                 ,
                                 0
                                 ,
                                 0
                                 }
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       ˆ
                                    
                                 
                                 f
                                 (
                                 x
                                 )
                                 =
                                 {
                                 0
                                 ,
                                 1
                                 ,
                                 4
                                 ,
                                 4
                                 ,
                                 5
                                 ,
                                 8
                                 ,
                                 11
                                 ,
                                 11
                                 ,
                                 11
                                 ,
                                 10
                                 ,
                                 6
                                 ,
                                 
                                    6
                                    ̲
                                 
                                 ,
                                 4
                                 ,
                                 2
                                 ,
                                 8
                                 ,
                                 13
                                 ,
                                 
                                    16
                                    ̲
                                 
                                 ,
                                 
                                 11
                                 ,
                                 7
                                 ,
                                 0
                                 ,
                                 0
                                 }
                                 ,
                              
                           
                        
                        
                           
                              
                                 M
                                 f
                                 (
                                 x
                                 )
                                 =
                                 {
                                 0
                                 ,
                                 1
                                 ,
                                 4
                                 ,
                                 4
                                 ,
                                 5
                                 ,
                                 8
                                 ,
                                 11
                                 ,
                                 11
                                 ,
                                 11
                                 ,
                                 10
                                 ,
                                 6
                                 ,
                                 
                                    5
                                    ̲
                                 
                                 ,
                                 4
                                 ,
                                 2
                                 ,
                                 8
                                 ,
                                 13
                                 ,
                                 
                                    13
                                    ̲
                                 
                                 ,
                                 
                                 11
                                 ,
                                 7
                                 ,
                                 0
                                 ,
                                 0
                                 }
                                 .
                              
                           
                         It should be noted, that the concept of the vector median, not in the above given form but in the 2-D case, was first introduced and used successfully for processing color images in [64] and in mixed median filtration [54].

The traditional median-type filters can also be calculated through a finite union of Fibonacci-level signals. Indeed, every m-valued signal 
                           f
                           (
                           x
                           )
                         can be represented as a finite union (maximum) of signals
                           
                              
                                 f
                                 (
                                 x
                                 )
                                 =
                                 
                                    ⋁
                                    
                                       i
                                       =
                                       1
                                    
                                    k
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ⋁
                                    
                                       i
                                       =
                                       1
                                    
                                    k
                                 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             g
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                 
                                 )
                                 ,
                              
                           
                         such that the following decomposition for the median is fulfilled:
                           
                              
                                 M
                                 f
                                 (
                                 x
                                 )
                                 =
                                 
                                    ⋁
                                    
                                       i
                                       =
                                       1
                                    
                                    k
                                 
                                 M
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ⋁
                                    
                                       i
                                       =
                                       1
                                    
                                    k
                                 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 M
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             g
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                 
                                 )
                                 .
                              
                           
                         Here, 
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                           ,
                           
                           i
                           =
                           1
                           ,
                           …
                           ,
                           k
                        , are Fibonacci integers and 
                           k
                           ≤
                           r
                           (
                           m
                           )
                        .

The example of this composition is shown in Table 4
                         for the 16-level signal 
                           f
                           (
                           x
                           )
                         with the five signals 
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                         which can be used in the signal representation,
                           
                              (25)
                              
                                 f
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 ∨
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 )
                                 ∨
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 x
                                 )
                                 ∨
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 x
                                 )
                                 ∨
                                 
                                    
                                       f
                                    
                                    
                                       5
                                    
                                 
                                 (
                                 x
                                 )
                                 .
                              
                           
                         In this case, the Fibonacci numbers 
                           
                              
                                 n
                              
                              
                                 1
                              
                           
                           =
                           1
                        , 
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           =
                           2
                        , 
                           
                              
                                 n
                              
                              
                                 3
                              
                           
                           =
                           5
                        , 
                           
                              
                                 n
                              
                              
                                 4
                              
                           
                           =
                           8
                        , and 
                           
                              
                                 n
                              
                              
                                 5
                              
                           
                           =
                           13
                        . The corresponding signals 
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                           (
                           x
                           )
                         are considered at points x where 
                           f
                           (
                           x
                           )
                           ≥
                           
                              
                                 n
                              
                              
                                 k
                              
                           
                        , 
                           k
                           =
                           1
                           :
                           5
                        . It is not difficult to verify, that the following expression holds of the median filter:
                           
                              (26)
                              
                                 M
                                 f
                                 (
                                 x
                                 )
                                 =
                                 M
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 ∨
                                 M
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 )
                                 ∨
                                 M
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 x
                                 )
                                 ∨
                                 M
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 x
                                 )
                                 ∨
                                 M
                                 
                                    
                                       f
                                    
                                    
                                       5
                                    
                                 
                                 (
                                 x
                                 )
                                 ,
                                 
                                 x
                                 =
                                 0
                                 :
                                 19
                                 .
                              
                           
                        
                     

The weighted thresholding can be used for designing new morphological filters in image enhancement, segmentation, and edge detection, together with the traditional thresholding [7–15,19,20,62–69]. For example, the processing of edges of the image, when using the difference between the image, f, and its erosion, 
                        (
                        f
                        ⊖
                        B
                        )
                     , by a set B, can also be performed by using the similar difference between the weighted thresholding, 
                        
                           
                              K
                           
                           
                              f
                           
                        
                     , and its erosion 
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        ⊖
                        B
                        )
                     . The general method of using the weighted thresholding for processing the signal or image 
                        f
                        (
                        x
                        )
                      can be described by the following algorithm.


                     
                        
                           Algorithm 4
                           
                              Sequence-based morphological image processing.
                           
                           
                        
                     
                  

This is the classical morphological approach for segmentation, which is based on gradients. It may require the fulfillment of some conditions for existence and uniqueness of such a function 
                        g
                        (
                        x
                        )
                     . Different expressions for gradients are used in image processing such as morphological gradients, half gradients, directional gradients, mosaic gradients, regularized gradients, internal and external gradients and others. These kinds of gradients are potentially useful and are based on operations of dilation and erosion [19,20]. We consider the function-set operations.


                     
                        Definition 4
                        Given an n-dimensional function 
                              f
                              (
                              x
                              )
                            with domain 
                              X
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           , its dilation, 
                              f
                              ⊕
                              B
                           , and erosion, 
                              f
                              ⊖
                              B
                           , by a set B are the following functions:
                              
                                 
                                    (
                                    f
                                    ⊕
                                    B
                                    )
                                    (
                                    x
                                    )
                                    =
                                    
                                       max
                                       
                                          x
                                          ∈
                                          B
                                       
                                    
                                    ⁡
                                    
                                    {
                                    f
                                    (
                                    x
                                    −
                                    b
                                    )
                                    ;
                                    
                                    b
                                    ∈
                                    B
                                    }
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    (
                                    f
                                    ⊖
                                    B
                                    )
                                    (
                                    x
                                    )
                                    =
                                    
                                       min
                                       
                                          x
                                          ∈
                                          B
                                       
                                    
                                    ⁡
                                    
                                    {
                                    f
                                    (
                                    x
                                    −
                                    b
                                    )
                                    ;
                                    
                                    b
                                    ∈
                                    B
                                    }
                                    .
                                 
                              
                            These operations are dual to each other, i.e., 
                              (
                              f
                              ⊖
                              B
                              )
                              (
                              x
                              )
                              =
                              −
                              (
                              −
                              f
                              ⊕
                              B
                              )
                              (
                              x
                              )
                           . The set B is called the structuring element.
                        

In many practical applications, B is considered to be a small window set or disk, respectively in 1-D and 2-D cases. Therefore, the erosion (dilation) of a sampled m-valued signal by a finite window B is equal to the moving local minimum (maximum) of the given signal inside B. The secondary operations of opening, 
                        f
                        ∘
                        B
                     , and closing, 
                        f
                        •
                        B
                     , of 
                        f
                        (
                        x
                        )
                      by B are defined by 
                        (
                        f
                        ⊖
                        B
                        )
                        ⊕
                        B
                      and 
                        (
                        f
                        ⊕
                        B
                        )
                        ⊖
                        B
                     , respectively. Consider the following three gradients:
                        
                           (27)
                           
                              f
                              →
                              G
                              (
                              f
                              )
                              =
                              
                                 {
                                 
                                    
                                       
                                          
                                             EG
                                          
                                          (
                                          f
                                          )
                                          =
                                          f
                                          −
                                          f
                                          ⊖
                                          B
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             DG
                                          
                                          (
                                          f
                                          )
                                          =
                                          f
                                          ⊕
                                          B
                                          −
                                          f
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             SG
                                          
                                          (
                                          f
                                          )
                                          =
                                          f
                                          ⊕
                                          B
                                          −
                                          f
                                          ⊖
                                          B
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

The weighted thresholding 
                        {
                        (
                        k
                        (
                        α
                        )
                        ,
                        
                           
                              f
                           
                           
                              α
                           
                        
                        (
                        x
                        )
                        )
                        }
                        →
                        
                           
                              K
                           
                           
                              f
                           
                        
                        (
                        x
                        )
                      is invariant relative to many morphological operations, M, which include the erosion and dilation, opening and closing. Therefore the following is valid:
                        
                           (28)
                           
                              M
                              f
                              =
                              
                                 ∑
                                 
                                    α
                                    =
                                    1
                                 
                                 L
                              
                              
                                 1
                                 
                                    k
                                    (
                                    α
                                    )
                                 
                              
                              M
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    α
                                 
                              
                              .
                           
                        
                      In other words, when the input gray-level signal is represented as the sum of its m-valued images, the M-filtered signal is represented by a linear combination of M-filtered m-valued images. The case 
                        k
                        (
                        α
                        )
                        ≡
                        1
                      has been described by Maragos [68,69]. In general, the mentioned invariance can be written as
                        
                           (29)
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 ⊖
                                 B
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       f
                                       ⊖
                                       B
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 ⊕
                                 B
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       f
                                       ⊕
                                       B
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 ∘
                                 B
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       f
                                       ∘
                                       B
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       K
                                    
                                    
                                       f
                                    
                                 
                                 •
                                 B
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       f
                                       •
                                       B
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Indeed, for the operations of the dilation and erosion of function by a set B, the following well-known equalities hold 
                        
                           
                              (
                              f
                              ⊖
                              B
                              )
                           
                           
                              α
                           
                        
                        =
                        
                           
                              f
                           
                           
                              α
                           
                        
                        ⊖
                        B
                      and 
                        
                           
                              (
                              f
                              ⊕
                              B
                              )
                           
                           
                              α
                           
                        
                        =
                        
                           
                              f
                           
                           
                              α
                           
                        
                        ⊕
                        B
                     , for all numbers 
                        α
                        ∈
                        (
                        −
                        ∞
                        ,
                        +
                        ∞
                        )
                     . Assume that 
                        k
                        (
                        α
                        )
                      are monotonically non-decreasing sequence. Then, denoting by
                        
                           (30)
                           
                              
                                 
                                    b
                                 
                                 
                                    α
                                 
                              
                              =
                              
                                 ∑
                                 
                                    β
                                    ≤
                                    α
                                 
                              
                              k
                              (
                              β
                              )
                              ,
                              
                              α
                              ≤
                              L
                              ,
                           
                        
                      and by 
                        
                           
                              g
                           
                           
                              β
                           
                        
                      the binary function 
                        
                           
                              g
                           
                           
                              β
                           
                        
                        (
                        x
                        )
                        =
                        
                           
                              f
                           
                           
                              α
                           
                        
                        (
                        x
                        )
                     , if 
                        
                           
                              b
                           
                           
                              α
                           
                        
                        <
                        β
                        ≤
                        
                           
                              b
                           
                           
                              α
                              +
                              1
                           
                        
                     , we can see that
                        
                           (31)
                           
                              
                                 ∑
                                 
                                    α
                                    ≤
                                    n
                                 
                              
                              k
                              (
                              α
                              )
                              
                                 
                                    f
                                 
                                 
                                    α
                                 
                              
                              =
                              
                                 ∑
                                 
                                    β
                                    ≤
                                    
                                       
                                          b
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    β
                                 
                              
                              ,
                              
                              for all 
                              
                              n
                              ≤
                              L
                              .
                           
                        
                     
                  

We can note that 
                        
                           
                              g
                           
                           
                              β
                           
                        
                      are the binary images of the function 
                        
                           
                              K
                           
                           
                              f
                           
                        
                     , i.e., 
                        
                           
                              (
                              
                                 
                                    K
                                 
                                 
                                    f
                                 
                              
                              )
                           
                           
                              β
                           
                        
                        =
                        
                           
                              g
                           
                           
                              β
                           
                        
                     . The following calculations are valid:
                        
                           
                              
                                 
                                    K
                                 
                                 
                                    f
                                 
                              
                              ⊖
                              B
                              =
                              (
                              
                                 ∑
                                 α
                              
                              k
                              (
                              α
                              )
                              
                                 
                                    f
                                 
                                 
                                    α
                                 
                              
                              )
                              ⊖
                              B
                              =
                              (
                              
                                 ∑
                                 β
                              
                              
                                 
                                    g
                                 
                                 
                                    β
                                 
                              
                              )
                              ⊖
                              B
                              =
                              
                                 ∑
                                 β
                              
                              (
                              
                                 
                                    g
                                 
                                 
                                    β
                                 
                              
                              ⊖
                              B
                              )
                              =
                              
                                 ∑
                                 α
                              
                              
                                 ∑
                                 
                                    
                                       
                                          b
                                       
                                       
                                          α
                                       
                                    
                                    <
                                    β
                                    ≤
                                    
                                       
                                          b
                                       
                                       
                                          a
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    β
                                 
                              
                              ⊖
                              B
                              =
                              
                                 ∑
                                 α
                              
                              k
                              (
                              α
                              )
                              (
                              
                                 
                                    g
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          a
                                          +
                                          1
                                       
                                    
                                 
                              
                              ⊖
                              B
                              )
                              =
                              
                                 ∑
                                 α
                              
                              k
                              (
                              α
                              )
                              (
                              
                                 
                                    f
                                 
                                 
                                    α
                                 
                              
                              ⊖
                              B
                              )
                              =
                              
                                 ∑
                                 α
                              
                              k
                              (
                              α
                              )
                              
                                 
                                    (
                                    f
                                    ⊖
                                    B
                                    )
                                 
                                 
                                    α
                                 
                              
                              =
                              
                                 
                                    K
                                 
                                 
                                    f
                                    ⊖
                                    B
                                 
                              
                              .
                           
                        
                     
                  

As example, let the set B be 
                        {
                        −
                        1
                        ,
                        0
                        ,
                        1
                        }
                      with the center at 0, and let the arithmetic series be 
                        k
                        (
                        α
                        )
                        =
                        1
                        ,
                        2
                        ,
                        3
                        ,
                        4
                        ,
                        …
                      . The following operations are valid over the given signal f:
                        
                           
                              f
                              =
                              {
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              1
                              ,
                              4
                              ,
                              3
                              ,
                              5
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              }
                              ,
                              
                              f
                              ⊖
                              B
                              =
                              {
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              3
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              }
                              ,
                              
                              
                                 
                                    K
                                 
                                 
                                    f
                                    ⊖
                                    B
                                 
                              
                              =
                              {
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              6
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              }
                              ,
                              
                              
                                 
                                    K
                                 
                                 
                                    f
                                 
                              
                              =
                              {
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              3
                              ,
                              1
                              ,
                              10
                              ,
                              6
                              ,
                              15
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              }
                              ,
                              
                              
                                 
                                    K
                                 
                                 
                                    f
                                 
                              
                              ⊖
                              B
                              =
                              {
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              
                              1
                              ,
                              
                              6
                              ,
                              
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              }
                              .
                           
                        
                     
                  

Similar equalities of (29) can be proved for the dilation operation and opening and closing systems. For the median filter, 
                        M
                        =
                        
                           Med
                        
                     , with a window B, we can also write that 
                        
                           Med
                        
                        [
                        
                           
                              K
                           
                           
                              f
                           
                        
                        ]
                        =
                        
                           
                              K
                           
                           
                              
                                 Med
                              
                              [
                              f
                              ]
                           
                        
                     , due to the calculations
                        
                           
                              
                                 Med
                              
                              [
                              
                                 
                                    K
                                 
                                 
                                    f
                                 
                              
                              ]
                              =
                              
                                 Med
                              
                              (
                              
                                 ∑
                                 α
                              
                              k
                              (
                              α
                              )
                              
                                 
                                    f
                                 
                                 
                                    α
                                 
                              
                              )
                              =
                              
                                 Med
                              
                              (
                              
                                 ∑
                                 β
                              
                              
                                 
                                    g
                                 
                                 
                                    β
                                 
                              
                              )
                              =
                              
                                 ∑
                                 β
                              
                              
                                 Med
                              
                              [
                              
                                 
                                    g
                                 
                                 
                                    β
                                 
                              
                              ]
                              =
                              
                                 ∑
                                 α
                              
                              k
                              (
                              α
                              )
                              
                                 Med
                              
                              [
                              
                                 
                                    f
                                 
                                 
                                    α
                                 
                              
                              ]
                              =
                              
                                 
                                    K
                                 
                                 
                                    
                                       Med
                                    
                                    [
                                    f
                                    ]
                                 
                              
                              .
                           
                        
                     
                  

Our preliminary experimental results show that the sequences of numbers 
                        k
                        (
                        α
                        )
                     , which includes the arithmetical, geometrical, 2-in-4, and Fibonacci series, are very effective when compared with other mentioned above cases. Together with the traditional erosion and dilation gradient operators 
                        
                           EG
                        
                        (
                        f
                        )
                        =
                        f
                        −
                        f
                        ⊖
                        B
                      and 
                        
                           DG
                        
                        (
                        f
                        )
                        =
                        f
                        ⊕
                        B
                        −
                        f
                     , the similar erosion and dilation operators over the weighted thresholding can be considered, 
                        
                           EG
                        
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        )
                        =
                        
                           
                              K
                           
                           
                              f
                           
                        
                        −
                        
                           
                              K
                           
                           
                              f
                           
                        
                        ⊖
                        B
                      and 
                        
                           DG
                        
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        )
                        =
                        
                           
                              K
                           
                           
                              f
                           
                        
                        ⊕
                        B
                        −
                        
                           
                              K
                           
                           
                              f
                           
                        
                     . The corresponding estimates of gradients 
                        E
                        Δ
                        (
                        f
                        )
                      and 
                        D
                        Δ
                        (
                        f
                        )
                      of signal f are defined by 
                        
                           
                              K
                           
                           
                              E
                              Δ
                              (
                              f
                              )
                           
                        
                        (
                        x
                        )
                        =
                        
                           EG
                        
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        )
                        (
                        x
                        )
                      and 
                        
                           
                              K
                           
                           
                              D
                              Δ
                              (
                              f
                              )
                           
                        
                        (
                        x
                        )
                        =
                        
                           DG
                        
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        )
                        (
                        x
                        )
                     .

For the above example with the signal f and the set 
                        B
                        =
                        {
                        −
                        1
                        ,
                        0
                        ,
                        1
                        }
                     , we obtain the following gradients:
                        
                           
                              f
                              =
                              {
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              1
                              ,
                              4
                              ,
                              3
                              ,
                              
                              5
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              }
                              ,
                              
                              
                                 EG
                              
                              (
                              f
                              )
                              =
                              {
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              3
                              ,
                              0
                              ,
                              
                              4
                              ,
                              0
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              }
                              ,
                              
                              
                                 EG
                              
                              (
                              
                                 
                                    K
                                 
                                 
                                    f
                                 
                              
                              )
                              =
                              {
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              0
                              ,
                              9
                              ,
                              0
                              ,
                              14
                              ,
                              0
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              }
                              .
                           
                        
                      Using the direct formula of calculation of multi-valued images 
                        
                           
                              
                                 
                                    f
                                 
                                 
                                    ¯
                                 
                              
                           
                           
                              α
                           
                        
                        (
                        x
                        )
                     , we obtain the estimate from the following table:
                        
                           
                              
                                 
                                    
                                       
                                          EG
                                       
                                       (
                                       
                                          
                                             K
                                          
                                          
                                             f
                                          
                                       
                                       )
                                       =
                                       {
                                       
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                    
                                       0
                                    
                                    
                                       9
                                    
                                    
                                       0
                                    
                                    
                                       14
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       0
                                       
                                       }
                                       
                                       
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       {
                                       
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       0
                                       
                                       }
                                       ×
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       {
                                       
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       
                                          
                                             .
                                             5
                                          
                                          ̲
                                       
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                       
                                       }
                                       ×
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       {
                                       
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                       
                                       }
                                       ×
                                       3
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             4
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       {
                                       
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       
                                          
                                             .
                                             75
                                          
                                          ̲
                                       
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                       
                                       }
                                       ×
                                       4
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             5
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       {
                                       
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       
                                          
                                             .
                                             8
                                          
                                          ̲
                                       
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                       
                                       }
                                       ×
                                       5
                                    
                                 
                                 
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             A
                                          
                                       
                                       f
                                       =
                                       {
                                       
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       
                                          1.5
                                          ̲
                                       
                                    
                                    
                                       0
                                    
                                    
                                       
                                          3.75
                                          ̲
                                       
                                    
                                    
                                       0
                                    
                                    
                                       
                                          4.8
                                          ̲
                                       
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       0
                                       
                                       }
                                       
                                       
                                       
                                       
                                    
                                 
                              
                           
                        
                      For the binary signals, the rounding of these data results in 
                        
                           
                              Δ
                           
                           
                              A
                           
                        
                        f
                      as follows:
                        
                           
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       {
                                       
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       0
                                       
                                       }
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       {
                                       
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       
                                          1
                                          ̲
                                       
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                       
                                       }
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       {
                                       
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                       
                                       }
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             4
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       {
                                       
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       
                                          1
                                          ̲
                                       
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                       
                                       }
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             5
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       {
                                       
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       
                                          1
                                          ̲
                                       
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       0
                                       
                                       }
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             A
                                          
                                       
                                       f
                                       =
                                       {
                                       
                                       0
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                    
                                       0
                                    
                                    
                                       4
                                    
                                    
                                       0
                                    
                                    
                                       5
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                    
                                       0
                                       
                                       }
                                       .
                                    
                                 
                              
                           
                        
                      One can see that 
                        
                           
                              Δ
                           
                           
                              A
                           
                        
                        f
                        ≥
                        
                           EG
                        
                        (
                        f
                        )
                     , and 
                        
                           
                              Δ
                           
                           
                              A
                           
                        
                        f
                        >
                        
                           EG
                        
                        (
                        f
                        )
                      at the points with peaks over 1.

When the weighted thresholding by the sequence of Fibonacci numbers, the following data are obtained:
                        
                           
                              f
                              =
                              {
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              1
                              ,
                              4
                              ,
                              3
                              ,
                              
                              
                              5
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              }
                              
                                 
                                    K
                                 
                                 
                                    f
                                 
                              
                              =
                              {
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              1
                              ,
                              7
                              ,
                              4
                              ,
                              12
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              }
                              
                                 
                                    K
                                 
                                 
                                    f
                                 
                              
                              ⊖
                              B
                              =
                              {
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              4
                              ,
                              
                              
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              }
                              
                                 EG
                              
                              (
                              
                                 
                                    K
                                 
                                 
                                    f
                                 
                              
                              )
                              =
                              {
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              6
                              ,
                              0
                              ,
                              11
                              ,
                              0
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              }
                              
                                 
                                    Δ
                                 
                                 
                                    F
                                 
                              
                              f
                              =
                              {
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              4
                              ,
                              0
                              ,
                              
                              
                              5
                              ,
                              0
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              }
                              .
                           
                        
                      The gradient is calculated by using the simple relation 
                        
                           EG
                        
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        )
                        (
                        x
                        )
                        =
                        k
                        (
                        
                           
                              Δ
                           
                           
                              F
                           
                        
                        f
                        (
                        x
                        )
                        +
                        2
                        )
                        −
                        1
                     , which is similar to the well-known formula 
                        
                           
                              K
                           
                           
                              f
                           
                        
                        (
                        x
                        )
                        =
                        k
                        (
                        f
                        (
                        x
                        )
                        +
                        2
                        )
                        −
                        1
                     .

The weighted thresholding by the sequences of arithmetic series and Fibonacci numbers give almost the same results. The calculation by means of the Fibonacci numbers is simple and does not require rounding operation. Comparing the obtained results for the erosion weighted thresholding gradients, one can see that both methods of enhancement of the signal f give the better results than the standard morphological gradients. As an example in the 2-D case, we consider application of the weighted thresholding in processing the gradients for the cell image shown in Fig. 24
                     .


                     Fig. 25
                      shows the gradient of the image 
                        
                           SG
                        
                        (
                        f
                        )
                        =
                        (
                        f
                        ⊕
                        B
                        )
                        −
                        (
                        f
                        ⊖
                        B
                        )
                      in part a, which is calculated with the structuring element B being the square 
                        3
                        ×
                        3
                     . The corresponding weighted thresholded gradient 
                        
                           SG
                        
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        )
                      calculated with the same set B is shown in b. The weighted sequence 
                        k
                        (
                        α
                        )
                      is arithmetical, i.e., 
                        1
                        ,
                        2
                        ,
                        3
                        ,
                        4
                        ,
                        5
                        ,
                        …
                      .

The similar processing of the gradients for the cell image, when the structuring element B is disk of radius 1, which is also the cross window 
                        3
                        ×
                        3
                     , is demonstrated in Fig. 26
                     . The gradient of the image 
                        
                           SG
                        
                        (
                        f
                        )
                      is shown in part a, along with the weighted thresholded gradient 
                        
                           SG
                        
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        )
                      in b.

One can see form both figures, that the images processed by the weighted thresholding show better results, when compared with the traditional gradient operation 
                        
                           
                              G
                           
                           
                              2
                           
                        
                        (
                        f
                        )
                     . The weighted thresholding allows to extract contours of the cells, and in addition this operation works as a filter cleaning the image outside the cells.

The similar results are shown in the next figures after processing stacked images by fluorescence in situ hybridization (FISH) for detection of gene copy numbers in cancer and other diseases [73,74]. Fig. 27
                      shows the maximum images of green and red channels of the stack87 FISH image in parts a and b, respectively. Both images are of size 
                        656
                        ×
                        517
                     . For the green channel of the FISH image, Fig. 28
                      shows the gradient image 
                        
                           SG
                        
                        (
                        f
                        )
                      in part a and the weighted thresholded gradient 
                        
                           SG
                        
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        )
                      in b. The results of processing the red channel of the FISH image by the gradient of the image 
                        
                           SG
                        
                        (
                        f
                        )
                      and the weighted thresholded gradient 
                        
                           SG
                        
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        )
                      are shown in Fig. 29
                      in parts a and b, respectively.

Now, we consider natural images. Fig. 30
                      shows the image f of size 
                        640
                        ×
                        1024
                      in part a, together with the gradients images 
                        
                           SG
                        
                        (
                        f
                        )
                      and 
                        
                           SG
                        
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        )
                      in b and c, respectively.

The difference between the gradient operations 
                        
                           SG
                        
                        (
                        f
                        )
                      and 
                        
                           SG
                        
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        )
                      also can be seen well in images shown in the next figures. Fig. 31
                      shows two different images of size 
                        640
                        ×
                        1024
                      and 
                        521
                        ×
                        800
                      in parts a and b, respectively. The results of processing the first image with the gradient and weighed gradient images 
                        
                           SG
                        
                        (
                        f
                        )
                      and 
                        
                           SG
                        
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        )
                      are shown in Fig. 32
                      in parts a and b, respectively. Fig. 33
                      shows gradient images 
                        
                           SG
                        
                        (
                        f
                        )
                      and 
                        
                           SG
                        
                        (
                        
                           
                              K
                           
                           
                              f
                           
                        
                        )
                      of the second image of Fig. 31 in parts a and b, respectively. The disk of radius 1 was used for these images, as the structuring element B.

@&#CONCLUSION@&#

We describe a unified approach for signal thresholding, by introducing the general concept of weighted thresholding by monotonic sequences for signal and image set-theoretical representation. Examples of the weighed thresholding include the thresholding with arithmetical series, histogram equalization, series of Fibonacci numbers, sequences of the 2-in-4 and Fibonacci numbers. The main advantage of such a representation is that it allows for the implementation of nonlinear operations by a weighted threshold, enhancing many geometrical features that present in the original signals and images by manipulating the weighted coefficients. The weighted thresholding is invariant under morphological transforms which include the erosion and dilation, opening, closing, and median. Examples of image enhancement, denoising and segmentation were given. On the base of the weighted thresholding, new algorithms can be developed for efficient calculation and representation of nonlinear filters (for instance the median type filters), for image enhancement and segmentation. The preliminary study shows, that the weighted thresholding is very promising in terms of high performance for signal and image processing applications. In the future work, there could be the following directions: a) to extend the presented concepts on color images and videos; b) to improve proposed method by incorporating with a modified coarse image representation techniques developed in [75]; c) to make the proposed method more efficient by using a bio-inspired and complex signal processing optical flow algorithm, acting as a bridge between software and hardware [76,77].

@&#REFERENCES@&#

