@&#MAIN-TITLE@&#A linear programming approach for linear programs with probabilistic constraints

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Heuristics for chance constrained programs with random right-hand side vectors.


                        
                        
                           
                           Efficient algorithms for scenarios with non-equal probabilities.


                        
                        
                           
                           Computational experiments compare against the best known exact solution methods.


                        
                        
                           
                           Near optimal solutions for problems that are currently intractable using MIP alone.


                        
                        
                           
                           Demonstrates where heuristics fail, highlighting the difficulty of solving CCPs.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Linear programming

Integer programming

Stochastic programming

Chance constrained programming

Heuristics

@&#ABSTRACT@&#


               
               
                  We study a class of mixed-integer programs for solving linear programs with joint probabilistic constraints from random right-hand side vectors with finite distributions. We present greedy and dual heuristic algorithms that construct and solve a sequence of linear programs. We provide optimality gaps for our heuristic solutions via the linear programming relaxation of the extended mixed-integer formulation of Luedtke et al. (2010) [13] as well as via lower bounds produced by their cutting plane method. While we demonstrate through an extensive computational study the effectiveness and scalability of our heuristics, we also prove that the theoretical worst-case solution quality for these algorithms is arbitrarily far from optimal. Our computational study compares our heuristics against both the extended mixed-integer programming formulation and the cutting plane method of Luedtke et al. (2010) [13]. Our heuristics efficiently and consistently produce solutions with small optimality gaps, while for larger instances the extended formulation becomes intractable and the optimality gaps from the cutting plane method increase to over 5%.
               
            

@&#INTRODUCTION@&#

Consider a linear program with a joint probabilistic or chance constraint
                     
                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   x
                                                   ∈
                                                   X
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          cx
                                       
                                    
                                 
                                 
                                    
                                       
                                          s.t.
                                       
                                    
                                    
                                       
                                          
                                          P
                                          (
                                          Ax
                                          ⩾
                                          
                                             
                                                b
                                             
                                             
                                                ̃
                                             
                                          
                                          )
                                          ⩾
                                          1
                                          -
                                          ε
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           X
                           ⊆
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        
                      is a polyhedron, 
                        
                           c
                           ∈
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                           ,
                           A
                           ∈
                           
                              
                                 R
                              
                              
                                 m
                                 ×
                                 d
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 ̃
                              
                           
                        
                      is a random vector taking values in 
                        
                           
                              
                                 R
                              
                              
                                 m
                              
                           
                        
                      and ε
                     ∈(0,1) is the reliability level.

Chance constrained models have been utilized in several applications. In the context of finance (see [19]), the joint probabilistic constraint is commonly referred to as a Value-at-Risk constraint. In supply chain management [10], these models are used to consider random supply and demand. In distillation processes [7], chance constraints are used to analyze random water inflows. Optimal vaccination strategies for preventing epidemics [20] is yet another area where chance constrained models have been applied. For additional references, we refer the reader to [17].

Problems with joint probabilistic constraints (1) can be grouped into one of the following two categories:
                        
                           1.
                           The distribution of 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ̃
                                       
                                    
                                 
                               is discrete and finite.

The distribution of 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ̃
                                       
                                    
                                 
                               is continuous or infinite.

Case 1 problems can at least in theory be solved to optimality, by using binary variables to cast the problems as mixed-integer programs with “big-M constraints” [18,15]. However, in practice, this approach may have limited computational tractability in some settings.

For case 2, aside from a few select distributions, no closed-form exists for evaluating 
                        
                           P
                           (
                           Ax
                           ⩾
                           
                              
                                 b
                              
                              
                                 ̃
                              
                           
                           )
                        
                      for a given candidate solution x, which prevents us from solving these problems to optimality. In lieu of exact solution methods, recent attention has focused on gradient methods [6] and on approximation methods that utilize Monte Carlo sampling [2,15,8]. The latter yields case 1 problems [12,16], which can then be solved either through mixed-integer programming [11] or through heuristic algorithms.

In this paper, we build upon the work in Pagnoncelli et al. [16] to develop specialized heuristics for case 1 problems.

Luedtke et al. [13] proved that the case 1 problems are NP-hard and to solve them they developed both a cutting plane algorithm and an extended mixed-integer programming formulation, which is a specialization of work by Miller and Wolsey [14], where all integer variables are binary. Luedtke et al. [13] leverage a natural ordering in the right-hand side to overcome the weakness of the big-M formulation. This inherent ordering has been utilized before in case 2 problems to develop a branch-and-bound algorithm [3] and we will also leverage this ordering in developing our linear programming based heuristic algorithms.

Although we focus on case 1 problems, the algorithms we develop in this paper will have direct applicability to case 2 problems when used in conjunction with sampling approaches. We compare our algorithms with the cutting plane method and extended mixed-integer programming formulation of Luedtke et al. [13]. We show that while their extended formulation becomes intractable for larger problems and their cutting plane method produces increasing optimality gaps, our heuristics remain efficient and provide near-optimal solutions.

The remainder of this paper is organized as follows. Section 2 introduces the mixed-integer programming problem that we aim to solve and presents the extended formulation of Luedtke et al. [13]. (We refer the reader to Luedtke et al. [13] and Atamtürk et al. [1] for detail on the cutting plane method.) In Section 3, we present our greedy and dual heuristic. In Section 4, we prove that the worst-case solution quality for our heuristic algorithms is arbitrarily far from optimal. In Section 5, we present a computational study that compares our algorithms with the extended formulation and the cutting plane method. Section 6 summarizes our contributions and discusses future research directions.

@&#BACKGROUND@&#

Consider case 1 of chance constrained problem (1), where the distribution of the right-hand side 
                        
                           
                              
                                 b
                              
                              
                                 ̃
                              
                           
                        
                      is discrete and has scenarios b
                     
                        ω
                      with corresponding probabilities p
                     
                        ω
                      for all ω
                     ∈
                     Ω. For simplicity, without loss of generality, we assume that b
                     
                        ω
                     
                     ⩾0 for all ω
                     ∈
                     Ω. By introducing ∣Ω∣ binary variables, we can restate this problem as a mixed-integer program with the following big-M formulation:
                        
                           (2)
                           
                              (
                              big-M
                              )
                              
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                       ∈
                                       X
                                    
                                 
                              
                              
                              cx
                           
                        
                     
                     
                        
                           (3)
                           
                              
                              
                              
                              s
                              .
                              t
                              .
                              
                              Ax
                              +
                              
                                 
                                    z
                                 
                                 
                                    ω
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    ω
                                 
                              
                              ⩾
                              
                                 
                                    b
                                 
                                 
                                    ω
                                 
                              
                              
                              ω
                              ∈
                              Ω
                           
                        
                     
                     
                        
                           (4)
                           
                              
                              
                              
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       ω
                                       ∈
                                       Ω
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    ω
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    ω
                                 
                              
                              ⩽
                              ε
                           
                        
                     
                     
                        
                           (5)
                           
                              
                              
                              
                              
                              z
                              ∈
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 
                                    |
                                    Ω
                                    |
                                 
                              
                              ,
                           
                        
                     where the big-M constant is b
                     
                        ω
                     , for each ω. If binary variable z
                     
                        ω
                     
                     =0, then Ax
                     ⩾
                     b
                     
                        ω
                      (⩾ 0 by assumption). If z
                     
                        ω
                     
                     =1, then we have Ax
                     ⩾0, which is satisfied because ε
                     <1 implies that there will be at least one ω
                     ∈
                     Ω such that z
                     
                        ω
                     
                     =0. The knapsack inequality (4) is equivalent to the probabilistic constraint
                        
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       ω
                                       ∈
                                       Ω
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    ω
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    z
                                 
                                 
                                    ω
                                 
                              
                              )
                              ⩾
                              1
                              -
                              ε
                              .
                           
                        
                     
                  

Consider a single row in the big-M formulation (3):
                           
                              (6)
                              
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 x
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       ω
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       ω
                                    
                                 
                                 ⩾
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       ω
                                    
                                 
                                 
                                 ω
                                 ∈
                                 Ω
                                 ,
                              
                           
                        where A
                        
                           i
                         is the ith row of the constraint matrix A and 
                           
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                                 
                                    ω
                                 
                              
                           
                         is the ith row of the right-hand side scenario b
                        
                           ω
                        . Let ω(i,
                        k) be the scenario with kth largest right-hand side 
                           
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                                 
                                    ω
                                    (
                                    i
                                    ,
                                    k
                                    )
                                 
                              
                           
                         for row i. Then for every row, there exists an index l
                        
                           i
                         such that
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       ω
                                       (
                                       i
                                       ,
                                       k
                                       )
                                    
                                 
                                 ⩽
                                 ε
                                 <
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       ω
                                       (
                                       i
                                       ,
                                       k
                                       )
                                    
                                 
                                 .
                              
                           
                        In other words, it would not be possible to remove all scenarios {ω(i,1),…,
                        ω(i,
                        l
                        
                           i
                        )} without exceeding ε; however, it would be possible to remove all scenarios {ω(i,1),…,
                        ω(i,
                        l
                        
                           i
                        
                        −1)}. Therefore, any feasible solution x to case 1 of problem (1) must satisfy
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 x
                                 ⩾
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       ω
                                       (
                                       i
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                 for
                                 
                                 all
                                 
                                 i
                                 ∈
                                 I
                                 .
                              
                           
                        
                     

Using l
                        
                           i
                         and w(i,k), we can replace the big-M formulation (2)–(5) with the following tight-M mixed-integer program:
                           
                              (7)
                              
                                 (
                                 tight-M
                                 )
                                 
                                 
                                    
                                       
                                          min
                                       
                                       
                                          x
                                          ∈
                                          X
                                       
                                    
                                 
                                 
                                 cx
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                 
                                 
                                 
                                 s
                                 .
                                 t
                                 .
                                 
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 x
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       ω
                                       (
                                       i
                                       ,
                                       k
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                i
                                             
                                             
                                                ω
                                                (
                                                i
                                                ,
                                                k
                                                )
                                             
                                          
                                          -
                                          
                                             
                                                b
                                             
                                             
                                                i
                                             
                                             
                                                ω
                                                (
                                                i
                                                ,
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       ω
                                       (
                                       i
                                       ,
                                       k
                                       )
                                    
                                 
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 1
                                 ⩽
                                 k
                                 ⩽
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 1
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          ω
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       ω
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ω
                                    
                                 
                                 ⩽
                                 ε
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                 
                                 
                                 
                                 z
                                 ∈
                                 
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                       |
                                       Ω
                                       |
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                                 
                                    ω
                                    (
                                    i
                                    ,
                                    k
                                    )
                                 
                              
                              -
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                                 
                                    ω
                                    (
                                    i
                                    ,
                                    
                                       
                                          l
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                           
                         strengthens the formulation and 1⩽
                        k
                        ⩽
                        l
                        
                           i
                        
                        −1 avoids the redundant constraints that were identified in ordering the scenarios according to row. For more detail on the tight-M formulation (7)–(10) and on additional valid inequalities that can be used to strengthen it, we refer the reader to Luedtke et al. [13] and to work on mixing sets by Atamtürk et al. [1], Günlük and Pochet [5], Guan et al. [4], Miller and Wolsey [14] and Küçükyavuz [9].

Luedtke et al. [13] make further use of the ordered scenarios by defining additional binary variables 
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                                 
                                    ω
                                 
                              
                           
                        , for all ω
                        ∈{ω(1,
                        i),…,
                        ω(i,
                        l
                        
                           i
                        )}, to arrive at the following extended mixed-integer programming formulation:
                           
                              (11)
                              
                                 (
                                 extended
                                 )
                                 
                                 
                                    
                                       
                                          min
                                       
                                       
                                          x
                                          ∈
                                          X
                                       
                                    
                                 
                                 
                                 cx
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                 
                                 
                                 s
                                 .
                                 t
                                 .
                                 
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 x
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       ω
                                       (
                                       i
                                       ,
                                       k
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                i
                                             
                                             
                                                ω
                                                (
                                                i
                                                ,
                                                k
                                                )
                                             
                                          
                                          -
                                          
                                             
                                                b
                                             
                                             
                                                i
                                             
                                             
                                                ω
                                                (
                                                i
                                                ,
                                                k
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       ω
                                       (
                                       i
                                       ,
                                       1
                                       )
                                    
                                 
                                 
                                 i
                                 ∈
                                 I
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       ω
                                       (
                                       i
                                       ,
                                       k
                                       )
                                    
                                 
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       ω
                                       (
                                       i
                                       ,
                                       k
                                       +
                                       1
                                       )
                                    
                                 
                                 ⩾
                                 0
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 1
                                 ⩽
                                 k
                                 ⩽
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 1
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ω
                                       (
                                       i
                                       ,
                                       k
                                       )
                                    
                                 
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       ω
                                       (
                                       i
                                       ,
                                       k
                                       )
                                    
                                 
                                 ⩾
                                 0
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 1
                                 ⩽
                                 k
                                 ⩽
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 1
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          ω
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       ω
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ω
                                    
                                 
                                 ⩽
                                 ε
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       ω
                                       (
                                       i
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 0
                                 
                                 i
                                 ∈
                                 I
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       ω
                                       (
                                       i
                                       ,
                                       k
                                       )
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 1
                                 ⩽
                                 k
                                 ⩽
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                 
                                 
                                 
                                 z
                                 ∈
                                 
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                       |
                                       Ω
                                       |
                                    
                                 
                                 ,
                              
                           
                        which they prove is a valid formulation for the tight-M problem (7)–(10). Constraint (13) orders the binary variables u and constraint (14) connects those binary variables to their corresponding scenarios. This allows us to require only a single constraint (12) for each row of A, which accounts for all scenarios corresponding to those individual rows. For further detail on the extended formulation, we refer the reader to Luedtke et al. [13].

In this section, we present greedy and dual heuristic algorithms for solving case 1 of chance constrained problem (1). As we demonstrate in Section 5, the mixed-integer programming formulations – even the extended one – have limited computational tractability. By leveraging the ordering detailed in Section 2, we develop effective and scalable algorithms for heuristically solving case 1 problems.

Consider the tight-M formulation (7)–(10). Our heuristic algorithms solve a sequence of linear programming problems similar to (7)–(10), while leveraging order to reduce the linear program problem size. For each row i of constraint matrix A, we need only include constraint (8) for the non-removed scenario ω(i,
                        k) for which 
                           
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                                 
                                    ω
                                    (
                                    i
                                    ,
                                    k
                                    )
                                 
                              
                           
                         is largest. The linear program we solve iteratively can be written as follows:
                           
                              (19)
                              
                                 (
                                 tight-LP
                                 |
                                 z
                                 )
                                 
                                 
                                    
                                       
                                          min
                                       
                                       
                                          x
                                          ∈
                                          X
                                       
                                    
                                 
                                 
                                 cx
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                 
                                 
                                 
                                 s
                                 .
                                 t
                                 .
                                 
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 x
                                 ⩾
                                 
                                    
                                       
                                          max
                                       
                                       
                                          ω
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       ω
                                    
                                 
                                 )
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       ω
                                    
                                 
                                 ,
                                 
                                 i
                                 ∈
                                 I
                                 .
                              
                           
                        
                     

Initially 
                              
                                 z
                                 =
                                 
                                    
                                       0
                                    
                                    
                                       →
                                    
                                 
                              
                           . At each iteration, we solve “tight-LP∣z” to obtain the optimal decision vector x
                           ∗. We then solve an additional “ tight-LP∣ max{z,e
                           
                              ω
                           }” linear program, where e
                           
                              ω
                            is the unit vector with 1 in position ω and zeros elsewhere, for each active constraint 
                              
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       ω
                                       ∈
                                       Ω
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       ω
                                    
                                 
                                 )
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       ω
                                    
                                 
                              
                           . The scenario ω that yields the greatest ratio of objective value improvement to scenario probability is removed by setting z
                           
                              ω
                           
                           =1. We continue to iterate until the constraint 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       ω
                                       ∈
                                       Ω
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       ω
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ω
                                    
                                 
                                 ⩽
                                 ε
                              
                            in (9) does not have sufficient slack to set another z
                           
                              ω
                           
                           =1. Pseudocode for the greedy method is given in Algorithm 1.
                              Algorithm 1
                              Greedy algorithm for solving min
                                 cx s.t. 
                                    
                                       P
                                       (
                                       Ax
                                       ⩾
                                       
                                          
                                             b
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                       ⩾
                                       1
                                       -
                                       ε
                                    
                                 . 
                                    
                                       
                                          
                                          
                                             
                                                Initialize r
                                                   =
                                                   ε
                                                
                                             
                                             
                                                Initialize z
                                                   
                                                      ω
                                                   
                                                   =0 for every ω
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                
                                                   if no feasible solution exists for “
                                                      
                                                         tight
                                                         -
                                                         LP
                                                         |
                                                         z
                                                         =
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                      
                                                   ” then
                                                
                                             
                                             
                                                
                                                   Run Algorithm 3 to remove infeasibility and update r and z
                                                
                                             
                                             
                                                
                                                   end if
                                                
                                             
                                             
                                                
                                                   while true do
                                                
                                             
                                             
                                                
                                                   Solve “tight-LP∣z” to obtain optimal solution x
                                                   ∗ with objective v
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                   for all 
                                                   ω
                                                   ∈
                                                   Ω 
                                                   do
                                                
                                             
                                             
                                                
                                                   
                                                   v
                                                   
                                                      ω
                                                   
                                                   =
                                                   v
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                   end for
                                                
                                             
                                             
                                                
                                                   
                                                   for all 
                                                   i
                                                   ∈
                                                   I such that 
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               max
                                                            
                                                            
                                                               ω
                                                               ∈
                                                               Ω
                                                            
                                                         
                                                         (
                                                         1
                                                         -
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               ω
                                                            
                                                         
                                                         )
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               ω
                                                            
                                                         
                                                      
                                                    
                                                   do
                                                
                                             
                                             
                                                
                                                   
                                                   for all 
                                                   
                                                      
                                                         ω
                                                         ∈
                                                         
                                                            
                                                               argmax
                                                            
                                                            
                                                               s
                                                               ∈
                                                               Ω
                                                            
                                                         
                                                         (
                                                         1
                                                         -
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         )
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                      
                                                    
                                                   do
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   if (p
                                                   
                                                      ω
                                                   
                                                   <
                                                   r and z
                                                   
                                                      ω
                                                   
                                                   =
                                                   =0 and v
                                                   
                                                      ω
                                                   
                                                   =
                                                   =
                                                   v
                                                   ∗) then
                                                
                                             
                                             
                                                
                                                   
                                                   Let v
                                                   
                                                      ω
                                                   
                                                   =“tight-LP∣ max{z,e
                                                   
                                                      ω
                                                   }”
                                             
                                             
                                                
                                                   
                                                   
                                                   end if
                                                
                                             
                                             
                                                
                                                   
                                                   end for
                                                
                                             
                                             
                                                
                                                   
                                                   end for
                                                
                                             
                                             
                                                
                                                   
                                                   if 
                                                   v
                                                   ∗
                                                   >min
                                                      ω∈Ω
                                                   
                                                   v
                                                   
                                                      ω
                                                    
                                                   then
                                                
                                             
                                             
                                                
                                                   Let ω
                                                   ∈argmax
                                                      s∈Ω
                                                   (v
                                                   ∗
                                                   −
                                                   v
                                                   
                                                      s
                                                   )/p
                                                   
                                                      s
                                                   
                                                
                                             
                                             
                                                
                                                   Let r
                                                   =
                                                   r
                                                   −
                                                   p
                                                   
                                                      ω
                                                   
                                                
                                             
                                             
                                                
                                                   Let z
                                                   
                                                      ω
                                                   
                                                   =1
                                             
                                             
                                                
                                                   
                                                   else
                                                
                                             
                                             
                                                
                                                   Return v
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                   end if
                                                
                                             
                                             
                                                
                                                   end while
                                                
                                             
                                          
                                       
                                    
                                 
                              

Initially 
                              
                                 z
                                 =
                                 
                                    
                                       0
                                    
                                    
                                       →
                                    
                                 
                              
                           . At each iteration, we solve “tight-LP∣z” to obtain the dual price vector π. We then compute, for all ω
                           ∈
                           Ω such that z
                           
                              ω
                           
                           =0,
                              
                                 (21)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          ω
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      s
                                                      ∈
                                                      Ω
                                                   
                                                
                                             
                                             (
                                             1
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   s
                                                
                                             
                                             )
                                             
                                                
                                                   b
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      s
                                                      ∈
                                                      Ω
                                                      ⧹
                                                      ω
                                                   
                                                
                                             
                                             (
                                             1
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   s
                                                
                                             
                                             )
                                             
                                                
                                                   b
                                                
                                                
                                                   i
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           which is the sum of the dual prices weighted by the magnitude of the change in the right-hand side that would be induced by removing scenario ω. Note that for any ω
                           ∈
                           Ω, only those constraints i for which 
                              
                                 ω
                                 ∈
                                 
                                    
                                       argmax
                                    
                                    
                                       s
                                       ∈
                                       Ω
                                       :
                                       
                                          
                                             z
                                          
                                          
                                             s
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       s
                                    
                                 
                              
                            contribute to d
                           
                              ω
                           . The scenario ω that yields the greatest ratio of d
                           
                              ω
                            to scenario probability p
                           
                              ω
                            is removed by setting z
                           
                              ω
                           
                           =1. We continue to iterate until the constraint 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       ω
                                       ∈
                                       Ω
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       ω
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ω
                                    
                                 
                                 ⩽
                                 ε
                              
                            in (9) does not have sufficient slack to set another z
                           
                              ω
                           
                           =1. Pseudocode for the dual method is given in Algorithm 2.
                              Algorithm 2
                              Dual algorithm for solving min
                                 cx s.t. 
                                    
                                       P
                                       (
                                       Ax
                                       ⩾
                                       
                                          
                                             b
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                       ⩾
                                       1
                                       -
                                       ε
                                    
                                 . 
                                    
                                       
                                          
                                          
                                             
                                                Initialize r
                                                   =
                                                   ε
                                                
                                             
                                             
                                                Initialize z
                                                   
                                                      ω
                                                   
                                                   =0 for every ω
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                
                                                   if no feasible solution exists for “
                                                      
                                                         tight
                                                         -
                                                         LP
                                                         |
                                                         z
                                                         =
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                      
                                                   ” then
                                                
                                             
                                             
                                                
                                                   Run Algorithm 3 to remove infeasibility and update r and z
                                                
                                             
                                             
                                                
                                                   end if
                                                
                                             
                                             
                                                
                                                   while true do
                                                
                                             
                                             
                                                
                                                   Solve “tight-LP∣z” to obtain optimal objective v
                                                   ∗ and dual prices π
                                                
                                             
                                             
                                                
                                                   
                                                   for all 
                                                   ω
                                                   ∈
                                                   Ω 
                                                   do
                                                
                                             
                                             
                                                
                                                   
                                                   if 
                                                   z
                                                   
                                                      ω
                                                   
                                                   =
                                                   =0 and p
                                                   
                                                      ω
                                                   
                                                   ⩽
                                                   r 
                                                   then
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               ω
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        max
                                                                     
                                                                     
                                                                        s
                                                                        ∈
                                                                        Ω
                                                                     
                                                                  
                                                                  (
                                                                  1
                                                                  -
                                                                  
                                                                     
                                                                        z
                                                                     
                                                                     
                                                                        s
                                                                     
                                                                  
                                                                  )
                                                                  
                                                                     
                                                                        b
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                     
                                                                        s
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        max
                                                                     
                                                                     
                                                                        s
                                                                        ∈
                                                                        Ω
                                                                        ⧹
                                                                        ω
                                                                     
                                                                  
                                                                  (
                                                                  1
                                                                  -
                                                                  
                                                                     
                                                                        z
                                                                     
                                                                     
                                                                        s
                                                                     
                                                                  
                                                                  )
                                                                  
                                                                     
                                                                        b
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                     
                                                                        s
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   else
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   d
                                                   
                                                      ω
                                                   
                                                   =0
                                             
                                             
                                                
                                                   
                                                   end if
                                                
                                             
                                             
                                                
                                                   
                                                   end for
                                                
                                             
                                             
                                                
                                                   
                                                   if max
                                                      ω∈Ω
                                                   
                                                   d
                                                   
                                                      ω
                                                   
                                                   >0 then
                                                
                                             
                                             
                                                
                                                   Let ω
                                                   ∈argmax
                                                      s∈Ω
                                                   
                                                   d
                                                   
                                                      s
                                                   /p
                                                   
                                                      s
                                                   
                                                
                                             
                                             
                                                
                                                   Let r
                                                   =
                                                   r
                                                   −
                                                   p
                                                   
                                                      ω
                                                   
                                                
                                             
                                             
                                                
                                                   Let z
                                                   
                                                      ω
                                                   
                                                   =1
                                             
                                             
                                                
                                                   
                                                   else
                                                
                                             
                                             
                                                
                                                   Return v
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                   end if
                                                
                                             
                                             
                                                
                                                   end while
                                                
                                             
                                          
                                       
                                    
                                 
                              

If a feasible solution exists to “
                                    
                                       tight
                                       -
                                       LP
                                       |
                                       z
                                       =
                                       
                                          
                                             0
                                          
                                          
                                             →
                                          
                                       
                                    
                                 ” (19), (20), then Algorithms 1 and 2 provide feasible solutions to case 1 of chance constrained problem (1).


                           Remark 1 assumes that a feasible solution exists to “
                              
                                 tight
                                 -
                                 LP
                                 |
                                 z
                                 =
                                 
                                    
                                       0
                                    
                                    
                                       →
                                    
                                 
                              
                           ”, which cannot be expected in general. When no feasible solution exists, the dual and greedy algorithms require the following additional routine.

We select a 
                              
                                 λ
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       +
                                    
                                    
                                       m
                                    
                                 
                              
                            and δ
                           ∈(0,1) and solve the Lagrange multiplier linear program
                              
                                 (22)
                                 
                                    (
                                    Lagrange-LP
                                    |
                                    λ
                                    ,
                                    δ
                                    )
                                    
                                    
                                       
                                          
                                             min
                                          
                                          
                                             x
                                             ∈
                                             X
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          
                                             max
                                          
                                          
                                             ω
                                             ∈
                                             Ω
                                          
                                       
                                    
                                    
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                       
                                          ω
                                       
                                    
                                    -
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    x
                                    )
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    
                                    
                                    
                                    
                                    s
                                    .
                                    t
                                    .
                                    
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    x
                                    ⩾
                                    
                                       
                                          
                                             max
                                          
                                          
                                             ω
                                             ∈
                                             Ω
                                             ⧹
                                             
                                                
                                                   Ω
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                       
                                          ω
                                       
                                    
                                    
                                    i
                                    ∈
                                    I
                                 
                              
                           where
                              
                                 (24)
                                 
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                       
                                          ω
                                       
                                    
                                    ⩾
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    
                                    for
                                    
                                    all
                                    
                                    ω
                                    ∈
                                    
                                       
                                          Ω
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                    s
                                    ∈
                                    Ω
                                    ⧹
                                    
                                       
                                          Ω
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           and
                              
                                 (25)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ω
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          ω
                                       
                                    
                                    ⩽
                                    δ
                                    <
                                    
                                       
                                          p
                                       
                                       
                                          s
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ω
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          ω
                                       
                                    
                                    
                                    for
                                    
                                    all
                                    
                                    s
                                    ∈
                                    Ω
                                    ⧹
                                    
                                       
                                          Ω
                                       
                                       
                                          i
                                       
                                    
                                    .
                                 
                              
                           In other words, Ω
                           
                              i
                            is the largest possible subset of highest right-hand side values with total probability less than δ. We start with a small δ
                           ≪
                           ε. λ can be selected based on problem characteristics or set to a vector of ones. If the Lagrange-LP∣λ,δ 
                           (22), (23) is infeasible, slowly increase δ by step size h up to a limit of ε. If ε is reached, the original chance constrained problem is infeasible. Alternatively, if an optimal solution x is achieved, we identify the scenarios that must be removed for that solution to be feasible for tight-LP∣z 
                           (19), (20). If those scenarios can be removed while satisfying the knapsack constraint (9), we remove them and proceed with the greedy or dual methods. Otherwise, we rerun this method for removing infeasibility with a smaller step size h and/or another λ. While this method is not guaranteed to find a feasible solution, we show through our computational study its effectiveness in practice. Pseudocode for the Lagrange multiplier removal method is provided in Algorithm 3.
                              Algorithm 3
                              Remove infeasibility and update r and z. 
                                    
                                       
                                          
                                          
                                             
                                                User inputs a step size h
                                                
                                             
                                             
                                                User inputs Lagrange multipliers λ
                                                   
                                                      i
                                                   
                                                   >0 for violating constraints 
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         x
                                                         ⩾
                                                         
                                                            
                                                               max
                                                            
                                                            
                                                               ω
                                                               ∈
                                                               Ω
                                                            
                                                         
                                                         
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               ω
                                                            
                                                         
                                                      
                                                    for all i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                Let δ
                                                   =0
                                             
                                             
                                                
                                                   while true do
                                                
                                             
                                             
                                                
                                                   
                                                   if 
                                                   δ
                                                   ⩾
                                                   ε 
                                                   then
                                                
                                             
                                             
                                                
                                                   Return the chance constrained problem is infeasible
                                             
                                             
                                                
                                                   
                                                   end if
                                                
                                             
                                             
                                                
                                                   Let δ
                                                   =
                                                   δ
                                                   +
                                                   h
                                                
                                             
                                             
                                                
                                                   
                                                   for all 
                                                   i in 1,…,m 
                                                   do
                                                
                                             
                                             
                                                
                                                   Let Ω
                                                   
                                                      i
                                                   
                                                   =∅ and r
                                                   =
                                                   δ
                                                
                                             
                                             
                                                
                                                   
                                                   while 
                                                   r
                                                   >0 do
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   for all 
                                                   
                                                      
                                                         ω
                                                         ∈
                                                         
                                                            
                                                               argmax
                                                            
                                                            
                                                               s
                                                               ∈
                                                               Ω
                                                               ⧹
                                                               
                                                                  
                                                                     Ω
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                      
                                                    
                                                   do
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   r
                                                   =
                                                   r
                                                   −
                                                   p
                                                   
                                                      s
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   if 
                                                   r
                                                   >0 then
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                   Ω
                                                   
                                                      i
                                                   
                                                   =
                                                   Ω
                                                   
                                                      i
                                                   
                                                   ∩
                                                   s
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   end if
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   end for
                                                
                                             
                                             
                                                
                                                   
                                                   end while
                                                
                                             
                                             
                                                
                                                   
                                                   end for
                                                
                                             
                                             
                                                
                                                   Solve Lagrange-LP∣λ, δ 
                                                   (22) and (23) to obtain the optimal solution x
                                                   ∗
                                                
                                             
                                             
                                                
                                                   
                                                   if a feasible solution exists to Lagrange-LP∣λ,δ 
                                                   then
                                                
                                             
                                             
                                                
                                                   
                                                   Ω′={ω
                                                   ∈
                                                   Ω:Ax
                                                   ∗
                                                   <
                                                   b
                                                   
                                                      ω
                                                   }
                                             
                                             
                                                
                                                   
                                                   
                                                      
                                                         r
                                                         =
                                                         ε
                                                         -
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               ω
                                                               ∈
                                                               
                                                                  
                                                                     Ω
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               ω
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   Let z
                                                   
                                                      ω
                                                   
                                                   =1 for every ω
                                                   ∈
                                                   Ω′ and z
                                                   
                                                      ω
                                                   
                                                   =0 for every ω
                                                   ∈
                                                   Ω⧹Ω′
                                             
                                             
                                                
                                                   
                                                   if 
                                                   r
                                                   ⩾0 then
                                                
                                             
                                             
                                                
                                                   
                                                   Return r and z
                                                
                                             
                                             
                                                
                                                   
                                                   else
                                                
                                             
                                             
                                                
                                                   
                                                   Request a smaller h and/or another λ from user and rerun Algorithm 3
                                                
                                             
                                             
                                                
                                                   
                                                   end if
                                                
                                             
                                             
                                                
                                                   
                                                   end if
                                                
                                             
                                             
                                                
                                                   end while
                                                
                                             
                                          
                                       
                                    
                                 
                              

We obtain optimality gaps, which are useful in assessing the quality of solutions obtained through our heuristic algorithms, via a linear programming relaxation of the extended formulation (11)–(18) and via lower bounds from the cutting plane method presented in Luedtke et al. [13]. As we will see in Section 5, while the linear programming relaxation of the extended formulation provides tight optimality gaps, it has limited scalability. Using lower bounds from the cutting plane method remains a practical alternative for establishing optimality gaps for our heuristic methods.

In the next section, we provide computational evidence for the effectiveness and efficiency of our greedy and dual heuristic algorithms. However, these heuristics can in fact produce solutions that are arbitrarily far from optimal.
                        Theorem 1
                        
                           Let v
                           ∗ 
                           be the optimal solution to a case 1 chance constrained problem 
                           
                              (1)
                           
                           . Let v
                           
                              1
                            
                           and v
                           
                              2
                            
                           be feasible solutions obtained by 
                           
                              Algorithms 1 and 2
                           , respectively. Then ∄M
                           <∞ such that
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                          
                                          {
                                          
                                             
                                                v
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                          }
                                          -
                                          
                                             
                                                v
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    <
                                    M
                                 
                              
                           
                           for all case 1 chance constrained problems 
                           
                              (1)
                           
                           .
                        

Assume ∃M
                           <∞ such that (min {v
                           1,
                           v
                           2}−
                           v
                           ∗)/v
                           ∗
                           <
                           M for all case 1 chance constrained problems (1). We construct a counterexample where (min{v
                           1,v
                           2}−
                           v
                           ∗)/v
                           ∗
                           >
                           M as follows.

Consider the chance constrained problem
                              
                                 (26)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         x
                                                         ∈
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                             
                                          
                                          
                                             
                                                
                                                P
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⩾
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⩾
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                ⩾
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Assume c
                           1
                           >0 and c
                           2
                           >0. Let b
                           1
                           =(2,−1),
                           b
                           2
                           =(2,0),
                           b
                           3
                           =(0,1), and b
                           4
                           =(0,2) be 4 scenarios, each with probability 1/4. ε
                           =1/2 allows us to remove at most two of the four scenarios and – because they all have probability 1/4 – removing any two provides a feasible solution to chance constrained problem (26). The key to this counterexample is that Algorithms 1 and 2 remove the same two scenarios, neither of which is removed in the optimal solution to chance constrained problem (26).

The first tight-LP
                              
                                 |
                                 z
                                 =
                                 
                                    
                                       0
                                    
                                    
                                       →
                                    
                                 
                              
                            problem solved by Algorithms 1 and 2 is
                              
                                 (27)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         x
                                                         ∈
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⩾
                                                2
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⩾
                                                2
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           The optimal solution to (27) is x
                           1
                           =2 and x
                           2
                           =2 with objective value 2c
                           1
                           +2c
                           2.

Removing scenario b
                           4 is the only one out of the four scenarios that relaxes the constraint system in (27). Therefore, both Algorithms 1 and 2 remove b
                           4 and the resulting tight-LP∣z
                           =(0,0,0,1) linear program is
                              
                                 (28)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         x
                                                         ∈
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⩾
                                                2
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⩾
                                                1
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           The optimal solution to (28) is x
                           1
                           =2 and x
                           2
                           =1 with objective value 2c
                           1
                           +
                           c
                           2.

Removing scenario b
                           3 is the only one out of the three remaining scenarios that relaxes the constraint system in (28). Therefore, both Algorithms 1 and 2 remove b
                           3 and the resulting tight-LP∣z
                           =(0,0,1,1) linear program is
                              
                                 (29)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         x
                                                         ∈
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⩾
                                                2
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⩾
                                                0
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           The optimal solution to (29) is x
                           1
                           =2 and x
                           2
                           =0 with objective value v
                           1
                           =
                           v
                           2
                           =2c
                           1. Both Algorithms 1 and 2 terminate because no further removals are possible while satisfying the knapsack constraint (9).

Removing b
                           1 and b
                           2 from chance constrained problem (26) yields the linear program
                              
                                 (30)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         x
                                                         ∈
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⩾
                                                0
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⩾
                                                2
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           The optimal solution to (30) is x
                           1
                           =0 and x
                           2
                           =2 with objective value 2c
                           2.

By assumption, c
                           1
                           >0 and c
                           2
                           >0. Regardless of their specific values, Algorithms 1 and 2 provide a feasible solution to the chance constrained problem (26) with an objective value of 2c
                           1. However, we have just shown in (30) that another feasible solution for (26) exists with cost 2c
                           2. Therefore, if we choose c
                           2
                           =1 and c
                           1
                           >1, we have that v
                           ∗
                           =2 and
                              
                                 
                                    
                                       
                                          
                                             min
                                          
                                          {
                                          
                                             
                                                v
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                          }
                                          -
                                          
                                             
                                                v
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          2
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          -
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    1
                                    .
                                 
                              
                           Therefore, by choosing c
                           1
                           >
                           M
                           +1 we contradict our assumption.

The counterexample in the preceding proof demonstrates the worst-case solution for these algorithms. Note though that we obtain optimality gaps equal to c
                     1, which is arbitrarily large, for the heuristic solutions via the extended linear programming relaxation. Therefore, we do have a warning against the heuristic solutions achieved in this worst-case counterexample. In the next section, we provide computational evidence that these heuristics are effective, efficient and scalable in practice by testing them on the complete set of instances from Luedtke et al. [13].

We focused our computational study on a probabilistic version of the classical transportation problem. The deterministic transportation problem is to find the least costly transportation strategy x for which demand b
                     
                        j
                      is satisfied at each location j
                     ∈
                     J from the available supplies M
                     
                        i
                      from suppliers i
                     ∈
                     I, where the cost of sending x
                     
                        ij
                      units from supplier i to customer j is c
                     
                        ij
                     . We consider random demand 
                        
                           
                              
                                 b
                              
                              
                                 ̃
                              
                           
                        
                      and formulate the problem as
                        
                           (31)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   I
                                                   ,
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                ij
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                ij
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                ij
                                             
                                          
                                          ⩽
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                          
                                          
                                          ∀
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          P
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                          
                                          ⩾
                                          1
                                          -
                                          ε
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                             
                                                x
                                             
                                             
                                                ij
                                             
                                          
                                          ⩾
                                          0
                                          
                                          ∀
                                          i
                                          ∈
                                          I
                                          ,
                                          
                                          j
                                          ∈
                                          J
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

We tested our algorithms on the complete set of instances introduced in Luedtke et al. [13]. These instances are divided into two categories: one where the scenarios have equal probabilities and the other where the probabilities are unequal. All instances have 40 suppliers with either 100 or 200 customers, and between 1000 and 3000 scenarios. For each problem size, there are 5 instances, which we tested for ε
                        =0.05, 0.10, 0.15 and 0.20. The random demands were generated via independent normal distributions with randomly generated means and variances. For more information about the generation of these instances, we refer the reader to Luedtke et al. [13].

In 10% of the instances, no feasible solution exists to “
                           
                              tight-LP
                              |
                              z
                              =
                              
                                 
                                    0
                                 
                                 
                                    →
                                 
                              
                           
                        ” (19) and (20). For those instances, the greedy and dual methods require Algorithm 3 to remove infeasibility. We use a vector of ones for the Lagrange multipliers λ and a step size h
                        =1/1000, which removes infeasibility in all instances requiring Algorithm 3. The running times and optimality gaps for these instances were similar to all other instances, so we present all results together, whether they require Algorithm 3 or not.

@&#IMPLEMENTATION@&#

We implemented Algorithms 1 (greedy), 2 (dual) and 3 (remove infeasibility), as well as the extended formulation and cutting plane method, in C. We did not implement Algorithm 1 (greedy) in parallel. All computations were performed on identical machines each having x86_64 architecture, an Intel Xeon @2.5GHz processor, 16GB RAM and running CentOS 4 Linux. The callable library for CPLEX 12.1 was used to solve all linear and integer programs. We required the same time limit of 1h and memory limit of 2GB that was required in Luedtke et al. [13]. However, our implementation of the cutting plane method most likely differs, as specific implementation details were not provided in Luedtke et al. [13].

For simplicity in comparing problem sizes, let us consider the case of equi-probable scenarios with m
                        =200 customers, n
                        =3000 scenarios and ε
                        =0.20. The dual algorithm requires solving nε
                        =600 linear programs each with m
                        =200 demand constraints. The greedy algorithm requires solving up to (less if not all demand constraints are active) mnε
                        =120,000 linear programs each with 200 demand constraints, but these can be solved in nε
                        =600 iterations where at each iteration up to (less if not all demand constraints are active) m
                        =200 linear programs are solved in parallel. The tight-M formulation requires m n ε
                        =120,000 demand constraints (8) and up to n
                        =3000 binary variables. The extended formulation requires mnε
                        +
                        n
                        =123,000 binary variables, 2mnε
                        =240,000 ordering constraints (13) and (14) and m
                        =200 demand constraints (12).


                        Table 1
                         provides the average running times over 5 instances for the dual and greedy algorithms, the cutting plane method, the extended formulation, and the linear programming relaxations of the extended formulation. The latter linear programming relaxation is used to obtain optimality gaps for our heuristic algorithms, and also provides further insight into the scalability of the extended formulation. The findings for Table 1 can be summarized as follows:
                           
                              •
                              The average running time of the dual method is under 6 s for all problem sizes.

The average running time of the greedy method increases by a factor of around 4 when the number of customers m is doubled, and scales roughly linearly in both the number of scenarios n and in ε.

The average running time of the cutting plane method requires the 1h time limit for larger instances, but it can produce feasible solutions in all cases.

The average running time of the extended formulation is increasing at an exponential rate with ε, and does not have a consistent scaling factor when doubling either the number of customers m or the number of scenarios n. The extended formulation cannot solve to optimality within the 1h time limit, as ε, m and n increase. Moreover, it cannot produce even a single feasible solution within 1h for the largest case.

The average running time of the linear programming relaxation for the extended formulation increases to over 30min for the largest instances.


                        Table 2
                         provides the maximum optimality gaps over 5 instances for the dual and greedy algorithms, using lower bounds produced by the cutting plane method and using the linear programming relaxation of the extended formulation. For the dual and greedy algorithms, we compute the gaps as the differences between the heuristic solutions and the bounds divided by the heuristic solutions, which is consistent with the measure used by CPLEX to compute the relative gaps we report for both the extended formulation and the cutting plane method. The findings for Table 2 can be summarized as follows:
                           
                              •
                              The extended formulation, while superior for smaller instances, cannot provide even a single feasible solution for 200 customers, 3000 scenarios and ε
                                 =0.20 within the 1h time limit.

The optimality gaps for the cutting plane method increase to over 5% for the largest instances.

The greedy and dual algorithms provide the exact same solutions for all instances.

The greedy and dual algorithms provide a solution within 2.2% of optimal for all instances.

The extended linear programming relaxation and the lower bounds from the cutting plane method provide similar optimality gaps for most instances.

The bounds from the cutting plane method can be used in cases where the extended linear programming relaxation cannot be solved due to its limited scalability.

For the instances with ε
                        ⩽10%, for which the extended formulation solved to optimality, we were able to verify that the solutions obtained through the greedy and dual algorithms were indeed suboptimal, by the amount reflected in the optimality gaps.

We have developed two linear programming based heuristic methods for solving linear programs with joint probabilistic constraints, where the constraint matrix is deterministic and the right-hand side vector is random. Our greedy and dual heuristics (Algorithms 1 and 2) account for infeasibility and for scenarios with non-equal probabilities.

We compare our greedy and dual algorithms against the cutting plane method and extended mixed-integer programming formulation proposed by [13] for all their transportation instances, both for the reliability levels ε
                     =0.05, 0.10 that they considered and for slightly higher ones of ε
                     =0.15, 0.20. Our computational study shows that while both the extended mixed-integer programming formulation and cutting plane method perform well for ε
                     =0.05, 0.10, even for ε
                     =0.15, the larger instances of Luedtke et al. [13] cannot be solved to optimality by their exact solution methods. Moreover, for ε
                     =0.20, their extended formulation is unable to identify even a single feasible solution within the 1h time limit and the optimality gap from their cutting plane method exceeds 5%.

Our greedy and dual heuristics achieve optimality gaps of at most 2.2% for all instances for all reliability levels. These optimality gaps are obtained through lower bounds produced by the cutting plane method and linear programming relaxations of the extended mixed-integer programming formulation. While the greedy and dual algorithms provide the exact same solutions for all instances in our computational study, the dual heuristic provides remarkable speed – less than 6s for any single instance.

In future work, the greedy and dual algorithms presented in this paper can be applied in conjunction with sampling approaches to chance constrained problems where the underlying distribution of the right-hand side vector is continuous. These algorithms can also be used to warmstart exact integer programming approaches in order to reduce their running time.

@&#ACKNOWLEDGMENTS@&#

Special thanks to the reviewer whose insight and thorough feedback led to a significant improvement in the dual algorithm presented. We thank James Luedtke, Shabbir Ahmed and George Nemhauser for providing their transportation problem instances from An Integer Programming Approach for Linear Programs with Probabilistic Constraints. We thank Bernardo Pagnoncelli for suggesting that these instances would be ideal for our computational study. This research was funded by ANILLO Grant ACT-88 and Basal Project CMM, Universidad de Chile.

@&#REFERENCES@&#

