@&#MAIN-TITLE@&#A computational analysis of multidimensional piecewise-linear models with applications to oil production optimization

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A comprehensive analysis of multidimensional piecewise-linear models.


                        
                        
                           
                           A computational analysis of the piecewise-linear models in oil production optimization.


                        
                        
                           
                           Logarithmic convex combination models were mostly efficient to model pressure drops.


                        
                        
                           
                           Simulated production is improved with increased resolution of the models.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in energy

Integer programming

Multidimensional functions

Piecewise linearization

Oil production

Pressure constraints

@&#ABSTRACT@&#


               
               
                  Production optimization of gas-lifted oil wells under facility, routing and pressure constraints is a challenging problem, which has attracted the interest of operations engineers aiming to drive economic gains and scientists for its inherent complexity. The hardness of this problem rests on the non-linear characteristics of the multidimensional well-production and pressure-drop functions, as well as the discrete routing decisions. To this end, this work develops several formulations in Mixed-Integer Linear Programming (MILP) using multidimensional piecewise-linear models to approximate the non-linear functions with domains spliced in hypercubes and simplexes. Computational and simulation analyses were performed considering a synthetic but realistic oil field modeled with a multiphase-flow simulator. The purpose of the analyses was to assess the relative performance of the MILP formulations and their impact on the simulated oil production.
               
            

@&#INTRODUCTION@&#

Although technological advances have increased the diversity of energy resource alternatives, fossil energy remains a primal source of energy in the modern world. In response to the increasing demand for petroleum and highly competitive markets, the petroleum industry has been investing in innovation aiming to optimize production processes and cut operational costs.

On the daily operation of oil fields several decisions are made to determine the production plan: valve configurations, well-manifold routings, and choke openings, among others. Further, the engineers have to deal with uncertainties and complex problems that arise from unexpected contingencies, such as compressor failure and choke stalling caused by equipment wear and abrasive fluid production. In existing oil fields, operational plans are reached promptly often based on a sensitivity analysis that uses simulation tools and heuristics. Even though these methods can obtain good operational plans, they do not necessarily ensure a mode of operation that maximizes the daily production.

In principle, optimal production plans could be achieved by formulating the production optimization problem as a Mixed-Integer Nonlinear Program (MINLP) accounting for complex nonlinear phenomena like well production and pressure drop. Since these relations are not known explicitly, they can be approximated using nonlinear functions to cast the problem as an MINLP or using piecewise-linear models to yield a Mixed-Integer Linear Programming (MILP) problem.

Although several works have applied mathematical programming methods to obtain optimal production plans (Buitrago, Rodríguez, & Espin, 1996; Alarcón, Torres, & Gómez, 2002; Camponogara & de Conto, 2009; Misener, Gounaris, & Floudas, 2009; Codas & Camponogara, 2012), only a limited number of works considered pressure drop in pipelines which cannot be neglected when the operating conditions vary due to routing operations and equipment failure, for instance.


                     Beggs and Brill (1973) were among the first to study the representation of pressure in oil production systems, who proposed correlations between the pressure drop and flow in pipelines. Litvak and Darlow (1995) developed analytic and piecewise-linear models for representing pressure equations. The first represents more precisely the physical phenomenon and is routinely used in software for simulating flows in oil production systems. The second technique approximates pressure drops as a function of the outlet pressure and the oil, gas, and water flows.

More recent works in oil production optimization considering complex operations, such as routing and pressure drop, can be roughly divided in MINLP and MILP methods. Kosmidis, Perkins, and Pistikopoulos (2004, 2005) present an MINLP optimization formulation of a production network with naturally producing and gas-lifted wells. The MINLP problem is solved by a sequence of MILP problems following a sequential linear programming strategy. On the other hand, Gunnerud and Foss (2010) present an MILP formulation for oil fields structured in clusters of independent wells, manifolds, and pipelines while the separation facilities are centralized in a platform. Piecewise linearization techniques based on special ordered sets of type 2 (SOS2) constraints are used to approximate nonlinear functions.

Because the complex behavior of well production and pipeline pressure drop are not explicitly known, the synthesis of an MINLP program will entail fitting sample data from a simulator to nonlinear models, a task that itself is challenging and dependent on the space of models considered. On the other hand, piecewise-linear models have the advantage of not needing the synthesis of such relationships, being defined directly from the sample points, a property that motivates the work herein.

Although some works have represented pressure drops with piecewise-linear models, a comprehensive analysis of the existing models for piecewise linearization in oil production optimization is lacking. To this end, this work presents a computational and simulation analysis of piecewise-linear models for hypercube- and simplex-based approximations of the function domains, considering an oil field modeled with a standard multiphase-flow simulator.

The work is organized as follows. Section 2 defines the problem of optimizing gas-lifted oil fields as an MINLP problem. Section 3 offers a brief review of piecewise-linear functions and several MILP approximation formulations of the gas-lift optimization problem. Section 4 presents a synthetic but realistic model of an off-shore oil field, along with a computational analysis of the developed MILP formulations and a simulation analysis considering both hypercube- and simplex-based approximations. Finally, Section 5 presents some conclusions and suggests directions for future research.

The problem of optimizing the daily production of a gas-lifted oil field taking into account constraints on lift-gas availability, separation capacity, well-manifold routing, and pressure constraints can be formulated as a mixed-integer non-linear program:
                        
                           (1a)
                           
                              P
                              :
                              
                                 max
                              
                              f
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       ∈
                                       M
                                    
                                 
                              
                              g
                              (
                              
                                 
                                    q
                                 
                                 
                                    m
                                 
                              
                              )
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       ∈
                                       N
                                    
                                 
                              
                              c
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1b)
                           
                              s
                              .
                              t
                              .
                              :
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       ∈
                                       N
                                    
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              ⩽
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                                 
                                    max
                                 
                              
                           
                        
                     
                     
                        
                           (1c)
                           
                              
                                 
                                    
                                    
                                       
                                          For
                                          
                                          all
                                          
                                          n
                                          ∈
                                          N
                                          :
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                             
                                                n
                                                ,
                                                
                                                   min
                                                
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                n
                                             
                                          
                                          ⩽
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                             
                                                n
                                             
                                          
                                          ⩽
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                             
                                                n
                                                ,
                                                
                                                   max
                                                
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1d)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       ∈
                                       
                                          
                                             M
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    n
                                 
                              
                           
                        
                     
                     
                        
                           (1e)
                           
                              
                              
                                 
                                    q
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              =
                              
                                 
                                    q
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             m
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              ,
                              
                              ∀
                              m
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    n
                                 
                              
                           
                        
                     
                     
                        
                           (1f)
                           
                              
                              
                                 
                                    z
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    n
                                    ,
                                    L
                                 
                              
                              ⩽
                              
                                 
                                    q
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              ⩽
                              
                                 
                                    z
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    n
                                    ,
                                    U
                                 
                              
                              ,
                              
                              ∀
                              m
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    n
                                 
                              
                           
                        
                     
                     
                        
                           (1g)
                           
                              
                                 
                                    q
                                 
                                 
                                    m
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              ⩽
                              
                                 
                                    q
                                 
                                 
                                    m
                                    ,
                                    S
                                 
                              
                              ,
                              
                              ∀
                              m
                              ∈
                              M
                           
                        
                     
                     
                        
                           (1h)
                           
                              
                                 
                                    p
                                 
                                 
                                    m
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    m
                                    ,
                                    S
                                 
                              
                              +
                              Δ
                              
                                 
                                    p
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    q
                                 
                                 
                                    m
                                 
                              
                              )
                              ,
                              
                              ∀
                              m
                              ∈
                              M
                           
                        
                     
                     
                        
                           (1i)
                           
                              
                                 
                                    p
                                 
                                 
                                    m
                                    ,
                                    
                                       min
                                    
                                 
                              
                              ⩽
                              
                                 
                                    p
                                 
                                 
                                    m
                                 
                              
                              ⩽
                              
                                 
                                    p
                                 
                                 
                                    m
                                    ,
                                    
                                       max
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1j)
                           
                              0
                              ⩽
                              
                                 
                                    y
                                 
                                 
                                    n
                                 
                              
                              ⩽
                              1
                              ,
                              
                              ∀
                              n
                              ∈
                              N
                           
                        
                     
                     
                        
                           (1k)
                           
                              
                                 
                                    z
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              ,
                              
                              ∀
                              n
                              ∈
                              N
                              ,
                              
                              ∀
                              m
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    n
                                 
                              
                           
                        
                     with decision variables for optimization being:
                        
                           •
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                 
                               is the lift-gas rate injected into well n;


                              y
                              
                                 n
                               takes on value 1 when well n is producing and 0 otherwise. Dispite being a continuous variable it can only assume values 1 or 0 as a consequence of Eq. (1d);


                              z
                              
                                 n,m
                               assumes value 1 if the production of well n is directed to manifold m, and 0 otherwise;


                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          h
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                 
                               is the flow of phase 
                                 
                                    h
                                    ∈
                                    H
                                 
                               directed from well n to manifold m, and 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   h
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             :
                                             h
                                             ∈
                                             H
                                          
                                       
                                    
                                 
                               is the vector of all phase flows;


                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                 
                               is the total flow received by manifold m;


                              p
                              
                                 m
                               is the pressure of manifold m;

with parameters:
                        
                           •
                           
                              N is the number of oil wells, 
                                 
                                    N
                                    =
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                    }
                                 
                              , and 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          m
                                       
                                    
                                    ⊆
                                    N
                                 
                               is the subset of wells whose production can be directed to manifold m;


                              M is the number of manifolds, 
                                 
                                    M
                                    =
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    M
                                    }
                                 
                               and 
                                 
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ⊆
                                    M
                                 
                               is the subset of manifolds that can receive production from well n. The production of each manifold is processed by a dedicated separator;


                              
                                 
                                    H
                                    =
                                    {
                                    o
                                    ,
                                    g
                                    ,
                                    w
                                    }
                                 
                               has the phase flows, namely oil (o), gas (g), and water (w);


                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                       
                                          max
                                       
                                    
                                 
                               models the lift-gas that can be delivered by the compression station;


                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                       
                                          n
                                          ,
                                          min
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                       
                                          n
                                          ,
                                          max
                                       
                                    
                                 
                               are bounds on the lift-gas injection for well n typically used to ensure production stability, avoid slugging, and follow a recovery policy for the reservoir;


                              p
                              
                                 m,S is the operational pressure of the separator connected to manifold m;


                              q
                              
                                 n,L and q
                              
                                 n,U are vectors with lower and upper bounds on the production of well n;


                              q
                              
                                 m,S is the processing capacity of the separator of manifold m;


                              p
                              
                                 m,min (p
                              
                                 m,max) is the minimum (maximum) operational pressure for manifold m;

and with functions:
                        
                           •
                           
                              f is a function composed by a function g that represents the economic benefit from oil production and a function c which represents the lift-gas injection cost, however any other continuous function can be considered such as the total oil production;


                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          h
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                               is the flow of phase h sent by well n to manifold m given as a function of the manifold pressure and lift-gas injection, and 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   h
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                             :
                                             h
                                             ∈
                                             H
                                          
                                       
                                    
                                 
                               is the vector of all phase flows;

Δp
                              
                                 m
                              (q
                              
                                 m
                              ) represents the pressure drop in the pipeline connecting manifold m to its adjoint separator.

Among the decision variables for optimization, the ones that are actually controlled in the oil field are the well activation decisions y
                     
                        n
                     , the routing decisions z
                     
                        n,m
                     , and the lift-gas rates 
                        
                           
                              
                                 q
                              
                              
                                 i
                              
                              
                                 n
                              
                           
                        
                     .

The nonlinearity in the production optimization problem arises from the nonlinear nature of the well-production function 
                        
                           
                              
                                 q
                              
                              
                                 h
                              
                              
                                 n
                                 ,
                                 m
                              
                           
                        
                      and the pressure drop Δp
                     
                        m
                      in pipelines, which later will be approximated with piecewise-linear models. This problem extends the work of Codas and Camponogara (2012) by explicitly modeling pressure drops and considering pressure constraints.

The gas compressing capacity and the bound on lift-gas injection for the wells are defined by constraints (1b) and (1c) respectively.

The well-manifold routing constraints (1d) and (1e) ensure that the production of each well will be sent to precisely one manifold when the well is producing, i.e. y
                     
                        n
                     
                     =1. The production of well n sent to manifold m is zero if not routed to this manifold, i.e. z
                     
                        n,m
                     
                     =0, however the production becomes bounded by q
                     
                        n,L and q
                     
                        n,U if well n is routed to manifold m.

The operational limits for well production, the mass balance equations, and separation capacity are established by constraints (1f) and (1g), while the pressure balance between manifolds and separators are given by constraints (1h) and (1i).


                     Fig. 1
                      illustrates the structure of the oil production system and the semantics of the decision variables. The available lift-gas rate 
                        
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                       
                                          max
                                       
                                    
                                 
                              
                           
                        
                      is distributed to the active wells 
                        
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    :
                                    n
                                    ∈
                                    N
                                 
                              
                           
                        
                      which in turn yield multiphase flows that are directed to manifolds 
                        
                           (
                           
                              
                                 q
                              
                              
                                 n
                                 ,
                                 m
                              
                           
                           :
                           n
                           ∈
                           N
                           ,
                           m
                           ∈
                           
                              
                                 M
                              
                              
                                 n
                              
                           
                           )
                        
                      and then to the separators (q
                     
                        m
                     ). These flows induce pressure drops in the pipelines (Δp
                     
                        m
                     (q
                     
                        m
                     )) which are limited by the separator’s capacity (q
                     
                        m,S).

The MINLP problem given above is a conceptual formulation because the well-production and pressure-drop relations are not known explicitly. An MINLP approximation may be obtained by fitting nonlinear models to sample data provided by a simulator or real measurements from the oil field. However, the synthesis and validation of such models are themselves a challenge, motivating the development of piecewise-linear models directly from the sample data to yield an MILP approximation. Since the true MINLP is not known, this work will compare the predictions induced by the piecewise-linear schemes against to the corresponding values provided by a simulator. This means that a solution close to the global optimum may be reached by solving the MILP formulation considering a sufficiently high number of sample points.

The formulation of the gas-lift optimization problem presented in the previous section is non-convex due to the non-linear nature of the well production curves and the flow-line pressure drops. The feasible space for well production can be non-convex regardless of the well production function being concave. Further, the flow-line pressure-drop functions are multidimensional relationships available in phenomenological simulators, making it a challenge to be modeled and used in optimization software even when the relationships are univariate.

However, non-convex piecewise-linear models can be used to approximate such complex non-linear functions, allowing the resulting MILP formulations to be solved by specialized algorithms and off-the-shelf solvers. Usually, the latter approach takes advantage on the first since it benefits from the state-of-the-art technology implemented in the solvers (Vielma, Ahmed, & Nemhauser, 2010). In this work, we approximate the non-linear functions with piecewise-linear (PWL) models and solve the gas-lift distribution problem with an MILP solver.

This section starts with a brief introduction to the existing MILP models for multidimensional piecewise-linear approximation and then presents the corresponding MILP approximation formulations of problem P.

The definition of piecewise-linear function is borrowed from Vielma et al. (2010) who review existing MILP models for piecewise linearization. According to Vielma et al. (2010), a continuous function 
                           
                              f
                              :
                              D
                              →
                              R
                           
                         with compact domain 
                           
                              D
                              ⊆
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                         is piecewise-linear if, and only if, there exists a family of polytopes 
                           
                              P
                           
                        , such that 
                           
                              
                                 
                                    ∪
                                 
                                 
                                    P
                                    ∈
                                    P
                                 
                              
                              P
                              =
                              D
                              ,
                              
                              
                                 
                                    {
                                    
                                       
                                          m
                                       
                                       
                                          P
                                       
                                    
                                    }
                                 
                                 
                                    P
                                    ∈
                                    P
                                 
                              
                              ⊆
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    {
                                    
                                       
                                          c
                                       
                                       
                                          P
                                       
                                    
                                    }
                                 
                                 
                                    P
                                    ∈
                                    P
                                 
                              
                           
                        , where:
                           
                              (2)
                              
                                 f
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       m
                                    
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 x
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       P
                                    
                                 
                                 ,
                                 
                                 ∀
                                 x
                                 ∈
                                 P
                                 ,
                                 
                                 P
                                 ∈
                                 P
                              
                           
                        Let V(P) be the set of vertices of polytope P and 
                           
                              V
                              (
                              P
                              )
                              =
                              
                                 
                                    ∪
                                 
                                 
                                    P
                                    ∈
                                    P
                                 
                              
                              V
                              (
                              P
                              )
                           
                         be the set of all vertices.


                        Figs. 2 and 3
                        
                         show one-dimensional and two-dimensional illustrative PWL functions respectively. The domain of the first one is D
                        =[0,4], which is represented by a family of polytopes P
                        ={P
                        1,
                        P
                        2,
                        P
                        3,
                        P
                        4}, where P
                        1
                        =[0,1], P
                        2
                        =[1,2], P
                        3
                        =[2,3], and P
                        4
                        =[3,4], and V(P
                        1)={0, 1}, V(P
                        2)={1,2}, V(P
                        3)={2,3}, and V(P
                        4)={3,4}, with the graph points 
                           
                              G
                              =
                              {
                              (
                              x
                              ,
                              f
                              (
                              x
                              )
                              )
                              :
                              x
                              ∈
                              D
                              }
                           
                         being {(0,8), (1,28), (2,14), (3,25), (4,21)}.

The two-dimensional PWL function approximates the non-convex function 
                           
                              f
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    e
                                 
                                 
                                    -
                                    y
                                 
                              
                              +
                              
                                 
                                    e
                                 
                                 
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              +
                              xy
                              -
                              2
                              y
                           
                         depicted in Fig. 3. Its domain 
                           
                              D
                              =
                              
                                 
                                    [
                                    -
                                    2
                                    ,
                                    2
                                    ]
                                 
                                 
                                    2
                                 
                              
                           
                         is partitioned in a set of polytopes 
                           
                              P
                              =
                              {
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    |
                                    P
                                    |
                                 
                              
                              }
                           
                         which can be hypercubes or simplexes. According to Todd (1977), the J1 (Union Jack) triangulation yields a subdivision of the domain space which is compatible with all PWL models, except the SOS2 model. Fig. 3b shows the J1 triangulation for the two-dimensional PWL function depicted in Fig. 3a.

The MILP models available to approximate multidimensional functions can represent the PWL functions in many different ways: convex combination of the vertices of one single polytope, set of hyperplane equations and linear inequalities, and incrementally from a set of ordered polytopes (simplexes) and vertices.

These formulations split the domain of the function in a set of polytopes 
                           
                              P
                              ∈
                              P
                           
                        . Each polytope P has a set of vertices V(P), and for each vertex v
                        ∈
                        V(P) of this polytope, there is an associated continuous variable λ
                        
                           P,v
                        . The representation of a graph point of the function is described as the convex combination of the vertices of each polytope.

The DCC model does not require any special property for its polytopes. This model was studied by Croxton, Gendron, and Magnanti (2003), Jeroslow and Lowe (1984), Meyer (1976), and Sherali (2001). The MILP reformulation of the production function 
                              
                                 
                                    
                                       q
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                            using the DCC model is given by following set of equations:
                              
                                 (3a)
                                 
                                    
                                       
                                          
                                             
                                                For
                                                
                                                all
                                                
                                             
                                          
                                          
                                             
                                                n
                                                ∈
                                                N
                                                :
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         P
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               n
                                                               ,
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         )
                                                         ∈
                                                         V
                                                         (
                                                         P
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                      ,
                                                      m
                                                      ,
                                                      P
                                                   
                                                
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (3b)
                                 
                                    
                                    
                                       
                                          p
                                       
                                       
                                          m
                                       
                                    
                                    ⩾
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             P
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                             ∈
                                             V
                                             (
                                             P
                                             )
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                          ,
                                          P
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                           
                              
                                 (3c)
                                 
                                    
                                    
                                       
                                          p
                                       
                                       
                                          m
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             P
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                             ∈
                                             V
                                             (
                                             P
                                             )
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                          ,
                                          P
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          m
                                          ,
                                          
                                             max
                                          
                                       
                                    
                                    (
                                    1
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    )
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                           
                              
                                 (3d)
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             P
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                             ∈
                                             V
                                             (
                                             P
                                             )
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                          ,
                                          P
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                           
                              
                                 (3e)
                                 
                                    
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                          ,
                                          L
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ⩽
                                    
                                       
                                          q
                                       
                                       
                                          n
                                          ,
                                          U
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                           
                              
                                 (3f)
                                 
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                          ,
                                          P
                                       
                                    
                                    ⩾
                                    0
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                    P
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ,
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    )
                                    ∈
                                    V
                                    (
                                    P
                                    )
                                 
                              
                           
                           
                              
                                 (3g)
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                             ∈
                                             V
                                             (
                                             P
                                             )
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                          ,
                                          P
                                       
                                    
                                    =
                                    
                                       
                                          y
                                       
                                       
                                          P
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    P
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                 
                              
                           
                           
                              
                                 (3h)
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             P
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          P
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                           
                              
                                 (3i)
                                 
                                    
                                    
                                       
                                          y
                                       
                                       
                                          P
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    P
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                 
                              
                           having the following extra parameters:
                              
                                 •
                                 
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                R
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                     are the sets of breakpoints for the lift-gas rate injected in well n and pressure of manifold m;


                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                     is the set of polytopes in the production function domain for well n when its production is directed to manifold m, and the set of vertices 
                                       
                                          V
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          )
                                          ≔
                                          
                                             
                                                K
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          ×
                                          
                                             
                                                R
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                     is defined by the Cartesian product of the set of breakpoints for the lift-gas rate and manifold pressure;

and extra variables:
                           
                              
                                 •
                                 
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                             
                                                n
                                                ,
                                                m
                                                ,
                                                P
                                             
                                          
                                       
                                     is the weighting variable of a breakpoint pair 
                                       
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                          )
                                       
                                     in 
                                       
                                          
                                             
                                                K
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          ×
                                          
                                             
                                                R
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                     that belongs to a polytope 
                                       
                                          P
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    . When manifold m receives the production of well n, z
                                    
                                       n,m
                                     takes on value 1 and the respective convex combination becomes active;


                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                     is a binary variable associated to each polytope 
                                       
                                          P
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                     which assumes value 1 when the convex combination is limited to polytope P. According to constraint (3g), only the vertices of P can be part of the convex combination that defines the lift-gas injection 
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                             
                                                n
                                             
                                          
                                       
                                     into well n and the manifold pressure p
                                    
                                       m
                                    ;


                                    
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                     is the piecewise-linear approximation of q
                                    
                                       n,m
                                    .

In the same way, the pressure drop functions Δp(q
                           
                              m
                           ) are piecewise linearized with each model. For simplicity, we show only the reformulation for the well production curves. Then, the objective function given in Eq. (1a) is recast as a piecewise-linear form:
                              
                                 (4)
                                 
                                    
                                       max
                                    
                                    
                                       
                                          f
                                       
                                       
                                          ̃
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             m
                                             ∈
                                             M
                                          
                                       
                                    
                                    g
                                    (
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          m
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                    
                                    c
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The DLog model aims to reduce the binary variables and extra constraints of the DCC model. In this formulation, each polytope 
                              
                                 P
                                 ∈
                                 P
                              
                            is represented with a binary vector 
                              
                                 y
                                 ∈
                                 
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                       ⌈
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       |
                                       P
                                       |
                                       ⌉
                                    
                                 
                              
                            using an injective function 
                              
                                 B
                                 :
                                 P
                                 →
                                 
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                       ⌈
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       |
                                       P
                                       |
                                       ⌉
                                    
                                 
                              
                           . Some binary variables are required to enforce 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       v
                                       ∈
                                       V
                                       (
                                       P
                                       )
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       P
                                       ,
                                       v
                                    
                                 
                              
                            to be one when y
                           =
                           B(P). Let B(P)
                              l
                            be the value in position l of the binary code associated to polytope P. 
                              
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 B
                                 ,
                                 l
                                 )
                              
                            is the set of polytopes whose binary codes have value j
                           ∈{0,1} in position l, and 
                              
                                 L
                                 (
                                 P
                                 )
                              
                            is the set of indexes for the entries of a binary code B(P):
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                   
                                                
                                                (
                                                B
                                                ,
                                                l
                                                )
                                                ≔
                                                {
                                                P
                                                ∈
                                                P
                                                :
                                                B
                                                
                                                   
                                                      (
                                                      P
                                                      )
                                                   
                                                   
                                                      l
                                                   
                                                
                                                =
                                                j
                                                }
                                                ,
                                                
                                                j
                                                ∈
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                L
                                                (
                                                P
                                                )
                                                ≔
                                                {
                                                1
                                                ,
                                                …
                                                ,
                                                ⌈
                                                
                                                   
                                                      log
                                                   
                                                   
                                                      2
                                                   
                                                
                                                |
                                                P
                                                |
                                                ⌉
                                                }
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Based on the works of Ibaraki (1976), Vielma, Keha, and Nemhauser (2008), Vielma and Nemhauser (2011), the well performance curve q
                           
                              n,m
                            is then approximated with a piecewise-linear function using the DLog model as follows:
                              
                                 (5a)
                                 
                                    
                                       
                                          
                                             
                                                For
                                                
                                                all
                                             
                                          
                                          
                                             
                                                
                                                n
                                                ∈
                                                N
                                                :
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         P
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               n
                                                               ,
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         )
                                                         ∈
                                                         V
                                                         (
                                                         P
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                      ,
                                                      m
                                                      ,
                                                      P
                                                   
                                                
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (5b)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         P
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               n
                                                               ,
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         )
                                                         ∈
                                                         V
                                                         (
                                                         P
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                      ,
                                                      m
                                                      ,
                                                      P
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      r
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                ∀
                                                m
                                                ∈
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (5c)
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             P
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                             ∈
                                             V
                                             (
                                             P
                                             )
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                          ,
                                          P
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          m
                                          ,
                                          
                                             max
                                          
                                       
                                    
                                    (
                                    1
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    )
                                    ⩾
                                    
                                       
                                          p
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                           
                              
                                 (5d)
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             P
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                             ∈
                                             V
                                             (
                                             P
                                             )
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                          ,
                                          P
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                           
                              
                                 (5e)
                                 
                                    
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                          ,
                                          L
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ⩽
                                    
                                       
                                          q
                                       
                                       
                                          n
                                          ,
                                          U
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                 
                              
                           
                           
                              
                                 (5f)
                                 
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                          ,
                                          P
                                       
                                    
                                    ⩾
                                    0
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                    P
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ,
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    )
                                    ∈
                                    V
                                    (
                                    P
                                    )
                                 
                              
                           
                           
                              
                                 (5g)
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             P
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                             ∈
                                             V
                                             (
                                             P
                                             )
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                          ,
                                          P
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                           
                              
                                 (5h)
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             P
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                   ,
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             (
                                             B
                                             ,
                                             l
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                             ∈
                                             V
                                             (
                                             P
                                             )
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                          ,
                                          P
                                       
                                    
                                    ⩽
                                    
                                       
                                          y
                                       
                                       
                                          l
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    l
                                    ∈
                                    L
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    )
                                 
                              
                           
                           
                              
                                 (5i)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         P
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               0
                                                               ,
                                                               n
                                                               ,
                                                               m
                                                            
                                                         
                                                         (
                                                         B
                                                         ,
                                                         l
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         )
                                                         ∈
                                                         V
                                                         (
                                                         P
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                      ,
                                                      m
                                                      ,
                                                      P
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      
                                                         1
                                                         -
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               l
                                                            
                                                            
                                                               n
                                                               ,
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                ∀
                                                m
                                                ∈
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ,
                                                l
                                                ∈
                                                L
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      n
                                                      ,
                                                      m
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (5j)
                                 
                                    
                                    
                                       
                                          y
                                       
                                       
                                          l
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    ,
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    l
                                    ∈
                                    L
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    )
                                 
                              
                           having the additional variable:
                              
                                 •
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                l
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                     is a binary variable associated with the l
                                    
                                       th
                                     entry of the binary code of each polytope, which induces the branching scheme in the weighting λ variables.

and extra parameters:
                              
                                 •
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                1
                                                ,
                                                n
                                                ,
                                                m
                                             
                                          
                                          (
                                          B
                                          ,
                                          l
                                          )
                                       
                                     and 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                0
                                                ,
                                                n
                                                ,
                                                m
                                             
                                          
                                          (
                                          B
                                          ,
                                          l
                                          )
                                       
                                     are the polytope sets associated to the injective function B which maps polytopes to binary vectors, grouping polytopes according to the index l and its binary representation B, where 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                j
                                                ,
                                                n
                                                ,
                                                m
                                             
                                          
                                          (
                                          B
                                          ,
                                          l
                                          )
                                          ≔
                                          {
                                          P
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          :
                                          B
                                          
                                             
                                                (
                                                P
                                                )
                                             
                                             
                                                l
                                             
                                          
                                          =
                                          j
                                          }
                                          ,
                                          
                                          j
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                    ;


                                    
                                       
                                          L
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          )
                                          ≔
                                          {
                                          1
                                          ,
                                          …
                                          ,
                                          ⌈
                                          
                                             
                                                log
                                             
                                             
                                                2
                                             
                                          
                                          |
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          |
                                          ⌉
                                          }
                                       
                                     is the set of indexes mapped by the binary vectors to represent each polytope 
                                       
                                          P
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    .

The production function 
                              
                                 
                                    
                                       q
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                            of well n depends on the pressure of the manifold m to which it is connected, p
                           
                              m
                           , and the lift-gas injection rate, 
                              
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                              
                           . This curve is represented by a piecewise-linear function using the CC model as follows:
                              
                                 (6a)
                                 
                                    
                                       
                                          
                                             
                                                For
                                                
                                                all
                                                
                                                n
                                                ∈
                                                N
                                                :
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      n
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         )
                                                         ∈
                                                         V
                                                         (
                                                         P
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                      ,
                                                      m
                                                   
                                                
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6b)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         )
                                                         ∈
                                                         V
                                                         (
                                                         P
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                      ,
                                                      m
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      r
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         )
                                                         ∈
                                                         V
                                                         (
                                                         P
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                      ,
                                                      m
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                +
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      m
                                                      ,
                                                      
                                                         max
                                                      
                                                   
                                                
                                                (
                                                1
                                                -
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      n
                                                      ,
                                                      m
                                                   
                                                
                                                )
                                                ,
                                                
                                                ∀
                                                m
                                                ∈
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6c)
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                             ∈
                                             V
                                             (
                                             P
                                             )
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    )
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6d)
                                 
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          n
                                          ,
                                          L
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ⩽
                                    
                                       
                                          q
                                       
                                       
                                          n
                                          ,
                                          U
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6e)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ⩾
                                    0
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    )
                                    ∈
                                    V
                                    (
                                    P
                                    )
                                 
                              
                           
                           
                              
                                 (6f)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                             ∈
                                             V
                                             (
                                             P
                                             )
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6g)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             P
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          P
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    )
                                    ∈
                                    V
                                    (
                                    P
                                    )
                                 
                              
                           
                           
                              
                                 (6h)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             P
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          P
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6i)
                                 
                                    
                                       
                                          y
                                       
                                       
                                          P
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    ,
                                    
                                    ∀
                                    P
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       P
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       r
                                    
                                 
                                 )
                                 =
                                 {
                                 P
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 :
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       r
                                    
                                 
                                 )
                                 ∈
                                 V
                                 (
                                 P
                                 )
                                 }
                              
                            and 
                              
                                 
                                    
                                       y
                                    
                                    
                                       P
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                              
                            chooses the polytope.

New concepts are introduced to implement the branching scheme proposed by Vielma and Nemhauser (2011). Let 
                              
                                 
                                    
                                       S
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       n
                                    
                                 
                                 }
                              
                            be the set of breakpoints on axis e and 
                              
                                 
                                    
                                       I
                                    
                                    
                                       e
                                    
                                 
                                 ≔
                                 {
                                 [
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ]
                                 ,
                                 …
                                 ,
                                 [
                                 
                                    
                                       s
                                    
                                    
                                       n
                                       -
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       n
                                    
                                 
                                 ]
                                 }
                              
                            be the intervals of breakpoints. Let 
                              
                                 
                                    
                                       I
                                    
                                    
                                       e
                                    
                                 
                                 (
                                 s
                                 )
                                 ≔
                                 {
                                 I
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       e
                                    
                                 
                                 :
                                 s
                                 ∈
                                 I
                                 }
                              
                            be the intervals containing s. Let Ξ
                           
                              e
                           ([s
                           
                              i
                           ,
                           s
                           
                              i+1])=
                           i
                           +1 be the index of an interval 
                              
                                 [
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ]
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       e
                                    
                                 
                              
                           . Let 
                              
                                 B
                                 :
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 |
                                 
                                    
                                       I
                                    
                                    
                                       e
                                    
                                 
                                 |
                                 }
                                 →
                                 
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                       ⌈
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       |
                                       
                                          
                                             I
                                          
                                          
                                             e
                                          
                                       
                                       |
                                       )
                                       ⌉
                                    
                                 
                              
                            be a SOS2 compatible function, meaning that B(i) and B(i
                           +1) differ only in one bit according to the Gray code property. The vertices of the domain is 
                              
                                 V
                                 (
                                 P
                                 )
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ×
                                 ⋯
                                 ×
                                 
                                    
                                       S
                                    
                                    
                                       d
                                    
                                 
                              
                            and d is the dimension. The first phase of the branching scheme uses the sets 
                              
                                 
                                    
                                       J
                                    
                                    
                                       e
                                       ,
                                       B
                                       ,
                                       l
                                    
                                    
                                       +
                                    
                                 
                                 ≔
                                 {
                                 s
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       e
                                    
                                 
                                 :
                                 B
                                 
                                    
                                       (
                                       
                                          
                                             Ξ
                                          
                                          
                                             e
                                          
                                       
                                       (
                                       I
                                       )
                                       )
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 1
                                 ,
                                 ∀
                                 I
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       e
                                    
                                 
                                 (
                                 s
                                 )
                                 }
                              
                           
                           
                              1
                              
                                 
                                    
                                       
                                          
                                             J
                                          
                                          
                                             e
                                             ,
                                             B
                                             ,
                                             l
                                          
                                          
                                             +
                                          
                                       
                                    
                                  is the set of breakpoints s on axis e such that the binary code of all intervals that contain s has value 1 at the l
                                 
                                    th
                                  position of the code.
                           
                           
                              1
                            and 
                              
                                 
                                    
                                       J
                                    
                                    
                                       e
                                       ,
                                       B
                                       ,
                                       l
                                    
                                    
                                       0
                                    
                                 
                                 ≔
                                 {
                                 s
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       e
                                    
                                 
                                 :
                                 B
                                 
                                    
                                       (
                                       
                                          
                                             Ξ
                                          
                                          
                                             e
                                          
                                       
                                       (
                                       I
                                       )
                                       )
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 0
                                 ,
                                 ∀
                                 I
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       e
                                    
                                 
                                 (
                                 s
                                 )
                                 }
                              
                           , where l
                           ∈
                           Φ(S
                           
                              e
                           )={1,2,…,⌈log2(∣S
                           
                              e
                           ∣−1)⌉} is the position of the binary code used to represent the intervals on axis e. Notice that the number of intervals is precisely one less the number of breakpoints.

The second phase selects a simplex of the hypercube obtained in phase one using the sets 
                              
                                 
                                    
                                       L
                                    
                                    
                                       r
                                       ,
                                       s
                                    
                                 
                                 =
                                 {
                                 v
                                 ∈
                                 V
                                 (
                                 P
                                 )
                                 :
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                                 
                                 is
                                 
                                 even
                                 
                                 and
                                 
                                 
                                    
                                       v
                                    
                                    
                                       s
                                    
                                 
                                 
                                 is
                                 
                                 odd
                                 }
                              
                            and 
                              
                                 
                                    
                                       R
                                    
                                    
                                       r
                                       ,
                                       s
                                    
                                 
                                 =
                                 {
                                 v
                                 ∈
                                 V
                                 (
                                 P
                                 )
                                 :
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                                 
                                 is
                                 
                                 odd
                                 
                                 and
                                 
                                 
                                    
                                       v
                                    
                                    
                                       s
                                    
                                 
                                 
                                 is
                                 
                                 even
                                 }
                                 ,
                                 
                                 ∀
                                 r
                                 ,
                                 s
                                 ∈
                                 D
                                 =
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 d
                                 }
                              
                           , such that r
                           <
                           s.

To piecewise linearize 
                              
                                 
                                    
                                       q
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           , the Log model builds the J1 triangulation and restricts the convex combination to a single simplex implicitly through the branching scheme. This is achieved with the following equations:
                              
                                 (7a)
                                 
                                    For
                                    
                                    all
                                    
                                    n
                                    ∈
                                    N
                                    ,
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    l
                                    ∈
                                    Φ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    )
                                    :
                                 
                              
                           
                           
                              
                                 (7b)
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                
                                                   J
                                                
                                                
                                                   axis
                                                   (
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         n
                                                         ,
                                                         m
                                                      
                                                   
                                                   )
                                                   ,
                                                   B
                                                   ,
                                                   l
                                                
                                                
                                                   +
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ⩽
                                    
                                       
                                          x
                                       
                                       
                                          l
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7c)
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                
                                                   J
                                                
                                                
                                                   axis
                                                   (
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         n
                                                         ,
                                                         m
                                                      
                                                   
                                                   )
                                                   ,
                                                   B
                                                   ,
                                                   l
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   l
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7d)
                                 
                                    For
                                    
                                    all
                                    
                                    n
                                    ∈
                                    N
                                    ,
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    l
                                    ∈
                                    Φ
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    )
                                    :
                                 
                              
                           
                           
                              
                                 (7e)
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             ∈
                                             
                                                
                                                   J
                                                
                                                
                                                   axis
                                                   (
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         n
                                                         ,
                                                         m
                                                      
                                                   
                                                   )
                                                   ,
                                                   B
                                                   ,
                                                   l
                                                
                                                
                                                   +
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ˇ
                                             
                                          
                                       
                                       
                                          l
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7f)
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             ∈
                                             
                                                
                                                   J
                                                
                                                
                                                   axis
                                                   (
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         n
                                                         ,
                                                         m
                                                      
                                                   
                                                   )
                                                   ,
                                                   B
                                                   ,
                                                   l
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˇ
                                                      
                                                   
                                                
                                                
                                                   l
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7g)
                                 
                                    For
                                    
                                    all
                                    
                                    n
                                    ∈
                                    N
                                    ,
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    (
                                    r
                                    ,
                                    s
                                    )
                                    ∈
                                    
                                       
                                          Γ
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    :
                                 
                              
                           
                           
                              
                                 (7h)
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                             ∈
                                             
                                                
                                                   L
                                                
                                                
                                                   r
                                                   ,
                                                   s
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ⩽
                                    
                                       
                                          y
                                       
                                       
                                          r
                                          ,
                                          s
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7i)
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   r
                                                   ,
                                                   s
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   r
                                                   ,
                                                   s
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7j)
                                 
                                    
                                       
                                          x
                                       
                                       
                                          l
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    ,
                                    
                                    ∀
                                    n
                                    ∈
                                    N
                                    ,
                                    
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                    l
                                    ∈
                                    Φ
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    )
                                 
                              
                           
                           
                              
                                 (7k)
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ˇ
                                             
                                          
                                       
                                       
                                          l
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    ,
                                    
                                    ∀
                                    n
                                    ∈
                                    N
                                    ,
                                    
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                    l
                                    ∈
                                    Φ
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    )
                                 
                              
                           
                           
                              
                                 (7l)
                                 
                                    
                                       
                                          y
                                       
                                       
                                          r
                                          ,
                                          s
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    ,
                                    
                                    n
                                    ∈
                                    N
                                    ,
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    (
                                    r
                                    ,
                                    s
                                    )
                                    ∈
                                    
                                       
                                          Γ
                                       
                                       
                                          n
                                          ,
                                          m
                                       
                                    
                                 
                              
                           having the following extra parameters:
                              
                                 •
                                 
                                    
                                       
                                          Φ
                                          (
                                          S
                                          )
                                          =
                                          {
                                          1
                                          ,
                                          …
                                          ,
                                          ⌈
                                          
                                             
                                                log
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          |
                                          S
                                          |
                                          -
                                          1
                                          )
                                          ⌉
                                          }
                                       
                                    ;


                                    
                                       
                                          axis
                                          (
                                          Q
                                          )
                                       
                                     is the axis that contains the breakpoint set 
                                       
                                          Q
                                       
                                    ;


                                    Γ
                                    
                                       n,m
                                    ≔{(r,s)∈
                                    D
                                    ×
                                    D:r
                                    <
                                    s};


                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                r
                                                ,
                                                s
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          =
                                          {
                                          v
                                          ∈
                                          V
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          )
                                          :
                                          
                                             
                                                v
                                             
                                             
                                                r
                                             
                                          
                                          
                                          is
                                          
                                          even
                                          
                                          and
                                          
                                          
                                             
                                                v
                                             
                                             
                                                s
                                             
                                          
                                          
                                          is
                                          
                                          odd
                                          }
                                       
                                     and 
                                       
                                          
                                             
                                                R
                                             
                                             
                                                r
                                                ,
                                                s
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          =
                                          {
                                          v
                                          ∈
                                          V
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          )
                                          :
                                          
                                             
                                                v
                                             
                                             
                                                r
                                             
                                          
                                          
                                          is
                                          
                                          odd
                                          
                                          and
                                          
                                          
                                             
                                                v
                                             
                                             
                                                s
                                             
                                          
                                          
                                          is
                                          
                                          even
                                          }
                                          ,
                                          
                                          ∀
                                          r
                                          ,
                                          s
                                          ∈
                                          D
                                       
                                     such that r
                                    <
                                    s;

and extra variables:
                              
                                 •
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                l
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ˇ
                                                   
                                                
                                             
                                             
                                                l
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                     are binary variables that induce the first phase of Log branching, for each entry 
                                       
                                          l
                                          ∈
                                          Φ
                                          (
                                          
                                             
                                                K
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          )
                                       
                                     and 
                                       
                                          l
                                          ∈
                                          Φ
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          )
                                       
                                     respectively;


                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                r
                                                ,
                                                s
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                     is a binary variable that induces the second phase of the Log branching for each (r,
                                    s)∈
                                    Γ
                                    
                                       n,m
                                    .

The complete Log model for the piecewise-linear approximation of the well-production functions consists of Eqs. (6a)–(6f) and (7). A complete example of the Log model for a 2-dimensional function is found in Silva, Codas, and Camponogara (2012).

The Multiple Choice (MC) model approximates the original function using hyperplane equations for each polytope function. The domain is divided into a set of polytopes 
                           
                              P
                              ∈
                              P
                           
                        , which are described by a set of linear inequalities A
                        
                           P
                        
                        x
                        
                           P
                        
                        ⩽
                        b
                        
                           P
                        
                        y
                        
                           P
                        . A domain point x is represented by the summation of all domain variables x
                        
                           P
                        . For each polytope there is an associated hyperplane function that linearizes the original function inside that polytope. Finally, only one polytope can be active, which has an active domain point and its corresponding function value. This formulation was studied in Balakrishnan and Graves (1989), Croxton et al. (2003), and Jeroslow and Lowe (1984). The non-convex function 
                           
                              
                                 
                                    q
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             m
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                         is approximated with a PWL function using the MC model as follows:
                           
                              (8a)
                              
                                 
                                    
                                       
                                       
                                          
                                             For
                                             
                                             all
                                             
                                             n
                                             ∈
                                             N
                                             :
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      P
                                                      ∈
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                   ,
                                                   P
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8b)
                              
                                 
                                 0
                                 ⩽
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                    
                                       n
                                       ,
                                       m
                                       ,
                                       P
                                    
                                 
                                 ⩽
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                    
                                       n
                                       ,
                                       
                                          max
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       P
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                              
                           
                        
                        
                           
                              (8c)
                              
                                 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          ∈
                                          
                                             
                                                M
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                              
                           
                        
                        
                           
                              (8d)
                              
                                 
                                 
                                    
                                       p
                                    
                                    
                                       m
                                    
                                 
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          P
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       r
                                    
                                    
                                       n
                                       ,
                                       m
                                       ,
                                       P
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                        
                           
                              (8e)
                              
                                 
                                 
                                    
                                       p
                                    
                                    
                                       m
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          P
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       r
                                    
                                    
                                       n
                                       ,
                                       m
                                       ,
                                       P
                                    
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       m
                                       ,
                                       
                                          max
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 )
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                        
                           
                              (8f)
                              
                                 
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          P
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                M
                                             
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  n
                                                                  ,
                                                                  m
                                                                  ,
                                                                  P
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  r
                                                               
                                                               
                                                                  n
                                                                  ,
                                                                  m
                                                                  ,
                                                                  P
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                        
                           
                              (8g)
                              
                                 
                                 
                                    
                                       z
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       n
                                       ,
                                       L
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ⩽
                                 
                                    
                                       q
                                    
                                    
                                       n
                                       ,
                                       U
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                              
                           
                        
                        
                           
                              (8h)
                              
                                 
                                 
                                    
                                       A
                                    
                                    
                                       P
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         n
                                                         ,
                                                         m
                                                         ,
                                                         P
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         r
                                                      
                                                      
                                                         n
                                                         ,
                                                         m
                                                         ,
                                                         P
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       b
                                    
                                    
                                       P
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       P
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 P
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                              
                           
                        
                        
                           
                              (8i)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          P
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       P
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                        
                           
                              (8j)
                              
                                 
                                 
                                    
                                       p
                                    
                                    
                                       r
                                    
                                    
                                       n
                                       ,
                                       m
                                       ,
                                       P
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 P
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                              
                           
                        
                        
                           
                              (8k)
                              
                                 
                                 
                                    
                                       y
                                    
                                    
                                       P
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 P
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                              
                           
                        with additional variables:
                           
                              •
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                          
                                             n
                                             ,
                                             m
                                             ,
                                             P
                                          
                                       
                                    
                                  is the lift-gas injection rate for well n when it belongs to polytope 
                                    
                                       P
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                 ;


                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             r
                                          
                                          
                                             n
                                             ,
                                             m
                                             ,
                                             P
                                          
                                       
                                    
                                  is manifold m pressure in polytope 
                                    
                                       P
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                 ;


                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             P
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  is a binary variable that takes on value 1 when polytope 
                                    
                                       P
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  is active, and 0 otherwise;

and extra parameters:
                           
                              •
                              
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             P
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  is a matrix with the coefficients of the hyperplanes that approximate the vector function q
                                 
                                    n,m
                                  within the polytope 
                                    
                                       P
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                 ;


                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             P
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  is a vector of constants for the hyperplanes that approximate q
                                 
                                    n,m
                                  within 
                                    
                                       P
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                 ;


                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             P
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             P
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  describe the linear inequalities that define polytope 
                                    
                                       P
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                 . Since the matrix 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             P
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  may not be full rank, Eq. (8b) is needed to force 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                          
                                             n
                                             ,
                                             m
                                             ,
                                             P
                                          
                                       
                                    
                                  to zero when 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             P
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  takes on value zero. In this case, the pressure 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             r
                                          
                                          
                                             n
                                             ,
                                             m
                                             ,
                                             P
                                          
                                       
                                    
                                  does not need to be driven to zero because p
                                 
                                    m
                                  will become a free variable, bounded by other wells connected to manifold m.

The Incremental Model (Inc) approximates the original function incrementally with an ordered set of simplexes and vertices, which must induce a triangulation of the domain of the function. When approximating multivariate functions, this model requires the set of polytopes 
                           
                              P
                           
                         to be a triangulation 
                           
                              T
                           
                         with special ordering properties:
                           
                              O1:
                              The simplexes in 
                                    
                                       T
                                    
                                  must be ordered as 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             T
                                          
                                          
                                             |
                                             T
                                             |
                                          
                                       
                                    
                                  such that T
                                 
                                    i
                                 
                                 ∩
                                 T
                                 
                                    i+1
                                 ≠∅ for 
                                    
                                       i
                                       ∈
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       |
                                       T
                                       |
                                       -
                                       1
                                       }
                                    
                                 .

The vertices of each simplex T
                                 
                                    i
                                  must be ordered as 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                          
                                             |
                                             V
                                             (
                                             
                                                
                                                   T
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             |
                                             -
                                             1
                                          
                                       
                                    
                                  such that 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                          
                                             |
                                             V
                                             (
                                             
                                                
                                                   T
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             |
                                             -
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             v
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                          
                                             0
                                          
                                       
                                    
                                  for 
                                    
                                       i
                                       ∈
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       |
                                       T
                                       |
                                       -
                                       1
                                       }
                                    
                                 .

These properties ensure a total ordering among the simplexes and vertices in the domain, which is required to incrementally represent the graph of the function, 
                           
                              G
                              =
                              {
                              (
                              x
                              ,
                              f
                              (
                              x
                              )
                              )
                              :
                              x
                              ∈
                              
                              dom
                              (
                              f
                              )
                              }
                           
                        . Lee and Wilson (2001) showed that such conditions are met by several triangulations, inclusive the J1 (“Union Jack”). Dantzig (1960), Jeroslow and Lowe (1985), Keha, de Farias, and Nemhauser (2004), Lee and Wilson (2001), and Padberg (2000) have studied the Inc model which is also referred to as the delta method. More recently, Vielma et al. (2010), Croxton et al. (2003), and Keha et al. (2004) began calling it the incremental model. Below, the equations based on the incremental model are presented to approximate the non-convex function q
                        
                           n,m
                        :
                           
                              (9a)
                              
                                 
                                    
                                       
                                       
                                          
                                             For
                                             
                                             all
                                             
                                             n
                                             ∈
                                             N
                                             :
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             =
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                   ,
                                                   1
                                                   ,
                                                   0
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      |
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      |
                                                      V
                                                      (
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      |
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                            ,
                                                            0
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                             ∀
                                             m
                                             ∈
                                             
                                                
                                                   M
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9b)
                              
                                 
                                 
                                    
                                       p
                                    
                                    
                                       m
                                    
                                 
                                 ⩾
                                 
                                    
                                       p
                                    
                                    
                                       r
                                       ,
                                       1
                                       ,
                                       0
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          |
                                          
                                             
                                                T
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          |
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          |
                                          V
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          |
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                r
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                          -
                                          
                                             
                                                p
                                             
                                             
                                                r
                                                ,
                                                j
                                                ,
                                                0
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                        
                           
                              (9c)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   m
                                                
                                             
                                             ⩽
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                   ,
                                                   1
                                                   ,
                                                   0
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      |
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      |
                                                      V
                                                      (
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      |
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            r
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            r
                                                            ,
                                                            j
                                                            ,
                                                            0
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   m
                                                   ,
                                                   
                                                      max
                                                   
                                                
                                             
                                             (
                                             1
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             )
                                             ,
                                             
                                             ∀
                                             m
                                             ∈
                                             
                                                
                                                   M
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9d)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             =
                                             
                                                
                                                   q
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            i
                                                            ,
                                                            1
                                                            ,
                                                            0
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            r
                                                            ,
                                                            1
                                                            ,
                                                            0
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      |
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      |
                                                      V
                                                      (
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      |
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     q
                                                                  
                                                                  
                                                                     i
                                                                     ,
                                                                     j
                                                                     ,
                                                                     k
                                                                  
                                                                  
                                                                     n
                                                                     ,
                                                                     m
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     r
                                                                     ,
                                                                     j
                                                                     ,
                                                                     k
                                                                  
                                                                  
                                                                     n
                                                                     ,
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     q
                                                                  
                                                                  
                                                                     i
                                                                     ,
                                                                     j
                                                                     ,
                                                                     0
                                                                  
                                                                  
                                                                     n
                                                                     ,
                                                                     m
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     r
                                                                     ,
                                                                     j
                                                                     ,
                                                                     0
                                                                  
                                                                  
                                                                     n
                                                                     ,
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                             ∀
                                             m
                                             ∈
                                             
                                                
                                                   M
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9e)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             
                                                
                                                   q
                                                
                                                
                                                   n
                                                   ,
                                                   L
                                                
                                             
                                             ⩽
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             ⩽
                                             
                                                
                                                   q
                                                
                                                
                                                   n
                                                   ,
                                                   U
                                                
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             ∀
                                             m
                                             ∈
                                             
                                                
                                                   M
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9f)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          |
                                          V
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          |
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                       ,
                                       k
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ⩽
                                 
                                    
                                       z
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                        
                           
                              (9g)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             ⩾
                                             0
                                             ,
                                             
                                             ∀
                                             m
                                             ∈
                                             
                                                
                                                   M
                                                
                                                
                                                   n
                                                
                                             
                                             ,
                                             
                                             j
                                             ∈
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             |
                                             
                                                
                                                   T
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             |
                                             }
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             k
                                             ∈
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             |
                                             V
                                             (
                                             
                                                
                                                   T
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             |
                                             -
                                             1
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9h)
                              
                                 
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ⩽
                                 
                                    
                                       δ
                                    
                                    
                                       j
                                       ,
                                       |
                                       V
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       |
                                       -
                                       1
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 j
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 |
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 |
                                 -
                                 1
                                 }
                              
                           
                        
                        
                           
                              (9i)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          |
                                          V
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          |
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       j
                                       +
                                       1
                                       ,
                                       k
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ⩽
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 j
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 |
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 |
                                 -
                                 1
                                 }
                              
                           
                        
                        
                           
                              (9j)
                              
                                 
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 j
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 |
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 |
                                 -
                                 1
                                 }
                                 .
                              
                           
                        having the additional variables:
                           
                              •
                              
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             j
                                             ,
                                             k
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  is a weighting variable that incrementally represents the domain into a single polytope;


                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  assumes value 1 when the variable 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   ˆ
                                                
                                             
                                             ,
                                             |
                                             V
                                             (
                                             
                                                
                                                   T
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                             
                                             )
                                             |
                                             -
                                             1
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  of the simplex 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                       
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  takes on value 1, for all 
                                    
                                       
                                          
                                             j
                                          
                                          
                                             ˆ
                                          
                                       
                                       ⩽
                                       j
                                    
                                 . In this case, T
                                 
                                    j+1 is the active simplex of the domain;

and extra parameters:
                           
                              •
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  is the breakpoint of the lift-gas injection rate for vertex k of simplex j of well n;


                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             r
                                             ,
                                             j
                                             ,
                                             k
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  is the breakpoint of the pressure of manifold m for vertex k of simplex j;


                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  is the set of simplexes that make up the family of polytopes in the domain of the production function 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  when well n is routed to manifold m;


                                 V(T) is the set of vertices of the simplex 
                                    
                                       T
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                 .

The Inc model requires an ordering of the polytopes and vertices according to properties O1 and O2. In this work, the J1 triangulation was used for all simplex-based approximation models, inclusive Inc. To find such an ordering of the J1 triangulation, the approach below was followed:
                           
                              1.
                              An undirected graph 
                                    
                                       G
                                       =
                                       (
                                       P
                                       ,
                                       E
                                       )
                                    
                                  is obtained to represent each polytope (simplex) as a vertex P, where an edge 
                                    
                                       (
                                       P
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ∈
                                       E
                                    
                                  if and only if V(P)∩
                                 V(P′)≠∅;

A weight 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             P
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       =
                                       1
                                       /
                                       (
                                       |
                                       V
                                       (
                                       P
                                       )
                                       ∩
                                       V
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       |
                                       )
                                    
                                  is assigned to each edge, being inversely proportional to the number of shared vertices between P and P′;

A Hamiltonian path 
                                    
                                       C
                                    
                                  for 
                                    
                                       G
                                    
                                  is found by a reduction to the traveling salesman problem which is solved using the Concorde solver.

Finally, an ordering of the vertices is obtained by following the path 
                                    
                                       C
                                    
                                 , moving from one polytope P
                                 
                                    k
                                  to the next P
                                 
                                    k+1 and selecting the common vertice 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             k
                                          
                                          
                                             |
                                             V
                                             (
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             |
                                             -
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             v
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                          
                                             0
                                          
                                       
                                    
                                  at random.

In a pioneer work, Beale and Tomlin (1970) proposed a new representation for piecewise-linear functions based on the convex combination of the weighting variables λ’s associated with the vertices of the function domain. Among these weighting variables, only two of them can be nonzero and consecutive in the branch-and-bound algorithm. Such sets are called Special Ordered Sets of Type II (SOS2) and the constraints that use these sets are called SOS2 constraints.

Nowadays some general purpose solvers support SOS2 constraints. Camponogara, Nazari, and Meneses (2012) presented an example that illustrates how the SOS2 constraints can be treated in a branch-bound procedure. Assume that 
                           
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                          
                                             k
                                             (
                                             j
                                             )
                                          
                                       
                                    
                                 
                              
                           
                         are SOS2, and let 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             j
                                          
                                          
                                             k
                                             (
                                             j
                                             )
                                          
                                       
                                    
                                 
                              
                           
                         be the solution of the linear relaxation of the problem, where 
                           
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              >
                              0
                           
                         for some k
                        1, k
                        2
                        ∈{0,…,
                        k(j)}, k
                        1
                        <
                        k
                        2, and k
                        2
                        −
                        k
                        1
                        ⩾2. This violation of the SOS2 constraint can be ruled out in the branch-and-bound search by introducing the constraints 
                           
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                                 
                                    0
                                 
                              
                              =
                              ⋯
                              =
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              =
                              0
                           
                         in one branch, and 
                           
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    2
                                 
                              
                              =
                              ⋯
                              =
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                                 
                                    k
                                    (
                                    j
                                    )
                                 
                              
                              =
                              0
                           
                         in the other.


                        Beale (1980) showed how to extend SOS2 constraints to multidimensional piecewise-linear functions. Instead of using binary variables, convex combinations are limited to a hypercube of the function domain using a linked chain of SOS2 constraints. The equations that represent the well-performance curve 
                           
                              
                                 
                                    q
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             m
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                         are reformulated with SOS2 constraints as follows:
                           
                              (10a)
                              
                                 
                                    
                                       
                                       
                                          
                                             For
                                             
                                             all
                                             
                                             n
                                             ∈
                                             N
                                             :
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      m
                                                      ∈
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            n
                                                            ,
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10b)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       r
                                    
                                 
                                 ⩽
                                 
                                    
                                       p
                                    
                                    
                                       m
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                        
                           
                              (10c)
                              
                                 
                                 
                                    
                                       p
                                    
                                    
                                       m
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       r
                                    
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       m
                                       ,
                                       
                                          max
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 )
                                 ,
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                        
                           
                              (10d)
                              
                                 
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       r
                                    
                                 
                                 )
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                        
                           
                              (10e)
                              
                                 
                                 
                                    
                                       z
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       n
                                       ,
                                       L
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ⩽
                                 
                                    
                                       q
                                    
                                    
                                       n
                                       ,
                                       U
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                        
                           
                              (10f)
                              
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       p
                                    
                                    
                                       r
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                              
                           
                        
                        
                           
                              (10g)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (10h)
                              
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                              
                           
                        
                        
                           
                              (10i)
                              
                                 
                                 
                                    
                                       η
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                    
                                       p
                                    
                                    
                                       r
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                              
                           
                        
                        
                           
                              (10j)
                              
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             K
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                                
                                                   n
                                                   ,
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                 
                                 
                                 are
                                 
                                 SOS
                                 2
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        having additional variables:
                        
                           
                              •
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  is an auxiliary variable which takes on the value of the summation of the weighting variables 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  over all manifold pressures p
                                 r for a particular injection rate q
                                 i;


                                 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  is an auxiliary variable which takes on the value of the summation of the weighting variables 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                    
                                  over all q
                                 i for a particular manifold pressure p
                                 r.

The auxiliary variables 
                           
                              
                                 
                                    ξ
                                 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                           
                         and 
                           
                              
                                 
                                    η
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                           
                         compose the linked chain of SOS2 constraints that divides the domain in a grid. The SOS2 constraints (10j) limit the convex combination of the weighting variables 
                           
                              
                                 
                                    λ
                                 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                           
                         to be within a single polytope (hypercube).


                        Table 1
                         gives the number of variables and constraints of the piecewise-linear models for a general function. The total number of variables and constraints of the MILP formulation of the oil production optimization problem is omitted for being too complex, however it is a function of the size of the PWL models and the number of wells and manifolds. The size of the formulations depends on the dimension d of the function domain, the number of polytopes 
                           
                              |
                              P
                              |
                           
                        , and the number of vertices 
                           
                              |
                              V
                              (
                              P
                              )
                              |
                           
                         or ∣V(P)∣, for 
                           
                              P
                              ∈
                              P
                           
                        , with the exception of Log, MC, and SOS2.

The size of MC depends on 
                           
                              d
                              ,
                              |
                              P
                              |
                           
                        , and the number of facets of polytope P, denoted by F(P). In particular, when 
                           
                              P
                           
                         is a triangulation, 
                           
                              |
                              F
                              (
                              P
                              )
                              |
                              =
                              d
                              +
                              1
                              ,
                              
                              ∀
                              P
                              ∈
                              P
                           
                        .

For Log, the formulation size is a function of the number of vertices 
                           
                              |
                              V
                              (
                              P
                              )
                              |
                           
                         and ∣S∣, where S is a branching scheme for the J
                        1 triangulation defined in [0,
                        K]
                           d
                        , with the breakpoints being {0,1,…,
                        K}. For the two-dimensional case, 
                           
                              |
                              P
                              |
                              =
                              
                                 
                                    K
                                 
                                 
                                    d
                                 
                              
                              d
                              !
                           
                         and ∣S∣=
                        d⌈log2(K)⌉+
                        d(d
                        −1)/2. For dimensions 
                           
                              d
                              >
                              2
                              ,
                              
                              |
                              S
                              |
                              ≈
                              
                                 
                                    log
                                 
                                 
                                    2
                                 
                              
                              (
                              |
                              P
                              |
                              )
                           
                        , that is, 
                           
                              
                                 
                                    lim
                                 
                                 
                                    K
                                    →
                                    ∞
                                 
                              
                              |
                              S
                              |
                              /
                              (
                              
                                 
                                    log
                                 
                                 
                                    2
                                 
                              
                              (
                              |
                              P
                              |
                              )
                              =
                              1
                           
                         (Vielma et al., 2010).

In SOS2, the number of constraints is a function of the number of breakpoints in each axis of the grid 
                           
                              G
                              =
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    K
                                    }
                                 
                                 
                                    d
                                 
                              
                           
                        .

This section presents a computational and simulation analysis of the MILP formulations developed for the oil production optimization problem subject to routing and pressure constraints. The oil production system used as a testbed is a synthetic but representative oil field modeled with a multiphase flow simulator widely used by oil operators. The computational analysis evaluates the performance of the MILP reformulations for both hypercube and simplex approximations. Finally, a simulation analysis is performed to analyze the mean errors and respective overall benefit of these models with respect to the results obtained with the multiphase flow simulator.

The production system has N
                        =16 wells and M
                        =2 manifolds as illustrated in Fig. 4
                        . All production wells can send their production to both manifolds, i.e. 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    m
                                 
                              
                              =
                              N
                              ,
                              
                              ∀
                              m
                              ∈
                              M
                           
                        . Each manifold is connected to a dedicated separator.

The wells and manifolds are topologically divided into two groups: the wells 1–8 are 1kilometer away from manifold 1, and 10kilometers away from manifold 2, while the wells 9–16 are 1kilometer away from manifold 2, and 10kilometers away from manifold 1. The pipelines connecting wells and manifolds have 4 inches of inner diameter (ID), and 0.001inches of roughness (R). With this topological structure, 
                           
                              
                                 
                                    q
                                 
                                 
                                    n
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              )
                              ⩾
                              
                                 
                                    q
                                 
                                 
                                    n
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         if well n is closer to manifold 1 than manifold 2 for a given manifold pressure p
                        r and lift-gas injection rate q
                        i.

The Gas–Oil Ratio (GOR) and Basic Sediment and Water (BSW) fraction are given constants for each well. The liquid flow rate of each well behaves according the equation q
                        l
                        =
                        J
                        i(p
                        R
                        −
                        p
                        wf), where q
                        l
                        =
                        q
                        o
                        +
                        q
                        w, p
                        
                           wf
                         is the bottom-hole pressure, J
                        i is the well productivity index, and p
                        R is the reservoir static pressure. Table 2
                         presents the well parameters with the units of GOR, BSW, p
                        R, and J
                        i being sm3/sm3, %, psi, and STB/d/psi, respectively.

The production of manifold 1 flows through a pipeline of 10kilometers to reach a separator, while the production of manifold 2 flows through a pipeline of 5kilometers long. Both pipelines have negligible vertical elevation, ID
                        =4.5inches, and R
                        =0.001inches. The manifold pressures can vary from 300 to 800pounds per square inch, while the nominal pressure at the separator is 300pounds per square inch.

All wells have identical tubings with the following features: ID of 3inches, drilling depth of 3.7kilometers, depth of 2.7kilometers, and injection point at 2.8kilometers. The maximum flow rate of each well is 8000Million standard cubic feet per day. The well performance curves used to represent this production system are available in Silva, Codas, and Camponogara (2011). This instance was obtained using the multiphase flow simulator Schlumberger Pipesim, inspired in a synthetic field from Kosmidis et al. (2004).

This section presents a computational analysis of the application of the MILP formulations developed in this paper to the synthetic production system. The formulations were expressed in AMPL and solved with the MILP solver CPLEX 11.2 in a Linux workstation, with an Intel Core 2 Quad 2.93gigahertz processor and 4gigabytes of RAM. All experiments ran within a time limit of 10,000seconds (≈2.78hours). The instances for which the solver ran out of memory are indicated with an asterisk (☆).

For comparing the performance of the developed formulations, we analyze the impact of the number of polytopes in the domain of the PWL functions for each scenario of gas-compression capacity. This analysis aims to verify the increase in the running time as a function of the resolution quality. The analysis considered three different scenarios of lift-gas compression capacity, namely: high for 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                                 
                                    max
                                 
                              
                              =
                              3
                              ,
                              624
                              ,
                              480
                              
                              standard cubic meters per day
                           
                        , medium for 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                                 
                                    max
                                 
                              
                              =
                              453
                              ,
                              060
                              
                              standard cubic meters per day
                           
                        , and low for 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                                 
                                    max
                                 
                              
                              =
                              113
                              ,
                              265
                              
                              standard cubic meters per day
                           
                        . The resolution qualities are:
                           
                              •
                              
                                 coarse: 18 squares (six breakpoints for gas-injection and three for manifold pressure) for the production function and 25 cubes (five breakpoints for phase flow) for pressure drop in the hypercube approximation; 36 (twice the number of squares) and 150 (six times the number of cubes) polytopes for the simplex approximation, respectively;


                                 moderate: 66 squares (11 by 6) and 1000 cubes (10 breakpoints in each phase) for hypercube approximation; 132 and 6000 polytopes in the simplex approximation, respectively.


                                 fine: 180 squares (15 by 12) and 2197 cubes (13 breakpoints in each phase) for hypercube approximation; 360 and 13182 polytopes in the simplex approximation, respectively.


                        Table 3
                         gives the size of the oil production optimization problem for the instances considered in the computational analysis and each PWL model, as reported by the MILP solver.

A computational analysis of DCC, DLog, CC, and SOS2 models is performed with hypercube approximation to the oil production optimization problem. Tables 4–6
                           
                           
                            present the running time in seconds and the primal–dual gap (i.e., ∣upper-bound-best-integer∣/∣best-integer∣) for the PWL formulations considering the hypercube approximation for high, medium, and low gas-compression capacity respectively. All formulations were evaluated with coarse, moderate, and fine resolutions for each scenario of lift-gas availability.


                           Table 4 presents the results for the scenario of high availability of compression gas. With the exception of DCC and MC, all formulations reached the global optimum, with the SOS2 formulation achieving the best performance.


                           Table 5 presents the results for the scenario of medium availability of compression gas. All formulations reached the global optimum for coarse and moderate resolutions, with the exception of MC for which the optimum was found only for the coarse resolution. Although DLog was the most efficient for the coarse resolution, only the SOS2 formulation was capable of closing the primal–dual gap with the fine resolution.

When the compression capacity becomes low, the oil production optimization problem becomes more complex and only the SOS2 formulation achieves the global optimum in all resolutions as shown in Table 6. The MC formulation reached the optimal solution only in the coarse resolution, while the others reached the optimum for coarse and moderate resolutions, but failed to close the primal–dual GAP for the fine resolution.

The results from a computational analysis of DCC, DLog, CC, Log, MC, and Inc models are presented for the simplex approximation of the function domains. As before, the performance of these models considers a varying number of polytopes and three scenarios of lift-gas compression capacity.


                           Table 7
                            presents the running times in seconds and primal–dual GAPs for the scenarios of high compression capacity with coarse, moderate, and fine resolutions. All models reached the global optimum with coarse resolution fairly quickly. For a medium resolution, the optimal solution was found with all formulations but MC, which also achieved the worse performance with the coarse resolution. For a fine resolution, the MC model could not find a feasible solution and only the Log model succeeded to close the primal–dual GAP. For a high gas-compression capacity, the Log model outperformed all of the other models for all approximation qualities.


                           Tables 8 and 9
                           
                            present the results for the scenarios of medium and low compression capacity, respectively. As the compression capacity becomes constrained, the oil production optimization problem becomes harder and the primal–dual GAP cannot be closed with most of the formulations and resolutions. This was expected because the approximation with simplex is more precise but rather complex. The results with medium and low gas-compression capacity were similar: the Log model achieved the best performance, whereas only the DCC and CC models could not reach the global optimum with the coarse resolution. With a moderate resolution, only logarithmic models (Log and DLog) closed the primal–dual GAP. With a fine resolution, the solver ran out of memory with the CC model and could not find a feasible solution, however the optimal solution was found with the Log model which was faster in all scenarios and approximation qualities.

Typically, gas production from the reservoir is sufficient to sustain the nominal operation which often seeks to maximize oil production, particularly so in offshore gas-lifted oil fields. Since prices and costs are difficult to come by, the experiments considered some plausible but arbitrary values in relative terms to honor the policy of oil production maximization. To assess the impact of the costs on the objective function and computational time, a restricted sensitivity analysis was performed considering only the variation on compression cost p
                           i, a scenario of medium compression capacity, and SOS2 for hypercube approximation and Log for simplex approximation, which were the most efficient models.


                           Table 10
                            shows the influence of the compression cost on solving time and objective function. As expected, the economic gain dwindles with the increase of the cost. Solving time tends to increase with a rising cost, with the Log model performing gracefully and always reaching the optimum, while SOS2 failed to close the gap in some instances. Despite the effects on solving time, the optimal or a nearly-optimal solution was always found with both models.

The quality (benefit and mean error) of the solutions obtained by hypercube and simplex approximations are compared considering the oil-field performance estimated with a multiphase flow simulator. The simulation analysis evaluates the mean errors of the process variables calculated with the simulator and their optimizer predictions for the scenario of low compression capacity, considering three approximation resolutions: coarse, moderate, and fine.

The objective function considered for optimization is 
                           
                              f
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    m
                                    ∈
                                    M
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             o
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             o
                                          
                                          
                                             m
                                          
                                       
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             g
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             g
                                          
                                          
                                             m
                                          
                                       
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             w
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             w
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    ∑
                                 
                                 
                                    n
                                    ∈
                                    N
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                           
                         with p
                        o
                        =20, p
                        g
                        =2, p
                        w
                        =1, and p
                        i
                        =0, which were arbitrarily defined to reflect the relative values of the production phases and costs.


                        Tables 11 and 12
                        
                         present the simulated pressure flow rates handled by both manifolds according to the optimizer predictions. All optimization models suggested the same well-manifold routing. The main differences arise in the multiphase flows, pressures, and in the system total benefit.

Analyzing the hypercube-based solutions shown in Table 11, it is noticeable the effect of the resolution quality on the simulated manifold production and pressure. The solution obtained with the coarse resolution has considerably high errors, mostly in manifold 2. When the resolution is increased (moderate and fine), the errors drop to under 1.5% except for the water production. Surprisingly, the moderate resolution achieves smaller mean errors than the fine resolution. However, a better solution was found with a more precise resolution, inducing a better field operation but with higher modeling errors. Further, the oil production and benefit function are increased as the resolution increases, even though a more precise resolution induces higher errors.


                        Table 12 shows the manifold pressure and flow rates of the simplex-based solution for varying resolutions. The errors obtained with the coarse resolution were not high in manifold 1, but considerably high in manifold 2. As in the approximation with hypercubes, the errors are reduced with an increased resolution (moderate and fine resolutions). However, the moderate resolution reached a solution with smaller errors in manifold 2, while the fine resolution presented smaller errors in manifold 1. Again, it can be noticed that the oil/gas production and benefit function are increased as the resolution is improved with simplex approximation. The profit obtained in the fine resolution is about 9.89% better than with the moderate, and 9.97% better than the coarse.

@&#DISCUSSION@&#

From the computational and simulation analysis, a comparison of the approximations based on hypercubes and simplexes elicited the following remarks:
                           
                              •
                              In most cases the SOS2 model achieved a better performance for the approximations based on hypercubes. On the other hand, the Log model was the most efficient for the approximations based on simplexes, regardless of the gas-compression capacity and resolution quality. Comparing these two models, the SOS2 formulation is more efficient in only two cases: coarse and moderate resolutions with high gas-compression capacity. In all other cases, which are more complex, the Log model attained a considerably better performance, probably a consequence of the logarithmic number of binary variables and extra constraints.

Models approximated with hypercubes produced solutions with smaller mean errors than simplex approximation models. In spite of having somewhat higher mean errors the models approximated with simplexes produced solutions that, when implemented in the simulator, achieved a little lower benefit (0.47%) in the moderate resolution, but considerably higher benefits ($) in coarse (4.29%) and fine (8.13%) resolutions. The analysis indicates that solutions obtained with simplex approximations can induce better operating points for the oil field, despite the higher mean errors.

@&#SUMMARY@&#

This work proposed a framework for modeling pressure drops and well-production functions with multidimensional piecewise-linear models for production optimization of lifted-gas oil fields. This framework contains several MILP reformulations of the original non-linear optimization problem with approximations based on hypercubes and simplexes. Computational and simulation analyses were performed considering a synthetic however representative oil field modeled with a commercial multiphase flow simulator. The results from theses analyses can guide operations engineers to implement a customized optimization solution for real-world oil fields.

The computational analysis indicated that the SOS2 model achieves better performance for hypercube-based approximations, while the Log model is the most efficient for simplex-based approximations. Considering both hypercube- and simplex-based approximations, the Log model outperforms all of the other models for the hard scenarios, possibly a consequence of its logarithmic number of binary variables and additional constraints.

The simulation analysis of a synthetic oil field showed that mean errors tend to decrease as the resolution quality increases. Models approximated with hypercubes induced smaller mean errors than with simplexes considering the simulation results, however better operating points with a higher benefit were achieved with simplex-based approximations.

Future research include the design of more detailed models for pressure drop, possibly including temperature and outlet pressure in the pipelines, the integration with compressor scheduling (Camponogara et al., 2012), and the identification of problem-dependent cutting planes.

@&#ACKNOWLEDGMENTS@&#

The authors thank the reviewers for their invaluable comments and contributions.

@&#REFERENCES@&#

