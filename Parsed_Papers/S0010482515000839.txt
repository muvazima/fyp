@&#MAIN-TITLE@&#Automatic detection of atrial fibrillation using stationary wavelet transform and support vector machine

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel method for automatic detection of Atrial fibrillation (AF) is proposed.


                        
                        
                           
                           This method eliminates the need for P and/or R peak detection.


                        
                        
                           
                           Sensitivity and specificity of the method is 97.0% and 97.1%, respectively.


                        
                        
                           
                           It holds several interesting properties suitable for practical applications.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Atrial fibrillation

Support vector machine

Wavelet transform

Cardiac arrhythmia

Log-energy entropy

ROC curve analysis

@&#ABSTRACT@&#


               
               
                  Background
                  Atrial fibrillation (AF) is the most common cardiac arrhythmia, and a major public health burden associated with significant morbidity and mortality. Automatic detection of AF could substantially help in early diagnosis, management and consequently prevention of the complications associated with chronic AF. In this paper, we propose a novel method for automatic AF detection.
               
               
                  Method
                  Stationary wavelet transform and support vector machine have been employed to detect AF episodes. The proposed method eliminates the need for P-peak or R-Peak detection (a pre-processing step required by many existing algorithms), and hence its performance (sensitivity, specificity) does not depend on the performance of beat detection. The proposed method has been compared with those of the existing methods in terms of various measures including performance, transition time (detection delay associated with transitioning from a non-AF to AF episode), and computation time (using MIT-BIH Atrial Fibrillation database).
               
               
                  Results
                  Results of a stratified 2-fold cross-validation reveals that the area under the Receiver Operative Characteristics (ROC) curve of the proposed method is 99.5%. Moreover, the method maintains its high accuracy regardless of the choice of the parameters׳ values and even for data segments as short as 10s. Using the optimal values of the parameters, the method achieves sensitivity and specificity of 97.0% and 97.1%, respectively.
               
               
                  Discussion
                  The proposed AF detection method has high sensitivity and specificity, and holds several interesting properties which make it a suitable choice for practical applications.
               
            

@&#INTRODUCTION@&#

Atrial fibrillation (AF) is the most common cardiac arrhythmia with an estimated prevalence of 1% corresponding to 2.3 million patients in the US and 4.5 million in the European Union [1]. This prevalence is strongly associated with age, such that over 17% of people aged 85 or above are AF patients [2]. It is expected that the number of AF patients in U.S. will increase by 2.5-fold to more than 5.6 million people by 2050 [3]. This increase not only reflects the growing population of elderly individuals, but also improved survival of people with predisposing conditions to AF (e.g. ischemic heart disease) [4]. The presence of AF is associated with a 5-fold increased risk of stroke [5] and about 2-fold increased risk of death, independent of other risk factors [6]. Furthermore, due to high rates of hospitalization and considerable health resource utilization, the economic and clinical burden of AF is substantial and will continue to increase in the future [7].

AF is usually characterized by rapidity and irregularity of ventricular contraction [8]. The chronic forms of AF can be paroxysmal AF (more than one episode with spontaneous termination within seven days); persistent AF (not self-terminated, or lasted more than seven days) and permanent AF (not terminated, or terminated but relapsed) [9]. Silent or asymptomatic AF can also occur in any of these temporal forms, carrying a similar prognosis to symptomatic AF [10]. Chronic AF adversely affects the blood flow dynamics and can result in the stroke. Early and accurate detection of AF and its management (e.g. anticoagulation, antiarrhythmic therapy and radiofrequency ablation) could substantially help in prevention of the complications associated with the chronic AF.

Currently, the diagnosis of AF mainly rests on the presence of related symptoms (e.g. shortness of breath and fatigue), followed by an electrocardiogram (ECG) study to verify the diagnosis. During the ECG study, a trained clinician/technician visually inspects the ECG signal collected over short period of time (e.g. less than 48h) to identify the AF associated chaotic patterns or abnormal changes in the waveform morphology.

Early and accurate diagnosis of AF is a challenging task. As a result, a majority of the early stage and easily treatable AF cases are not diagnosed in time and evolves into chronic debilitating AF with high cardiac related complications. Several factors hinder the accurate and early detection of AF:
                        
                           •
                           Many of the AF patients do not experience symptoms. Hence, a considerable number of AF cases are undetected or diagnosed fortuitously when the subject is being evaluated for other cardiac complications. Moreover, the studies have shown that a good correlation does not always exist between symptoms and episodes of AF [11].

ECG study can miss detection of AF in patients with paroxysmal intermittent AF who are not experiencing AF episodes during the study.

Visual inspection of hours of collected ECG is time consuming.

Accurate interpretation of ECG study requires extensive training and experience. Hence, the reliability of diagnosis is dependent on the level of training or experience of the clinician. In fact, studies have shown that many primary care practitioners are not able to detect AF (on an ECG) with sufficient accuracy to guide therapy [12].

A possible solution to this problem is automatic AF detection using ambulatory monitoring. This approach could eliminate the need for visual inspection, and contribute to early and accurate detection of AF by allowing for an in-depth analysis of ECG and identification of abnormal patterns.

Over the last two decades, several algorithms have been developed for automatic AF detection. Many of these algorithms either rely on the absence of P-waves (replaced by rapid oscillations or fibrillatory waves) [13–16] or R–R irregularities [17–21], or combination of both characteristics to detect AF episodes [22–24]. As P-waves are prone to contamination with motion and noise artifacts, the AF detection algorithms solely based on the absence of P-waves perform poorly in the presence of noise [25]. Therefore, employing heart rate variability for AF detection has become a preferred approach in recent years. But many of these R–R interval based methods compare the density histogram of R–R intervals for a segment of data with previously compiled histograms of R–R intervals during AF using the Kolmogorov–Smirnov test [18,24,26]. Since these algorithms require storage of large amount of histogram data, they may not be suitable for implementation in an ambulatory monitoring device with limited memory and processing power. Other R–R algorithms need various parameters׳ tuning to guarantee the high accuracy of AF detection [19–21]. Furthermore, most of the existing methods do not perform well with short data segments (less than one minute) [25]. This deficiency may result in missing short-duration AF episodes (prevalent in Paroxysmal or early stage AF), less accurate calculation of AF burden (a measure of the percent of time a patient spends in AF), and a lower speed of AF detection. Lastly, a majority of existing approaches for AF detection require P or R peak detection as a pre-processing step and consequently their performance will degrade if the related peaks are missed or erroneously detected.

Aimed at addressing the existing issues, the current work proposes a novel method for automatic AF detection using stationary wavelet transform (SWT) and support vector machine (SVM). As opposed to traditional methods, the proposed method does not require P or R peak detection pre-processing step. Only few parameters are involved in the development of the proposed method and the method maintains its high accuracy regardless of the choice of the parameters׳ values. The proposed method also performs well even for short data segments of 10s. In what follows, we first describe (Section 2) our proposed method in detail. Then in Section 3, we present the result of applying the proposed method on MIT-BIH Atrial fibrillation database. These results are discussed and compared with those of the existing methods in Section 4. Conclusions are presented in Section 5.

The proposed method consists of three major steps: pre-processing; feature extraction; and AF classification. 
                        Fig. 1 illustrates a block diagram of various steps of this method. In the following sub-sections, we will describe each step in detail.

The incoming ECG signal is divided every 
                              T
                            seconds into segments of length 
                              T
                           . An elliptical band-pass filter with pass-band of 0.5–50Hz (effective filter order of 10) is applied to each data segment to remove noise and baseline wander. After filtering in the forward direction, the filtered sequence was then reversed and run back through the filter to obtain a zero-phase distortion. Then a wavelet transform is performed on the filtered data segments.

Wavelet transform has proved to be a useful tool for denoising, delineation and compression of signals. Using wavelet transform, one can observe a signal at different scales where each scale emphasizes on various signal properties and characteristics [27]. Wavelet transform allows for the analysis of transients, aperiodicity and other non-stationary signal features where, through the interrogation of the transform, subtle changes in signal morphology may be highlighted over the scales of interest [28].

In the current work, we employ wavelet transform which allows for arbitrarily high resolution of the high frequency signal components (in contrast to short term Fourier transform) and then extract features that would enable us to detect AF episodes. Among several wavelet transform techniques, we choose stationary wavelet transform (SWT). SWT is time-invariant and at each decomposition level, its wavelet coefficients carry the same number of samples (temporal information) as that of the original signal. SWT overcomes the problem of repeatability and robustness of the analysis which exists with a discrete wavelet transform. We leverage these remarkable properties of SWT, and employ it for the purpose of AF detection.

It is known that to implement SWT with 
                              L
                           -levels on a signal, the length of signal should be a multiple of 
                              
                                 
                                    2
                                 
                                 L
                              
                           . In order to meet this data length requirement, we zero-pad the filtered data segment (Let us call the zero-padded signal 
                              x
                              (
                              n
                              )
                            where 
                              n
                              =
                              1
                              ,
                              ..
                              .
                              ,
                              N
                           ). 
                           Fig. 2 presents a tree-structure diagram of an 
                              L
                           -level SWT 
                              (
                              ℓ
                              =
                              1
                              ,
                              2
                              ,
                              ..
                              .
                              ,
                              L
                              )
                           .

In this figure, 
                              G
                              (
                              z
                              )
                            and 
                              H
                              (
                              z
                              )
                            are high-pass and low-pass filters respectively, designed based on the wavelet basis function, and 
                              X
                              (
                              z
                              )
                            is the zero-padded signal in z-domain. Note that at decomposition level 
                              ℓ
                           , the impulse responses of high-pass filter 
                              G
                              (
                              
                                 
                                    z
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          ℓ
                                          −
                                          1
                                       
                                    
                                 
                              
                              )
                            and low-pass filter 
                              H
                              (
                              
                                 
                                    z
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          ℓ
                                          −
                                          1
                                       
                                    
                                 
                              
                              )
                            are up-sampled versions (by a factor of 2) of impulse responses of high-pass filter 
                              G
                              (
                              
                                 
                                    z
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          ℓ
                                          −
                                          2
                                       
                                    
                                 
                              
                              )
                            and low-pass filter 
                              H
                              (
                              
                                 
                                    z
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          ℓ
                                          −
                                          2
                                       
                                    
                                 
                              
                              )
                            at previous level 
                              (
                              ℓ
                              −
                              1
                              )
                           . The detail coefficients 
                              
                                 
                                    d
                                 
                                 
                                    ℓ
                                 
                              
                              (
                              n
                              )
                            and coarse coefficients 
                              
                                 
                                    c
                                 
                                 
                                    ℓ
                                 
                              
                              (
                              n
                              )
                            in time domain can be recursively obtained as
                              
                                 (1)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                (
                                                z
                                                )
                                                =
                                                G
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      
                                                         
                                                            2
                                                         
                                                         
                                                            ℓ
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                                )
                                                .
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      ℓ
                                                      −
                                                      1
                                                   
                                                
                                                (
                                                z
                                                )
                                                ⇒
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                (
                                                n
                                                )
                                                =
                                                
                                                   
                                                      ∑
                                                      m
                                                   
                                                   
                                                      g
                                                      (
                                                      n
                                                      )
                                                      .
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            ℓ
                                                            −
                                                            1
                                                         
                                                      
                                                      (
                                                      n
                                                      −
                                                      
                                                         
                                                            2
                                                         
                                                         
                                                            ℓ
                                                            −
                                                            1
                                                         
                                                      
                                                      m
                                                      )
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                (
                                                z
                                                )
                                                =
                                                H
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      
                                                         
                                                            2
                                                         
                                                         
                                                            ℓ
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                                )
                                                .
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ℓ
                                                      −
                                                      1
                                                   
                                                
                                                (
                                                z
                                                )
                                                ⇒
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                (
                                                n
                                                )
                                                =
                                                
                                                   
                                                      ∑
                                                      m
                                                   
                                                   
                                                      h
                                                      (
                                                      n
                                                      )
                                                      .
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            ℓ
                                                            −
                                                            1
                                                         
                                                      
                                                      (
                                                      n
                                                      −
                                                      
                                                         
                                                            2
                                                         
                                                         
                                                            ℓ
                                                            −
                                                            1
                                                         
                                                      
                                                      m
                                                      )
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    n
                                    =
                                    1
                                    ,
                                    ..
                                    .
                                    ,
                                    N
                                 
                              
                           
                        

Hence, at the end of pre-processing step, a total of 
                              2
                              ×
                              L
                            time series are generated (L detail coefficients and L coarse coefficients), where each coefficient time series has the same time resolution as the original signal 
                              x
                              (
                              n
                              )
                           . Note that the optimal value for the length of the data segment (T) is not a trivial choice. The parameter tuning to maximize the performance of the proposed method will be discussed later in Section 2.3.

Following the calculation of wavelet coefficients, at this step, two features are extracted for each coefficient: Peak-to-average power ratio; and log-energy entropy. These features are later used in combination with a support vector machine classifier to detect AF.

The power spectrum of the wavelet coefficients at each level provides spectral information of ECG signal for different scales [29], and hence it can be used to analyze atrial activity. In fact, power spectrogram of detail coefficient at 
                                 ℓ
                                 th
                               level 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       ℓ
                                    
                                    
                                       D
                                    
                                 
                                 (
                                 f
                                 )
                                 )
                               and that of coarse coefficient 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       ℓ
                                    
                                    
                                       C
                                    
                                 
                                 (
                                 f
                                 )
                                 )
                               can be expressed as
                                 
                                    (2)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         ℓ
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                   (
                                                   f
                                                   )
                                                   =
                                                   Ε
                                                   {
                                                   |
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   (
                                                   f
                                                   )
                                                   
                                                      
                                                         |
                                                      
                                                      2
                                                   
                                                   }
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         ℓ
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                   (
                                                   f
                                                   )
                                                   =
                                                   Ε
                                                   {
                                                   |
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   (
                                                   f
                                                   )
                                                   
                                                      
                                                         |
                                                      
                                                      2
                                                   
                                                   }
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              where 
                                 Ε
                               denotes expectation operation, and 
                                 
                                    
                                       D
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 f
                                 )
                               and 
                                 
                                    
                                       C
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 f
                                 )
                               are Fourier transforms of detail coefficient 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 f
                                 )
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 z
                                 )
                                 
                                    
                                       |
                                    
                                    
                                       z
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             j
                                             2
                                             π
                                             f
                                             t
                                          
                                       
                                    
                                 
                                 )
                               and coarse coefficient 
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 f
                                 )
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 z
                                 )
                                 
                                    
                                       |
                                    
                                    
                                       z
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             j
                                             2
                                             π
                                             f
                                             t
                                          
                                       
                                    
                                 
                                 )
                              , respectively.

It is known that atrial activity usually occurs in the frequency range of F=[4–9Hz]. Therefore during an AF episode, one can expect to have higher power concentration in this frequency range [25]. Peak-to-average power ratio has been shown to be effective in capturing the power distribution profile in the aforementioned frequency range [29], and is obtained according to the following formula:
                                 
                                    (3)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ℓ
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               max
                                                               
                                                               
                                                                  
                                                                     S
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                                  
                                                                     D
                                                                  
                                                               
                                                               (
                                                               f
                                                               )
                                                            
                                                            
                                                               f
                                                               ∈
                                                               F
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ∫
                                                            
                                                               f
                                                               ∈
                                                               F
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  D
                                                               
                                                            
                                                            (
                                                            f
                                                            )
                                                         
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ℓ
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               max
                                                               
                                                               
                                                                  
                                                                     S
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                                  
                                                                     C
                                                                  
                                                               
                                                               (
                                                               f
                                                               )
                                                            
                                                            
                                                               f
                                                               ∈
                                                               F
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ∫
                                                            
                                                               f
                                                               ∈
                                                               F
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  C
                                                               
                                                            
                                                            (
                                                            f
                                                            )
                                                         
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    
                                       ρ
                                    
                                    
                                       ℓ
                                    
                                    
                                       D
                                    
                                 
                               and 
                                 
                                    
                                       ρ
                                    
                                    
                                       ℓ
                                    
                                    
                                       C
                                    
                                 
                               are Peak-to-average power ratio of detail and coarse coefficients at level 
                                 ℓ
                              , respectively. By calculating 
                                 
                                    
                                       ρ
                                    
                                    
                                       ℓ
                                    
                                    
                                       D
                                    
                                 
                               and 
                                 
                                    
                                       ρ
                                    
                                    
                                       ℓ
                                    
                                    
                                       C
                                    
                                 
                               for all levels 
                                 ℓ
                                 =
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 ..
                                 .
                                 ,
                                 L
                                 }
                              , we obtain 2×L power spectrum related features for each data segment.

Entropy is a measure of the degree of disorder, uncertainty or randomness of a signal. Wavelet entropy provides useful information about the underlying dynamic system (associated with a signal) over different frequency bands. For example, entropy of a mono-frequency signal is very low, given that the wavelet coefficient at the decomposition level containing the representative frequency will contain most of the signal energy. In contrast, a random white noise has high entropy, as there is a significant contribution of energy from wavelet coefficients at various decomposition levels [30].

During AF, electrical discharges conducted from the atrium into the ventricles are irregular and disorganized. Consequently, one can expect that the ECG signal demonstrates more degree of randomness and a higher entropy during an AF episode [30]. Leveraging this note, in order to reveal underlying dynamic process relevant to AF pathology, we calculate the wavelet entropy of the signal. Various wavelet entropy measures have been defined. In this paper, we use a simple non-normalized log-energy entropy [31] (which is conveniently included in Matlab Wavelet Packet and quickly executable) defined as
                                 
                                    (4)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         ℓ
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      log
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  ℓ
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         ℓ
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      log
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  ℓ
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                            )
                                                         
                                                         2
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    
                                       E
                                    
                                    
                                       ℓ
                                    
                                    
                                       D
                                    
                                 
                               and 
                                 
                                    
                                       E
                                    
                                    
                                       ℓ
                                    
                                    
                                       C
                                    
                                 
                               are the log-energy entropy of detail coefficient and coarse coefficient at 
                                 ℓ
                                 th
                               level, respectively. Calculation of log-energy entropy for all wavelet coefficients results in obtaining 
                                 2
                                 ×
                                 L
                               time related features for each data segment. Hence, at the end of this step, a vector of 
                                 4
                                 ×
                                 L
                               features are extracted for each data segment as
                                 
                                    (5)
                                    
                                       Φ
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ρ
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  C
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ..
                                                            .
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  ρ
                                                               
                                                               
                                                                  L
                                                               
                                                               
                                                                  C
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  ρ
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  D
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ..
                                                            .
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  ρ
                                                               
                                                               
                                                                  L
                                                               
                                                               
                                                                  D
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  C
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ..
                                                            .
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  L
                                                               
                                                               
                                                                  C
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  D
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ..
                                                            .
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  L
                                                               
                                                               
                                                                  D
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          T
                                       
                                       .
                                    
                                 
                              
                           

Our goal is to classify each data segment into AF or non-AF category using 
                              4
                              ×
                              L
                            extracted features. For this purpose, we employ support vector machine (SVM) as our classification algorithm. SVM is a non-parametric binary classifier which has shown promising results in various medical diagnostics [32–35].

In a conventional problem of binary classification, a data point is viewed as a p-dimensional vector which belongs to one the two possible categories. An SVM classifies these data points by finding the best (p−1)-dimensional hyperplane that separates all data points of one class from those of the other class. The separating hyperplane has the largest margin between the two classes (Margin is the maximal width of the slab parallel to the hyperplane that has no interior data points). SVM then classifies new samples based on which side of the hyperplane they fall into and how far the samples are from the hyperplane (SVM score)[36]. One of the major advantages of SVM is that in addition to linear classification, it can efficiently perform a non-linear classification [37]. Using a kernel trick, samples are mapped into higher-dimensional feature space where a linear classifier can separate the two classes with the largest margin among the samples. Mapping the separating hyperplane back to the original space results in having a non-linear classifier.

For our AF detection, we use a common kernel choice, Gaussian Radial Basis Function kernel
                              
                                 (6)
                                 
                                    K
                                    (
                                    
                                       
                                          Φ
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          Φ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                      ‖
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           with scaling factor 
                              σ
                              =
                              1
                           . 
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    Φ
                                 
                                 
                                    j
                                 
                              
                            are features of two data segments and 
                              
                                 
                                    ‖
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             Φ
                                          
                                          
                                             j
                                          
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                            is the squares Euclidean distance between the two feature vectors. The separating hyperplane for our SVM classifier is obtained using the conventional “Least-Squares” method.

To evaluate the performance of the proposed method, we employ MIT-BIH Atrial fibrillation (MIT-BIH AFIB) dataset [38], the most popular and most frequently used publicly available dataset for AF detection. This dataset contains 23 annotated records of ECG signal from atrial fibrillation patients (mostly paroxysmal) with sampling frequency of 250Hz and 12-bit resolution over a range of ±10mV. Each record is about 10h-long and the whole dataset includes slightly less than 234h of data. The dataset has 605 annotated episodes: 291 atrial fibrillation episodes with average time duration of 115s, 14 atrial flutter episodes with average time duration of 419s, 12 episodes of junctional rhythm with average time duration of 27s and 288 episodes of all other rhythms with average time duration of 174s. 
                        Fig. 3 presents examples of ECG signal during four annotated episodes.

Daubechies 5 is an orthogonal wavelet resembling the ECG waveform in morphology [29]. Hence, we choose the Daubechies 5 wavelet as the mother wavelet to perform wavelet analysis. Given the sampling frequency of 250Hz and the frequency range of atrial activities (4–9Hz) [39], a 
                           L
                           =
                           6
                         level wavelet transform is implemented. A periodogram spectral estimator with a Hamming window is used to obtain the power spectrum of each wavelet coefficient.

The original beat-to-beat annotations of data are converted to a 
                           T
                        -second resolution (
                           T
                         is the duration of each data segment) by using a minimum percentage parameter 
                           P
                         
                        [19,20]: A data segment is classified as a true AF only if the percentage of annotated AF beats in that data segment is more than 
                           P
                        . A two-fold stratified cross-validation on the feature vectors (extracted from the dataset) is employed to train and test the classifier. At the testing phase of each fold, SVM׳s scores for the testing samples (distance of the testing samples to the separating hyperplane) are obtained and compared with a pre-set threshold 
                           ς
                         to classify corresponding testing samples. The classification results (from each fold) is then compared to the ground truth (converted annotation) and number of True Positive (TP), False Negative (FN), True Negative (TN) and False Positive (FP) cases are calculated. Finally, the results from the two folds are combined to calculate True Positive Rate (TPR) as 
                           T
                           P
                           R
                           =
                           T
                           P
                           /
                           T
                           P
                           +
                           F
                           N
                        , False Positive Rate (FPR) as 
                           F
                           P
                           R
                           =
                           F
                           P
                           /
                           F
                           P
                           +
                           T
                           N
                         and Accuracy (ACC) as 
                           A
                           C
                           C
                           =
                           T
                           P
                           +
                           T
                           N
                           /
                           T
                           P
                           +
                           T
                           N
                           +
                           F
                           P
                           +
                           F
                           N
                        .

In order to obtain the optimal values of the parameters of the proposed method (
                           T
                        , 
                           P
                         and 
                           ς
                        ), an exhaustive standard Receiver Operating Characteristic (ROC) Curve analysis is implemented as the following: Parameter 
                           T
                         (length of the data segment in seconds) is varied over a reasonable range of 10–120s with incremental steps of 5s. Parameter 
                           P
                         (percentage threshold for annotation of AF data segments) is varied from 0% to 100% with incremental steps of 10%. Then for each specific value of 
                           T
                         and 
                           P
                        , an ROC curve is derived by varying the score threshold 
                           ς
                         from −1.5 to 1.5 with incremental steps of 0.01. The ROC with the highest Area Under the Curve (AUC) is used to obtain the optimal values of parameters 
                           T
                         and 
                           P
                        . Furthermore, the score threshold 
                           ς
                         corresponding to the knee point of this ROC curve (closest point to ideal performance of FPR=0 and TPR=1) is considered as the optimal value for score threshold.

To further investigate the efficacy of the chosen classification algorithm (SVM), we compare the ROC curve of AF detection using SVM classifier with those of three other popular classifiers—viz., Naïve Bayesian, Linear discriminant Analysis (LDA), and Logistic Regression. For this purpose, the ROC curves of other classifiers are obtained similar to that of SVM by varying either the score threshold (logistic regression), or a threshold on the AF posteriori (Naïve Bayesian, LDA). Finally, we compare the performance of our proposed method with those of the existing AF detection methods in terms of various measures including accuracy, transition time, and computation time.

@&#RESULTS@&#


                     
                     Fig. 4 presents a typical ECG waveform prior to and during an AF (extracted from 6th AF episode of file 4048 in MIT-BIH AFIB database), along with its detail wavelet coefficients at levels 4–6 (
                        
                           
                              d
                           
                           
                              4
                           
                        
                        (
                        n
                        )
                        ,
                        
                        
                           
                              d
                           
                           
                              5
                           
                        
                        (
                        n
                        )
                      and 
                        
                           
                              d
                           
                           
                              6
                           
                        
                        (
                        n
                        )
                     ). This example demonstrates signature characteristics of an AF episode, namely irregular R–R interval and absence of P wave. It also shows the efficacy of wavelet transform to capture the atrial activity, especially at detail coefficients.


                     
                     Fig. 5 presents two examples of the application of the proposed method (with 
                        T
                        =
                        10
                      and 
                        P
                        =
                        50
                        %
                     ), on segments of ECG signal. The ECG signal of Fig. 5(A) contains the 8th AF episode of file 4936, while the ECG signal of Fig. 5(E) contains the 27th normal sinus rhythm (NSR) episode of file 8219. From Fig. 5(D), we observe that by using a score threshold of 
                        ς
                        =
                        0
                     , our proposed method is able to correctly identify the entire AF episode (a true positive case). Similarly, as displayed in Fig. 5(H), our proposed method is able to correctly identify the entire non-AF episode (a true negative case).

The application of the proposed method resulted in few cases of false negative and false positive in detection of AF episodes. 
                     Fig. 6 presents two examples of those cases (a false negative and a false positive case). The ECG signal of Fig. 6(A) contains the 2th AF episode of file 4746, while the ECG signal of Fig. 6(E) contains the 26th NSR episode of file 4936. As Fig. 6(D) illustrates, with T=10s, our proposed method has missed the detection of the short AF episode (a false negative case). Note that in both of the two 10-s data segments which partially contain the AF episode (corresponding to time between 30 and 50), only less than 
                        P
                        =
                        50
                        %
                      of the segment holds the AF pattern. This could have contributed to missing the detection of the related AF episode. On the other hand, Fig. 6(H) shows that although our proposed method has been able to identify the NSR episode, but its estimated duration is less than the duration of the annotated episode. This is due to the fact that calculated SVM score for the 4th 10s data segment (corresponding to time between 30 and 40) is slightly above the threshold 
                        ς
                        =
                        0
                     , and hence, this data segment has been falsely detected as AF (false positive case).


                     
                     Fig. 7 presents two more examples of false positive cases. The ECG signal of Fig. 7(A) (extracted from file 6426) contains an atrial flutter episode with duration of approximately 118s. As Fig. 7(D) illustrates, few data segments along the corresponding atrial flutter episode have been wrongly detected as atrial fibrillation. The ECG signal of Fig. 7(E) contains a junction rhythm episode of file 7879. Similarly (as Fig. 7(H) demonstrates), the proposed method has falsely labeled the junction rhythm episode as an AF episode. In both examples, the irregularity associated with a non-AF episode (i.e., atrial flutter, and junctional rhythm) has resulted in a false positive case. To evaluate the prevalence of the false positive (and false negative cases), we employed the ROC curve analysis (
                     Fig. 8).

Note that although Fig. 8 depicts the results of parameter value optimization only for few values of 
                        T
                      and 
                        P
                     , we performed the actual parameter optimization on the entire range of each parameter, as described in Section 2.3. It can be noticed that the ROC curves of both subplots (Fig. 8(A,B)) are very closely spaced. In fact, our results showed that the AUC of all four ROC curves of Fig. 8(A) and all 5 ROC curves of Fig. 8(B) are above 0.992. This indicates that our proposed method is able to maintain its high accuracy regardless of the choice of the parameter values 
                        T
                      and 
                        P
                     . Nevertheless, the highest AUC of 0.995 is obtained when 
                        T
                        =
                        30
                      and 
                        P
                        =
                        50
                        %
                     . Moreover, the score threshold 
                        ς
                     corresponding to the knee point of the ROC curve with 
                        T
                        =
                        30
                      and 
                        P
                        =
                        50
                        %
                      (closest point to the ideal performance of FPR=0 and TPR=1) is 
                        ς
                        =
                        −
                        0.05
                     .


                     
                     Fig. 9(A) presents results of AF detection (with 
                        T
                        =
                        30
                      and 
                        P
                        =
                        50
                        %
                     ), obtained from applying various classification algorithms on the extracted 28-dimensional feature space. Note that similar to Fig. 8, all the ROC curves are calculated by using a two-fold stratified cross validation as described in Section 2.3. We observe that Naïve Bayesian classifier with AUC of 0.915 has the lowest accuracy. LDA and Logistic regression perform slightly better with AUC of 0.937 and 0.949, respectively, while our proposed SVM classifier achieves the best performance with AUC of 0.995.


                     Fig. 9(B) compares the result of AF detection using our proposed method with that of Weng et al. which have used a similar SWT approach [29]. We observe that AUC of Weng method is 0.89, and hence our proposed method outperforms Weng method by 10%. Furthermore, at sensitivity of 100%, the specificity of the proposed method is 86.3%, while the specificity of the Weng method is only 2%. Finally, 
                     Table 1 summarizes the result of the performance of our proposed method on MIT_BIH AFIB database (two-fold stratified cross-validation) using the optimal values of the parameters 
                        P
                        =
                        50
                        %
                      an 
                        ς
                        =
                        −
                        0.05
                     . With optimal data length of 
                        T
                        =
                        30
                     , our method achieves sensitivity of 97%, specificity of 97.1% and an accuracy of 97.1%.

To complete our study, we also analyzed the transition delay and computation time of our proposed method. Note that in all segment-based AF detection methods, the transition from a non-AF to an AF episode is detected with a delay (i.e. transition delay). For example, the transition delay in the Fig. 5 is 6.8s. In general, transition delay is a function of the length of the data segment 
                        (
                        T
                        )
                     , and a longer data segment will induce a larger transition delay. Our analysis showed that the median transition delay of our proposed method for 
                        T
                        =
                        10
                      is 9.8s.

The computation time of our proposed method implemented in Matlab 2012a (on an Intel® core™ CPU@ 3.5GHz, 32 GB RAM, 64bit OS) is approximately 35ms and 40ms, with 
                        T
                        =
                        10
                      and 
                        T
                        =
                        30
                     , respectively. Given this short computation time, our proposed algorithm is easily realizable in real-time for automatic AF detection.

@&#DISCUSSION@&#

Automatic and accurate detection of AF using ambulatory ECG monitoring could lead to earlier diagnosis, and consequently provides more opportunities for effective management or treatment of the condition, and avoiding the complications associated with chronic AF.

Over the last two decades, several algorithms have been developed for automatic AF detection. These algorithms either rely on the absence of P-waves or R–R irregularities, or combination of both characteristics to detect AF episodes. 
                     Table 2 lists some of the most-cited and recently proposed AF detection algorithms. Among the listed methods, algorithm #1 is a P-wave-based method, algorithms #2–#6 are R–R interval-based algorithms, and algorithms # 7–#9 use the combination of these characteristics to detect AF. Note that all of these algorithms require a pre-processing step where the P and/or R peaks of ECG signals need to be located. As a result, their performances depend on the accuracy of peak detection step and they do not perform well in the case of missing peaks or erroneously detected peaks.

The current work introduces a novel AF detection method which does not require any P and/or R peak detection step. Our method leverages on the high time-frequency resolution of stationary wavelet transform, and captures atrial activity by calculating peak-to-average power spectrum ratio over different frequency bands. Furthermore, we extract the log-energy entropy of the wavelet coefficients, to enhance the performance of the method. The extracted features are then classified into AF (and non-AF) cases using a support vector machine.

The proposed algorithm has only few parameters to optimize: segment length 
                           T
                        , minimum AF percentage 
                           P
                        , and SVM score threshold 
                           ς
                        . Interestingly, the results of our parameter optimization (Fig. 8) indicated that the method maintains its high accuracy regardless of the choice of 
                           T
                         and 
                           P
                         values (less than 0.3% change in AUC). In contrast to our method, many of the existing algorithms need to tune at least 5 parameters to guarantee a high performance [19–21]. Moreover, the accuracy of these methods is much more sensitive to the choice of those parameters. For example, in Dash [20] changing the segment length from 128 beats to 64 beats decreases TPR by more than 10% (from 96% to approximately 85%), whereas in Lee method the TPR decreases by 5%, if one changes the segment length from 64 beats to 12 beats. Note that in general, there is a tradeoff between accuracy and speed of diagnosis. Shorter data segments will result in having a higher speed, but lower accuracy in AF detection. A measure that can substantiate one AF detection method from another is the degree of this trade-off. For our proposed method, the extent of this trade-off is low, because our algorithm is able to maintain its high accuracy (96.4%) even with a data segment as short as 10s.

Among various classifiers we evaluated for AF detection, Naïve Bayesian demonstrated the lowest performance (Fig. 9(A)). This observation is consistent with the fact that underlying assumption of Naïve Bayesian classifier, i.e. all features are independent, does not hold for our feature space. The performance of LDA and Logistic regression were close (around 94%). But our SVM classifier had the highest performance with an AUC of 99.5%.

Similar to our approach, Weng et al. has employed stationary wavelet transform to detect AF episodes [29]. In their paper, the authors compared their proposed SWT-based method with the frequency domain QRST-cancellation based method which obtains the dominant frequency components in the residual signal after QRST cancellation using Short-time Fourier transform. Their results showed that Weng method has a superior performance (in terms of AUC) to the frequency domain QRST-cancellation method by 14%. Given the efficacy of Weng method, we compared the performance of our method with that of Weng (Fig. 9(B)). The results showed that our proposed method outperformed Weng method by 10% in AUC (and consequently, it outperformed the frequency domain QRST-cancellation method by 24%). Note that although our proposed method is similar to Weng method in terms of employing stationary wavelet transform for AF detection, there exist two major differences between the two methods:(1) Our proposed method uses entropy measure as additional feature (in addition to peak-to-average-ratio) to classify AF data segments. This additional feature selection contributed to enhancement of the performance of AF detection; (2) While our proposed method employs SVM with Gaussian radial basis function kernel for classification (a non-linear classification), Weng method implements Perceptron classifier, following a Fisher Discriminant Ratio analysis of the features (to reduce dimensionality of the feature space). A linear classifier such as Perceptron may not be the best option for AF classification, as the peak-to-average features may not be well separated linearly. Moreover, feature dimensionality reduction using Fisher Discriminant Ratio has the underlying assumption of independency and Gaussian distribution for features; both assumptions may not hold for the chosen feature space.

Comparison of our algorithm with the existing methods listed in Table 2 shows that the proposed method has a superior performance (in terms of both sensitivity and specificity) to Slocum [14], Tateno [18], Dash [20], Couceiro [22] and Babaeizadeh [23] algorithms. While the specificity of our proposed method is 1% lower than that of Huang [26], its sensitivity is about 1% higher. The sensitivity and specificity of our algorithm is slightly lower than Sarkar [19] (by 0.5% and 1.9%), Jiang [24] (by 1.1% and 0.4%), and Lee [21] (by 1.2% and 0.6%), respectively. Although the last four aforementioned methods have shown a slightly better performance in AF detection, the proposed method holds some other properties which may make it a better choice for practical applications:
                           
                              •
                              Huang [26] and Jiang [24] method need to implement the computationally expensive Kolmogorov–Smirnov test on the histograms of R–R intervals to detect AF. The comprehensive storage capacity requirement of these two methods may limit their applications in mobile monitoring devices with limited memory and processing power.

Sarkar [19] and Jiang [24] method need a long data segment (2min for Sarkar and 50 beats for Jiang) to guarantee a high accuracy on AF detection. Our proposed method is able to achieve almost the same level of performance with short data segment of 10s, and hence has a better speed of diagnosis.

The long data segment requirement by the existing methods also results in missing detection of some of the short duration AF episodes. For example, while Jiang [24] method was only able to detect 260 out of 291 AF episodes of MIT-BIH AFIB database, our proposed method detected 271 episodes including short AF episodes.

Another advantage of our proposed method is that it does not require pre-processing step of peak detection. The accuracy of AF detection for other methods such as Dash [20] and Lee [21] depends on the accuracy of beat detection. Therefore, if the R peak detection/annotation is not correct, the algorithm would not be able to correctly identify the AF episodes. In fact, due to this reason, the authors in Dash [20] and Lee [21] had to exclude 2 data files (files 4936 and 5091) from MIT-BIH AFIB database while evaluating their proposed method. These two files had wrong R peak annotations and with those wrongly located R peaks, their method could have not been able to perform well. In contrast, our proposed method does not rely on R peak locations for AF detection, so we did not need to exclude those files in our analysis.

A summary of weakness points of existing algorithms relative to the proposed method are presented in Table 2.

The median transition delay of our proposed method was 9.8s. This result outperforms those of two recently published algorithms: 18 beats in Dash [20] and 70 beats Huang [26]. In Lee [40], the authors were able to decrease the transition delay to only 6 beats by using a data segment of 12 beats at the cost of having a lower accuracy rate of 92%. However, our proposed method is able to achieve the accuracy of 96.4% with transition delay of 9.8s.

Finally, our results indicated that the computation time of the proposed method for segment length of 30s or less, is less than 40ms. The most time-consuming part of our algorithm (more than 90% of running time) pertains to calculation of stationary wavelet coefficients. Nevertheless, a computation time of 40ms enables our proposed method to be realizable in practical applications. In general, the computational time of an AF detection method is highly dependent on the software/hardware used for the algorithm implementation/evaluation, and the length of the data segment used [25]. Many of the existing algorithms have reported their computation time for the segment length resulting in the highest accuracy of detection. For example, for a data segment of 128 beats, the computation times of Lee [21] and Dash [20] methods are less than 30ms and 200ms, respectively. It should be noted that since R peak annotations have been already provided in MIT-BIH AFIB database, the reported computation time of many existing algorithms do not include the computation time required to obtain the location of the R peaks. The average computation time of R peak detection using a well-known algorithm such as that of Pan and Tompkin [41] for data segment of 100s is about 40ms. Considering this additional computation time, our algorithm runs substantially faster than many existing algorithms.

The conversion of the original beat-to-beat annotation to a 
                           T
                        -second resolution (by using a minimum percentage parameter 
                           P
                        ) limited the duration of the shortest detectable AF episode to 
                           T
                           ×
                           P
                           /
                           100
                           
                        . For example, with 
                           T
                           =
                           10
                         and 
                           P
                           =
                           50
                           %
                        , the shortest detectable AF will be 5s. One solution to address this issue is to decrease the value of 
                           T
                        to less than 10s. However, such investigation requires a computer with a processing power higher than the one used in this study (in order to train support vector machine with the larger number of resulted data points).

In general, AF detection algorithms need near 100% sensitivity to be clinically acceptable; otherwise there will be some FN cases that cannot be correctly diagnosed and intervened in a timely manner. Although our proposed method performed well in AF detection (sensitivity of 97.0% and specificity of 97.1%), it demonstrated a specificity of 86.3% at sensitivity of 100%. Thus, further enhancement of the proposed method in terms of specificity may be needed to make it a clinically acceptable method.

The proposed AF detection method applies support vector machine on the ECG features (peak-to-average power ratio and entropy) extracted over different frequency bands using a stationary wavelet transform. The method does not dynamically choose the most effective wavelet scale for the purpose of denoising. Hence, the possibility of further enhancement of the method using a multi-resolution analysis remains to be investigated.

The validation of the proposed method was conducted on MIT_BIH atrial fibrillation dataset using two-fold cross validation. Although this dataset is the most popular publicly available data set for AF detection, it includes a limited group of patients. A larger dataset with more diverse arrhythmia patterns could allow for a more comprehensive analysis of the proposed method.

@&#CONCLUSION@&#

The current work proposes a novel AF detection method using stationary wavelet transform and support vector machine. This method eliminates the need for P and/or R peak detection; a pre-processing step required by many of the existing algorithms. Comparison of the performance of the proposed method (on MIT-BIH Atrial Fibrillation database) with other major algorithms showed that our method achieving the sensitivity and specificity of 97.0% and 97.1%, respectively outperforms many of existing methods. Moreover, the proposed method holds interesting properties (e.g. high performance for data segments as short as 10s, reasonably low computation and transition times, high accuracy regardless of the choice of the parameters of the method) which make it a suitable choice for various practical applications.

None declared.

@&#ACKNOWLEDGMENT@&#

The authors would like to thank “Yong Bai” from UCLA for his assistance with implementation of Multi-scale Entropy.

@&#REFERENCES@&#

