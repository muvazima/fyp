@&#MAIN-TITLE@&#On the performance of joint iterative detection and decoding in coherent optical channels with laser frequency fluctuations

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Use of joint iterative detection and decoding in high-speed fiber-optic communications.


                        
                        
                           
                           Near-optimal compensation of laser phase noise and frequency fluctuations.


                        
                        
                           
                           Efficient mitigation of (carrier) cycle slips in optical coherent receivers.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Coherent detection

LDPC

Joint iterative detection and decoding

Phase noise

16QAM

DWDM

@&#ABSTRACT@&#


               
               
                  The joint iterative detection and decoding (JIDD) technique has been proposed by Barbieri et al. (2007) with the objective of compensating the time-varying phase noise and constant frequency offset experienced in satellite communication systems. The application of JIDD to optical coherent receivers in the presence of laser frequency fluctuations has not been reported in prior literature. Laser frequency fluctuations are caused by mechanical vibrations, power supply noise, and other mechanisms. They significantly degrade the performance of the carrier phase estimator in high-speed intradyne coherent optical receivers.
                  This work investigates the performance of the JIDD algorithm in multi-gigabit optical coherent receivers. We present simulation results of bit error rate (BER) for non-differential polarization division multiplexing (PDM)-16QAM modulation in a 200Gb/s coherent optical system that includes an LDPC code with 20% overhead and net coding gain of 11.3dB at BER=10−15. Our study shows that JIDD with a pilot rate 
                        
                           ⩽
                           5
                           %
                        
                      compensates for both laser phase noise and laser frequency fluctuation. Furthermore, since JIDD is used with non-differential modulation formats, we find that gains in excess of 1dB can be achieved over existing solutions based on an explicit carrier phase estimator with differential modulation. The impact of the fiber nonlinearities in dense wavelength division multiplexing (DWDM) systems is also investigated. Our results demonstrate that JIDD is an excellent candidate for application in next generation high-speed optical coherent receivers.
               
            

@&#INTRODUCTION@&#

Multi-gigabit coherent fiber optic systems based on quadrature phase shift keying (QPSK) and M-ary quadrature amplitude modulation (M-QAM) are currently being deployed in carrier networks. High spectral efficiency modulation and coding schemes are being considered to satisfy the projected increase of the bandwidth demand [2] and to enable advanced networking concepts such as the flexible grid and software defined optical networks. Carrier phase recovery (CPR) is a key function of intradyne coherent optical QPSK/M-QAM receivers [3,4]. In these devices, CPR algorithms are required to track effects such as laser phase noise and carrier frequency fluctuations [5].

Since most of the M-QAM schemes considered for practical applications have rotational symmetry, errors in the carrier phase estimation may cause cycle slips (CS). After a CS occurs, all detected symbols are erroneous and they cannot be corrected by forward error correction (FEC) codes [3]. To counter this catastrophic effect, differential modulation is typically used [3]. In this modulation technique, the information is transmitted as the phase difference between two consecutive symbols. Therefore, the effects of a CS do not translate into catastrophic bit error bursts. While this option provides a solution to the CS problem, its sensitivity in terms of signal-to-noise ratio (SNR) is worse than that achieved by non-differential schemes. For instance, a penalty of 1.2dB has been reported for differential QPSK modulation [6]. To avoid the penalty of differential modulation formats, the use of pilot symbols has been proposed in previous literature [7–9] to prevent error propagation in non-differential modulation.

Although the catastrophic bit errors caused by CS can be mitigated by pilot symbols [10], their occurrence cannot be avoided and performance degradation will be experienced in the presence of high laser phase noise. This CS degradation caused by practical limitations of an explicit CPR is exacerbated by laser frequency instabilities introduced by mechanical vibrations including power supply noise [5]. These frequency fluctuations are modeled as sinusoidal frequency modulation of large amplitude (e.g., ∼500MHz) and low frequency (e.g., ⩽35kHz).

In this work we investigate the performance of a joint iterative detection and decoding (JIDD) algorithm in optical systems based on pilot symbols and powerful FEC codes such as low density parity check (LDPC). JIDD uses the soft-output information on the coded symbols provided by the decoder and performs forward–backward recursions, taking into account carrier phase information. Although performance evaluation of JIDD has been addressed in the past (e.g., see [1] and references therein), its behavior in high-speed transmissions over optical channels with laser frequency fluctuations and phase noise has not been reported so far.

The JIDD technique analyzed in this work builds upon the algorithm proposed in [1] for satellite channels with random time-varying carrier phase and constant unknown frequency offset. We present simulation results of post-FEC bit error rate (BER) for non-differential polarization division multiplexing (PDM)-16QAM in a 200Gb/s optical coherent system that uses the LDPC code with 20% overhead and net coding gain (NCG) of 11.3dB at BER=10−15 proposed in [11]. Our study shows that JIDD with a pilot rate of 5% is able to completely compensate laser frequency fluctuations with amplitudes as high as 700MHz [5]. We highlight that this performance is achieved without the need of a traditional CPR stage such as the blind phase search (BPS) carrier recovery algorithm [4]. Furthermore, our results demonstrate that JIDD achieves gains higher than 1dB over existing solutions based on an explicit CPR with differential modulation [5].

This paper is organized as follows. Section 2 investigates the impact of the laser frequency fluctuations in optical coherent receivers with LDPC codes and existing carrier phase recovery algorithms. The JIDD algorithm is investigated in Sections 3 and 4. The performance of the proposed receiver in the presence of nonlinear effects is analyzed in Section 5. Conclusions are drawn in Section 6. To facilitate the reading of this paper, abbreviations most frequently used are listed in Table 1
                     .


                     Figs. 1 and 2
                     
                      show a simplified model of the PDM coherent optical transmitter and receiver, respectively. The components in phase and quadrature of transmitted symbols for each polarization modulate the intensity and/or phase of corresponding output of the polarization beam splitter (PBS) of the transmitter laser (TL) through parallel Mach–Zehnder modulators (MZM) arranged in a Mach–Zehnder super-structure. Then, the modulated signals of each polarization are combined in the polarization beam combiner (PBC). The optical fiber introduces chromatic dispersion, polarization mode dispersion, as well as attenuation. Optical amplifiers (OA) deployed periodically along the fiber compensate the attenuation and introduce amplified spontaneous emission (ASE) noise. At the receiver, the optical signal is mixed with a local oscillator (LO) laser, the system operates with intradyne detection. The mixing of the received signal and LO with a 90° hybrid of 4 outputs (HY) gives the in-phase and quadrature components for each polarization, which are then fed to balanced photodiodes. This scheme allows suppressing the relative intensity noise (RIN). The TL and LO lasers can be either distributed feedback (DFB) or external cavity laser (ECL). The four signals are sampled twice per symbol period (i.e., the sampling rate is 
                        
                           2
                           /
                           T
                        
                      with T being the symbol duration) and fed into a digital signal processor (DSP). The DSP implements the main receiver functions, such as coarse carrier recovery (CCR), compensation of chromatic dispersion (CD) and polarization mode dispersion (PMD), timing recovery (TR), etc. The CCR block estimates the carrier frequency offset (e.g., based on the spectral shift of the received signal) and compensates it in order to achieve a capture range of several GHz.
                        1
                        Due to the low bandwidth of the CCR loop, short-term frequency instabilities of the laser as well as correlated phase noise cannot be tracked.
                     
                     
                        1
                      The chromatic dispersion is compensated typically by a frequency domain equalizer (FDE). The fiber length is automatically identified during the startup and the response of the filter is programmed accordingly. A T/2 multiple-input multiple-output (MIMO) feedforward equalizer (FFE) performs the polarization demultiplexing and the compensation of PMD and polarization-dependent loss (PDL). An adaptation algorithm is essential in optical channels since the receiver must track nonstationary effects (PMD, PDL, changes in the state of polarization of the TX or LO lasers, etc.). Towards this end, decision-directed LMS and/or the constant modulus algorithm (CMA) are typically used. A low latency phase-locked loop (PLL) is included to get tentative decisions required to implement the FFE adaptation algorithm [5,12]. Since most part of the carrier frequency offset has already been compensated by the CCR, the PLL is required mainly to track short-term frequency instabilities of the lasers as well as part of the phase noise [5]. To avoid the cycle slips introduced by the PLL in transmission with non-differential modulation, the signal not demodulated by the PLL is fed to the CPR. Therefore the CPR block must be able to track high-frequency laser phase noise, nonlinear phase noise as well as laser frequency fluctuations. Finally, the samples are processed by the soft decision demapper (SDD) which provides the soft information used by the iterative LDPC decoder to estimate the transmit bit.

For simplicity, in this section we assume that:
                           
                              •
                              Fiber optic impairments include only linear effects (i.e., CD and PMD). The impact of the nonlinear effects experienced in fiber optic transmission systems shall be analyzed later in Section 5.

CD and PMD are perfectly compensated by the FDE and the MIMO-FFE, respectively.

Most carrier frequency offset is compensated at the receiver input by the CCR stage (i.e., the residual carrier frequency offset at the output of the DSP is low and easily compensated by traditional CPR blocks such as BPS).

Furthermore, from Fig. 2 notice that the two polarizations at the output of the DSP block are treated as two independent coded channels. Consequently, in this work a single polarization is considered for the channel modeling and the theoretical formulation of the JIDD algorithm.

Let 
                           
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              ∈
                              M
                           
                         be a complex symbol of an M-QAM constellation with alphabet 
                           
                              M
                           
                        . The information bits are encoded and mapped into symbols. Each codeword become in a block of coded symbols, denoted as symbol codeword, which corresponds to a set of K symbols. The received signal at the input of the carrier phase recovery can be expressed as [13]
                        
                           
                              (1)
                              
                                 
                                    
                                       r
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       j
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                              
                           
                         is the total phase noise and 
                           
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                           
                         represents the ASE noise sample. The latter is modeled as a white complex Gaussian random variable with power 
                           
                              2
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           
                        . Let 
                           
                              Δ
                              ν
                           
                         be the total laser linewidth parameter. The received phase 
                           
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                              
                           
                         can be expressed as
                           
                              (2)
                              
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       ϕ
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        where 
                           
                              {
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                              }
                           
                         is a set of i.i.d white real Gaussian random variables with variance 
                           
                              
                                 
                                    σ
                                 
                                 
                                    w
                                 
                                 
                                    2
                                 
                              
                              =
                              2
                              π
                              Δ
                              ν
                              T
                           
                         
                        [3], while 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    k
                                 
                              
                           
                         is given by
                           
                              (3)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       Ω
                                    
                                    
                                       c
                                    
                                 
                                 +
                                 Δ
                                 
                                    
                                       Ω
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    c
                                 
                              
                           
                         is the angular carrier frequency offset given by 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    c
                                 
                              
                              =
                              2
                              π
                              
                                 
                                    Tf
                                 
                                 
                                    c
                                 
                              
                           
                        , with 
                           
                              
                                 
                                    f
                                 
                                 
                                    c
                                 
                              
                           
                         being the residual carrier frequency offset. The term 
                           
                              Δ
                              
                                 
                                    Ω
                                 
                                 
                                    k
                                 
                              
                           
                         represents the phase change generated by frequency fluctuations, which can be modeled as
                           
                              (4)
                              
                                 Δ
                                 
                                    
                                       Ω
                                    
                                    
                                       k
                                    
                                 
                                 ≈
                                 2
                                 π
                                 
                                    
                                       A
                                    
                                    
                                       p
                                    
                                 
                                 T
                                 cos
                                 (
                                 2
                                 π
                                 T
                                 Δ
                                 
                                    
                                       f
                                    
                                    
                                       c
                                    
                                 
                                 k
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    A
                                 
                                 
                                    p
                                 
                              
                           
                         and 
                           
                              Δ
                              
                                 
                                    f
                                 
                                 
                                    c
                                 
                              
                           
                         are the amplitude and frequency of the modulation tone [5].

As we shall show in Section 5, the generic model given by Eq. (1) can also be used to include the nonlinear interference caused by the Kerr effect in the fiber [13,14].


                        Fig. 2 depicts the simplified model of the PDM coherent optical receiver, where a carrier phase recovery stage is used to demodulate the received signal. CPR is a key function of coherent optical receivers [2,3]. In particular, feedforward phase estimation schemes such as the Viterbi–Viterbi (VV) [3] or BPS [4] algorithms have been proposed for these receivers, as a result of their good laser linewidth tolerance and feasibility for parallel implementation. We consider two existing carrier phase recovery techniques denoted here as ECPR-1 and ECPR-2.

ECPR-1 is the blind phase search carrier recovery algorithm [4] with differential modulation (see Fig. 3
                           ). The BPS block estimates the phase noise as follows:
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    U
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      arg
                                                      
                                                      min
                                                   
                                                   
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   k
                                                
                                             
                                             (
                                             
                                                
                                                   φ
                                                
                                                
                                                   b
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 U
                                 
                                    
                                       
                                          ·
                                       
                                    
                                 
                              
                            is the unwrap function and 
                              
                                 
                                    
                                       φ
                                    
                                    
                                       b
                                    
                                 
                              
                            is the test phase defined as
                              
                                 (6)
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          B
                                       
                                    
                                    .
                                    
                                       
                                          π
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                    b
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    B
                                    -
                                    1
                                    }
                                 
                              
                           with B being the number of phases to be tested; term 
                              
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       φ
                                    
                                    
                                       b
                                    
                                 
                                 )
                              
                            is given by
                              
                                 (7)
                                 
                                    
                                       
                                          g
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          φ
                                       
                                       
                                          b
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             -
                                             N
                                          
                                          
                                             N
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      k
                                                      -
                                                      i
                                                   
                                                
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      -
                                                      j
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                   
                                                
                                                -
                                                Q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               k
                                                               -
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               -
                                                               j
                                                               
                                                                  
                                                                     φ
                                                                  
                                                                  
                                                                     b
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           where 
                              
                                 Q
                                 (
                                 .
                                 )
                              
                            is the slicer function and N is the filter half width (see [4] for more details).

On the other hand, ECPR-2 is a pilot-aided scheme that employs an interpolation filter followed by BPS with non-differential modulation [15] (see Fig. 4
                           ). Consider that one pilot symbol is periodically inserted after 
                              
                                 D
                                 -
                                 1
                              
                            payload symbols. Thus, we define the pilot-rate as 
                              
                                 
                                    
                                       P
                                    
                                    
                                       R
                                    
                                 
                                 =
                                 1
                                 /
                                 D
                              
                           . The ith pilot symbol occurs at the discrete time instant iD, hence the pilot sequence is a zero-padded sequence given by
                              
                                 (8)
                                 
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      k
                                                      =
                                                      iD
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      k
                                                      
                                                      ≠
                                                      
                                                      iD
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The system comprises a coarse phase tracking based on pilot symbols, where the received sequence is multiplied with the complex conjugate of the zero padded pilot sequence. The resulting sequence is filtered by an interpolation filter with impulse response 
                              
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                              
                           . The phase correction is generated by taking the argument of the samples at the output of the interpolation filter. To correct any residual phase error, a second CPR stage based on the BPS algorithm is used. Note that there is not phase ambiguity at the BPS input due to the use of the pilot symbols. A small residual phase offset is assumed therefore the phase estimate is limited to the range [
                              
                                 -
                                 π
                                 /
                                 4
                                 ,
                                 π
                                 /
                                 4
                              
                           ). From the latter, note that no cycle slips are introduced by the ECPR-2 scheme since the unwrap operation is avoided. However, we highlight that if the pilot rate 
                              
                                 
                                    
                                       P
                                    
                                    
                                       R
                                    
                                 
                              
                            is not sufficiently high,
                              2
                              The proper value of 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             R
                                          
                                       
                                    
                                  shall depend on the amount of phase noise power in the system.
                           
                           
                              2
                            burst errors may occur and the performance of the LDPC decoder should degrade significantly.

The performance of ECPR-1 and ECPR-2 in the presence of laser frequency fluctuations is investigated by computer simulations. In all the cases, BPS uses 
                           
                              B
                              =
                              32
                           
                         test phases and the filter half width N is optimized for each SNR. We consider a non-dispersive optical channel with 
                           
                              
                                 
                                    f
                                 
                                 
                                    c
                                 
                              
                              =
                              0
                           
                        , a baud rate of 
                           
                              1
                              /
                              T
                              =
                              32
                           
                         Giga-symbols per second (Gs/s) with PDM-16QAM modulation (i.e., the bit rate is 256Gb/s). We use the LDPC code with 20% overhead and net coding gain in additive white Gaussian noise (AWGN) channels of 11.3dB at BER=10−15 proposed in [11].
                           3
                           Note that the effective bit rate is ∼200Gb/s.
                        
                        
                           3
                         Three values of the pilot rate (
                           
                              
                                 
                                    P
                                 
                                 
                                    R
                                 
                              
                           
                        ) are considered for ECPR-2: P
                        
                           R
                        
                        =1, 2 and 5%. An LDPC decoder with 50 iterations has been used in all the cases in order to achieve all benefit possible. Results without laser phase noise and frequency fluctuations are also included for comparison purposes. This scheme (denoted as Ideal CPR) also uses an LDPC decoder with 50 iterations. We focus our study on the post-FEC BER as a function of the signal-to-noise ratio per information bit (
                           
                              
                                 
                                    E
                                 
                                 
                                    b
                                 
                              
                              /
                              
                                 
                                    N
                                 
                                 
                                    0
                                 
                              
                           
                        ), which considers the penalty caused by the code overhead and the pilot symbols.


                        Fig. 5
                         shows the post-FEC BER versus 
                           
                              
                                 
                                    E
                                 
                                 
                                    b
                                 
                              
                              /
                              
                                 
                                    N
                                 
                                 
                                    0
                                 
                              
                           
                         in the presence of laser phase noise only (i.e., 
                           
                              
                                 
                                    A
                                 
                                 
                                    p
                                 
                              
                              =
                              0
                           
                        ). Two values of the laser linewidth 
                           
                              Δ
                              ν
                           
                         are simulated: 500kHz and 5MHz. We observe that the ECPR-1 and ECPR-2 with 
                           
                              
                                 
                                    P
                                 
                                 
                                    R
                                 
                              
                              =
                              5
                              %
                           
                         can operate with some degradation in the presence of phase noise. The penalty of ECPR-1 respect to ECPR-2 with 
                           
                              
                                 
                                    P
                                 
                                 
                                    R
                                 
                              
                              =
                              5
                              %
                           
                         is mainly owing to the use of differential modulation.


                        Fig. 6
                         shows the post-FEC BER versus 
                           
                              
                                 
                                    E
                                 
                                 
                                    b
                                 
                              
                              /
                              
                                 
                                    N
                                 
                                 
                                    0
                                 
                              
                           
                         in the presence of laser phase noise and sinusoidal jitter with 
                           
                              Δ
                              
                                 
                                    f
                                 
                                 
                                    c
                                 
                              
                              =
                              35
                              
                              kHz
                           
                        , 
                           
                              
                                 
                                    A
                                 
                                 
                                    p
                                 
                              
                              =
                              200
                           
                         and 500MHz. Note that a dramatic performance degradation caused by the frequency fluctuations is experienced in both CPR schemes. Although the impact of the laser frequency fluctuations on the performance has already been investigated in the past (e.g., see [5]), we emphasize that our study considers the post-FEC BER and not the pre-FEC BER as usual in previous related work. Thus, short bursts of bit errors unnoticeable in pre-FEC BER analysis may cause high penalty when post-FEC performance is considered [16]. This fact is useful to understand the important degradation experienced in the presence the carrier frequency fluctuations shown in Fig. 6.

From previous results we can see that powerful carrier phase estimation and decoding techniques shall be needed to combat the effects of both the laser phase noise and the frequency fluctuations. To compensate these impairments, in next section we propose the use of a joint iterative detection and decoding technique. This technique has been proposed in the past to compensate time-varying phase noise and constant frequency offset experienced in satellite communication systems [1]. So far, its application to optical coherent receivers in the presence of laser frequency fluctuations has not been investigated in the literature.

@&#BACKGROUND@&#

In the following, we summarize the JIDD algorithm proposed in [1]. Denote 
                           
                              c
                              =
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             K
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         the coded symbol block to be transmitted, and 
                           
                              r
                              =
                              {
                              
                                 
                                    r
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    r
                                 
                                 
                                    K
                                    -
                                    1
                                 
                              
                              }
                           
                         the received symbol block. In order to simplify the implementation, 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    k
                                 
                              
                           
                         is assumed to be constant in a symbol block (i.e., 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    k
                                 
                              
                              =
                              ϕ
                              ,
                              k
                              =
                              0
                              ,
                              …
                              ,
                              K
                              -
                              1
                           
                        ). The validity of this assumption will be confirmed later by computer simulations.

To implement the maximum-a posteriori (MAP) detector, the a posteriori probability (APP) 
                           
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              |
                              r
                              )
                           
                         must be evaluated. Towards this end, JIDD uses the sum-product algorithm (SPA) on a factor graph (FG) to evaluate the joint APP distribution function
                           
                              (9)
                              
                                 p
                                 
                                    
                                       
                                          c
                                          ,
                                          θ
                                          ,
                                          ϕ
                                          ∣
                                          r
                                       
                                    
                                 
                                 ∝
                                 
                                    
                                       χ
                                    
                                    
                                       C
                                    
                                 
                                 (
                                 c
                                 )
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                       
                                    
                                 
                                 p
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                k
                                             
                                          
                                          ∣
                                          
                                             
                                                c
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 p
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          ∣
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                                -
                                                1
                                             
                                          
                                          ,
                                          ϕ
                                       
                                    
                                 
                                 p
                                 
                                    
                                       
                                          ϕ
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    χ
                                 
                                 
                                    C
                                 
                              
                              (
                              c
                              )
                           
                         is the code indicator function defined as 1 if 
                           
                              c
                           
                         is a symbol codeword of the channel code 
                           
                              C
                           
                         and 0 otherwise; 
                           
                              θ
                              =
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             K
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         is the sequence of the channel phase noise.

The probability density function (pdf) 
                           
                              p
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       ∣
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       ϕ
                                    
                                 
                              
                           
                         is Gaussian with mean 
                           
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                              
                              +
                              ϕ
                           
                         and variance 
                           
                              
                                 
                                    σ
                                 
                                 
                                    w
                                 
                                 
                                    2
                                 
                              
                           
                        . The term 
                           
                              p
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             k
                                          
                                       
                                       ∣
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           
                         in (9) results
                           
                              (10)
                              
                                 p
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                k
                                             
                                          
                                          ∣
                                          
                                             
                                                c
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 ∝
                                 exp
                                 
                                    
                                       
                                          R
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               k
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         -
                                                         j
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              R
                              
                                 
                                    
                                       ·
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          ·
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                           
                         denote real part and complex conjugate, respectively.

The normal factor graph
                        
                           4
                           See [17] for more details.
                        
                        
                           4
                         of the JIDD algorithm is depicted in Fig. 7
                        . The state of the detector is defined as 
                           
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                              
                              ≜
                              
                              (
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                              
                              ,
                              ϕ
                              )
                           
                        . The application of the SPA leads to an iterative exchange of messages along the edges of the FG. 
                           
                              
                                 
                                    P
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    u
                                 
                              
                              (
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         are the APP probabilities of the coded symbols received from and sent to the decoder, respectively. The forward (
                           
                              
                                 
                                    p
                                 
                                 
                                    f
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        ) and backward (
                           
                              
                                 
                                    p
                                 
                                 
                                    b
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        ) messages along of the edge 
                           
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                           
                         (not depicted for purposes of clarity) are the pdfs of 
                           
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                           
                         given the past and the future, respectively, i.e.,
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                f
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          ≜
                                          
                                          p
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ,
                                                   ϕ
                                                   ∣
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         k
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          p
                                          
                                             
                                                
                                                   ϕ
                                                   ∣
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         k
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          p
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ∣
                                                   ϕ
                                                   ,
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         k
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                b
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          ≜
                                          
                                          p
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ,
                                                   ϕ
                                                   ∣
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                      
                                                         K
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          p
                                          
                                             
                                                
                                                   ϕ
                                                   ∣
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                      
                                                         K
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          p
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ∣
                                                   ϕ
                                                   ,
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                      
                                                         K
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                              
                              ≜
                              
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        , 
                           
                              i
                              ⩽
                              j
                           
                        . In order to simplify the implementation, ϕ is assumed to be a discrete random variable with 
                           
                              ϕ
                              ∈
                              
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             ϕ
                                          
                                          
                                             
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       ⋯
                                       ,
                                       
                                          
                                             ϕ
                                          
                                          
                                             
                                                
                                                   L
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         in the interval 
                           
                              
                                 
                                    
                                       -
                                       
                                          
                                             ϕ
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             ϕ
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        . In this way, pdfs 
                           
                              p
                              
                                 
                                    
                                       ϕ
                                       ∣
                                       
                                          
                                             r
                                          
                                          
                                             0
                                          
                                          
                                             k
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              p
                              
                                 
                                    
                                       ϕ
                                       ∣
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                          
                                             K
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         in (11) become probability mass functions:
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                f
                                                ,
                                                k
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          
                                          ≜
                                          
                                          P
                                          
                                             
                                                
                                                   ϕ
                                                   =
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                   ∣
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         k
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                b
                                                ,
                                                k
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          
                                          ≜
                                          
                                          P
                                          
                                             
                                                
                                                   ϕ
                                                   =
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                   ∣
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                      
                                                         K
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 ℓ
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 L
                              
                           
                        where 
                           
                              
                                 
                                    γ
                                 
                                 
                                    f
                                    ,
                                    k
                                 
                                 
                                    
                                       
                                          ℓ
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    γ
                                 
                                 
                                    b
                                    ,
                                    k
                                 
                                 
                                    
                                       
                                          ℓ
                                       
                                    
                                 
                              
                           
                         are recursively estimated as
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                f
                                                ,
                                                k
                                                +
                                                1
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                γ
                                             
                                             
                                                f
                                                ,
                                                k
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          exp
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  f
                                                                  ,
                                                                  k
                                                               
                                                               
                                                                  
                                                                     
                                                                        ℓ
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  f
                                                                  ,
                                                                  k
                                                               
                                                               
                                                                  
                                                                     
                                                                        ℓ
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                b
                                                ,
                                                k
                                                -
                                                1
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                γ
                                             
                                             
                                                b
                                                ,
                                                k
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          exp
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  b
                                                                  ,
                                                                  k
                                                               
                                                               
                                                                  
                                                                     
                                                                        ℓ
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  b
                                                                  ,
                                                                  k
                                                               
                                                               
                                                                  
                                                                     
                                                                        ℓ
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        with
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                f
                                                ,
                                                k
                                                +
                                                1
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      f
                                                      ,
                                                      k
                                                   
                                                   
                                                      
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                1
                                                +
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      w
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               f
                                                               ,
                                                               k
                                                            
                                                            
                                                               
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                j
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                k
                                                -
                                                1
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      b
                                                      ,
                                                      k
                                                   
                                                   
                                                      
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                1
                                                +
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      w
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               b
                                                               ,
                                                               k
                                                            
                                                            
                                                               
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                -
                                                j
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and initial conditions
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                f
                                                ,
                                                0
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          =
                                          0
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                K
                                                -
                                                1
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          =
                                          0
                                       
                                    
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                f
                                                ,
                                                0
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          =
                                          const.
                                       
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                b
                                                ,
                                                K
                                                -
                                                1
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          =
                                          const.
                                       
                                    
                                 
                                 
                                 ℓ
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 L
                                 .
                              
                           
                        
                     

Parameter 
                           
                              
                                 
                                    u
                                 
                                 
                                    k
                                 
                              
                           
                         in Eq. (14) is given by
                           
                              (15)
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                                 
                                 ≜
                                 
                                 
                                    
                                       2
                                       
                                          
                                             r
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             α
                                          
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where
                           
                              (16)
                              
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 
                                 ≜
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          c
                                          ∈
                                          M
                                       
                                    
                                 
                                 
                                    
                                       cP
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          c
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 
                                 ≜
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          c
                                          ∈
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             c
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          c
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The probability 
                           
                              
                                 
                                    P
                                 
                                 
                                    u
                                 
                              
                              (
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         can be approximated by
                           
                              (18)
                              
                                 
                                    
                                       P
                                    
                                    
                                       u
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ∝
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          ℓ
                                       
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       f
                                       ,
                                       k
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       b
                                       ,
                                       k
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               k
                                                            
                                                            
                                                               
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               f
                                                               ,
                                                               k
                                                            
                                                            
                                                               
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               b
                                                               ,
                                                               k
                                                            
                                                            
                                                               
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    I
                                 
                                 
                                    0
                                 
                              
                              (
                              ·
                              )
                           
                         is the zeroth-order modified Bessel function of the first kind and
                           
                              (19)
                              
                                 
                                    
                                       b
                                    
                                    
                                       k
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       f
                                       ,
                                       k
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       b
                                       ,
                                       k
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Thus, the JIDD algorithm can be summarized as follows:
                           
                              Step 1)
                              evaluate coefficients 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                       
                                    
                                 , 
                                    
                                       k
                                       =
                                       0
                                       ,
                                       1
                                       ,
                                       …
                                       ,
                                       K
                                       -
                                       1
                                    
                                 , using (15)–(17);

recursively update forward and backward parameter 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             f
                                             ,
                                             k
                                          
                                          
                                             
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                    
                                 , 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             b
                                             ,
                                             k
                                          
                                          
                                             
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                    
                                 , 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             f
                                             ,
                                             k
                                          
                                          
                                             
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             b
                                             ,
                                             k
                                          
                                          
                                             
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                    
                                  given by (13) and (14);

evaluate 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                  from (18) and (19);

update 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                  from 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                  applying the soft-input soft-output decoder for code 
                                    
                                       C
                                    
                                 .

A modification to the described JIDD algorithm is introduced in order to reduce the computational load required by (13) and (18). Towards this end, we consider the logarithm of 
                           
                              
                                 
                                    γ
                                 
                                 
                                    f
                                    ,
                                    k
                                 
                                 
                                    
                                       
                                          ℓ
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    γ
                                 
                                 
                                    b
                                    ,
                                    k
                                 
                                 
                                    
                                       
                                          ℓ
                                       
                                    
                                 
                              
                           
                         then product operations in the recursive processing are replaced by sums. Thus, Eq. (13) can be rewritten as
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                f
                                                ,
                                                k
                                                +
                                                1
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          =
                                          exp
                                          
                                             
                                                
                                                   
                                                      
                                                         ν
                                                      
                                                      
                                                         f
                                                         ,
                                                         k
                                                         +
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                b
                                                ,
                                                k
                                                -
                                                1
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          =
                                          exp
                                          
                                             
                                                
                                                   
                                                      
                                                         ν
                                                      
                                                      
                                                         b
                                                         ,
                                                         k
                                                         -
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 ℓ
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 L
                              
                           
                        where
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                ν
                                             
                                             
                                                f
                                                ,
                                                k
                                                +
                                                1
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                ν
                                             
                                             
                                                f
                                                ,
                                                k
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         f
                                                         ,
                                                         k
                                                      
                                                      
                                                         
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         f
                                                         ,
                                                         k
                                                      
                                                      
                                                         
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ν
                                             
                                             
                                                b
                                                ,
                                                k
                                                -
                                                1
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                ν
                                             
                                             
                                                b
                                                ,
                                                k
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         b
                                                         ,
                                                         k
                                                      
                                                      
                                                         
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         b
                                                         ,
                                                         k
                                                      
                                                      
                                                         
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        with 
                           
                              
                                 
                                    ν
                                 
                                 
                                    f
                                    ,
                                    0
                                 
                                 
                                    
                                       
                                          ℓ
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ν
                                 
                                 
                                    b
                                    ,
                                    K
                                    -
                                    1
                                 
                                 
                                    
                                       
                                          ℓ
                                       
                                    
                                 
                              
                           
                         being an arbitrary constant 
                           
                              ∀
                              ℓ
                           
                        . Furthermore, approximating (as suggested in [1]) 
                           
                              
                                 
                                    I
                                 
                                 
                                    0
                                 
                              
                              (
                              x
                              )
                              ≃
                              
                                 
                                    e
                                 
                                 
                                    x
                                 
                              
                           
                        , Eq. (18) reduces to
                           
                              (22)
                              
                                 
                                    
                                       P
                                    
                                    
                                       u
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ∝
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          ℓ
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       
                                          
                                             ς
                                          
                                          
                                             k
                                          
                                          
                                             
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   ς
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        where
                           
                              (23)
                              
                                 
                                    
                                       ς
                                    
                                    
                                       k
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ν
                                    
                                    
                                       f
                                       ,
                                       k
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       ν
                                    
                                    
                                       b
                                       ,
                                       k
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                k
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                f
                                                ,
                                                k
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                                ,
                                                k
                                             
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             ς
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          ℓ
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       ς
                                    
                                    
                                       k
                                    
                                    
                                       
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                              
                           
                        is a normalization variable required to avoid numerical overflow when finite precision arithmetic is used. Compared to (18), Eq. (22) not only reduces the computational complexity of the algorithm, but also provides an improved numerical stability for implementing with finite resolution arithmetic.


                        Fig. 8
                         depicts a possible architecture of the proposed JIDD-based receiver. Notice that the JIDD replaces the following blocks: CPR, SDD, and LDPC decoder. We highlight that the carrier frequency offset is compensated before by the CCR, as explained in Fig. 2. The low latency PLL is kept as part of the FFE equalizer adaptation loop. As in the traditional architecture based on a CPR followed by LDPC decoding, each polarization is processed independently after the polarization demultiplexing achieved by the MIMO-FFE [12]. This architecture has shown to provide an excellent performance in real applications. We realize that some authors have proposed to combine information of the two carrier recovery blocks of the two polarizations in order to improve the receiver performance [18]. Although this approach could also be used in the context of the JIDD, in this work we focus on the architecture with independent JIDDs for each polarization, which has shown to achieve a good performance in ultra-high speed coherent receivers [19].


                        Fig. 9
                         shows a simplified block diagram of the JIDD. Notice that existing architectures of LDPC decoders can be used to implement JIDD receivers (e.g., see [20] for more details). Development of practical architectures for the symbol node (SN) blocks will be required to implement JIDD in commercial optical transceivers.

We investigate the performance of the S-JIDD algorithm in the presence of laser phase noise and frequency fluctuations. The simulation conditions described in Section 2.3 are used. Numerical results for S-JIDD are presented and compared to those of ECPR-1 and ECPR-2. The S-JIDD employs 20 inner iterations for each update of 
                        
                           
                              
                                 P
                              
                              
                                 d
                              
                           
                           (
                           
                              
                                 c
                              
                              
                                 k
                              
                           
                           )
                        
                      from 
                        
                           
                              
                                 P
                              
                              
                                 u
                              
                           
                           (
                           
                              
                                 c
                              
                              
                                 k
                              
                           
                           )
                        
                      and 50 outer iterations of 
                        
                           
                              
                                 P
                              
                              
                                 d
                              
                           
                           (
                           
                              
                                 c
                              
                              
                                 k
                              
                           
                           )
                        
                      for each codeword. Equally spaced pilot symbols of the highest amplitude allowed by the constellation are used. Several values of the pilot rate (
                        
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                        
                     ) are considered for the pilot-aided schemes with non-differential modulation (i.e., S-JIDD and ECPR-2).
                        5
                        The penalties of 
                              
                                 
                                    
                                       E
                                    
                                    
                                       b
                                    
                                 
                                 /
                                 
                                    
                                       N
                                    
                                    
                                       0
                                    
                                 
                              
                            caused by pilot symbols using the highest constellation amplitude are 0.09, 0.17, and 0.44dB for 
                              
                                 
                                    
                                       P
                                    
                                    
                                       R
                                    
                                 
                                 =
                                 1
                                 ,
                                 2
                              
                           , and 5%, respectively.
                     
                     
                        5
                      Moreover, S-JIDD uses 
                        
                           L
                           =
                           11
                        
                      levels for the first iteration and 
                        
                           L
                           =
                           3
                        
                      for the rest, while 
                        
                           
                              
                                 ϕ
                              
                              
                                 0
                              
                           
                        
                      is properly chosen according to the pilot rate.


                     Fig. 10
                      shows the post-FEC BER versus the signal-to-noise ratio per bit in the presence of laser phase noise only (i.e., 
                        
                           
                              
                                 A
                              
                              
                                 p
                              
                           
                           =
                           0
                        
                     ). Two values of the laser linewidth 
                        
                           Δ
                           ν
                        
                      are used: 500kHz and 5MHz. In all the cases, notice that S-JIDD outperforms the existing solutions based on an explicit CPR stage. We also observe that S-JIDD with 
                        
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                           =
                           1
                           %
                        
                      behaves slightly better than 
                        
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                           =
                           5
                           %
                        
                      as a result of the penalty caused by the (higher) pilot rate. Furthermore, note that S-JIDD with 
                        
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                           =
                           1
                           %
                        
                      outperforms ECPR-2 with 
                        
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                           =
                           5
                           %
                        
                     .

The robustness of the S-JIDD in the presence of laser frequency fluctuations is analyzed in Fig. 11
                     . We consider 
                        
                           Δ
                           ν
                           =
                           500
                           
                           kHz
                        
                     , 
                        
                           Δ
                           
                              
                                 f
                              
                              
                                 c
                              
                           
                           =
                           35
                           
                           kHz
                        
                     , and two frequency amplitudes: 
                        
                           
                              
                                 A
                              
                              
                                 p
                              
                           
                           =
                           200
                        
                      and 500MHz (see (4)). Notice the drastic performance degradation observed in both ECPR-1 and ECPR-2 when 
                        
                           
                              
                                 A
                              
                              
                                 p
                              
                           
                           =
                           500
                           
                           MHz
                        
                     . In this case, S-JIDD with 
                        
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                           =
                           5
                           %
                        
                      is the only scheme that achieves an acceptable performance with 
                        
                           ∼
                           0.5
                           
                           dB
                        
                      penalty. We realize that the performance of ECPR-1 can be significantly improved by using the technique proposed in [5]. However, as observed in Fig. 10, we do not expect a better performance than that achieved by S-JIDD as a result of the modulation format (i.e., differential vs. non-differential).

We realize that the performance improvements of S-JIDD observed in Figs. 10 and 11 are achieved by using 20 inner iterations and 50 outer iterations. Next we also consider S-JIDD with 10 inner iterations and 5 outer iterations.
                        6
                        Thus, the total number of iterations used in S-JIDD is similar to that used in ECPR-1 and ECPR-2.
                     
                     
                        6
                     
                  


                     Fig. 12
                      shows the penalty versus the frequency amplitude 
                        
                           
                              
                                 A
                              
                              
                                 p
                              
                           
                        
                      for S-JIDD with 
                        
                           Δ
                           
                              
                                 f
                              
                              
                                 c
                              
                           
                           =
                           35
                           
                           kHz
                        
                     , 
                        
                           Δ
                           ν
                           =
                           250
                           
                           kHz
                        
                     , 
                        
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                           =
                           1
                           ,
                           2
                        
                     , and 5%. Notice that frequency amplitudes as high as 
                        
                           
                              
                                 A
                              
                              
                                 p
                              
                           
                           =
                           700
                           
                           MHz
                        
                      can be tolerated by S-JIDD with 
                        
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                           =
                           5
                           %
                        
                     . Furthermore, note that the extra degradation of S-JIDD with 
                        
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                           =
                           5
                           %
                        
                     , 10 inner iterations, and 5 outer iterations is only 
                        
                           ∼
                           0.2
                           
                           dB
                        
                     .


                     Fig. 13
                      investigates the tolerance to the laser phase noise in the presence of frequency fluctuation with 
                        
                           
                              
                                 A
                              
                              
                                 p
                              
                           
                           =
                           140
                           
                           MHz
                        
                      and 
                        
                           Δ
                           
                              
                                 f
                              
                              
                                 c
                              
                           
                           =
                           35
                           
                           kHz
                        
                     . In this case, note that the performance of S-JIDD is practically insensitive to laser phase noise when 
                        
                           Δ
                           ν
                           T
                           <
                           2
                           ×
                           
                              
                                 10
                              
                              
                                 -
                                 4
                              
                           
                        
                      (e.g., 
                        
                           Δ
                           ν
                           <
                           6.4
                           
                           MHz
                        
                      at 
                        
                           1
                           /
                           T
                           =
                           32
                           
                           Gs
                           /
                           s
                        
                     ). From the above, we infer that the proper tradeoff between performance and complexity should be achieved by adjusting the number of inner and outer iterations.

Optical coherent dense wavelength division multiplexing (DWDM) systems have become the mainstream technology for optical transport networks. The performance of DWDM systems in PDM transmissions over long-haul fiber links is limited by the ASE noise and nonlinear interference (NLI) caused by the Kerr effect in the fiber. In particular, self-phase and cross-phase modulation (SPM and XPM), and four-wave mixing (FWM) are the main Kerr-induced effects that impact on the performance of DWDM in long-haul links. Simplified and empirical models for NLI have been introduced recently to evaluate performance of iterative decoding schemes in DWDM systems [21]. In the following, we investigate the performance of S-JIDD in DWDM systems with PDM transmissions based on two models for NLI proposed in previous works.

Transmissions over optical links can be classified in dispersion-managed (DMT) or uncompensated (UT), depending on whether dispersion compensation fiber (DCF) is used or not, respectively. Owing to the difficulty to derive compact and comprehensive analytical solutions in the context of DMT, several empirical models of the NLI have been proposed [13,22]. For example, it has been observed in [13] that the Wiener process is still adequate to describe carrier phase noise effects after nonlinear propagation in DMT links. In this case, the sample at the input of the CPR block reduces to
                           
                              (25)
                              
                                 
                                    
                                       r
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       j
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                           
                         are defined as in (1), while 
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                         is the total phase noise given by
                           
                              (26)
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       ϕ
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        with 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    k
                                 
                              
                           
                         being the laser frequency fluctuation given by (3); laser phase noise and NLI effects are modeled by the set 
                           
                              {
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              }
                           
                        , which is assumed i.i.d white real Gaussian random variables with variance 
                           
                              
                                 
                                    σ
                                 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              2
                              π
                              T
                              (
                              Δ
                              ν
                              +
                              Δ
                              
                                 
                                    ν
                                 
                                 
                                    NL
                                 
                              
                              )
                           
                        . Parameter 
                           
                              Δ
                              ν
                           
                         is the laser linewidth of TX and RX oscillators, while 
                           
                              Δ
                              
                                 
                                    ν
                                 
                                 
                                    NL
                                 
                              
                           
                         represents a “linewidth broadening” caused by the NLI. For example, 
                           
                              Δ
                              ν
                              +
                              Δ
                              
                                 
                                    ν
                                 
                                 
                                    NL
                                 
                              
                              =
                              10
                              
                              MHz
                           
                         has been reported for a 100Gb/s PDM-QPSK optical receiver in the presence of 79 DWDM 100Gb/s PDM-QPSK channels spaced at 50GHz with 
                           
                              Δ
                              ν
                              =
                              1
                              
                              MHz
                           
                         
                        [13]. From Fig. 12 we can infer that the performance degradation caused by NLI in the DWDM system just mentioned
                           7
                           That is, a DWDM system with 100Gb/s PDM-QPSK channels spaced at 50GHz [13] 
                              
                                 
                                    →
                                 
                               
                              
                                 
                                    Δ
                                    ν
                                    +
                                    Δ
                                    
                                       
                                          ν
                                       
                                       
                                          NL
                                       
                                    
                                    ∼
                                    10
                                    
                                    MHz
                                 
                              .
                        
                        
                           7
                         in the presence of laser frequency fluctuations is 
                           
                              <
                              0.7
                              
                              dB
                           
                         in a 256Gb/s PDM-16QAM coherent receiver with S-JIDD. This result shows the excellent behavior of the proposed JIDD receiver in transmissions over long-haul DMT fiber links.

Due to the dispersion of UT links, the properties of the signal propagation are altered drastically with respect to DMT. It has been shown that the propagated signal appears to take on statistically-independent zero-mean Gaussian distribution [14,23,24]. This result has also been extended for the signal after the DSP block used at the receiver to compensate, e.g., CD and PMD of the UT link.
                           8
                           DSP functions in the receiver include linear equalization only of the fiber dispersion (i.e., nonlinear compensation algorithms such as back-propagation are not considered in this work).
                        
                        
                           8
                         Consequently, the nonlinear interference is modeled as AWGN. This is called the Gaussian Noise (GN) model [14]. The sample at the input of the CPR also reduces to
                           
                              (27)
                              
                                 
                                    
                                       r
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       j
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                              
                           
                         are defined as in (1), while
                           
                              (28)
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 Δ
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        is an AWGN component that represents the contribution of both ASE noise (
                           
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                           
                        ) and NLI (
                           
                              Δ
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                           
                        ).

We define the power per-channel of the DWDM system as 
                           
                              
                                 
                                    P
                                 
                                 
                                    Tx
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    0
                                 
                              
                              E
                              {
                              |
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    2
                                 
                              
                              }
                           
                         with 
                           
                              
                                 
                                    P
                                 
                                 
                                    0
                                 
                              
                           
                         being a certain gain. We also define in Table 2
                         various wavelength division multiplexing (WDM) system parameters. Then, the variance of 
                           
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              Δ
                              
                                 
                                    z
                                 
                                 
                                    k
                                 
                              
                           
                         in erbium-doped fiber amplifier (EDFA)-based optical systems with channel spacing equal to the baud rate can be approximated by [25]
                        
                           
                              (29)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       2
                                       α
                                       
                                          
                                             L
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 -
                                 1
                                 )
                                 Fhv
                                 ,
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       Δ
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 ≈
                                 
                                    
                                       8
                                    
                                    
                                       27
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       Tx
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       eff
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       ln
                                       
                                          
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      2
                                                   
                                                
                                                |
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      2
                                                   
                                                
                                                |
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      eff
                                                   
                                                
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      ch
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       π
                                       |
                                       
                                          
                                             β
                                          
                                          
                                             2
                                          
                                       
                                       |
                                       
                                          
                                             R
                                          
                                          
                                             s
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The effective signal-to-noise ratio at the DSP output results in
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   SNR
                                                
                                                
                                                   NL
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         Tx
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         z
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         Δ
                                                         z
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         Tx
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         z
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   η
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         Tx
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              η
                              =
                              
                                 
                                    σ
                                 
                                 
                                    Δ
                                    z
                                 
                                 
                                    2
                                 
                              
                              /
                              
                                 
                                    P
                                 
                                 
                                    Tx
                                 
                                 
                                    3
                                 
                              
                           
                        . Since 
                           
                              
                                 
                                    σ
                                 
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                           
                         and η are independent of 
                           
                              
                                 
                                    P
                                 
                                 
                                    Tx
                                 
                              
                           
                        , the receiver performance shall degrade at high values of 
                           
                              
                                 
                                    P
                                 
                                 
                                    Tx
                                 
                              
                           
                         (i.e., 
                           
                              
                                 lim
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       Tx
                                    
                                 
                                 
                                 →
                                 
                                 ∞
                              
                           
                           
                              
                                 SNR
                              
                              
                                 NL
                              
                           
                           =
                           0
                        ). Notice that this behavior is drastically different from that experienced in wireless channels as investigated in [1]. Based on the GN model defined by (29) and (30), in the following we evaluate the performance of S-JIDD with PDM-16QAM modulation in the presence of laser frequency fluctuations and nonlinear effects in WDM systems over UT fiber links. Table 3
                         presents the general parameters used in the simulations. Notice that the system also includes laser phase noise with 
                           
                              Δ
                              ν
                              =
                              500
                              
                              kHz
                           
                         and sinusoidal frequency jitter with 
                           
                              
                                 
                                    A
                                 
                                 
                                    p
                                 
                              
                              =
                              200
                              
                              MHz
                           
                         and 
                           
                              Δ
                              
                                 
                                    f
                                 
                                 
                                    c
                                 
                              
                              =
                              35
                              
                              kHz
                           
                        . In this situation we realize that CPR solutions based on ECPR-1 and ECPR-2 are not able to achieve an acceptable performance even in the absence of NLI (see Fig. 11).


                        Fig. 14
                         depicts the pre and post-FEC BER for different values of the link length 
                           
                              
                                 
                                    L
                                 
                                 
                                    tot
                                 
                              
                           
                         (i.e., 
                           
                              
                                 
                                    L
                                 
                                 
                                    tot
                                 
                              
                              =
                              500
                              ,
                              1000
                              ,
                              2000
                           
                        , and 4000km).
                           9
                           Pre-FEC BER is derived theoretically from 
                                 
                                    
                                       
                                          BER
                                       
                                       
                                          16
                                          QAM
                                       
                                    
                                    =
                                    0.75
                                    ·
                                    Q
                                    (
                                    
                                       
                                          0.2
                                          ·
                                          
                                             
                                                SNR
                                             
                                             
                                                NL
                                             
                                          
                                       
                                    
                                    )
                                    +
                                    0.5
                                    ·
                                    Q
                                    (
                                    
                                       
                                          1.8
                                          ·
                                          
                                             
                                                SNR
                                             
                                             
                                                NL
                                             
                                          
                                       
                                    
                                    )
                                    -
                                    0.25
                                    ·
                                    Q
                                    (
                                    
                                       
                                          5
                                          ·
                                          
                                             
                                                SNR
                                             
                                             
                                                NL
                                             
                                          
                                       
                                    
                                    )
                                 
                               with 
                                 
                                    
                                       
                                          SNR
                                       
                                       
                                          NL
                                       
                                    
                                 
                               given by (31).
                        
                        
                           9
                         The length of the span is 
                           
                              
                                 
                                    L
                                 
                                 
                                    s
                                 
                              
                              =
                              100
                              
                              km
                           
                         with 
                           
                              
                                 
                                    N
                                 
                                 
                                    ch
                                 
                              
                              =
                              80
                           
                         WDM channels. We observe that S-JIDD is able to reduce drastically the error rate up to 2000km of link lengths. This agrees very well with that reported in [14] where it has been found that 
                           
                              
                                 
                                    L
                                 
                                 
                                    tot
                                 
                              
                              ≈
                              2000
                              
                              km
                           
                         is the maximum length of the link with (i) PDM-16QAM and (ii) FEC with ∼20% overhead (i.e., ∼6.5 bits/symbol of optical channel throughput (OCT)).


                        Fig. 15
                         shows the pre and post-FEC BER for different values of number of WDM channels, 
                           
                              
                                 
                                    N
                                 
                                 
                                    ch
                                 
                              
                           
                         (i.e., 
                           
                              
                                 
                                    N
                                 
                                 
                                    ch
                                 
                              
                              =
                              40
                              ,
                              80
                           
                        , and 128). Results for transmissions without NLI (denoted as “AWGN”) have also been included for comparison purposes. The length of the span is 
                           
                              
                                 
                                    L
                                 
                                 
                                    s
                                 
                              
                              =
                              100
                              
                              km
                           
                         and the total length of the link is 
                           
                              
                                 
                                    L
                                 
                                 
                                    tot
                                 
                              
                              =
                              1000
                              
                              km
                           
                        . Unlike previous application of JIDD (see [1]), we verify that an important performance degradation caused by NLI in UT WDM systems occurs at high values of 
                           
                              
                                 
                                    P
                                 
                                 
                                    Tx
                                 
                              
                           
                        . We also observe that the impact of 
                           
                              
                                 
                                    N
                                 
                                 
                                    ch
                                 
                              
                           
                         on the performance does not change significantly when 
                           
                              
                                 
                                    N
                                 
                                 
                                    ch
                                 
                              
                              ⩾
                              40
                           
                        . In particular, note that the post-FEC BER for 
                           
                              
                                 
                                    N
                                 
                                 
                                    ch
                                 
                              
                              =
                              80
                           
                         rapidly degrades at 
                           
                              
                                 
                                    P
                                 
                                 
                                    Tx
                                 
                              
                              ≲
                              -
                              6.6
                              
                              dBm
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    Tx
                                 
                              
                              ≳
                              2.6
                              
                              dBm
                           
                        . 
                           10
                           The LDPC code considered here achieves a post-FEC BER=10-15 with a pre FEC BER around 0.025 in AWGN.
                        
                        
                           10
                         On the other hand, based on results derived from the theory in [14,25] with parameters of Table 3 we found that an OCT of 6.3 bits/symbol at the linear regime
                           11
                           In this case, 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          Tx
                                       
                                    
                                    ≲
                                    -
                                    6
                                    
                                    dBm
                                 
                              .
                        
                        
                           11
                         is achieved at 
                           
                              
                                 
                                    P
                                 
                                 
                                    Tx
                                 
                              
                              ∼
                              -
                              8.8
                              
                              dBm
                           
                         for 
                           
                              
                                 
                                    L
                                 
                                 
                                    tot
                                 
                              
                              =
                              1000
                              
                              km
                           
                        , 
                           
                              
                                 
                                    L
                                 
                                 
                                    s
                                 
                              
                              =
                              100
                              
                              km
                           
                        , and 
                           
                              
                                 
                                    N
                                 
                                 
                                    ch
                                 
                              
                              =
                              80
                           
                        . Notice that the 
                           
                              8.8
                              -
                              6.6
                              =
                              2.2
                              
                              dB
                           
                         gap to the PDM-16QAM limit is approximately the penalty respect to the Shannon capacity of the LDPC code used in this work (
                           
                              ∼
                              1.5
                              
                              dB
                           
                         
                        [14] plus the penalty caused by the pilot rate 0.44dB). Finally, Fig. 16
                         depicts the pre and post-FEC BER for different values of the span length 
                           
                              
                                 
                                    L
                                 
                                 
                                    s
                                 
                              
                           
                         (i.e., 
                           
                              
                                 
                                    L
                                 
                                 
                                    s
                                 
                              
                              =
                              65
                              ,
                              85
                           
                        , and 100km). The total length of the link is 
                           
                              
                                 
                                    L
                                 
                                 
                                    tot
                                 
                              
                              ≈
                              1000
                              
                              km
                           
                         with 
                           
                              
                                 
                                    N
                                 
                                 
                                    ch
                                 
                              
                              =
                              80
                           
                         WDM channels. As shown in Fig. 15 for 
                           
                              
                                 
                                    L
                                 
                                 
                                    s
                                 
                              
                              =
                              100
                              
                              km
                           
                        , we have verified that the performance of S-JIDD for 
                           
                              
                                 
                                    L
                                 
                                 
                                    s
                                 
                              
                              =
                              65
                           
                         and 85km is also close to the values expected from the theoretical analysis [25]. Thus, we conclude that JIDD-based receivers in combination with powerful FEC schemes will be able to achieve a performance close to the channel limits over UT WDM systems in the presence of laser phase noise and laser frequency fluctuations.

@&#CONCLUSIONS@&#

The performance of a joint iterative detection and decoding algorithm in optical coherent receivers has been investigated in this work. The excellent performance of JIDD in the presence of laser phase noise, fiber nonlinearities, and frequency fluctuations has been demonstrated. Computer simulations with high phase noise have also shown that JIDD outperforms BPS combined with non-differential modulation and the CS compensation technique proposed in [10]. Further work is needed to enable the implementation of JIDD in practical receivers. Nevertheless, we would like to emphasize that the key contribution of this work is to show that JIDD is able to successfully combat the laser phase noise and frequency fluctuations in high-speed transmissions over optical channels.

@&#ACKNOWLEDGMENTS@&#

This paper has been supported in part by Fundación Fulgor and the ANPCyT under Grant PICT-2013 2724, MINCyT – Argentina.

@&#REFERENCES@&#

