@&#MAIN-TITLE@&#An adaptive threshold based image processing technique for improved glaucoma detection and classification

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The optic nerve head region is analyzed for glaucoma diagnosis.


                        
                        
                           
                           Adaptive threshold based segmentation of optic disc and cup is implemented.


                        
                        
                           
                           CDR, NRR and blood vessel area as per ISNT rule are selected as features.


                        
                        
                           
                           An accuracy of 94.11% with sensitivity of 100% is achieved using SVM classifier.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Glaucoma

Optic disc

Optic cup

Cup to disc ratio

Adaptive threshold

Fundus image

@&#ABSTRACT@&#


               
               
                  Glaucoma is an optic neuropathy which is one of the main causes of permanent blindness worldwide. This paper presents an automatic image processing based method for detection of glaucoma from the digital fundus images. In this proposed work, the discriminatory parameters of glaucoma infection, such as cup to disc ratio (CDR), neuro retinal rim (NRR) area and blood vessels in different regions of the optic disc has been used as features and fed as inputs to learning algorithms for glaucoma diagnosis. These features which have discriminatory changes with the occurrence of glaucoma are strategically used for training the classifiers to improve the accuracy of identification. The segmentation of optic disc and cup based on adaptive threshold of the pixel intensities lying in the optic nerve head region. Unlike existing methods the proposed algorithm is based on an adaptive threshold that uses local features from the fundus image for segmentation of optic cup and optic disc making it invariant to the quality of the image and noise content which may find wider acceptability. The experimental results indicate that such features are more significant in comparison to the statistical or textural features as considered in existing works. The proposed work achieves an accuracy of 94.11% with a sensitivity of 100%. A comparison of the proposed work with the existing methods indicates that the proposed approach has improved accuracy of classification glaucoma from a digital fundus which may be considered clinically significant.
               
            

@&#INTRODUCTION@&#

One of the most prominent eye diseases in today's world is glaucoma which causes irreparable damage to the eye. Glaucoma is an optic neuropathy which results in progressive damage to the optic nerve and results in loss of vision. Glaucoma is characterized by increase in the fluid pressure inside the eye. This may result in the damage to the optic nerve and loss of nerve fibers. The advancement of glaucoma may cause blindness.

Glaucoma can be classified as primary open angle glaucoma, angle-closure glaucoma, secondary glaucoma and normal tension glaucoma. In primary angle glaucoma, the drainage system of the eye becomes inefficient over time. This inefficiency of the drainage system results in gradual increase of the pressure inside the eye. The damage is slow and painless. In angle closure glaucoma, the drainage angle of the eye is blocked. It can be progressing gradually or appearing suddenly. The secondary glaucoma is caused by physical injuries, eye abnormalities, medications and eye surgery. In normal tension glaucoma, the eye pressure remains within range but there is damage to the optic nerve. Accurate and timely diagnosis is essential for successful treatment of any disease. Computer Aided Diagnosis (CAD) may prove beneficial for screening of diseases over a large population and may be time saving as compared to the physical examination by medical professionals. It will augment and aid the clinical healthcare in the developing countries where there is shortage of trained professional ophthalmologists.

Some image processing based work on segmentation of optic disc and cup for detection of glaucoma has been reported in literature. Kavita et al. [1] proposed a component analysis method and region of interest (ROI) based methods for disc segmentation. The component analysis method and the active contour are used for cup segmentation. Nayak et al. [2] proposes a method where features such as cup to disc ratio, blood vessels area ratio in inferior–superior side to the nasal-temporal side and ratio of the distance between optic nerve head and center of optic disc to the diameter of optic disc, are extracted from the images and feed as input to the classifier to classify the images as normal or glaucoma. Niemeijer et al. [3] has used regression to locate the structures in a retinal image. Bock et al. [4] has used feature extraction, dimensionality reduction and a two stage classifier for glaucoma detection. Joshi et al. [5] proposed a method for disc and cup segmentation. The optic disc is segmented using OD parameterization technique while optic cup boundaries are determined by blood vessels. Hoover and Goldbaum [6] has found the origination of blood vessels network using fuzzy convergence and located the optic nerve head. Aquino et al. [7] proposed a method which uses morphological and edge detection techniques along with the circular Hough Transform to identify the boundary of optic disc. Liu et al. [8] proposes the use of an ARGALI framework, which consists of different methods for extraction of optic disc and cup, and use them for determination of CDR. Abràmoff et al. [9] proposes a method wherein feature classification was done on stereo color fundus images and a linear cup to disc ratio was used for glaucoma estimation. Chan and Vese et al. [10] propose a method based on numerical algorithm using finite differences to detect the boundaries of objects in a given image. Liu et al. [11] proposes method for detection of optic disc and cup. For the optic disc extraction, a region of interest is selected by using pixel intensity variation method followed by variation level set method. The optic cup is segmented using a multi modal approach. The final optic disc and cup boundaries are smoothed by using ellipse fitting. Chrastek et al. [12] used a method based on morphology, Hough Transform and active contours for segmentation of optic nerve head. Acharya et al. [13] presents a method to detect glaucoma by using texture and higher order spectra features. After feature extraction, classification is performed using a variety of classifiers. Meier et al. [14] proposed some preprocessing methods and evaluated the effects of preprocessing using principal component analysis and support vector machine. Dutta et al. [15] proposed a multi threshold based method for segmentation of optic disc and cup. Also, Hough transform is used for finding the optic disc and cup radius. Yadav et al. [16] proposed a glaucoma identification method which involves the texture features of a fundus image and artificial neural network for its identification. Sharma et al. [17] proposed use of threshold and morphology to for removal of unwanted objects from the fundus images. Issac et al. [18] proposed an automatic threshold based method for detection of optic disc and cup. Marin [19] proposed a method of obtaining optic disc center and pixel region by automatic thresholding on morphologically processed fundus images. Marumatsu [20] proposed a comparison between contour modeling and pixel classification methods of optic disc segmentation from retinal fundus images. Kao [21] proposed a Gaussian shaped template for detection of optic disc and fovea in a fundus image. All these work seems to be promising but still there is a need for higher efficient algorithms in the area of image processing to develop methods which can be used for real time applications for mass screening of Glaucoma and prove beneficial for humanity especially for those countries where there is scarcity of professional ophthalmologists.

The main contribution of the paper is a fully automatic algorithm for glaucoma detection from fundus images. The proposed glaucoma identification algorithm is based on an adaptive method that uses local features from the fundus image for segmentation making the proposed method adaptive and invariant to the quality of the images and robust to noises. Unlike the existing methods where a constant threshold for segmentation of optic disc and optic cup has been used, the proposed work uses a strategic variable threshold decided from the local statistical features of the images that makes the method completely adaptive and invariant to image quality. The variable threshold increases the accuracy of the segmentation of the objects from the images and increases the accuracy of the system.

Another contribution of this work is the strategic combination of parameters like cup to disc ratio (CDR), neuro-retinal rim (NRR) area and blood vessels distribution pattern in different regions (ISNT quadrants) of the optic nerve head region as discriminatory features and use such features together to train the learning algorithms. The choice of these features has resulted into higher accuracy of performance for identification of glaucoma from the fundus image.

The rest of the paper is organized as follows: Section 2 describes the proposed methodology and the database used. Section 3 presents the imaging techniques for optic cup and optic disc segmentation. Section 4 disuses the feature selection for glaucoma identification. Section 5 discusses the experimental results and finally Section 6 draws a conclusion to the paper.

The human eye is divided into two parts: exterior and posterior. The retinal digital fundus image deals with the posterior region of the eye which consists of the retinal surface. A retinal fundus image has blood vessels, macula and optic nerve head. The optic nerve head is the region from which the nerve fibers exit the eye and is helpful in identification of glaucoma. The optic nerve head is the brightest portion in the fundus image and can be sub divided into optic disc and cup.

A normal eye consists of only these objects. However, a glaucoma affected eye may consist of atrophy and optic cup. The peri-papillary atrophy is the thinning of the retinal layers around the optic nerve head region. When the pressure inside the eye increases, it causes a pressure on the retinal surface, thereby causing damage to the retinal nerve fibers. This creates a pressure on the optic nerve head and the optic disc starts cupping. This cupping of optic disc results in formation of optic cup. The size of optic cup determines the amount of damage caused to the eye. Usually, a cup-to-disc ratio below 0.3 is considered normal. An eye with cup-to-disc ratio above 0.3 is considered to be glaucoma affected [1] (Fig. 1
                     ).

The digital fundus image used is a 2-dimensional color image. It consists of three channels namely, red, green and blue. Each channel has its own characteristics. The optic disc is mostly of orange or bright yellow color and the boundaries of the optic disc are clearly visible in the red channel. This property can be used to differentiate the optic disc pixels from the background pixels (Fig. 2
                     ).

In the proposed paper, the optic disc is segmented from the red channel of a fundus image. The green channel provides a greater contrast between the brighter and darker pixel values. The optic cup pixels are brighter than the optic disc pixels. A high contrast is available in the green channel that differentiates the optic disc and cup pixels. This property of green channel is useful in differentiating the optic disc from the optic cup. The green channel is used for the segmentation of the optic cup.

The threshold value to segment different objects of the fundus image can be obtained from the histogram of the fundus image which will be based on some localized feature of that particular image under consideration. The optic nerve head, consisting of optic disc and cup, is the brightest region and hence consists of pixels with a higher gray value as compared to the rest of the image. The optic disc is the brightest region in the red channel and optic cup is the brightest region in the green channel. Thus, setting a proper threshold value can help in segmenting out the optic disc and cup from the red and green channel respectively. However, it will be beneficial if this threshold can be made image dependent based on local features of the image which will make the method invariant to the quality of the image and may find acceptability to various qualities of images.

Every fundus image has variable quality and needs some preprocessing steps to make the image ready for further processing. In the proposed work some preprocessing steps are applied on the red and green channel, to make them ready for the segmentation of optic disc and cup respectively.


                     Fig. 3
                      presents the methodology involved in the paper. The input image is used for the feature extraction. A total of three features are extracted from the image and fed to classifier to classify them as glaucomatous or normal. The three features which are fed to the classifier are cup-to-disc ratio, the ratio of the sum of neuro-retinal rim area in the superior and inferior region to the sum of rim area in the nasal and temporal region, and the ratio of sum of blood vessels in the optic disc region in the superior and inferior region to the sum of blood vessels in the nasal and temporal region. The various steps involved in the paper are explained in the following sections.

The fundus images used for this work were collected from the Venu Eye Research Centre, New Delhi, India. In this work total 67 images were used for experimentation from patients aged 18 to 75. A total of 67 images were used for the experimentation out of which 35 were normal images and 32 glaucoma images and were labeled by the doctors. All the images were used anonymously and had an ethical clearance from the hospital committee.

The inbuilt imaging software of the Fundus camera is used to take pictures of the inner surface of the eye in the JPEG format and had a resolution of 2544×1696 pixels. The combined anterior and posterior segment digital photography eye camera was used to capture the images. The camera used for capturing images is Welch Allyn Pan Optic Opthalmoscope, model no 11820 with dimensions 5.12″
                        L
                        ×1.40″
                        W
                        ×3.75″
                        H and weight 48lbs, 25 degrees field of view and focussing range of −20 to +20 diopters. This camera is used by doctors to diagnose eye diseases like diabetic retinopathy, glaucoma, etc. and to monitor their progression and is a convenient device for fundus image capturing.

The various steps of image processing of the digital fundus image involved for optic disc and optic cup segmentation in this work is explained in this section.

Detection of glaucoma using imaging techniques is mainly focused on analyzing the changes in the optic disc region in the fundus image. Segmenting out the optic disc may prove beneficial in Glaucoma Analysis. In this paper cup-to-disc ratio is considered as one of the feature for identification of Glaucoma. The optic disc is segmented from the red channel and optic cup from the green channel. The segmentation from the selected channels is based on the fact that optic disc region being mostly of brighter intensity is easily distinguishable from the background. The segmentation of optic cup from the green channel is based on the fact that the green channel has a high contrast and the optic cup and disc boundaries may be easily identified in a green channel.

As a preprocessing step, image standardization is done by subtracting the statistical features like mean and variance from the input image iteratively. The resultant image, I
                        
                           i+1 is obtained as:
                           
                              (1)
                              
                                 
                                    
                                       I
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       I
                                       i
                                    
                                    −
                                    (
                                    
                                       μ
                                       i
                                    
                                    +
                                    
                                       σ
                                       i
                                    
                                    )
                                 
                              
                           
                        where μ
                        
                           i
                        , σ
                        
                           i
                        
                        =mean and standard deviation of a grayscale image, and i
                        =no. of times the statistical features are subtracted iteratively from the input image.

In the experiments performed, two iterations were used in case of red channel image and three iterations were used in case of green channel image.


                        Fig. 4
                         shows the results of the preprocessing steps. Fig. 4(a) shows the input image. The red and green channel of this image is extracted. The statistical features of these channel images are used to obtain the preprocessed image which is used for further processing and classification of glaucoma.

An image histogram represents the data distribution graphically and is a quantization of probability distribution of data. A histogram may contain pointy peaks. The smoothing of histogram results in a distribution with no sharp peaks but soft bumps. The histogram of the preprocessed images show a peak which is very close to the origin and estimating the threshold from such a histogram becomes difficult. So, a process, which involves smoothing of histogram, is necessary to make the image suitable for segmenting the optic disc and cup using appropriate thresholds respectively. The steps involved in the histogram smoothing are explained in Algorithm 1.
                           
                              
                                 
                                 
                                    
                                       
                                          Algorithm 1 – Histogram smoothing
                                    
                                 
                                 
                                    
                                       1. The preprocessed red and green channel images are taken as input.
                                    
                                    
                                       2. The histogram of both the preprocessed channels is determined.
                                    
                                    
                                       3. A 1-D Gaussian filter of dimension 1*100 and standard deviation 6 is used for smoothing the histograms of both channels.
                                    
                                    
                                       4. The histogram of the preprocessed red channel and Gaussian filter are convolved with each other to result in the smoothed histogram for red channel.
                                    
                                    
                                       5. The preprocessed green channel histogram and Gaussian filter are convolved to give a smoothed histogram for green channel.
                                    
                                    
                                       6. The smoothed histograms are used for threshold selection for segmentation.
                                    
                                 
                              
                           
                        
                     


                        Fig. 5(a) shows the preprocessed red channel of the input image and its zoomed histogram is shown in Fig. 5(b). The same is shown for the green channel in Fig. 5(c) and (d). These figures have been zoomed in vertical direction in order to show the peaks in the histograms. From the histograms, a threshold is selected to differentiate the primary peak from the secondary. This threshold to segment the optic disc and cup has been marked in Fig. 5(b) and (d) respectively.

The selection of fixed value of threshold may not work on all sample images and might result in improper segmentation of optic disc and optic cup. This is because every image is independent having different levels of image properties and noise contents. If the threshold is determined from the local features of the image then the accuracy of segmentation may improve. This concept is used in this proposed approach and an adaptive threshold is selected which is based on the statistical features of the preprocessed image samples. The threshold is not selected from the histogram of the raw image. Instead, as per Eq. (1), every image is standardized based on its inherent statistical features and the resultant image is suitable for threshold selection making the algorithm adaptive. From the histograms of preprocessed channels, it is clear that the threshold has to be in between the primary and secondary peaks. The process of histogram smoothing is used to decide the threshold so that the chosen threshold in the original histograms of the preprocessed channels corresponds to the points as shown in the smoothed histograms. These points correspond to the starting point of the primary peak in the smoothed histogram of red channel for optic disc segmentation. The same process is used for green channel to determine threshold for optic cup segmentation in which the selected threshold in the original image corresponds to the termination point of the primary peak in the smoothed histogram.


                        Fig. 6
                         demonstrates the histogram smoothing process. Fig. 6(a) shows the histogram of the preprocessed red channel with a threshold marked which is used for segmentation of optic disc. The histogram shown is zoomed in vertical direction to demonstrate the smoothing process. Fig. 6(b) shows a 1-dimensional Gaussian filter of size 1×100. This Gaussian filter is normalized and has a mean of 50 and standard deviation of 6. The histogram of preprocessed red channel and the Gaussian filter are convolved to give smoothed histogram as shown in Fig. 6(c) which is suitable for threshold determination for segmentation of optic disc.

One of the main symptoms of glaucoma detection is the ratio of areas of optic cup to that of the disc. Hence there is a need to segment out the optic cup from the optic disc from the image to calculate this ratio. The threshold is determined from the smoothed histogram as discussed later in this section, is applied on the red channel after preprocessing to segment the optic disc from the pre-processed image. The image obtained is a binary image and is subjected to morphological closing. The need for morphological dilation arises because the optic nerve head is covered by blood vessels and upon segmentation gaps may occur in the boundary of the segmented optic disc. In order to remove such gaps, morphological closing is done. For the closing operation, a structuring element of dimension equal to the width of the primary blood vessels lying on the optic nerve head is chosen. This is done because the gap at the optic disc boundary is due to the blood vessel and it may have a maximum value equal to that of the width of the primary blood vessels. The primary blood vessel was found to be at most 20 pixels wide.

The optic disc is the brightest portion in the red channel. The preprocessed red channel image produces only the optic nerve head region. From the smoothed histogram, a suitable threshold is selected as discussed later in this section.


                        Fig. 7
                         shows the optic disc segmented for a sample. Fig. 7(a) is the preprocessed red channel which is used for segmentation of the optic disc. Its smoothed histogram is shown in the Fig. 7(b). A threshold τ
                        1 is shown in the Fig. 7(b). The final segmented optic disc after morphology is shown in Fig. 7(c). The final image containing the segmented optic disc is a binary image. The threshold selected for optic disc segmentation is indicated in the figure and described as follows.

The optic nerve head region, having the highest intensity pixels in a fundus image, corresponds to the peak obtained in the smoothed histogram of the preprocessed red channel and the initial point of this peak may be selected as threshold in order to segment the optic disc from the image. The standard deviation and mean of the Gaussian window is used to shift the peak in order to make it clearly visible and then the standard deviation of the preprocessed image is used to determine the starting point of the peak. In order to make the algorithm adaptive, some feature from the image needs to be used for threshold. It was observed that the standard deviation of the image was best suited to obtain the starting point of the peak when subtracted from the shifted peak in the histogram of the preprocessed image to segment the optic disc from red channel. The value of this threshold is obtained as in Eq. (2).

The threshold, τ
                        1 selected for the segmentation of the optic disc in the Fig. 6, is given by:
                           
                              (2)
                              
                                 
                                    
                                       τ
                                       1
                                    
                                    =
                                    (
                                    
                                       μ
                                       G
                                    
                                    )
                                    −
                                    (
                                    2
                                    ×
                                    
                                       σ
                                       G
                                    
                                    )
                                    −
                                    (
                                    
                                       σ
                                       
                                          RI
                                       
                                    
                                    )
                                 
                              
                           
                        where μ
                        G
                        =mean of Gaussian filter, i.e. 50, σ
                        G
                        =standard deviation of Gaussian window, i.e. 6. σ
                        RI
                        =standard deviation of the preprocessed red channel image.

This threshold resulted in a binary image. The objects in the binary image were identified and labeled on the basis of pixel count. In order to extract the optic disc region, area thresholding was done to isolate the object with maximum area.

The steps of the optic disc segmentation are given in Algorithm 2.Algorithm 2 – Optic disc segmentation1. The threshold is decided from the smoothed histogram of the preprocessed red channel using Eq. (2).2. This preprocessed red channel image is thresholded using this value.3. The binary threshold image is subjected to morphology dilation and erosion.4. A disc shaped structuring element of size of the primary blood vessel is used for dilation and erosion.5. The final image after morphology is considered for calculation of CDR.

The optic cup is the brightest portion in the green channel. The preprocessed green channel image produces an inaccurate optic nerve head region. However, the optic cup is obtained completely. A threshold is selected from the preprocessed green channel image and its smoothed histogram.


                        Fig. 8
                         shows the optic cup segmented for a sample. Fig. 8(a) is the preprocessed green channel which is used for segmentation of the optic cup. Its smoothed histogram is shown in the Fig. 8(b).

The optic cup, having the highest intensity in the green channel, corresponds to the peak obtained in the smoothed histogram of the preprocessed green channel and the termination point of this peak may be selected in order to segment the optic cup from the image. The standard deviation and mean of the Gaussian window is used to shift the peak in order to make it clearly visible and then the standard deviation and mean of the preprocessed image is used to determine the termination point of the peak in the smoothed histogram. In order to make the algorithm adaptive, it was observed that the standard deviation and mean of the image were the best suited features to obtain the termination point of the peak when added to the shifted peak in the histogram of the preprocessed image to segment the optic cup from green channel. The value of this threshold is obtained as in Eq. (3).

The threshold, τ
                        2, selected for the segmentation of the optic cup is shown in Fig. 8:
                           
                              (3)
                              
                                 
                                    
                                       τ
                                       2
                                    
                                    =
                                    (
                                    
                                       μ
                                       G
                                    
                                    )
                                    +
                                    (
                                    2
                                    ×
                                    
                                       σ
                                       G
                                    
                                    )
                                    +
                                    (
                                    2
                                    ×
                                    
                                       σ
                                       
                                          GI
                                       
                                    
                                    )
                                    +
                                    (
                                    
                                       μ
                                       
                                          GI
                                       
                                    
                                    )
                                 
                              
                           
                        where μ
                        G, σ
                        G
                        =mean and standard deviation of Gaussian window; μ
                        GI, σ
                        RI
                        =mean and standard deviation of the preprocessed green channel image.

The image having the finally segmented optic cup is a binary image. The pixels in this binary image are labeled on the basis of the pixel count and the grouped pixels with largest pixel count were retained while all remaining pixels were left out in order to segment out the optic cup.

The segmentation of optic disc and cup is completely adaptive and is dependent on statistical features from the image itself. The segmentation results of optic disc and cup are as follows:


                        Fig. 9
                         shows the results involved in the segmentation of optic disc of a few samples. Fig. 9(a) is the input image from which the disc and cup is extracted. Fig. 9(b) is the red channel of the input image which is used for the segmentation of optic disc. The following observations can be summarized.
                           
                              1.
                              From the Fig. 9 it is clear that the optic disc boundary can be easily distinguished from the background objects.

This is because the optic disc consists mostly of color content close to red color which can be easily detected in the red channel. Fig. 9(c) is the preprocessed red channel which is obtained after subtracting the mean and standard deviation from the red channel image.

The mean and standard deviation represents the statistical features which are obtained from the image on which the operation is done, indicating image dependent parameters are used.

This means that these features are local features and this method makes the segmentation process invariant to the quality of the image which may find wider acceptability.

The histogram of the preprocessed image is used to find the threshold for detection of the optic disc. Fig. 9(d) is the raw segmented optic disc. As it can be seen that this image contains some noise which needs to be removed. This is done by identifying the maximum area object from the noisy image. The objects in the noisy image are grouped on the basis of area and are labeled. Finally, the image is threshold by selecting the labeled region of maximum area. By doing this only the optic nerve head region is selected and the noise is removed. After removing the noise, morphological operations are performed so as to fill the gaps created by overlapping blood vessels. The structuring element chosen is equal to the width of the primary blood vessel. The optic disc obtained finally is shown in Fig. 9(e). The number of white pixels in the final segmented image is calculated and termed as disc area and is used for the CDR calculation.


                        Fig. 10
                         shows the results involved in the segmentation of optic cup of the same samples for which optic disc was segmented above. Fig. 10(a) is the input image from which the disc and cup is extracted. Fig. 10(b) is the green channel of the input image which is used for the segmentation of optic cup. The following observations can be summarized from the results.
                           
                              1.
                              From the Fig. 10 it is clear that the optic cup and optic disc boundaries can be easily distinguished from each other in a green channel due to a high contrast presence.


                                 Fig. 10(c) is the preprocessed green channel which is obtained after subtracting the mean and standard deviation from the green channel of the input image.

The mean and standard deviation are obtained as local features for each image. The selection of local features makes the algorithm adaptive in nature.

The histogram of this preprocessed image is used to find the threshold for detection of the optic cup. The threshold is decided based on these local properties making it invariant to quality of images and applicable to wide range of images of various qualities.


                                 Fig. 10(d) is the raw segmented optic cup. It can be seen that this image contains some noise which needs to be removed. This is done by identifying the maximum area using an area threshold based method. Hence, only the optic cup region is selected and the noise is removed.

After removing the noise, morphological operations are performed so as to fill the gaps. The finally obtained optic disc is shown in Fig. 10(e). The number of white pixels in the final segmented image is calculated and termed as cup area.

This section presents the different feature selection and extraction from the fundus image for classification of glaucoma.

The optic cup to disc ratio is one of the popular feature for evaluation of glaucoma. The cup to disc ratio can be calculated by two ways. The first technique of finding CDR is finding the vertical diameter of both the optic disc and cup, and dividing the vertical diameter of the optic cup by the vertical diameter of the optic disc. The second method involves the calculation of the area of the optic disc and cup. The area of the optic cup when divided by the area of the optic disc results in the CDR value. In this paper, the later method is used. The area of the disc and cup is calculated after performing the morphological operations. The finally obtained binary images after morphology are used for CDR calculation. The CDR is calculated by finding the ratio of the optic cup area to the optic disc area. The optic disc and cup area are found by calculating the number of white pixels in respective images. The calculated CDR is used as one of the feature for classification. An image, with CDR value greater than 0.3, is considered as glaucomatous and vice versa [1].

A neuro retinal rim is the disc shaped structure which is left if the cup area is removed from the disc. The appearance of the neuro retinal rim can quantify the damage to the optic disc. The neuro retinal rim of a healthy disc follows the ISNT rule. The rule states that for a healthy disc, the thickest portion of the rim is inferior, followed by superior, then nasal and temporal. The inferior is the thickest and temporal is the thinnest.

The NRR area is calculated as [2]:
                           
                              (4)
                              
                                 
                                    N
                                    =
                                    
                                       
                                          Area in inferior quadrant
                                          +
                                          Area in superior quadrant
                                       
                                       
                                          Area in nasal quadrant
                                          +
                                          Area temporal quadrant
                                       
                                    
                                 
                              
                           
                        
                     

For a healthy disc, usually, the ISNT rule is followed. A healthy disc usually has a cup spread out in nasal and temporal region. But as the glaucoma progresses, the cup starts to expand in the inferior and superior region of the disc. This causes a violation of the ISNT rule. This means the area in inferior and superior region decreases. So, for a healthy eye, this value may be greater than unity, but for an infected eye, the value of NRR area may be close to unity or may be less than that. This is calculated for all the images and is used as a feature for classification.

The centroid of the segmented optic disc is found out and is used as center to crop the image. The finally cropped image is of the size 500×500 with the centroid of the optic disc as its center. This size was decided after observing all the images and this size was selected as it was found adequeate to cover the optic nerve head region of all the images which were used in this work. The mask is also of the same size as the cropped image. The mask is rotated by 90 degrees and used on the cropped image to find the NRR area in each quadrant.


                        Fig. 11
                         shows the detection of the neuro retinal rim. Fig. 11(a) shows the cropped image extracted after finding the centroid of the segmented disc and cropped. Fig. 11(b) shows the segmented optic disc which is obtained after performing threshold and morphological operations. Fig. 11(c) shows the optic cup. Fig. 11(d) shows the neuro retinal rim. This image is obtained by subtracting optic cup from the optic disc. The top and bottom quadrant of this image are the inferior and superior quadrants while the left and right ones are the nasal and temporal. The mask shown in Fig. 12
                         is used to segment the rim in each quadrant.


                        Fig. 12(a) shows the mask to segment the neuro retinal rim (NRR) area in superior quadrant. The topmost region is the superior quadrant. Since, the algorithm involves adding up the area in nasal and temporal quadrants, hence, the mask for nasal and temporal is kept the same for all the images, even though the images may be for left eye or right eye. Fig. 12(b) shows the mask to segment the area in nasal quadrant. Fig. 12(c) shows the mask for the inferior and Fig. 12(d) for temporal quadrant.


                        Fig. 13(a) shows the neuro retinal rim obtained after subtracting the optic cup from the optic disc. Fig. 13(b) shows the NRR area in the superior quadrant. This area is obtained when the NRR image is multiplied with the mask image in the superior quadrant. The similar procedure is done to obtain the NRR area in the other quadrants. This is done by multiplying the NRR image with the mask in the different quadrants. The results are shown in Fig. 13(c)–(e). These white pixels lying in all the four quadrants is calculated and used to find the NRR Area. It is the ratio of the sum of the area in the superior and inferior quadrant to the sum of the area in the nasal and temporal quadrants. The same procedure is done for all the available images and this is used as the second feature for classification of images for identification of glaucoma.

For any fundus image, the blood vessels enter the eye from the optic disc. They enter the eye in the vertical direction, i.e. from the inferior and superior side. It is known that that for a healthy fundus image, the blood vessels are mostly concentrated in the inferior and superior quadrants of the optic disc [22]. If the image gets affected by glaucoma, a shift in the optic nerve head occurs. This shift in the optic nerve head causes the blood vessels to shift toward the nasal side of the disc. This shift causes a decrease in the blood vessels in the inferior and superior regions. Keeping this fact in mind, a ratio of blood vessels is calculated [2].(5)
                           
                              B
                              =
                              
                                 
                                    Area in inferior quadrant
                                    +
                                    Area in superior quadrant
                                 
                                 
                                    Area in nasal quadrant
                                    +
                                    Area temporal quadrant
                                 
                              
                           
                        
                     

The blood vessels are extracted as in [2]. The mask used for the extraction of the blood vessels in each quadrant is same as that used for extraction of NRR area. The mask is multiplied with the blood vessels extracted image and used to find the blood vessels area in the optic disc.


                        Fig. 14
                         depicts the process involved in the extraction of blood vessels on the optic disc. The optic disc binary image is used as mask on the green channel. This results in an image which has only the optic disc region of the green channel. Fig. 14(a) shows the cropped green channel image with only the blood vessels on the optic disc region. Fig. 14(b) shows the extracted blood vessels as explained in [2]. Fig. 14(c)–(f) shows the blood vessels in all the four quadrants, namely, superior, nasal, inferior and temporal respectively. After extracting the blood vessels in each quadrant, the blood vessels area ratio is calculated as the ratio of the sum of blood vessels area in superior and inferior to the sum of blood vessels area in nasal and temporal. The ratio should be less for a glaucomatous eye in comparison to a healthy eye.

The cup to disc ratio, NRR area and blood vessels area in the ISNT quadrants are used as features for classification of glaucomatous image. Table 1
                         shows the range of the three features which are used as input to the classifiers.

The cup to disc ratio greater than 0.3 is considered as glaucomatous and CDR less than 0.3 is considered as normal. The NRR Area and blood vessels area in ISNT quadrants should have a lower value for a glaucomatous eye and higher for a normal eye. The box plot for the features range is shown in Fig. 15
                        .

In the box plot of Fig. 15, the Class 1 represents normal and Class 2 represents glaucomatous. Fig. 15(a) shows the range of CDR for all images. Fig. 15(b) shows the variation of Neuro Retinal Rim Area for all images and Fig. 15(c) shows the range of the blood vessels area in ISNT quadrants for all images.

@&#EXPERIMENTAL RESULTS@&#

A total of 67 images were used for experimentation. Out of the 67 images used, 35 are related to healthy cases and 32 glaucomatous respectively.

For the classification purpose, various kernels of the SVM were used. Along with the kernels, the training and testing samples were also varied. It was observed that the best accuracy is obtained for a RBF kernel. An accuracy of 94.11% with a specificity of 90% and sensitivity of 100% is obtained for the SVM classifier with 50 training and 17 testing samples. The 50 training samples consisted of 25 normal and 25 glaucoma samples. Out of 17 testing samples, 10 were normal and 7 were glaucomatous samples. The variation of accuracy with number of training samples is presented in Table 2
                        . It can be seen from the table that the accuracy of identification increases as more number of samples are used to train the classifiers. The best result with the settings is reported in Table 3
                        .

While all the 7 samples were correctly classified as glaucomatous, 9 out of 10 samples were classified as normal. Table 3 shows the experimental results when the three features, i.e. cup to disc ratio, neuro retinal rim area in ISNT quadrants and blood vessels in ISNT quadrant, were given as input to the SVM classifier.

Since, the data size is small and using more samples for testing can create over fitting of the samples, so leave one out cross validation classification technique was also employed for classification of the samples. In this technique, out of all the available samples only one sample is taken as testing set while all the remaining are considered as training data set. This process is repeated for every sample until each and every available sample has been a test sample once. The average accuracy of all the samples is calculated. This cross validation technique produced an accuracy of 94.03% with specificity of 94.29% and sensitivity of 93.75% for SVM classifier. The results after implementing this algorithm as tabulated below in Table 3 However, the best results for the classifier are reported in Table 4
                        .

The neural network employed has an input layer, a hidden layer and an output layer. The network consist a total of 3 layers, with 20 neurons in the hidden layer. The feed-forward network was used for the classification. The number of training and testing samples was varied to study the classification rate. It was observed that the accuracy increases if the number of samples in training dataset increases. When the training dataset consisted of 50 training samples and 17 samples were used for testing, it provided an overall accuracy of 89.6%. The overall sensitivity was 78.1% and specificity of 100% is achieved. This means that all the normal samples were correctly classified by ANN classifier.


                        Fig. 16
                         shows the variation of accuracy against the number of training samples. It can be seen that as the number of training samples is increased, both the classifiers produced good results.


                        Table 3 gives a comparative analysis of performance of proposed method against some existing methods of glaucoma detection. It can be seen from the table that the proposed method performs well in terms of accuracy in comparison to other existing methods. Some final remarks are as follows.
                           
                              1.
                              Unlike existing works, the proposed work uses a threshold which is adaptive and is decided from the local features of the images which improves accuracy and finds more acceptability to various qualities of images acquired under different imaging conditions and noises.

The strategic use of three features in the proposed work i.e. CDR, NRR and blood vessels in NRR is a robust approach for accurate classification of glaucoma from the fundus images. These features used in SVM classifier and ANN classifier have returned encouraging results (Table 5
                                 ).

The common challenge in glaucoma detection is the accurate segmentation of optic disc which can be affected due to the presence of peri-papillary atrophy (PPA). In few glaucoma samples, CDR<0.3 is diagnosed due to the presence of PPA. This problem is not addressed in this proposed work and the proposed algorithm needs further improvement to address this challenge. However, the NRR area and blood vessels area in ISNT quadrants lie within the range in these cases of PPA. Thus, classification was possible in such cases. Also, in a few cases in which experts have labeled them as glaucomatous, CDR value obtained was less than 0.3. This is owing to the intra ocular pressure (IOP) exceeding the limit in these cases. However, the disc and cup segmentation was correct in these cases using the proposed imaging method.

@&#CONCLUSION@&#

The paper presents a technique for glaucoma detection and classification using a novel image processing technique in the digital fundus image. The glaucoma detection is done by taking into consideration, the cup-to-disc ratio (CDR), neuro-retinal rim (NRR) area and blood vessels in the different regions of the optic nerve head. Strategic use of these features is done to classify the fundus images as glaucomatous or non-glaucomatous. The segmentation of the optic disc and cup is threshold based and completely adaptive. The algorithm uses local statistical features of the fundus image to make the proposed system adaptive. Unlike the existing methods where constant threshold is used, the adaptive nature of the proposed threshold based segmentation algorithm helps in improving the accuracy of the system and find acceptability to a wide range of images of various qualities. The rim area and blood vessels in ISNT quadrants is calculated and both these values along with CDR are fed as input to the classifier. An accuracy of 94.11% with sensitivity of 100% and specificity of 90% is obtained from the proposed method using SVM and ANN classifiers. The framework can be used screening of Glaucoma over a large population. This proposed work is clinically significant, as the accuracy of this method is high and competitive with existing methods.

Future work in this direction may be consideration of some other alternate features of glaucoma from fundus image and use of different classifiers for further improving the performance of the method.

@&#ACKNOWLEDGEMENTS@&#

This work was supported in parts by the Grants from Department of Science and Technology No. DST/TSG/ICT/2013/37, Also the authors express their thankfulness to Dr. S.C. Gupta, Medical Director of Venu Eye Research Centre for his contribution in classification of the images.

@&#REFERENCES@&#

