@&#MAIN-TITLE@&#Improved bounds for the traveling umpire problem: A stronger formulation and a relax-and-fix heuristic

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study the Traveling Umpire Problem (TUP) and strengthen a known IP formulation.


                        
                        
                           
                           We use the stronger formulation to implement a relax-and-fix heuristic.


                        
                        
                           
                           The heuristic improves 24 out of 25 best-known solutions in the TUP benchmark.


                        
                        
                           
                           We also improve all best-known lower bounds for those instances.


                        
                        
                           
                           We are the first to provide lower bounds for instances with more than 16 teams.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in sports

Baseball

Heuristics

Integer programming

Relax-and-fix

Traveling umpire problem

@&#ABSTRACT@&#


               
               
                  Given a double round-robin tournament, the traveling umpire problem (TUP) consists of determining which games will be handled by each one of several umpire crews during the tournament. The objective is to minimize the total distance traveled by the umpires, while respecting constraints that include visiting every team at home, and not seeing a team or venue too often. We strengthen a known integer programming formulation for the TUP and use it to implement a relax-and-fix heuristic that improves the quality of 24 out of 25 best-known feasible solutions to instances in the TUP benchmark. We also improve all best-known lower bounds for those instances and, for the first time, provide lower bounds for instances with more than 16 teams.
               
            

@&#INTRODUCTION@&#

The assignment of officials (referees, umpires, judges, etc.) to the games of a competition is an important and difficult problem studied in the area of sports scheduling. The specific constraints and objectives vary according to the sport and type of competition, of course, but they typically aim to satisfy a given set of fairness criteria while minimizing costs (e.g. wages or travel). Existing research ranges over many different sports, including baseball (Evans, Hebert, & Deckro, 1984; Evans, 1988; Trick & Yildiz, 2011; Trick & Yildiz, 2012; Trick, Yildiz, & Yunes, 2012), cricket (Wright, 1991), football (Yavuz, İnan, & Fığlalı, 2008), and tennis (Farmer, Smith, & Miller, 2007). For more comprehensive surveys of sports-related problems, we refer to Ernst, Jiang, Krishnamoorthy, Owens, and Sier (2004) and Kendall, Knust, Ribeiro, and Urrutia (2010).

We study the traveling umpire problem (TUP), which was first proposed by Trick and Yildiz (2007) as an abstract version of the real-life umpire scheduling problem faced by Major League Baseball. Despite excluding many details present in the real problem, the TUP successfully captures the most important features that make the problem very challenging to solve. This is evidenced by the fact that many small instances remain unsolved in the official TUP benchmark: Trick (2013).

Given a double round-robin tournament with 
                        
                           2
                           n
                        
                      teams (each team plays against each other team twice, once at home and once on the road, over exactly 
                        
                           4
                           n
                           -
                           2
                        
                      rounds), the distances between the home venues of each pair of teams, and two integers 
                        
                           0
                           ⩽
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           <
                           n
                        
                      and 
                        
                           0
                           ⩽
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           <
                           ⌊
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           ⌋
                        
                     , a solution to the TUP is an assignment of n umpire crews (umpires, for short) that satisfies the following constraints:
                        
                           (i)
                           In each round, each umpire is assigned to exactly one game and each game must be assigned to an umpire;

Each umpire visits every team at home at least once;

Each umpire visits any given venue at most once in any sequence of 
                                 
                                    n
                                    -
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                 
                               consecutive games;

Each umpire sees any given team at most once in any sequence of 
                                 
                                    ⌊
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    ⌋
                                    -
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                 
                               consecutive games.

The objective is to find a feasible solution that minimizes the total distance traveled by the umpires over the entire tournament.

When 
                        
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           =
                           0
                        
                     , TUP instances tend to be more difficult to solve because constraints (iii) and (iv) become stricter. We refer to these instances as hard instances. To allow for a wider range in the degree of difficulty, the TUP benchmark also includes instances with 
                        
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           >
                           0
                        
                     , to which we refer as relaxed instances.

Our main contributions are: (1) we strengthen a known integer programming formulation for the TUP and use it to implement a relax-and-fix heuristic that improves the quality of 24 out of 25 best-known feasible solutions to instances in the TUP benchmark; and (2) using our stronger formulation, we improve all best-known lower bounds for those instances and, for the first time, provide lower bounds for instances with more than 16 teams.

Before explaining our approach in detail, we review the existing exact and heuristic methods for solving the TUP.


                     Trick and Yildiz (2007) present exact integer programming (IP) and constraint programming (CP) models for the TUP and test them on benchmark instances ranging from 4 to 16 teams, as well as on a 30-team instance. These same models are also used in Trick and Yildiz (2011); Trick and Yildiz (2012); and Trick et al. (2012), but in Trick and Yildiz (2011) and Trick and Yildiz (2012) the performance of the IP model is improved by a better choice of solver parameters (execution times were limited to three hours). Their IP model finds optimal solutions to all instances with at most 10 teams. The CP model finds optimal solutions to all instances with at most 8 teams, and also to one of the four 10-team instances. In addition, it manages to prove that the 12-team instance is infeasible; a conclusion that was not obtained by the IP model within the allowed computation time. When it comes to hard instances with 14 teams, both IP and CP find feasible solutions to all four instances, with the CP model beating the IP model in terms of solution quality in three of the four cases. Neither the IP nor the CP models managed to find any feasible solutions to hard instances with more than 14 teams. When run on relaxed instances, the CP model finds feasible solutions to all eight 14-team and all twelve 16-team instances. The IP model finds feasible solutions to 17 of these 20 instances (three 16-team instances had no solution after 3hours), but all 17 solutions are better than their counterpart solutions found by the CP model. Neither method managed to find provably optimal solutions to any of the relaxed instances with more than 10 teams.

On the heuristic side, we focus on hard and relaxed instances with at least 14 teams because none of them have known optimal solutions (29 instances in total; 25 with known feasible solutions). Trick et al. (2012) describe a greedy matching heuristic (GMH) and a two-exchange local search that are combined to build a simulated annealing (SA) heuristic. The SA heuristic does reasonably well on the real-life Major League Baseball problem of 2006, but it does not perform so well on the TUP instances. Trick and Yildiz (2011) incorporate the GMH into a large neighborhood search guided by Benders cuts that help repair the solution being built when the heuristic gets stuck. This improved GMH, which they call GBNS, finds feasible solutions to 23 out of 25 instances with previously known solutions, with 16 of those solutions being improvements over the best results at the time. In a follow-up paper, Trick and Yildiz (2012) propose a genetic algorithm (GA) with a crossover operator that uses a matching scheme to recombine the individuals of a population. Their GA further improves the quality of 14 instances with respect to the GBNS results. As of August, 2013, the results published in Trick (2013) indicate that the four best-known solutions to the 14-team hard instances were obtained by Wauters (2013). Table 1
                      shows how many of the 25 best-known solutions to date have been found by each of the most successful methods described above. The GA currently owns the majority of best-known solutions (13 out of 25), including the best solution to the 30-team instance.

The remainder of this paper is organized as follows. In Section 3, we present the IP formulation of Trick and Yildiz (2011) and show how it can be strengthened. We describe our relax-and-fix heuristic in Section 4, and provide computational results in Section 5. We conclude the paper and discuss future research directions in Section 6.

For simplicity, we use letters i and j to refer to teams i and j, as well as their respective home venues. In addition, we use letters u and s to refer to an umpire and a round in the tournament, respectively.

The IP formulation used by Trick and Yildiz (2011); Trick and Yildiz (2012); and Trick et al. (2012) starts with the following input data:
                           
                              •
                              Set of umpires 
                                    
                                       U
                                       =
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       }
                                    
                                 ;

Set of teams 
                                    
                                       T
                                       =
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       2
                                       n
                                       }
                                    
                                 ;

Set of rounds 
                                    
                                       S
                                       =
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       4
                                       n
                                       -
                                       2
                                       }
                                    
                                 ;


                                 
                                    
                                       OPP
                                       [
                                       s
                                       ,
                                       i
                                       ]
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         if
                                                         
                                                         i
                                                         
                                                         plays against
                                                         
                                                         j
                                                         
                                                         at venue
                                                         
                                                         i
                                                         
                                                         in round
                                                         
                                                         s
                                                      
                                                   
                                                   
                                                      
                                                         -
                                                         j
                                                      
                                                      
                                                         if
                                                         
                                                         i
                                                         
                                                         plays against
                                                         
                                                         j
                                                         
                                                         at venue
                                                         
                                                         j
                                                         
                                                         in round
                                                         
                                                         s
                                                         ;
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              


                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ij
                                          
                                       
                                    
                                  = distance in miles between venues i and j;


                                 
                                    
                                       
                                          
                                             CV
                                          
                                          
                                             s
                                          
                                       
                                       =
                                       {
                                       s
                                       ,
                                       …
                                       ,
                                       s
                                       +
                                       n
                                       -
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       -
                                       1
                                       }
                                    
                                  for any given round 
                                    
                                       s
                                       ∈
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       4
                                       n
                                       -
                                       2
                                       -
                                       (
                                       n
                                       -
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       -
                                       1
                                       )
                                       }
                                    
                                 ;


                                 
                                    
                                       
                                          
                                             CT
                                          
                                          
                                             s
                                          
                                       
                                       =
                                       {
                                       s
                                       ,
                                       …
                                       ,
                                       s
                                       +
                                       ⌊
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                       ⌋
                                       -
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       1
                                       }
                                    
                                  for any given round 
                                    
                                       s
                                       ∈
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       4
                                       n
                                       -
                                       2
                                       -
                                       (
                                       ⌊
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                       ⌋
                                       -
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       1
                                       )
                                       }
                                    
                                 .

The decision variables are:
                           
                              •
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             isu
                                          
                                       
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         if the game at venue
                                                         
                                                         i
                                                         
                                                         in round
                                                         
                                                         s
                                                         
                                                         is assigned to umpire
                                                         
                                                         u
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         otherwise;
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              


                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ijsu
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         if umpire
                                                         
                                                         u
                                                         
                                                         is at venue
                                                         
                                                         i
                                                         
                                                         in round
                                                         
                                                         s
                                                         
                                                         and travels to venue
                                                         
                                                         j
                                                         
                                                         in round
                                                         
                                                         s
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         otherwise.
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

We are now ready to state the formulation.
                           
                              (1)
                              
                                 
                                    min
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          ∈
                                          U
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          s
                                          ∈
                                          S
                                          :
                                          s
                                          <
                                          |
                                          S
                                          |
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijsu
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 subject to
                                 :
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                          ∈
                                          U
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       isu
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ∈
                                 T
                                 ,
                                 s
                                 ∈
                                 S
                                 :
                                 OPP
                                 [
                                 s
                                 ,
                                 i
                                 ]
                                 >
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          T
                                          :
                                          OPP
                                          [
                                          s
                                          ,
                                          i
                                          ]
                                          >
                                          0
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       isu
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 ∀
                                 
                                 s
                                 ∈
                                 S
                                 ,
                                 u
                                 ∈
                                 U
                                 ,
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          s
                                          ∈
                                          S
                                          :
                                          OPP
                                          [
                                          s
                                          ,
                                          i
                                          ]
                                          >
                                          0
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       isu
                                    
                                 
                                 ⩾
                                 1
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ∈
                                 T
                                 ,
                                 u
                                 ∈
                                 U
                                 ,
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          c
                                          ∈
                                          
                                             
                                                CV
                                             
                                             
                                                s
                                             
                                          
                                          :
                                          OPP
                                          [
                                          c
                                          ,
                                          i
                                          ]
                                          >
                                          0
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       icu
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                 
                                    
                                       
                                          ∀
                                          
                                          i
                                          ∈
                                          T
                                          ,
                                          u
                                          ∈
                                          U
                                          ,
                                          s
                                          ∈
                                          S
                                          :
                                       
                                    
                                    
                                       
                                          s
                                          ⩽
                                          ∣
                                          S
                                          ∣
                                          -
                                          (
                                          n
                                          -
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          -
                                          1
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          c
                                          ∈
                                          
                                             
                                                CT
                                             
                                             
                                                s
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                icu
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   T
                                                   :
                                                   OPP
                                                   [
                                                   c
                                                   ,
                                                   j
                                                   ]
                                                   =
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                jcu
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                 
                                    
                                       
                                          ∀
                                          
                                          i
                                          ∈
                                          T
                                          ,
                                          u
                                          ∈
                                          U
                                          ,
                                          s
                                          ∈
                                          S
                                          :
                                       
                                    
                                    
                                       
                                          s
                                          ⩽
                                          ∣
                                          S
                                          ∣
                                          -
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          1
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       x
                                    
                                    
                                       isu
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       j
                                       (
                                       s
                                       +
                                       1
                                       )
                                       u
                                    
                                 
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       ijsu
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 j
                                 ∈
                                 T
                                 ,
                                 u
                                 ∈
                                 U
                                 ,
                                 s
                                 ∈
                                 S
                                 :
                                 s
                                 <
                                 ∣
                                 S
                                 ∣
                                 ,
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       x
                                    
                                    
                                       isu
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ∈
                                 T
                                 ,
                                 u
                                 ∈
                                 U
                                 ,
                                 s
                                 ∈
                                 S
                                 ,
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       z
                                    
                                    
                                       ijsu
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 j
                                 ∈
                                 T
                                 ,
                                 u
                                 ∈
                                 U
                                 ,
                                 s
                                 ∈
                                 S
                                 :
                                 s
                                 <
                                 ∣
                                 S
                                 ∣
                                 .
                              
                           
                        
                     

The objective function (1) minimizes the total distance traveled by the umpires. Constraints (2) and (3) state that each game is refereed by an umpire, and each umpire is assigned to a game, respectively. TUP constraints (ii), (iii), and (iv) from Section 1 are modeled by (4)–(6), respectively. Finally, (7) ensures that game (x) and travel (z) assignments are consistent.


                        Trick and Yildiz (2011) improve the above formulation by including the following constraints:
                           
                              (10)
                              
                                 
                                    
                                       x
                                    
                                    
                                       isu
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ∈
                                 T
                                 ,
                                 u
                                 ∈
                                 U
                                 ,
                                 s
                                 ∈
                                 S
                                 :
                                 OPP
                                 [
                                 s
                                 ,
                                 i
                                 ]
                                 <
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       z
                                    
                                    
                                       ijsu
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       isu
                                    
                                 
                                 ⩽
                                 0
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 j
                                 ∈
                                 T
                                 ,
                                 u
                                 ∈
                                 U
                                 ,
                                 s
                                 ∈
                                 S
                                 :
                                 s
                                 <
                                 ∣
                                 S
                                 ∣
                                 ,
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       z
                                    
                                    
                                       ijsu
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       j
                                       (
                                       s
                                       +
                                       1
                                       )
                                       u
                                    
                                 
                                 ⩽
                                 0
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 j
                                 ∈
                                 T
                                 ,
                                 u
                                 ∈
                                 U
                                 ,
                                 s
                                 ∈
                                 S
                                 :
                                 s
                                 <
                                 ∣
                                 S
                                 ∣
                                 ,
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          T
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       jisu
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          T
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                       (
                                       s
                                       +
                                       1
                                       )
                                       u
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ∈
                                 T
                                 ,
                                 u
                                 ∈
                                 U
                                 ,
                                 s
                                 ∈
                                 S
                                 :
                                 s
                                 <
                                 ∣
                                 S
                                 ∣
                                 -
                                 1
                                 ,
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          T
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijsu
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 ∀
                                 
                                 u
                                 ∈
                                 U
                                 ,
                                 s
                                 ∈
                                 S
                                 :
                                 s
                                 <
                                 ∣
                                 S
                                 ∣
                                 .
                              
                           
                        Constraint (10) forbids the assignment of an umpire to a venue where no game is played in the given round. Constraints (11) and (12) allow an umpire to move from or to a venue in round s and 
                           
                              s
                              +
                              1
                           
                        , respectively, only if the umpire is assigned to the venue in those rounds. The flow conservation constraint (13) states that if umpire u is (is not) at venue i in round 
                           
                              s
                              +
                              1
                           
                        , his trip from round 
                           
                              s
                              +
                              1
                           
                         to round 
                           
                              s
                              +
                              2
                           
                         must (must not) start at venue i. Constraint (14) forces every umpire to move from one round to the next.

Formulation (1)–(14) suffers from symmetry because, given a solution, 
                           
                              n
                              !
                           
                         equivalent solutions can be obtained by permuting the umpires. To overcome this problem, Yildiz (2008) fixes the games refereed by each umpire in a given round k, which is chosen arbitrarily in the interval 
                           
                              [
                              1
                              ,
                              4
                              n
                              -
                              2
                              ]
                           
                        . To accomplish that, we enforce (15) for a given set K of tuples that assign each umpire to a different venue where a game takes place in round k:
                           
                              (15)
                              
                                 
                                    
                                       x
                                    
                                    
                                       iku
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 ∀
                                 
                                 (
                                 i
                                 ,
                                 u
                                 )
                                 ∈
                                 K
                                 .
                              
                           
                        
                     

We refer to round k as the symmetry breaking round, and to formulation (1)–(15) as 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        . The linear relaxation of 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        , in which we replace the integrality constraints 8–9 with 
                           
                              0
                              ⩽
                              
                                 
                                    x
                                 
                                 
                                    isu
                                 
                              
                              ⩽
                              1
                           
                         and 
                           
                              0
                              ⩽
                              
                                 
                                    z
                                 
                                 
                                    ijsu
                                 
                              
                              ⩽
                              1
                           
                        , is denoted by 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    R
                                 
                              
                           
                        .

Based on 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        , we propose a stronger formulation for the TUP that includes the following valid identities:
                           
                              (16)
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       1
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          T
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                       1
                                       u
                                    
                                 
                                 
                                 ∀
                                 
                                 i
                                 ∈
                                 T
                                 ,
                                 u
                                 ∈
                                 U
                                 ,
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       x
                                    
                                    
                                       isu
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          T
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ji
                                       (
                                       s
                                       -
                                       1
                                       )
                                       u
                                    
                                 
                                 
                                 ∀
                                 
                                 i
                                 ∈
                                 T
                                 ,
                                 u
                                 ∈
                                 U
                                 ,
                                 s
                                 ∈
                                 S
                                 :
                                 s
                                 >
                                 1
                                 .
                              
                           
                        Constraint (16) ensures that an umpire u is assigned to a venue i in the first round if, and only if, u travels away from i in this round. Analogously, (17) enforces that an umpire u is assigned to a venue i in round 
                           
                              s
                              >
                              1
                           
                         if, and only if, u travels to i between rounds 
                           
                              s
                              -
                              1
                           
                         and s.

Because (16)–(17) are equalities, variable x can be eliminated from 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                         by replacing each of its occurrences with the proper summation over z. Let 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                           
                         be the formulation that results from 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                         after both eliminating x and removing (3), (7), (11), (12), and (14). We refer to the linear relaxation of 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                           
                         as 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                                 
                                    R
                                 
                              
                           
                        .
                           Proposition 1
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                 
                               
                              is a valid IP formulation for the TUP.
                           

It suffices to show that (3), (7), (11), (12), and (14) are implied by the conjunction of (16) and (17) with the remaining constraints of 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                 
                              . For simplicity, and without loss of generality, we will show the implications before eliminating x from the model.

First, by combining (13) and (16), (17) we obtain the following identity:
                                 
                                    (18)
                                    
                                       
                                          
                                             x
                                          
                                          
                                             isu
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             ijsu
                                          
                                       
                                       ,
                                       
                                       ∀
                                       
                                       i
                                       ∈
                                       T
                                       ,
                                       u
                                       ∈
                                       U
                                       ,
                                       s
                                       ∈
                                       S
                                       :
                                       s
                                       <
                                       ∣
                                       S
                                       ∣
                                       .
                                    
                                 
                              To see that (18) implies (11), note that 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          T
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          ijsu
                                       
                                    
                                    ⩾
                                    
                                       
                                          z
                                       
                                       
                                          ihsu
                                       
                                    
                                 
                               for any given 
                                 
                                    h
                                    ∈
                                    T
                                 
                              . The proof that (17) implies (12) is analogous.

We now show that (3) and (14) are implied constraints. Because of (13), we can write
                                 
                                    (19)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             ij
                                             1
                                             u
                                          
                                       
                                       =
                                       …
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             ijku
                                          
                                       
                                       =
                                       …
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             ij
                                             (
                                             ∣
                                             S
                                             ∣
                                             -
                                             1
                                             )
                                             u
                                          
                                       
                                       ,
                                       
                                       ∀
                                       
                                       u
                                       ∈
                                       U
                                       ,
                                    
                                 
                              and, by replacing the inner summations in (19) with the appropriate x variables according to (18), we obtain the equivalent equalities in (20), except for the last one:
                                 
                                    (20)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             1
                                             u
                                          
                                       
                                       =
                                       …
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             iku
                                          
                                       
                                       =
                                       …
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             (
                                             ∣
                                             S
                                             ∣
                                             -
                                             1
                                             )
                                             u
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             (
                                             ∣
                                             S
                                             ∣
                                             )
                                             u
                                          
                                       
                                       ,
                                       
                                       ∀
                                       
                                       u
                                       ∈
                                       U
                                       .
                                    
                                 
                              To obtain the last equality in (20) we replace the rightmost inner summation in (19) with the appropriate x variable according to (17).

Because of (15), 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          T
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          iku
                                       
                                    
                                    =
                                    1
                                 
                              . Thus, all the expressions in (19) and (20) are equal to 1. Since the summations in (19) and (20) are the same as those in (14) and (3), respectively, the latter are satisfied.

Finally, we show that (7) is an implied constraint. For any 
                                 
                                    u
                                    ∈
                                    U
                                    ,
                                    s
                                    ∈
                                    S
                                    ,
                                    s
                                    <
                                    |
                                    S
                                    |
                                 
                              , we have seen that combining (15), (19), and (20) yields
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             ijsu
                                          
                                       
                                       =
                                       1
                                       .
                                    
                                 
                              
                           

Hence, for a given pair of venues 
                                 
                                    i
                                    ,
                                    j
                                 
                               in the double-summation above, we have
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                h
                                                ∈
                                                T
                                                :
                                                h
                                                ≠
                                                j
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             ihsu
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                h
                                                ∈
                                                T
                                                :
                                                h
                                                ≠
                                                i
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             hjsu
                                          
                                       
                                       +
                                       
                                          
                                             z
                                          
                                          
                                             ijsu
                                          
                                       
                                       ⩽
                                       1
                                       ,
                                    
                                 
                              which is equivalent to
                                 
                                    (21)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                h
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             ihsu
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                h
                                                ∈
                                                T
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             hjsu
                                          
                                       
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             ijsu
                                          
                                       
                                       ⩽
                                       1
                                       .
                                    
                                 
                              
                           

Because of (18), we can substitute 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          isu
                                       
                                    
                                 
                               for 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          h
                                          ∈
                                          T
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          ihsu
                                       
                                    
                                 
                               in (21). Similarly, (17) allows us to substitute 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          j
                                          (
                                          s
                                          +
                                          1
                                          )
                                          u
                                       
                                    
                                 
                               for 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          h
                                          ∈
                                          T
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          hjsu
                                       
                                    
                                 
                               in (21), turning it into (7).□

We are now ready to show that 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                           
                         is stronger than 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        .
                           Proposition 2
                           
                              The lower bound provided by 
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          2
                                       
                                       
                                          R
                                       
                                    
                                 
                               
                              is greater than or equal to the lower bound provided by 
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                       
                                          R
                                       
                                    
                                 
                              
                              . Moreover, the former bound can be strictly greater than the latter.
                           

From the proof of Proposition 1, it is clear that the lower bound provided by 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          2
                                       
                                       
                                          R
                                       
                                    
                                 
                               cannot be worse than the lower bound provided by 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                       
                                          R
                                       
                                    
                                 
                              . Therefore, it suffices to show an example in which the former bound is strictly greater than the latter. Consider a TUP instance with four teams (represented by a table of games in each round) as shown in Fig. 1
                              . The first team in each pair (game) is the home team. Suppose that teams 1, 2, and 3 have their venues close to each other (say, 1 mile away), and the venue of team 4 is further away from the others (say, 10 miles away). In this scenario, an optimal solution to 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                       
                                          R
                                       
                                    
                                 
                               with 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    0
                                    ,
                                    k
                                    =
                                    1
                                 
                              , and 
                                 
                                    K
                                    =
                                    {
                                    (
                                    1
                                    ,
                                    1
                                    )
                                    ,
                                    (
                                    3
                                    ,
                                    2
                                    )
                                    }
                                 
                               corresponds to assigning value 1 to variables 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          111
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          312
                                       
                                    
                                 
                              , value 0 to variables 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          311
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          112
                                       
                                    
                                 
                              , value 0.5 to all other 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          isu
                                       
                                    
                                 
                               variables where 
                                 
                                    i
                                    ∈
                                    T
                                    ,
                                    s
                                    ∈
                                    S
                                    ,
                                    u
                                    ∈
                                    U
                                 
                              , and 
                                 
                                    OPP
                                    [
                                    i
                                    ,
                                    s
                                    ]
                                    >
                                    0
                                 
                              , value 0.5 to variables z of umpire 1 associated with the trips given by the simple solid and dashed lines in Fig. 1, and value 0.5 to variables z of umpire 2 associated with the trips given by the simple and double solid lines in Fig. 1. All remaining variables are equal to zero. The optimal value is 25, which is a very weak lower bound because the value of an optimal integer solution to this instance is 55.

Now, observe that (17) is not satisfied by the previous solution because variables 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          441
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          442
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          461
                                       
                                    
                                 
                              , and 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          462
                                       
                                    
                                 
                               have value 0.5 and all the z variables arriving to or leaving from the venue of team 4 in rounds 4 and 6 have value 0. Hence, this fractional solution becomes infeasible once (17) is added to 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                       
                                          R
                                       
                                    
                                 
                              . In fact, the new optimal solution found after the inclusion of (16) and (17) has value 52, which is much closer to the integer optimum.□

It is possible to strengthen 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                                 
                                    R
                                 
                              
                           
                         further by fixing the following variables:
                           
                              (22)
                              
                                 
                                    
                                       z
                                    
                                    
                                       iisu
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ∈
                                 T
                                 ,
                                 u
                                 ∈
                                 U
                                 ,
                                 s
                                 ∈
                                 S
                                 :
                                 s
                                 <
                                 |
                                 S
                                 |
                                 ,
                                 
                                 if
                                 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 n
                                 -
                                 1
                                 ,
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       z
                                    
                                    
                                       ijsu
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 
                                    
                                       
                                          ∀
                                          
                                          i
                                          
                                          ≠
                                          
                                          j
                                          ∈
                                          T
                                          ,
                                          u
                                          ∈
                                          U
                                          ,
                                          s
                                          ∈
                                          S
                                          :
                                          s
                                          <
                                          |
                                          S
                                          |
                                          ,
                                          
                                          if
                                          
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          <
                                          ⌊
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                          ⌋
                                          -
                                          1
                                          
                                          and
                                       
                                    
                                    
                                       
                                          either
                                          
                                          OPP
                                          [
                                          s
                                          ,
                                          i
                                          ]
                                          =
                                          OPP
                                          [
                                          s
                                          +
                                          1
                                          ,
                                          j
                                          ]
                                          
                                          or
                                          
                                          OPP
                                          [
                                          s
                                          ,
                                          i
                                          ]
                                          =
                                          j
                                          
                                          or
                                       
                                    
                                    
                                       
                                          OPP
                                          [
                                          s
                                          +
                                          1
                                          ,
                                          j
                                          ]
                                          =
                                          i
                                          .
                                       
                                    
                                 
                              
                           
                        Note that (22) and (23) are valid because they forbid the assignment of positive values to z variables that would violate TUP constraints (iii) and (iv) (no umpire can stay at a venue, or follow a team) when 
                           
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                           
                         are strictly less than their maximum values. Let 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                                 
                                    R
                                 
                              
                           
                         be, respectively, the formulations obtained from 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                                 
                                    R
                                 
                              
                           
                         after the inclusion of (22) and (23). In the example of Fig. 1, the optimal solution obtained by 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    R
                                 
                              
                           
                         (see proof of Proposition 2) violates (22) multiple times. For example, it sets 
                           
                              
                                 
                                    z
                                 
                                 
                                    2221
                                 
                              
                              =
                              
                                 
                                    z
                                 
                                 
                                    2222
                                 
                              
                              =
                              
                                 
                                    z
                                 
                                 
                                    2231
                                 
                              
                              =
                              
                                 
                                    z
                                 
                                 
                                    2232
                                 
                              
                              =
                              
                                 
                                    z
                                 
                                 
                                    3351
                                 
                              
                              =
                              
                                 
                                    z
                                 
                                 
                                    3352
                                 
                              
                              =
                              0.5
                           
                        . Solving 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                                 
                                    R
                                 
                              
                           
                         for that example yields an integer (optimal) solution of value 55. Recall that the lower bounds produced by 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    R
                                 
                              
                           
                         and 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                                 
                                    R
                                 
                              
                           
                         for that example are 25 and 52, respectively.

A relax-and-fix heuristic iteratively solves relaxations of an IP model and progressively fixes variables until a feasible solution is found (Wolsey, 1998, Section 12.5). Our relax-and-fix heuristic is based on 
                        
                           
                              
                                 F
                              
                              
                                 2
                                 +
                              
                           
                        
                     . It receives as input a TUP instance and an integer 
                        
                           1
                           ⩽
                           b
                           ⩽
                           4
                           n
                           -
                           3
                        
                     . The parameter b defines the size of a window of consecutive rounds whose variables will be binary in the relaxed model solved at each iteration of the algorithm. Starting with formulation 
                        
                           
                              
                                 F
                              
                              
                                 2
                                 +
                              
                           
                        
                      with the symmetry breaking round 
                        
                           k
                           =
                           1
                        
                     , we modify it so that only the variables in the first b rounds are binary. This relaxed model is solved and, if it is infeasible, the algorithm stops. Otherwise, the variables in the first round are fixed to their values in the best solution found within some stopping criteria. In the next iteration, variables in round 
                        
                           b
                           +
                           1
                        
                      are also made binary and the resulting model is solved. As before, we stop in case of infeasibility, and fix the variables in the second round to their best values otherwise. These steps are repeated until either all variables are fixed, or the model becomes infeasible. The pseudocode in Fig. 2
                      includes more specific details, which we discuss next.

At iteration t, the heuristic solves a relaxed 
                        
                           
                              
                                 F
                              
                              
                                 2
                                 +
                              
                           
                        
                      model in which the z variables in rounds 
                        
                           s
                           ⩽
                           t
                           -
                           1
                           ,
                           t
                           ⩽
                           s
                           <
                           t
                           +
                           b
                        
                     , and 
                        
                           s
                           ⩾
                           t
                           +
                           b
                        
                      are fixed, binary, and continuous, respectively. If this model is feasible, the variables in round t are fixed to their values in the best solution found after exploring no more than a given number of search nodes (see Section 5.3 for details). Because intermediate solutions found in line 8 of the pseudocode are not necessarily optimal for the last model solved, the heuristic may continue to execute until iteration 
                        
                           t
                           =
                           4
                           n
                           -
                           3
                        
                     , when all variables in the model are fixed.

To keep running times under control, we use two different strategies to solve the relaxations of 
                        
                           
                              
                                 F
                              
                              
                                 2
                                 +
                              
                           
                        
                      in each iteration of the relax-and-fix heuristic. For instances with at most 18 teams, we solve the models with all variables and constraints, as described above. For instances with more than 18 teams, in each iteration t of the heuristic we solve a relaxation of 
                        
                           
                              
                                 F
                              
                              
                                 2
                                 +
                              
                           
                        
                      that only includes the variables and constraints relative to rounds no greater than 
                        
                           min
                           (
                           
                              
                                 
                                    
                                       
                                          2
                                       
                                       
                                          5
                                       
                                    
                                    (
                                    4
                                    n
                                    -
                                    2
                                    )
                                 
                              
                           
                           +
                           t
                           -
                           1
                           ,
                           4
                           n
                           -
                           2
                           )
                        
                     . (Recall that, in iteration t, all variables relative to the 
                        
                           t
                           -
                           1
                        
                      first rounds are fixed.) This is equivalent to redefining the set S at each iteration to be 
                        
                           S
                           =
                           {
                           1
                           ,
                           …
                           ,
                           min
                           (
                           
                              
                                 
                                    
                                       
                                          2
                                       
                                       
                                          5
                                       
                                    
                                    (
                                    4
                                    n
                                    -
                                    2
                                    )
                                 
                              
                           
                           +
                           t
                           -
                           1
                           ,
                           4
                           n
                           -
                           2
                           )
                           }
                        
                     . The value 
                        
                           
                              
                                 
                                    
                                       
                                          2
                                       
                                       
                                          5
                                       
                                    
                                    (
                                    4
                                    n
                                    -
                                    2
                                    )
                                 
                              
                           
                        
                      was chosen experimentally with the goal of accelerating the heuristic, while still allowing the model to look at enough rounds ahead of round t to be able to find good solutions. To properly disregard future rounds while solving relaxations of 
                        
                           
                              
                                 F
                              
                              
                                 2
                                 +
                              
                           
                        
                     , it is necessary to deal with (4) in a different way. In early iterations, the number of rounds considered by the relaxed 
                        
                           
                              
                                 F
                              
                              
                                 2
                                 +
                              
                           
                        
                      models is insufficient to satisfy the constraint. If we disregard (4) entirely for many iterations, however, the variables that get fixed may make it impossible to satisfy (4) later on. Therefore, we introduce (4) gradually as follows. We disregard it during iterations 
                        
                           t
                           ≤
                           n
                        
                     . In iterations 
                        
                           n
                           +
                           1
                           ,
                           n
                           +
                           2
                           ,
                           …
                           ,
                           2
                           n
                           -
                           1
                        
                      we enforce (4) only for umpires whose indices are less than or equal to 
                        
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                           -
                           1
                        
                     , respectively, and in iterations 
                        
                           t
                           >
                           2
                           n
                           -
                           1
                        
                      we enforce (4) for all umpires.

Notice that our heuristic begins with a fixed assignment of umpires for the first round (
                        
                           k
                           =
                           1
                        
                     ) and, at each iteration t, determines the umpire trips between rounds t and 
                        
                           t
                           +
                           1
                        
                     . This resembles the GMH of Trick et al. (2012). The difference stems from the fact that our relax-and-fix heuristic schedules the umpires in each round while taking into account, in a relaxed way, the subsequent rounds of the tournament. In addition, we deal with the trip distances directly, rather than using a modified cost function to schedule each round. Finally, because our method is not guaranteed to find a solution every time, we could use a backtracking scheme similar to what is done with the GMH. In practice, however, we almost always find solutions to the instances that are known to be feasible. Therefore, to keep our implementation simple, we decided not to use a backtracking step.

In this section, we experimentally evaluate the IP models and the relax-and-fix heuristic presented earlier. We consider instances from the TUP benchmark (Trick, 2013) ranging from 4 to 32 teams. Instance names start with the number of teams, optionally followed by a letter indicating that the distance matrix is different, but the underlying tournament is not. Experiments were performed on a machine running Linux Ubuntu 12.04.1 and equipped with an i7-2600, 3.40GHz processor, and 8GB of RAM. Our code is written in C++, and we use ILOG CPLEX’s callable library version 12.5.0.1 to solve linear programming and integer programming models.

Before solving the IP models, we analyze the strength of our lower bounds. We focus first on hard instances (
                           
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                           
                        ), and fix the symmetry breaking round 
                           
                              k
                              =
                              1
                           
                        . Table 2
                         shows the lower bounds obtained by solving the linear relaxations of the original IP model (
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    R
                                 
                              
                           
                        ) and of our stronger formulations (
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                                 
                                    R
                                 
                              
                           
                        ) and (
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                                 
                                    R
                                 
                              
                           
                        ). We also include the solution time and the optimal distances for instances with known optimal solutions. Note that, except for the smallest instance (4 teams), 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                                 
                                    R
                                 
                              
                           
                         and 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                                 
                                    R
                                 
                              
                           
                         always provide better lower bounds than 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    R
                                 
                              
                           
                        . In particular, 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                                 
                                    R
                                 
                              
                           
                         provides significantly better bounds (up to 340% better) that are reasonably close to the known optimal solutions, which attests the importance of (22) and (23). In addition, 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                                 
                                    R
                                 
                              
                           
                         and 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                                 
                                    R
                                 
                              
                           
                         solve between 2 and 8 times faster than 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    R
                                 
                              
                           
                         because they are more compact (fewer variables and constraints), with 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                                 
                                    R
                                 
                              
                           
                         having a slight advantage over 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                                 
                                    R
                                 
                              
                           
                        .

Our experiments show that the choice of the symmetry breaking round k can significantly affect the value of the lower bound provided by the linear relaxations. However, it is difficult to determine a priori what value of k leads to the best results for the integer models. Therefore, we solve the IP models with three different values of 
                           
                              k
                              :
                              1
                           
                         (first round), 
                           
                              2
                              n
                              -
                              1
                           
                         (middle round), and the value 
                           
                              
                                 
                                    k
                                 
                                 
                                    ∗
                                 
                              
                           
                         that produces the best lower bound. The models adjusted with each chosen value of k are denoted as before but followed by the suffixes “-F” (first-round k), “-M” (middle-round k) and “-BB” (best-bound k), respectively.

We now switch from root-node lower bounds to solving the IP models, while still focusing on hard instances. We limit execution times to 3hours and limit the number of CPU threads to one. Table 3
                         shows the optimal distances and execution times for hard instances with 12 or fewer teams. In general, 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                         exhibits better performance than 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        . For a given formulation, breaking symmetry in the middle round often speeds up the optimization, whereas breaking symmetry in the first round tends be a bad idea. Therefore, we disregard 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        -F and 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                        -F in subsequent experiments.


                        Table 4
                         summarizes the results for hard instances with at least 14 teams, which have no known optimal solutions. Calculating 
                           
                              
                                 
                                    k
                                 
                                 
                                    ∗
                                 
                              
                           
                         for 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        -BB on instances with at least 26 teams, and for 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                        -BB on instance 32 takes longer than 3hours. In these cases, we report the best lower bound found within 3hours, which is marked with an “∗”, and do not execute CPLEX’s branch-and-cut. The lower bounds in Table 4 contain unexpected results for 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        . Although 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                                 
                                    R
                                 
                              
                           
                         does not perform well in Table 2, it appears that the root-node presolve and strengthening routines of CPLEX are able to improve it, enabling 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                         to achieve competitive lower bounds in 3hours. For example, the best lower bounds for instances with 16 and 18 teams are given by 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        -BB. On the other hand, this model yields very poor lower bounds for instances with more than 24 teams within the time limit. The 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                         models achieve the best lower bounds on instances with 14 teams, or with more than 18 teams, with the latter being significantly better than those provided by the 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                         models. Overall, 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                        -BB obtains 8 out of the 16 best lower bounds, and gets reasonably close in the remaining cases, except for instance 30. The best lower bounds shown in Table 4 are better than the best known bounds reported in the TUP benchmark, for all instance sizes. In particular, the benchmark reports no lower bounds for instances with more than 16 teams.

When it comes to quality of feasible solutions, no formulation finds solutions to hard instances with more than 14 teams (no such solutions are known, to the best of our knowledge). Formulation 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                        -M finds three out of the four best 14-team solutions, all of which are better than the best known solutions found by exact methods reported in Trick and Yildiz (2012).


                        Table 5
                         summarizes the performance of our IP models on relaxed instances (
                           
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              >
                              0
                           
                        ) with at least 14 teams. Because calculating 
                           
                              
                                 
                                    k
                                 
                                 
                                    ∗
                                 
                              
                           
                         for the 30-team instance with 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        -BB takes too long, we report the best lower bound found within 3hours and mark it with an “∗”. Except for the first two 14-team instances, the lower bounds provided by 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                         models are always better than those provided by 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                         models. The 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                        -BB model is responsible for 14 out of the 21 best lower bounds, and its solution is reasonably close to the best bound in the remaining cases. Formulation 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                        -M does well with 14-team instances, finding 4 out of the 8 best lower bounds, and it also finds the best bound for the 30-team instance. When it comes to feasible solutions, 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                        -M manages to find 8 out of the 21 best solutions.

The best lower bounds shown in Table 5 are better than the best known bounds reported in the TUP benchmark, for all instance sizes. In addition, 18 out of the 20 best solutions shown in Table 5 are better than the best solutions found by exact methods reported in Trick and Yildiz (2012). More importantly, 11 of these solutions (underlined numbers) are better than the best known solution found by any method, according to the TUP benchmark. In Section 5.3, we show that our heuristic can do even better than that.

We use CPLEX to solve the optimization models inside the relax-and-fix heuristic (see Table A.9 in A for the parameter settings we used). We apply the relax-and-fix heuristic with 
                           
                              b
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              10
                           
                         to the instances used in our previous experiments. The heuristic finds an optimal solution to all but one of the hard instances with at most 10 teams. (The best solution obtained by the heuristic for instance 10C is 43,193, which is close to the optimal distance of 43,149.) The total time spent to obtain these solutions for all values of b is at most 1second for instances with 4 and 6 teams, at most 10seconds for instances with 8 teams, at most 2minutes for instances 10, 10A, and 10B, and around 3minutes for instance 10C. Tables 6 and 7
                        
                         present, respectively, the solution values and execution times for hard and relaxed instances with at least 14 teams. Unfortunately, similarly to previous attempts reported in the literature, the relax-and-fix heuristic does not manage to find feasible solutions to hard instances with more than 14 teams. For the instances to which it manages to find a feasible solution, the heuristic appears to be reliable, obtaining solutions in 240 out of 250 runs (25 instances, 10 values of b). Most of the best solutions (14 out of 25) are found with 
                           
                              b
                              =
                              4
                              ,
                              6
                           
                        , or 7. Finally, we also include in Table 7 the total cumulative time to find the solutions for 
                           
                              b
                              ∈
                              {
                              4
                              ,
                              6
                              ,
                              7
                              }
                           
                         (column “4,6,7”) and for 
                           
                              b
                              ∈
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              10
                              }
                           
                         (column “1–10”).

We now compare the best results obtained by our approaches (exact and heuristic) with the best results from the literature, which are published in Trick and Yildiz (2011); Trick and Yildiz (2012); Trick et al. (2012); and Trick (2013). The most relevant comparison for hard instances with no more than 10 teams are the times required to reach optimality. Table 3 indicates that our strengthened formulation 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                         does better than 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                         on these small instances, and that a good choice of k (e.g. middle-round) pays off.

The main improvements we achieve are on instances with at least 14 teams, which have no known optimal solutions. Table 8
                         summarizes the best results for these instances (an “∗” indicates that the time limit was exceeded; see Table 7). The best lower bounds and solutions from the literature were obtained within 3hours of computation for instances with 14 and 16 teams, and within 5hours for the relaxed 30-team instance (solution only; no lower bound is reported). The lower bounds provided by 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                                 
                                    R
                                 
                              
                           
                        -BB are already better than the best ones in the literature on 25 out of 29 instances. They can be calculated in less than 1minute for instances with at most 16 teams, and in approximately 2hours for the instance with 30 teams. Within 3hours of computation, the best lower bounds found during branch-and-cut with 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                        -BB beat all known lower bounds by margins ranging between 8 and 24 thousand miles. The “
                           
                              F
                           
                         Best” column under “Lower bounds” shows the best bounds we managed to find over the entire range of models we considered. These bounds are better than the 
                           
                              
                                 
                                    F
                                 
                                 
                                    2
                                    +
                                 
                              
                           
                        -BB bounds on 13 out of 29 instances.

On the right half of Table 8 we compare the quality of the best known solutions in the literature with those obtained by our IP models and by the relax-and-fix heuristic. All of our best solutions are obtained by some configuration of the relax-and-fix heuristic (column “RF Best”). The only instance whose solution we do not manage to improve is 14C-7-3 (by a mere 57 miles). For the remaining 24 instances with known feasible solutions, our best solutions are between 0.36 and 27.6 thousand miles shorter. When compared with the best solutions obtained by the IP models (column “
                           
                              F
                           
                         Best”), the best relax-and-fix solutions are between 1.68 and 28.6 thousand miles shorter. However, except for instances with 14 teams, this comparison is unfair because finding the best relax-and-fix solution over all values of 
                           
                              b
                              ∈
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              10
                              }
                           
                         takes much more time than the limits of 3 and 5hours (see Table 7). Therefore, we include column “RF 4,6,7” which has the best solution obtained over three runs of relax-and-fix with 
                           
                              b
                              =
                              4
                              ,
                              6
                           
                        , and 7. These three runs obtain most of our best results (14 out of 25) and, in total, stay within the time limits with two exceptions: instance 16B-7-3 (3-hour limit exceeded by 5minutes), and instance 30. When compared to the best known solutions in the literature, solutions under “RF 4,6,7” have less mileage in 22 out of 25 cases. The worst solutions obtained by the relax-and-fix heuristic (column “RF Worst”) are better than the best known solutions in 18 out of 25 cases. Finally, for the relaxed instance with 30 teams, 4 out of the 6 solutions found by the relax-and-fix heuristic are better than the best one in the literature, with the greatest improvement being equal to 16,459 miles.

@&#CONCLUSIONS AND FUTURE WORK@&#

By strengthening an existing IP formulation for the traveling umpire problem (TUP), we obtain an optimization model that not only solves more quickly than its original version, but also provides better lower and upper bounds for instances in the TUP benchmark. This new formulation plays a crucial role in our implementation of a relax-and-fix heuristic for the problem, because each iteration of the heuristic cannot dedicate too much time to solving its intermediate IP models. As a result, we improve all known lower bounds for instances in the benchmark, as well as 24 of the 25 best known upper bounds. Moreover, we are the first to provide strong lower bounds for instances with more than 16 teams.

The TUP remains a very difficult problem, with many small instances lacking feasible solutions. We believe that a combination of exact and heuristic methods is a promising research direction. The TUP formulations deserve a deeper polyhedral study, and our relax-and-fix heuristic can be modified in several ways. For example, the sliding windows of binary variables can take different shapes, focus first on problematic areas of the schedule (a bottleneck approach), and/or use randomization. Finally, not much attention has been given to improving the CP model of Trick and Yildiz (2011), and a more effective version of that model (e.g. with fancier search routines) could become part of a relax-and-fix heuristic as well.

We hope that the improvements in solution quality presented in this paper will spark the interest of other researchers in tackling this challenging problem.

See Table A.9
                     .

@&#REFERENCES@&#

