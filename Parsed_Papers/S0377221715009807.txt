@&#MAIN-TITLE@&#Constant approximation algorithms for the one warehouse multiple retailers problem with backlog or lost-sales

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We consider the OWMR problem with deterministic time-varying demand.


                        
                        
                           
                           We propose a combinatorial algorithm based on a decomposition into single-echelon problems.


                        
                        
                           
                           With backlog, the algorithm has a performance guarantee of 3.


                        
                        
                           
                           This guarantee is improved to 2 in the JRP special case.


                        
                        
                           
                           With lost sales, a similar technique leads to a 2-approximation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Approximation algorithms

Lot-sizing

Inventory control

Distribution systems

@&#ABSTRACT@&#


               
               
                  We consider the One Warehouse Multi-Retailer (OWMR) problem with deterministic time-varying demand in the case where shortages are allowed. Demand may be either backlogged or lost. We present a simple combinatorial algorithm to build an approximate solution from a decomposition of the system into single-echelon subproblems. We establish that the algorithm has a performance guarantee of 3 for the OWMR with backlog under mild assumptions on the cost structure. In addition, we improve this guarantee to 2 in the special case of the Joint-Replenishment Problem (JRP) with backlog. As a by-product of our approach, we show that our decomposition provides a new lower bound of the optimal cost. A similar technique also leads to a 2-approximation for the OWMR problem with lost-sales. In all cases, the complexity of the algorithm is linear in the number of retailers and quadratic in the number of time periods, which makes it a valuable tool for practical applications. To the best of our knowledge, these are the first constant approximations for the OWMR with shortages.
               
            

@&#INTRODUCTION@&#

We consider two multi-echelon inventory control problems: The One Warehouse Multi-Retailer (OWMR) problem and its special case the Joint Replenishment Problem (JRP). Both problems share the same divergent network structure: A single warehouse replenishes N retailers facing customers demands, by ordering material from an external suppliers. Demands are fulfilled by units that are first ordered at the warehouse, then at the retailers. In particular, the ’divergent structure of the system requires that the retailers can only order material that is available (i.e. physically held) at the warehouse. The JRP is a special case of this problem in which the warehouse cannot hold any unit. In this work, we focus on a discrete and deterministic setting by assuming that the demands are known over a finite planning horizon of T periods. Costs are incurred when a location places an order to replenish its stock (ordering costs), when units are physically held in the system (holding costs) or when demand is not immediately satisfied (penalty costs). The goal is then to determine an ordering strategy in order to minimize the total cost incurred to fulfill the demands by moving the products through the network.

Most of the existing work on this problem focuses on the case where all demands must be satisfied on time. Even in this simpler setting the OWMR problem and the JRP are both known to be NP-hard (Arkin, Joneja, & Roundy, 1989). Those problems have attracted a lot of attention in the past and many heuristics have been developed. In particular (Levi, Roundy, Shmoys, & Sviridenko, 2008), (Stauffer, Massonnet, Rapine, & Gayon, 2011) and (Bienkowski et al., 2014) introduced constant factor approximation algorithms for the former problem (1.8, 2, 1.791, respectively). We refer to these papers for a detailed review of the corresponding literature. (Nonner & Souza, 2009) have also proposed a 5/3-approximation algorithm for the JRP problem, for the special case where each demand has a strict deadline.

In this paper, we focus on extensions of these standard models in which shortages (either backlog or lost sales) are allowed. Such models have been extensively studied in the lot-sizing literature when a single location faces customers demands over a discrete, finite planning horizon. (Zangwill, 1966) was among the first to extend the pioneering work of (Wagner & Whitin, 1958) to incorporate the possibility to backlog units. Later, (Federgruen & Tzur, 1993) and (Aggarwal & Park, 1993) used more advanced dynamic programming techniques to solve the problem and improved the time complexity. An interesting extension of the lot-sizing problem is the multi-item version, which considers that several items are distributed, each incurring its own holding and backlogging costs. Several papers (see (Pochet & Wosley, 1988; 1994) and (Küçükyavuz & Pochet, 2009)) have focused on the integer programming formulation of this problem in the case of single or multiple items. The special case of the JRP is a generalization of the multi-item problem in which additional ordering costs are incurred whenever a specific item replenishes its own stock. (Levi, Roundy, & Shmoys, 2006) developed an algorithm based on primal-dual approach for this problem with backlogging and proved its cost is at most twice the optimal cost in the worst case.

The literature on lost sales models is more recent: (Sandbothe & Thompson, 1990) were the first to propose a forward algorithm to solve a lot-sizing problem with production capacity constraints and stockouts. Later, (Aksen, Altinkemer, & Chand, 2003) introduced a dynamic programming approach to solve efficiently the uncapacitated version with time-varying costs. (Liu, Chu, Chu, & Wang, 2007) considered a model where inventory is bounded, present an optimal dynamic program for this model and test it on industrial problem successfully. Other papers deal with the multi-item versions of the basic lot-sizing problem. In particular, (Absi & Kedad-Sidhoum, 2008) extends the original work of (Sandbothe & Thompson, 1990) to a multi-item version and use a MIP approach to develop an effective method to find near optimal solutions.

This work extends the decomposition technique of  (Stauffer et al., 2011) to more general models allowing backorders or lost-sales and derive a constant approximation algorithm in each case. We present a new lower bound for each problem, based on a decomposition into simple single-echelon systems. We then recompose the optimal solutions to the subproblems into a feasible solution to the original problem. In the case of the OWMR problem with backlogging, we prove that the cost of the solution obtained is guaranteed to be at most three times the optimal cost under mild assumptions on the cost structure. In addition in the JRP case, some of these assumptions become irrelevant and we show that our algorithm can be modified to match the best known performance guarantee obtained by (Levi et al., 2006) when backorders are allowed. Finally, we adapt our technique to the OWMR problem with lost-sales and build a 2-approximation for this problem. To the best of our knowledge, this paper presents the first constant approximation algorithms for the backlogging and the lost-sales version of the OWMR problem. The complexity of our algorithms is linear with the number of time periods and quadratic with the number of retailers.

The remainder of this paper is organized as follows. In Section 2, we formally introduce the assumptions and notations used throughout the following sections. In Section 3, we present the split and uncross technique and provide a 3-approximation algorithm for the backorder version of the OWMR problem. In Section 4, we show that in our cost structure, the lost-sales model is simply a special case of the backlogging problem. We are then able to improve the performance guarantee of our algorithm to two by simply modifying one step of our algorithm.

In this section, we focus on models where unmet demand is backordered. In this version of the OWMR problem, demands faced by the retailers are not necessarily satisfied on time but can instead be backlogged and served by an order placed later in time. We now discuss the assumptions and notations used throughout the remainder of the paper. In particular, we present a general cost structure that extends the cost structure introduced in (Levi et al., 2008) and (Stauffer et al., 2011).

We consider N retailers that face customers demands over a finite planning horizon, discretized into T periods. For each retailer 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           N
                        
                      and each period 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                           ,
                        
                      let 
                        
                           d
                           t
                           i
                        
                      be the deterministic demand for retailer i in period t, to which we also refer as the demand point (i, t). Each retailer orders units from a central warehouse, which in turn orders from an external supplier. Recall that we assume that the decisions are centralized in order to minimize the total cost incurred by the system. As a consequence, orders placed by the retailers are always filled on time by units coming from the on-hand inventory of the warehouse. If the warehouse orders from its supplier in period t, it incurs a fixed ordering cost 
                        
                           
                              K
                              t
                              0
                           
                           ,
                        
                      regardless of how many units are ordered. Similarly, retailer i pays a fixed ordering cost 
                        
                           K
                           t
                           i
                        
                      for ordering from the warehouse in period t. (Chan, Muriel, Shen, Simchi-Levi, & Teo, 2000) have shown that if the ordering costs at the retailers vary over time, the OWMR problem is as hard to approximate as the set cover problem and thus admits no constant guarantee unless 
                        
                           P
                           =
                           N
                           P
                        
                      (Feige, 1998). Therefore we assume in this paper that the ordering costs at each retailer i > 0 are stationary, i.e. 
                        
                           
                              K
                              t
                              i
                           
                           =
                           
                              K
                              i
                           
                        
                      for all periods 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     . The leadtimes are deterministic, thus we assume without loss of generality that the orders are delivered instantaneously from one location to another.

The most common assumption in the inventory literature is to consider that holding and backlogging units induce linear costs that are proportional to the inventory level in each location. However, it is worth noticing that the algorithms developed in the following sections only need to satisfy weaker properties to yield a constant performance guarantee for the OWMR problem with backorders. For clarity reasons, we start by introducing the assumptions on the cost structure in the linear case first. We then relate this basic parameters to the so-called metric carrying cost structure and generalize the assumptions to this more complex setting.

In the traditional linear cost structure, each unit physically held in location i in period t incurs a holding cost 
                           
                              
                                 h
                                 t
                                 i
                              
                              ≥
                              0
                              ,
                           
                         while each backlogged unit for a specific retailer i ≥ 1 induces a penalty cost of 
                           
                              
                                 b
                                 t
                                 i
                              
                              ≥
                              0
                           
                        . Note that we consider that the penalty cost for backlogging a demand is entirely incurred at the retailer, where demands have to be served eventually. In other words, we restrict ourselves to policies in which the warehouse cannot backlog the orders of the retailers, i.e. retailers can only order units that are available at the warehouse. Another common assumption for the OWMR problem is that the set of retailers can be partitioned into two subsets IJ
                         and IW
                         such that:

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             I
                                             J
                                          
                                       
                                       
                                          
                                             =
                                             
                                                {
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                N
                                                :
                                                
                                                   h
                                                   t
                                                   i
                                                
                                                ≤
                                                
                                                   h
                                                   t
                                                   0
                                                
                                                
                                                for
                                                
                                                all
                                                
                                                t
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             I
                                             W
                                          
                                       
                                       
                                          
                                             =
                                             
                                                {
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                N
                                                :
                                                
                                                   h
                                                   t
                                                   i
                                                
                                                ≥
                                                
                                                   h
                                                   t
                                                   0
                                                
                                                
                                                and
                                                
                                                
                                                   b
                                                   t
                                                   i
                                                
                                                ≥
                                                
                                                   h
                                                   t
                                                   0
                                                
                                                
                                                for
                                                
                                                all
                                                
                                                t
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        In the remainder of this paper, retailers in set IJ
                         are also called J-retailers, while retailers from set IW
                         are called W-retailers. In simple words, it is cheaper to store units at J-retailers than at the warehouse, while it is cheaper to hold units at the warehouse than at W-retailers. Note that in addition we assume that for all i ∈ IW
                         and 
                           
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                              ,
                           
                         it is also cheaper to hold unit at the warehouse rather than backlogging it at retailer i in period t. In other words, the backlogging cost of any W-retailer is greater than the holding cost at the warehouse. This assumption matches many practical situations, since backlogging units is often more expensive than holding them in the stock, which is in turn more expensive than holding them in the central warehouse in the case of W-retailers.

We now introduce a more general cost structure, called carrying cost structure, that encapsulate both holding and backlogging costs in a single notation. These parameters extend the shelf age dependent holding costs introduced in (Levi et al., 2008) and (Stauffer et al., 2011), which generalize the classical level-dependent holding costs usually considered in the literature (see (Federgruen & Wang, 2013) for further discussion on these cost structures). Namely, a unit ordered in period r at the warehouse and in period s ≥ r at retailer i (we denote by ⌈r, s⌋ such a pair of orders) to satisfy a unit of demand 
                           
                              d
                              t
                              i
                           
                         incurs a per-unit carrying cost of 
                           
                              ϕ
                              
                                 r
                                 s
                              
                              
                                 i
                                 t
                              
                           
                        . That is, 
                           
                              ϕ
                              
                                 r
                                 s
                              
                              
                                 i
                                 t
                              
                           
                         encapsulates the cost for holding one unit at the warehouse from r to s, then either holding it at retailer i from period s to t (if s ≤ t) to serve demand in period t, or backlogging one unit of demand (i, t) from period t to s (if s > t). Note that this cost structure can capture additional phenomena than the traditional linear holding/backlogging costs. For instance, it allows us to consider situations in which the holding cost incurred for a specific item at the central warehouse depends on which retailers it replenishes. It can also capture additional phenomena such as perishability, with a prohibitive holding cost if the period of storage in a location is longer than a certain threshold.

Clearly, linear cost parameters are a special case of carrying cost parameters: Indeed, for each demand point (i, t), each ordering period r of the warehouse and each ordering period s ≥ r of retailer i, one can define the total carrying cost incurred to serve demand (i, t) with the pair of orders ⌈r, s⌋ as follows:

                           
                              (3)
                              
                                 
                                    
                                       ϕ
                                       
                                          r
                                          s
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               u
                                                               =
                                                               r
                                                            
                                                            
                                                               s
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            h
                                                            u
                                                            0
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               v
                                                               =
                                                               s
                                                            
                                                            
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            h
                                                            v
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      d
                                                      t
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   s
                                                   ≤
                                                   t
                                                
                                             
                                          
                                          
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               u
                                                               =
                                                               r
                                                            
                                                            
                                                               s
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            h
                                                            u
                                                            0
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               v
                                                               =
                                                               t
                                                            
                                                            
                                                               s
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            b
                                                            v
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      d
                                                      t
                                                      i
                                                   
                                                
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As already mentioned, the carrying cost parameters do not need to satisfy Eq. (3) for us to derive constant approximations for the backlogging model we consider. In fact, we simply assume that parameters 
                           
                              ϕ
                              
                                 r
                                 s
                              
                              
                                 i
                                 t
                              
                           
                         satisfy the following five properties:

                           
                              
                                 (P1) 
                                 Non-negativity. The parameters 
                                    
                                       ϕ
                                       
                                          r
                                          s
                                       
                                       
                                          i
                                          t
                                       
                                    
                                  are nonnegative.


                                 (P2) 
                                 Piecewise monotonicity with respect to s. Every retailer i is in exactly one of the two following situations: Either 
                                    
                                       ϕ
                                       
                                          r
                                          s
                                       
                                       
                                          i
                                          t
                                       
                                    
                                  is non-increasing in s ∈ [r, t] and non-decreasing in s ∈ [t, T] for each demand point (i, t) and warehouse order r, or 
                                    
                                       ϕ
                                       
                                          r
                                          s
                                       
                                       
                                          i
                                          t
                                       
                                    
                                  is non-decreasing in s ∈ [r, T] for each demand point (i, t) and warehouse order r. This property defines a partition of the set of retailers into two subsets: IW
                                  and IJ
                                 , respectively.


                                 (P3) 
                                 Monotonicity with respect to r. For each retailer 
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       N
                                       ,
                                    
                                  each demand point (i, t) and retailer order in period 1 ≤ s ≤ T,  
                                    
                                       ϕ
                                       
                                          r
                                          s
                                       
                                       
                                          i
                                          t
                                       
                                    
                                  is non-increasing in r ∈ [1, s]. Moreover if i ∈ IJ
                                 , we have: 
                                    
                                       
                                          ϕ
                                          
                                             r
                                             r
                                          
                                          
                                             i
                                             t
                                          
                                       
                                       ≥
                                       
                                          ϕ
                                          
                                             
                                                r
                                                ′
                                             
                                             
                                                r
                                                ′
                                             
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                  for r ≤ r′ ≤ t and 
                                    
                                       
                                          ϕ
                                          
                                             r
                                             r
                                          
                                          
                                             i
                                             t
                                          
                                       
                                       ≤
                                       
                                          ϕ
                                          
                                             
                                                r
                                                ′
                                             
                                             
                                                r
                                                ′
                                             
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                  for t ≤ r ≤ r′.


                                 (P4) 
                                 Triangle inequality. For each demand point (i, t) with i ∈ IW
                                 , we have

                                    
                                       
                                          
                                             
                                                ϕ
                                                
                                                   r
                                                   s
                                                
                                                
                                                   i
                                                   t
                                                
                                             
                                             ≤
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ϕ
                                                               
                                                                  r
                                                                  t
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            +
                                                            
                                                               ϕ
                                                               
                                                                  s
                                                                  s
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            r
                                                            ≤
                                                            s
                                                            ≤
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ϕ
                                                               
                                                                  r
                                                                  t
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            +
                                                            
                                                               ϕ
                                                               
                                                                  t
                                                                  s
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            r
                                                            ≤
                                                            t
                                                            <
                                                            s
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ϕ
                                                               
                                                                  r
                                                                  r
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            +
                                                            
                                                               ϕ
                                                               
                                                                  t
                                                                  s
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         otherwise
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              


                                 (P5) 
                                 Backlogging cost bounding. If i ∈ IW
                                 , for each demand point (i, t) and retailer i order in period s > t, we have 
                                    
                                       
                                          ϕ
                                          
                                             t
                                             s
                                          
                                          
                                             i
                                             t
                                          
                                       
                                       ≤
                                       2
                                       
                                          ϕ
                                          
                                             s
                                             s
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                 
                              

In the remainder of the paper, we refer to the metric carrying cost structure when the parameters satisfy the five properties introduced above. It is straightforward to check that properties (P1), (P3) and (P4) capture the linear per-unit holding/penalty cost structure. Moreover if the set of retailers is partitioned into two subsets IW
                         and IJ
                         as defined by (1) and (2), properties (P2) and (P5) are also satisfied and therefore the linear holding/penalty cost structure is a particular case of the metric carrying cost structure. Notice that property (P5) generalizes the inequality 
                           
                              
                                 b
                                 t
                                 i
                              
                              ≥
                              
                                 h
                                 t
                                 0
                              
                           
                         for all t and i ∈ IW
                         to the case of carrying cost parameters. As already discussed, these assumptions cover many other practical cases.

In the remainder of this paper, we call a solution π to our problem a policy. Any policy π for the problem is represented by a (
                           
                              N
                              +
                              1
                           
                        )-uplet 
                           
                              π
                              =
                              (
                              
                                 π
                                 0
                              
                              ,
                              
                                 π
                                 1
                              
                              ,
                              ⋯
                              ,
                              
                                 π
                                 N
                              
                              )
                           
                         where each πi
                         is the set of pairs (ordering period, quantity) for location i. A policy π is feasible for the OWMR problem if the two following conditions are satisfied:

                           
                              
                                 Condition 1. For all 
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       N
                                    
                                  policy πi
                                  orders at least the sum of the demands 
                                    
                                       d
                                       t
                                       i
                                    
                                  over the entire planning horizon.


                                 Condition 2. Let r and r′ be two consecutive ordering periods of the warehouse. Then the quantities ordered by π
                                 0 in period r are sufficient to serve the orders placed by all the retailers in periods 
                                    
                                       r
                                       ,
                                       …
                                       ,
                                       
                                          r
                                          ′
                                       
                                       −
                                       1
                                    
                                 .

Given a policy π for the entire system, we denote 
                           
                              C
                              (
                              π
                              )
                           
                         the total cost incurred by π over the planning horizon. This cost can be split into two parts: The total ordering cost denoted 
                           
                              K
                              (
                              π
                              )
                           
                         and the total carrying (i.e. holding/backlogging) cost denoted Ψ(π) and thus we have:

                           
                              
                                 
                                    C
                                    (
                                    π
                                    )
                                    =
                                    K
                                    (
                                    π
                                    )
                                    +
                                    Ψ
                                    (
                                    π
                                    )
                                 
                              
                           
                        
                     

We conclude this section by pointing out three dominant properties on any feasible policy for the problem with the metric carrying cost structure. First, it is easy to prove that there exists an optimal policy 
                           
                              
                                 π
                                 
                                    O
                                    P
                                    T
                                 
                              
                              =
                              
                                 (
                                 
                                    π
                                    0
                                    
                                       O
                                       P
                                       T
                                    
                                 
                                 ,
                                 
                                    π
                                    1
                                    
                                       O
                                       P
                                       T
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    π
                                    N
                                    
                                       O
                                       P
                                       T
                                    
                                 
                                 )
                              
                           
                         such that for all 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              N
                              ,
                           
                         
                           
                              π
                              i
                              
                                 O
                                 P
                                 T
                              
                           
                         orders only when its inventory level is nonpositive. In addition, the metric carrying cost structure ensures that there exists an optimal policy in which each demand 
                           
                              d
                              t
                              i
                           
                         is served from a unique pair of orders ⌈r, s⌋, which is a classical dominant property in most of the inventory models. This allows us to incorporate the amount 
                           
                              d
                              t
                              i
                           
                         directly into the cost parameters by setting 
                           
                              
                                 ψ
                                 
                                    i
                                    t
                                 
                                 
                                    r
                                    s
                                 
                              
                              ≡
                              
                                 ϕ
                                 
                                    r
                                    s
                                 
                                 
                                    i
                                    t
                                 
                              
                              
                                 d
                                 t
                                 i
                              
                              ,
                           
                         where 
                           
                              ϕ
                              
                                 r
                                 s
                              
                              
                                 i
                                 t
                              
                           
                         is a per-unit cost satisfying properties (P1)-(P5). Since 
                           
                              
                                 d
                                 t
                                 i
                              
                              ≥
                              0
                           
                         for all i, t, parameters 
                           
                              ψ
                              
                                 r
                                 s
                              
                              
                                 i
                                 t
                              
                           
                         also satisfy properties (P1)-(P5) and correspond to the total carrying cost incurred to serve the entire demand 
                           
                              d
                              t
                              i
                           
                         from the pair of orders ⌈r, s⌋. Therefore in the remainder of the paper we use parameters 
                           
                              ψ
                              
                                 r
                                 s
                              
                              
                                 i
                                 t
                              
                           
                         to prove our approximation results. Finally, it is clear from property (P2) that there exists an optimal policy in which all J-retailers orders are synchronized with a warehouse order. In particular, we shall assume w.l.o.g. that the optimal policies considered in the following sections satisfy this property.

Basically, the algorithm works in two steps: First decompose the original problem into several single-echelon subproblems, then solve each of them and recompose the resulting policies into a feasible policy for the OWMR problem. Each sub-problem is a relaxation of the OWMR problem where we remove the requirement that warehouse and retailer orders are synchronized but both just need to match the demand.

The first step of our algorithm is to decompose a general OWMR problem with backlog into several single-echelon subproblems. In addition, we show that by splitting the carrying cost between the different subproblems, we can derive a new lower bound for the original problem.

                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             S
                                             ^
                                          
                                          0
                                       
                                       )
                                    
                                  The warehouse is regarded as a single-echelon, multi-item system with backlogging facing for each period t a demand 
                                    
                                       d
                                       t
                                       i
                                    
                                  for item 
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       N
                                    
                                 . A fixed ordering cost 
                                    
                                       K
                                       r
                                       0
                                    
                                  is incurred for placing an order in period r. If a demand (i, t) is ordered in period r ≤ t, it incurs a holding cost of 
                                    
                                       
                                          1
                                          3
                                       
                                       
                                          ψ
                                          
                                             r
                                             t
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                  if i ∈ IW
                                  and 
                                    
                                       
                                          1
                                          2
                                       
                                       
                                          ψ
                                          
                                             r
                                             r
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                  if i ∈ IJ
                                 . On the other hand if r > t, it incurs a backlogging cost of 
                                    
                                       
                                          1
                                          3
                                       
                                       
                                          ψ
                                          
                                             r
                                             r
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                  if i ∈ IW
                                  and 
                                    
                                       
                                          1
                                          2
                                       
                                       
                                          ψ
                                          
                                             r
                                             r
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                  if i ∈ IJ
                                 .


                                 
                                    
                                       (
                                       
                                          
                                             S
                                             ^
                                          
                                          i
                                       
                                       )
                                    
                                  Retailer i is considered as a single-echelon system with backlog facing demand 
                                    
                                       d
                                       t
                                       i
                                    
                                  with ordering cost Ki
                                 . The carrying cost incurred to order in period s to serve the demand in period t is equal to 
                                    
                                       
                                          2
                                          3
                                       
                                       
                                          ψ
                                          
                                             s
                                             s
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                  if i ∈ IW
                                  and 
                                    
                                       
                                          1
                                          2
                                       
                                       
                                          ψ
                                          
                                             s
                                             s
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                  if i ∈ IJ
                                 .

Problem 
                           
                              (
                              
                                 
                                    S
                                    ^
                                 
                                 0
                              
                              )
                           
                         and problems 
                           
                              (
                              
                                 
                                    S
                                    ^
                                 
                                 i
                              
                              )
                           
                         are all equivalent to single-echelon lot-sizing problems with backlog. However, note that the first one corresponds to the multi-item version of this problem. These problems have been widely studied in the literature and it is well-known that finding their optimal solution can be reduced to finding a shortest path in a graph 
                           
                              
                                 G
                                 j
                              
                              =
                              
                                 (
                                 
                                    V
                                    j
                                 
                                 ,
                                 
                                    E
                                    j
                                 
                                 )
                              
                           
                         representing problem 
                           
                              (
                              
                                 
                                    S
                                    ^
                                 
                                 j
                              
                              )
                           
                         (see Fig. 1). For all 
                           
                              j
                              =
                              0
                              ,
                              …
                              ,
                              N
                              ,
                           
                         
                           
                              
                                 V
                                 j
                              
                              =
                              
                                 {
                                 0
                                 ,
                                 …
                                 ,
                                 T
                                 +
                                 1
                                 }
                              
                           
                         is the set of periods, where 0 and 
                           
                              T
                              +
                              1
                           
                         are two artificial periods representing the beginning and the end of the planning horizon. Given two consecutive orders u and v and t ∈ [u, v], properties (P2) and (P3) ensure that it is suboptimal to serve demand 
                           
                              d
                              t
                              i
                           
                         with an order placed earlier than u or later than v. As a consequence for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              N
                           
                         an arc (u, v) ∈ Ei
                         represents two consecutive orders in a solution and its length is equal to the minimal possible cost incurred for placing an order in period u and carrying the units necessary to serve demands 
                           
                              
                                 d
                                 u
                                 i
                              
                              ,
                              …
                              ,
                              
                                 d
                                 
                                    v
                                    −
                                    1
                                 
                                 i
                              
                           
                         by ordering them either in period u or in period v. Therefore its length 
                           
                              l
                              
                                 u
                                 ,
                                 v
                              
                              i
                           
                         is equal to:

                           
                              
                                 
                                    
                                       l
                                       
                                          u
                                          ,
                                          v
                                       
                                       i
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            t
                                                            =
                                                            1
                                                         
                                                         
                                                            v
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         2
                                                         3
                                                      
                                                      
                                                         ψ
                                                         
                                                            v
                                                            v
                                                         
                                                         
                                                            i
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   u
                                                   =
                                                   0
                                                   
                                                   and
                                                   
                                                   i
                                                   ∈
                                                   
                                                      I
                                                      W
                                                   
                                                
                                             
                                          
                                          
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            t
                                                            =
                                                            1
                                                         
                                                         
                                                            v
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         1
                                                         2
                                                      
                                                      
                                                         ψ
                                                         
                                                            v
                                                            v
                                                         
                                                         
                                                            i
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   u
                                                   =
                                                   0
                                                   
                                                   and
                                                   
                                                   i
                                                   ∈
                                                   
                                                      I
                                                      J
                                                   
                                                
                                             
                                          
                                          
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                         i
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            t
                                                            =
                                                            u
                                                         
                                                         
                                                            v
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         2
                                                         3
                                                      
                                                      min
                                                      
                                                         {
                                                         
                                                            ψ
                                                            
                                                               u
                                                               u
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                         ,
                                                         
                                                            ψ
                                                            
                                                               v
                                                               v
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                         }
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   u
                                                   >
                                                   0
                                                   
                                                   and
                                                   
                                                   i
                                                   ∈
                                                   
                                                      I
                                                      W
                                                   
                                                
                                             
                                          
                                          
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                         i
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            t
                                                            =
                                                            u
                                                         
                                                         
                                                            v
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         1
                                                         2
                                                      
                                                      min
                                                      
                                                         {
                                                         
                                                            ψ
                                                            
                                                               u
                                                               u
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                         ,
                                                         
                                                            ψ
                                                            
                                                               v
                                                               v
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                         }
                                                      
                                                   
                                                
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The definition of an arc (u, ), u ≤ v, is similar for the warehouse, except that in this case the system has to serve demands of all the items between two consecutive orders in periods u and v. Its length 
                           
                              l
                              
                                 u
                                 ,
                                 v
                              
                              0
                           
                         is then set to:

                           
                              
                                 
                                    
                                       l
                                       
                                          u
                                          ,
                                          v
                                       
                                       0
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            t
                                                            =
                                                            1
                                                         
                                                         
                                                            v
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  I
                                                                  W
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                            3
                                                         
                                                         
                                                            ψ
                                                            
                                                               v
                                                               t
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  I
                                                                  J
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                            2
                                                         
                                                         
                                                            ψ
                                                            
                                                               v
                                                               v
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   u
                                                   =
                                                   0
                                                
                                             
                                          
                                          
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                         u
                                                         0
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            t
                                                            =
                                                            u
                                                         
                                                         
                                                            v
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  I
                                                                  W
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                            3
                                                         
                                                         min
                                                         
                                                            {
                                                            
                                                               ψ
                                                               
                                                                  u
                                                                  t
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            ,
                                                            
                                                               ψ
                                                               
                                                                  v
                                                                  v
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            }
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  I
                                                                  J
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                            2
                                                         
                                                         min
                                                         
                                                            {
                                                            
                                                               ψ
                                                               
                                                                  u
                                                                  u
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            ,
                                                            
                                                               ψ
                                                               
                                                                  v
                                                                  v
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            }
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Note that these lengths are computed in time O(T
                        2) for the single-item problem and O(NT
                        2) for the multi-item case. Moreover, from the nonnegativity of parameters 
                           
                              
                                 ψ
                                 
                                    r
                                    s
                                 
                                 
                                    i
                                    t
                                 
                              
                              ,
                           
                         they are nonnegative and therefore one can easily find a shortest path from node 0 to 
                           
                              T
                              +
                              1
                           
                         in graph Gj
                         using classical shortest path algorithms. Since graph Gj
                         is acyclic and has O(T
                        2) arcs, a topological sorting or breadth-first search algorithm can compute the shortest path in time O(T
                        2). Hence, finding an optimal policy for the single-echelon problems can be achieved in time complexity O(NT
                        2) for 
                           
                              (
                              
                                 
                                    S
                                    ^
                                 
                                 0
                              
                              )
                           
                         and O(T
                        2) for each 
                           
                              (
                              
                                 
                                    S
                                    ^
                                 
                                 i
                              
                              )
                              ,
                           
                         
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              N
                           
                        .

We denote 
                           
                              
                                 π
                                 ^
                              
                              j
                           
                         a feasible policy for system 
                           
                              (
                              
                                 
                                    S
                                    ^
                                 
                                 j
                              
                              )
                           
                        . Note that if 
                           
                              j
                              =
                              0
                              ,
                           
                         
                           
                              
                                 π
                                 ^
                              
                              0
                           
                         is a set of 
                           
                              (
                              N
                              +
                              1
                              )
                           
                        -uplet (r, qr
                        ), where 
                           
                              r
                              ∈
                              
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 }
                              
                           
                         and qr
                         is the N-uplet of quantities ordered for each item in period r. For all j, we denote 
                           
                              
                                 
                                    C
                                    ^
                                 
                                 j
                              
                              
                                 (
                                 
                                    
                                       π
                                       ^
                                    
                                    j
                                 
                                 )
                              
                           
                         the total cost incurred by policy 
                           
                              
                                 π
                                 ^
                              
                              j
                           
                         in system 
                           
                              (
                              
                                 
                                    S
                                    ^
                                 
                                 j
                              
                              )
                           
                        . In the same fashion as the one used for the global cost, it can be split between two components:

                           
                              
                                 
                                    
                                       
                                          C
                                          ^
                                       
                                       j
                                    
                                    
                                       (
                                       
                                          
                                             π
                                             ^
                                          
                                          j
                                       
                                       )
                                    
                                    =
                                    
                                       K
                                       j
                                    
                                    
                                       (
                                       
                                          
                                             π
                                             ^
                                          
                                          j
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          Ψ
                                          ^
                                       
                                       j
                                    
                                    
                                       (
                                       
                                          
                                             π
                                             ^
                                          
                                          j
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           
                              
                                 K
                                 j
                              
                              
                                 (
                                 
                                    
                                       π
                                       ^
                                    
                                    j
                                 
                                 )
                              
                           
                         (resp. 
                           
                              
                                 
                                    Ψ
                                    ^
                                 
                                 j
                              
                              
                                 (
                                 
                                    
                                       π
                                       ^
                                    
                                    j
                                 
                                 )
                              
                           
                        ) denotes the total ordering (resp. carrying) cost incurred by policy 
                           
                              
                                 π
                                 ^
                              
                              j
                           
                         in system 
                           
                              (
                              
                                 
                                    S
                                    ^
                                 
                                 j
                              
                              )
                           
                        .

To conclude this section, we introduce a new lower bound for the optimal solution of the OWMR problem with backlog using the decomposition discussed above. Assume that we compute an optimal policy 
                           
                              
                                 π
                                 ^
                              
                              j
                              *
                           
                         to problem 
                           
                              (
                              
                                 
                                    S
                                    ^
                                 
                                 j
                              
                              )
                           
                         for all j. The next lemma uses the costs incurred by these policies in the single-echelon systems 
                           
                              (
                              
                                 
                                    S
                                    ^
                                 
                                 j
                              
                              )
                           
                         to define a lower bound on the cost of any policy for the original problem. In particular, the sum of these costs is a lower bound on its optimal cost.

                           Lemma 1
                           
                              Consider a OWMR problem with backlog and a metric carrying cost structure. Let
                              
                                 
                                    C
                                    *
                                 
                               
                              be the cost of an optimal policy for this problem and let
                              
                                 
                                    
                                       
                                          π
                                          ^
                                       
                                       0
                                       *
                                    
                                    ,
                                    
                                       
                                          π
                                          ^
                                       
                                       1
                                       *
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          π
                                          ^
                                       
                                       N
                                       *
                                    
                                 
                               
                              be optimal single-echelon policies for problems
                              
                                 
                                    
                                       (
                                       
                                          
                                             S
                                             ^
                                          
                                          0
                                       
                                       )
                                    
                                    ,
                                    
                                       (
                                       
                                          
                                             S
                                             ^
                                          
                                          1
                                       
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    
                                       (
                                       
                                          
                                             S
                                             ^
                                          
                                          N
                                       
                                       )
                                    
                                 
                               
                              as defined in the decomposition. Then the following inequality holds:
                              
                                 
                                    
                                       
                                          
                                             C
                                             *
                                          
                                          ≥
                                          
                                             ∑
                                             
                                                j
                                                =
                                                0
                                             
                                             N
                                          
                                          
                                             
                                                C
                                                ^
                                             
                                             j
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ^
                                                
                                                j
                                                *
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

Proof. The proof of this lemma is detailed in Appendix A. Basically, we start from an optimal policy 
                                 
                                    
                                       π
                                       OPT
                                    
                                    =
                                    
                                       (
                                       
                                          π
                                          0
                                          OPT
                                       
                                       ,
                                       
                                          π
                                          1
                                          OPT
                                       
                                       ,
                                       …
                                       ,
                                       
                                          π
                                          N
                                          OPT
                                       
                                       )
                                    
                                 
                               and decompose it in 
                                 
                                    N
                                    +
                                    1
                                 
                               single-echelon policies 
                                 
                                    
                                       
                                          π
                                          ¯
                                       
                                       0
                                    
                                    ,
                                    
                                       
                                          π
                                          ¯
                                       
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          π
                                          ¯
                                       
                                       N
                                    
                                    ,
                                 
                               one for each system 
                                 
                                    (
                                    
                                       
                                          S
                                          ^
                                       
                                       j
                                    
                                    )
                                 
                              . We then show that the sum of the costs incurred by policies 
                                 
                                    
                                       π
                                       ¯
                                    
                                    j
                                 
                               in systems 
                                 
                                    (
                                    
                                       
                                          S
                                          ^
                                       
                                       j
                                    
                                    )
                                 
                               is lower than the optimal cost 
                                 
                                    C
                                    *
                                 
                               for the original problem. The proof then follows from the optimality of policies 
                                 
                                    
                                       π
                                       ^
                                    
                                    j
                                    *
                                 
                              .□

In this section, we modify the uncrossing method and use the decomposition 
                           
                              
                                 (
                                 
                                    
                                       S
                                       ^
                                    
                                    0
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    
                                       S
                                       ^
                                    
                                    1
                                 
                                 )
                              
                              ,
                              …
                              ,
                              
                                 (
                                 
                                    
                                       S
                                       ^
                                    
                                    N
                                 
                                 )
                              
                           
                         to build a feasible solution for the original problem. In addition we prove that when the solution is built upon the optimal single-echelon policies for these independent systems, the policy obtained has a cost of at most three times the optimal cost.

Let 
                           
                              
                                 
                                    π
                                    ^
                                 
                                 0
                              
                              ,
                              …
                              ,
                              
                                 
                                    π
                                    ^
                                 
                                 N
                              
                           
                         be feasible policies for problems 
                           
                              
                                 (
                                 
                                    
                                       S
                                       ^
                                    
                                    0
                                 
                                 )
                              
                              ,
                              …
                              ,
                              
                                 (
                                 
                                    
                                       S
                                       ^
                                    
                                    N
                                 
                                 )
                              
                           
                        . Recall that in our model, the warehouse cannot backlog the orders of the retailers. Thus in order to build a feasible policy to the original problem from policies 
                           
                              
                                 
                                    π
                                    ^
                                 
                                 i
                              
                              ,
                           
                         we need to eliminate the problematic situations where policy 
                           
                              
                                 π
                                 ^
                              
                              i
                           
                         orders a demand 
                           
                              d
                              t
                              i
                           
                         in period s while 
                           
                              
                                 π
                                 ^
                              
                              0
                           
                         orders the same demand in period r > s. We say that the pair of orders ⌈r, s⌋ is crossing (or not feasible) if r > s.

We now present the uncrossing algorithm for the OWMR problem with backlog. Let 
                           
                              R
                              =
                              {
                              
                                 r
                                 1
                              
                              ,
                              ⋯
                              ,
                              
                                 r
                                 w
                              
                              }
                           
                         denote the set of periods when the warehouse orders according to policy 
                           
                              
                                 π
                                 ^
                              
                              0
                           
                        . For convenience we add to R an artificial period 
                           
                              
                                 r
                                 
                                    w
                                    +
                                    1
                                 
                              
                              =
                              
                                 T
                                 +
                                 1
                              
                           
                         corresponding to the end of the planning horizon, with no ordering cost. Given a set R – induced by a policy π
                        0 – and a period 
                           
                              s
                              =
                              1
                              ,
                              …
                              ,
                              T
                              ,
                           
                         let 
                           
                              
                                 s
                              
                              +
                           
                         and 
                           
                              
                                 s
                              
                              −
                           
                         be the first period of R after s and the last period of R prior to s, respectively:

                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             +
                                          
                                       
                                       
                                          
                                             =
                                             min
                                             
                                                {
                                                r
                                                ∈
                                                R
                                                :
                                                
                                                r
                                                ≥
                                                s
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             −
                                          
                                       
                                       
                                          
                                             =
                                             max
                                             
                                                {
                                                r
                                                ∈
                                                R
                                                :
                                                
                                                r
                                                ≤
                                                s
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        In what follows, the set R used to define 
                           
                              
                                 s
                              
                              +
                           
                         and 
                           
                              
                                 s
                              
                              −
                           
                         will be clear from the context.

For simplicity, we say that a retailer order in period s is crossing in period r if there exists a demand 
                           
                              d
                              t
                              i
                           
                         served by 
                           
                              
                                 π
                                 ^
                              
                              i
                           
                         in period s and by 
                           
                              
                                 π
                                 ^
                              
                              0
                           
                         in period r, with r > s. As its name suggests, the following algorithm uncrosses such retailer orders by simply adding an order of retailer i in period 
                           
                              
                                 s
                              
                              +
                           
                         in order to synchronize with the warehouse. Note that in the case of J-retailers, we also synchronize the orders when r ≤ s by placing an additional order in period 
                           
                              
                                 
                                    s
                                 
                                 −
                              
                              ,
                           
                         which enables us to bound the holding cost incurred in the resulting policy.


                        The uncrossing algorithm
                     


                        Input: A set of feasible policies 
                           
                              
                                 π
                                 ^
                              
                              i
                           
                         for each problem 
                           
                              (
                              
                                 
                                    S
                                    ^
                                 
                                 i
                              
                              )
                              ,
                           
                        
                        
                           
                              i
                              =
                              0
                              ,
                              …
                              ,
                              N
                           
                        .


                        Output: A feasible policy πu
                         for the OWMR problem with backlog, defined as follows. Let r and s be the periods when 
                           
                              
                                 π
                                 ^
                              
                              0
                           
                         and 
                           
                              
                                 π
                                 ^
                              
                              i
                           
                         order to serve demand 
                           
                              
                                 d
                                 t
                                 i
                              
                              ,
                           
                         respectively. The final policy πu
                         then uses the pair of orders ⌈rit, sit
                        ⌋ to serve demand 
                           
                              
                                 d
                                 t
                                 i
                              
                              ,
                           
                         where

                           
                              (6)
                              
                                 
                                    
                                       ⌈
                                       
                                          r
                                          
                                             i
                                             t
                                          
                                       
                                       ,
                                       
                                          s
                                          
                                             i
                                             t
                                          
                                       
                                       ⌋
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   ⌈
                                                   
                                                      
                                                         s
                                                      
                                                      +
                                                   
                                                   ,
                                                   
                                                      
                                                         s
                                                      
                                                      +
                                                   
                                                   ⌋
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   r
                                                   >
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⌈
                                                   
                                                      
                                                         s
                                                      
                                                      −
                                                   
                                                   ,
                                                   
                                                      
                                                         s
                                                      
                                                      −
                                                   
                                                   ⌋
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   i
                                                   ∈
                                                   
                                                      I
                                                      J
                                                   
                                                   
                                                   and
                                                   
                                                   r
                                                   ≤
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⌈
                                                   
                                                      
                                                         s
                                                      
                                                      −
                                                   
                                                   ,
                                                   s
                                                   ⌋
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   i
                                                   ∈
                                                   
                                                      I
                                                      W
                                                   
                                                   
                                                   and
                                                   
                                                   r
                                                   ≤
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Note that this operation is executed in time O(NT), which leads to a final complexity (including the resolution of the single-echelon subproblems) of O(NT
                        2).

We now focus on the total cost incurred by πu
                        , the final policy built by the uncrossing algorithm. The following lemma bounds the overcost incurred by the uncrossing algorithm compared to the costs of the independent single-echelon policies 
                           
                              
                                 π
                                 ^
                              
                              j
                           
                        .

                           Lemma 2
                           
                              The uncrossing algorithm applied to single-echelon policies
                              
                                 
                                    
                                       
                                          π
                                          ^
                                       
                                       0
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          π
                                          ^
                                       
                                       N
                                    
                                 
                               
                              produces an uncrossed feasible solution πu 
                              for the OWMR problem. The total cost incurred by the resulting policy satisfies:
                              
                                 
                                    
                                       
                                          C
                                          
                                             (
                                             
                                                π
                                                u
                                             
                                             )
                                          
                                          ≤
                                          3
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             N
                                          
                                          
                                             
                                                Ψ
                                                ^
                                             
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ^
                                                
                                                i
                                             
                                             )
                                          
                                          +
                                          
                                             K
                                             0
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ^
                                                
                                                0
                                             
                                             )
                                          
                                          +
                                          2
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             N
                                          
                                          
                                             K
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ^
                                                
                                                i
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                              Moreover in the special case of the JRP (i.e. if
                              
                                 
                                    
                                       I
                                       W
                                    
                                    =
                                    ∅
                                 
                              
                              ), we have:
                              
                                 
                                    
                                       
                                          C
                                          
                                             (
                                             
                                                π
                                                u
                                             
                                             )
                                          
                                          ≤
                                          2
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             N
                                          
                                          
                                             
                                                Ψ
                                                ^
                                             
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ^
                                                
                                                i
                                             
                                             )
                                          
                                          +
                                          
                                             K
                                             0
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ^
                                                
                                                0
                                             
                                             )
                                          
                                          +
                                          2
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             N
                                          
                                          
                                             K
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ^
                                                
                                                i
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

Proof. See Appendix B.□

We now show that when the split and uncross algorithm builds a policy πu
                         upon optimal policies 
                           
                              
                                 
                                    π
                                    ^
                                 
                                 0
                                 *
                              
                              ,
                              
                                 
                                    π
                                    ^
                                 
                                 1
                                 *
                              
                              ,
                              …
                              ,
                              
                                 
                                    π
                                    ^
                                 
                                 N
                                 *
                              
                           
                         for single-echelon systems 
                           
                              
                                 (
                                 
                                    
                                       S
                                       ^
                                    
                                    0
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    
                                       S
                                       ^
                                    
                                    1
                                 
                                 )
                              
                              ,
                              …
                              ,
                              
                                 (
                                 
                                    
                                       S
                                       ^
                                    
                                    N
                                 
                                 )
                              
                              ,
                           
                         
                           
                              C
                              (
                              
                                 π
                                 u
                              
                              )
                           
                         is at most three times the optimal cost 
                           
                              C
                              *
                           
                        . More precisely, the 3-approximation algorithm works as follows:

                           
                              
                                 Step 1 Compute optimal policies 
                                    
                                       
                                          
                                             π
                                             ^
                                          
                                          0
                                          *
                                       
                                       ,
                                       
                                          
                                             π
                                             ^
                                          
                                          1
                                          *
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             π
                                             ^
                                          
                                          N
                                          *
                                       
                                    
                                  for problems 
                                    
                                       
                                          (
                                          
                                             
                                                S
                                                ^
                                             
                                             0
                                          
                                          )
                                       
                                       ,
                                       
                                          (
                                          
                                             
                                                S
                                                ^
                                             
                                             1
                                          
                                          )
                                       
                                       ,
                                       …
                                       ,
                                       
                                          (
                                          
                                             
                                                S
                                                ^
                                             
                                             N
                                          
                                          )
                                       
                                    
                                  independently.


                                 Step 2 Apply the uncrossing algorithm to policies 
                                    
                                       
                                          
                                             π
                                             ^
                                          
                                          0
                                          *
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             π
                                             ^
                                          
                                          N
                                          *
                                       
                                    
                                 .

Let πu
                        
                        * be the resulting policy: From Lemmas 1 and 2, we have:

                           
                              
                                 
                                    
                                       
                                          
                                             C
                                             (
                                             
                                                
                                                   
                                                      π
                                                      u
                                                   
                                                
                                                *
                                             
                                             )
                                          
                                       
                                       
                                          
                                             ≤
                                             3
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                N
                                             
                                             
                                                
                                                   Ψ
                                                   ^
                                                
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      π
                                                      ^
                                                   
                                                   i
                                                   *
                                                
                                                )
                                             
                                             +
                                             
                                                K
                                                0
                                             
                                             
                                                (
                                                
                                                   
                                                      π
                                                      ^
                                                   
                                                   0
                                                   *
                                                
                                                )
                                             
                                             +
                                             2
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                K
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      π
                                                      ^
                                                   
                                                   i
                                                   *
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ≤
                                             3
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                N
                                             
                                             
                                                
                                                   C
                                                   ^
                                                
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      π
                                                      ^
                                                   
                                                   i
                                                   *
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ≤
                                             3
                                             
                                                C
                                                *
                                             
                                          
                                       
                                    
                                 
                              
                           
                        We conclude that the following theorem holds:

                           Theorem 1
                           
                              The policy πu
                              
                              * 
                              obtained after applying the split and uncross algorithm to policies
                              
                                 
                                    
                                       
                                          π
                                          ^
                                       
                                       0
                                       *
                                    
                                    ,
                                    
                                       
                                          π
                                          ^
                                       
                                       1
                                       *
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          π
                                          ^
                                       
                                       N
                                       *
                                    
                                 
                               
                              has a performance guarantee of three for the OWMR problem with backlog. Its complexity is quadratic in the case of a metric carrying cost structure.
                           

Notice that in the special case of the JRP, property (P5) becomes irrelevant since 
                           
                              
                                 I
                                 W
                              
                              =
                              ∅
                           
                        . In addition, the above inequality can be refined to reach a performance guarantee of two:

                           
                              
                                 
                                    
                                       
                                          
                                             C
                                             (
                                             
                                                
                                                   
                                                      π
                                                      u
                                                   
                                                
                                                *
                                             
                                             )
                                          
                                       
                                       
                                          
                                             ≤
                                             2
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                N
                                             
                                             
                                                
                                                   Ψ
                                                   ^
                                                
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      π
                                                      ^
                                                   
                                                   i
                                                   *
                                                
                                                )
                                             
                                             +
                                             
                                                K
                                                0
                                             
                                             
                                                (
                                                
                                                   
                                                      π
                                                      ^
                                                   
                                                   0
                                                   *
                                                
                                                )
                                             
                                             +
                                             2
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                K
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      π
                                                      ^
                                                   
                                                   i
                                                   *
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ≤
                                             2
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                N
                                             
                                             
                                                
                                                   C
                                                   ^
                                                
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      π
                                                      ^
                                                   
                                                   i
                                                   *
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ≤
                                             2
                                             
                                                C
                                                *
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           Theorem 2
                           
                              The policy πu
                              
                              * 
                              obtained after applying the split and uncross algorithm to policies
                              
                                 
                                    
                                       
                                          π
                                          ^
                                       
                                       0
                                       *
                                    
                                    ,
                                    
                                       
                                          π
                                          ^
                                       
                                       1
                                       *
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          π
                                          ^
                                       
                                       N
                                       *
                                    
                                 
                               
                              has a performance guarantee of two for the JRP with backlog.
                           

While in the backorder model we assume that customers are willing to wait for their demands to be fulfilled, another alternative is to consider a model in which customers are impatient and every unmet demand is simply lost. Most of the lost-sales literature focuses on cost structures in which it is dominant to serve demands on a first-come first-served basis. Although this is clearly the case for the linear cost setting, our model uses a general metric cost structure derived from the one introduced in Section 2, in which the latter property is not necessarily dominant.

In this section, we introduce a modified decomposition for the problem and exhibits a lower bound for the OWMR problem with lost-sales. We then show how to adapt the split and uncross technique to this problem and build a 2-approximation from the subproblems of the decomposition.

We use the general cost structure introduced in Section 2 to modelize the case of lost-sales problem and simply consider it as a special case of the backorder version, where parameters 
                           
                              ϕ
                              
                                 r
                                 s
                              
                              
                                 i
                                 t
                              
                           
                         are constant when demand dit
                         is not satisfied immediately. We have 
                           
                              
                                 ϕ
                                 
                                    r
                                    s
                                 
                                 
                                    i
                                    t
                                 
                              
                              =
                              
                                 ϕ
                                 
                                    i
                                    t
                                 
                              
                           
                         for all s > t and the following inequality holds for parameters 
                           
                              ψ
                              
                                 r
                                 s
                              
                              
                                 i
                                 t
                              
                           
                        :

                           
                              (7)
                              
                                 
                                    
                                       ψ
                                       
                                          r
                                          s
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    =
                                    
                                       ψ
                                       
                                          i
                                          t
                                       
                                    
                                    =
                                    
                                       ϕ
                                       
                                          i
                                          t
                                       
                                    
                                    
                                       d
                                       
                                          i
                                          t
                                       
                                    
                                    
                                    
                                    for
                                    
                                    all
                                    
                                    s
                                    >
                                    t
                                 
                              
                           
                        Thus the parameter ψit
                         corresponds to the total lost-sales cost associated to demand point (i, t). In other words, if the system serves demand dit
                         with the pair of orders ⌈r, s⌋ where s ≤ t, it incurs a cost 
                           
                              ψ
                              
                                 r
                                 s
                              
                              
                                 i
                                 t
                              
                           
                         while if it does not serve this demand, the cost for loosing the sale is equal to ψit
                        . Another way to see the lost-sales penalty cost is to consider that there exists an alternative stock from which we can order units to satisfy an unmet demand, for a total ordering cost of ψit
                        . Note that in our model one can speculate on the penalty cost and deliberately choose to order from this alternative stock if the penalty cost is attractive compared to the cost of serving the demand using the inventory on hand.

Constraint (7) ensures that properties (P1)-(P4) are satisfied when s > t. On the other hand, property (P5) is not necessary in the lost-sales case and therefore we only assume that parameters 
                           
                              ψ
                              
                                 r
                                 s
                              
                              
                                 i
                                 t
                              
                           
                         satisfy properties (P1)–(P4) and equation (7) in the remainder of this section.

In the same fashion as the backorder model, we decompose the system into 
                           
                              N
                              +
                              1
                           
                         independent single-echelon problems with lost-sales. However in this version, the holding costs and lost-sales penalty costs are halved instead of divided by three. Similarly to the JRP case, increasing the fraction of the real costs used in the subproblems is crucial to obtain a performance guarantee of two.

The decomposition for the OWMR with lost-sales is defined as follows:

                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             S
                                             ˜
                                          
                                          0
                                       
                                       )
                                    
                                  The warehouse is regarded as a single-echelon, multi-item system with lost-sales, facing for each period t a demand dit
                                  for item i. A fixed ordering cost 
                                    
                                       K
                                       r
                                       0
                                    
                                  is incurred for placing an order in period r. The holding cost incurred if demand (i, t) is ordered in period r is equal to 
                                    
                                       
                                          1
                                          2
                                       
                                       
                                          ψ
                                          
                                             r
                                             r
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                  if i ∈ IJ
                                  and 
                                    
                                       
                                          1
                                          2
                                       
                                       
                                          ψ
                                          
                                             r
                                             t
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                  if i ∈ IW
                                 . If the demand is lost, the system incurs a lost-sales cost equal to 
                                    
                                       
                                          1
                                          2
                                       
                                       
                                          ψ
                                          
                                             i
                                             t
                                          
                                       
                                    
                                 .


                                 
                                    
                                       (
                                       
                                          
                                             S
                                             ˜
                                          
                                          i
                                       
                                       )
                                    
                                  Retailer i is considered as a single-echelon system with lost-sales, facing demand dit
                                  with ordering cost Ki
                                 . The holding cost incurred to order to serve demand (i, t) with an order in period s is equal to 
                                    
                                       
                                          1
                                          2
                                       
                                       
                                          ψ
                                          
                                             s
                                             s
                                          
                                          
                                             i
                                             t
                                          
                                       
                                       ,
                                    
                                  while the per-unit cost if the demand is lost is equal to 
                                    
                                       
                                          1
                                          2
                                       
                                       
                                          ψ
                                          
                                             i
                                             t
                                          
                                       
                                    
                                 .

Similarly to the previous sections, we define 
                           
                              
                                 
                                    C
                                    ˜
                                 
                                 i
                              
                              
                                 (
                                 
                                    
                                       π
                                       ˜
                                    
                                    i
                                 
                                 )
                              
                           
                         (resp. 
                           
                              
                                 
                                    Ψ
                                    ˜
                                 
                                 i
                              
                              
                                 (
                                 
                                    
                                       π
                                       ˜
                                    
                                    i
                                 
                                 )
                              
                           
                        ) as the total (resp. carrying) cost incurred by 
                           
                              
                                 π
                                 ˜
                              
                              i
                           
                         in system 
                           
                              (
                              
                                 
                                    S
                                    ˜
                                 
                                 i
                              
                              )
                           
                         and we have for all 
                           
                              i
                              =
                              0
                              ,
                              …
                              ,
                              N
                           
                        :

                           
                              
                                 
                                    
                                       
                                          C
                                          ˜
                                       
                                       i
                                    
                                    
                                       (
                                       
                                          
                                             π
                                             ˜
                                          
                                          i
                                       
                                       )
                                    
                                    =
                                    
                                       K
                                       i
                                    
                                    
                                       (
                                       
                                          
                                             π
                                             ˜
                                          
                                          i
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          Ψ
                                          ˜
                                       
                                       i
                                    
                                    
                                       (
                                       
                                          
                                             π
                                             ˜
                                          
                                          i
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

We first discuss how to solve these single-echelon problems. Similarly to the systems with backlog, this can be done using classical shortest path algorithms in the same type of graph (see Fig. 1). We define a graph Gj
                         corresponding to each single-echelon problem 
                           
                              (
                              
                                 
                                    S
                                    ˜
                                 
                                 j
                              
                              )
                           
                        . The main difference comes from the computation of the length of each arc (u, v), u < v, that we detail below.

We first introduce the following virtual cost parameters:

                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                ω
                                                ˜
                                             
                                             r
                                             
                                                i
                                                t
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            min
                                                            
                                                               {
                                                               
                                                                  ψ
                                                                  
                                                                     r
                                                                     r
                                                                  
                                                                  
                                                                     i
                                                                     t
                                                                  
                                                               
                                                               ,
                                                               
                                                                  ψ
                                                                  
                                                                     i
                                                                     t
                                                                  
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            i
                                                            ∈
                                                            
                                                               I
                                                               J
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            min
                                                            
                                                               {
                                                               
                                                                  ψ
                                                                  
                                                                     r
                                                                     t
                                                                  
                                                                  
                                                                     i
                                                                     t
                                                                  
                                                               
                                                               ,
                                                               
                                                                  ψ
                                                                  
                                                                     i
                                                                     t
                                                                  
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                      
                                                         otherwise
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                                ˜
                                             
                                             s
                                             
                                                i
                                                t
                                             
                                          
                                       
                                       
                                          
                                             =
                                             min
                                             
                                                {
                                                
                                                   ψ
                                                   
                                                      s
                                                      s
                                                   
                                                   
                                                      i
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   ψ
                                                   
                                                      i
                                                      t
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        These are the virtual minimum cost between satisfying or loosing demand dit
                         when the last order is placed in period r or s. One can precompute these parameters in time O(T
                        2) for one retailer and O(NT
                        2) for the warehouse. We then define the length of each edge (u, v) in graphs Gi
                         and G
                        0 as follows:

                           
                              
                                 
                                    
                                       
                                          
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             N
                                             ,
                                             
                                             
                                             
                                                
                                                   l
                                                   ˜
                                                
                                                
                                                   u
                                                   ,
                                                   v
                                                
                                                i
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     t
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     v
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                                  1
                                                                  2
                                                               
                                                               
                                                                  ψ
                                                                  
                                                                     i
                                                                     t
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            u
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  K
                                                                  i
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  
                                                                     t
                                                                     =
                                                                     u
                                                                  
                                                                  
                                                                     v
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                                  1
                                                                  2
                                                               
                                                               
                                                                  
                                                                     ρ
                                                                     ˜
                                                                  
                                                                  u
                                                                  
                                                                     i
                                                                     t
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         otherwise
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                l
                                                ˜
                                             
                                             
                                                u
                                                ,
                                                v
                                             
                                             0
                                          
                                       
                                       
                                          
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  N
                                                               
                                                               
                                                                  ∑
                                                                  
                                                                     t
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     v
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                                  1
                                                                  2
                                                               
                                                               
                                                                  ψ
                                                                  
                                                                     i
                                                                     t
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            u
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  K
                                                                  u
                                                                  0
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  N
                                                               
                                                               
                                                                  ∑
                                                                  
                                                                     t
                                                                     =
                                                                     u
                                                                  
                                                                  
                                                                     v
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                                  1
                                                                  2
                                                               
                                                               
                                                                  
                                                                     ω
                                                                     ˜
                                                                  
                                                                  u
                                                                  
                                                                     i
                                                                     t
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         otherwise
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        These lengths are computed in time O(NT
                        2). As for the backorder version, the time complexity to compute the 
                           
                              N
                              +
                              1
                           
                         optimal policies to problems 
                           
                              (
                              
                                 
                                    S
                                    ˜
                                 
                                 j
                              
                              )
                           
                         is equal to O(NT
                        2).

We now focus on the lower bound resulting from this decomposition. The following lemma derives from Lemma 1:

                           Lemma 3
                           
                              Consider a OWMR problem with lost-sales. Let
                              
                                 
                                    C
                                    *
                                 
                               
                              be the cost of an optimal policy for this problem and let
                              
                                 
                                    
                                       
                                          π
                                          ˜
                                       
                                       0
                                       *
                                    
                                    ,
                                    
                                       
                                          π
                                          ˜
                                       
                                       1
                                       *
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          π
                                          ˜
                                       
                                       N
                                       *
                                    
                                 
                               
                              be optimal single-echelon policies for problems
                              
                                 
                                    
                                       (
                                       
                                          
                                             S
                                             ˜
                                          
                                          0
                                       
                                       )
                                    
                                    ,
                                    
                                       (
                                       
                                          
                                             S
                                             ˜
                                          
                                          1
                                       
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    
                                       (
                                       
                                          
                                             S
                                             ˜
                                          
                                          N
                                       
                                       )
                                    
                                 
                               
                              as defined in the decomposition. Then the following inequality holds:
                              
                                 
                                    
                                       
                                          
                                             C
                                             *
                                          
                                          ≥
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             N
                                          
                                          
                                             
                                                C
                                                ˜
                                             
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ˜
                                                
                                                i
                                                *
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

Proof The proof is similar to the one of Lemma 1 (see Appendix C).□

To conclude this section, we show how to adapt the split and uncross technique to the lost-sales case and build a 2-approximation algorithm. Let 
                           
                              
                                 
                                    π
                                    ˜
                                 
                                 0
                              
                              ,
                              …
                              ,
                              
                                 
                                    π
                                    ˜
                                 
                                 N
                              
                           
                         be feasible policies for problems 
                           
                              
                                 (
                                 
                                    
                                       S
                                       ˜
                                    
                                    0
                                 
                                 )
                              
                              ,
                              …
                              ,
                              
                                 (
                                 
                                    
                                       S
                                       ˜
                                    
                                    N
                                 
                                 )
                              
                           
                         and let 
                           
                              R
                              =
                              {
                              
                                 r
                                 1
                              
                              ,
                              ⋯
                              ,
                              
                                 r
                                 w
                              
                              ,
                              
                                 r
                                 
                                    w
                                    +
                                    1
                                 
                              
                              }
                           
                         the set of periods when policy 
                           
                              
                                 π
                                 ˜
                              
                              0
                           
                         places order, where again 
                           
                              
                                 r
                                 
                                    w
                                    +
                                    1
                                 
                              
                              =
                              
                                 T
                                 +
                                 1
                              
                           
                         is an artificial period corresponding to the end of the planning horizon. The algorithm is very similar to the one presented in Section 3.2, with the following simple modification. Let 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              N
                           
                         and 
                           
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                           
                        : If neither 
                           
                              
                                 π
                                 ˜
                              
                              0
                           
                         nor 
                           
                              
                                 π
                                 ˜
                              
                              i
                           
                         satisfies 
                           
                              
                                 d
                                 t
                                 i
                              
                              ,
                           
                         then the demand is lost in the final policy πu
                        . Otherwise the ordering periods for demand 
                           
                              d
                              t
                              i
                           
                         at the warehouse and at the retailer are defined according to Eq. (6).

It is straightforward that the lower bound from Lemma 2 holds in this special case of the problem. However, since we only halve the holding and penalty costs in the subproblems instead of dividing them by three, we can improve upon this result to get the following lower bound:

                           Lemma 4
                           
                              The uncrossing algorithm applied to single-echelon policies
                              
                                 
                                    
                                       
                                          π
                                          ˜
                                       
                                       0
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          π
                                          ˜
                                       
                                       N
                                    
                                 
                               
                              produces an uncrossed feasible solution
                              
                                 
                                    
                                       π
                                       ˜
                                    
                                    u
                                 
                               
                              for the OWMR problem with lost-sales. The total cost incurred by the resulting policy satisfies:
                              
                                 
                                    
                                       
                                          C
                                          
                                             (
                                             
                                                
                                                   π
                                                   ˜
                                                
                                                u
                                             
                                             )
                                          
                                          ≤
                                          
                                             K
                                             0
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ˜
                                                
                                                0
                                             
                                             )
                                          
                                          +
                                          2
                                          
                                             
                                                Ψ
                                                ˜
                                             
                                             0
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ˜
                                                
                                                0
                                             
                                             )
                                          
                                          +
                                          2
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             N
                                          
                                          
                                             
                                                C
                                                ˜
                                             
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ˜
                                                
                                                i
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

Proof See Appendix D.□

Finally, assume the solution built by the split and uncross algorithm when applied to the optimal single-echelon policis 
                           
                              
                                 
                                    π
                                    ˜
                                 
                                 0
                                 *
                              
                              ,
                              
                                 
                                    π
                                    ˜
                                 
                                 1
                                 *
                              
                              ,
                              …
                              ,
                              
                                 
                                    π
                                    ˜
                                 
                                 N
                                 *
                              
                           
                         for problems 
                           
                              
                                 (
                                 
                                    
                                       S
                                       ˜
                                    
                                    0
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    
                                       S
                                       ˜
                                    
                                    1
                                 
                                 )
                              
                              ,
                              …
                              ,
                              
                                 (
                                 
                                    
                                       S
                                       ˜
                                    
                                    N
                                 
                                 )
                              
                           
                        . Let 
                           
                              
                                 π
                                 ˜
                              
                              
                                 u
                                 *
                              
                           
                         be the resulting policy: From Lemmas 3 and 4, we have:

                           
                              
                                 
                                    
                                       
                                          
                                             C
                                             (
                                             
                                                
                                                   π
                                                   ˜
                                                
                                                
                                                   u
                                                   *
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             ≤
                                             
                                                K
                                                0
                                             
                                             
                                                (
                                                
                                                   
                                                      π
                                                      ˜
                                                   
                                                   0
                                                   *
                                                
                                                )
                                             
                                             +
                                             2
                                             
                                                
                                                   Ψ
                                                   ˜
                                                
                                                0
                                             
                                             
                                                (
                                                
                                                   
                                                      π
                                                      ˜
                                                   
                                                   0
                                                   *
                                                
                                                )
                                             
                                             +
                                             2
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                
                                                   C
                                                   ˜
                                                
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      π
                                                      ˜
                                                   
                                                   i
                                                   *
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ≤
                                             2
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                N
                                             
                                             
                                                
                                                   C
                                                   ˜
                                                
                                                i
                                             
                                             
                                                (
                                                
                                                   
                                                      π
                                                      ˜
                                                   
                                                   i
                                                   *
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ≤
                                             2
                                             
                                                C
                                                *
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and the following theorem states the approximation ratio of the technique:

                           Theorem 3
                           
                              The policy
                              
                                 
                                    
                                       π
                                       ˜
                                    
                                    
                                       u
                                       *
                                    
                                 
                               
                              obtained after applying the split and uncross algorithm to policies
                              
                                 
                                    
                                       
                                          π
                                          ˜
                                       
                                       0
                                       *
                                    
                                    ,
                                    
                                       
                                          π
                                          ˜
                                       
                                       1
                                       *
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          π
                                          ˜
                                       
                                       N
                                       *
                                    
                                 
                               
                              has a performance guarantee of two for the OWMR problem with lost-sales. Its complexity is linear in the case of linear cost and quadratic in the case of metric carrying cost parameters.
                           

Although the literature on discrete deterministic divergent inventory systems is already substantial, almost all the existing works assume that demands must be satisfied on time. Our work propose the first constant approximation for the OWMR problem with backlog or lost-sales. We derive new, intuitive lower bounds for the problems considered and prove that our algorithms have a constant performance guarantee under a general cost structure that can capture many practical situations. In addition we show that the performance guarantee can be improved in special cases of our model, namely the JRP and a lost-sales model.

Although these results fill a gap in the literature on deterministic inventory theory, there remains some room for improvement. One obvious way for future research is to try to improve the performance guarantee of three in the backlogging case. One could also want to generalize the assumptions on the cost structure by eliminating the backlogging cost bounding constraint or considering nonlinear carrying costs.

Consider an optimal policy 
                        
                           
                              π
                              OPT
                           
                           =
                           
                              (
                              
                                 π
                                 0
                                 OPT
                              
                              ,
                              
                                 π
                                 1
                                 OPT
                              
                              ,
                              …
                              ,
                              
                                 π
                                 N
                                 OPT
                              
                              )
                           
                        
                      for the OWMR system with backlog. For all 
                        
                           j
                           =
                           0
                           ,
                           …
                           ,
                           N
                           ,
                        
                      let 
                        
                           
                              π
                              ¯
                           
                           j
                        
                      be the single-echelon policy that places the same orders as 
                        
                           π
                           j
                           OPT
                        
                     . That is, if π
                     OPT orders demand (i, t) in period r at the warehouse and s at retailer i,  
                        
                           
                              π
                              ¯
                           
                           0
                        
                      and 
                        
                           
                              π
                              ¯
                           
                           i
                        
                      orders demand (i, t) in period r and s, respectively.

Note that by definition of 
                        
                           
                              π
                              ¯
                           
                           j
                        
                      for all j, the ordering costs remain untouched: 
                        
                           K
                           
                              (
                              
                                 π
                                 OPT
                              
                              )
                           
                           =
                           
                              ∑
                              
                                 j
                                 =
                                 0
                              
                              N
                           
                           
                              K
                              j
                           
                           
                              (
                              
                                 
                                    π
                                    ¯
                                 
                                 j
                              
                              )
                           
                        
                     . Therefore we simply have to prove that 
                        
                           
                              ∑
                              
                                 j
                                 =
                                 0
                              
                              N
                           
                           
                              Ψ
                              j
                           
                           
                              (
                              
                                 
                                    π
                                    ¯
                                 
                                 j
                              
                              )
                           
                           ≤
                           Ψ
                           
                              (
                              
                                 π
                                 OPT
                              
                              )
                           
                        
                      and the proof will follow from the optimality of policies 
                        
                           
                              
                                 π
                                 ^
                              
                              0
                              *
                           
                           ,
                           
                              
                                 π
                                 ^
                              
                              1
                              *
                           
                           ,
                           …
                           ,
                           
                              
                                 π
                                 ^
                              
                              N
                              *
                           
                        
                     . Consider a demand point (i, t) and let r and s be the periods when π
                     OPT orders the demand at the warehouse and at retailer i, respectively. The carrying cost incurred by π
                     OPT for this demand is therefore equal to 
                        
                           ψ
                           
                              r
                              s
                           
                           
                              i
                              t
                           
                        
                     . On the other hand, the total cost incurred by policies 
                        
                           
                              π
                              ¯
                           
                           0
                        
                      and 
                        
                           
                              π
                              ¯
                           
                           i
                        
                      to carry this demand in systems 
                        
                           (
                           
                              
                                 S
                                 ^
                              
                              0
                           
                           )
                        
                      (resp. 
                        
                           (
                           
                              
                                 S
                                 ^
                              
                              i
                           
                           )
                        
                     ) is equal to 
                        
                           
                              1
                              3
                           
                           
                              ω
                              
                                 r
                                 r
                              
                              
                                 i
                                 t
                              
                           
                        
                      (resp. 
                        
                           
                              2
                              3
                           
                           
                              ψ
                              
                                 s
                                 s
                              
                              
                                 i
                                 t
                              
                           
                        
                     ) if i ∈ IW
                      and 
                        
                           
                              1
                              2
                           
                           
                              ω
                              
                                 r
                                 r
                              
                              
                                 i
                                 t
                              
                           
                        
                      (resp. 
                        
                           
                              1
                              2
                           
                           
                              ψ
                              
                                 s
                                 s
                              
                              
                                 i
                                 t
                              
                           
                        
                     ) if i ∈ IJ
                     . Hence we want to show that 
                        
                           ψ
                           
                              r
                              s
                           
                           
                              i
                              t
                           
                        
                      is bounded as follows:

                        
                           (A.1)
                           
                              
                                 
                                    ψ
                                    
                                       r
                                       s
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 ≥
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   3
                                                
                                                
                                                   ψ
                                                   
                                                      r
                                                      r
                                                   
                                                   
                                                      i
                                                      t
                                                   
                                                
                                                +
                                                
                                                   2
                                                   3
                                                
                                                
                                                   ψ
                                                   
                                                      s
                                                      s
                                                   
                                                   
                                                      i
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                if
                                                
                                                i
                                                ∈
                                                
                                                   I
                                                   W
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   1
                                                   2
                                                
                                                
                                                   ψ
                                                   
                                                      r
                                                      r
                                                   
                                                   
                                                      i
                                                      t
                                                   
                                                
                                                +
                                                
                                                   1
                                                   2
                                                
                                                
                                                   ψ
                                                   
                                                      s
                                                      s
                                                   
                                                   
                                                      i
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                otherwise.
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     which is precisely the sum of the costs incurred by policies 
                        
                           
                              π
                              ¯
                           
                           0
                        
                      and 
                        
                           
                              π
                              ¯
                           
                           j
                        
                      to carry demand 
                        
                           d
                           t
                           i
                        
                     . We now prove that inequality (A.1) holds depending on the nature of retailer i.

If i ∈ IJ
                     , we have 
                        
                           r
                           =
                           s
                        
                      since π
                     OPT is optimal and therefore

                        
                           (A.2)
                           
                              
                                 
                                    
                                       
                                          ψ
                                          
                                             r
                                             s
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             ψ
                                             
                                                r
                                                r
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          =
                                          
                                             ψ
                                             
                                                s
                                                s
                                             
                                             
                                                i
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.3)
                           
                              
                                 
                                    
                                       
                                    
                                    
                                       
                                          =
                                          
                                             1
                                             2
                                          
                                          
                                             ψ
                                             
                                                r
                                                r
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             ψ
                                             
                                                s
                                                s
                                             
                                             
                                                i
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

If i ∈ IW
                     , we distinguish between two cases, listed below:

                        
                           •
                           
                              s ≤ t or r > t: Properties (P2) and (P3) ensure that

                                 
                                    (A.4)
                                    
                                       
                                          
                                             
                                                
                                                   ψ
                                                   
                                                      r
                                                      s
                                                   
                                                   
                                                      i
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   ≥
                                                   max
                                                   
                                                      {
                                                      
                                                         ψ
                                                         
                                                            r
                                                            t
                                                         
                                                         
                                                            i
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         ψ
                                                         
                                                            s
                                                            s
                                                         
                                                         
                                                            i
                                                            t
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   ≥
                                                   
                                                      1
                                                      3
                                                   
                                                   
                                                      ψ
                                                      
                                                         r
                                                         r
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      2
                                                      3
                                                   
                                                   
                                                      ψ
                                                      
                                                         s
                                                         s
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              r ≤ t < s: We have from properties (P2) and (P3)

                                 
                                    (A.5)
                                    
                                       
                                          
                                             
                                                
                                                   ψ
                                                   
                                                      r
                                                      s
                                                   
                                                   
                                                      i
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   ≥
                                                   max
                                                   
                                                      {
                                                      
                                                         ψ
                                                         
                                                            r
                                                            t
                                                         
                                                         
                                                            i
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         ψ
                                                         
                                                            t
                                                            s
                                                         
                                                         
                                                            i
                                                            t
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   ≥
                                                   
                                                      1
                                                      3
                                                   
                                                   
                                                      ψ
                                                      
                                                         r
                                                         r
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      2
                                                      3
                                                   
                                                   
                                                      ψ
                                                      
                                                         t
                                                         s
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   ≥
                                                   
                                                      1
                                                      3
                                                   
                                                   
                                                      ψ
                                                      
                                                         r
                                                         r
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      2
                                                      3
                                                   
                                                   
                                                      ψ
                                                      
                                                         s
                                                         s
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Hence in all cases, inequality (A.1) is satisfied and we have 
                        
                           Ψ
                           
                              (
                              
                                 π
                                 OPT
                              
                              )
                           
                           ≥
                           
                              ∑
                              
                                 j
                                 =
                                 0
                              
                              N
                           
                           
                              Ψ
                              j
                           
                           
                              (
                              
                                 
                                    π
                                    ¯
                                 
                                 j
                              
                              )
                           
                        
                     . As a consequence the following inequality holds:

                        
                           (A.6)
                           
                              
                                 
                                    C
                                    *
                                 
                                 =
                                 C
                                 
                                    (
                                    
                                       π
                                       OPT
                                    
                                    )
                                 
                                 ≥
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    N
                                 
                                 
                                    C
                                    j
                                 
                                 
                                    (
                                    
                                       
                                          π
                                          ¯
                                       
                                       j
                                    
                                    )
                                 
                              
                           
                        
                     Inequality (A.6) and the optimality of policies 
                        
                           
                              π
                              ^
                           
                           j
                           *
                        
                      for problems 
                        
                           (
                           
                              
                                 S
                                 ^
                              
                              j
                           
                           )
                        
                      then conclude the proof:

                        
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                0
                                             
                                             N
                                          
                                          
                                             C
                                             j
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ^
                                                
                                                j
                                                *
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ≤
                                          
                                             ∑
                                             
                                                j
                                                =
                                                0
                                             
                                             N
                                          
                                          C
                                          
                                             (
                                             
                                                
                                                   π
                                                   ¯
                                                
                                                j
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≤
                                          
                                             C
                                             *
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

First, note that for all 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           N
                        
                      and 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                           ,
                        
                      the pair of orders ⌈rit, sit
                     ⌋ chosen by the algorithm to serve 
                        
                           d
                           t
                           i
                        
                      satisfies rit
                      ≤ sit
                      and therefore policy πu
                      is uncrossed and feasible.

We now prove that the final cost incurred by πu
                      is bounded. By construction, each ordering period of 
                        
                           
                              π
                              ^
                           
                           i
                        
                      is replaced by at most two ordering periods at retailer i in πu
                     . More precisely, the set of ordering periods of retailer i in πu
                      is included in 
                        
                           {
                           
                              
                                 s
                              
                              −
                           
                           ,
                           
                              
                                 s
                              
                              +
                           
                           
                              |
                              s
                              
                              an
                              
                              ordering
                              
                              period
                              
                              of
                              
                           
                           
                              
                                 π
                                 ^
                              
                              i
                           
                           }
                        
                      if i ∈ IJ
                     , and in 
                        
                           {
                           s
                           ,
                           
                              
                                 s
                              
                              +
                           
                           
                              |
                              s
                              
                              an
                              
                              ordering
                              
                              period
                              
                              of
                              
                           
                           
                              
                                 π
                                 ^
                              
                              i
                           
                           }
                        
                      if i ∈ IW
                     . Thus the number of ordering periods at each retailer is at most doubled by the uncrossing algorithm. Moreover the uncrossing algorithm leaves the orders of 
                        
                           
                              π
                              ^
                           
                           0
                        
                      untouched, hence using the assumption of stationary ordering costs Ki
                      at the retailers, we have that the ordering costs incurred by πu
                      are at most twice the sum of the ordering costs incurred by policies 
                        
                           
                              π
                              ^
                           
                           i
                        
                     .

Therefore if IW
                      ≠ ∅ it only remains to prove that the following inequalities hold:

                        
                           (B.1)
                           
                              
                                 Ψ
                                 
                                    (
                                    
                                       π
                                       u
                                    
                                    )
                                 
                                 ≤
                                 3
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    N
                                 
                                 
                                    
                                       Ψ
                                       ^
                                    
                                    j
                                 
                                 
                                    (
                                    
                                       
                                          π
                                          ^
                                       
                                       j
                                    
                                    )
                                 
                              
                           
                        
                     
                  

Let 
                        
                           i
                           =
                           1
                           …
                           ,
                           N
                        
                      and 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                      and focus on demand point (i, t). Let r be the period when 
                        
                           
                              π
                              ^
                           
                           0
                        
                      orders 
                        
                           d
                           t
                           i
                        
                      and s the period when 
                        
                           
                              π
                              ^
                           
                           i
                        
                      orders 
                        
                           d
                           t
                           i
                        
                      in their single-echelon solution. We now bound the final carrying cost incurred in πu
                      to serve 
                        
                           d
                           t
                           i
                        
                     . Recall that in πu
                     , 
                        
                           d
                           t
                           i
                        
                      is served by the pair ⌈rit, sit
                     ⌋, as defined in Eq. (6). Hence we want to show that for a retailer i and periods t, r, s, the following inequality is satisfied:

                        
                           
                              
                                 
                                    
                                       
                                          
                                             ψ
                                             
                                                
                                                   r
                                                   
                                                      i
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   s
                                                   
                                                      i
                                                      t
                                                   
                                                
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          ≤
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            3
                                                            ·
                                                            
                                                               1
                                                               3
                                                            
                                                            
                                                               ψ
                                                               
                                                                  r
                                                                  t
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            +
                                                            3
                                                            ·
                                                            
                                                               2
                                                               3
                                                            
                                                            
                                                               ψ
                                                               
                                                                  s
                                                                  s
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            =
                                                            
                                                               ψ
                                                               
                                                                  r
                                                                  t
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            +
                                                            2
                                                            
                                                               ψ
                                                               
                                                                  s
                                                                  s
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         i
                                                         ∈
                                                         
                                                            I
                                                            W
                                                         
                                                         
                                                         and
                                                         
                                                         r
                                                         ≤
                                                         t
                                                         
                                                         
                                                         
                                                            (
                                                            B
                                                            .
                                                            2
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            3
                                                            ·
                                                            
                                                               1
                                                               3
                                                            
                                                            
                                                               ψ
                                                               
                                                                  r
                                                                  r
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            +
                                                            3
                                                            ·
                                                            
                                                               2
                                                               3
                                                            
                                                            
                                                               ψ
                                                               
                                                                  s
                                                                  s
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            =
                                                            
                                                               ψ
                                                               
                                                                  r
                                                                  r
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            +
                                                            2
                                                            
                                                               ψ
                                                               
                                                                  s
                                                                  s
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         i
                                                         ∈
                                                         
                                                            I
                                                            W
                                                         
                                                         
                                                         and
                                                         
                                                         r
                                                         >
                                                         t
                                                         
                                                         
                                                         
                                                            (
                                                            B
                                                            .
                                                            3
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            2
                                                            ·
                                                            
                                                               1
                                                               2
                                                            
                                                            
                                                               ψ
                                                               
                                                                  r
                                                                  r
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            +
                                                            2
                                                            ·
                                                            
                                                               1
                                                               2
                                                            
                                                            
                                                               ψ
                                                               
                                                                  s
                                                                  s
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            =
                                                            
                                                               ψ
                                                               
                                                                  r
                                                                  r
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                            +
                                                            
                                                               ψ
                                                               
                                                                  s
                                                                  s
                                                               
                                                               
                                                                  i
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         i
                                                         ∈
                                                         
                                                            I
                                                            J
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                            (
                                                            B
                                                            .
                                                            4
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

If i ∈ IJ
                     , the order of retailer i that serves 
                        
                           d
                           t
                           i
                        
                      in policy πu
                      is synchronized with a warehouse order either in period 
                        
                           
                              s
                           
                           −
                        
                      or 
                        
                           
                              s
                           
                           +
                        
                     . Note that by definition we necessarily have 
                        
                           r
                           ≤
                           
                              
                                 s
                              
                              −
                           
                        
                      if r ≤ s and 
                        
                           r
                           ≥
                           
                              
                                 s
                              
                              +
                           
                        
                      if r > s. Hence if r ≤ s, we have from property (P4)

                        
                           
                              
                                 
                                    
                                       
                                          ψ
                                          
                                             
                                                
                                                   s
                                                
                                                −
                                             
                                             
                                                
                                                   s
                                                
                                                −
                                             
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                    
                                       
                                          ≤
                                          
                                             ψ
                                             
                                                r
                                                r
                                             
                                             
                                                i
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≤
                                          
                                             ψ
                                             
                                                r
                                                r
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          +
                                          
                                             ψ
                                             
                                                s
                                                s
                                             
                                             
                                                i
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     On the other hand if r > s,  πu
                      uses the pair 
                        
                           ⌈
                           
                              
                                 s
                              
                              +
                           
                           ,
                           
                              
                                 s
                              
                              +
                           
                           ⌋
                        
                      to serve 
                        
                           d
                           t
                           i
                        
                      and from property (P2) and (P3) the following inequality holds

                        
                           
                              
                                 
                                    
                                       
                                          ψ
                                          
                                             
                                                
                                                   s
                                                
                                                +
                                             
                                             
                                                
                                                   s
                                                
                                                +
                                             
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                    
                                       
                                          ≤
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         ψ
                                                         
                                                            r
                                                            r
                                                         
                                                         
                                                            i
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         r
                                                         >
                                                         t
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ψ
                                                         
                                                            s
                                                            s
                                                         
                                                         
                                                            i
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≤
                                          max
                                          
                                             {
                                             
                                                ψ
                                                
                                                   r
                                                   r
                                                
                                                
                                                   i
                                                   t
                                                
                                             
                                             ,
                                             
                                                ψ
                                                
                                                   s
                                                   s
                                                
                                                
                                                   i
                                                   t
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≤
                                          
                                             ψ
                                             
                                                r
                                                r
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          +
                                          
                                             ψ
                                             
                                                s
                                                s
                                             
                                             
                                                i
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     Hence if i ∈ IJ
                      inequality  (B.4) is satisfied for all t, r, s.

In the case where i is a W-retailer, we again derive a lower bound for the carrying cost depending on how r,  s and t are ordered. If r ≤ s and r ≤ t, the final cost incurred in πu
                      to serve 
                        
                           d
                           t
                           i
                        
                      is 
                        
                           ψ
                           
                              
                                 
                                    s
                                 
                                 −
                              
                              s
                           
                           
                              i
                              t
                           
                        
                     . Notice that in this case, we have 
                        
                           r
                           ≤
                           
                              
                                 s
                              
                              −
                           
                        
                     . Therefore we can bound the carrying cost incurred to serve demand 
                        
                           d
                           t
                           i
                        
                      using properties (P3), (P4) and (P5) in their turn:

                        
                           
                              
                                 
                                    
                                       
                                          ψ
                                          
                                             
                                                
                                                   s
                                                
                                                −
                                             
                                             s
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                    
                                       
                                          ≤
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            ψ
                                                            
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  −
                                                               
                                                               t
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                         +
                                                         
                                                            ψ
                                                            
                                                               s
                                                               s
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         r
                                                         ≤
                                                         s
                                                         ≤
                                                         t
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ψ
                                                            
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  −
                                                               
                                                               t
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                         +
                                                         
                                                            ψ
                                                            
                                                               t
                                                               s
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         r
                                                         ≤
                                                         t
                                                         <
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≤
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            ψ
                                                            
                                                               r
                                                               t
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                         +
                                                         
                                                            ψ
                                                            
                                                               s
                                                               s
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         r
                                                         ≤
                                                         s
                                                         ≤
                                                         t
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ψ
                                                            
                                                               r
                                                               t
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                         +
                                                         
                                                            ψ
                                                            
                                                               t
                                                               s
                                                            
                                                            
                                                               i
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         r
                                                         ≤
                                                         t
                                                         <
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≤
                                          
                                             ψ
                                             
                                                r
                                                t
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          +
                                          2
                                          
                                             ψ
                                             
                                                s
                                                s
                                             
                                             
                                                i
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     On the other hand if t < r ≤ s, properties (P3) and (P5) ensure that

                        
                           
                              
                                 
                                    
                                       
                                          ψ
                                          
                                             
                                                
                                                   s
                                                
                                                −
                                             
                                             s
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                    
                                       
                                          ≤
                                          
                                             ψ
                                             
                                                t
                                                s
                                             
                                             
                                                i
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≤
                                          2
                                          
                                             ψ
                                             
                                                s
                                                s
                                             
                                             
                                                i
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≤
                                          
                                             ψ
                                             
                                                r
                                                r
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          +
                                          2
                                          
                                             ψ
                                             
                                                s
                                                s
                                             
                                             
                                                i
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     Finally if r > s, we use properties (P2) and (P3) to bound the final carrying cost:

                        
                           
                              
                                 
                                    
                                       
                                          ψ
                                          
                                             
                                                
                                                   s
                                                
                                                +
                                             
                                             
                                                
                                                   s
                                                
                                                +
                                             
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                    
                                       
                                          ≤
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         ψ
                                                         
                                                            r
                                                            r
                                                         
                                                         
                                                            i
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         t
                                                         <
                                                         
                                                            
                                                               s
                                                            
                                                            +
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ψ
                                                         
                                                            s
                                                            s
                                                         
                                                         
                                                            i
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≤
                                          max
                                          
                                             {
                                             
                                                ψ
                                                
                                                   r
                                                   r
                                                
                                                
                                                   i
                                                   t
                                                
                                             
                                             ,
                                             
                                                ψ
                                                
                                                   s
                                                   s
                                                
                                                
                                                   i
                                                   t
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≤
                                          
                                             ψ
                                             
                                                r
                                                r
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          +
                                          
                                             ψ
                                             
                                                s
                                                s
                                             
                                             
                                                i
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     We conclude that if i ∈ IW
                      inequalities (B.2) and (B.3) are satisfied.

Therefore if πu
                      uses the pair of orders ⌈rit, sit
                     ⌋, inequalities (B.2), (B.3) and (B.4) are always satisfied. As a consequence inequality (D.1) holds and the proof follows:

                        
                           
                              
                                 C
                                 
                                    (
                                    
                                       π
                                       u
                                    
                                    )
                                 
                                 ≤
                                 3
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    N
                                 
                                 
                                    
                                       Ψ
                                       ^
                                    
                                    j
                                 
                                 
                                    (
                                    
                                       
                                          π
                                          ^
                                       
                                       j
                                    
                                    )
                                 
                                 +
                                 
                                    K
                                    0
                                 
                                 
                                    (
                                    
                                       
                                          π
                                          ^
                                       
                                       0
                                    
                                    )
                                 
                                 +
                                 2
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    K
                                    i
                                 
                                 
                                    (
                                    
                                       
                                          π
                                          ^
                                       
                                       i
                                    
                                    )
                                 
                              
                           
                        
                     
                  

To conclude the proof, notice that when 
                        
                           
                              I
                              W
                           
                           =
                           ∅
                           ,
                        
                      inequality  (B.3) implies that

                        
                           
                              
                                 Ψ
                                 
                                    (
                                    
                                       π
                                       u
                                    
                                    )
                                 
                                 ≤
                                 2
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    N
                                 
                                 
                                    
                                       Ψ
                                       ^
                                    
                                    j
                                 
                                 
                                    (
                                    
                                       
                                          π
                                          ^
                                       
                                       j
                                    
                                    )
                                 
                              
                           
                        
                     and thus one can modify the upper bound in the special case of the JRP:

                        
                           
                              
                                 C
                                 
                                    (
                                    
                                       π
                                       u
                                    
                                    )
                                 
                                 ≤
                                 2
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    N
                                 
                                 
                                    
                                       Ψ
                                       ^
                                    
                                    j
                                 
                                 
                                    (
                                    
                                       
                                          π
                                          ^
                                       
                                       j
                                    
                                    )
                                 
                                 +
                                 
                                    K
                                    0
                                 
                                 
                                    (
                                    
                                       
                                          π
                                          ^
                                       
                                       0
                                    
                                    )
                                 
                                 +
                                 2
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    K
                                    i
                                 
                                 
                                    (
                                    
                                       
                                          π
                                          ^
                                       
                                       i
                                    
                                    )
                                 
                              
                           
                        
                     
                  

We prove this inequality in a similar manner as we did for Lemma 1. Consider an optimal policy 
                        
                           
                              π
                              OPT
                           
                           =
                           
                              (
                              
                                 π
                                 0
                                 OPT
                              
                              ,
                              
                                 π
                                 1
                                 OPT
                              
                              ,
                              …
                              ,
                              
                                 π
                                 N
                                 OPT
                              
                              )
                           
                        
                      for the OWMR system with lost-sales. For all 
                        
                           j
                           =
                           0
                           ,
                           …
                           ,
                           N
                           ,
                        
                      we define 
                        
                           
                              π
                              ¯
                           
                           j
                        
                      as the policy that orders in the same periods as 
                        
                           π
                           j
                           OPT
                        
                      and fills or looses demands exactly as the latter does. Obviously, we again have 
                        
                           K
                           
                              (
                              
                                 π
                                 OPT
                              
                              )
                           
                           =
                           
                              ∑
                              
                                 j
                                 =
                                 0
                              
                              N
                           
                           
                              K
                              j
                           
                           
                              (
                              
                                 
                                    π
                                    ¯
                                 
                                 j
                              
                              )
                           
                        
                     . We now prove that 
                        
                           
                              ∑
                              
                                 j
                                 =
                                 0
                              
                              N
                           
                           
                              Ψ
                              j
                           
                           
                              (
                              
                                 
                                    π
                                    ¯
                                 
                                 j
                              
                              )
                           
                           ≤
                           Ψ
                           
                              (
                              
                                 π
                                 OPT
                              
                              )
                           
                        
                     . Consider a retailer i and a demand point (i, t). If 
                        
                           d
                           t
                           i
                        
                      is lost in π
                     OPT, then by construction it is lost in 
                        
                           
                              π
                              ¯
                           
                           0
                        
                      and 
                        
                           
                              π
                              ¯
                           
                           i
                        
                      and we directly have:

                        
                           (C.1)
                           
                              
                                 
                                    ψ
                                    
                                       i
                                       t
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    ψ
                                    
                                       i
                                       t
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    ψ
                                    
                                       i
                                       t
                                    
                                 
                              
                           
                        
                     
                  

Now assume the demand is filled and let r and s be the periods when π
                     OPT orders 
                        
                           d
                           t
                           i
                        
                      at the warehouse and at the retailer, respectively. The holding cost incurred by π
                     OPT for 
                        
                           d
                           t
                           i
                        
                      is equal to 
                        
                           ψ
                           
                              r
                              s
                           
                           
                              i
                              t
                           
                        
                     . If i is a J-retailer, we have 
                        
                           r
                           =
                           s
                        
                      and therefore

                        
                           (C.2)
                           
                              
                                 
                                    ψ
                                    
                                       r
                                       s
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 =
                                 
                                    ψ
                                    
                                       r
                                       r
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 =
                                 
                                    ψ
                                    
                                       s
                                       s
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    ψ
                                    
                                       r
                                       r
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    ψ
                                    
                                       s
                                       s
                                    
                                    
                                       i
                                       t
                                    
                                 
                              
                           
                        
                     On the other hand if i is a W-retailer, we can bound this cost using properties (P2) and (P3):

                        
                           (C.3)
                           
                              
                                 
                                    
                                       
                                          ψ
                                          
                                             r
                                             s
                                          
                                          
                                             i
                                             t
                                          
                                       
                                    
                                    
                                       
                                          ≥
                                          max
                                          
                                             {
                                             
                                                ψ
                                                
                                                   r
                                                   t
                                                
                                                
                                                   i
                                                   t
                                                
                                             
                                             ,
                                             
                                                ψ
                                                
                                                   s
                                                   s
                                                
                                                
                                                   i
                                                   t
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≥
                                          
                                             1
                                             2
                                          
                                          
                                             ψ
                                             
                                                r
                                                t
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             ψ
                                             
                                                s
                                                s
                                             
                                             
                                                i
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     In both cases, the sum of the holding costs incurred by 
                        
                           
                              π
                              ¯
                           
                           0
                        
                      and 
                        
                           
                              π
                              ¯
                           
                           i
                        
                      to serve demand (i, t) in systems 
                        
                           (
                           
                              
                                 S
                                 ˜
                              
                              0
                           
                           )
                        
                      and 
                        
                           (
                           
                              
                                 S
                                 ˜
                              
                              i
                           
                           )
                        
                      is lower than or equal to the cost incurred in π
                     OPT to serve the same demand. Therefore from equations (C.1), (C.2) and (C.3) we conclude 
                        
                           Ψ
                           
                              (
                              
                                 π
                                 OPT
                              
                              )
                           
                           ≥
                           
                              ∑
                              
                                 j
                                 =
                                 0
                              
                              N
                           
                           
                              Ψ
                              j
                           
                           
                              (
                              
                                 
                                    π
                                    ¯
                                 
                                 j
                              
                              )
                           
                        
                     . The optimality of policies 
                        
                           
                              π
                              ˜
                           
                           j
                           *
                        
                      for problems 
                        
                           (
                           
                              
                                 S
                                 ˜
                              
                              j
                           
                           )
                        
                      then yields:

                        
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                0
                                             
                                             N
                                          
                                          
                                             C
                                             j
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ˜
                                                
                                                j
                                                *
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ≤
                                          
                                             ∑
                                             
                                                j
                                                =
                                                0
                                             
                                             N
                                          
                                          C
                                          
                                             (
                                             
                                                
                                                   π
                                                   ¯
                                                
                                                j
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          =
                                          
                                             ∑
                                             
                                                j
                                                =
                                                0
                                             
                                             N
                                          
                                          
                                             K
                                             j
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ¯
                                                
                                                j
                                             
                                             )
                                          
                                          +
                                          
                                             Ψ
                                             j
                                          
                                          
                                             (
                                             
                                                
                                                   π
                                                   ¯
                                                
                                                j
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≤
                                          K
                                          
                                             (
                                             
                                                π
                                                OPT
                                             
                                             )
                                          
                                          +
                                          Ψ
                                          
                                             (
                                             
                                                π
                                                OPT
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≤
                                          
                                             C
                                             *
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

To prove the feasibility of the resulting policy, we refer the reader to the proof of Lemma 2. Similarly, it is straightforward to see that 
                        
                           K
                           
                              (
                              
                                 
                                    π
                                    ˜
                                 
                                 u
                              
                              )
                           
                           ≤
                           
                              K
                              0
                           
                           
                              (
                              
                                 
                                    π
                                    ˜
                                 
                                 0
                              
                              )
                           
                           +
                           2
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              N
                           
                           
                              K
                              i
                           
                           
                              (
                              
                                 
                                    π
                                    ˜
                                 
                                 i
                              
                              )
                           
                           ,
                        
                      since for every order in 
                        
                           
                              π
                              ˜
                           
                           i
                        
                      the algorithm places at most two orders in the final policy 
                        
                           
                              π
                              ˜
                           
                           u
                        
                     . Therefore we only have to prove that

                        
                           (D.1)
                           
                              
                                 Ψ
                                 
                                    (
                                    
                                       
                                          π
                                          ˜
                                       
                                       u
                                    
                                    )
                                 
                                 ≤
                                 2
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    N
                                 
                                 
                                    Ψ
                                    j
                                 
                                 
                                    (
                                    
                                       
                                          π
                                          ˜
                                       
                                       j
                                    
                                    )
                                 
                              
                           
                        
                     
                  

Let 
                        
                           i
                           =
                           1
                           …
                           ,
                           N
                        
                      and 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                      and focus on demand point (i, t). If the 
                        
                           d
                           t
                           i
                        
                      is lost in 
                        
                           
                              π
                              ˜
                           
                           0
                        
                      or 
                        
                           
                              
                                 π
                                 ˜
                              
                              i
                           
                           ,
                        
                      it incurs a cost of at least 
                        
                           
                              1
                              2
                           
                           
                              ψ
                              
                                 i
                                 t
                              
                           
                        
                      in these policies. Since by construction it is also lost in 
                        
                           
                              
                                 π
                                 ˜
                              
                              u
                           
                           ,
                        
                      it incurs a cost of exactly ψit
                      in the final solution. Now assume the demand is filled both in 
                        
                           
                              π
                              ˜
                           
                           0
                        
                      and 
                        
                           
                              π
                              ˜
                           
                           i
                        
                      and let r and s be the respective ordering periods of these policies for this demand. We want to prove that the final holding cost incurred in 
                        
                           
                              π
                              ˜
                           
                           u
                        
                      to serve 
                        
                           d
                           t
                           i
                        
                      is at most the sum of the holding cost it incurs in policies  
                        
                           
                              π
                              ˜
                           
                           0
                        
                      and 
                        
                           
                              π
                              ˜
                           
                           i
                        
                     .

This final cost depends on the path followed by the units in the system after applying the uncrossing policy. Specifically, we want to compare this cost with the cost of the paths the same units follow in the single echelon policies 
                        
                           
                              π
                              ˜
                           
                           0
                        
                      and 
                        
                           
                              π
                              ˜
                           
                           i
                        
                     . We distinguish several cases depending on the type of retailer and on the respective position of r and s (see also Fig. D.2
                      for a specific example of units path in each case):

                        
                           •
                           If i ∈ IJ
                               and r ≤ s,  
                                 
                                    
                                       π
                                       ˜
                                    
                                    u
                                 
                               orders 
                                 
                                    d
                                    t
                                    i
                                 
                               in period 
                                 
                                    
                                       s
                                    
                                    −
                                 
                               at the warehouse and at the retailer for a final cost of 
                                 
                                    ψ
                                    
                                       
                                          
                                             s
                                          
                                          −
                                       
                                       
                                          
                                             s
                                          
                                          −
                                       
                                    
                                    
                                       i
                                       t
                                    
                                 
                              . The holding cost incurred by policy 
                                 
                                    
                                       π
                                       ˜
                                    
                                    0
                                 
                               (resp. 
                                 
                                    
                                       π
                                       ˜
                                    
                                    i
                                 
                              ) to serve this demand is equal to 
                                 
                                    ψ
                                    
                                       r
                                       r
                                    
                                    
                                       i
                                       t
                                    
                                 
                               (resp. 
                                 
                                    ψ
                                    
                                       s
                                       s
                                    
                                    
                                       i
                                       t
                                    
                                 
                              ). Since 
                                 
                                    
                                       
                                          s
                                       
                                       −
                                    
                                    ≥
                                    r
                                    ,
                                 
                               we have from property (P3):

                                 
                                    (D.2)
                                    
                                       
                                          
                                             
                                                
                                                   ψ
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         −
                                                      
                                                      
                                                         
                                                            s
                                                         
                                                         −
                                                      
                                                   
                                                   
                                                      i
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   ≤
                                                   
                                                      ψ
                                                      
                                                         r
                                                         r
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   ≤
                                                   
                                                      ψ
                                                      
                                                         r
                                                         r
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      ψ
                                                      
                                                         s
                                                         s
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

If i ∈ IJ
                               and r > s,  
                                 
                                    
                                       π
                                       ˜
                                    
                                    u
                                 
                               orders the demand in period 
                                 
                                    
                                       s
                                    
                                    +
                                 
                               at the warehouse and at the retailer for a final cost of 
                                 
                                    ψ
                                    
                                       
                                          
                                             s
                                          
                                          +
                                       
                                       
                                          
                                             s
                                          
                                          +
                                       
                                    
                                    
                                       i
                                       t
                                    
                                 
                              . The holding cost incurred by policy 
                                 
                                    
                                       π
                                       ˜
                                    
                                    0
                                 
                               (resp. 
                                 
                                    
                                       π
                                       ˜
                                    
                                    i
                                 
                              ) to serve this demand is equal to 
                                 
                                    ψ
                                    
                                       r
                                       r
                                    
                                    
                                       i
                                       t
                                    
                                 
                               (resp. 
                                 
                                    ψ
                                    
                                       s
                                       s
                                    
                                    
                                       i
                                       t
                                    
                                 
                              ). Since 
                                 
                                    
                                       
                                          s
                                       
                                       +
                                    
                                    ≥
                                    s
                                    ,
                                 
                               we have from property (P3):

                                 
                                    (D.3)
                                    
                                       
                                          
                                             
                                                
                                                   ψ
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         +
                                                      
                                                      
                                                         
                                                            s
                                                         
                                                         +
                                                      
                                                   
                                                   
                                                      i
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   ≤
                                                   
                                                      ψ
                                                      
                                                         s
                                                         s
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   ≤
                                                   
                                                      ψ
                                                      
                                                         r
                                                         r
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      ψ
                                                      
                                                         s
                                                         s
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

If i ∈ IW
                               and r ≤ s,  
                                 
                                    
                                       π
                                       ˜
                                    
                                    u
                                 
                               orders the demand in period 
                                 
                                    
                                       s
                                    
                                    −
                                 
                               at the warehouse and in period s at the retailer for a final cost of 
                                 
                                    ψ
                                    
                                       
                                          
                                             s
                                          
                                          −
                                       
                                       s
                                    
                                    
                                       i
                                       t
                                    
                                 
                              . Recall that by definition, we have 
                                 
                                    r
                                    ≤
                                    
                                       
                                          s
                                       
                                       −
                                    
                                 
                              . The holding cost incurred by policy 
                                 
                                    
                                       π
                                       ˜
                                    
                                    0
                                 
                               (resp. 
                                 
                                    
                                       π
                                       ˜
                                    
                                    i
                                 
                              ) to serve this demand is equal to 
                                 
                                    ψ
                                    
                                       r
                                       t
                                    
                                    
                                       i
                                       t
                                    
                                 
                               (resp. 
                                 
                                    ψ
                                    
                                       s
                                       s
                                    
                                    
                                       i
                                       t
                                    
                                 
                              ). Thus we have from property (P3) and (P4):

                                 
                                    (D.4)
                                    
                                       
                                          
                                             ψ
                                             
                                                
                                                   
                                                      s
                                                   
                                                   −
                                                
                                                s
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          ≤
                                          
                                             ψ
                                             
                                                r
                                                s
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          ≤
                                          
                                             ψ
                                             
                                                r
                                                t
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          +
                                          
                                             ψ
                                             
                                                s
                                                s
                                             
                                             
                                                i
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           

If i ∈ IW
                               and s < r,  
                                 
                                    
                                       π
                                       ˜
                                    
                                    u
                                 
                               orders the demand in period 
                                 
                                    
                                       s
                                    
                                    +
                                 
                               at the warehouse and at the retailer for a final cost of 
                                 
                                    ψ
                                    
                                       
                                          
                                             s
                                          
                                          +
                                       
                                       
                                          
                                             s
                                          
                                          +
                                       
                                    
                                    
                                       i
                                       t
                                    
                                 
                              . The holding cost incurred by policy 
                                 
                                    
                                       π
                                       ˜
                                    
                                    0
                                 
                               (resp. 
                                 
                                    
                                       π
                                       ˜
                                    
                                    i
                                 
                              ) to serve this demand is equal to 
                                 
                                    ψ
                                    
                                       r
                                       t
                                    
                                    
                                       i
                                       t
                                    
                                 
                               (resp. 
                                 
                                    ψ
                                    
                                       s
                                       s
                                    
                                    
                                       i
                                       t
                                    
                                 
                              ). Since 
                                 
                                    
                                       
                                          s
                                       
                                       +
                                    
                                    >
                                    s
                                 
                               we have from property (P3):

                                 
                                    (D.5)
                                    
                                       
                                          
                                             
                                                
                                                   ψ
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         +
                                                      
                                                      
                                                         
                                                            s
                                                         
                                                         +
                                                      
                                                   
                                                   
                                                      i
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   ≤
                                                   
                                                      ψ
                                                      
                                                         s
                                                         s
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   ≤
                                                   
                                                      ψ
                                                      
                                                         r
                                                         t
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      ψ
                                                      
                                                         s
                                                         s
                                                      
                                                      
                                                         i
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Note that in inequalities (D.2)–(D.5), the right-hand side corresponds exactly to twice the sum of the holding cost incurred in policy 
                        
                           
                              π
                              ˜
                           
                           0
                        
                      and 
                        
                           
                              π
                              ˜
                           
                           i
                        
                      to serve demand 
                        
                           d
                           t
                           i
                        
                     . As a consequence in all cases the holding or penalty cost incurred to serve or loose this demand in 
                        
                           
                              π
                              ˜
                           
                           u
                        
                      is at most twice the sum of the costs incurred for the same demand in policies 
                        
                           
                              π
                              ˜
                           
                           0
                        
                      and 
                        
                           
                              π
                              ˜
                           
                           i
                        
                     . We conclude that inequality (D.1) holds and the proof follows.

@&#REFERENCES@&#

