@&#MAIN-TITLE@&#A frequency domain test for detecting nonstationary time series

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a frequency domain test against nonstationarity in time series.


                        
                        
                           
                           The test is based on comparing the goodness of fit in log-periodogram regression.


                        
                        
                           
                           The regression model is the varying coefficient fractionally exponential model.


                        
                        
                           
                           The test is applicable for dynamic changes of both short and long range dependences.


                        
                        
                           
                           The finite sample test distribution is approximated by bootstrap.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Fractionally exponential model

Local polynomial estimation

Local periodogram estimate

Log-periodogram regression

@&#ABSTRACT@&#


               
               
                  We propose a frequency domain generalized likelihood ratio test for testing nonstationarity in time series. The test is constructed in the frequency domain by comparing the goodness of fit in the log-periodogram regression under the varying coefficient fractionally exponential models. Under such a locally stationary specification, the proposed test is capable of detecting dynamic changes of short-range and long-range dependences in a regression framework. The asymptotic distribution of the proposed test statistic is known under the null stationarity hypothesis, and its finite sample distribution can be approximated by bootstrap. Numerical results show that the proposed test has good power against a wide range of locally stationary alternatives.
               
            

@&#INTRODUCTION@&#

The stationarity assumption plays an essential role in making inference for time series analysis. Under this assumption, statistical properties such as consistency and asymptotic normality hold for standard inference in time series analysis, based only on one realization. However, the stationarity assumption might not be realistic in practice, especially when the observed time span is long or the series is apparently affected by some natural factors. For example, the influenza-like illness incidence has different dynamics during the epidemic period and non-epidemic period; the tree ring data exhibit time varying dynamics due to different weather and environmental conditions over the years. As another example in finance, volatilities of returns usually exhibit strong dependencies but the level of persistence is likely to change over time due to numerous unpredictable economic factors (Ray and Tsay, 2002).

In order to validate the analysis based on stationary modeling, some preliminary checking of stationarity is necessary. Usually, visualizing the time series plot is a useful way of spotting certain types of nonstationarity such as the mean and variance change over time, but this naive method makes somehow difficult to explore more complex dynamic changes in the dependence structures. An alternative approach for checking stationarity is through the hypothesis testing. In the literature, there are various tests under different specifications of nonstationarity. Early development focused on the change point problem subject to a specific parameter under a fully parametric setting (Inclán and Tiao, 1994). Recent research focuses on nonstationary modeling with slowly varying dependence structures. The pioneering work in this area was given by Priestley (1965) by introducing the evolutionary spectrum with the power-frequency analog of stationary spectrum under a time-dependent framework. Later, Priestley and Subba Rao (1969) further developed an analysis of variance (ANOVA) procedure to test the homogeneity of evolutionary spectra. This test is easy to implement and is particularly powerful for detecting nonstationarity against a uniformly modulated process. However, due to completely unspecified time-frequency interactions in the ANOVA model, this ANOVA test is less powerful against other types of nonstationarity, such as the class of varying coefficient AR models.

In contrast to Priestley’s approach, Dahlhaus (1997) gave an alternative specification for the locally stationary process with smoothly varying spectra. The well-developed asymptotic theories under this local stationarity framework bring about its popularity among other approaches in the literature (e.g.  Adak, 1998; Guo et al., 2003; Nason et al., 2000; Davis et al., 2006). Accordingly, several testing procedures for detecting nonstationarity are constructed under Dahlhaus’s locally stationary framework. Sakiyama and Taniguchi (2003) proposed the likelihood ratio test, Wald test and Lagrange multiplier test for testing a specific structure in a locally stationary Gaussian process. These likelihood-based tests require fully specified hypotheses and the results are often sensitive to model mis-specification. Sergides and Paparoditis (2009) proposed a more general procedure for detecting local stationarity based on a goodness of fit measure, which allows a semiparametric specification for the null model against a unspecified locally stationary alternative model. Similar idea was also applied for validating and monitoring stationarity for a process over time (Paparoditis, 2010).

Among the studies for testing nonstationarity, most of the interest focuses on the changes of short-range dependence while the issue concerning long-memory nonstationarity is rarely addressed. Regarding such issue, change point approaches have been suggested under fully parametric settings (e.g.  Beran and Terrin, 1996; Ray and Tsay, 2002). Recently, Beran (2009) incorporated long-memory structure into the locally stationary process framework in a time domain approach, which mainly concerned on estimation problems rather than hypothesis testing issues.

In this paper, we propose a general testing procedure which aims to detect the dynamic change for both short-memory and long-memory structures. Our approach is built on a semiparametric class of models, called varying-coefficient fractionally exponential (VC-FEXP) models, whose specification is extended from a stationary fractionally exponential (FEXP) model of Beran (1993) by allowing parameters in the spectra to vary smoothly over time. This VC-FEXP model is appealing not only because the specification is very flexible but also because the corresponding inference can be carried out in a regression framework. The regression used here is a time-varying version of the log-periodogram regression. Under this regression framework, we suggest a generalized goodness-of-fit test to detect various aspects of nonstationarity.

The rest of the paper is organized as follows. In Section  2, the proposed VC-FEXP model is introduced, under which the varying-coefficient log-periodogram regression and the corresponding local linear fitting are described. Section  3 defines the hypotheses and the test statistic for detecting nonstationarity. Numerical results are reported in Section  4, including a real data example. Section  5 is the summary.

For the purpose of testing stationarity, we first suggest a general family of nonstationary models represented via time-varying spectra in a locally stationary process framework. This general alternative model, called the varying-coefficient FEXP (VC-FEXP), is a natural generalization of the FEXP model (Beran, 1993) by allowing parameters to vary smoothly over time. Specifically, a VC-FEXP model is defined via the following time-varying spectra: 
                        
                           (1)
                           
                              
                                 
                                    f
                                 
                                 
                                    t
                                 
                              
                              
                                 (
                                 ω
                                 )
                              
                              ≡
                              f
                              
                                 (
                                 ω
                                 ;
                                 
                                    θ
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       |
                                       1
                                       −
                                       
                                          
                                             e
                                          
                                          
                                             i
                                             ω
                                          
                                       
                                       |
                                    
                                 
                                 
                                    −
                                    2
                                    d
                                    
                                       (
                                       u
                                       )
                                    
                                 
                              
                              exp
                              
                                 {
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    ω
                                    )
                                 
                                 }
                              
                              ,
                              
                              u
                              =
                              t
                              /
                              T
                              ∈
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                              ,
                           
                        
                      where the time index 
                        t
                      is represented by the re-scaled time 
                        u
                        =
                        t
                        /
                        T
                        ,
                        
                           
                              ψ
                           
                           
                              0
                           
                        
                        
                           (
                           ω
                           )
                        
                        =
                        1
                      and 
                        
                           {
                           
                              
                                 ψ
                              
                              
                                 k
                              
                           
                           
                              (
                              ⋅
                              )
                           
                           :
                           k
                           =
                           1
                           ,
                           …
                           ,
                           p
                           }
                        
                      are some continuous and even functions defined on 
                        
                           [
                           −
                           π
                           ,
                           π
                           ]
                        
                      satisfying 
                        
                           
                              ∫
                           
                           
                              0
                           
                           
                              π
                           
                        
                        
                           
                              ψ
                           
                           
                              k
                           
                           
                              2
                           
                        
                        
                           (
                           ω
                           )
                        
                        d
                        ω
                        <
                        ∞
                     . 
                        d
                        
                           (
                           u
                           )
                        
                      and 
                        
                           θ
                        
                        
                           (
                           u
                           )
                        
                        ≡
                        
                           
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       p
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 )
                              
                           
                           
                              ′
                           
                        
                     , having continuous second derivatives, characterize the long-range and short-range dependence structures of the underlying process respectively.

When 
                        d
                        
                           (
                           u
                           )
                        
                        =
                        d
                        ,
                        
                           
                              θ
                           
                           
                              k
                           
                        
                        
                           (
                           u
                           )
                        
                        =
                        
                           
                              θ
                           
                           
                              k
                           
                        
                      and 
                        
                           
                              ψ
                           
                           
                              k
                           
                        
                        
                           (
                           ω
                           )
                        
                        =
                        cos
                        
                           (
                           k
                           ω
                           )
                        
                     , this generalized model (1) reduces to the FEXP model (Beran, 1993) as a special case, which has a very flexible form of approximating a variety of short-range and long-range dependence structures for a stationary process. In addition, FEXP plays an important role on long-memory parameter estimation (Beran, 1993; Hurvich and Brodsky, 2001). Inherited from these advantages associated with FEXP models, the VC-FEXP model not only provides a flexible semiparametric family for approximating locally stationary processes but also serves as a general alternative model for testing nonstationarity by examining the homogeneity of the coefficient functions 
                        d
                        
                           (
                           u
                           )
                        
                      and 
                        
                           θ
                        
                        
                           (
                           u
                           )
                        
                     .

Regarding the model fitting, since the VC-FEXP model is specified in the frequency domain, it is natural to use the log-periodogram regression for estimating the time-varying spectra. In Section  2.1, a customized log-periodogram regression is introduced and the time-varying coefficient functions are estimated using the local polynomial fitting described in Section  2.2.

For the ease of illustration, we first review the log-periodogram regression for a stationary FEXP process and then give an analogous version for a locally stationary VC-FEXP process. Assume that a time series data 
                           
                              {
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              :
                              t
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              T
                              }
                           
                         are observed and define the periodogram ordinates 
                           
                              
                                 I
                                 
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          ℓ
                                          ,
                                          T
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          2
                                          π
                                          T
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          |
                                          
                                             
                                                ∑
                                             
                                             
                                                t
                                                =
                                                1
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                −
                                                i
                                                t
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      ℓ
                                                      ,
                                                      T
                                                   
                                                
                                             
                                          
                                          |
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       ℓ
                                       ,
                                       T
                                    
                                 
                                 =
                                 2
                                 π
                                 ℓ
                                 /
                                 T
                                 ,
                                 
                                 ℓ
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    [
                                    
                                       (
                                       T
                                       −
                                       1
                                       )
                                    
                                    /
                                    2
                                    ]
                                 
                                 .
                              
                           
                         Under a stationary FEXP model, it is well known that 
                           I
                           
                              (
                              
                                 
                                    ω
                                 
                                 
                                    ℓ
                                    ,
                                    T
                                 
                              
                              )
                           
                         satisfies the log-periodogram regression: 
                           
                              (2)
                              
                                 log
                                 I
                                 
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          ℓ
                                          ,
                                          T
                                       
                                    
                                    )
                                 
                                 =
                                 log
                                 f
                                 
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          ℓ
                                          ,
                                          T
                                       
                                    
                                    ;
                                    
                                       θ
                                    
                                    )
                                 
                                 +
                                 log
                                 
                                    
                                       Z
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 γ
                                 −
                                 2
                                 d
                                 log
                                 
                                    |
                                    1
                                    −
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          
                                             
                                                ω
                                             
                                             
                                                ℓ
                                                ,
                                                T
                                             
                                          
                                       
                                    
                                    |
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          ℓ
                                          ,
                                          T
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       ϵ
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                              
                           
                         where 
                           f
                           
                              (
                              ω
                              ;
                              
                                 θ
                              
                              )
                           
                         is the spectral density of the FEXP process, 
                           
                              {
                              
                                 
                                    Z
                                 
                                 
                                    ℓ
                                 
                              
                              }
                           
                         are asymptotically independent and identically distributed (iid) from 
                           
                              
                                 χ
                              
                              
                                 2
                              
                              
                                 2
                              
                           
                           /
                           2
                         with 
                           E
                           
                              [
                              log
                              
                                 
                                    χ
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              /
                              2
                              ]
                           
                           ≡
                           γ
                         the Euler’s constant, 
                           
                              
                                 ϵ
                              
                              
                                 ℓ
                              
                           
                           ≡
                           log
                           
                              
                                 Z
                              
                              
                                 ℓ
                              
                           
                           −
                           γ
                         and 
                           
                              {
                              
                                 
                                    ϵ
                                 
                                 
                                    ℓ
                                 
                              
                              }
                           
                         are nearly iid random errors. Under (2) and the given basis functions 
                           
                              
                                 ψ
                              
                              
                                 k
                              
                           
                           
                              (
                              ⋅
                              )
                           
                        ’s, the regression coefficients 
                           d
                         and 
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                         can easily be estimated by the ordinary least squares. This least squares approach has been widely used in the literature for estimating the spectral density of a stationary processes. In particular, it provides an easy-to-use semiparametric estimation for the long-memory parameter (Geweke and Porter-Hudak, 1983; Beran, 1993; Robinson, 1995; Moulines and Soulier, 1999; Hurvich and Brodsky, 2001).

Following similar ideas, the conventional log-periodogram regression (2) is adapted for a locally stationary VC-FEXP process 
                           
                              {
                              
                                 
                                    X
                                 
                                 
                                    t
                                    ,
                                    T
                                 
                              
                              :
                              t
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              T
                              }
                           
                         to account for time-varying spectra (1). Since the coefficient functions 
                           d
                           
                              (
                              u
                              )
                           
                         and 
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                           
                              (
                              u
                              )
                           
                         in (1) are smoothly varying, the process is nearly stationary within a short period of time. Therefore, under the consideration of suitable localized periodogram estimates, a time-frequency version of (2) can be developed. In this work, we consider two types of local periodogram estimates: the blockwise periodogram estimate and its smoothed version. To define these two estimates, we need the following notations. Let 
                           N
                         be an integer as the block size, 
                           M
                         be an integer as the number of blocks, 
                           
                              
                                 t
                              
                              
                                 j
                              
                           
                         be the midpoint of the 
                           j
                        th block of size 
                           N
                         under which 
                           
                              {
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              :
                              j
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              M
                              }
                           
                         are regularly spaced in the observed time span with a fixed interval 
                           S
                           =
                           
                              
                                 t
                              
                              
                                 j
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 t
                              
                              
                                 j
                              
                           
                        . For notational simplicity and without ambiguity, we assume 
                           N
                         is even in the following descriptions. The time index set for the 
                           j
                        th block is defined by 
                           
                              
                                 B
                              
                              
                                 j
                              
                           
                           =
                           
                              {
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              −
                              
                                 [
                                 N
                                 /
                                 2
                                 ]
                              
                              +
                              1
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              +
                              
                                 [
                                 N
                                 /
                                 2
                                 ]
                              
                              }
                           
                        . The blockwise periodogram estimate is defined as the conventional periodogram ordinate within each block, i.e., 
                           
                              (3)
                              
                                 I
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          ω
                                       
                                       
                                          ℓ
                                          ,
                                          N
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          2
                                          π
                                          N
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          |
                                          
                                             
                                                ∑
                                             
                                             
                                                s
                                                =
                                                0
                                             
                                             
                                                N
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                   
                                                
                                                −
                                                
                                                   [
                                                   N
                                                   /
                                                   2
                                                   ]
                                                
                                                +
                                                s
                                                +
                                                1
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                −
                                                i
                                                s
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      ℓ
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          |
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         for the 
                           j
                        th block, where the locally stationary series 
                           
                              
                                 X
                              
                              
                                 t
                                 ,
                                 T
                              
                           
                         is abbreviated as 
                           
                              
                                 X
                              
                              
                                 t
                              
                           
                         for short and 
                           
                              
                                 ω
                              
                              
                                 ℓ
                                 ,
                                 N
                              
                           
                           =
                           2
                           π
                           ℓ
                           /
                           N
                        , for 
                           ℓ
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           
                              [
                              N
                              /
                              2
                              ]
                           
                        . When the block size 
                           N
                         is relatively small compared to 
                           T
                        , the data associated with each block is roughly stationary and 
                           I
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    ℓ
                                    ,
                                    N
                                 
                              
                              )
                           
                         provides a naive estimate for the time-varying spectra around time 
                           
                              
                                 t
                              
                              
                                 j
                              
                           
                        .


                        Dahlhaus (1997) suggested a tapered local periodogram estimate: 
                           
                              (4)
                              
                                 I
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          ω
                                       
                                       
                                          ℓ
                                          ,
                                          N
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      s
                                                      =
                                                      0
                                                   
                                                   
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                H
                                                
                                                   (
                                                   s
                                                   /
                                                   N
                                                   )
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         [
                                                         N
                                                         /
                                                         2
                                                         ]
                                                      
                                                      +
                                                      s
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      −
                                                      i
                                                      s
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            ℓ
                                                            ,
                                                            N
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       π
                                       
                                          
                                             ∑
                                          
                                          
                                             s
                                             =
                                             0
                                          
                                          
                                             N
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          s
                                          /
                                          N
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           H
                           
                              (
                              ⋅
                              )
                           
                           >
                           0
                         is a taper function, which is essentially a smoothed version of the blockwise estimate in (3). Later in our numerical analysis, we use the Tukey–Hanning taper function in (4): 
                           
                              
                                 H
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    1
                                    −
                                    cos
                                    2
                                    π
                                    u
                                    )
                                 
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          {
                                          0
                                          ≤
                                          u
                                          <
                                          1
                                          }
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Given the local periodogram estimates (3) or (4), a time-varying version of the log-periodogram regression is developed: 
                           
                              (5)
                              
                                 log
                                 I
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          ω
                                       
                                       
                                          ℓ
                                          ,
                                          N
                                       
                                    
                                    )
                                 
                                 =
                                 log
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          ℓ
                                          ,
                                          N
                                       
                                    
                                    )
                                 
                                 +
                                 log
                                 
                                    
                                       Z
                                    
                                    
                                       j
                                       ,
                                       ℓ
                                    
                                 
                                 =
                                 
                                    
                                       γ
                                    
                                    
                                       ∗
                                    
                                 
                                 −
                                 2
                                 d
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 log
                                 
                                    |
                                    1
                                    −
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          
                                             
                                                ω
                                             
                                             
                                                ℓ
                                                ,
                                                N
                                             
                                          
                                       
                                    
                                    |
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          ℓ
                                          ,
                                          N
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       ϵ
                                    
                                    
                                       j
                                       ,
                                       ℓ
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 u
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 t
                              
                              
                                 j
                              
                           
                           /
                           T
                           ,
                           
                              
                                 γ
                              
                              
                                 ∗
                              
                           
                           ≡
                           E
                           log
                           
                              (
                              
                                 
                                    Z
                                 
                                 
                                    j
                                    ,
                                    ℓ
                                 
                              
                              )
                           
                           ,
                           
                              
                                 ϵ
                              
                              
                                 j
                                 ,
                                 ℓ
                              
                           
                           ≡
                           log
                           
                              
                                 Z
                              
                              
                                 j
                                 ,
                                 ℓ
                              
                           
                           −
                           
                              
                                 γ
                              
                              
                                 ∗
                              
                           
                        . When the block size 
                           N
                         is large, the error terms 
                           
                              {
                              
                                 
                                    ϵ
                                 
                                 
                                    j
                                    ,
                                    ℓ
                                 
                              
                              }
                           
                         are nearly iid random noise.

Note that 
                           
                              
                                 ψ
                              
                              
                                 0
                              
                           
                           
                              (
                              ω
                              )
                           
                           =
                           1
                        . For notational simplicity, we combined two intercept terms in (5) and equalized the following parametrizations: 
                           
                              (6)
                              
                                 
                                    
                                       θ
                                    
                                    
                                       0
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ≡
                                 
                                    
                                       γ
                                    
                                    
                                       ∗
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       p
                                       +
                                       1
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ≡
                                 d
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       p
                                       +
                                       1
                                    
                                 
                                 
                                    (
                                    ω
                                    )
                                 
                                 ≡
                                 −
                                 2
                                 log
                                 
                                    |
                                    1
                                    −
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ω
                                       
                                    
                                    |
                                 
                                 .
                              
                           
                         Under the reparametrization defined in (6), the regression (5) can be equivalently represented as 
                           
                              (7)
                              
                                 log
                                 I
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          ω
                                       
                                       
                                          ℓ
                                          ,
                                          N
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       θ
                                    
                                    
                                       0
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       p
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          ℓ
                                          ,
                                          N
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       ϵ
                                    
                                    
                                       j
                                       ,
                                       ℓ
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 /
                                 T
                                 .
                              
                           
                        
                     

The log-periodogram regression in (7) is a special case of varying coefficient models (Hastie and Tibshirani, 1993). A standard procedure to carry out the estimation for the varying coefficient functions is via the local linear fitting (Fan and Gijbels, 1996), described as follows.

Given 
                           s
                           ∈
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                         and 
                           u
                         in a neighborhood of 
                           s
                        , the varying coefficient functions in (7) are approximated by the first-order polynomial: 
                           
                              (8)
                              
                                 
                                    
                                       θ
                                    
                                    
                                       0
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ≈
                                 
                                    
                                       α
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    u
                                    −
                                    s
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ≈
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    u
                                    −
                                    s
                                    )
                                 
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 p
                                 +
                                 1
                                 .
                              
                           
                         Let 
                           n
                           ≡
                           
                              [
                              N
                              /
                              2
                              ]
                           
                        . By incorporating the local linear approximation (8) into (7), 
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                           
                              (
                              s
                              )
                           
                         is estimated by minimizing the following local least squares: 
                           
                              (9)
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       ℓ
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       
                                          {
                                          log
                                          I
                                          
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   ω
                                                
                                                
                                                   ℓ
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   β
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      j
                                                   
                                                
                                                −
                                                s
                                                )
                                             
                                             )
                                          
                                          
                                          
                                             
                                                ψ
                                             
                                             
                                                k
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   ω
                                                
                                                
                                                   ℓ
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                          }
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       K
                                    
                                    
                                       h
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    s
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 /
                                 T
                                 ,
                              
                           
                         where 
                           
                              
                                 K
                              
                              
                                 h
                              
                           
                           
                              (
                              x
                              )
                           
                           =
                           
                              
                                 h
                              
                              
                                 −
                                 1
                              
                           
                           K
                           
                              (
                              x
                              /
                              h
                              )
                           
                           ,
                           K
                           
                              (
                              ⋅
                              )
                           
                         is a kernel function and 
                           h
                           >
                           0
                         is the bandwidth. The resulting minimizer satisfies 
                           
                              (10)
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                s
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                s
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                s
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   W
                                                
                                             
                                             
                                                s
                                             
                                          
                                          
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                s
                                             
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          W
                                       
                                    
                                    
                                       s
                                    
                                 
                                 
                                    y
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          β
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                              
                           
                         are the local least square estimates of 
                           
                              {
                              
                                 
                                    α
                                 
                                 
                                    k
                                 
                              
                              }
                           
                         and 
                           
                              {
                              
                                 
                                    β
                                 
                                 
                                    k
                                 
                              
                              }
                           
                         in vector form, and 
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          j
                                          ,
                                          ℓ
                                       
                                    
                                    ≡
                                    log
                                    I
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             ω
                                          
                                          
                                             ℓ
                                             ,
                                             N
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          ℓ
                                       
                                    
                                    ≡
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   ψ
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      ℓ
                                                      ,
                                                      N
                                                   
                                                
                                                )
                                             
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      ℓ
                                                      ,
                                                      N
                                                   
                                                
                                                )
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   ψ
                                                
                                                
                                                   p
                                                   +
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      ℓ
                                                      ,
                                                      N
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       y
                                    
                                    ≡
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   Y
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   Y
                                                
                                                
                                                   1
                                                   ,
                                                   n
                                                
                                             
                                             ,
                                             
                                                
                                                   Y
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   Y
                                                
                                                
                                                   2
                                                   ,
                                                   n
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   Y
                                                
                                                
                                                   M
                                                   ,
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   Y
                                                
                                                
                                                   M
                                                   ,
                                                   n
                                                
                                             
                                             )
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                    ≡
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   s
                                                   )
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   s
                                                   )
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                   −
                                                   s
                                                   )
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                   −
                                                   s
                                                   )
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                       
                                       
                                          s
                                       
                                    
                                    ≡
                                    diag
                                    
                                       {
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   s
                                                   )
                                                
                                                ,
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   s
                                                   )
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                   −
                                                   s
                                                   )
                                                
                                                )
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ⊗
                                       
                                          
                                             
                                                1
                                             
                                          
                                          
                                             n
                                          
                                       
                                       }
                                    
                                    ,
                                 
                              
                           
                         in which 
                           
                              
                                 
                                    1
                                 
                              
                              
                                 n
                              
                           
                         is an 
                           n
                           ×
                           1
                         vector with all elements equal to 1.

The local polynomial fitting (10) is applied at 
                           s
                           =
                           
                              
                                 u
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 t
                              
                              
                                 j
                              
                           
                           /
                           T
                         for each 
                           j
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           M
                         to solve the local log-spectra estimate: 
                           
                              (11)
                              
                                 log
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          ℓ
                                          ,
                                          N
                                       
                                    
                                    )
                                 
                                 ≡
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       j
                                       ,
                                       ℓ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ℓ
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                α
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         Such a local fitting scheme has been used in a stationary process for estimating the spectral density (Fan and Kreutzberger, 1998) as well as for validating a given parametric form for the spectral density (Fan and Zhang, 2004). We extend the usage of local fitting beyond the stationary framework to estimate the time-varying spectra in a locally stationary framework. The theoretical properties of the local polynomial fitting for varying coefficient models have been well studied (Fan and Zhang, 2004; Cai et al., 2000a) under some regularity conditions, which can be directly applied to our local log-spectra estimate. The regularity conditions include the smoothness conditions on the varying coefficient functions 
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                           
                              (
                              u
                              )
                           
                         which require to have the continuous second derivatives. Moreover, the basis functions 
                           
                              
                                 ψ
                              
                              
                                 k
                              
                           
                           
                              (
                              ⋅
                              )
                           
                         need to satisfy 
                           
                              
                                 ∫
                              
                              
                                 0
                              
                              
                                 π
                              
                           
                           
                              
                                 ψ
                              
                              
                                 k
                              
                              
                                 2
                              
                           
                           
                              (
                              ω
                              )
                           
                           d
                           ω
                           <
                           ∞
                        . These two conditions are assumed earlier in Section  2. Besides, the fourth moment of the error term in the log-periodogram regression must be finite. In our case, the error terms in the log periodogram regression are asymptotically distributed as the centered logarithm of weighted linear combination of independent 
                           
                              
                                 χ
                              
                              
                                 2
                              
                              
                                 2
                              
                           
                         random variables, which have finite fourth moment. The kernel function 
                           K
                           
                              (
                              u
                              )
                           
                         is symmetric, bounded, and has a bound support. The bandwidth 
                           h
                         satisfies 
                           h
                           →
                           0
                         and 
                           
                              (
                              M
                              n
                              )
                           
                           h
                           →
                           ∞
                         where 
                           M
                         (the number of blocks in time) and 
                           n
                         (the number of frequencies for each block) both go to infinity as 
                           T
                           →
                           ∞
                        .

The local estimates 
                           log
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    ω
                                 
                                 
                                    ℓ
                                    ,
                                    N
                                 
                              
                              )
                           
                         in (11) reveal useful information about the deviations from stationarity, which are further used in Section  3 to develop a frequency domain generalized likelihood ratio test for detecting nonstationarity under the VC-FEXP specification.

Under the VC-FEXP model framework, we detect nonstationarity via evaluating the goodness of fit in the varying-coefficient log-periodogram regression. In the following subsections, we first specify the hypotheses of interest in Section  3.1 and then a nonparametric test is introduced in Section  3.2 by comparing the residual sum of squares (RSS) associated with the null stationary FEXP model against the RSS associated with the alternative nonstationary VC-FEXP model. A bootstrap procedure is also provided for approximating the null distribution of the test statistic in finite samples, detailed in Section  3.3.

Let 
                           A
                           ⊆
                           
                              {
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              p
                              +
                              1
                              }
                           
                        . Under the VC-FEXP model with the time-varying spectra in (1), three types of hypotheses for testing nonstationarity are of interest: 
                           
                              •
                              Hypotheses A: 
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                0
                                             
                                          
                                          :
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          =
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                          k
                                          ∈
                                          A
                                          
                                          v.s.
                                          
                                          
                                             
                                                H
                                             
                                             
                                                1
                                             
                                          
                                          :
                                            not  
                                          
                                             
                                                H
                                             
                                             
                                                0
                                             
                                          
                                          .
                                       
                                    
                                 
                              

Hypotheses B: 
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                0
                                             
                                          
                                          :
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          =
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                          k
                                          ∈
                                          A
                                          
                                          v.s.
                                          
                                          
                                             
                                                H
                                             
                                             
                                                1
                                             
                                          
                                          :
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          =
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                          k
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                0
                                             
                                          
                                          ⊂
                                          A
                                          .
                                       
                                    
                                 
                              

Hypotheses C: 
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                0
                                             
                                          
                                          :
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          =
                                          
                                             
                                                θ
                                             
                                             
                                                0
                                                k
                                             
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          ,
                                          
                                          k
                                          ∈
                                          A
                                          
                                          v.s.
                                          
                                          
                                             
                                                H
                                             
                                             
                                                1
                                             
                                          
                                          :
                                            not  
                                          
                                             
                                                H
                                             
                                             
                                                0
                                             
                                          
                                          .
                                       
                                    
                                 
                              

Hypotheses A detect various kind of nonstationarity. For instance, one can set 
                           A
                           =
                           
                              {
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              p
                              }
                           
                         to test short-memory nonstationarity only, or set 
                           A
                           =
                           
                              {
                              0
                              ,
                              p
                              +
                              1
                              }
                           
                         to test long-memory nonstationarity only. For Hypotheses B, if 
                           A
                           =
                           
                              {
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              p
                              }
                           
                         and 
                           
                              
                                 A
                              
                              
                                 0
                              
                           
                           =
                           A
                           ∖
                           
                              {
                              0
                              }
                           
                        , the problem becomes to test stationarity against a uniformly modulated process considered in Priestley and Subba Rao (1969). Hypotheses C detect the deviation from a fully specified locally stationary structure characterized by 
                           
                              {
                              
                                 
                                    θ
                                 
                                 
                                    0
                                    k
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              :
                              k
                              ∈
                              A
                              }
                           
                         with finite parameters, which can also be viewed as a goodness-of-fit test addressed by Sergides and Paparoditis (2009). Generally speaking, the hypothesis testing for a certain aspect of nonstationarity can possibly be formulated by choosing proper functions 
                           
                              
                                 ψ
                              
                              
                                 k
                              
                           
                           
                              (
                              ω
                              )
                           
                        ’s and imposing suitable restrictions on 
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                           
                              (
                              u
                              )
                           
                        .

To test the hypotheses for nonstationarity given in the previous section, the null model and the alternative model are both fitted using the log-periodogram regression defined in Section  2.1. The null model is fitted in a FEXP form with constant regression coefficients using the ordinary least squares; the alternative model is fitted in a VC-FEXP model with time-varying coefficients using the local least squares. We consider a goodness of fit test by comparing the residual sum of squares between two fitted models. This testing methodology is adopted from the generalized likelihood ratio test of Fan et al. (2001) and a similar idea has been used in testing nonlinearity for time series data by Cai et al. (2000b) in the time domain approach.

Under the first identity in (6), a constant function 
                           
                              
                                 θ
                              
                              
                                 0
                              
                           
                           
                              (
                              u
                              )
                           
                         implies a constant intercept function 
                           
                              
                                 θ
                              
                              
                                 0
                              
                              
                                 ∗
                              
                           
                           
                              (
                              u
                              )
                           
                         in (7) and vice versa. Accordingly, the null hypothesis 
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 :
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 for  
                                 k
                                 ∈
                                 A
                                 ,
                              
                           
                         is equivalent to 
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 :
                                 
                                    
                                       θ
                                    
                                    
                                       0
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    
                                       θ
                                    
                                    
                                       0
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 for  
                                 k
                                 ∈
                                 A
                                 ∖
                                 
                                    {
                                    0
                                    }
                                 
                                 .
                              
                           
                         Due to this equivalence, the ordinary least squares fitting under 
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                         is solved by 
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          0
                                       
                                       
                                          ∗
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 =
                                 arg
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             0
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       
                                          θ
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       ℓ
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       
                                          {
                                          
                                             
                                                Y
                                             
                                             
                                                j
                                                ,
                                                ℓ
                                             
                                          
                                          −
                                          
                                             
                                                θ
                                             
                                             
                                                0
                                             
                                             
                                                ∗
                                             
                                          
                                          −
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                ∈
                                                A
                                                ∖
                                                
                                                   {
                                                   0
                                                   }
                                                
                                             
                                          
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                ψ
                                             
                                             
                                                k
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   ω
                                                
                                                
                                                   ℓ
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                          }
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         resulting in the fitted residual sum of squares: 
                           
                              (12)
                              
                                 
                                    
                                       RSS
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       ℓ
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       
                                          {
                                          
                                             
                                                Y
                                             
                                             
                                                j
                                                ,
                                                ℓ
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                ∗
                                             
                                          
                                          −
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                ∈
                                                A
                                                ∖
                                                
                                                   {
                                                   0
                                                   }
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                ψ
                                             
                                             
                                                k
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   ω
                                                
                                                
                                                   ℓ
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                          }
                                       
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         On the other hand, under VC-FEXP, the time-varying coefficients 
                           
                              
                                 θ
                              
                              
                                 0
                              
                              
                                 ∗
                              
                           
                           
                              (
                              u
                              )
                           
                        ’s and 
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                           
                              (
                              u
                              )
                           
                        ’s are estimated via the local least squares introduced in Section  2.2, defined in (10) and (11), resulting in the fitted residual sum of squares under 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                        : 
                           
                              (13)
                              
                                 
                                    
                                       RSS
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       ℓ
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       
                                          {
                                          
                                             
                                                Y
                                             
                                             
                                                j
                                                ,
                                                ℓ
                                             
                                          
                                          −
                                          log
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   ω
                                                
                                                
                                                   ℓ
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                          }
                                       
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         Our test statistic is defined as 
                           
                              (14)
                              
                                 
                                    
                                       T
                                    
                                    
                                       G
                                       L
                                       R
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             RSS
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             RSS
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             RSS
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             RSS
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             RSS
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 −
                                 1
                                 .
                              
                           
                         A greater value of 
                           
                              
                                 T
                              
                              
                                 G
                                 L
                                 R
                              
                           
                         indicates a stronger evidence favoring nonstationarity, leading to a rejection of the null hypothesis.


                        
                           Theorem 1
                           
                              Under some regularity conditions, the rescaled 
                              
                                 
                                    
                                       T
                                    
                                    
                                       G
                                       L
                                       R
                                    
                                 
                               
                              is asymptotically distributed as a chi-square distribution under stationarity:
                              
                                 
                                    
                                       
                                          
                                             M
                                             n
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       
                                       
                                          
                                             T
                                          
                                          
                                             G
                                             L
                                             R
                                          
                                       
                                       ∼
                                       
                                          
                                             χ
                                          
                                          
                                             b
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                              
                              where
                              
                                 
                                    
                                       b
                                       =
                                       
                                          
                                             
                                                |
                                                A
                                                |
                                             
                                          
                                          
                                             h
                                          
                                       
                                       
                                          {
                                          K
                                          
                                             (
                                             0
                                             )
                                          
                                          −
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          ∫
                                          
                                             
                                                K
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          d
                                          u
                                          }
                                       
                                       ,
                                       
                                       r
                                       =
                                       
                                          
                                             K
                                             
                                                (
                                                0
                                                )
                                             
                                             −
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             ∫
                                             
                                                
                                                   K
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                             d
                                             u
                                          
                                          
                                             ∫
                                             
                                                
                                                   
                                                      {
                                                      K
                                                      
                                                         (
                                                         u
                                                         )
                                                      
                                                      −
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      K
                                                      ∗
                                                      K
                                                      
                                                         (
                                                         u
                                                         )
                                                      
                                                      }
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             d
                                             u
                                          
                                       
                                       ,
                                    
                                 
                              
                              in which 
                              
                                 
                                    |
                                    A
                                    |
                                 
                               
                              is the number of elements in the index set 
                              
                                 A
                                 ,
                                 K
                                 
                                    (
                                    ⋅
                                    )
                                 
                               
                              is the kernel function and 
                              
                                 h
                               
                              is the bandwidth used in the local linear fitting   (9)
                              .
                           

Although the asymptotic distribution for 
                           
                              
                                 T
                              
                              
                                 G
                                 L
                                 R
                              
                           
                         is available, we found that the test based on the chi-square null distribution tends to over reject 
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                         for series with moderate sample size. This fact was also noticed in the previous studies based on similar testing procedures. We further consider a bootstrap approach to evaluate the 
                           p
                        -value for the GLR test. The detailed steps are summarized in Section  3.3.

We use a standard bootstrap procedure to approximate the 
                           p
                        -value for the test statistic in (14) in the following steps: 
                           
                              1.
                              Under the fitted null and alternative models, we have the fitted values 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   Y
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             j
                                          
                                          
                                             
                                                (
                                                0
                                                )
                                             
                                          
                                       
                                       }
                                    
                                  under the null model and the residuals 
                                    
                                       {
                                       
                                          
                                             ϵ
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             
                                                (
                                                1
                                                )
                                             
                                          
                                       
                                       }
                                    
                                  under the alternative model, where 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   
                                                      (
                                                      0
                                                      )
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   ∗
                                                
                                             
                                             +
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   A
                                                   ∖
                                                   
                                                      {
                                                      0
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   ψ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      ℓ
                                                      ,
                                                      N
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   Y
                                                
                                                
                                                   j
                                                   ,
                                                   ℓ
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              

The bootstrap samples 
                                    
                                       {
                                       
                                          
                                             ϵ
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             ∗
                                             
                                                (
                                                b
                                                )
                                             
                                          
                                       
                                       }
                                    
                                  are generated from the empirical distribution of 
                                    
                                       {
                                       
                                          
                                             ϵ
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             
                                                (
                                                1
                                                )
                                             
                                          
                                       
                                       }
                                    
                                  independently to create the bootstrapped responses under 
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                 : 
                                    
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                ∗
                                                
                                                   (
                                                   b
                                                   )
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                
                                                   (
                                                   0
                                                   )
                                                
                                             
                                          
                                          +
                                          
                                             
                                                ϵ
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                ∗
                                                
                                                   (
                                                   b
                                                   )
                                                
                                             
                                          
                                          ,
                                          
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          M
                                          ,
                                          
                                          j
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                          
                                          b
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                B
                                             
                                          
                                          .
                                       
                                    
                                 
                              

Compute the GLR test statistic based on the 
                                    b
                                 -th bootstrap sample 
                                    
                                       {
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             ∗
                                             
                                                (
                                                b
                                                )
                                             
                                          
                                       
                                       }
                                    
                                 , denoted as 
                                    
                                       
                                          T
                                       
                                       
                                          G
                                          L
                                          R
                                       
                                       
                                          ∗
                                          
                                             (
                                             b
                                             )
                                          
                                       
                                    
                                 , for 
                                    b
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          B
                                       
                                    
                                 .

Approximate the 
                                    p
                                 -value of 
                                    
                                       
                                          T
                                       
                                       
                                          G
                                          L
                                          R
                                       
                                    
                                  by the empirical frequency of 
                                    
                                       {
                                       
                                          
                                             T
                                          
                                          
                                             G
                                             L
                                             R
                                          
                                          
                                             ∗
                                             
                                                (
                                                b
                                                )
                                             
                                          
                                       
                                       >
                                       
                                          
                                             T
                                          
                                          
                                             G
                                             L
                                             R
                                          
                                       
                                       }
                                    
                                  among all 
                                    b
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          B
                                       
                                    
                                 .

We investigate the performance of the proposed test in a simulation study under various model settings with different degrees of nonstationarity. Moreover, an application to the tree ring data is illustrated in Section  4.2.

We consider five nonstationary models in this simulation study, including a piecewise autoregressive model, two time-varying autoregressive models and two mixture models. The detailed model specifications are given in Table 1
                        , where all 
                           
                              {
                              
                                 
                                    η
                                 
                                 
                                    t
                                 
                              
                              }
                           
                         and 
                           
                              {
                              
                                 
                                    η
                                 
                                 
                                    j
                                    ,
                                    t
                                 
                              
                              }
                           
                         are iid 
                           N
                           
                              (
                              0
                              ,
                              1
                              )
                           
                        . In each setting, data are generated in different degrees of nonstationarity controlled by the index 
                           λ
                        . For the piecewise AR model, 
                           λ
                         controls the proportions of the two sub-models. For the other four models, the nonstationarity is governed through the weight function 
                           
                              
                                 w
                              
                              
                                 λ
                              
                           
                           
                              (
                              u
                              )
                           
                        : 
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       λ
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                       +
                                       exp
                                       
                                          {
                                          −
                                          10
                                          
                                             (
                                             u
                                             −
                                             0.5
                                             )
                                          
                                          }
                                       
                                    
                                 
                                 ,
                                 
                                 u
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 .
                              
                           
                         This weight function, shown in Fig. 1
                        , characterizes the change of dynamics from one sub-model to the other within the observation time period. These five models are stationary when 
                           λ
                           =
                           0
                         and move towards stronger nonstationarity as 
                           λ
                         increases. Here, we set 
                           λ
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           5
                         in this simulation. For each 
                           λ
                        , 500 realizations of length 
                           T
                           =
                           500
                         are generated for Models (a)–(d) and 1000 realizations of length 
                           T
                           =
                           1000
                         for Model (e). The generalized likelihood ratio test is implemented based on the bootstrapped 
                           p
                        -value 
                           
                              (
                              
                                 
                                    n
                                 
                                 
                                    B
                                 
                              
                              =
                              500
                              )
                           
                        .

For Models (a)–(d), we focus on the detection of short-memory nonstationarity with: 
                           
                              
                                 (15)
                                 
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                    :
                                    
                                    log
                                    
                                       
                                          f
                                       
                                       
                                          t
                                       
                                    
                                    
                                       (
                                       ω
                                       )
                                    
                                    =
                                    
                                       
                                          θ
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    cos
                                    
                                       (
                                       k
                                       ω
                                       )
                                    
                                    ,
                                 
                              
                              
                                 (16)
                                 
                                    v.s.
                                    
                                    
                                       
                                          H
                                       
                                       
                                          1
                                       
                                    
                                    :
                                    
                                    log
                                    
                                       
                                          f
                                       
                                       
                                          t
                                       
                                    
                                    
                                       (
                                       ω
                                       )
                                    
                                    =
                                    
                                       
                                          θ
                                       
                                       
                                          0
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    cos
                                    
                                       (
                                       k
                                       ω
                                       )
                                    
                                    .
                                 
                              
                           
                         For Model (e), we emphasize on the dynamic change in long memory with the hypotheses: 
                           
                              
                                 (17)
                                 
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                    :
                                    
                                    log
                                    
                                       
                                          f
                                       
                                       
                                          t
                                       
                                    
                                    
                                       (
                                       ω
                                       )
                                    
                                    =
                                    
                                       
                                          θ
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    2
                                    d
                                    log
                                    
                                       |
                                       1
                                       −
                                       
                                          
                                             e
                                          
                                          
                                             i
                                             ω
                                          
                                       
                                       |
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    cos
                                    
                                       (
                                       k
                                       ω
                                       )
                                    
                                    ,
                                 
                              
                              
                                 (18)
                                 
                                    v.s.
                                    
                                    
                                       
                                          H
                                       
                                       
                                          1
                                       
                                    
                                    :
                                    
                                    log
                                    
                                       
                                          f
                                       
                                       
                                          t
                                       
                                    
                                    
                                       (
                                       ω
                                       )
                                    
                                    =
                                    
                                       
                                          θ
                                       
                                       
                                          0
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    −
                                    2
                                    d
                                    
                                       (
                                       u
                                       )
                                    
                                    log
                                    
                                       |
                                       1
                                       −
                                       
                                          
                                             e
                                          
                                          
                                             i
                                             ω
                                          
                                       
                                       |
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    cos
                                    
                                       (
                                       k
                                       ω
                                       )
                                    
                                    .
                                 
                              
                           
                         For the alternative (16) or (18), the local polynomial fitting described in Section  2.2 is implemented using a Gaussian kernel with the bandwidth set to be 0.25. The blockwise periodogram (3) and the smoothed local periodogram estimates (4) are both considered, with block settings 
                           
                              (
                              M
                              ,
                              N
                              )
                           
                         equal to (5,100) for Models (a)–(d) and (10,100) for Model (e). The sizes and powers of the GLR test associated with the blockwise and smoothed local periodogram estimates are demonstrated in Tables 2 and 3
                        
                         respectively, with Model (a)–(d) tested under (15)–(16) with 
                           p
                           =
                           7
                        , and Model (e) tested under (17)–(18) with 
                           p
                           =
                           0
                        .

From Table 2, the empirical sizes of all tested models are close to the nominal value 
                           0.05
                         for the null cases at 
                           λ
                           =
                           0
                        , and the empirical powers increase along with larger 
                           λ
                         corresponding to stronger nonstationarity. We found that the test associated with the smoothed local periodogram estimator tends to over reject the null hypothesis when all the frequencies 
                           
                              
                                 Ω
                              
                              
                                 N
                              
                           
                           ≡
                           
                              {
                              
                                 
                                    ω
                                 
                                 
                                    ℓ
                                    ,
                                    N
                                 
                              
                              :
                              ℓ
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 [
                                 N
                                 /
                                 2
                                 ]
                              
                              }
                           
                         are used in the log-periodogram regression. This might be due to the dependence among the smoothed local periodogram estimates associated with adjacent frequencies. To resolve this issue, we modified the log-periodogram regression by using partial frequencies only, e.g.,  
                           1
                           /
                           5
                         of 
                           
                              
                                 Ω
                              
                              
                                 N
                              
                           
                         by regularly selecting one from every 5 frequencies. The resulting sizes and powers are reported in Table 3. Generally speaking, the GLR test associated with the smoothed local periodogram estimates is less powerful than that based on the blockwise periodogram estimates.

We further examine the impact of some setting parameters on the GLR test results, focusing on two particular factors: the block setting 
                           
                              (
                              M
                              ,
                              N
                              )
                           
                         and the number of basis terms 
                           p
                         specified in the VC-FEXP model. Fig. 2
                         presents the empirical sizes and powers of Model (d), under three different block settings in (3)
                        
                           
                              (
                              M
                              ,
                              N
                              ,
                              S
                              )
                           
                           =
                           
                              (
                              5
                              ,
                              100
                              ,
                              100
                              )
                           
                           ,
                           
                              (
                              11
                              ,
                              50
                              ,
                              45
                              )
                           
                         and (15,38,33). The first setting forms non-overlapping blocks; the other two settings form overlapping blocks. Fig. 2 shows similar performance among different settings, indicating that the GLR test is fairly robust to the block settings. Similar results are found for the other models as well. In practice, the block setting determines the trade off between the information in the time scale and in the frequency scale. A setting with smaller blocks preserves lower-resolution information on spectrum but simultaneously has higher-resolution information on the time scale, and vice versa. In other words, large-scale changes on the spectrum is possibly detected faster in time using smaller block setting; but detailed changes in the spectrum are detectable only at a longer period of time using larger block settings. As an example, in Fig. 2, the third block setting 
                           
                              (
                              M
                              ,
                              N
                              ,
                              S
                              )
                           
                           =
                           
                              (
                              15
                              ,
                              38
                              ,
                              33
                              )
                           
                         creates the shortest block among three settings and results in a slightly higher testing power for the cases with higher degrees of nonstationarity.

Regarding the impact of the order 
                           p
                         on the testing performance, Tables 4 and 5
                        
                         show the testing powers for Models (d) and (e) under various choices of 
                           p
                        . Generally speaking, a greater 
                           p
                         tends to increase the power for data with lower degrees of non-stationarity but loses power for data with higher degrees of non-stationarity. This phenomenon seems reasonable due to that a VC-FEXP model with a greater 
                           p
                         provides a more flexible form for nonstationarity detection but simultaneously pays the price of having larger estimation errors leading to power loss. Without any knowledge in advance, our experience suggests to use a more parsimony model with lower order 
                           p
                        . Order selection strategies such as the forward search can be incorporated into the fitting procedure to enhance the testing power but it is beyond the focus of this study.

For testing nonstationary long memory, we are aware of the bias of the periodogram associated with very low frequencies. According to our simulation results for the long-memory Model (e), the type I errors of the GLR test are about correct showing that the impact of such bias seems not to be a problem. Another way to avoid such a bias issue is to implement the GLR test based on the local periodogram estimates with frequencies away from zero, in particular the lowest 10% Fourier frequencies are excluded from the analysis. Doing so, the GLR test is expected to lose power. The corresponding results for Model (e) under the same setting as those in Table 5 are reported in Table 6
                        .

To sum up, the GLR test based on the blockwise periodogram estimate has good power on detecting various nonstationarities and simultaneously controls the type I error correctly. On the other hand, when implementing the GLR test based on the smoothed local periodogram estimates, we suggest using only a fraction of frequencies to maintain the correct size of the test. Some suggestions for choosing the fraction from the theoretic aspect were addressed by Priestley (1966), but a good selection in practice needs more investigation.

We illustrate the proposed testing procedure using the tree ring data given by D.A. Graybill (Source: Rob J. Hyndman’s Time Series Data Library, http://data.is/TSDLdemo. Accessed on April, 2011). This time series measures the chronologies of bristlecone pine trees at Mammoth Creek, Utah, USA, which contains 1990 observations recorded from year 0 to 1989 A.D. Beran (2009) analyzed a subset of these data (consisting of the first 1900 observations) and concluded that the series exhibits long-memory nonstationarity with a decreasing memory parameter. We apply our GLR test to the complete data for further confirmation. For this application, we set the hypotheses (17) versus (18) in two ways: 
                           
                              •
                              testing for long-memory nonstationarity only with 
                                    p
                                    =
                                    0
                                 ;

testing for general nonstationarity with 
                                    p
                                    =
                                    1
                                    ,
                                    3
                                    ,
                                    5
                                    ,
                                    7
                                 .

No matter what 
                           p
                         is used, the 
                           p
                        -values associated with the test using blockwise periodogram are extremely small indicating a strong evidence of nonstationary long-memory in the tree ring data. While the GLR test using the smoothed local periodogram is less significant, all 
                           p
                        -values are still less than 0.05. The local polynomial fittings of 
                           d
                           
                              (
                              u
                              )
                           
                         under (18) with 
                           p
                           =
                           0
                         using the blockwise periodogram and the local periodogram estimates are shown in Fig. 3
                        . These time-varying patterns agree with that given in Beran (2009) very well. The time-varying patterns are also similar under a more general nonstationary model with 
                           p
                           >
                           0
                        .

@&#SUMMARY@&#

We propose a varying coefficient FEXP model specified in the frequency domain, which is useful for modeling the spectral density of a locally stationary time series and also serves as a general alternative model for testing nonstationarity. We then suggest a nonparametric GLR testing procedure for detecting nonstationarity under the VC-FEXP model framework. The simulation results show that the GLR test has fairly good performance in detecting various nonstationary structures.

There are several directions for further study. First, in the model specification, the basis functions 
                        
                           
                              ψ
                           
                           
                              k
                           
                        
                        
                           (
                           ⋅
                           )
                        
                      in (1) could be in other forms rather than the cosine functions. The GLR test would be more powerful by incorporating a good selection of the basis functions in the fitting procedure. Second, the setting for calculating the local periodogram estimates affects the test result observed in the simulation study. This issue is analogous to the bandwidth selection problem and how to make a good setting for empirical data analysis needs a further investigation. Finally, a similar testing methodology can be adapted for detecting nonstationarity in spatial data.

@&#REFERENCES@&#

